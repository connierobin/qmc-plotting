Rank =    0  Free Memory = 70808 MB
Rank =    1  Free Memory = 70806 MB
Rank =    2  Free Memory = 70805 MB
Rank =    3  Free Memory = 70805 MB
Rank =    4  Free Memory = 70805 MB
Rank =    5  Free Memory = 70805 MB
Rank =    6  Free Memory = 70805 MB
Rank =    7  Free Memory = 70805 MB
Rank =    8  Free Memory = 70805 MB
Rank =    9  Free Memory = 70805 MB
Rank =   10  Free Memory = 70805 MB
Rank =   11  Free Memory = 70805 MB
Rank =   12  Free Memory = 70805 MB
Rank =   13  Free Memory = 70805 MB
Rank =   14  Free Memory = 70804 MB
Rank =   15  Free Memory = 70793 MB
Rank =   16  Free Memory = 70792 MB
Rank =   17  Free Memory = 70792 MB
Rank =   18  Free Memory = 70792 MB
Rank =   19  Free Memory = 70792 MB
Rank =   20  Free Memory = 70792 MB
Rank =   21  Free Memory = 70792 MB
Rank =   22  Free Memory = 70792 MB
Rank =   23  Free Memory = 70792 MB
Rank =   24  Free Memory = 70792 MB
Rank =   25  Free Memory = 70792 MB
Rank =   26  Free Memory = 70792 MB
Rank =   27  Free Memory = 70792 MB
Rank =   28  Free Memory = 70792 MB
Rank =   29  Free Memory = 70792 MB
Rank =   30  Free Memory = 70792 MB
Rank =   31  Free Memory = 70792 MB
Rank =   32  Free Memory = 71458 MB
Rank =   33  Free Memory = 71458 MB
Rank =   34  Free Memory = 71458 MB
Rank =   35  Free Memory = 71458 MB
Rank =   36  Free Memory = 71458 MB
Rank =   37  Free Memory = 71458 MB
Rank =   38  Free Memory = 71458 MB
Rank =   39  Free Memory = 71458 MB
Rank =   40  Free Memory = 71458 MB
Rank =   41  Free Memory = 71458 MB
Rank =   42  Free Memory = 71458 MB
Rank =   43  Free Memory = 71458 MB
Rank =   44  Free Memory = 71458 MB
Rank =   45  Free Memory = 71458 MB
Rank =   46  Free Memory = 71458 MB
Rank =   47  Free Memory = 71458 MB
Rank =   48  Free Memory = 71458 MB
Rank =   49  Free Memory = 71458 MB
Rank =   50  Free Memory = 71458 MB
Rank =   51  Free Memory = 71458 MB
Rank =   52  Free Memory = 71458 MB
Rank =   53  Free Memory = 71458 MB
Rank =   54  Free Memory = 71458 MB
Rank =   55  Free Memory = 71458 MB
Rank =   56  Free Memory = 71458 MB
Rank =   57  Free Memory = 71458 MB
Rank =   58  Free Memory = 71457 MB
Rank =   59  Free Memory = 71457 MB
Rank =   60  Free Memory = 71457 MB
Rank =   61  Free Memory = 71457 MB
Rank =   62  Free Memory = 71457 MB
Rank =   63  Free Memory = 71457 MB
Rank =   64  Free Memory = 68360 MB
Rank =   65  Free Memory = 68360 MB
Rank =   66  Free Memory = 68360 MB
Rank =   67  Free Memory = 68360 MB
Rank =   68  Free Memory = 68360 MB
Rank =   69  Free Memory = 68360 MB
Rank =   70  Free Memory = 68360 MB
Rank =   71  Free Memory = 68360 MB
Rank =   72  Free Memory = 68360 MB
Rank =   73  Free Memory = 68360 MB
Rank =   74  Free Memory = 68360 MB
Rank =   75  Free Memory = 68360 MB
Rank =   76  Free Memory = 68360 MB
Rank =   77  Free Memory = 68360 MB
Rank =   78  Free Memory = 68360 MB
Rank =   79  Free Memory = 68360 MB
Rank =   80  Free Memory = 68359 MB
Rank =   81  Free Memory = 68359 MB
Rank =   82  Free Memory = 68359 MB
Rank =   83  Free Memory = 68359 MB
Rank =   84  Free Memory = 68359 MB
Rank =   85  Free Memory = 68359 MB
Rank =   86  Free Memory = 68359 MB
Rank =   87  Free Memory = 68359 MB
Rank =   88  Free Memory = 68359 MB
Rank =   89  Free Memory = 68359 MB
Rank =   90  Free Memory = 68359 MB
Rank =   91  Free Memory = 68359 MB
Rank =   92  Free Memory = 68359 MB
Rank =   93  Free Memory = 68359 MB
Rank =   94  Free Memory = 68359 MB
Rank =   95  Free Memory = 68359 MB
Rank =   96  Free Memory = 66409 MB
Rank =   97  Free Memory = 66409 MB
Rank =   98  Free Memory = 66409 MB
Rank =   99  Free Memory = 66409 MB
Rank =  100  Free Memory = 66409 MB
Rank =  101  Free Memory = 66409 MB
Rank =  102  Free Memory = 66409 MB
Rank =  103  Free Memory = 66409 MB
Rank =  104  Free Memory = 66409 MB
Rank =  105  Free Memory = 66409 MB
Rank =  106  Free Memory = 66409 MB
Rank =  107  Free Memory = 66409 MB
Rank =  108  Free Memory = 66409 MB
Rank =  109  Free Memory = 66409 MB
Rank =  110  Free Memory = 66409 MB
Rank =  111  Free Memory = 66409 MB
Rank =  112  Free Memory = 66409 MB
Rank =  113  Free Memory = 66409 MB
Rank =  114  Free Memory = 66409 MB
Rank =  115  Free Memory = 66409 MB
Rank =  116  Free Memory = 66409 MB
Rank =  117  Free Memory = 66409 MB
Rank =  118  Free Memory = 66409 MB
Rank =  119  Free Memory = 66409 MB
Rank =  120  Free Memory = 66409 MB
Rank =  121  Free Memory = 66409 MB
Rank =  122  Free Memory = 66409 MB
Rank =  123  Free Memory = 66409 MB
Rank =  124  Free Memory = 66409 MB
Rank =  125  Free Memory = 66408 MB
Rank =  126  Free Memory = 66408 MB
Rank =  127  Free Memory = 66408 MB
  Input file(s): opt_h2o_gs_gvptt_32dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_32dets_run001f.xml

  Project = H2O
  date    = 2023-05-14 15:22:45 PDT
  host    = n0026.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 821

  Range of prime numbers to use as seeds over processors and threads = 6323-7507


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.200698e-01    1         1  ON     0
     uu_1                 5.346208e-02    1         1  ON     1
     uu_2                -4.625710e-02    1         1  ON     2
     uu_3                -1.035660e-01    1         1  ON     3
     uu_4                -1.367493e-01    1         1  ON     4
     uu_5                -1.428450e-01    1         1  ON     5
     uu_6                -1.197772e-01    1         1  ON     6
     uu_7                -5.047321e-02    1         1  ON     7
     uu_8                 8.985774e-02    1         1  ON     8
     uu_9                 1.304373e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.679948e-01    1         1  ON     0
     ud_1                 1.020584e-01    1         1  ON     1
     ud_2                -1.449103e-02    1         1  ON     2
     ud_3                -7.788714e-02    1         1  ON     3
     ud_4                -1.257901e-01    1         1  ON     4
     ud_5                -1.570998e-01    1         1  ON     5
     ud_6                -1.595589e-01    1         1  ON     6
     ud_7                -1.160356e-01    1         1  ON     7
     ud_8                -1.497313e-02    1         1  ON     8
     ud_9                 9.187830e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.092529e-01    1         1  ON     0
     eO_1                -4.764127e-01    1         1  ON     1
     eO_2                -4.797272e-02    1         1  ON     2
     eO_3                 2.201502e-01    1         1  ON     3
     eO_4                 3.204359e-01    1         1  ON     4
     eO_5                 3.342181e-01    1         1  ON     5
     eO_6                 2.654162e-01    1         1  ON     6
     eO_7                 1.301709e-01    1         1  ON     7
     eO_8                 3.091170e-02    1         1  ON     8
     eO_9                 1.995683e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.851191e-01    1         1  ON     0
     eH1_1                -1.061882e-01    1         1  ON     1
     eH1_2                -6.332660e-02    1         1  ON     2
     eH1_3                -2.550935e-02    1         1  ON     3
     eH1_4                 1.889038e-02    1         1  ON     4
     eH1_5                 3.132479e-02    1         1  ON     5
     eH1_6                 7.601514e-02    1         1  ON     6
     eH1_7                 1.081401e-01    1         1  ON     7
     eH1_8                 1.009262e-01    1         1  ON     8
     eH1_9                 2.807699e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.869111e-01    1         1  ON     0
     eH2_1                -1.073016e-01    1         1  ON     1
     eH2_2                -6.454256e-02    1         1  ON     2
     eH2_3                -2.675873e-02    1         1  ON     3
     eH2_4                 1.787106e-02    1         1  ON     4
     eH2_5                 3.040885e-02    1         1  ON     5
     eH2_6                 7.670263e-02    1         1  ON     6
     eH2_7                 1.122960e-01    1         1  ON     7
     eH2_8                 1.047039e-01    1         1  ON     8
     eH2_9                 2.963655e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 32 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.673366e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 11 unique up determinants.
Found 11 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4961e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.259342
====================================================
  Execution time = 1.9556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.1641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345850786029
                                         uncertainty =       0.005240125160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345850786029
                                         uncertainty =       0.005240125160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415824362
  error estimate for blocks of size 2^( 2) =       0.000426780014
  error estimate for blocks of size 2^( 3) =       0.000436414674
  error estimate for blocks of size 2^( 4) =       0.000443982978
  error estimate for blocks of size 2^( 5) =       0.000447495392
  error estimate for blocks of size 2^( 6) =       0.000449271462
  error estimate for blocks of size 2^( 7) =       0.000450378535

      target function =                  N/A
              le_mean =     -17.212435979815
             les_mean =     296.613771986193
             stat err =       0.000447782092
             autocorr =       1.159614353076
              std dev =       0.588064452143
             le_variance =       0.345819799874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721243597981e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212435979815       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212441014733       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212441653503       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212441118623       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212441108039       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212441476023       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212441373881       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212441553997       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212441490119       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212441625161       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.282214e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212435979815       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212438088974       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212438587190       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212438522827       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212438688645       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212438718918       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212438523576       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212438531770       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212438559850       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.955263e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212435979815       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212436614268       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212436802709       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212436806724       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212436916921       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212436891901       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212436838058       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212436827413       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.064280e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4736e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.198935e-01                 1 1 ON  0
uu_1  5.354390e-02                 1 1 ON  1
uu_2  -4.615718e-02                1 1 ON  2
uu_3  -1.035571e-01                1 1 ON  3
uu_4  -1.366792e-01                1 1 ON  4
uu_5  -1.428908e-01                1 1 ON  5
uu_6  -1.198056e-01                1 1 ON  6
uu_7  -5.054389e-02                1 1 ON  7
uu_8  8.977683e-02                 1 1 ON  8
uu_9  1.304892e-01                 1 1 ON  9
ud_0  3.681979e-01                 1 1 ON  10
ud_1  1.021959e-01                 1 1 ON  11
ud_2  -1.464268e-02                1 1 ON  12
ud_3  -7.808595e-02                1 1 ON  13
ud_4  -1.257930e-01                1 1 ON  14
ud_5  -1.570841e-01                1 1 ON  15
ud_6  -1.595299e-01                1 1 ON  16
ud_7  -1.160380e-01                1 1 ON  17
ud_8  -1.508317e-02                1 1 ON  18
ud_9  9.187424e-02                 1 1 ON  19
eO_0  -8.096485e-01                1 1 ON  20
eO_1  -4.766308e-01                1 1 ON  21
eO_2  -4.779630e-02                1 1 ON  22
eO_3  2.202188e-01                 1 1 ON  23
eO_4  3.204347e-01                 1 1 ON  24
eO_5  3.342944e-01                 1 1 ON  25
eO_6  2.655498e-01                 1 1 ON  26
eO_7  1.302921e-01                 1 1 ON  27
eO_8  3.092703e-02                 1 1 ON  28
eO_9  1.996634e-02                 1 1 ON  29
eH1_0 -1.852380e-01                1 1 ON  30
eH1_1 -1.062061e-01                1 1 ON  31
eH1_2 -6.330311e-02                1 1 ON  32
eH1_3 -2.555591e-02                1 1 ON  33
eH1_4 1.896733e-02                 1 1 ON  34
eH1_5 3.128987e-02                 1 1 ON  35
eH1_6 7.601128e-02                 1 1 ON  36
eH1_7 1.081362e-01                 1 1 ON  37
eH1_8 1.010060e-01                 1 1 ON  38
eH1_9 2.810905e-02                 1 1 ON  39
eH2_0 -1.869830e-01                1 1 ON  40
eH2_1 -1.073283e-01                1 1 ON  41
eH2_2 -6.456150e-02                1 1 ON  42
eH2_3 -2.669052e-02                1 1 ON  43
eH2_4 1.790769e-02                 1 1 ON  44
eH2_5 3.041200e-02                 1 1 ON  45
eH2_6 7.664946e-02                 1 1 ON  46
eH2_7 1.122565e-01                 1 1 ON  47
eH2_8 1.047761e-01                 1 1 ON  48
eH2_9 2.965677e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1583
    reference variance = 0.22669
====================================================
  Execution time = 1.8818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.4437e-01
  Total weights = 2.0000e+06
  Execution time = 1.5682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344271741436
                                         uncertainty =       0.004577773432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344271741436
                                         uncertainty =       0.004577773432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414841917
  error estimate for blocks of size 2^( 2) =       0.000424872079
  error estimate for blocks of size 2^( 3) =       0.000434538826
  error estimate for blocks of size 2^( 4) =       0.000441950877
  error estimate for blocks of size 2^( 5) =       0.000445494674
  error estimate for blocks of size 2^( 6) =       0.000448624674
  error estimate for blocks of size 2^( 7) =       0.000449621220

      target function =                  N/A
              le_mean =     -17.212655783943
             les_mean =     296.619706596768
             stat err =       0.000446422861
             autocorr =       1.158050740214
              std dev =       0.586675065385
             le_variance =       0.344187632344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344786252300
                                         uncertainty =       0.004583890328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344786252300
                                         uncertainty =       0.004583890328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415151744
  error estimate for blocks of size 2^( 2) =       0.000425160022
  error estimate for blocks of size 2^( 3) =       0.000434802131
  error estimate for blocks of size 2^( 4) =       0.000442202950
  error estimate for blocks of size 2^( 5) =       0.000445737178
  error estimate for blocks of size 2^( 6) =       0.000448856323
  error estimate for blocks of size 2^( 7) =       0.000449853534

      target function =                  N/A
              le_mean =     -17.212653674736
             les_mean =     296.620148294382
             stat err =       0.000446662496
             autocorr =       1.157564621661
              std dev =       0.587113226164
             le_variance =       0.344701940337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344638499730
                                         uncertainty =       0.004582142053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344638499730
                                         uncertainty =       0.004582142053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415062790
  error estimate for blocks of size 2^( 2) =       0.000425075396
  error estimate for blocks of size 2^( 3) =       0.000434722644
  error estimate for blocks of size 2^( 4) =       0.000442126263
  error estimate for blocks of size 2^( 5) =       0.000445663755
  error estimate for blocks of size 2^( 6) =       0.000448785399
  error estimate for blocks of size 2^( 7) =       0.000449783314

      target function =                  N/A
              le_mean =     -17.212653815869
             les_mean =     296.620005451709
             stat err =       0.000446589683
             autocorr =       1.157683302800
              std dev =       0.586987426645
             le_variance =       0.344554239040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344322076506
                                         uncertainty =       0.004578383473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344322076506
                                         uncertainty =       0.004578383473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414872237
  error estimate for blocks of size 2^( 2) =       0.000424899680
  error estimate for blocks of size 2^( 3) =       0.000434563468
  error estimate for blocks of size 2^( 4) =       0.000441974287
  error estimate for blocks of size 2^( 5) =       0.000445517195
  error estimate for blocks of size 2^( 6) =       0.000448645949
  error estimate for blocks of size 2^( 7) =       0.000449642749

      target function =                  N/A
              le_mean =     -17.212655288692
             les_mean =     296.619739860829
             stat err =       0.000446445045
             autocorr =       1.157996558318
              std dev =       0.586717943835
             le_variance =       0.344237945618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212655783943        initial  <--
     2.5000e-01     2.5000e+00             1.2822e-03       -17.212653674736
     1.0000e+00     1.0000e+01             3.9553e-04       -17.212653815869
     4.0000e+00     4.0000e+01             1.0643e-04       -17.212655288692

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7439
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.200698e-01 1 1  ON 0
 uu_1                 5.346208e-02 1 1  ON 1
 uu_2                -4.625710e-02 1 1  ON 2
 uu_3                -1.035660e-01 1 1  ON 3
 uu_4                -1.367493e-01 1 1  ON 4
 uu_5                -1.428450e-01 1 1  ON 5
 uu_6                -1.197772e-01 1 1  ON 6
 uu_7                -5.047321e-02 1 1  ON 7
 uu_8                 8.985774e-02 1 1  ON 8
 uu_9                 1.304373e-01 1 1  ON 9
 ud_0                 3.679948e-01 1 1  ON 10
 ud_1                 1.020584e-01 1 1  ON 11
 ud_2                -1.449103e-02 1 1  ON 12
 ud_3                -7.788714e-02 1 1  ON 13
 ud_4                -1.257901e-01 1 1  ON 14
 ud_5                -1.570998e-01 1 1  ON 15
 ud_6                -1.595589e-01 1 1  ON 16
 ud_7                -1.160356e-01 1 1  ON 17
 ud_8                -1.497313e-02 1 1  ON 18
 ud_9                 9.187830e-02 1 1  ON 19
 eO_0                -8.092529e-01 1 1  ON 20
 eO_1                -4.764127e-01 1 1  ON 21
 eO_2                -4.797272e-02 1 1  ON 22
 eO_3                 2.201502e-01 1 1  ON 23
 eO_4                 3.204359e-01 1 1  ON 24
 eO_5                 3.342181e-01 1 1  ON 25
 eO_6                 2.654162e-01 1 1  ON 26
 eO_7                 1.301709e-01 1 1  ON 27
 eO_8                 3.091170e-02 1 1  ON 28
 eO_9                 1.995683e-02 1 1  ON 29
eH1_0                -1.851191e-01 1 1  ON 30
eH1_1                -1.061882e-01 1 1  ON 31
eH1_2                -6.332660e-02 1 1  ON 32
eH1_3                -2.550935e-02 1 1  ON 33
eH1_4                 1.889038e-02 1 1  ON 34
eH1_5                 3.132479e-02 1 1  ON 35
eH1_6                 7.601514e-02 1 1  ON 36
eH1_7                 1.081401e-01 1 1  ON 37
eH1_8                 1.009262e-01 1 1  ON 38
eH1_9                 2.807699e-02 1 1  ON 39
eH2_0                -1.869111e-01 1 1  ON 40
eH2_1                -1.073016e-01 1 1  ON 41
eH2_2                -6.454256e-02 1 1  ON 42
eH2_3                -2.675873e-02 1 1  ON 43
eH2_4                 1.787106e-02 1 1  ON 44
eH2_5                 3.040885e-02 1 1  ON 45
eH2_6                 7.670263e-02 1 1  ON 46
eH2_7                 1.122960e-01 1 1  ON 47
eH2_8                 1.047039e-01 1 1  ON 48
eH2_9                 2.963655e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2152
    reference variance = 0.242379
====================================================
  Execution time = 1.8922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352621217005
                                         uncertainty =       0.009159855504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352621217005
                                         uncertainty =       0.009159855504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419874027
  error estimate for blocks of size 2^( 2) =       0.000430437773
  error estimate for blocks of size 2^( 3) =       0.000439806715
  error estimate for blocks of size 2^( 4) =       0.000446860077
  error estimate for blocks of size 2^( 5) =       0.000451298980
  error estimate for blocks of size 2^( 6) =       0.000453053669
  error estimate for blocks of size 2^( 7) =       0.000453977898

      target function =                  N/A
              le_mean =     -17.211311786925
             les_mean =     296.581841646886
             stat err =       0.000451297656
             autocorr =       1.155282342565
              std dev =       0.593791542926
             le_variance =       0.352588396450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721131178692e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211311786925       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211312494273       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211313077858       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211313509056       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211313422125       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211313586773       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211313435856       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211313380654       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.352460e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211311786925       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211311979696       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211312128545       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211312213641       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211312240607       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211312280445       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211312239859       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211312231517       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.495318e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211311786925       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211311836228       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211311873552       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211311894316       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211311903565       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211311913500       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211311903280       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211311901489       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 8.814508e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4292e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.200674e-01 1 1  ON 0
 uu_1                 5.345054e-02 1 1  ON 1
 uu_2                -4.625497e-02 1 1  ON 2
 uu_3                -1.035642e-01 1 1  ON 3
 uu_4                -1.367519e-01 1 1  ON 4
 uu_5                -1.428300e-01 1 1  ON 5
 uu_6                -1.197785e-01 1 1  ON 6
 uu_7                -5.047880e-02 1 1  ON 7
 uu_8                 8.984946e-02 1 1  ON 8
 uu_9                 1.304417e-01 1 1  ON 9
 ud_0                 3.680261e-01 1 1  ON 10
 ud_1                 1.020798e-01 1 1  ON 11
 ud_2                -1.451675e-02 1 1  ON 12
 ud_3                -7.790760e-02 1 1  ON 13
 ud_4                -1.258091e-01 1 1  ON 14
 ud_5                -1.570924e-01 1 1  ON 15
 ud_6                -1.595598e-01 1 1  ON 16
 ud_7                -1.160339e-01 1 1  ON 17
 ud_8                -1.497685e-02 1 1  ON 18
 ud_9                 9.187843e-02 1 1  ON 19
 eO_0                -8.092879e-01 1 1  ON 20
 eO_1                -4.764326e-01 1 1  ON 21
 eO_2                -4.796005e-02 1 1  ON 22
 eO_3                 2.201591e-01 1 1  ON 23
 eO_4                 3.204281e-01 1 1  ON 24
 eO_5                 3.342283e-01 1 1  ON 25
 eO_6                 2.654301e-01 1 1  ON 26
 eO_7                 1.301840e-01 1 1  ON 27
 eO_8                 3.091412e-02 1 1  ON 28
 eO_9                 1.995738e-02 1 1  ON 29
eH1_0                -1.851343e-01 1 1  ON 30
eH1_1                -1.061905e-01 1 1  ON 31
eH1_2                -6.332836e-02 1 1  ON 32
eH1_3                -2.550080e-02 1 1  ON 33
eH1_4                 1.890427e-02 1 1  ON 34
eH1_5                 3.131922e-02 1 1  ON 35
eH1_6                 7.601167e-02 1 1  ON 36
eH1_7                 1.081375e-01 1 1  ON 37
eH1_8                 1.009314e-01 1 1  ON 38
eH1_9                 2.807938e-02 1 1  ON 39
eH2_0                -1.869042e-01 1 1  ON 40
eH2_1                -1.073125e-01 1 1  ON 41
eH2_2                -6.455595e-02 1 1  ON 42
eH2_3                -2.676301e-02 1 1  ON 43
eH2_4                 1.787682e-02 1 1  ON 44
eH2_5                 3.040983e-02 1 1  ON 45
eH2_6                 7.670365e-02 1 1  ON 46
eH2_7                 1.122985e-01 1 1  ON 47
eH2_8                 1.047113e-01 1 1  ON 48
eH2_9                 2.963939e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2531
    reference variance = 0.192367
====================================================
  Execution time = 1.8429e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4123e-01
  Total weights = 2.0000e+06
  Execution time = 1.5698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341142482211
                                         uncertainty =       0.002888590272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341142482211
                                         uncertainty =       0.002888590272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413034310
  error estimate for blocks of size 2^( 2) =       0.000423900145
  error estimate for blocks of size 2^( 3) =       0.000433174762
  error estimate for blocks of size 2^( 4) =       0.000439567561
  error estimate for blocks of size 2^( 5) =       0.000443651249
  error estimate for blocks of size 2^( 6) =       0.000448135420
  error estimate for blocks of size 2^( 7) =       0.000450196608

      target function =                  N/A
              le_mean =     -17.212104740221
             les_mean =     296.597744100581
             stat err =       0.000445387710
             autocorr =       1.162797792519
              std dev =       0.584118723245
             le_variance =       0.341194682845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341273275672
                                         uncertainty =       0.002889184292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341273275672
                                         uncertainty =       0.002889184292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413113515
  error estimate for blocks of size 2^( 2) =       0.000423973607
  error estimate for blocks of size 2^( 3) =       0.000433242513
  error estimate for blocks of size 2^( 4) =       0.000439630896
  error estimate for blocks of size 2^( 5) =       0.000443711121
  error estimate for blocks of size 2^( 6) =       0.000448198580
  error estimate for blocks of size 2^( 7) =       0.000450258939

      target function =                  N/A
              le_mean =     -17.212105923483
             les_mean =     296.597915703733
             stat err =       0.000445449884
             autocorr =       1.162676497552
              std dev =       0.584230736258
             le_variance =       0.341325553189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341212004805
                                         uncertainty =       0.002888892343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341212004805
                                         uncertainty =       0.002888892343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413076415
  error estimate for blocks of size 2^( 2) =       0.000423939116
  error estimate for blocks of size 2^( 3) =       0.000433210649
  error estimate for blocks of size 2^( 4) =       0.000439601056
  error estimate for blocks of size 2^( 5) =       0.000443682870
  error estimate for blocks of size 2^( 6) =       0.000448168817
  error estimate for blocks of size 2^( 7) =       0.000450229592

      target function =                  N/A
              le_mean =     -17.212105390478
             les_mean =     296.597836051941
             stat err =       0.000445420584
             autocorr =       1.162732379822
              std dev =       0.584178268725
             le_variance =       0.341264249650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341151285954
                                         uncertainty =       0.002888628012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341151285954
                                         uncertainty =       0.002888628012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413039642
  error estimate for blocks of size 2^( 2) =       0.000423905076
  error estimate for blocks of size 2^( 3) =       0.000433179299
  error estimate for blocks of size 2^( 4) =       0.000439571792
  error estimate for blocks of size 2^( 5) =       0.000443655241
  error estimate for blocks of size 2^( 6) =       0.000448139639
  error estimate for blocks of size 2^( 7) =       0.000450200775

      target function =                  N/A
              le_mean =     -17.212104821467
             les_mean =     296.597755706893
             stat err =       0.000445391861
             autocorr =       1.162789448139
              std dev =       0.584126264018
             le_variance =       0.341203492315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212104740221        initial
     2.5000e+00     2.5000e+01             1.3525e-04       -17.212105923483  <--
     1.0000e+01     1.0000e+02             3.4953e-05       -17.212105390478
     4.0000e+01     4.0000e+02             8.8145e-06       -17.212104821467

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.6352e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.200585e-01 1 1  ON 0
 uu_1                 5.342124e-02 1 1  ON 1
 uu_2                -4.625032e-02 1 1  ON 2
 uu_3                -1.035597e-01 1 1  ON 3
 uu_4                -1.367586e-01 1 1  ON 4
 uu_5                -1.427882e-01 1 1  ON 5
 uu_6                -1.197818e-01 1 1  ON 6
 uu_7                -5.049473e-02 1 1  ON 7
 uu_8                 8.982539e-02 1 1  ON 8
 uu_9                 1.304545e-01 1 1  ON 9
 ud_0                 3.681144e-01 1 1  ON 10
 ud_1                 1.021323e-01 1 1  ON 11
 ud_2                -1.458115e-02 1 1  ON 12
 ud_3                -7.796869e-02 1 1  ON 13
 ud_4                -1.258616e-01 1 1  ON 14
 ud_5                -1.570731e-01 1 1  ON 15
 ud_6                -1.595606e-01 1 1  ON 16
 ud_7                -1.160278e-01 1 1  ON 17
 ud_8                -1.498744e-02 1 1  ON 18
 ud_9                 9.187885e-02 1 1  ON 19
 eO_0                -8.093882e-01 1 1  ON 20
 eO_1                -4.764887e-01 1 1  ON 21
 eO_2                -4.792800e-02 1 1  ON 22
 eO_3                 2.201851e-01 1 1  ON 23
 eO_4                 3.204055e-01 1 1  ON 24
 eO_5                 3.342585e-01 1 1  ON 25
 eO_6                 2.654711e-01 1 1  ON 26
 eO_7                 1.302223e-01 1 1  ON 27
 eO_8                 3.092117e-02 1 1  ON 28
 eO_9                 1.995897e-02 1 1  ON 29
eH1_0                -1.851789e-01 1 1  ON 30
eH1_1                -1.061976e-01 1 1  ON 31
eH1_2                -6.333232e-02 1 1  ON 32
eH1_3                -2.547689e-02 1 1  ON 33
eH1_4                 1.894493e-02 1 1  ON 34
eH1_5                 3.130327e-02 1 1  ON 35
eH1_6                 7.600156e-02 1 1  ON 36
eH1_7                 1.081302e-01 1 1  ON 37
eH1_8                 1.009467e-01 1 1  ON 38
eH1_9                 2.808637e-02 1 1  ON 39
eH2_0                -1.868850e-01 1 1  ON 40
eH2_1                -1.073451e-01 1 1  ON 41
eH2_2                -6.459303e-02 1 1  ON 42
eH2_3                -2.677652e-02 1 1  ON 43
eH2_4                 1.789265e-02 1 1  ON 44
eH2_5                 3.041359e-02 1 1  ON 45
eH2_6                 7.670714e-02 1 1  ON 46
eH2_7                 1.123060e-01 1 1  ON 47
eH2_8                 1.047329e-01 1 1  ON 48
eH2_9                 2.964768e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.293045
====================================================
  Execution time = 1.8691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355896251186
                                         uncertainty =       0.008198723313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355896251186
                                         uncertainty =       0.008198723313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421748468
  error estimate for blocks of size 2^( 2) =       0.000432132150
  error estimate for blocks of size 2^( 3) =       0.000441759510
  error estimate for blocks of size 2^( 4) =       0.000449276401
  error estimate for blocks of size 2^( 5) =       0.000452898132
  error estimate for blocks of size 2^( 6) =       0.000455143634
  error estimate for blocks of size 2^( 7) =       0.000455019399

      target function =                  N/A
              le_mean =     -17.211850976834
             les_mean =     296.603557411778
             stat err =       0.000453084391
             autocorr =       1.154120551265
              std dev =       0.596442403667
             le_variance =       0.355743540892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721185097683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211850976834       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211855231590       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211856107178       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211855788363       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211855128004       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211855627877       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211855761628       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211855645115       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211855704872       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.805133e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211850976834       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211852335413       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211852693502       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211852637086       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211852442045       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211852617018       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211852579847       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211852547694       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.675994e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211850976834       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211851341772       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211851446233       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211851435633       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211851387978       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211851434232       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211851417380       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211851410170       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.424809e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4080e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.199461e-01 1 1  ON 0
 uu_1                 5.342993e-02 1 1  ON 1
 uu_2                -4.623220e-02 1 1  ON 2
 uu_3                -1.035372e-01 1 1  ON 3
 uu_4                -1.367103e-01 1 1  ON 4
 uu_5                -1.427741e-01 1 1  ON 5
 uu_6                -1.197998e-01 1 1  ON 6
 uu_7                -5.050432e-02 1 1  ON 7
 uu_8                 8.980365e-02 1 1  ON 8
 uu_9                 1.304734e-01 1 1  ON 9
 ud_0                 3.682026e-01 1 1  ON 10
 ud_1                 1.022036e-01 1 1  ON 11
 ud_2                -1.466529e-02 1 1  ON 12
 ud_3                -7.807045e-02 1 1  ON 13
 ud_4                -1.259136e-01 1 1  ON 14
 ud_5                -1.570487e-01 1 1  ON 15
 ud_6                -1.595206e-01 1 1  ON 16
 ud_7                -1.160071e-01 1 1  ON 17
 ud_8                -1.501090e-02 1 1  ON 18
 ud_9                 9.187903e-02 1 1  ON 19
 eO_0                -8.095558e-01 1 1  ON 20
 eO_1                -4.765668e-01 1 1  ON 21
 eO_2                -4.787470e-02 1 1  ON 22
 eO_3                 2.202155e-01 1 1  ON 23
 eO_4                 3.204103e-01 1 1  ON 24
 eO_5                 3.342954e-01 1 1  ON 25
 eO_6                 2.655274e-01 1 1  ON 26
 eO_7                 1.302749e-01 1 1  ON 27
 eO_8                 3.092900e-02 1 1  ON 28
 eO_9                 1.996070e-02 1 1  ON 29
eH1_0                -1.852163e-01 1 1  ON 30
eH1_1                -1.061827e-01 1 1  ON 31
eH1_2                -6.335788e-02 1 1  ON 32
eH1_3                -2.545855e-02 1 1  ON 33
eH1_4                 1.895058e-02 1 1  ON 34
eH1_5                 3.129903e-02 1 1  ON 35
eH1_6                 7.598493e-02 1 1  ON 36
eH1_7                 1.081387e-01 1 1  ON 37
eH1_8                 1.009746e-01 1 1  ON 38
eH1_9                 2.809245e-02 1 1  ON 39
eH2_0                -1.869236e-01 1 1  ON 40
eH2_1                -1.073425e-01 1 1  ON 41
eH2_2                -6.462911e-02 1 1  ON 42
eH2_3                -2.672854e-02 1 1  ON 43
eH2_4                 1.794001e-02 1 1  ON 44
eH2_5                 3.039114e-02 1 1  ON 45
eH2_6                 7.667791e-02 1 1  ON 46
eH2_7                 1.122972e-01 1 1  ON 47
eH2_8                 1.047582e-01 1 1  ON 48
eH2_9                 2.965721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1767
    reference variance = 0.171263
====================================================
  Execution time = 1.8738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3953e-01
  Total weights = 2.0000e+06
  Execution time = 1.5689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339499069376
                                         uncertainty =       0.003667035206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339499069376
                                         uncertainty =       0.003667035206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411974350
  error estimate for blocks of size 2^( 2) =       0.000422656983
  error estimate for blocks of size 2^( 3) =       0.000432390676
  error estimate for blocks of size 2^( 4) =       0.000439429482
  error estimate for blocks of size 2^( 5) =       0.000442956907
  error estimate for blocks of size 2^( 6) =       0.000445143637
  error estimate for blocks of size 2^( 7) =       0.000445747840

      target function =                  N/A
              le_mean =     -17.211694603071
             les_mean =     296.581876669451
             stat err =       0.000443319466
             autocorr =       1.157959178545
              std dev =       0.582619712847
             le_variance =       0.339445729798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339773016115
                                         uncertainty =       0.003669109901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339773016115
                                         uncertainty =       0.003669109901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412140569
  error estimate for blocks of size 2^( 2) =       0.000422809150
  error estimate for blocks of size 2^( 3) =       0.000432528583
  error estimate for blocks of size 2^( 4) =       0.000439561494
  error estimate for blocks of size 2^( 5) =       0.000443083513
  error estimate for blocks of size 2^( 6) =       0.000445269465
  error estimate for blocks of size 2^( 7) =       0.000445872689

      target function =                  N/A
              le_mean =     -17.211695482354
             les_mean =     296.582180903920
             stat err =       0.000443446790
             autocorr =       1.157690047906
              std dev =       0.582854781660
             le_variance =       0.339719696504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339667631070
                                         uncertainty =       0.003667984366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339667631070
                                         uncertainty =       0.003667984366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412076636
  error estimate for blocks of size 2^( 2) =       0.000422749871
  error estimate for blocks of size 2^( 3) =       0.000432474155
  error estimate for blocks of size 2^( 4) =       0.000439509043
  error estimate for blocks of size 2^( 5) =       0.000443033095
  error estimate for blocks of size 2^( 6) =       0.000445218774
  error estimate for blocks of size 2^( 7) =       0.000445822609

      target function =                  N/A
              le_mean =     -17.211695002297
             les_mean =     296.582058989403
             stat err =       0.000443395881
             autocorr =       1.157783419153
              std dev =       0.582764366725
             le_variance =       0.339614307124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339520642170
                                         uncertainty =       0.003667126560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339520642170
                                         uncertainty =       0.003667126560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411987442
  error estimate for blocks of size 2^( 2) =       0.000422668782
  error estimate for blocks of size 2^( 3) =       0.000432401196
  error estimate for blocks of size 2^( 4) =       0.000439439473
  error estimate for blocks of size 2^( 5) =       0.000442966451
  error estimate for blocks of size 2^( 6) =       0.000445153003
  error estimate for blocks of size 2^( 7) =       0.000445757168

      target function =                  N/A
              le_mean =     -17.211694611177
             les_mean =     296.581898523378
             stat err =       0.000443329024
             autocorr =       1.157935510560
              std dev =       0.582638227973
             le_variance =       0.339467304696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211694603071        initial
     6.2500e-01     6.2500e+00             5.8051e-04       -17.211695482354  <--
     2.5000e+00     2.5000e+01             1.6760e-04       -17.211695002297
     1.0000e+01     1.0000e+02             4.4248e-05       -17.211694611177

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0604e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.197133e-01 1 1  ON 0
 uu_1                 5.345540e-02 1 1  ON 1
 uu_2                -4.621442e-02 1 1  ON 2
 uu_3                -1.034759e-01 1 1  ON 3
 uu_4                -1.366235e-01 1 1  ON 4
 uu_5                -1.427323e-01 1 1  ON 5
 uu_6                -1.198547e-01 1 1  ON 6
 uu_7                -5.053450e-02 1 1  ON 7
 uu_8                 8.973839e-02 1 1  ON 8
 uu_9                 1.305303e-01 1 1  ON 9
 ud_0                 3.684061e-01 1 1  ON 10
 ud_1                 1.023363e-01 1 1  ON 11
 ud_2                -1.482046e-02 1 1  ON 12
 ud_3                -7.831045e-02 1 1  ON 13
 ud_4                -1.260596e-01 1 1  ON 14
 ud_5                -1.570135e-01 1 1  ON 15
 ud_6                -1.594005e-01 1 1  ON 16
 ud_7                -1.159392e-01 1 1  ON 17
 ud_8                -1.507955e-02 1 1  ON 18
 ud_9                 9.187981e-02 1 1  ON 19
 eO_0                -8.099687e-01 1 1  ON 20
 eO_1                -4.767998e-01 1 1  ON 21
 eO_2                -4.780786e-02 1 1  ON 22
 eO_3                 2.202914e-01 1 1  ON 23
 eO_4                 3.204354e-01 1 1  ON 24
 eO_5                 3.344101e-01 1 1  ON 25
 eO_6                 2.656976e-01 1 1  ON 26
 eO_7                 1.304336e-01 1 1  ON 27
 eO_8                 3.095264e-02 1 1  ON 28
 eO_9                 1.996592e-02 1 1  ON 29
eH1_0                -1.853165e-01 1 1  ON 30
eH1_1                -1.061598e-01 1 1  ON 31
eH1_2                -6.341072e-02 1 1  ON 32
eH1_3                -2.541800e-02 1 1  ON 33
eH1_4                 1.896297e-02 1 1  ON 34
eH1_5                 3.128876e-02 1 1  ON 35
eH1_6                 7.593667e-02 1 1  ON 36
eH1_7                 1.081648e-01 1 1  ON 37
eH1_8                 1.010586e-01 1 1  ON 38
eH1_9                 2.811076e-02 1 1  ON 39
eH2_0                -1.870281e-01 1 1  ON 40
eH2_1                -1.073423e-01 1 1  ON 41
eH2_2                -6.469730e-02 1 1  ON 42
eH2_3                -2.662344e-02 1 1  ON 43
eH2_4                 1.806280e-02 1 1  ON 44
eH2_5                 3.033517e-02 1 1  ON 45
eH2_6                 7.659290e-02 1 1  ON 46
eH2_7                 1.122713e-01 1 1  ON 47
eH2_8                 1.048346e-01 1 1  ON 48
eH2_9                 2.968588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.594106
====================================================
  Execution time = 1.8852e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3812e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338122655496
                                         uncertainty =       0.003643493037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338122655496
                                         uncertainty =       0.003643493037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411168221
  error estimate for blocks of size 2^( 2) =       0.000421834004
  error estimate for blocks of size 2^( 3) =       0.000431082900
  error estimate for blocks of size 2^( 4) =       0.000438116541
  error estimate for blocks of size 2^( 5) =       0.000442834118
  error estimate for blocks of size 2^( 6) =       0.000445045045
  error estimate for blocks of size 2^( 7) =       0.000445680190

      target function =                  N/A
              le_mean =     -17.211366714450
             les_mean =     296.569262622336
             stat err =       0.000442918974
             autocorr =       1.160404722304
              std dev =       0.581479674739
             le_variance =       0.338118612135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721136671445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211366714450       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211366317147       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211366154778       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211367698407       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211369650858       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211370261734       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211370365239       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211371160341       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211370978283       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211370662306       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211370787772       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.533931e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211366714450       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211366511315       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211366398219       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211366939841       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211367960406       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211367995321       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211367969268       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211368075962       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211368039935       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.366425e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211366714450       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211366645704       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211366602062       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211366748024       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211367075838       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211367058269       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211367059634       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211367073971       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.092784e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4131e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.197437e-01 1 1  ON 0
 uu_1                 5.338554e-02 1 1  ON 1
 uu_2                -4.624079e-02 1 1  ON 2
 uu_3                -1.035033e-01 1 1  ON 3
 uu_4                -1.366702e-01 1 1  ON 4
 uu_5                -1.428525e-01 1 1  ON 5
 uu_6                -1.198142e-01 1 1  ON 6
 uu_7                -5.049443e-02 1 1  ON 7
 uu_8                 8.969936e-02 1 1  ON 8
 uu_9                 1.306276e-01 1 1  ON 9
 ud_0                 3.686776e-01 1 1  ON 10
 ud_1                 1.024222e-01 1 1  ON 11
 ud_2                -1.501153e-02 1 1  ON 12
 ud_3                -7.849613e-02 1 1  ON 13
 ud_4                -1.262591e-01 1 1  ON 14
 ud_5                -1.570224e-01 1 1  ON 15
 ud_6                -1.592050e-01 1 1  ON 16
 ud_7                -1.158636e-01 1 1  ON 17
 ud_8                -1.518013e-02 1 1  ON 18
 ud_9                 9.187248e-02 1 1  ON 19
 eO_0                -8.104053e-01 1 1  ON 20
 eO_1                -4.771471e-01 1 1  ON 21
 eO_2                -4.781823e-02 1 1  ON 22
 eO_3                 2.204497e-01 1 1  ON 23
 eO_4                 3.204090e-01 1 1  ON 24
 eO_5                 3.345584e-01 1 1  ON 25
 eO_6                 2.659140e-01 1 1  ON 26
 eO_7                 1.306698e-01 1 1  ON 27
 eO_8                 3.099759e-02 1 1  ON 28
 eO_9                 1.997820e-02 1 1  ON 29
eH1_0                -1.854436e-01 1 1  ON 30
eH1_1                -1.061671e-01 1 1  ON 31
eH1_2                -6.323998e-02 1 1  ON 32
eH1_3                -2.538609e-02 1 1  ON 33
eH1_4                 1.901685e-02 1 1  ON 34
eH1_5                 3.098453e-02 1 1  ON 35
eH1_6                 7.584497e-02 1 1  ON 36
eH1_7                 1.082355e-01 1 1  ON 37
eH1_8                 1.011936e-01 1 1  ON 38
eH1_9                 2.816004e-02 1 1  ON 39
eH2_0                -1.869866e-01 1 1  ON 40
eH2_1                -1.074398e-01 1 1  ON 41
eH2_2                -6.475340e-02 1 1  ON 42
eH2_3                -2.660699e-02 1 1  ON 43
eH2_4                 1.815731e-02 1 1  ON 44
eH2_5                 3.035896e-02 1 1  ON 45
eH2_6                 7.643600e-02 1 1  ON 46
eH2_7                 1.122474e-01 1 1  ON 47
eH2_8                 1.049508e-01 1 1  ON 48
eH2_9                 2.971954e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2534
    reference variance = 0.367863
====================================================
  Execution time = 1.8536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4061e-01
  Total weights = 2.0000e+06
  Execution time = 1.5575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340182386638
                                         uncertainty =       0.003080448255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340182386638
                                         uncertainty =       0.003080448255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412485212
  error estimate for blocks of size 2^( 2) =       0.000423347683
  error estimate for blocks of size 2^( 3) =       0.000432823473
  error estimate for blocks of size 2^( 4) =       0.000440409868
  error estimate for blocks of size 2^( 5) =       0.000444862091
  error estimate for blocks of size 2^( 6) =       0.000446183032
  error estimate for blocks of size 2^( 7) =       0.000448898556

      target function =                  N/A
              le_mean =     -17.211057566139
             les_mean =     296.560790475223
             stat err =       0.000445088387
             autocorr =       1.164329117986
              std dev =       0.583342181249
             le_variance =       0.340288100424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885109971
                                         uncertainty =       0.003085026944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340885109971
                                         uncertainty =       0.003085026944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412910699
  error estimate for blocks of size 2^( 2) =       0.000423747642
  error estimate for blocks of size 2^( 3) =       0.000433200782
  error estimate for blocks of size 2^( 4) =       0.000440766863
  error estimate for blocks of size 2^( 5) =       0.000445196776
  error estimate for blocks of size 2^( 6) =       0.000446507332
  error estimate for blocks of size 2^( 7) =       0.000449197376

      target function =                  N/A
              le_mean =     -17.211058055892
             les_mean =     296.561509723090
             stat err =       0.000445417086
             autocorr =       1.163647588917
              std dev =       0.583943910229
             le_variance =       0.340990490294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340822442535
                                         uncertainty =       0.003084626182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340822442535
                                         uncertainty =       0.003084626182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412872735
  error estimate for blocks of size 2^( 2) =       0.000423710313
  error estimate for blocks of size 2^( 3) =       0.000433165402
  error estimate for blocks of size 2^( 4) =       0.000440733472
  error estimate for blocks of size 2^( 5) =       0.000445166368
  error estimate for blocks of size 2^( 6) =       0.000446478623
  error estimate for blocks of size 2^( 7) =       0.000449170764

      target function =                  N/A
              le_mean =     -17.211059126499
             les_mean =     296.561483876706
             stat err =       0.000445387307
             autocorr =       1.163705970058
              std dev =       0.583890221989
             le_variance =       0.340927791334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340290812891
                                         uncertainty =       0.003081158798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340290812891
                                         uncertainty =       0.003081158798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412550880
  error estimate for blocks of size 2^( 2) =       0.000423408864
  error estimate for blocks of size 2^( 3) =       0.000432881095
  error estimate for blocks of size 2^( 4) =       0.000440464292
  error estimate for blocks of size 2^( 5) =       0.000444913217
  error estimate for blocks of size 2^( 6) =       0.000446232874
  error estimate for blocks of size 2^( 7) =       0.000448944432

      target function =                  N/A
              le_mean =     -17.211057878646
             les_mean =     296.560909589184
             stat err =       0.000445138704
             autocorr =       1.164221668376
              std dev =       0.583435049742
             le_variance =       0.340396457268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211057566139        initial
     1.5625e-01     1.5625e+00             1.5339e-03       -17.211058055892
     6.2500e-01     6.2500e+00             4.3664e-04       -17.211059126499  <--
     2.5000e+00     2.5000e+01             1.0928e-04       -17.211057878646

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.6419e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.197437e-01 1 1  ON 0
 uu_1                 5.338554e-02 1 1  ON 1
 uu_2                -4.624079e-02 1 1  ON 2
 uu_3                -1.035033e-01 1 1  ON 3
 uu_4                -1.366702e-01 1 1  ON 4
 uu_5                -1.428525e-01 1 1  ON 5
 uu_6                -1.198142e-01 1 1  ON 6
 uu_7                -5.049443e-02 1 1  ON 7
 uu_8                 8.969936e-02 1 1  ON 8
 uu_9                 1.306276e-01 1 1  ON 9
 ud_0                 3.686776e-01 1 1  ON 10
 ud_1                 1.024222e-01 1 1  ON 11
 ud_2                -1.501153e-02 1 1  ON 12
 ud_3                -7.849613e-02 1 1  ON 13
 ud_4                -1.262591e-01 1 1  ON 14
 ud_5                -1.570224e-01 1 1  ON 15
 ud_6                -1.592050e-01 1 1  ON 16
 ud_7                -1.158636e-01 1 1  ON 17
 ud_8                -1.518013e-02 1 1  ON 18
 ud_9                 9.187248e-02 1 1  ON 19
 eO_0                -8.104053e-01 1 1  ON 20
 eO_1                -4.771471e-01 1 1  ON 21
 eO_2                -4.781823e-02 1 1  ON 22
 eO_3                 2.204497e-01 1 1  ON 23
 eO_4                 3.204090e-01 1 1  ON 24
 eO_5                 3.345584e-01 1 1  ON 25
 eO_6                 2.659140e-01 1 1  ON 26
 eO_7                 1.306698e-01 1 1  ON 27
 eO_8                 3.099759e-02 1 1  ON 28
 eO_9                 1.997820e-02 1 1  ON 29
eH1_0                -1.854436e-01 1 1  ON 30
eH1_1                -1.061671e-01 1 1  ON 31
eH1_2                -6.323998e-02 1 1  ON 32
eH1_3                -2.538609e-02 1 1  ON 33
eH1_4                 1.901685e-02 1 1  ON 34
eH1_5                 3.098453e-02 1 1  ON 35
eH1_6                 7.584497e-02 1 1  ON 36
eH1_7                 1.082355e-01 1 1  ON 37
eH1_8                 1.011936e-01 1 1  ON 38
eH1_9                 2.816004e-02 1 1  ON 39
eH2_0                -1.869866e-01 1 1  ON 40
eH2_1                -1.074398e-01 1 1  ON 41
eH2_2                -6.475340e-02 1 1  ON 42
eH2_3                -2.660699e-02 1 1  ON 43
eH2_4                 1.815731e-02 1 1  ON 44
eH2_5                 3.035896e-02 1 1  ON 45
eH2_6                 7.643600e-02 1 1  ON 46
eH2_7                 1.122474e-01 1 1  ON 47
eH2_8                 1.049508e-01 1 1  ON 48
eH2_9                 2.971954e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1781
    reference variance = 0.243612
====================================================
  Execution time = 1.9046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4487e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344773013641
                                         uncertainty =       0.003272952102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344773013641
                                         uncertainty =       0.003272952102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415255402
  error estimate for blocks of size 2^( 2) =       0.000425661977
  error estimate for blocks of size 2^( 3) =       0.000435560457
  error estimate for blocks of size 2^( 4) =       0.000442115039
  error estimate for blocks of size 2^( 5) =       0.000446354697
  error estimate for blocks of size 2^( 6) =       0.000450535033
  error estimate for blocks of size 2^( 7) =       0.000450137711

      target function =                  N/A
              le_mean =     -17.211672486606
             les_mean =     296.586543712098
             stat err =       0.000447285620
             autocorr =       1.160217173172
              std dev =       0.587259821838
             le_variance =       0.344874098345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721167248661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211672486606       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211671170785       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211671387116       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211672684835       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211673691754       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211674121544       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211672215863       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211673080290       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211673405665       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211673768220       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.494483e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211672486606       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211671786494       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211671560689       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211671975866       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211672077279       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211672416027       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211671973930       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211672223675       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211672263143       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.815638e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211672486606       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211672242810       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211672131390       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211672215505       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211672085031       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211672236627       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211672213283       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211672258539       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.348308e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4373e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.196265e-01 1 1  ON 0
 uu_1                 5.343202e-02 1 1  ON 1
 uu_2                -4.616735e-02 1 1  ON 2
 uu_3                -1.035181e-01 1 1  ON 3
 uu_4                -1.367219e-01 1 1  ON 4
 uu_5                -1.429093e-01 1 1  ON 5
 uu_6                -1.198919e-01 1 1  ON 6
 uu_7                -5.046783e-02 1 1  ON 7
 uu_8                 8.964609e-02 1 1  ON 8
 uu_9                 1.307212e-01 1 1  ON 9
 ud_0                 3.686277e-01 1 1  ON 10
 ud_1                 1.024618e-01 1 1  ON 11
 ud_2                -1.498829e-02 1 1  ON 12
 ud_3                -7.867092e-02 1 1  ON 13
 ud_4                -1.263545e-01 1 1  ON 14
 ud_5                -1.570815e-01 1 1  ON 15
 ud_6                -1.590464e-01 1 1  ON 16
 ud_7                -1.157314e-01 1 1  ON 17
 ud_8                -1.526160e-02 1 1  ON 18
 ud_9                 9.187505e-02 1 1  ON 19
 eO_0                -8.108869e-01 1 1  ON 20
 eO_1                -4.773438e-01 1 1  ON 21
 eO_2                -4.792825e-02 1 1  ON 22
 eO_3                 2.205493e-01 1 1  ON 23
 eO_4                 3.204912e-01 1 1  ON 24
 eO_5                 3.345776e-01 1 1  ON 25
 eO_6                 2.661829e-01 1 1  ON 26
 eO_7                 1.309197e-01 1 1  ON 27
 eO_8                 3.104588e-02 1 1  ON 28
 eO_9                 1.999032e-02 1 1  ON 29
eH1_0                -1.854825e-01 1 1  ON 30
eH1_1                -1.062168e-01 1 1  ON 31
eH1_2                -6.323263e-02 1 1  ON 32
eH1_3                -2.533249e-02 1 1  ON 33
eH1_4                 1.924708e-02 1 1  ON 34
eH1_5                 3.082438e-02 1 1  ON 35
eH1_6                 7.563974e-02 1 1  ON 36
eH1_7                 1.082232e-01 1 1  ON 37
eH1_8                 1.013210e-01 1 1  ON 38
eH1_9                 2.819582e-02 1 1  ON 39
eH2_0                -1.871781e-01 1 1  ON 40
eH2_1                -1.076382e-01 1 1  ON 41
eH2_2                -6.485214e-02 1 1  ON 42
eH2_3                -2.665030e-02 1 1  ON 43
eH2_4                 1.826786e-02 1 1  ON 44
eH2_5                 3.061299e-02 1 1  ON 45
eH2_6                 7.644451e-02 1 1  ON 46
eH2_7                 1.122194e-01 1 1  ON 47
eH2_8                 1.050825e-01 1 1  ON 48
eH2_9                 2.975856e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1799
    reference variance = 0.357762
====================================================
  Execution time = 1.9160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4166e-01
  Total weights = 2.0000e+06
  Execution time = 1.5609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341785916427
                                         uncertainty =       0.003790139153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341785916427
                                         uncertainty =       0.003790139153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413371951
  error estimate for blocks of size 2^( 2) =       0.000424483735
  error estimate for blocks of size 2^( 3) =       0.000434177747
  error estimate for blocks of size 2^( 4) =       0.000441737647
  error estimate for blocks of size 2^( 5) =       0.000445787063
  error estimate for blocks of size 2^( 6) =       0.000448787641
  error estimate for blocks of size 2^( 7) =       0.000449624456

      target function =                  N/A
              le_mean =     -17.211429287221
             les_mean =     296.575050677524
             stat err =       0.000446484202
             autocorr =       1.166622059696
              std dev =       0.584596219116
             le_variance =       0.341752739405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341752162116
                                         uncertainty =       0.003791032421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341752162116
                                         uncertainty =       0.003791032421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413351558
  error estimate for blocks of size 2^( 2) =       0.000424463914
  error estimate for blocks of size 2^( 3) =       0.000434150943
  error estimate for blocks of size 2^( 4) =       0.000441704138
  error estimate for blocks of size 2^( 5) =       0.000445753232
  error estimate for blocks of size 2^( 6) =       0.000448749663
  error estimate for blocks of size 2^( 7) =       0.000449590858

      target function =                  N/A
              le_mean =     -17.211431986761
             les_mean =     296.575109885580
             stat err =       0.000446449473
             autocorr =       1.166555673426
              std dev =       0.584567379800
             le_variance =       0.341719021526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341606270536
                                         uncertainty =       0.003789206140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341606270536
                                         uncertainty =       0.003789206140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413263334
  error estimate for blocks of size 2^( 2) =       0.000424379995
  error estimate for blocks of size 2^( 3) =       0.000434071320
  error estimate for blocks of size 2^( 4) =       0.000441628548
  error estimate for blocks of size 2^( 5) =       0.000445678715
  error estimate for blocks of size 2^( 6) =       0.000448678558
  error estimate for blocks of size 2^( 7) =       0.000449521028

      target function =                  N/A
              le_mean =     -17.211432145160
             les_mean =     296.574969482441
             stat err =       0.000446376712
             autocorr =       1.166673434672
              std dev =       0.584442611193
             le_variance =       0.341573165778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341738706136
                                         uncertainty =       0.003789810089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341738706136
                                         uncertainty =       0.003789810089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413343408
  error estimate for blocks of size 2^( 2) =       0.000424456493
  error estimate for blocks of size 2^( 3) =       0.000434150469
  error estimate for blocks of size 2^( 4) =       0.000441710352
  error estimate for blocks of size 2^( 5) =       0.000445759939
  error estimate for blocks of size 2^( 6) =       0.000448760722
  error estimate for blocks of size 2^( 7) =       0.000449598600

      target function =                  N/A
              le_mean =     -17.211429724376
             les_mean =     296.575018532216
             stat err =       0.000446457403
             autocorr =       1.166643124113
              std dev =       0.584555853560
             le_variance =       0.341705545931


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211429287221        initial
     1.5625e-01     1.5625e+00             1.4945e-03       -17.211431986761
     6.2500e-01     6.2500e+00             4.8156e-04       -17.211432145160  <--
     2.5000e+00     2.5000e+01             1.3483e-04       -17.211429724376

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.7039e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.196265e-01 1 1  ON 0
 uu_1                 5.343202e-02 1 1  ON 1
 uu_2                -4.616735e-02 1 1  ON 2
 uu_3                -1.035181e-01 1 1  ON 3
 uu_4                -1.367219e-01 1 1  ON 4
 uu_5                -1.429093e-01 1 1  ON 5
 uu_6                -1.198919e-01 1 1  ON 6
 uu_7                -5.046783e-02 1 1  ON 7
 uu_8                 8.964609e-02 1 1  ON 8
 uu_9                 1.307212e-01 1 1  ON 9
 ud_0                 3.686277e-01 1 1  ON 10
 ud_1                 1.024618e-01 1 1  ON 11
 ud_2                -1.498829e-02 1 1  ON 12
 ud_3                -7.867092e-02 1 1  ON 13
 ud_4                -1.263545e-01 1 1  ON 14
 ud_5                -1.570815e-01 1 1  ON 15
 ud_6                -1.590464e-01 1 1  ON 16
 ud_7                -1.157314e-01 1 1  ON 17
 ud_8                -1.526160e-02 1 1  ON 18
 ud_9                 9.187505e-02 1 1  ON 19
 eO_0                -8.108869e-01 1 1  ON 20
 eO_1                -4.773438e-01 1 1  ON 21
 eO_2                -4.792825e-02 1 1  ON 22
 eO_3                 2.205493e-01 1 1  ON 23
 eO_4                 3.204912e-01 1 1  ON 24
 eO_5                 3.345776e-01 1 1  ON 25
 eO_6                 2.661829e-01 1 1  ON 26
 eO_7                 1.309197e-01 1 1  ON 27
 eO_8                 3.104588e-02 1 1  ON 28
 eO_9                 1.999032e-02 1 1  ON 29
eH1_0                -1.854825e-01 1 1  ON 30
eH1_1                -1.062168e-01 1 1  ON 31
eH1_2                -6.323263e-02 1 1  ON 32
eH1_3                -2.533249e-02 1 1  ON 33
eH1_4                 1.924708e-02 1 1  ON 34
eH1_5                 3.082438e-02 1 1  ON 35
eH1_6                 7.563974e-02 1 1  ON 36
eH1_7                 1.082232e-01 1 1  ON 37
eH1_8                 1.013210e-01 1 1  ON 38
eH1_9                 2.819582e-02 1 1  ON 39
eH2_0                -1.871781e-01 1 1  ON 40
eH2_1                -1.076382e-01 1 1  ON 41
eH2_2                -6.485214e-02 1 1  ON 42
eH2_3                -2.665030e-02 1 1  ON 43
eH2_4                 1.826786e-02 1 1  ON 44
eH2_5                 3.061299e-02 1 1  ON 45
eH2_6                 7.644451e-02 1 1  ON 46
eH2_7                 1.122194e-01 1 1  ON 47
eH2_8                 1.050825e-01 1 1  ON 48
eH2_9                 2.975856e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3166
    reference variance = 0.362432
====================================================
  Execution time = 1.8792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4562e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654031086
                                         uncertainty =       0.007809345619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345654031086
                                         uncertainty =       0.007809345619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415704883
  error estimate for blocks of size 2^( 2) =       0.000426432728
  error estimate for blocks of size 2^( 3) =       0.000436087490
  error estimate for blocks of size 2^( 4) =       0.000442518086
  error estimate for blocks of size 2^( 5) =       0.000446459408
  error estimate for blocks of size 2^( 6) =       0.000448971725
  error estimate for blocks of size 2^( 7) =       0.000450222610

      target function =                  N/A
              le_mean =     -17.211485579510
             les_mean =     296.580856780820
             stat err =       0.000447042957
             autocorr =       1.156453732779
              std dev =       0.587895483874
             le_variance =       0.345621099959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721148557951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211485579510       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211485146104       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211485545200       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211486614761       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211486281168       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211487860568       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211487005270       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211487000588       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211487166021       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211487185537       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211487344650       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.151190e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211485579510       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211485382083       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211485463256       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211486038201       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211486143445       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211486470073       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211486258704       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211486198412       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.450326e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211485579510       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211485517385       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211485526533       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211485719276       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211485804179       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211485854306       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211485838225       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211485809067       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.946537e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4085e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.195641e-01 1 1  ON 0
 uu_1                 5.351427e-02 1 1  ON 1
 uu_2                -4.620835e-02 1 1  ON 2
 uu_3                -1.035159e-01 1 1  ON 3
 uu_4                -1.367527e-01 1 1  ON 4
 uu_5                -1.429488e-01 1 1  ON 5
 uu_6                -1.199799e-01 1 1  ON 6
 uu_7                -5.046690e-02 1 1  ON 7
 uu_8                 8.961018e-02 1 1  ON 8
 uu_9                 1.308200e-01 1 1  ON 9
 ud_0                 3.687816e-01 1 1  ON 10
 ud_1                 1.025358e-01 1 1  ON 11
 ud_2                -1.497473e-02 1 1  ON 12
 ud_3                -7.871414e-02 1 1  ON 13
 ud_4                -1.263658e-01 1 1  ON 14
 ud_5                -1.569764e-01 1 1  ON 15
 ud_6                -1.591700e-01 1 1  ON 16
 ud_7                -1.158917e-01 1 1  ON 17
 ud_8                -1.538022e-02 1 1  ON 18
 ud_9                 9.187828e-02 1 1  ON 19
 eO_0                -8.111693e-01 1 1  ON 20
 eO_1                -4.776889e-01 1 1  ON 21
 eO_2                -4.794604e-02 1 1  ON 22
 eO_3                 2.204826e-01 1 1  ON 23
 eO_4                 3.205346e-01 1 1  ON 24
 eO_5                 3.348367e-01 1 1  ON 25
 eO_6                 2.663442e-01 1 1  ON 26
 eO_7                 1.311009e-01 1 1  ON 27
 eO_8                 3.108713e-02 1 1  ON 28
 eO_9                 2.000530e-02 1 1  ON 29
eH1_0                -1.854764e-01 1 1  ON 30
eH1_1                -1.062191e-01 1 1  ON 31
eH1_2                -6.326726e-02 1 1  ON 32
eH1_3                -2.518732e-02 1 1  ON 33
eH1_4                 1.928856e-02 1 1  ON 34
eH1_5                 3.063053e-02 1 1  ON 35
eH1_6                 7.554125e-02 1 1  ON 36
eH1_7                 1.082054e-01 1 1  ON 37
eH1_8                 1.014269e-01 1 1  ON 38
eH1_9                 2.823515e-02 1 1  ON 39
eH2_0                -1.871628e-01 1 1  ON 40
eH2_1                -1.077424e-01 1 1  ON 41
eH2_2                -6.475017e-02 1 1  ON 42
eH2_3                -2.672917e-02 1 1  ON 43
eH2_4                 1.820358e-02 1 1  ON 44
eH2_5                 3.067664e-02 1 1  ON 45
eH2_6                 7.636271e-02 1 1  ON 46
eH2_7                 1.122156e-01 1 1  ON 47
eH2_8                 1.051875e-01 1 1  ON 48
eH2_9                 2.978921e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2483
    reference variance = 0.228765
====================================================
  Execution time = 1.8620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 4.3317e-01
  Total weights = 2.0000e+06
  Execution time = 1.5636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433100271308
                                         uncertainty =       0.085125626207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433100271308
                                         uncertainty =       0.085125626207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465324896
  error estimate for blocks of size 2^( 2) =       0.000474478088
  error estimate for blocks of size 2^( 3) =       0.000483358148
  error estimate for blocks of size 2^( 4) =       0.000490463580
  error estimate for blocks of size 2^( 5) =       0.000493326685
  error estimate for blocks of size 2^( 6) =       0.000496438793
  error estimate for blocks of size 2^( 7) =       0.000496986433

      target function =                  N/A
              le_mean =     -17.212113150792
             les_mean =     296.689893416183
             stat err =       0.000494303873
             autocorr =       1.128432143630
              std dev =       0.658068778344
             le_variance =       0.433054517031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433328641381
                                         uncertainty =       0.085079447979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433328641381
                                         uncertainty =       0.085079447979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465447533
  error estimate for blocks of size 2^( 2) =       0.000474591729
  error estimate for blocks of size 2^( 3) =       0.000483463454
  error estimate for blocks of size 2^( 4) =       0.000490564780
  error estimate for blocks of size 2^( 5) =       0.000493426142
  error estimate for blocks of size 2^( 6) =       0.000496537462
  error estimate for blocks of size 2^( 7) =       0.000497081360

      target function =                  N/A
              le_mean =     -17.212114454508
             les_mean =     296.690166589588
             stat err =       0.000494402436
             autocorr =       1.128287401481
              std dev =       0.658242213123
             le_variance =       0.433282811137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433330856342
                                         uncertainty =       0.085125070886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433330856342
                                         uncertainty =       0.085125070886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465448685
  error estimate for blocks of size 2^( 2) =       0.000474592997
  error estimate for blocks of size 2^( 3) =       0.000483466006
  error estimate for blocks of size 2^( 4) =       0.000490568199
  error estimate for blocks of size 2^( 5) =       0.000493430192
  error estimate for blocks of size 2^( 6) =       0.000496541008
  error estimate for blocks of size 2^( 7) =       0.000497084702

      target function =                  N/A
              le_mean =     -17.212113684728
             les_mean =     296.690142236147
             stat err =       0.000494406026
             autocorr =       1.128298198598
              std dev =       0.658243842953
             le_variance =       0.433284956786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142740201
                                         uncertainty =       0.085128395632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142740201
                                         uncertainty =       0.085128395632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465347699
  error estimate for blocks of size 2^( 2) =       0.000474499358
  error estimate for blocks of size 2^( 3) =       0.000483378281
  error estimate for blocks of size 2^( 4) =       0.000490483136
  error estimate for blocks of size 2^( 5) =       0.000493346067
  error estimate for blocks of size 2^( 6) =       0.000496457895
  error estimate for blocks of size 2^( 7) =       0.000497004965

      target function =                  N/A
              le_mean =     -17.212113086442
             les_mean =     296.689933645299
             stat err =       0.000494323016
             autocorr =       1.128408951516
              std dev =       0.658101026721
             le_variance =       0.433096961371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212113150792        initial
     1.5625e-01     1.5625e+00             1.1512e-03       -17.212114454508  <--
     6.2500e-01     6.2500e+00             3.4503e-04       -17.212113684728
     2.5000e+00     2.5000e+01             9.9465e-05       -17.212113086442

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.6513e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.195526e-01 1 1  ON 0
 uu_1                 5.354870e-02 1 1  ON 1
 uu_2                -4.627232e-02 1 1  ON 2
 uu_3                -1.035823e-01 1 1  ON 3
 uu_4                -1.368609e-01 1 1  ON 4
 uu_5                -1.430804e-01 1 1  ON 5
 uu_6                -1.201968e-01 1 1  ON 6
 uu_7                -5.045244e-02 1 1  ON 7
 uu_8                 8.950288e-02 1 1  ON 8
 uu_9                 1.311256e-01 1 1  ON 9
 ud_0                 3.690565e-01 1 1  ON 10
 ud_1                 1.027129e-01 1 1  ON 11
 ud_2                -1.486596e-02 1 1  ON 12
 ud_3                -7.870312e-02 1 1  ON 13
 ud_4                -1.263674e-01 1 1  ON 14
 ud_5                -1.568823e-01 1 1  ON 15
 ud_6                -1.593870e-01 1 1  ON 16
 ud_7                -1.163190e-01 1 1  ON 17
 ud_8                -1.574096e-02 1 1  ON 18
 ud_9                 9.188782e-02 1 1  ON 19
 eO_0                -8.119849e-01 1 1  ON 20
 eO_1                -4.784950e-01 1 1  ON 21
 eO_2                -4.832617e-02 1 1  ON 22
 eO_3                 2.202689e-01 1 1  ON 23
 eO_4                 3.206554e-01 1 1  ON 24
 eO_5                 3.356416e-01 1 1  ON 25
 eO_6                 2.668628e-01 1 1  ON 26
 eO_7                 1.316651e-01 1 1  ON 27
 eO_8                 3.121488e-02 1 1  ON 28
 eO_9                 2.005153e-02 1 1  ON 29
eH1_0                -1.854501e-01 1 1  ON 30
eH1_1                -1.062493e-01 1 1  ON 31
eH1_2                -6.326675e-02 1 1  ON 32
eH1_3                -2.500690e-02 1 1  ON 33
eH1_4                 1.939738e-02 1 1  ON 34
eH1_5                 3.020936e-02 1 1  ON 35
eH1_6                 7.525222e-02 1 1  ON 36
eH1_7                 1.081508e-01 1 1  ON 37
eH1_8                 1.017554e-01 1 1  ON 38
eH1_9                 2.835694e-02 1 1  ON 39
eH2_0                -1.871954e-01 1 1  ON 40
eH2_1                -1.078824e-01 1 1  ON 41
eH2_2                -6.467951e-02 1 1  ON 42
eH2_3                -2.680450e-02 1 1  ON 43
eH2_4                 1.805860e-02 1 1  ON 44
eH2_5                 3.076754e-02 1 1  ON 45
eH2_6                 7.612227e-02 1 1  ON 46
eH2_7                 1.122151e-01 1 1  ON 47
eH2_8                 1.055146e-01 1 1  ON 48
eH2_9                 2.988418e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0603e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2144
    reference variance = 0.266541
====================================================
  Execution time = 1.9075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4798e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348098930617
                                         uncertainty =       0.004298696532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348098930617
                                         uncertainty =       0.004298696532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417123744
  error estimate for blocks of size 2^( 2) =       0.000427709347
  error estimate for blocks of size 2^( 3) =       0.000437255134
  error estimate for blocks of size 2^( 4) =       0.000443755132
  error estimate for blocks of size 2^( 5) =       0.000447167404
  error estimate for blocks of size 2^( 6) =       0.000447051389
  error estimate for blocks of size 2^( 7) =       0.000448765465

      target function =                  N/A
              le_mean =     -17.212208688855
             les_mean =     296.608112210137
             stat err =       0.000446684847
             autocorr =       1.146760214250
              std dev =       0.589902055806
             le_variance =       0.347984435444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220868885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212208688855       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212207215936       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212209365313       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212209972877       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212208811607       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212206089708       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212205933918       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212207941946       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212210252861       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212210302371       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212210081683       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212210011226       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 3.701710e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212208688855       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212207537483       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212208886987       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212209401241       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212208794367       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212207942075       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212207288080       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212208122000       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212208746943       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212208728844       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.135620e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212208688855       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212208074208       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212208582471       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212208838549       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212208671089       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212208539353       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212208212328       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212208434331       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.464291e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4381e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.194195e-01 1 1  ON 0
 uu_1                 5.352188e-02 1 1  ON 1
 uu_2                -4.612477e-02 1 1  ON 2
 uu_3                -1.034895e-01 1 1  ON 3
 uu_4                -1.368057e-01 1 1  ON 4
 uu_5                -1.429647e-01 1 1  ON 5
 uu_6                -1.205551e-01 1 1  ON 6
 uu_7                -5.076041e-02 1 1  ON 7
 uu_8                 8.908008e-02 1 1  ON 8
 uu_9                 1.313842e-01 1 1  ON 9
 ud_0                 3.691241e-01 1 1  ON 10
 ud_1                 1.029208e-01 1 1  ON 11
 ud_2                -1.476484e-02 1 1  ON 12
 ud_3                -7.860826e-02 1 1  ON 13
 ud_4                -1.265969e-01 1 1  ON 14
 ud_5                -1.568617e-01 1 1  ON 15
 ud_6                -1.593652e-01 1 1  ON 16
 ud_7                -1.164665e-01 1 1  ON 17
 ud_8                -1.630118e-02 1 1  ON 18
 ud_9                 9.182325e-02 1 1  ON 19
 eO_0                -8.131205e-01 1 1  ON 20
 eO_1                -4.791139e-01 1 1  ON 21
 eO_2                -4.909518e-02 1 1  ON 22
 eO_3                 2.202220e-01 1 1  ON 23
 eO_4                 3.208853e-01 1 1  ON 24
 eO_5                 3.362261e-01 1 1  ON 25
 eO_6                 2.675600e-01 1 1  ON 26
 eO_7                 1.324914e-01 1 1  ON 27
 eO_8                 3.135015e-02 1 1  ON 28
 eO_9                 2.007111e-02 1 1  ON 29
eH1_0                -1.857639e-01 1 1  ON 30
eH1_1                -1.064273e-01 1 1  ON 31
eH1_2                -6.313339e-02 1 1  ON 32
eH1_3                -2.517262e-02 1 1  ON 33
eH1_4                 1.932026e-02 1 1  ON 34
eH1_5                 3.022336e-02 1 1  ON 35
eH1_6                 7.522485e-02 1 1  ON 36
eH1_7                 1.081159e-01 1 1  ON 37
eH1_8                 1.022116e-01 1 1  ON 38
eH1_9                 2.851211e-02 1 1  ON 39
eH2_0                -1.875068e-01 1 1  ON 40
eH2_1                -1.076430e-01 1 1  ON 41
eH2_2                -6.470770e-02 1 1  ON 42
eH2_3                -2.671676e-02 1 1  ON 43
eH2_4                 1.812003e-02 1 1  ON 44
eH2_5                 3.063681e-02 1 1  ON 45
eH2_6                 7.579790e-02 1 1  ON 46
eH2_7                 1.120047e-01 1 1  ON 47
eH2_8                 1.059345e-01 1 1  ON 48
eH2_9                 3.001957e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2459
    reference variance = 0.340491
====================================================
  Execution time = 1.8779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4554e-01
  Total weights = 2.0000e+06
  Execution time = 1.5623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345805078450
                                         uncertainty =       0.005578408244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345805078450
                                         uncertainty =       0.005578408244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415754039
  error estimate for blocks of size 2^( 2) =       0.000426721027
  error estimate for blocks of size 2^( 3) =       0.000435984164
  error estimate for blocks of size 2^( 4) =       0.000443228522
  error estimate for blocks of size 2^( 5) =       0.000446081146
  error estimate for blocks of size 2^( 6) =       0.000448934883
  error estimate for blocks of size 2^( 7) =       0.000449884523

      target function =                  N/A
              le_mean =     -17.212442096300
             les_mean =     296.613865588142
             stat err =       0.000447032268
             autocorr =       1.156124996974
              std dev =       0.587965001095
             le_variance =       0.345702842513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345730032705
                                         uncertainty =       0.005576456360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345730032705
                                         uncertainty =       0.005576456360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415708921
  error estimate for blocks of size 2^( 2) =       0.000426677080
  error estimate for blocks of size 2^( 3) =       0.000435938689
  error estimate for blocks of size 2^( 4) =       0.000443181230
  error estimate for blocks of size 2^( 5) =       0.000446026457
  error estimate for blocks of size 2^( 6) =       0.000448875661
  error estimate for blocks of size 2^( 7) =       0.000449811394

      target function =                  N/A
              le_mean =     -17.212441294658
             les_mean =     296.613762962567
             stat err =       0.000446973685
             autocorr =       1.156072906807
              std dev =       0.587901193525
             le_variance =       0.345627813348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345486787823
                                         uncertainty =       0.005577123678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345486787823
                                         uncertainty =       0.005577123678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415562666
  error estimate for blocks of size 2^( 2) =       0.000426536436
  error estimate for blocks of size 2^( 3) =       0.000435806053
  error estimate for blocks of size 2^( 4) =       0.000443054605
  error estimate for blocks of size 2^( 5) =       0.000445902553
  error estimate for blocks of size 2^( 6) =       0.000448747900
  error estimate for blocks of size 2^( 7) =       0.000449678032

      target function =                  N/A
              le_mean =     -17.212441680291
             les_mean =     296.613533082889
             stat err =       0.000446845772
             autocorr =       1.156224744742
              std dev =       0.587694357789
             le_variance =       0.345384658177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345692636161
                                         uncertainty =       0.005577797642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345692636161
                                         uncertainty =       0.005577797642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415686445
  error estimate for blocks of size 2^( 2) =       0.000426655772
  error estimate for blocks of size 2^( 3) =       0.000435921318
  error estimate for blocks of size 2^( 4) =       0.000443167352
  error estimate for blocks of size 2^( 5) =       0.000446018926
  error estimate for blocks of size 2^( 6) =       0.000448870137
  error estimate for blocks of size 2^( 7) =       0.000449814566

      target function =                  N/A
              le_mean =     -17.212441700171
             les_mean =     296.613739549409
             stat err =       0.000446967745
             autocorr =       1.156167196746
              std dev =       0.587869407629
             le_variance =       0.345590440426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212442096300        initial  <--
     3.9062e-02     3.9062e-01             3.7017e-03       -17.212441294658
     1.5625e-01     1.5625e+00             1.1356e-03       -17.212441680291
     6.2500e-01     6.2500e+00             3.4643e-04       -17.212441700171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.6727
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.195526e-01 1 1  ON 0
 uu_1                 5.354870e-02 1 1  ON 1
 uu_2                -4.627232e-02 1 1  ON 2
 uu_3                -1.035823e-01 1 1  ON 3
 uu_4                -1.368609e-01 1 1  ON 4
 uu_5                -1.430804e-01 1 1  ON 5
 uu_6                -1.201968e-01 1 1  ON 6
 uu_7                -5.045244e-02 1 1  ON 7
 uu_8                 8.950288e-02 1 1  ON 8
 uu_9                 1.311256e-01 1 1  ON 9
 ud_0                 3.690565e-01 1 1  ON 10
 ud_1                 1.027129e-01 1 1  ON 11
 ud_2                -1.486596e-02 1 1  ON 12
 ud_3                -7.870312e-02 1 1  ON 13
 ud_4                -1.263674e-01 1 1  ON 14
 ud_5                -1.568823e-01 1 1  ON 15
 ud_6                -1.593870e-01 1 1  ON 16
 ud_7                -1.163190e-01 1 1  ON 17
 ud_8                -1.574096e-02 1 1  ON 18
 ud_9                 9.188782e-02 1 1  ON 19
 eO_0                -8.119849e-01 1 1  ON 20
 eO_1                -4.784950e-01 1 1  ON 21
 eO_2                -4.832617e-02 1 1  ON 22
 eO_3                 2.202689e-01 1 1  ON 23
 eO_4                 3.206554e-01 1 1  ON 24
 eO_5                 3.356416e-01 1 1  ON 25
 eO_6                 2.668628e-01 1 1  ON 26
 eO_7                 1.316651e-01 1 1  ON 27
 eO_8                 3.121488e-02 1 1  ON 28
 eO_9                 2.005153e-02 1 1  ON 29
eH1_0                -1.854501e-01 1 1  ON 30
eH1_1                -1.062493e-01 1 1  ON 31
eH1_2                -6.326675e-02 1 1  ON 32
eH1_3                -2.500690e-02 1 1  ON 33
eH1_4                 1.939738e-02 1 1  ON 34
eH1_5                 3.020936e-02 1 1  ON 35
eH1_6                 7.525222e-02 1 1  ON 36
eH1_7                 1.081508e-01 1 1  ON 37
eH1_8                 1.017554e-01 1 1  ON 38
eH1_9                 2.835694e-02 1 1  ON 39
eH2_0                -1.871954e-01 1 1  ON 40
eH2_1                -1.078824e-01 1 1  ON 41
eH2_2                -6.467951e-02 1 1  ON 42
eH2_3                -2.680450e-02 1 1  ON 43
eH2_4                 1.805860e-02 1 1  ON 44
eH2_5                 3.076754e-02 1 1  ON 45
eH2_6                 7.612227e-02 1 1  ON 46
eH2_7                 1.122151e-01 1 1  ON 47
eH2_8                 1.055146e-01 1 1  ON 48
eH2_9                 2.988418e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2767
    reference variance = 0.295891
====================================================
  Execution time = 1.9248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4195e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341910217338
                                         uncertainty =       0.003155150195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341910217338
                                         uncertainty =       0.003155150195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413488375
  error estimate for blocks of size 2^( 2) =       0.000423978671
  error estimate for blocks of size 2^( 3) =       0.000433312092
  error estimate for blocks of size 2^( 4) =       0.000439971889
  error estimate for blocks of size 2^( 5) =       0.000443736718
  error estimate for blocks of size 2^( 6) =       0.000445889212
  error estimate for blocks of size 2^( 7) =       0.000446772586

      target function =                  N/A
              le_mean =     -17.211752202312
             les_mean =     296.586358974993
             stat err =       0.000444092601
             autocorr =       1.153507618897
              std dev =       0.584760867509
             le_variance =       0.341945272170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721175220231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211752202312       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211752558455       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211752630573       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211752736523       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211753082948       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211752940847       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211753031215       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211752843501       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211752966970       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.687414e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211752202312       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211752322354       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211752360086       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211752435550       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211752508226       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211752466178       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211752475441       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211752444422       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.695957e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211752202312       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211752235185       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211752247327       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211752277580       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211752286761       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211752275820       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211752277260       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.535419e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4531e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.195501e-01 1 1  ON 0
 uu_1                 5.356098e-02 1 1  ON 1
 uu_2                -4.625206e-02 1 1  ON 2
 uu_3                -1.035695e-01 1 1  ON 3
 uu_4                -1.368794e-01 1 1  ON 4
 uu_5                -1.430851e-01 1 1  ON 5
 uu_6                -1.202155e-01 1 1  ON 6
 uu_7                -5.049843e-02 1 1  ON 7
 uu_8                 8.947625e-02 1 1  ON 8
 uu_9                 1.311577e-01 1 1  ON 9
 ud_0                 3.690623e-01 1 1  ON 10
 ud_1                 1.027168e-01 1 1  ON 11
 ud_2                -1.485661e-02 1 1  ON 12
 ud_3                -7.872816e-02 1 1  ON 13
 ud_4                -1.263795e-01 1 1  ON 14
 ud_5                -1.569103e-01 1 1  ON 15
 ud_6                -1.593709e-01 1 1  ON 16
 ud_7                -1.162955e-01 1 1  ON 17
 ud_8                -1.577016e-02 1 1  ON 18
 ud_9                 9.188676e-02 1 1  ON 19
 eO_0                -8.121545e-01 1 1  ON 20
 eO_1                -4.785251e-01 1 1  ON 21
 eO_2                -4.839445e-02 1 1  ON 22
 eO_3                 2.202172e-01 1 1  ON 23
 eO_4                 3.207131e-01 1 1  ON 24
 eO_5                 3.357225e-01 1 1  ON 25
 eO_6                 2.669397e-01 1 1  ON 26
 eO_7                 1.317483e-01 1 1  ON 27
 eO_8                 3.123002e-02 1 1  ON 28
 eO_9                 2.005446e-02 1 1  ON 29
eH1_0                -1.855172e-01 1 1  ON 30
eH1_1                -1.062649e-01 1 1  ON 31
eH1_2                -6.329453e-02 1 1  ON 32
eH1_3                -2.504287e-02 1 1  ON 33
eH1_4                 1.935806e-02 1 1  ON 34
eH1_5                 3.030563e-02 1 1  ON 35
eH1_6                 7.526446e-02 1 1  ON 36
eH1_7                 1.081611e-01 1 1  ON 37
eH1_8                 1.018028e-01 1 1  ON 38
eH1_9                 2.837378e-02 1 1  ON 39
eH2_0                -1.872207e-01 1 1  ON 40
eH2_1                -1.078395e-01 1 1  ON 41
eH2_2                -6.472928e-02 1 1  ON 42
eH2_3                -2.683793e-02 1 1  ON 43
eH2_4                 1.808029e-02 1 1  ON 44
eH2_5                 3.077109e-02 1 1  ON 45
eH2_6                 7.613341e-02 1 1  ON 46
eH2_7                 1.121957e-01 1 1  ON 47
eH2_8                 1.055479e-01 1 1  ON 48
eH2_9                 2.989553e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1613
    reference variance = 0.234545
====================================================
  Execution time = 1.8715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4723e-01
  Total weights = 2.0000e+06
  Execution time = 1.5606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347313915845
                                         uncertainty =       0.004870663247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347313915845
                                         uncertainty =       0.004870663247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416669162
  error estimate for blocks of size 2^( 2) =       0.000427286844
  error estimate for blocks of size 2^( 3) =       0.000436924775
  error estimate for blocks of size 2^( 4) =       0.000443716910
  error estimate for blocks of size 2^( 5) =       0.000448061855
  error estimate for blocks of size 2^( 6) =       0.000449500638
  error estimate for blocks of size 2^( 7) =       0.000450834234

      target function =                  N/A
              le_mean =     -17.212340672569
             les_mean =     296.611897636091
             stat err =       0.000448028409
             autocorr =       1.156187815534
              std dev =       0.589259179915
             le_variance =       0.347226381114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347365321340
                                         uncertainty =       0.004870829748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347365321340
                                         uncertainty =       0.004870829748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416699993
  error estimate for blocks of size 2^( 2) =       0.000427317234
  error estimate for blocks of size 2^( 3) =       0.000436951686
  error estimate for blocks of size 2^( 4) =       0.000443740899
  error estimate for blocks of size 2^( 5) =       0.000448078201
  error estimate for blocks of size 2^( 6) =       0.000449514294
  error estimate for blocks of size 2^( 7) =       0.000450845058

      target function =                  N/A
              le_mean =     -17.212341116710
             les_mean =     296.611964312033
             stat err =       0.000448044613
             autocorr =       1.156100355110
              std dev =       0.589302781001
             le_variance =       0.347277767695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347331521276
                                         uncertainty =       0.004870417950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347331521276
                                         uncertainty =       0.004870417950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416679710
  error estimate for blocks of size 2^( 2) =       0.000427297623
  error estimate for blocks of size 2^( 3) =       0.000436933681
  error estimate for blocks of size 2^( 4) =       0.000443724307
  error estimate for blocks of size 2^( 5) =       0.000448063822
  error estimate for blocks of size 2^( 6) =       0.000449500438
  error estimate for blocks of size 2^( 7) =       0.000450832032

      target function =                  N/A
              le_mean =     -17.212341042750
             les_mean =     296.611927958937
             stat err =       0.000448030150
             autocorr =       1.156138265207
              std dev =       0.589274096350
             le_variance =       0.347243960629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347314920456
                                         uncertainty =       0.004870584346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347314920456
                                         uncertainty =       0.004870584346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416669762
  error estimate for blocks of size 2^( 2) =       0.000427287527
  error estimate for blocks of size 2^( 3) =       0.000436925219
  error estimate for blocks of size 2^( 4) =       0.000443717181
  error estimate for blocks of size 2^( 5) =       0.000448061331
  error estimate for blocks of size 2^( 6) =       0.000449499772
  error estimate for blocks of size 2^( 7) =       0.000450833099

      target function =                  N/A
              le_mean =     -17.212340714535
             les_mean =     296.611900080042
             stat err =       0.000448027846
             autocorr =       1.156181579096
              std dev =       0.589260027859
             le_variance =       0.347227380433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212340672569        initial
     3.9062e-01     3.9062e+00             5.6874e-04       -17.212341116710  <--
     1.5625e+00     1.5625e+01             1.6960e-04       -17.212341042750
     6.2500e+00     6.2500e+01             4.5354e-05       -17.212340714535

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.6601e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.195818e-01 1 1  ON 0
 uu_1                 5.360578e-02 1 1  ON 1
 uu_2                -4.621572e-02 1 1  ON 2
 uu_3                -1.035362e-01 1 1  ON 3
 uu_4                -1.369166e-01 1 1  ON 4
 uu_5                -1.431316e-01 1 1  ON 5
 uu_6                -1.202774e-01 1 1  ON 6
 uu_7                -5.063142e-02 1 1  ON 7
 uu_8                 8.939873e-02 1 1  ON 8
 uu_9                 1.312516e-01 1 1  ON 9
 ud_0                 3.690923e-01 1 1  ON 10
 ud_1                 1.027394e-01 1 1  ON 11
 ud_2                -1.484592e-02 1 1  ON 12
 ud_3                -7.877633e-02 1 1  ON 13
 ud_4                -1.264308e-01 1 1  ON 14
 ud_5                -1.569995e-01 1 1  ON 15
 ud_6                -1.593356e-01 1 1  ON 16
 ud_7                -1.162265e-01 1 1  ON 17
 ud_8                -1.585397e-02 1 1  ON 18
 ud_9                 9.188389e-02 1 1  ON 19
 eO_0                -8.125537e-01 1 1  ON 20
 eO_1                -4.787123e-01 1 1  ON 21
 eO_2                -4.856919e-02 1 1  ON 22
 eO_3                 2.200628e-01 1 1  ON 23
 eO_4                 3.208582e-01 1 1  ON 24
 eO_5                 3.359602e-01 1 1  ON 25
 eO_6                 2.671666e-01 1 1  ON 26
 eO_7                 1.319925e-01 1 1  ON 27
 eO_8                 3.127443e-02 1 1  ON 28
 eO_9                 2.006304e-02 1 1  ON 29
eH1_0                -1.856993e-01 1 1  ON 30
eH1_1                -1.063279e-01 1 1  ON 31
eH1_2                -6.337706e-02 1 1  ON 32
eH1_3                -2.513768e-02 1 1  ON 33
eH1_4                 1.925903e-02 1 1  ON 34
eH1_5                 3.056192e-02 1 1  ON 35
eH1_6                 7.530134e-02 1 1  ON 36
eH1_7                 1.081930e-01 1 1  ON 37
eH1_8                 1.019417e-01 1 1  ON 38
eH1_9                 2.842312e-02 1 1  ON 39
eH2_0                -1.872784e-01 1 1  ON 40
eH2_1                -1.077839e-01 1 1  ON 41
eH2_2                -6.482997e-02 1 1  ON 42
eH2_3                -2.691785e-02 1 1  ON 43
eH2_4                 1.812927e-02 1 1  ON 44
eH2_5                 3.078467e-02 1 1  ON 45
eH2_6                 7.616696e-02 1 1  ON 46
eH2_7                 1.121396e-01 1 1  ON 47
eH2_8                 1.056454e-01 1 1  ON 48
eH2_9                 2.992879e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1374
    reference variance = 0.252662
====================================================
  Execution time = 1.9120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4021e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340287493675
                                         uncertainty =       0.003271653806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340287493675
                                         uncertainty =       0.003271653806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412438151
  error estimate for blocks of size 2^( 2) =       0.000423289746
  error estimate for blocks of size 2^( 3) =       0.000432813101
  error estimate for blocks of size 2^( 4) =       0.000439928621
  error estimate for blocks of size 2^( 5) =       0.000444593239
  error estimate for blocks of size 2^( 6) =       0.000446458152
  error estimate for blocks of size 2^( 7) =       0.000445879721

      target function =                  N/A
              le_mean =     -17.211920032153
             les_mean =     296.590401480633
             stat err =       0.000444214933
             autocorr =       1.160028461931
              std dev =       0.583275627398
             le_variance =       0.340210457517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721192003215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211920032153       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211920515199       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211922882868       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211924848244       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211926553310       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211926240130       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211927196112       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211925707238       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211924762784       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211925315518       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211925513539       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.552394e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211920032153       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211920257958       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211921453065       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211922259300       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211923225854       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211922879824       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211922653681       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211922617666       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211922547985       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.909954e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211920032153       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211920104291       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211920514781       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211920726978       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211921082424       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211920973664       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211920856297       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 9.369673e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4464e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.194433e-01 1 1  ON 0
 uu_1                 5.348376e-02 1 1  ON 1
 uu_2                -4.621757e-02 1 1  ON 2
 uu_3                -1.034875e-01 1 1  ON 3
 uu_4                -1.367305e-01 1 1  ON 4
 uu_5                -1.429746e-01 1 1  ON 5
 uu_6                -1.203044e-01 1 1  ON 6
 uu_7                -5.084233e-02 1 1  ON 7
 uu_8                 8.920996e-02 1 1  ON 8
 uu_9                 1.313552e-01 1 1  ON 9
 ud_0                 3.692298e-01 1 1  ON 10
 ud_1                 1.028690e-01 1 1  ON 11
 ud_2                -1.477710e-02 1 1  ON 12
 ud_3                -7.871552e-02 1 1  ON 13
 ud_4                -1.264724e-01 1 1  ON 14
 ud_5                -1.571009e-01 1 1  ON 15
 ud_6                -1.595002e-01 1 1  ON 16
 ud_7                -1.162350e-01 1 1  ON 17
 ud_8                -1.604936e-02 1 1  ON 18
 ud_9                 9.186316e-02 1 1  ON 19
 eO_0                -8.128568e-01 1 1  ON 20
 eO_1                -4.790645e-01 1 1  ON 21
 eO_2                -4.888017e-02 1 1  ON 22
 eO_3                 2.199742e-01 1 1  ON 23
 eO_4                 3.209590e-01 1 1  ON 24
 eO_5                 3.361245e-01 1 1  ON 25
 eO_6                 2.675576e-01 1 1  ON 26
 eO_7                 1.323204e-01 1 1  ON 27
 eO_8                 3.131304e-02 1 1  ON 28
 eO_9                 2.007929e-02 1 1  ON 29
eH1_0                -1.856449e-01 1 1  ON 30
eH1_1                -1.062723e-01 1 1  ON 31
eH1_2                -6.326265e-02 1 1  ON 32
eH1_3                -2.533237e-02 1 1  ON 33
eH1_4                 1.905706e-02 1 1  ON 34
eH1_5                 3.054554e-02 1 1  ON 35
eH1_6                 7.522142e-02 1 1  ON 36
eH1_7                 1.081952e-01 1 1  ON 37
eH1_8                 1.021389e-01 1 1  ON 38
eH1_9                 2.847425e-02 1 1  ON 39
eH2_0                -1.871948e-01 1 1  ON 40
eH2_1                -1.078685e-01 1 1  ON 41
eH2_2                -6.473612e-02 1 1  ON 42
eH2_3                -2.687849e-02 1 1  ON 43
eH2_4                 1.802775e-02 1 1  ON 44
eH2_5                 3.076901e-02 1 1  ON 45
eH2_6                 7.600690e-02 1 1  ON 46
eH2_7                 1.120561e-01 1 1  ON 47
eH2_8                 1.058109e-01 1 1  ON 48
eH2_9                 2.998741e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2082
    reference variance = 0.240444
====================================================
  Execution time = 2.0874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4408e-01
  Total weights = 2.0000e+06
  Execution time = 1.5685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235919783
                                         uncertainty =       0.006404546357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235919783
                                         uncertainty =       0.006404546357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414809524
  error estimate for blocks of size 2^( 2) =       0.000425070759
  error estimate for blocks of size 2^( 3) =       0.000434583073
  error estimate for blocks of size 2^( 4) =       0.000441433182
  error estimate for blocks of size 2^( 5) =       0.000447479826
  error estimate for blocks of size 2^( 6) =       0.000449310041
  error estimate for blocks of size 2^( 7) =       0.000449718672

      target function =                  N/A
              le_mean =     -17.210817374856
             les_mean =     296.556368420943
             stat err =       0.000446985430
             autocorr =       1.161152590825
              std dev =       0.586629254606
             le_variance =       0.344133882360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344154093369
                                         uncertainty =       0.006398316612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344154093369
                                         uncertainty =       0.006398316612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414760236
  error estimate for blocks of size 2^( 2) =       0.000425023294
  error estimate for blocks of size 2^( 3) =       0.000434537450
  error estimate for blocks of size 2^( 4) =       0.000441390201
  error estimate for blocks of size 2^( 5) =       0.000447436653
  error estimate for blocks of size 2^( 6) =       0.000449268198
  error estimate for blocks of size 2^( 7) =       0.000449668113

      target function =                  N/A
              le_mean =     -17.210820676075
             les_mean =     296.556400278275
             stat err =       0.000446940791
             autocorr =       1.161196616314
              std dev =       0.586559550509
             le_variance =       0.344052106294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344125371932
                                         uncertainty =       0.006398458296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344125371932
                                         uncertainty =       0.006398458296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414742946
  error estimate for blocks of size 2^( 2) =       0.000425006376
  error estimate for blocks of size 2^( 3) =       0.000434522010
  error estimate for blocks of size 2^( 4) =       0.000441375959
  error estimate for blocks of size 2^( 5) =       0.000447423037
  error estimate for blocks of size 2^( 6) =       0.000449257617
  error estimate for blocks of size 2^( 7) =       0.000449662468

      target function =                  N/A
              le_mean =     -17.210821420211
             les_mean =     296.556397209453
             stat err =       0.000446929770
             autocorr =       1.161236161733
              std dev =       0.586535099618
             le_variance =       0.344023423084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344220652358
                                         uncertainty =       0.006403222996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344220652358
                                         uncertainty =       0.006403222996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414800334
  error estimate for blocks of size 2^( 2) =       0.000425061710
  error estimate for blocks of size 2^( 3) =       0.000434574368
  error estimate for blocks of size 2^( 4) =       0.000441425024
  error estimate for blocks of size 2^( 5) =       0.000447471814
  error estimate for blocks of size 2^( 6) =       0.000449302997
  error estimate for blocks of size 2^( 7) =       0.000449710898

      target function =                  N/A
              le_mean =     -17.210817940740
             les_mean =     296.556372651570
             stat err =       0.000446977683
             autocorr =       1.161163793378
              std dev =       0.586616258164
             le_variance =       0.344118634342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210817374856        initial
     9.7656e-02     9.7656e-01             1.5524e-03       -17.210820676075
     3.9062e-01     3.9062e+00             3.9100e-04       -17.210821420211  <--
     1.5625e+00     1.5625e+01             9.3697e-05       -17.210817940740

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.8793e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.194433e-01 1 1  ON 0
 uu_1                 5.348376e-02 1 1  ON 1
 uu_2                -4.621757e-02 1 1  ON 2
 uu_3                -1.034875e-01 1 1  ON 3
 uu_4                -1.367305e-01 1 1  ON 4
 uu_5                -1.429746e-01 1 1  ON 5
 uu_6                -1.203044e-01 1 1  ON 6
 uu_7                -5.084233e-02 1 1  ON 7
 uu_8                 8.920996e-02 1 1  ON 8
 uu_9                 1.313552e-01 1 1  ON 9
 ud_0                 3.692298e-01 1 1  ON 10
 ud_1                 1.028690e-01 1 1  ON 11
 ud_2                -1.477710e-02 1 1  ON 12
 ud_3                -7.871552e-02 1 1  ON 13
 ud_4                -1.264724e-01 1 1  ON 14
 ud_5                -1.571009e-01 1 1  ON 15
 ud_6                -1.595002e-01 1 1  ON 16
 ud_7                -1.162350e-01 1 1  ON 17
 ud_8                -1.604936e-02 1 1  ON 18
 ud_9                 9.186316e-02 1 1  ON 19
 eO_0                -8.128568e-01 1 1  ON 20
 eO_1                -4.790645e-01 1 1  ON 21
 eO_2                -4.888017e-02 1 1  ON 22
 eO_3                 2.199742e-01 1 1  ON 23
 eO_4                 3.209590e-01 1 1  ON 24
 eO_5                 3.361245e-01 1 1  ON 25
 eO_6                 2.675576e-01 1 1  ON 26
 eO_7                 1.323204e-01 1 1  ON 27
 eO_8                 3.131304e-02 1 1  ON 28
 eO_9                 2.007929e-02 1 1  ON 29
eH1_0                -1.856449e-01 1 1  ON 30
eH1_1                -1.062723e-01 1 1  ON 31
eH1_2                -6.326265e-02 1 1  ON 32
eH1_3                -2.533237e-02 1 1  ON 33
eH1_4                 1.905706e-02 1 1  ON 34
eH1_5                 3.054554e-02 1 1  ON 35
eH1_6                 7.522142e-02 1 1  ON 36
eH1_7                 1.081952e-01 1 1  ON 37
eH1_8                 1.021389e-01 1 1  ON 38
eH1_9                 2.847425e-02 1 1  ON 39
eH2_0                -1.871948e-01 1 1  ON 40
eH2_1                -1.078685e-01 1 1  ON 41
eH2_2                -6.473612e-02 1 1  ON 42
eH2_3                -2.687849e-02 1 1  ON 43
eH2_4                 1.802775e-02 1 1  ON 44
eH2_5                 3.076901e-02 1 1  ON 45
eH2_6                 7.600690e-02 1 1  ON 46
eH2_7                 1.120561e-01 1 1  ON 47
eH2_8                 1.058109e-01 1 1  ON 48
eH2_9                 2.998741e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3263e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2149
    reference variance = 0.35408
====================================================
  Execution time = 1.9600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331072896107
                                         uncertainty =       0.002530456579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331072896107
                                         uncertainty =       0.002530456579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406882500
  error estimate for blocks of size 2^( 2) =       0.000417911356
  error estimate for blocks of size 2^( 3) =       0.000427437977
  error estimate for blocks of size 2^( 4) =       0.000434992224
  error estimate for blocks of size 2^( 5) =       0.000441267966
  error estimate for blocks of size 2^( 6) =       0.000444136525
  error estimate for blocks of size 2^( 7) =       0.000446132038

      target function =                  N/A
              le_mean =     -17.211468902353
             les_mean =     296.565768348037
             stat err =       0.000441632188
             autocorr =       1.178103419533
              std dev =       0.575418749199
             le_variance =       0.331106736930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721146890235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211468902353       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211468477805       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211468853471       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211468824899       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211469780277       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211469755392       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211473075202       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211472182062       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211471730193       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211471558090       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211471425415       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.047983e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211468902353       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211468704890       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211468723053       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211468480417       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211469118135       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211469077128       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211469874319       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211469500682       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211469495145       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.054742e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211468902353       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211468839458       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211468806789       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211468673434       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211468913423       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211468931271       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211469021942       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.580383e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4926e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.195596e-01 1 1  ON 0
 uu_1                 5.350044e-02 1 1  ON 1
 uu_2                -4.625672e-02 1 1  ON 2
 uu_3                -1.035860e-01 1 1  ON 3
 uu_4                -1.368979e-01 1 1  ON 4
 uu_5                -1.431850e-01 1 1  ON 5
 uu_6                -1.202398e-01 1 1  ON 6
 uu_7                -5.080308e-02 1 1  ON 7
 uu_8                 8.909559e-02 1 1  ON 8
 uu_9                 1.315106e-01 1 1  ON 9
 ud_0                 3.693858e-01 1 1  ON 10
 ud_1                 1.028868e-01 1 1  ON 11
 ud_2                -1.486292e-02 1 1  ON 12
 ud_3                -7.888774e-02 1 1  ON 13
 ud_4                -1.265268e-01 1 1  ON 14
 ud_5                -1.571989e-01 1 1  ON 15
 ud_6                -1.595189e-01 1 1  ON 16
 ud_7                -1.161728e-01 1 1  ON 17
 ud_8                -1.611184e-02 1 1  ON 18
 ud_9                 9.189415e-02 1 1  ON 19
 eO_0                -8.134622e-01 1 1  ON 20
 eO_1                -4.794974e-01 1 1  ON 21
 eO_2                -4.900272e-02 1 1  ON 22
 eO_3                 2.200813e-01 1 1  ON 23
 eO_4                 3.208912e-01 1 1  ON 24
 eO_5                 3.363892e-01 1 1  ON 25
 eO_6                 2.679273e-01 1 1  ON 26
 eO_7                 1.326678e-01 1 1  ON 27
 eO_8                 3.138513e-02 1 1  ON 28
 eO_9                 2.011124e-02 1 1  ON 29
eH1_0                -1.857693e-01 1 1  ON 30
eH1_1                -1.063550e-01 1 1  ON 31
eH1_2                -6.338463e-02 1 1  ON 32
eH1_3                -2.532225e-02 1 1  ON 33
eH1_4                 1.916145e-02 1 1  ON 34
eH1_5                 3.046736e-02 1 1  ON 35
eH1_6                 7.520414e-02 1 1  ON 36
eH1_7                 1.082340e-01 1 1  ON 37
eH1_8                 1.023314e-01 1 1  ON 38
eH1_9                 2.852370e-02 1 1  ON 39
eH2_0                -1.872268e-01 1 1  ON 40
eH2_1                -1.078468e-01 1 1  ON 41
eH2_2                -6.495048e-02 1 1  ON 42
eH2_3                -2.701397e-02 1 1  ON 43
eH2_4                 1.799542e-02 1 1  ON 44
eH2_5                 3.090412e-02 1 1  ON 45
eH2_6                 7.598679e-02 1 1  ON 46
eH2_7                 1.120244e-01 1 1  ON 47
eH2_8                 1.060028e-01 1 1  ON 48
eH2_9                 3.006152e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1561
    reference variance = 0.129775
====================================================
  Execution time = 1.8739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4199e-01
  Total weights = 2.0000e+06
  Execution time = 1.5691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341801672919
                                         uncertainty =       0.002585597405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341801672919
                                         uncertainty =       0.002585597405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413344904
  error estimate for blocks of size 2^( 2) =       0.000424571158
  error estimate for blocks of size 2^( 3) =       0.000434682067
  error estimate for blocks of size 2^( 4) =       0.000442130166
  error estimate for blocks of size 2^( 5) =       0.000446793798
  error estimate for blocks of size 2^( 6) =       0.000448528706
  error estimate for blocks of size 2^( 7) =       0.000448020979

      target function =                  N/A
              le_mean =     -17.212256911316
             les_mean =     296.603495830140
             stat err =       0.000446368412
             autocorr =       1.166169641652
              std dev =       0.584557969633
             le_variance =       0.341708019861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342387577715
                                         uncertainty =       0.002588633792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342387577715
                                         uncertainty =       0.002588633792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413698971
  error estimate for blocks of size 2^( 2) =       0.000424912208
  error estimate for blocks of size 2^( 3) =       0.000435003156
  error estimate for blocks of size 2^( 4) =       0.000442434199
  error estimate for blocks of size 2^( 5) =       0.000447087940
  error estimate for blocks of size 2^( 6) =       0.000448819085
  error estimate for blocks of size 2^( 7) =       0.000448309383

      target function =                  N/A
              le_mean =     -17.212256251738
             les_mean =     296.604058781254
             stat err =       0.000446662652
             autocorr =       1.165709670167
              std dev =       0.585058695264
             le_variance =       0.342293676904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342369671234
                                         uncertainty =       0.002588450741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342369671234
                                         uncertainty =       0.002588450741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413688164
  error estimate for blocks of size 2^( 2) =       0.000424900491
  error estimate for blocks of size 2^( 3) =       0.000434992016
  error estimate for blocks of size 2^( 4) =       0.000442425184
  error estimate for blocks of size 2^( 5) =       0.000447079234
  error estimate for blocks of size 2^( 6) =       0.000448810477
  error estimate for blocks of size 2^( 7) =       0.000448303173

      target function =                  N/A
              le_mean =     -17.212255671900
             les_mean =     296.604020937198
             stat err =       0.000446654517
             autocorr =       1.165728113472
              std dev =       0.585043411614
             le_variance =       0.342275793473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341905448242
                                         uncertainty =       0.002586151605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341905448242
                                         uncertainty =       0.002586151605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413407642
  error estimate for blocks of size 2^( 2) =       0.000424631215
  error estimate for blocks of size 2^( 3) =       0.000434738643
  error estimate for blocks of size 2^( 4) =       0.000442184112
  error estimate for blocks of size 2^( 5) =       0.000446846232
  error estimate for blocks of size 2^( 6) =       0.000448580302
  error estimate for blocks of size 2^( 7) =       0.000448072824

      target function =                  N/A
              le_mean =     -17.212256505040
             les_mean =     296.603585582030
             stat err =       0.000446420868
             autocorr =       1.166089735215
              std dev =       0.584646694724
             le_variance =       0.341811757652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212256911316        initial  <--
     9.7656e-02     9.7656e-01             2.0480e-03       -17.212256251738
     3.9062e-01     3.9062e+00             6.0547e-04       -17.212255671900
     1.5625e+00     1.5625e+01             1.5804e-04       -17.212256505040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.6530
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.194433e-01 1 1  ON 0
 uu_1                 5.348376e-02 1 1  ON 1
 uu_2                -4.621757e-02 1 1  ON 2
 uu_3                -1.034875e-01 1 1  ON 3
 uu_4                -1.367305e-01 1 1  ON 4
 uu_5                -1.429746e-01 1 1  ON 5
 uu_6                -1.203044e-01 1 1  ON 6
 uu_7                -5.084233e-02 1 1  ON 7
 uu_8                 8.920996e-02 1 1  ON 8
 uu_9                 1.313552e-01 1 1  ON 9
 ud_0                 3.692298e-01 1 1  ON 10
 ud_1                 1.028690e-01 1 1  ON 11
 ud_2                -1.477710e-02 1 1  ON 12
 ud_3                -7.871552e-02 1 1  ON 13
 ud_4                -1.264724e-01 1 1  ON 14
 ud_5                -1.571009e-01 1 1  ON 15
 ud_6                -1.595002e-01 1 1  ON 16
 ud_7                -1.162350e-01 1 1  ON 17
 ud_8                -1.604936e-02 1 1  ON 18
 ud_9                 9.186316e-02 1 1  ON 19
 eO_0                -8.128568e-01 1 1  ON 20
 eO_1                -4.790645e-01 1 1  ON 21
 eO_2                -4.888017e-02 1 1  ON 22
 eO_3                 2.199742e-01 1 1  ON 23
 eO_4                 3.209590e-01 1 1  ON 24
 eO_5                 3.361245e-01 1 1  ON 25
 eO_6                 2.675576e-01 1 1  ON 26
 eO_7                 1.323204e-01 1 1  ON 27
 eO_8                 3.131304e-02 1 1  ON 28
 eO_9                 2.007929e-02 1 1  ON 29
eH1_0                -1.856449e-01 1 1  ON 30
eH1_1                -1.062723e-01 1 1  ON 31
eH1_2                -6.326265e-02 1 1  ON 32
eH1_3                -2.533237e-02 1 1  ON 33
eH1_4                 1.905706e-02 1 1  ON 34
eH1_5                 3.054554e-02 1 1  ON 35
eH1_6                 7.522142e-02 1 1  ON 36
eH1_7                 1.081952e-01 1 1  ON 37
eH1_8                 1.021389e-01 1 1  ON 38
eH1_9                 2.847425e-02 1 1  ON 39
eH2_0                -1.871948e-01 1 1  ON 40
eH2_1                -1.078685e-01 1 1  ON 41
eH2_2                -6.473612e-02 1 1  ON 42
eH2_3                -2.687849e-02 1 1  ON 43
eH2_4                 1.802775e-02 1 1  ON 44
eH2_5                 3.076901e-02 1 1  ON 45
eH2_6                 7.600690e-02 1 1  ON 46
eH2_7                 1.120561e-01 1 1  ON 47
eH2_8                 1.058109e-01 1 1  ON 48
eH2_9                 2.998741e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1663
    reference variance = 0.511022
====================================================
  Execution time = 1.9050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4300e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343049253915
                                         uncertainty =       0.003137199103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343049253915
                                         uncertainty =       0.003137199103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414125998
  error estimate for blocks of size 2^( 2) =       0.000424848441
  error estimate for blocks of size 2^( 3) =       0.000434394089
  error estimate for blocks of size 2^( 4) =       0.000441792686
  error estimate for blocks of size 2^( 5) =       0.000447320240
  error estimate for blocks of size 2^( 6) =       0.000448863722
  error estimate for blocks of size 2^( 7) =       0.000452279466

      target function =                  N/A
              le_mean =     -17.212001668620
             les_mean =     296.596001953902
             stat err =       0.000447564029
             autocorr =       1.168006762824
              std dev =       0.585662603224
             le_variance =       0.343000684815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200166862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212001668620       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212002046052       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212002531704       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212002774036       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212002711413       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212002995013       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212002943954       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212002851638       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.913960e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212001668620       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212001781510       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212001936479       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212002021573       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212002007979       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212002069974       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212002036692       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 8.097947e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212001668620       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212001698300       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212001739980       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212001762597       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212001760620       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212001775089       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212001765950       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.094706e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4493e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.194322e-01 1 1  ON 0
 uu_1                 5.347722e-02 1 1  ON 1
 uu_2                -4.623151e-02 1 1  ON 2
 uu_3                -1.035041e-01 1 1  ON 3
 uu_4                -1.367269e-01 1 1  ON 4
 uu_5                -1.429998e-01 1 1  ON 5
 uu_6                -1.202802e-01 1 1  ON 6
 uu_7                -5.082571e-02 1 1  ON 7
 uu_8                 8.919884e-02 1 1  ON 8
 uu_9                 1.313697e-01 1 1  ON 9
 ud_0                 3.692136e-01 1 1  ON 10
 ud_1                 1.028715e-01 1 1  ON 11
 ud_2                -1.477107e-02 1 1  ON 12
 ud_3                -7.874150e-02 1 1  ON 13
 ud_4                -1.264773e-01 1 1  ON 14
 ud_5                -1.571257e-01 1 1  ON 15
 ud_6                -1.594738e-01 1 1  ON 16
 ud_7                -1.162098e-01 1 1  ON 17
 ud_8                -1.605883e-02 1 1  ON 18
 ud_9                 9.186422e-02 1 1  ON 19
 eO_0                -8.129377e-01 1 1  ON 20
 eO_1                -4.790709e-01 1 1  ON 21
 eO_2                -4.890732e-02 1 1  ON 22
 eO_3                 2.199807e-01 1 1  ON 23
 eO_4                 3.209645e-01 1 1  ON 24
 eO_5                 3.361427e-01 1 1  ON 25
 eO_6                 2.675908e-01 1 1  ON 26
 eO_7                 1.323592e-01 1 1  ON 27
 eO_8                 3.132010e-02 1 1  ON 28
 eO_9                 2.008182e-02 1 1  ON 29
eH1_0                -1.856629e-01 1 1  ON 30
eH1_1                -1.062842e-01 1 1  ON 31
eH1_2                -6.326675e-02 1 1  ON 32
eH1_3                -2.532242e-02 1 1  ON 33
eH1_4                 1.905307e-02 1 1  ON 34
eH1_5                 3.054603e-02 1 1  ON 35
eH1_6                 7.521965e-02 1 1  ON 36
eH1_7                 1.081956e-01 1 1  ON 37
eH1_8                 1.021572e-01 1 1  ON 38
eH1_9                 2.848173e-02 1 1  ON 39
eH2_0                -1.871948e-01 1 1  ON 40
eH2_1                -1.078578e-01 1 1  ON 41
eH2_2                -6.475072e-02 1 1  ON 42
eH2_3                -2.687131e-02 1 1  ON 43
eH2_4                 1.802436e-02 1 1  ON 44
eH2_5                 3.074073e-02 1 1  ON 45
eH2_6                 7.600933e-02 1 1  ON 46
eH2_7                 1.120583e-01 1 1  ON 47
eH2_8                 1.058258e-01 1 1  ON 48
eH2_9                 2.999304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2038
    reference variance = 0.344564
====================================================
  Execution time = 1.8631e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4417e-01
  Total weights = 2.0000e+06
  Execution time = 1.5641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218041866
                                         uncertainty =       0.004101088520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218041866
                                         uncertainty =       0.004101088520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414836073
  error estimate for blocks of size 2^( 2) =       0.000424916178
  error estimate for blocks of size 2^( 3) =       0.000434216859
  error estimate for blocks of size 2^( 4) =       0.000440848597
  error estimate for blocks of size 2^( 5) =       0.000445260052
  error estimate for blocks of size 2^( 6) =       0.000446942447
  error estimate for blocks of size 2^( 7) =       0.000448856864

      target function =                  N/A
              le_mean =     -17.211315953348
             les_mean =     296.573574608278
             stat err =       0.000445476990
             autocorr =       1.153181121844
              std dev =       0.586666800144
             le_variance =       0.344177934391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344206703200
                                         uncertainty =       0.004100523047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344206703200
                                         uncertainty =       0.004100523047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414829201
  error estimate for blocks of size 2^( 2) =       0.000424910422
  error estimate for blocks of size 2^( 3) =       0.000434210987
  error estimate for blocks of size 2^( 4) =       0.000440841899
  error estimate for blocks of size 2^( 5) =       0.000445251184
  error estimate for blocks of size 2^( 6) =       0.000446933005
  error estimate for blocks of size 2^( 7) =       0.000448847009

      target function =                  N/A
              le_mean =     -17.211314896061
             les_mean =     296.573526811138
             stat err =       0.000445468274
             autocorr =       1.153174205335
              std dev =       0.586657081983
             le_variance =       0.344166531841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344198982165
                                         uncertainty =       0.004100578027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344198982165
                                         uncertainty =       0.004100578027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414824561
  error estimate for blocks of size 2^( 2) =       0.000424905703
  error estimate for blocks of size 2^( 3) =       0.000434206584
  error estimate for blocks of size 2^( 4) =       0.000440838035
  error estimate for blocks of size 2^( 5) =       0.000445248161
  error estimate for blocks of size 2^( 6) =       0.000446930340
  error estimate for blocks of size 2^( 7) =       0.000448844403

      target function =                  N/A
              le_mean =     -17.211315198250
             les_mean =     296.573529514310
             stat err =       0.000445465235
             autocorr =       1.153184265577
              std dev =       0.586650520218
             le_variance =       0.344158832872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344215112291
                                         uncertainty =       0.004101013852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344215112291
                                         uncertainty =       0.004101013852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414834304
  error estimate for blocks of size 2^( 2) =       0.000424914561
  error estimate for blocks of size 2^( 3) =       0.000434215278
  error estimate for blocks of size 2^( 4) =       0.000440846986
  error estimate for blocks of size 2^( 5) =       0.000445258262
  error estimate for blocks of size 2^( 6) =       0.000446940634
  error estimate for blocks of size 2^( 7) =       0.000448855002

      target function =                  N/A
              le_mean =     -17.211315846664
             les_mean =     296.573568000742
             stat err =       0.000445475221
             autocorr =       1.153181799094
              std dev =       0.586664298552
             le_variance =       0.344174999195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211315953348        initial  <--
     9.7656e-01     9.7656e+00             2.9140e-04       -17.211314896061
     3.9062e+00     3.9062e+01             8.0979e-05       -17.211315198250
     1.5625e+01     1.5625e+02             2.0947e-05       -17.211315846664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.5554
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.194433e-01 1 1  ON 0
 uu_1                 5.348376e-02 1 1  ON 1
 uu_2                -4.621757e-02 1 1  ON 2
 uu_3                -1.034875e-01 1 1  ON 3
 uu_4                -1.367305e-01 1 1  ON 4
 uu_5                -1.429746e-01 1 1  ON 5
 uu_6                -1.203044e-01 1 1  ON 6
 uu_7                -5.084233e-02 1 1  ON 7
 uu_8                 8.920996e-02 1 1  ON 8
 uu_9                 1.313552e-01 1 1  ON 9
 ud_0                 3.692298e-01 1 1  ON 10
 ud_1                 1.028690e-01 1 1  ON 11
 ud_2                -1.477710e-02 1 1  ON 12
 ud_3                -7.871552e-02 1 1  ON 13
 ud_4                -1.264724e-01 1 1  ON 14
 ud_5                -1.571009e-01 1 1  ON 15
 ud_6                -1.595002e-01 1 1  ON 16
 ud_7                -1.162350e-01 1 1  ON 17
 ud_8                -1.604936e-02 1 1  ON 18
 ud_9                 9.186316e-02 1 1  ON 19
 eO_0                -8.128568e-01 1 1  ON 20
 eO_1                -4.790645e-01 1 1  ON 21
 eO_2                -4.888017e-02 1 1  ON 22
 eO_3                 2.199742e-01 1 1  ON 23
 eO_4                 3.209590e-01 1 1  ON 24
 eO_5                 3.361245e-01 1 1  ON 25
 eO_6                 2.675576e-01 1 1  ON 26
 eO_7                 1.323204e-01 1 1  ON 27
 eO_8                 3.131304e-02 1 1  ON 28
 eO_9                 2.007929e-02 1 1  ON 29
eH1_0                -1.856449e-01 1 1  ON 30
eH1_1                -1.062723e-01 1 1  ON 31
eH1_2                -6.326265e-02 1 1  ON 32
eH1_3                -2.533237e-02 1 1  ON 33
eH1_4                 1.905706e-02 1 1  ON 34
eH1_5                 3.054554e-02 1 1  ON 35
eH1_6                 7.522142e-02 1 1  ON 36
eH1_7                 1.081952e-01 1 1  ON 37
eH1_8                 1.021389e-01 1 1  ON 38
eH1_9                 2.847425e-02 1 1  ON 39
eH2_0                -1.871948e-01 1 1  ON 40
eH2_1                -1.078685e-01 1 1  ON 41
eH2_2                -6.473612e-02 1 1  ON 42
eH2_3                -2.687849e-02 1 1  ON 43
eH2_4                 1.802775e-02 1 1  ON 44
eH2_5                 3.076901e-02 1 1  ON 45
eH2_6                 7.600690e-02 1 1  ON 46
eH2_7                 1.120561e-01 1 1  ON 47
eH2_8                 1.058109e-01 1 1  ON 48
eH2_9                 2.998741e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2348
    reference variance = 0.170808
====================================================
  Execution time = 1.9527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4320e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343276766466
                                         uncertainty =       0.003347995426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343276766466
                                         uncertainty =       0.003347995426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414244164
  error estimate for blocks of size 2^( 2) =       0.000424911284
  error estimate for blocks of size 2^( 3) =       0.000434101446
  error estimate for blocks of size 2^( 4) =       0.000441351488
  error estimate for blocks of size 2^( 5) =       0.000445952498
  error estimate for blocks of size 2^( 6) =       0.000447342872
  error estimate for blocks of size 2^( 7) =       0.000448496086

      target function =                  N/A
              le_mean =     -17.211815818352
             les_mean =     296.589800047372
             stat err =       0.000445785736
             autocorr =       1.158082609203
              std dev =       0.585829714243
             le_variance =       0.343196454090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181581835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211815818352       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211815814006       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211815785973       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211815770962       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211815765849       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211815788595       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211815785999       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.344545e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211815818352       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211815817245       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211815810059       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211815806140       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211815804532       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211815810254       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211815809739       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.947071e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211815818352       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211815818074       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211815816266       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211815815275       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211815814851       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211815816284       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211815816164       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.492306e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4834e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.194431e-01 1 1  ON 0
 uu_1                 5.348486e-02 1 1  ON 1
 uu_2                -4.621987e-02 1 1  ON 2
 uu_3                -1.034871e-01 1 1  ON 3
 uu_4                -1.367310e-01 1 1  ON 4
 uu_5                -1.429742e-01 1 1  ON 5
 uu_6                -1.203037e-01 1 1  ON 6
 uu_7                -5.084358e-02 1 1  ON 7
 uu_8                 8.920825e-02 1 1  ON 8
 uu_9                 1.313565e-01 1 1  ON 9
 ud_0                 3.692331e-01 1 1  ON 10
 ud_1                 1.028692e-01 1 1  ON 11
 ud_2                -1.477655e-02 1 1  ON 12
 ud_3                -7.871666e-02 1 1  ON 13
 ud_4                -1.264740e-01 1 1  ON 14
 ud_5                -1.571028e-01 1 1  ON 15
 ud_6                -1.594984e-01 1 1  ON 16
 ud_7                -1.162343e-01 1 1  ON 17
 ud_8                -1.605234e-02 1 1  ON 18
 ud_9                 9.186276e-02 1 1  ON 19
 eO_0                -8.128597e-01 1 1  ON 20
 eO_1                -4.790704e-01 1 1  ON 21
 eO_2                -4.887981e-02 1 1  ON 22
 eO_3                 2.199730e-01 1 1  ON 23
 eO_4                 3.209590e-01 1 1  ON 24
 eO_5                 3.361273e-01 1 1  ON 25
 eO_6                 2.675609e-01 1 1  ON 26
 eO_7                 1.323233e-01 1 1  ON 27
 eO_8                 3.131339e-02 1 1  ON 28
 eO_9                 2.007945e-02 1 1  ON 29
eH1_0                -1.856444e-01 1 1  ON 30
eH1_1                -1.062715e-01 1 1  ON 31
eH1_2                -6.326279e-02 1 1  ON 32
eH1_3                -2.533402e-02 1 1  ON 33
eH1_4                 1.905611e-02 1 1  ON 34
eH1_5                 3.054324e-02 1 1  ON 35
eH1_6                 7.522149e-02 1 1  ON 36
eH1_7                 1.081964e-01 1 1  ON 37
eH1_8                 1.021407e-01 1 1  ON 38
eH1_9                 2.847466e-02 1 1  ON 39
eH2_0                -1.871968e-01 1 1  ON 40
eH2_1                -1.078690e-01 1 1  ON 41
eH2_2                -6.473503e-02 1 1  ON 42
eH2_3                -2.687805e-02 1 1  ON 43
eH2_4                 1.802857e-02 1 1  ON 44
eH2_5                 3.076892e-02 1 1  ON 45
eH2_6                 7.600600e-02 1 1  ON 46
eH2_7                 1.120549e-01 1 1  ON 47
eH2_8                 1.058125e-01 1 1  ON 48
eH2_9                 2.998786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.293649
====================================================
  Execution time = 1.8713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5922e-01
  Total weights = 2.0000e+06
  Execution time = 1.5631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359315091136
                                         uncertainty =       0.018357061154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359315091136
                                         uncertainty =       0.018357061154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423803008
  error estimate for blocks of size 2^( 2) =       0.000434399714
  error estimate for blocks of size 2^( 3) =       0.000444088456
  error estimate for blocks of size 2^( 4) =       0.000451548688
  error estimate for blocks of size 2^( 5) =       0.000457340284
  error estimate for blocks of size 2^( 6) =       0.000459350642
  error estimate for blocks of size 2^( 7) =       0.000461551770

      target function =                  N/A
              le_mean =     -17.212246926529
             les_mean =     296.620662059811
             stat err =       0.000457447846
             autocorr =       1.165078273501
              std dev =       0.599347962060
             le_variance =       0.359217979625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359326397424
                                         uncertainty =       0.018356963353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359326397424
                                         uncertainty =       0.018356963353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423809677
  error estimate for blocks of size 2^( 2) =       0.000434406136
  error estimate for blocks of size 2^( 3) =       0.000444094717
  error estimate for blocks of size 2^( 4) =       0.000451554712
  error estimate for blocks of size 2^( 5) =       0.000457346203
  error estimate for blocks of size 2^( 6) =       0.000459356176
  error estimate for blocks of size 2^( 7) =       0.000461557102

      target function =                  N/A
              le_mean =     -17.212246943887
             les_mean =     296.620673962567
             stat err =       0.000457453548
             autocorr =       1.165070653935
              std dev =       0.599357393253
             le_variance =       0.359229284847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359320937034
                                         uncertainty =       0.018357012014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359320937034
                                         uncertainty =       0.018357012014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423806456
  error estimate for blocks of size 2^( 2) =       0.000434403035
  error estimate for blocks of size 2^( 3) =       0.000444091694
  error estimate for blocks of size 2^( 4) =       0.000451551805
  error estimate for blocks of size 2^( 5) =       0.000457343348
  error estimate for blocks of size 2^( 6) =       0.000459353507
  error estimate for blocks of size 2^( 7) =       0.000461554531

      target function =                  N/A
              le_mean =     -17.212246934259
             les_mean =     296.620668171290
             stat err =       0.000457450798
             autocorr =       1.165074350423
              std dev =       0.599352838480
             le_variance =       0.359223824994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359315828073
                                         uncertainty =       0.018357055003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359315828073
                                         uncertainty =       0.018357055003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423803443
  error estimate for blocks of size 2^( 2) =       0.000434400133
  error estimate for blocks of size 2^( 3) =       0.000444088864
  error estimate for blocks of size 2^( 4) =       0.000451549081
  error estimate for blocks of size 2^( 5) =       0.000457340671
  error estimate for blocks of size 2^( 6) =       0.000459351003
  error estimate for blocks of size 2^( 7) =       0.000461552118

      target function =                  N/A
              le_mean =     -17.212246927444
             les_mean =     296.620662828205
             stat err =       0.000457448218
             autocorr =       1.165077779358
              std dev =       0.599348576786
             le_variance =       0.359218716496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212246926529        initial
     9.7656e+00     9.7656e+01             2.3445e-05       -17.212246943887  <--
     3.9062e+01     3.9062e+02             5.9471e-06       -17.212246934259
     1.5625e+02     1.5625e+03             1.4923e-06       -17.212246927444

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.6611e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.194422e-01 1 1  ON 0
 uu_1                 5.348788e-02 1 1  ON 1
 uu_2                -4.622644e-02 1 1  ON 2
 uu_3                -1.034863e-01 1 1  ON 3
 uu_4                -1.367324e-01 1 1  ON 4
 uu_5                -1.429728e-01 1 1  ON 5
 uu_6                -1.203015e-01 1 1  ON 6
 uu_7                -5.084730e-02 1 1  ON 7
 uu_8                 8.920315e-02 1 1  ON 8
 uu_9                 1.313606e-01 1 1  ON 9
 ud_0                 3.692425e-01 1 1  ON 10
 ud_1                 1.028699e-01 1 1  ON 11
 ud_2                -1.477495e-02 1 1  ON 12
 ud_3                -7.871998e-02 1 1  ON 13
 ud_4                -1.264787e-01 1 1  ON 14
 ud_5                -1.571086e-01 1 1  ON 15
 ud_6                -1.594928e-01 1 1  ON 16
 ud_7                -1.162321e-01 1 1  ON 17
 ud_8                -1.606121e-02 1 1  ON 18
 ud_9                 9.186157e-02 1 1  ON 19
 eO_0                -8.128685e-01 1 1  ON 20
 eO_1                -4.790879e-01 1 1  ON 21
 eO_2                -4.887892e-02 1 1  ON 22
 eO_3                 2.199696e-01 1 1  ON 23
 eO_4                 3.209588e-01 1 1  ON 24
 eO_5                 3.361357e-01 1 1  ON 25
 eO_6                 2.675708e-01 1 1  ON 26
 eO_7                 1.323319e-01 1 1  ON 27
 eO_8                 3.131442e-02 1 1  ON 28
 eO_9                 2.007993e-02 1 1  ON 29
eH1_0                -1.856427e-01 1 1  ON 30
eH1_1                -1.062695e-01 1 1  ON 31
eH1_2                -6.326326e-02 1 1  ON 32
eH1_3                -2.533885e-02 1 1  ON 33
eH1_4                 1.905320e-02 1 1  ON 34
eH1_5                 3.053639e-02 1 1  ON 35
eH1_6                 7.522170e-02 1 1  ON 36
eH1_7                 1.082000e-01 1 1  ON 37
eH1_8                 1.021463e-01 1 1  ON 38
eH1_9                 2.847590e-02 1 1  ON 39
eH2_0                -1.872026e-01 1 1  ON 40
eH2_1                -1.078704e-01 1 1  ON 41
eH2_2                -6.473181e-02 1 1  ON 42
eH2_3                -2.687674e-02 1 1  ON 43
eH2_4                 1.803100e-02 1 1  ON 44
eH2_5                 3.076865e-02 1 1  ON 45
eH2_6                 7.600331e-02 1 1  ON 46
eH2_7                 1.120515e-01 1 1  ON 47
eH2_8                 1.058173e-01 1 1  ON 48
eH2_9                 2.998921e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1741
    reference variance = 0.193112
====================================================
  Execution time = 1.9095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3675e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336707434686
                                         uncertainty =       0.002785100752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336707434686
                                         uncertainty =       0.002785100752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410334056
  error estimate for blocks of size 2^( 2) =       0.000421054501
  error estimate for blocks of size 2^( 3) =       0.000431030945
  error estimate for blocks of size 2^( 4) =       0.000437228127
  error estimate for blocks of size 2^( 5) =       0.000441539531
  error estimate for blocks of size 2^( 6) =       0.000444093271
  error estimate for blocks of size 2^( 7) =       0.000445419959

      target function =                  N/A
              le_mean =     -17.211775194834
             les_mean =     296.581953264769
             stat err =       0.000442070222
             autocorr =       1.160666357887
              std dev =       0.580299987633
             le_variance =       0.336748075646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721177519483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211775194834       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211775302271       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211775264239       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211775237565       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211775161308       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211775253969       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211775241497       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.216673e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211775194834       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211775222981       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211775213744       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211775209787       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211775193376       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211775210526       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211775209175       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.871598e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211775194834       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211775201956       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211775199672       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211775198890       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211775195048       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211775198889       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211775198615       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.726589e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4385e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.194478e-01 1 1  ON 0
 uu_1                 5.348598e-02 1 1  ON 1
 uu_2                -4.622287e-02 1 1  ON 2
 uu_3                -1.034923e-01 1 1  ON 3
 uu_4                -1.367294e-01 1 1  ON 4
 uu_5                -1.429734e-01 1 1  ON 5
 uu_6                -1.203056e-01 1 1  ON 6
 uu_7                -5.085320e-02 1 1  ON 7
 uu_8                 8.919846e-02 1 1  ON 8
 uu_9                 1.313657e-01 1 1  ON 9
 ud_0                 3.692496e-01 1 1  ON 10
 ud_1                 1.028731e-01 1 1  ON 11
 ud_2                -1.477962e-02 1 1  ON 12
 ud_3                -7.872439e-02 1 1  ON 13
 ud_4                -1.264762e-01 1 1  ON 14
 ud_5                -1.571161e-01 1 1  ON 15
 ud_6                -1.594898e-01 1 1  ON 16
 ud_7                -1.162293e-01 1 1  ON 17
 ud_8                -1.606629e-02 1 1  ON 18
 ud_9                 9.186017e-02 1 1  ON 19
 eO_0                -8.128843e-01 1 1  ON 20
 eO_1                -4.791066e-01 1 1  ON 21
 eO_2                -4.887999e-02 1 1  ON 22
 eO_3                 2.199692e-01 1 1  ON 23
 eO_4                 3.209592e-01 1 1  ON 24
 eO_5                 3.361458e-01 1 1  ON 25
 eO_6                 2.675805e-01 1 1  ON 26
 eO_7                 1.323447e-01 1 1  ON 27
 eO_8                 3.131652e-02 1 1  ON 28
 eO_9                 2.008039e-02 1 1  ON 29
eH1_0                -1.856500e-01 1 1  ON 30
eH1_1                -1.062643e-01 1 1  ON 31
eH1_2                -6.325891e-02 1 1  ON 32
eH1_3                -2.534153e-02 1 1  ON 33
eH1_4                 1.905695e-02 1 1  ON 34
eH1_5                 3.052636e-02 1 1  ON 35
eH1_6                 7.521853e-02 1 1  ON 36
eH1_7                 1.082008e-01 1 1  ON 37
eH1_8                 1.021530e-01 1 1  ON 38
eH1_9                 2.847752e-02 1 1  ON 39
eH2_0                -1.872045e-01 1 1  ON 40
eH2_1                -1.078691e-01 1 1  ON 41
eH2_2                -6.474160e-02 1 1  ON 42
eH2_3                -2.687288e-02 1 1  ON 43
eH2_4                 1.803032e-02 1 1  ON 44
eH2_5                 3.076576e-02 1 1  ON 45
eH2_6                 7.600592e-02 1 1  ON 46
eH2_7                 1.120501e-01 1 1  ON 47
eH2_8                 1.058238e-01 1 1  ON 48
eH2_9                 2.999119e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2469
    reference variance = 0.655854
====================================================
  Execution time = 1.8596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4512e-01
  Total weights = 2.0000e+06
  Execution time = 1.5698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345135999496
                                         uncertainty =       0.005085749611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345135999496
                                         uncertainty =       0.005085749611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415398732
  error estimate for blocks of size 2^( 2) =       0.000425658542
  error estimate for blocks of size 2^( 3) =       0.000434753468
  error estimate for blocks of size 2^( 4) =       0.000441407936
  error estimate for blocks of size 2^( 5) =       0.000445130184
  error estimate for blocks of size 2^( 6) =       0.000446562212
  error estimate for blocks of size 2^( 7) =       0.000447174953

      target function =                  N/A
              le_mean =     -17.210825265195
             les_mean =     296.557618349988
             stat err =       0.000445068821
             autocorr =       1.147952741516
              std dev =       0.587462520915
             le_variance =       0.345112213480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345171879738
                                         uncertainty =       0.005086874413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345171879738
                                         uncertainty =       0.005086874413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415420315
  error estimate for blocks of size 2^( 2) =       0.000425678810
  error estimate for blocks of size 2^( 3) =       0.000434772678
  error estimate for blocks of size 2^( 4) =       0.000441425680
  error estimate for blocks of size 2^( 5) =       0.000445147943
  error estimate for blocks of size 2^( 6) =       0.000446580653
  error estimate for blocks of size 2^( 7) =       0.000447193688

      target function =                  N/A
              le_mean =     -17.210825386394
             les_mean =     296.557658384019
             stat err =       0.000445086991
             autocorr =       1.147927184683
              std dev =       0.587493043058
             le_variance =       0.345148075642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345154698455
                                         uncertainty =       0.005086347598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345154698455
                                         uncertainty =       0.005086347598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415409980
  error estimate for blocks of size 2^( 2) =       0.000425669073
  error estimate for blocks of size 2^( 3) =       0.000434763443
  error estimate for blocks of size 2^( 4) =       0.000441417109
  error estimate for blocks of size 2^( 5) =       0.000445139407
  error estimate for blocks of size 2^( 6) =       0.000446571841
  error estimate for blocks of size 2^( 7) =       0.000447184785

      target function =                  N/A
              le_mean =     -17.210825337053
             les_mean =     296.557639513145
             stat err =       0.000445078285
             autocorr =       1.147939395660
              std dev =       0.587478427822
             le_variance =       0.345130903156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345138355852
                                         uncertainty =       0.005085825555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345138355852
                                         uncertainty =       0.005085825555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415400150
  error estimate for blocks of size 2^( 2) =       0.000425659868
  error estimate for blocks of size 2^( 3) =       0.000434754724
  error estimate for blocks of size 2^( 4) =       0.000441409089
  error estimate for blocks of size 2^( 5) =       0.000445131345
  error estimate for blocks of size 2^( 6) =       0.000446563426
  error estimate for blocks of size 2^( 7) =       0.000447176194

      target function =                  N/A
              le_mean =     -17.210825274375
             les_mean =     296.557621021168
             stat err =       0.000445070014
             autocorr =       1.147951056876
              std dev =       0.587464525456
             le_variance =       0.345114568670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210825265195        initial
     2.4414e+00     2.4414e+01             7.2167e-05       -17.210825386394  <--
     9.7656e+00     9.7656e+01             1.8716e-05       -17.210825337053
     3.9062e+01     3.9062e+02             4.7266e-06       -17.210825274375

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.6523e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.194636e-01 1 1  ON 0
 uu_1                 5.348185e-02 1 1  ON 1
 uu_2                -4.621423e-02 1 1  ON 2
 uu_3                -1.035078e-01 1 1  ON 3
 uu_4                -1.367226e-01 1 1  ON 4
 uu_5                -1.429745e-01 1 1  ON 5
 uu_6                -1.203172e-01 1 1  ON 6
 uu_7                -5.087064e-02 1 1  ON 7
 uu_8                 8.918457e-02 1 1  ON 8
 uu_9                 1.313808e-01 1 1  ON 9
 ud_0                 3.692700e-01 1 1  ON 10
 ud_1                 1.028804e-01 1 1  ON 11
 ud_2                -1.479109e-02 1 1  ON 12
 ud_3                -7.873729e-02 1 1  ON 13
 ud_4                -1.264702e-01 1 1  ON 14
 ud_5                -1.571366e-01 1 1  ON 15
 ud_6                -1.594809e-01 1 1  ON 16
 ud_7                -1.162211e-01 1 1  ON 17
 ud_8                -1.608128e-02 1 1  ON 18
 ud_9                 9.185602e-02 1 1  ON 19
 eO_0                -8.129314e-01 1 1  ON 20
 eO_1                -4.791601e-01 1 1  ON 21
 eO_2                -4.888537e-02 1 1  ON 22
 eO_3                 2.199678e-01 1 1  ON 23
 eO_4                 3.209610e-01 1 1  ON 24
 eO_5                 3.361759e-01 1 1  ON 25
 eO_6                 2.676091e-01 1 1  ON 26
 eO_7                 1.323827e-01 1 1  ON 27
 eO_8                 3.132276e-02 1 1  ON 28
 eO_9                 2.008177e-02 1 1  ON 29
eH1_0                -1.856712e-01 1 1  ON 30
eH1_1                -1.062490e-01 1 1  ON 31
eH1_2                -6.324722e-02 1 1  ON 32
eH1_3                -2.534804e-02 1 1  ON 33
eH1_4                 1.906724e-02 1 1  ON 34
eH1_5                 3.049683e-02 1 1  ON 35
eH1_6                 7.520913e-02 1 1  ON 36
eH1_7                 1.082034e-01 1 1  ON 37
eH1_8                 1.021729e-01 1 1  ON 38
eH1_9                 2.848235e-02 1 1  ON 39
eH2_0                -1.872101e-01 1 1  ON 40
eH2_1                -1.078665e-01 1 1  ON 41
eH2_2                -6.476839e-02 1 1  ON 42
eH2_3                -2.686290e-02 1 1  ON 43
eH2_4                 1.802811e-02 1 1  ON 44
eH2_5                 3.075776e-02 1 1  ON 45
eH2_6                 7.601379e-02 1 1  ON 46
eH2_7                 1.120458e-01 1 1  ON 47
eH2_8                 1.058432e-01 1 1  ON 48
eH2_9                 2.999704e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0915e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1957
    reference variance = 0.246794
====================================================
  Execution time = 1.9372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3995e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339768527384
                                         uncertainty =       0.003126267862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339768527384
                                         uncertainty =       0.003126267862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412280241
  error estimate for blocks of size 2^( 2) =       0.000422672552
  error estimate for blocks of size 2^( 3) =       0.000432516180
  error estimate for blocks of size 2^( 4) =       0.000439494255
  error estimate for blocks of size 2^( 5) =       0.000444801840
  error estimate for blocks of size 2^( 6) =       0.000446472857
  error estimate for blocks of size 2^( 7) =       0.000448109509

      target function =                  N/A
              le_mean =     -17.212417838358
             les_mean =     296.607277666726
             stat err =       0.000444719615
             autocorr =       1.163556637366
              std dev =       0.583052308539
             le_variance =       0.339949994493


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721241783836e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212417838358       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212417610138       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212417307062       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212417315308       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212417394264       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212417656025       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212417552237       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212417694908       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.462380e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212417838358       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212417763132       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212417673237       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212417652591       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212417666709       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212417735431       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212417709792       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.430646e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212417838358       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212417817924       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212417794157       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212417786549       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212417788174       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212417805273       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212417799651       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.441279e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4700e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.194744e-01 1 1  ON 0
 uu_1                 5.346163e-02 1 1  ON 1
 uu_2                -4.620539e-02 1 1  ON 2
 uu_3                -1.035234e-01 1 1  ON 3
 uu_4                -1.367124e-01 1 1  ON 4
 uu_5                -1.429442e-01 1 1  ON 5
 uu_6                -1.203234e-01 1 1  ON 6
 uu_7                -5.089032e-02 1 1  ON 7
 uu_8                 8.915404e-02 1 1  ON 8
 uu_9                 1.313928e-01 1 1  ON 9
 ud_0                 3.692621e-01 1 1  ON 10
 ud_1                 1.029066e-01 1 1  ON 11
 ud_2                -1.477089e-02 1 1  ON 12
 ud_3                -7.872769e-02 1 1  ON 13
 ud_4                -1.264924e-01 1 1  ON 14
 ud_5                -1.571679e-01 1 1  ON 15
 ud_6                -1.594785e-01 1 1  ON 16
 ud_7                -1.162126e-01 1 1  ON 17
 ud_8                -1.610834e-02 1 1  ON 18
 ud_9                 9.185002e-02 1 1  ON 19
 eO_0                -8.130257e-01 1 1  ON 20
 eO_1                -4.791921e-01 1 1  ON 21
 eO_2                -4.890894e-02 1 1  ON 22
 eO_3                 2.199825e-01 1 1  ON 23
 eO_4                 3.209675e-01 1 1  ON 24
 eO_5                 3.362014e-01 1 1  ON 25
 eO_6                 2.676471e-01 1 1  ON 26
 eO_7                 1.324353e-01 1 1  ON 27
 eO_8                 3.133138e-02 1 1  ON 28
 eO_9                 2.008447e-02 1 1  ON 29
eH1_0                -1.856376e-01 1 1  ON 30
eH1_1                -1.062525e-01 1 1  ON 31
eH1_2                -6.325743e-02 1 1  ON 32
eH1_3                -2.534991e-02 1 1  ON 33
eH1_4                 1.901427e-02 1 1  ON 34
eH1_5                 3.049653e-02 1 1  ON 35
eH1_6                 7.519946e-02 1 1  ON 36
eH1_7                 1.082035e-01 1 1  ON 37
eH1_8                 1.022055e-01 1 1  ON 38
eH1_9                 2.849285e-02 1 1  ON 39
eH2_0                -1.872155e-01 1 1  ON 40
eH2_1                -1.078951e-01 1 1  ON 41
eH2_2                -6.477935e-02 1 1  ON 42
eH2_3                -2.689151e-02 1 1  ON 43
eH2_4                 1.801951e-02 1 1  ON 44
eH2_5                 3.081204e-02 1 1  ON 45
eH2_6                 7.600988e-02 1 1  ON 46
eH2_7                 1.120342e-01 1 1  ON 47
eH2_8                 1.058710e-01 1 1  ON 48
eH2_9                 3.000928e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2288
    reference variance = 0.183318
====================================================
  Execution time = 1.8644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4407e-01
  Total weights = 2.0000e+06
  Execution time = 1.5665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344132234003
                                         uncertainty =       0.007076305675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344132234003
                                         uncertainty =       0.007076305675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414786188
  error estimate for blocks of size 2^( 2) =       0.000425677274
  error estimate for blocks of size 2^( 3) =       0.000435705139
  error estimate for blocks of size 2^( 4) =       0.000443573209
  error estimate for blocks of size 2^( 5) =       0.000448857271
  error estimate for blocks of size 2^( 6) =       0.000451956464
  error estimate for blocks of size 2^( 7) =       0.000456438314

      target function =                  N/A
              le_mean =     -17.211693883449
             les_mean =     296.586501329152
             stat err =       0.000450206314
             autocorr =       1.178079478722
              std dev =       0.586596252670
             le_variance =       0.344095163646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344109464650
                                         uncertainty =       0.007074084296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344109464650
                                         uncertainty =       0.007074084296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414772441
  error estimate for blocks of size 2^( 2) =       0.000425664384
  error estimate for blocks of size 2^( 3) =       0.000435692409
  error estimate for blocks of size 2^( 4) =       0.000443559171
  error estimate for blocks of size 2^( 5) =       0.000448843714
  error estimate for blocks of size 2^( 6) =       0.000451939568
  error estimate for blocks of size 2^( 7) =       0.000456420186

      target function =                  N/A
              le_mean =     -17.211694925721
             les_mean =     296.586514399539
             stat err =       0.000450190660
             autocorr =       1.178075639981
              std dev =       0.586576811239
             le_variance =       0.344072355483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344090155658
                                         uncertainty =       0.007073864860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344090155658
                                         uncertainty =       0.007073864860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414760810
  error estimate for blocks of size 2^( 2) =       0.000425653113
  error estimate for blocks of size 2^( 3) =       0.000435681686
  error estimate for blocks of size 2^( 4) =       0.000443549409
  error estimate for blocks of size 2^( 5) =       0.000448833903
  error estimate for blocks of size 2^( 6) =       0.000451931092
  error estimate for blocks of size 2^( 7) =       0.000456412405

      target function =                  N/A
              le_mean =     -17.211694647482
             les_mean =     296.586485524359
             stat err =       0.000450181702
             autocorr =       1.178094831344
              std dev =       0.586560361962
             le_variance =       0.344053058225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344125550926
                                         uncertainty =       0.007075943411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344125550926
                                         uncertainty =       0.007075943411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414782158
  error estimate for blocks of size 2^( 2) =       0.000425673432
  error estimate for blocks of size 2^( 3) =       0.000435701413
  error estimate for blocks of size 2^( 4) =       0.000443569455
  error estimate for blocks of size 2^( 5) =       0.000448853585
  error estimate for blocks of size 2^( 6) =       0.000451952513
  error estimate for blocks of size 2^( 7) =       0.000456434290

      target function =                  N/A
              le_mean =     -17.211693990327
             les_mean =     296.586498321308
             stat err =       0.000450202461
             autocorr =       1.178082204289
              std dev =       0.586590552861
             le_variance =       0.344088476706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211693883449        initial
     6.1035e-01     6.1035e+00             3.4624e-04       -17.211694925721  <--
     2.4414e+00     2.4414e+01             9.4306e-05       -17.211694647482
     9.7656e+00     9.7656e+01             2.4413e-05       -17.211693990327

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.6766e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.195039e-01 1 1  ON 0
 uu_1                 5.344331e-02 1 1  ON 1
 uu_2                -4.619740e-02 1 1  ON 2
 uu_3                -1.035429e-01 1 1  ON 3
 uu_4                -1.366993e-01 1 1  ON 4
 uu_5                -1.428792e-01 1 1  ON 5
 uu_6                -1.203445e-01 1 1  ON 6
 uu_7                -5.095121e-02 1 1  ON 7
 uu_8                 8.905960e-02 1 1  ON 8
 uu_9                 1.314298e-01 1 1  ON 9
 ud_0                 3.692861e-01 1 1  ON 10
 ud_1                 1.029646e-01 1 1  ON 11
 ud_2                -1.472430e-02 1 1  ON 12
 ud_3                -7.871385e-02 1 1  ON 13
 ud_4                -1.265423e-01 1 1  ON 14
 ud_5                -1.572599e-01 1 1  ON 15
 ud_6                -1.594838e-01 1 1  ON 16
 ud_7                -1.161906e-01 1 1  ON 17
 ud_8                -1.619188e-02 1 1  ON 18
 ud_9                 9.183147e-02 1 1  ON 19
 eO_0                -8.132777e-01 1 1  ON 20
 eO_1                -4.793176e-01 1 1  ON 21
 eO_2                -4.897349e-02 1 1  ON 22
 eO_3                 2.200181e-01 1 1  ON 23
 eO_4                 3.209798e-01 1 1  ON 24
 eO_5                 3.362784e-01 1 1  ON 25
 eO_6                 2.677634e-01 1 1  ON 26
 eO_7                 1.325974e-01 1 1  ON 27
 eO_8                 3.135793e-02 1 1  ON 28
 eO_9                 2.009278e-02 1 1  ON 29
eH1_0                -1.855495e-01 1 1  ON 30
eH1_1                -1.062743e-01 1 1  ON 31
eH1_2                -6.326664e-02 1 1  ON 32
eH1_3                -2.536789e-02 1 1  ON 33
eH1_4                 1.888139e-02 1 1  ON 34
eH1_5                 3.048510e-02 1 1  ON 35
eH1_6                 7.516668e-02 1 1  ON 36
eH1_7                 1.082033e-01 1 1  ON 37
eH1_8                 1.023060e-01 1 1  ON 38
eH1_9                 2.852518e-02 1 1  ON 39
eH2_0                -1.872339e-01 1 1  ON 40
eH2_1                -1.079685e-01 1 1  ON 41
eH2_2                -6.482933e-02 1 1  ON 42
eH2_3                -2.696415e-02 1 1  ON 43
eH2_4                 1.799493e-02 1 1  ON 44
eH2_5                 3.096495e-02 1 1  ON 45
eH2_6                 7.599796e-02 1 1  ON 46
eH2_7                 1.119984e-01 1 1  ON 47
eH2_8                 1.059563e-01 1 1  ON 48
eH2_9                 3.004699e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1211
    reference variance = 0.332415
====================================================
  Execution time = 1.9088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5635e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356373700767
                                         uncertainty =       0.012451663066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356373700767
                                         uncertainty =       0.012451663066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422106869
  error estimate for blocks of size 2^( 2) =       0.000432480144
  error estimate for blocks of size 2^( 3) =       0.000442166310
  error estimate for blocks of size 2^( 4) =       0.000449766530
  error estimate for blocks of size 2^( 5) =       0.000453267781
  error estimate for blocks of size 2^( 6) =       0.000455386789
  error estimate for blocks of size 2^( 7) =       0.000458397843

      target function =                  N/A
              le_mean =     -17.211979120535
             les_mean =     296.608573485699
             stat err =       0.000454204736
             autocorr =       1.157866467222
              std dev =       0.596949259256
             le_variance =       0.356348418126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197912054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211979120535       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211980285796       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211981290144       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211980589393       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211980361405       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211980500795       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211981782498       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211982147590       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211981294656       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211981624902       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211981803138       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.061092e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211979120535       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211979673242       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211980176774       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211979904300       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211979619511       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211979562363       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211980064877       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211980000910       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.880409e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211979120535       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211979298672       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211979469985       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211979422896       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211979300266       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211979253969       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211979380266       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.338794e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4396e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.193533e-01 1 1  ON 0
 uu_1                 5.346357e-02 1 1  ON 1
 uu_2                -4.620173e-02 1 1  ON 2
 uu_3                -1.035246e-01 1 1  ON 3
 uu_4                -1.367296e-01 1 1  ON 4
 uu_5                -1.428891e-01 1 1  ON 5
 uu_6                -1.202619e-01 1 1  ON 6
 uu_7                -5.093006e-02 1 1  ON 7
 uu_8                 8.896987e-02 1 1  ON 8
 uu_9                 1.315018e-01 1 1  ON 9
 ud_0                 3.694517e-01 1 1  ON 10
 ud_1                 1.030486e-01 1 1  ON 11
 ud_2                -1.471483e-02 1 1  ON 12
 ud_3                -7.874182e-02 1 1  ON 13
 ud_4                -1.264957e-01 1 1  ON 14
 ud_5                -1.575208e-01 1 1  ON 15
 ud_6                -1.595773e-01 1 1  ON 16
 ud_7                -1.161029e-01 1 1  ON 17
 ud_8                -1.625395e-02 1 1  ON 18
 ud_9                 9.182110e-02 1 1  ON 19
 eO_0                -8.135151e-01 1 1  ON 20
 eO_1                -4.796056e-01 1 1  ON 21
 eO_2                -4.914399e-02 1 1  ON 22
 eO_3                 2.201028e-01 1 1  ON 23
 eO_4                 3.209789e-01 1 1  ON 24
 eO_5                 3.363584e-01 1 1  ON 25
 eO_6                 2.680275e-01 1 1  ON 26
 eO_7                 1.328261e-01 1 1  ON 27
 eO_8                 3.138686e-02 1 1  ON 28
 eO_9                 2.009875e-02 1 1  ON 29
eH1_0                -1.855624e-01 1 1  ON 30
eH1_1                -1.063768e-01 1 1  ON 31
eH1_2                -6.337418e-02 1 1  ON 32
eH1_3                -2.539224e-02 1 1  ON 33
eH1_4                 1.883359e-02 1 1  ON 34
eH1_5                 3.049709e-02 1 1  ON 35
eH1_6                 7.524881e-02 1 1  ON 36
eH1_7                 1.082292e-01 1 1  ON 37
eH1_8                 1.024315e-01 1 1  ON 38
eH1_9                 2.856609e-02 1 1  ON 39
eH2_0                -1.872924e-01 1 1  ON 40
eH2_1                -1.078250e-01 1 1  ON 41
eH2_2                -6.483448e-02 1 1  ON 42
eH2_3                -2.692404e-02 1 1  ON 43
eH2_4                 1.813333e-02 1 1  ON 44
eH2_5                 3.070926e-02 1 1  ON 45
eH2_6                 7.586797e-02 1 1  ON 46
eH2_7                 1.119669e-01 1 1  ON 47
eH2_8                 1.060743e-01 1 1  ON 48
eH2_9                 3.008139e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2649
    reference variance = 0.225295
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4387e-01
  Total weights = 2.0000e+06
  Execution time = 1.5670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343840843789
                                         uncertainty =       0.004916787374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343840843789
                                         uncertainty =       0.004916787374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414595402
  error estimate for blocks of size 2^( 2) =       0.000425199582
  error estimate for blocks of size 2^( 3) =       0.000433996761
  error estimate for blocks of size 2^( 4) =       0.000440999825
  error estimate for blocks of size 2^( 5) =       0.000445920813
  error estimate for blocks of size 2^( 6) =       0.000448465977
  error estimate for blocks of size 2^( 7) =       0.000449726320

      target function =                  N/A
              le_mean =     -17.211772081513
             les_mean =     296.588876708876
             stat err =       0.000446278234
             autocorr =       1.158677166379
              std dev =       0.586326440501
             le_variance =       0.343778694831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344080155192
                                         uncertainty =       0.004924165486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344080155192
                                         uncertainty =       0.004924165486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414739619
  error estimate for blocks of size 2^( 2) =       0.000425337493
  error estimate for blocks of size 2^( 3) =       0.000434126222
  error estimate for blocks of size 2^( 4) =       0.000441119457
  error estimate for blocks of size 2^( 5) =       0.000446034780
  error estimate for blocks of size 2^( 6) =       0.000448573841
  error estimate for blocks of size 2^( 7) =       0.000449832683

      target function =                  N/A
              le_mean =     -17.211771826044
             les_mean =     296.589107122226
             stat err =       0.000446390190
             autocorr =       1.158452513158
              std dev =       0.586530393440
             le_variance =       0.344017902429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344035008406
                                         uncertainty =       0.004923293901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344035008406
                                         uncertainty =       0.004923293901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414712411
  error estimate for blocks of size 2^( 2) =       0.000425310446
  error estimate for blocks of size 2^( 3) =       0.000434100291
  error estimate for blocks of size 2^( 4) =       0.000441095339
  error estimate for blocks of size 2^( 5) =       0.000446010584
  error estimate for blocks of size 2^( 6) =       0.000448549959
  error estimate for blocks of size 2^( 7) =       0.000449809366

      target function =                  N/A
              le_mean =     -17.211772583675
             les_mean =     296.589088067313
             stat err =       0.000446366312
             autocorr =       1.158480576045
              std dev =       0.586491915671
             le_variance =       0.343972767148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343876844838
                                         uncertainty =       0.004917996701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343876844838
                                         uncertainty =       0.004917996701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414617102
  error estimate for blocks of size 2^( 2) =       0.000425220124
  error estimate for blocks of size 2^( 3) =       0.000434016006
  error estimate for blocks of size 2^( 4) =       0.000441017832
  error estimate for blocks of size 2^( 5) =       0.000445937751
  error estimate for blocks of size 2^( 6) =       0.000448481905
  error estimate for blocks of size 2^( 7) =       0.000449742071

      target function =                  N/A
              le_mean =     -17.211772117557
             les_mean =     296.588913937229
             stat err =       0.000446294890
             autocorr =       1.158642365661
              std dev =       0.586357128744
             le_variance =       0.343814682428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211772081513        initial
     1.5259e-01     1.5259e+00             1.0611e-03       -17.211771826044
     6.1035e-01     6.1035e+00             2.8804e-04       -17.211772583675  <--
     2.4414e+00     2.4414e+01             8.3388e-05       -17.211772117557

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.8916e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.193533e-01 1 1  ON 0
 uu_1                 5.346357e-02 1 1  ON 1
 uu_2                -4.620173e-02 1 1  ON 2
 uu_3                -1.035246e-01 1 1  ON 3
 uu_4                -1.367296e-01 1 1  ON 4
 uu_5                -1.428891e-01 1 1  ON 5
 uu_6                -1.202619e-01 1 1  ON 6
 uu_7                -5.093006e-02 1 1  ON 7
 uu_8                 8.896987e-02 1 1  ON 8
 uu_9                 1.315018e-01 1 1  ON 9
 ud_0                 3.694517e-01 1 1  ON 10
 ud_1                 1.030486e-01 1 1  ON 11
 ud_2                -1.471483e-02 1 1  ON 12
 ud_3                -7.874182e-02 1 1  ON 13
 ud_4                -1.264957e-01 1 1  ON 14
 ud_5                -1.575208e-01 1 1  ON 15
 ud_6                -1.595773e-01 1 1  ON 16
 ud_7                -1.161029e-01 1 1  ON 17
 ud_8                -1.625395e-02 1 1  ON 18
 ud_9                 9.182110e-02 1 1  ON 19
 eO_0                -8.135151e-01 1 1  ON 20
 eO_1                -4.796056e-01 1 1  ON 21
 eO_2                -4.914399e-02 1 1  ON 22
 eO_3                 2.201028e-01 1 1  ON 23
 eO_4                 3.209789e-01 1 1  ON 24
 eO_5                 3.363584e-01 1 1  ON 25
 eO_6                 2.680275e-01 1 1  ON 26
 eO_7                 1.328261e-01 1 1  ON 27
 eO_8                 3.138686e-02 1 1  ON 28
 eO_9                 2.009875e-02 1 1  ON 29
eH1_0                -1.855624e-01 1 1  ON 30
eH1_1                -1.063768e-01 1 1  ON 31
eH1_2                -6.337418e-02 1 1  ON 32
eH1_3                -2.539224e-02 1 1  ON 33
eH1_4                 1.883359e-02 1 1  ON 34
eH1_5                 3.049709e-02 1 1  ON 35
eH1_6                 7.524881e-02 1 1  ON 36
eH1_7                 1.082292e-01 1 1  ON 37
eH1_8                 1.024315e-01 1 1  ON 38
eH1_9                 2.856609e-02 1 1  ON 39
eH2_0                -1.872924e-01 1 1  ON 40
eH2_1                -1.078250e-01 1 1  ON 41
eH2_2                -6.483448e-02 1 1  ON 42
eH2_3                -2.692404e-02 1 1  ON 43
eH2_4                 1.813333e-02 1 1  ON 44
eH2_5                 3.070926e-02 1 1  ON 45
eH2_6                 7.586797e-02 1 1  ON 46
eH2_7                 1.119669e-01 1 1  ON 47
eH2_8                 1.060743e-01 1 1  ON 48
eH2_9                 3.008139e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3318e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1596
    reference variance = 0.350864
====================================================
  Execution time = 1.9411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351083599628
                                         uncertainty =       0.008113056700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351083599628
                                         uncertainty =       0.008113056700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418919292
  error estimate for blocks of size 2^( 2) =       0.000429134229
  error estimate for blocks of size 2^( 3) =       0.000438053109
  error estimate for blocks of size 2^( 4) =       0.000444548859
  error estimate for blocks of size 2^( 5) =       0.000448962026
  error estimate for blocks of size 2^( 6) =       0.000450323157
  error estimate for blocks of size 2^( 7) =       0.000451414763

      target function =                  N/A
              le_mean =     -17.212371831423
             les_mean =     296.616730633725
             stat err =       0.000448812201
             autocorr =       1.147806259274
              std dev =       0.592441343968
             le_variance =       0.350986746043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721237183142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212371831423       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212370884253       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212371348162       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212371070136       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212372021957       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212372312505       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212372915359       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212372580112       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212372472354       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212372489093       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.032785e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212371831423       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212371395997       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212371606105       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212371498131       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212371880957       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212371822210       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212371991505       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212371929476       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.353268e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212371831423       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212371693680       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212371757221       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212371726509       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212371843125       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212371809306       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212371844483       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212371834489       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.959545e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4705e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.194388e-01 1 1  ON 0
 uu_1                 5.347299e-02 1 1  ON 1
 uu_2                -4.621237e-02 1 1  ON 2
 uu_3                -1.034927e-01 1 1  ON 3
 uu_4                -1.367099e-01 1 1  ON 4
 uu_5                -1.429194e-01 1 1  ON 5
 uu_6                -1.203251e-01 1 1  ON 6
 uu_7                -5.101571e-02 1 1  ON 7
 uu_8                 8.886405e-02 1 1  ON 8
 uu_9                 1.315650e-01 1 1  ON 9
 ud_0                 3.695711e-01 1 1  ON 10
 ud_1                 1.031981e-01 1 1  ON 11
 ud_2                -1.472229e-02 1 1  ON 12
 ud_3                -7.879303e-02 1 1  ON 13
 ud_4                -1.265185e-01 1 1  ON 14
 ud_5                -1.574774e-01 1 1  ON 15
 ud_6                -1.596859e-01 1 1  ON 16
 ud_7                -1.161872e-01 1 1  ON 17
 ud_8                -1.637504e-02 1 1  ON 18
 ud_9                 9.181811e-02 1 1  ON 19
 eO_0                -8.137041e-01 1 1  ON 20
 eO_1                -4.799410e-01 1 1  ON 21
 eO_2                -4.920082e-02 1 1  ON 22
 eO_3                 2.200492e-01 1 1  ON 23
 eO_4                 3.210980e-01 1 1  ON 24
 eO_5                 3.364549e-01 1 1  ON 25
 eO_6                 2.681935e-01 1 1  ON 26
 eO_7                 1.330257e-01 1 1  ON 27
 eO_8                 3.141963e-02 1 1  ON 28
 eO_9                 2.011012e-02 1 1  ON 29
eH1_0                -1.855721e-01 1 1  ON 30
eH1_1                -1.063724e-01 1 1  ON 31
eH1_2                -6.337941e-02 1 1  ON 32
eH1_3                -2.546741e-02 1 1  ON 33
eH1_4                 1.885825e-02 1 1  ON 34
eH1_5                 3.046712e-02 1 1  ON 35
eH1_6                 7.518743e-02 1 1  ON 36
eH1_7                 1.082035e-01 1 1  ON 37
eH1_8                 1.025586e-01 1 1  ON 38
eH1_9                 2.860889e-02 1 1  ON 39
eH2_0                -1.872544e-01 1 1  ON 40
eH2_1                -1.078562e-01 1 1  ON 41
eH2_2                -6.478611e-02 1 1  ON 42
eH2_3                -2.684468e-02 1 1  ON 43
eH2_4                 1.807262e-02 1 1  ON 44
eH2_5                 3.061827e-02 1 1  ON 45
eH2_6                 7.581604e-02 1 1  ON 46
eH2_7                 1.119080e-01 1 1  ON 47
eH2_8                 1.061560e-01 1 1  ON 48
eH2_9                 3.011256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2161
    reference variance = 0.159261
====================================================
  Execution time = 1.8493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3688e-01
  Total weights = 2.0000e+06
  Execution time = 1.5717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336873404593
                                         uncertainty =       0.002961955336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336873404593
                                         uncertainty =       0.002961955336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410366366
  error estimate for blocks of size 2^( 2) =       0.000421056586
  error estimate for blocks of size 2^( 3) =       0.000430923832
  error estimate for blocks of size 2^( 4) =       0.000438074440
  error estimate for blocks of size 2^( 5) =       0.000444533950
  error estimate for blocks of size 2^( 6) =       0.000446085742
  error estimate for blocks of size 2^( 7) =       0.000447583442

      target function =                  N/A
              le_mean =     -17.211847124434
             les_mean =     296.584482375479
             stat err =       0.000444069393
             autocorr =       1.171003425382
              std dev =       0.580345680615
             le_variance =       0.336801109009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337057907270
                                         uncertainty =       0.002963817627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337057907270
                                         uncertainty =       0.002963817627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410478708
  error estimate for blocks of size 2^( 2) =       0.000421163320
  error estimate for blocks of size 2^( 3) =       0.000431025130
  error estimate for blocks of size 2^( 4) =       0.000438168914
  error estimate for blocks of size 2^( 5) =       0.000444623143
  error estimate for blocks of size 2^( 6) =       0.000446176960
  error estimate for blocks of size 2^( 7) =       0.000447676746

      target function =                  N/A
              le_mean =     -17.211847289273
             les_mean =     296.584672479778
             stat err =       0.000444161441
             autocorr =       1.170847782385
              std dev =       0.580504555552
             le_variance =       0.336985539016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337028905248
                                         uncertainty =       0.002963707290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337028905248
                                         uncertainty =       0.002963707290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410461034
  error estimate for blocks of size 2^( 2) =       0.000421146453
  error estimate for blocks of size 2^( 3) =       0.000431009829
  error estimate for blocks of size 2^( 4) =       0.000438154783
  error estimate for blocks of size 2^( 5) =       0.000444609545
  error estimate for blocks of size 2^( 6) =       0.000446164755
  error estimate for blocks of size 2^( 7) =       0.000447665565

      target function =                  N/A
              le_mean =     -17.211847324851
             les_mean =     296.584644685966
             stat err =       0.000444148662
             autocorr =       1.170881237778
              std dev =       0.580479560754
             le_variance =       0.336956520453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336892049427
                                         uncertainty =       0.002962193101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336892049427
                                         uncertainty =       0.002962193101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410377715
  error estimate for blocks of size 2^( 2) =       0.000421067285
  error estimate for blocks of size 2^( 3) =       0.000430934076
  error estimate for blocks of size 2^( 4) =       0.000438083829
  error estimate for blocks of size 2^( 5) =       0.000444542579
  error estimate for blocks of size 2^( 6) =       0.000446095110
  error estimate for blocks of size 2^( 7) =       0.000447593331

      target function =                  N/A
              le_mean =     -17.211847081330
             les_mean =     296.584499520171
             stat err =       0.000444078712
             autocorr =       1.170987806429
              std dev =       0.580361729863
             le_variance =       0.336819737489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211847124434        initial
     1.5259e-01     1.5259e+00             1.0328e-03       -17.211847289273
     6.1035e-01     6.1035e+00             3.3533e-04       -17.211847324851  <--
     2.4414e+00     2.4414e+01             9.9595e-05       -17.211847081330

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.6455e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.194388e-01 1 1  ON 0
 uu_1                 5.347299e-02 1 1  ON 1
 uu_2                -4.621237e-02 1 1  ON 2
 uu_3                -1.034927e-01 1 1  ON 3
 uu_4                -1.367099e-01 1 1  ON 4
 uu_5                -1.429194e-01 1 1  ON 5
 uu_6                -1.203251e-01 1 1  ON 6
 uu_7                -5.101571e-02 1 1  ON 7
 uu_8                 8.886405e-02 1 1  ON 8
 uu_9                 1.315650e-01 1 1  ON 9
 ud_0                 3.695711e-01 1 1  ON 10
 ud_1                 1.031981e-01 1 1  ON 11
 ud_2                -1.472229e-02 1 1  ON 12
 ud_3                -7.879303e-02 1 1  ON 13
 ud_4                -1.265185e-01 1 1  ON 14
 ud_5                -1.574774e-01 1 1  ON 15
 ud_6                -1.596859e-01 1 1  ON 16
 ud_7                -1.161872e-01 1 1  ON 17
 ud_8                -1.637504e-02 1 1  ON 18
 ud_9                 9.181811e-02 1 1  ON 19
 eO_0                -8.137041e-01 1 1  ON 20
 eO_1                -4.799410e-01 1 1  ON 21
 eO_2                -4.920082e-02 1 1  ON 22
 eO_3                 2.200492e-01 1 1  ON 23
 eO_4                 3.210980e-01 1 1  ON 24
 eO_5                 3.364549e-01 1 1  ON 25
 eO_6                 2.681935e-01 1 1  ON 26
 eO_7                 1.330257e-01 1 1  ON 27
 eO_8                 3.141963e-02 1 1  ON 28
 eO_9                 2.011012e-02 1 1  ON 29
eH1_0                -1.855721e-01 1 1  ON 30
eH1_1                -1.063724e-01 1 1  ON 31
eH1_2                -6.337941e-02 1 1  ON 32
eH1_3                -2.546741e-02 1 1  ON 33
eH1_4                 1.885825e-02 1 1  ON 34
eH1_5                 3.046712e-02 1 1  ON 35
eH1_6                 7.518743e-02 1 1  ON 36
eH1_7                 1.082035e-01 1 1  ON 37
eH1_8                 1.025586e-01 1 1  ON 38
eH1_9                 2.860889e-02 1 1  ON 39
eH2_0                -1.872544e-01 1 1  ON 40
eH2_1                -1.078562e-01 1 1  ON 41
eH2_2                -6.478611e-02 1 1  ON 42
eH2_3                -2.684468e-02 1 1  ON 43
eH2_4                 1.807262e-02 1 1  ON 44
eH2_5                 3.061827e-02 1 1  ON 45
eH2_6                 7.581604e-02 1 1  ON 46
eH2_7                 1.119080e-01 1 1  ON 47
eH2_8                 1.061560e-01 1 1  ON 48
eH2_9                 3.011256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1165e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.166
    reference variance = 0.203992
====================================================
  Execution time = 1.9023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5169e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351768756511
                                         uncertainty =       0.008508807227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351768756511
                                         uncertainty =       0.008508807227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419338348
  error estimate for blocks of size 2^( 2) =       0.000429839565
  error estimate for blocks of size 2^( 3) =       0.000439321574
  error estimate for blocks of size 2^( 4) =       0.000446940391
  error estimate for blocks of size 2^( 5) =       0.000451351293
  error estimate for blocks of size 2^( 6) =       0.000453457065
  error estimate for blocks of size 2^( 7) =       0.000456007008

      target function =                  N/A
              le_mean =     -17.211576334589
             les_mean =     296.590049044991
             stat err =       0.000451938939
             autocorr =       1.161529822877
              std dev =       0.593033978326
             le_variance =       0.351689299450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721157633459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211576334589       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211576423895       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211574369610       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211574636233       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211574712402       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211574411533       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211574373974       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211575685493       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211575657097       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211575208743       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211575358549       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.105707e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211576334589       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211576373867       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211575364274       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211575456311       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211575329146       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211575037400       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211575077671       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211575453623       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.182175e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211576334589       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211576346709       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211576009508       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211575985282       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211575901496       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211575819341       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211575831401       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211575910926       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.418884e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4333e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.194190e-01 1 1  ON 0
 uu_1                 5.350493e-02 1 1  ON 1
 uu_2                -4.620026e-02 1 1  ON 2
 uu_3                -1.035045e-01 1 1  ON 3
 uu_4                -1.368011e-01 1 1  ON 4
 uu_5                -1.429231e-01 1 1  ON 5
 uu_6                -1.203214e-01 1 1  ON 6
 uu_7                -5.108469e-02 1 1  ON 7
 uu_8                 8.877360e-02 1 1  ON 8
 uu_9                 1.316716e-01 1 1  ON 9
 ud_0                 3.695587e-01 1 1  ON 10
 ud_1                 1.031288e-01 1 1  ON 11
 ud_2                -1.468007e-02 1 1  ON 12
 ud_3                -7.884022e-02 1 1  ON 13
 ud_4                -1.265989e-01 1 1  ON 14
 ud_5                -1.575881e-01 1 1  ON 15
 ud_6                -1.595690e-01 1 1  ON 16
 ud_7                -1.160478e-01 1 1  ON 17
 ud_8                -1.644465e-02 1 1  ON 18
 ud_9                 9.181131e-02 1 1  ON 19
 eO_0                -8.139951e-01 1 1  ON 20
 eO_1                -4.801070e-01 1 1  ON 21
 eO_2                -4.951904e-02 1 1  ON 22
 eO_3                 2.201247e-01 1 1  ON 23
 eO_4                 3.211569e-01 1 1  ON 24
 eO_5                 3.366276e-01 1 1  ON 25
 eO_6                 2.683790e-01 1 1  ON 26
 eO_7                 1.332475e-01 1 1  ON 27
 eO_8                 3.145452e-02 1 1  ON 28
 eO_9                 2.011937e-02 1 1  ON 29
eH1_0                -1.856636e-01 1 1  ON 30
eH1_1                -1.063504e-01 1 1  ON 31
eH1_2                -6.349499e-02 1 1  ON 32
eH1_3                -2.552894e-02 1 1  ON 33
eH1_4                 1.893910e-02 1 1  ON 34
eH1_5                 3.045645e-02 1 1  ON 35
eH1_6                 7.514216e-02 1 1  ON 36
eH1_7                 1.082383e-01 1 1  ON 37
eH1_8                 1.026792e-01 1 1  ON 38
eH1_9                 2.865360e-02 1 1  ON 39
eH2_0                -1.872121e-01 1 1  ON 40
eH2_1                -1.078291e-01 1 1  ON 41
eH2_2                -6.479443e-02 1 1  ON 42
eH2_3                -2.682290e-02 1 1  ON 43
eH2_4                 1.793431e-02 1 1  ON 44
eH2_5                 3.044244e-02 1 1  ON 45
eH2_6                 7.585009e-02 1 1  ON 46
eH2_7                 1.119526e-01 1 1  ON 47
eH2_8                 1.062663e-01 1 1  ON 48
eH2_9                 3.014516e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2522
    reference variance = 0.296197
====================================================
  Execution time = 1.8755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3749e-01
  Total weights = 2.0000e+06
  Execution time = 1.5801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337575456601
                                         uncertainty =       0.003075277736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337575456601
                                         uncertainty =       0.003075277736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410783185
  error estimate for blocks of size 2^( 2) =       0.000421464532
  error estimate for blocks of size 2^( 3) =       0.000432095141
  error estimate for blocks of size 2^( 4) =       0.000439303114
  error estimate for blocks of size 2^( 5) =       0.000443975264
  error estimate for blocks of size 2^( 6) =       0.000445700265
  error estimate for blocks of size 2^( 7) =       0.000448813456

      target function =                  N/A
              le_mean =     -17.211902113646
             les_mean =     296.587059851328
             stat err =       0.000444448025
             autocorr =       1.170621900223
              std dev =       0.580935151578
             le_variance =       0.337485650339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337651421054
                                         uncertainty =       0.003075479768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337651421054
                                         uncertainty =       0.003075479768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829381
  error estimate for blocks of size 2^( 2) =       0.000421510311
  error estimate for blocks of size 2^( 3) =       0.000432138945
  error estimate for blocks of size 2^( 4) =       0.000439346197
  error estimate for blocks of size 2^( 5) =       0.000444016778
  error estimate for blocks of size 2^( 6) =       0.000445739319
  error estimate for blocks of size 2^( 7) =       0.000448861647

      target function =                  N/A
              le_mean =     -17.211903331676
             les_mean =     296.587177691559
             stat err =       0.000444490986
             autocorr =       1.170584917468
              std dev =       0.581000483120
             le_variance =       0.337561561385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337589311663
                                         uncertainty =       0.003074826388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337589311663
                                         uncertainty =       0.003074826388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410791598
  error estimate for blocks of size 2^( 2) =       0.000421473910
  error estimate for blocks of size 2^( 3) =       0.000432104775
  error estimate for blocks of size 2^( 4) =       0.000439313998
  error estimate for blocks of size 2^( 5) =       0.000443986500
  error estimate for blocks of size 2^( 6) =       0.000445711121
  error estimate for blocks of size 2^( 7) =       0.000448834463

      target function =                  N/A
              le_mean =     -17.211902643619
             les_mean =     296.587091918932
             stat err =       0.000444461520
             autocorr =       1.170645042240
              std dev =       0.580947049462
             le_variance =       0.337499474279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579560567
                                         uncertainty =       0.003075217013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579560567
                                         uncertainty =       0.003075217013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410785680
  error estimate for blocks of size 2^( 2) =       0.000421467095
  error estimate for blocks of size 2^( 3) =       0.000432097768
  error estimate for blocks of size 2^( 4) =       0.000439306056
  error estimate for blocks of size 2^( 5) =       0.000443978280
  error estimate for blocks of size 2^( 6) =       0.000445703270
  error estimate for blocks of size 2^( 7) =       0.000448818523

      target function =                  N/A
              le_mean =     -17.211902123397
             les_mean =     296.587064286774
             stat err =       0.000444451532
             autocorr =       1.170626156626
              std dev =       0.580938680160
             le_variance =       0.337489750106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211902113646        initial
     1.5259e-01     1.5259e+00             1.1057e-03       -17.211903331676  <--
     6.1035e-01     6.1035e+00             3.1822e-04       -17.211902643619
     2.4414e+00     2.4414e+01             9.4189e-05       -17.211902123397

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.6748e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.194744e-01 1 1  ON 0
 uu_1                 5.357157e-02 1 1  ON 1
 uu_2                -4.618116e-02 1 1  ON 2
 uu_3                -1.035355e-01 1 1  ON 3
 uu_4                -1.369640e-01 1 1  ON 4
 uu_5                -1.430242e-01 1 1  ON 5
 uu_6                -1.203966e-01 1 1  ON 6
 uu_7                -5.131251e-02 1 1  ON 7
 uu_8                 8.849094e-02 1 1  ON 8
 uu_9                 1.320017e-01 1 1  ON 9
 ud_0                 3.695348e-01 1 1  ON 10
 ud_1                 1.030633e-01 1 1  ON 11
 ud_2                -1.469329e-02 1 1  ON 12
 ud_3                -7.891671e-02 1 1  ON 13
 ud_4                -1.267719e-01 1 1  ON 14
 ud_5                -1.577844e-01 1 1  ON 15
 ud_6                -1.594457e-01 1 1  ON 16
 ud_7                -1.156926e-01 1 1  ON 17
 ud_8                -1.665909e-02 1 1  ON 18
 ud_9                 9.179094e-02 1 1  ON 19
 eO_0                -8.148098e-01 1 1  ON 20
 eO_1                -4.807165e-01 1 1  ON 21
 eO_2                -5.016534e-02 1 1  ON 22
 eO_3                 2.200559e-01 1 1  ON 23
 eO_4                 3.213496e-01 1 1  ON 24
 eO_5                 3.371351e-01 1 1  ON 25
 eO_6                 2.689397e-01 1 1  ON 26
 eO_7                 1.339360e-01 1 1  ON 27
 eO_8                 3.156349e-02 1 1  ON 28
 eO_9                 2.014819e-02 1 1  ON 29
eH1_0                -1.858589e-01 1 1  ON 30
eH1_1                -1.064090e-01 1 1  ON 31
eH1_2                -6.368333e-02 1 1  ON 32
eH1_3                -2.567131e-02 1 1  ON 33
eH1_4                 1.899861e-02 1 1  ON 34
eH1_5                 3.043176e-02 1 1  ON 35
eH1_6                 7.501056e-02 1 1  ON 36
eH1_7                 1.083393e-01 1 1  ON 37
eH1_8                 1.030533e-01 1 1  ON 38
eH1_9                 2.879269e-02 1 1  ON 39
eH2_0                -1.871210e-01 1 1  ON 40
eH2_1                -1.078086e-01 1 1  ON 41
eH2_2                -6.482425e-02 1 1  ON 42
eH2_3                -2.684188e-02 1 1  ON 43
eH2_4                 1.771939e-02 1 1  ON 44
eH2_5                 2.993637e-02 1 1  ON 45
eH2_6                 7.591075e-02 1 1  ON 46
eH2_7                 1.120765e-01 1 1  ON 47
eH2_8                 1.066081e-01 1 1  ON 48
eH2_9                 3.024662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.144905
====================================================
  Execution time = 1.9384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4662e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346627658285
                                         uncertainty =       0.004404431048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346627658285
                                         uncertainty =       0.004404431048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416306481
  error estimate for blocks of size 2^( 2) =       0.000426771343
  error estimate for blocks of size 2^( 3) =       0.000436574510
  error estimate for blocks of size 2^( 4) =       0.000443384784
  error estimate for blocks of size 2^( 5) =       0.000448061479
  error estimate for blocks of size 2^( 6) =       0.000450293998
  error estimate for blocks of size 2^( 7) =       0.000451078411

      target function =                  N/A
              le_mean =     -17.211930450370
             les_mean =     296.597171827673
             stat err =       0.000448204668
             autocorr =       1.159114680645
              std dev =       0.588746271832
             le_variance =       0.346622172596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721193045037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211930450370       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211931171449       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211931350050       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211932646471       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211935087846       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211935702806       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211937899335       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211936262270       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211939457091       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211938767946       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211939044763       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211938031361       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211938026250       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 3.449721e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211930450370       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211930922925       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211930800510       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211931657061       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211933483405       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211933768025       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211934141222       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211933526215       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211934351959       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211934145439       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211934022893       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 8.904517e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211930450370       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211930649038       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211930474369       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211931034755       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211931794254       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211931768365       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211931863136       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211931666680       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.393371e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062418 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4651e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.198298e-01 1 1  ON 0
 uu_1                 5.357333e-02 1 1  ON 1
 uu_2                -4.608568e-02 1 1  ON 2
 uu_3                -1.034889e-01 1 1  ON 3
 uu_4                -1.368311e-01 1 1  ON 4
 uu_5                -1.434685e-01 1 1  ON 5
 uu_6                -1.207544e-01 1 1  ON 6
 uu_7                -5.155216e-02 1 1  ON 7
 uu_8                 8.822227e-02 1 1  ON 8
 uu_9                 1.323435e-01 1 1  ON 9
 ud_0                 3.695232e-01 1 1  ON 10
 ud_1                 1.030156e-01 1 1  ON 11
 ud_2                -1.477392e-02 1 1  ON 12
 ud_3                -7.872968e-02 1 1  ON 13
 ud_4                -1.266201e-01 1 1  ON 14
 ud_5                -1.573279e-01 1 1  ON 15
 ud_6                -1.597385e-01 1 1  ON 16
 ud_7                -1.159788e-01 1 1  ON 17
 ud_8                -1.702566e-02 1 1  ON 18
 ud_9                 9.178755e-02 1 1  ON 19
 eO_0                -8.157003e-01 1 1  ON 20
 eO_1                -4.812666e-01 1 1  ON 21
 eO_2                -5.061926e-02 1 1  ON 22
 eO_3                 2.195749e-01 1 1  ON 23
 eO_4                 3.212958e-01 1 1  ON 24
 eO_5                 3.376006e-01 1 1  ON 25
 eO_6                 2.697864e-01 1 1  ON 26
 eO_7                 1.348099e-01 1 1  ON 27
 eO_8                 3.174154e-02 1 1  ON 28
 eO_9                 2.018843e-02 1 1  ON 29
eH1_0                -1.859190e-01 1 1  ON 30
eH1_1                -1.067055e-01 1 1  ON 31
eH1_2                -6.355470e-02 1 1  ON 32
eH1_3                -2.587405e-02 1 1  ON 33
eH1_4                 1.886645e-02 1 1  ON 34
eH1_5                 3.050952e-02 1 1  ON 35
eH1_6                 7.485682e-02 1 1  ON 36
eH1_7                 1.083910e-01 1 1  ON 37
eH1_8                 1.034798e-01 1 1  ON 38
eH1_9                 2.892247e-02 1 1  ON 39
eH2_0                -1.870016e-01 1 1  ON 40
eH2_1                -1.073734e-01 1 1  ON 41
eH2_2                -6.445553e-02 1 1  ON 42
eH2_3                -2.676918e-02 1 1  ON 43
eH2_4                 1.735029e-02 1 1  ON 44
eH2_5                 2.948237e-02 1 1  ON 45
eH2_6                 7.527160e-02 1 1  ON 46
eH2_7                 1.118746e-01 1 1  ON 47
eH2_8                 1.070791e-01 1 1  ON 48
eH2_9                 3.038956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2376
    reference variance = 0.226266
====================================================
  Execution time = 1.8587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5203e-01
  Total weights = 2.0000e+06
  Execution time = 1.6246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351967310931
                                         uncertainty =       0.006398348711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351967310931
                                         uncertainty =       0.006398348711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419492917
  error estimate for blocks of size 2^( 2) =       0.000429751315
  error estimate for blocks of size 2^( 3) =       0.000439194038
  error estimate for blocks of size 2^( 4) =       0.000445854844
  error estimate for blocks of size 2^( 5) =       0.000450145814
  error estimate for blocks of size 2^( 6) =       0.000450730665
  error estimate for blocks of size 2^( 7) =       0.000452733989

      target function =                  N/A
              le_mean =     -17.212361010434
             les_mean =     296.617319992450
             stat err =       0.000449866328
             autocorr =       1.150052617998
              std dev =       0.593252572607
             le_variance =       0.351948614905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352069276449
                                         uncertainty =       0.006408953979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352069276449
                                         uncertainty =       0.006408953979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419553617
  error estimate for blocks of size 2^( 2) =       0.000429808464
  error estimate for blocks of size 2^( 3) =       0.000439249778
  error estimate for blocks of size 2^( 4) =       0.000445914061
  error estimate for blocks of size 2^( 5) =       0.000450204220
  error estimate for blocks of size 2^( 6) =       0.000450786335
  error estimate for blocks of size 2^( 7) =       0.000452796049

      target function =                  N/A
              le_mean =     -17.212363547026
             les_mean =     296.617509174149
             stat err =       0.000449925166
             autocorr =       1.150020632829
              std dev =       0.593338415385
             le_variance =       0.352050475172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352133716920
                                         uncertainty =       0.006412617601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352133716920
                                         uncertainty =       0.006412617601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419592022
  error estimate for blocks of size 2^( 2) =       0.000429844206
  error estimate for blocks of size 2^( 3) =       0.000439286096
  error estimate for blocks of size 2^( 4) =       0.000445955134
  error estimate for blocks of size 2^( 5) =       0.000450244843
  error estimate for blocks of size 2^( 6) =       0.000450828370
  error estimate for blocks of size 2^( 7) =       0.000452837395

      target function =                  N/A
              le_mean =     -17.212364051787
             les_mean =     296.617591005474
             stat err =       0.000449966436
             autocorr =       1.150021062425
              std dev =       0.593392728533
             le_variance =       0.352114930275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352020481375
                                         uncertainty =       0.006401745638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352020481375
                                         uncertainty =       0.006401745638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419524596
  error estimate for blocks of size 2^( 2) =       0.000429780896
  error estimate for blocks of size 2^( 3) =       0.000439222731
  error estimate for blocks of size 2^( 4) =       0.000445884992
  error estimate for blocks of size 2^( 5) =       0.000450175275
  error estimate for blocks of size 2^( 6) =       0.000450759113
  error estimate for blocks of size 2^( 7) =       0.000452762971

      target function =                  N/A
              le_mean =     -17.212361149671
             les_mean =     296.617377943204
             stat err =       0.000449895588
             autocorr =       1.150028526122
              std dev =       0.593297372751
             le_variance =       0.352001772513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212361010434        initial
     3.8147e-02     3.8147e-01             3.4497e-03       -17.212363547026
     1.5259e-01     1.5259e+00             8.9045e-04       -17.212364051787  <--
     6.1035e-01     6.1035e+00             2.3934e-04       -17.212361149671

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.6665e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.198298e-01 1 1  ON 0
 uu_1                 5.357333e-02 1 1  ON 1
 uu_2                -4.608568e-02 1 1  ON 2
 uu_3                -1.034889e-01 1 1  ON 3
 uu_4                -1.368311e-01 1 1  ON 4
 uu_5                -1.434685e-01 1 1  ON 5
 uu_6                -1.207544e-01 1 1  ON 6
 uu_7                -5.155216e-02 1 1  ON 7
 uu_8                 8.822227e-02 1 1  ON 8
 uu_9                 1.323435e-01 1 1  ON 9
 ud_0                 3.695232e-01 1 1  ON 10
 ud_1                 1.030156e-01 1 1  ON 11
 ud_2                -1.477392e-02 1 1  ON 12
 ud_3                -7.872968e-02 1 1  ON 13
 ud_4                -1.266201e-01 1 1  ON 14
 ud_5                -1.573279e-01 1 1  ON 15
 ud_6                -1.597385e-01 1 1  ON 16
 ud_7                -1.159788e-01 1 1  ON 17
 ud_8                -1.702566e-02 1 1  ON 18
 ud_9                 9.178755e-02 1 1  ON 19
 eO_0                -8.157003e-01 1 1  ON 20
 eO_1                -4.812666e-01 1 1  ON 21
 eO_2                -5.061926e-02 1 1  ON 22
 eO_3                 2.195749e-01 1 1  ON 23
 eO_4                 3.212958e-01 1 1  ON 24
 eO_5                 3.376006e-01 1 1  ON 25
 eO_6                 2.697864e-01 1 1  ON 26
 eO_7                 1.348099e-01 1 1  ON 27
 eO_8                 3.174154e-02 1 1  ON 28
 eO_9                 2.018843e-02 1 1  ON 29
eH1_0                -1.859190e-01 1 1  ON 30
eH1_1                -1.067055e-01 1 1  ON 31
eH1_2                -6.355470e-02 1 1  ON 32
eH1_3                -2.587405e-02 1 1  ON 33
eH1_4                 1.886645e-02 1 1  ON 34
eH1_5                 3.050952e-02 1 1  ON 35
eH1_6                 7.485682e-02 1 1  ON 36
eH1_7                 1.083910e-01 1 1  ON 37
eH1_8                 1.034798e-01 1 1  ON 38
eH1_9                 2.892247e-02 1 1  ON 39
eH2_0                -1.870016e-01 1 1  ON 40
eH2_1                -1.073734e-01 1 1  ON 41
eH2_2                -6.445553e-02 1 1  ON 42
eH2_3                -2.676918e-02 1 1  ON 43
eH2_4                 1.735029e-02 1 1  ON 44
eH2_5                 2.948237e-02 1 1  ON 45
eH2_6                 7.527160e-02 1 1  ON 46
eH2_7                 1.118746e-01 1 1  ON 47
eH2_8                 1.070791e-01 1 1  ON 48
eH2_9                 3.038956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1321e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2527
    reference variance = 0.250668
====================================================
  Execution time = 1.8868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4317e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343081541668
                                         uncertainty =       0.003248370025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343081541668
                                         uncertainty =       0.003248370025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414226303
  error estimate for blocks of size 2^( 2) =       0.000425021656
  error estimate for blocks of size 2^( 3) =       0.000434758311
  error estimate for blocks of size 2^( 4) =       0.000442116939
  error estimate for blocks of size 2^( 5) =       0.000446774629
  error estimate for blocks of size 2^( 6) =       0.000449402373
  error estimate for blocks of size 2^( 7) =       0.000450164252

      target function =                  N/A
              le_mean =     -17.212459048546
             les_mean =     296.611913186606
             stat err =       0.000447114548
             autocorr =       1.165097462866
              std dev =       0.585804455698
             le_variance =       0.343166860316


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721245904855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212459048546       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212458967661       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212458575530       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212460409355       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212459186648       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212459960742       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212460751191       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212458985656       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212458806718       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212458829197       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212460319473       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212460450095       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 3.356229e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212459048546       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212458997969       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212458800179       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212460229270       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212459884164       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212459645304       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212460320921       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212459737685       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212459742010       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212459834279       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 8.835785e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212459048546       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212459028305       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212458974162       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212459692589       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212459727804       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212459442165       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212459618127       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212459517494       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.302276e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4162e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.199411e-01 1 1  ON 0
 uu_1                 5.359117e-02 1 1  ON 1
 uu_2                -4.605706e-02 1 1  ON 2
 uu_3                -1.034408e-01 1 1  ON 3
 uu_4                -1.369601e-01 1 1  ON 4
 uu_5                -1.436567e-01 1 1  ON 5
 uu_6                -1.209746e-01 1 1  ON 6
 uu_7                -5.180467e-02 1 1  ON 7
 uu_8                 8.787171e-02 1 1  ON 8
 uu_9                 1.326470e-01 1 1  ON 9
 ud_0                 3.692710e-01 1 1  ON 10
 ud_1                 1.030593e-01 1 1  ON 11
 ud_2                -1.495372e-02 1 1  ON 12
 ud_3                -7.901209e-02 1 1  ON 13
 ud_4                -1.267262e-01 1 1  ON 14
 ud_5                -1.574958e-01 1 1  ON 15
 ud_6                -1.594264e-01 1 1  ON 16
 ud_7                -1.156061e-01 1 1  ON 17
 ud_8                -1.728779e-02 1 1  ON 18
 ud_9                 9.178878e-02 1 1  ON 19
 eO_0                -8.165838e-01 1 1  ON 20
 eO_1                -4.820786e-01 1 1  ON 21
 eO_2                -5.123753e-02 1 1  ON 22
 eO_3                 2.193974e-01 1 1  ON 23
 eO_4                 3.212496e-01 1 1  ON 24
 eO_5                 3.381905e-01 1 1  ON 25
 eO_6                 2.706460e-01 1 1  ON 26
 eO_7                 1.356617e-01 1 1  ON 27
 eO_8                 3.184779e-02 1 1  ON 28
 eO_9                 2.022366e-02 1 1  ON 29
eH1_0                -1.860873e-01 1 1  ON 30
eH1_1                -1.067799e-01 1 1  ON 31
eH1_2                -6.385388e-02 1 1  ON 32
eH1_3                -2.600220e-02 1 1  ON 33
eH1_4                 1.906737e-02 1 1  ON 34
eH1_5                 3.051024e-02 1 1  ON 35
eH1_6                 7.466055e-02 1 1  ON 36
eH1_7                 1.083990e-01 1 1  ON 37
eH1_8                 1.039221e-01 1 1  ON 38
eH1_9                 2.909136e-02 1 1  ON 39
eH2_0                -1.869115e-01 1 1  ON 40
eH2_1                -1.075666e-01 1 1  ON 41
eH2_2                -6.462926e-02 1 1  ON 42
eH2_3                -2.696165e-02 1 1  ON 43
eH2_4                 1.738920e-02 1 1  ON 44
eH2_5                 2.941396e-02 1 1  ON 45
eH2_6                 7.506315e-02 1 1  ON 46
eH2_7                 1.117022e-01 1 1  ON 47
eH2_8                 1.076480e-01 1 1  ON 48
eH2_9                 3.057139e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1792
    reference variance = 0.310516
====================================================
  Execution time = 1.9013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4079e-01
  Total weights = 2.0000e+06
  Execution time = 1.5765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340887169313
                                         uncertainty =       0.003177847181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340887169313
                                         uncertainty =       0.003177847181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412829141
  error estimate for blocks of size 2^( 2) =       0.000423603376
  error estimate for blocks of size 2^( 3) =       0.000432999270
  error estimate for blocks of size 2^( 4) =       0.000439816127
  error estimate for blocks of size 2^( 5) =       0.000443792995
  error estimate for blocks of size 2^( 6) =       0.000446726993
  error estimate for blocks of size 2^( 7) =       0.000449273425

      target function =                  N/A
              le_mean =     -17.212118146962
             les_mean =     296.597866733463
             stat err =       0.000444902385
             autocorr =       1.161418599555
              std dev =       0.583828569799
             le_variance =       0.340855798914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873977998
                                         uncertainty =       0.003178956059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873977998
                                         uncertainty =       0.003178956059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412821123
  error estimate for blocks of size 2^( 2) =       0.000423597418
  error estimate for blocks of size 2^( 3) =       0.000432987487
  error estimate for blocks of size 2^( 4) =       0.000439800148
  error estimate for blocks of size 2^( 5) =       0.000443767886
  error estimate for blocks of size 2^( 6) =       0.000446688358
  error estimate for blocks of size 2^( 7) =       0.000449223728

      target function =                  N/A
              le_mean =     -17.212119763293
             les_mean =     296.597909134655
             stat err =       0.000444870030
             autocorr =       1.161294785354
              std dev =       0.583817230946
             le_variance =       0.340842559150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340764451591
                                         uncertainty =       0.003176908980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340764451591
                                         uncertainty =       0.003176908980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412754776
  error estimate for blocks of size 2^( 2) =       0.000423534779
  error estimate for blocks of size 2^( 3) =       0.000432928363
  error estimate for blocks of size 2^( 4) =       0.000439742981
  error estimate for blocks of size 2^( 5) =       0.000443711424
  error estimate for blocks of size 2^( 6) =       0.000446633656
  error estimate for blocks of size 2^( 7) =       0.000449169889

      target function =                  N/A
              le_mean =     -17.212119432552
             les_mean =     296.597788199755
             stat err =       0.000444814488
             autocorr =       1.161378103931
              std dev =       0.583723401704
             le_variance =       0.340733009697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795618029
                                         uncertainty =       0.003176929378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340795618029
                                         uncertainty =       0.003176929378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412773690
  error estimate for blocks of size 2^( 2) =       0.000423550587
  error estimate for blocks of size 2^( 3) =       0.000432947324
  error estimate for blocks of size 2^( 4) =       0.000439764651
  error estimate for blocks of size 2^( 5) =       0.000443740247
  error estimate for blocks of size 2^( 6) =       0.000446671683
  error estimate for blocks of size 2^( 7) =       0.000449216099

      target function =                  N/A
              le_mean =     -17.212118300085
             les_mean =     296.597780444614
             stat err =       0.000444848170
             autocorr =       1.161447544196
              std dev =       0.583750151067
             le_variance =       0.340764238871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212118146962        initial
     3.8147e-02     3.8147e-01             3.3562e-03       -17.212119763293  <--
     1.5259e-01     1.5259e+00             8.8358e-04       -17.212119432552
     6.1035e-01     6.1035e+00             2.3023e-04       -17.212118300085

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 2.7010e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.201895e-01 1 1  ON 0
 uu_1                 5.377459e-02 1 1  ON 1
 uu_2                -4.592311e-02 1 1  ON 2
 uu_3                -1.033977e-01 1 1  ON 3
 uu_4                -1.371672e-01 1 1  ON 4
 uu_5                -1.440298e-01 1 1  ON 5
 uu_6                -1.218906e-01 1 1  ON 6
 uu_7                -5.263305e-02 1 1  ON 7
 uu_8                 8.684923e-02 1 1  ON 8
 uu_9                 1.335358e-01 1 1  ON 9
 ud_0                 3.690007e-01 1 1  ON 10
 ud_1                 1.028903e-01 1 1  ON 11
 ud_2                -1.519485e-02 1 1  ON 12
 ud_3                -7.931628e-02 1 1  ON 13
 ud_4                -1.270498e-01 1 1  ON 14
 ud_5                -1.578129e-01 1 1  ON 15
 ud_6                -1.595042e-01 1 1  ON 16
 ud_7                -1.147320e-01 1 1  ON 17
 ud_8                -1.800065e-02 1 1  ON 18
 ud_9                 9.180277e-02 1 1  ON 19
 eO_0                -8.188537e-01 1 1  ON 20
 eO_1                -4.841739e-01 1 1  ON 21
 eO_2                -5.309175e-02 1 1  ON 22
 eO_3                 2.183911e-01 1 1  ON 23
 eO_4                 3.211700e-01 1 1  ON 24
 eO_5                 3.398182e-01 1 1  ON 25
 eO_6                 2.731204e-01 1 1  ON 26
 eO_7                 1.381661e-01 1 1  ON 27
 eO_8                 3.216461e-02 1 1  ON 28
 eO_9                 2.032754e-02 1 1  ON 29
eH1_0                -1.864073e-01 1 1  ON 30
eH1_1                -1.071012e-01 1 1  ON 31
eH1_2                -6.423954e-02 1 1  ON 32
eH1_3                -2.622503e-02 1 1  ON 33
eH1_4                 1.898723e-02 1 1  ON 34
eH1_5                 3.048632e-02 1 1  ON 35
eH1_6                 7.409136e-02 1 1  ON 36
eH1_7                 1.083961e-01 1 1  ON 37
eH1_8                 1.052172e-01 1 1  ON 38
eH1_9                 2.958860e-02 1 1  ON 39
eH2_0                -1.870550e-01 1 1  ON 40
eH2_1                -1.078566e-01 1 1  ON 41
eH2_2                -6.491128e-02 1 1  ON 42
eH2_3                -2.720151e-02 1 1  ON 43
eH2_4                 1.720011e-02 1 1  ON 44
eH2_5                 2.914250e-02 1 1  ON 45
eH2_6                 7.442731e-02 1 1  ON 46
eH2_7                 1.111758e-01 1 1  ON 47
eH2_8                 1.093133e-01 1 1  ON 48
eH2_9                 3.110592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2536
    reference variance = 0.421803
====================================================
  Execution time = 1.8777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.8128e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381295413732
                                         uncertainty =       0.041448771638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381295413732
                                         uncertainty =       0.041448771638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436626069
  error estimate for blocks of size 2^( 2) =       0.000446658330
  error estimate for blocks of size 2^( 3) =       0.000455714191
  error estimate for blocks of size 2^( 4) =       0.000462621337
  error estimate for blocks of size 2^( 5) =       0.000466957464
  error estimate for blocks of size 2^( 6) =       0.000469889314
  error estimate for blocks of size 2^( 7) =       0.000473639180

      target function =                  N/A
              le_mean =     -17.211028181266
             les_mean =     296.600775514261
             stat err =       0.000468276824
             autocorr =       1.150233477418
              std dev =       0.617482508705
             le_variance =       0.381284648557


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721102818127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211028181266       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211031269090       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211030213806       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211026024178       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211025483277       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211025371336       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211024041222       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211027158111       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211025048114       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211025501346       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211029645313       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211027707657       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211028753106       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211029333174       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211030501529       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211030156394       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211031047836       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211032352240       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211032854641       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.211032158991       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 1.319861e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211028181266       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211030845540       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211029869604       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211025889317       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211026015585       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211024490748       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211025783590       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211026823296       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211025697545       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211026341558       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211027438080       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211027051372       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211027091761       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 3.169608e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211028181266       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211029901627       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211029252698       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211027121101       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211026239758       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211026132305       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211025792476       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211026948386       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211026624279       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211026939483       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211026946389       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 8.759862e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075016 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4145e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.208743e-01 1 1  ON 0
 uu_1                 5.450465e-02 1 1  ON 1
 uu_2                -4.554775e-02 1 1  ON 2
 uu_3                -1.029757e-01 1 1  ON 3
 uu_4                -1.368634e-01 1 1  ON 4
 uu_5                -1.438199e-01 1 1  ON 5
 uu_6                -1.221870e-01 1 1  ON 6
 uu_7                -5.536336e-02 1 1  ON 7
 uu_8                 8.452946e-02 1 1  ON 8
 uu_9                 1.346071e-01 1 1  ON 9
 ud_0                 3.706614e-01 1 1  ON 10
 ud_1                 1.037838e-01 1 1  ON 11
 ud_2                -1.448523e-02 1 1  ON 12
 ud_3                -7.889497e-02 1 1  ON 13
 ud_4                -1.270919e-01 1 1  ON 14
 ud_5                -1.584345e-01 1 1  ON 15
 ud_6                -1.605110e-01 1 1  ON 16
 ud_7                -1.157651e-01 1 1  ON 17
 ud_8                -1.963119e-02 1 1  ON 18
 ud_9                 9.154039e-02 1 1  ON 19
 eO_0                -8.213996e-01 1 1  ON 20
 eO_1                -4.867011e-01 1 1  ON 21
 eO_2                -5.502603e-02 1 1  ON 22
 eO_3                 2.172270e-01 1 1  ON 23
 eO_4                 3.208666e-01 1 1  ON 24
 eO_5                 3.415145e-01 1 1  ON 25
 eO_6                 2.762900e-01 1 1  ON 26
 eO_7                 1.409839e-01 1 1  ON 27
 eO_8                 3.263640e-02 1 1  ON 28
 eO_9                 2.058765e-02 1 1  ON 29
eH1_0                -1.869048e-01 1 1  ON 30
eH1_1                -1.075334e-01 1 1  ON 31
eH1_2                -6.473992e-02 1 1  ON 32
eH1_3                -2.652955e-02 1 1  ON 33
eH1_4                 1.828748e-02 1 1  ON 34
eH1_5                 3.039568e-02 1 1  ON 35
eH1_6                 7.442410e-02 1 1  ON 36
eH1_7                 1.084551e-01 1 1  ON 37
eH1_8                 1.066967e-01 1 1  ON 38
eH1_9                 3.010669e-02 1 1  ON 39
eH2_0                -1.876199e-01 1 1  ON 40
eH2_1                -1.085651e-01 1 1  ON 41
eH2_2                -6.525769e-02 1 1  ON 42
eH2_3                -2.685672e-02 1 1  ON 43
eH2_4                 1.771622e-02 1 1  ON 44
eH2_5                 2.944800e-02 1 1  ON 45
eH2_6                 7.323766e-02 1 1  ON 46
eH2_7                 1.105253e-01 1 1  ON 47
eH2_8                 1.108796e-01 1 1  ON 48
eH2_9                 3.165375e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.3263
====================================================
  Execution time = 1.8467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4953e-01
  Total weights = 2.0000e+06
  Execution time = 1.5727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348447502589
                                         uncertainty =       0.004371537406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348447502589
                                         uncertainty =       0.004371537406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417457297
  error estimate for blocks of size 2^( 2) =       0.000427966150
  error estimate for blocks of size 2^( 3) =       0.000437451134
  error estimate for blocks of size 2^( 4) =       0.000443972603
  error estimate for blocks of size 2^( 5) =       0.000448712958
  error estimate for blocks of size 2^( 6) =       0.000451823901
  error estimate for blocks of size 2^( 7) =       0.000454812958

      target function =                  N/A
              le_mean =     -17.212359349652
             les_mean =     296.613855396307
             stat err =       0.000449830605
             autocorr =       1.161111395171
              std dev =       0.590373770612
             le_variance =       0.348541189026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349713400520
                                         uncertainty =       0.004389292231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349713400520
                                         uncertainty =       0.004389292231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418214446
  error estimate for blocks of size 2^( 2) =       0.000428678425
  error estimate for blocks of size 2^( 3) =       0.000438111109
  error estimate for blocks of size 2^( 4) =       0.000444587172
  error estimate for blocks of size 2^( 5) =       0.000449307117
  error estimate for blocks of size 2^( 6) =       0.000452407761
  error estimate for blocks of size 2^( 7) =       0.000455408248

      target function =                  N/A
              le_mean =     -17.212350577717
             les_mean =     296.614818881504
             stat err =       0.000450427574
             autocorr =       1.159983676574
              std dev =       0.591444541919
             le_variance =       0.349806646166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350447048109
                                         uncertainty =       0.004403500539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350447048109
                                         uncertainty =       0.004403500539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418652731
  error estimate for blocks of size 2^( 2) =       0.000429097748
  error estimate for blocks of size 2^( 3) =       0.000438520360
  error estimate for blocks of size 2^( 4) =       0.000444992177
  error estimate for blocks of size 2^( 5) =       0.000449711422
  error estimate for blocks of size 2^( 6) =       0.000452809284
  error estimate for blocks of size 2^( 7) =       0.000455806047

      target function =                  N/A
              le_mean =     -17.212349283386
             les_mean =     296.615507895675
             stat err =       0.000450829732
             autocorr =       1.159624131230
              std dev =       0.592064369532
             le_variance =       0.350540217670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117821443
                                         uncertainty =       0.004383284135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349117821443
                                         uncertainty =       0.004383284135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417858452
  error estimate for blocks of size 2^( 2) =       0.000428345030
  error estimate for blocks of size 2^( 3) =       0.000437810573
  error estimate for blocks of size 2^( 4) =       0.000444317502
  error estimate for blocks of size 2^( 5) =       0.000449052995
  error estimate for blocks of size 2^( 6) =       0.000452157923
  error estimate for blocks of size 2^( 7) =       0.000455144308

      target function =                  N/A
              le_mean =     -17.212353331343
             les_mean =     296.614318400866
             stat err =       0.000450168182
             autocorr =       1.160623095140
              std dev =       0.590941090517
             le_variance =       0.349211372461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212359349652        initial  <--
     9.5367e-03     9.5367e-02             1.3199e-02       -17.212350577717
     3.8147e-02     3.8147e-01             3.1696e-03       -17.212349283386
     1.5259e-01     1.5259e+00             8.7599e-04       -17.212353331343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.4253
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.201895e-01 1 1  ON 0
 uu_1                 5.377459e-02 1 1  ON 1
 uu_2                -4.592311e-02 1 1  ON 2
 uu_3                -1.033977e-01 1 1  ON 3
 uu_4                -1.371672e-01 1 1  ON 4
 uu_5                -1.440298e-01 1 1  ON 5
 uu_6                -1.218906e-01 1 1  ON 6
 uu_7                -5.263305e-02 1 1  ON 7
 uu_8                 8.684923e-02 1 1  ON 8
 uu_9                 1.335358e-01 1 1  ON 9
 ud_0                 3.690007e-01 1 1  ON 10
 ud_1                 1.028903e-01 1 1  ON 11
 ud_2                -1.519485e-02 1 1  ON 12
 ud_3                -7.931628e-02 1 1  ON 13
 ud_4                -1.270498e-01 1 1  ON 14
 ud_5                -1.578129e-01 1 1  ON 15
 ud_6                -1.595042e-01 1 1  ON 16
 ud_7                -1.147320e-01 1 1  ON 17
 ud_8                -1.800065e-02 1 1  ON 18
 ud_9                 9.180277e-02 1 1  ON 19
 eO_0                -8.188537e-01 1 1  ON 20
 eO_1                -4.841739e-01 1 1  ON 21
 eO_2                -5.309175e-02 1 1  ON 22
 eO_3                 2.183911e-01 1 1  ON 23
 eO_4                 3.211700e-01 1 1  ON 24
 eO_5                 3.398182e-01 1 1  ON 25
 eO_6                 2.731204e-01 1 1  ON 26
 eO_7                 1.381661e-01 1 1  ON 27
 eO_8                 3.216461e-02 1 1  ON 28
 eO_9                 2.032754e-02 1 1  ON 29
eH1_0                -1.864073e-01 1 1  ON 30
eH1_1                -1.071012e-01 1 1  ON 31
eH1_2                -6.423954e-02 1 1  ON 32
eH1_3                -2.622503e-02 1 1  ON 33
eH1_4                 1.898723e-02 1 1  ON 34
eH1_5                 3.048632e-02 1 1  ON 35
eH1_6                 7.409136e-02 1 1  ON 36
eH1_7                 1.083961e-01 1 1  ON 37
eH1_8                 1.052172e-01 1 1  ON 38
eH1_9                 2.958860e-02 1 1  ON 39
eH2_0                -1.870550e-01 1 1  ON 40
eH2_1                -1.078566e-01 1 1  ON 41
eH2_2                -6.491128e-02 1 1  ON 42
eH2_3                -2.720151e-02 1 1  ON 43
eH2_4                 1.720011e-02 1 1  ON 44
eH2_5                 2.914250e-02 1 1  ON 45
eH2_6                 7.442731e-02 1 1  ON 46
eH2_7                 1.111758e-01 1 1  ON 47
eH2_8                 1.093133e-01 1 1  ON 48
eH2_9                 3.110592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.106731
====================================================
  Execution time = 1.9507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346829651111
                                         uncertainty =       0.005076599475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346829651111
                                         uncertainty =       0.005076599475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416423718
  error estimate for blocks of size 2^( 2) =       0.000426594124
  error estimate for blocks of size 2^( 3) =       0.000436023674
  error estimate for blocks of size 2^( 4) =       0.000443417509
  error estimate for blocks of size 2^( 5) =       0.000447435197
  error estimate for blocks of size 2^( 6) =       0.000450401308
  error estimate for blocks of size 2^( 7) =       0.000452448115

      target function =                  N/A
              le_mean =     -17.212129169063
             les_mean =     296.604207785123
             stat err =       0.000448425532
             autocorr =       1.159604119618
              std dev =       0.588912069849
             le_variance =       0.346817426014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721212916906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212129169063       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212131150694       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212130904575       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212131509776       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212130756878       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212130851683       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212131407679       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212131331599       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212131851483       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212131927924       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212132194601       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.250205e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212129169063       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212130169558       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212130022997       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212130228192       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212129984854       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212130231747       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212130119055       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212130259704       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212130236048       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 3.289701e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212129169063       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212129504748       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212129462913       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212129505837       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212129433052       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212129538795       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212129508376       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212129522391       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.044952e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5201e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.202430e-01 1 1  ON 0
 uu_1                 5.391100e-02 1 1  ON 1
 uu_2                -4.587037e-02 1 1  ON 2
 uu_3                -1.034468e-01 1 1  ON 3
 uu_4                -1.371749e-01 1 1  ON 4
 uu_5                -1.440683e-01 1 1  ON 5
 uu_6                -1.218883e-01 1 1  ON 6
 uu_7                -5.282220e-02 1 1  ON 7
 uu_8                 8.659552e-02 1 1  ON 8
 uu_9                 1.336480e-01 1 1  ON 9
 ud_0                 3.692471e-01 1 1  ON 10
 ud_1                 1.028475e-01 1 1  ON 11
 ud_2                -1.514194e-02 1 1  ON 12
 ud_3                -7.913647e-02 1 1  ON 13
 ud_4                -1.269860e-01 1 1  ON 14
 ud_5                -1.576336e-01 1 1  ON 15
 ud_6                -1.596689e-01 1 1  ON 16
 ud_7                -1.150185e-01 1 1  ON 17
 ud_8                -1.828489e-02 1 1  ON 18
 ud_9                 9.173802e-02 1 1  ON 19
 eO_0                -8.191827e-01 1 1  ON 20
 eO_1                -4.843920e-01 1 1  ON 21
 eO_2                -5.333823e-02 1 1  ON 22
 eO_3                 2.182123e-01 1 1  ON 23
 eO_4                 3.212774e-01 1 1  ON 24
 eO_5                 3.401112e-01 1 1  ON 25
 eO_6                 2.733754e-01 1 1  ON 26
 eO_7                 1.384288e-01 1 1  ON 27
 eO_8                 3.218957e-02 1 1  ON 28
 eO_9                 2.034214e-02 1 1  ON 29
eH1_0                -1.864768e-01 1 1  ON 30
eH1_1                -1.070455e-01 1 1  ON 31
eH1_2                -6.410267e-02 1 1  ON 32
eH1_3                -2.617583e-02 1 1  ON 33
eH1_4                 1.883336e-02 1 1  ON 34
eH1_5                 3.038767e-02 1 1  ON 35
eH1_6                 7.402746e-02 1 1  ON 36
eH1_7                 1.083001e-01 1 1  ON 37
eH1_8                 1.053732e-01 1 1  ON 38
eH1_9                 2.964391e-02 1 1  ON 39
eH2_0                -1.869786e-01 1 1  ON 40
eH2_1                -1.078072e-01 1 1  ON 41
eH2_2                -6.477261e-02 1 1  ON 42
eH2_3                -2.709534e-02 1 1  ON 43
eH2_4                 1.719305e-02 1 1  ON 44
eH2_5                 2.883822e-02 1 1  ON 45
eH2_6                 7.422896e-02 1 1  ON 46
eH2_7                 1.111129e-01 1 1  ON 47
eH2_8                 1.094613e-01 1 1  ON 48
eH2_9                 3.114291e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1597
    reference variance = 0.539126
====================================================
  Execution time = 1.8864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3838e-01
  Total weights = 2.0000e+06
  Execution time = 1.5731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338007672081
                                         uncertainty =       0.002543636991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338007672081
                                         uncertainty =       0.002543636991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411203043
  error estimate for blocks of size 2^( 2) =       0.000421825622
  error estimate for blocks of size 2^( 3) =       0.000431631461
  error estimate for blocks of size 2^( 4) =       0.000438876667
  error estimate for blocks of size 2^( 5) =       0.000444378344
  error estimate for blocks of size 2^( 6) =       0.000448067852
  error estimate for blocks of size 2^( 7) =       0.000447727518

      target function =                  N/A
              le_mean =     -17.211768911039
             les_mean =     296.583164763871
             stat err =       0.000444762595
             autocorr =       1.169886880493
              std dev =       0.581528920987
             le_variance =       0.338175885944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338308952283
                                         uncertainty =       0.002546984709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338308952283
                                         uncertainty =       0.002546984709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411386314
  error estimate for blocks of size 2^( 2) =       0.000421995995
  error estimate for blocks of size 2^( 3) =       0.000431794660
  error estimate for blocks of size 2^( 4) =       0.000439036681
  error estimate for blocks of size 2^( 5) =       0.000444534692
  error estimate for blocks of size 2^( 6) =       0.000448230684
  error estimate for blocks of size 2^( 7) =       0.000447892785

      target function =                  N/A
              le_mean =     -17.211768036193
             les_mean =     296.583436160624
             stat err =       0.000444923710
             autocorr =       1.169691738568
              std dev =       0.581788104180
             le_variance =       0.338477398165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338424099422
                                         uncertainty =       0.002548029946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338424099422
                                         uncertainty =       0.002548029946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411456318
  error estimate for blocks of size 2^( 2) =       0.000422062933
  error estimate for blocks of size 2^( 3) =       0.000431859460
  error estimate for blocks of size 2^( 4) =       0.000439101219
  error estimate for blocks of size 2^( 5) =       0.000444599420
  error estimate for blocks of size 2^( 6) =       0.000448297104
  error estimate for blocks of size 2^( 7) =       0.000447957984

      target function =                  N/A
              le_mean =     -17.211768043724
             les_mean =     296.583551625680
             stat err =       0.000444988932
             autocorr =       1.169636590837
              std dev =       0.581887105905
             le_variance =       0.338592604018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110264744
                                         uncertainty =       0.002544681285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338110264744
                                         uncertainty =       0.002544681285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411265452
  error estimate for blocks of size 2^( 2) =       0.000421884266
  error estimate for blocks of size 2^( 3) =       0.000431687751
  error estimate for blocks of size 2^( 4) =       0.000438931973
  error estimate for blocks of size 2^( 5) =       0.000444432792
  error estimate for blocks of size 2^( 6) =       0.000448124253
  error estimate for blocks of size 2^( 7) =       0.000447783540

      target function =                  N/A
              le_mean =     -17.211768677267
             les_mean =     296.583259374807
             stat err =       0.000444818139
             autocorr =       1.169823984401
              std dev =       0.581617180103
             le_variance =       0.338278544191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211768911039        initial  <--
     9.5367e-02     9.5367e-01             1.2502e-03       -17.211768036193
     3.8147e-01     3.8147e+00             3.2897e-04       -17.211768043724
     1.5259e+00     1.5259e+01             1.0450e-04       -17.211768677267

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8186
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.201895e-01 1 1  ON 0
 uu_1                 5.377459e-02 1 1  ON 1
 uu_2                -4.592311e-02 1 1  ON 2
 uu_3                -1.033977e-01 1 1  ON 3
 uu_4                -1.371672e-01 1 1  ON 4
 uu_5                -1.440298e-01 1 1  ON 5
 uu_6                -1.218906e-01 1 1  ON 6
 uu_7                -5.263305e-02 1 1  ON 7
 uu_8                 8.684923e-02 1 1  ON 8
 uu_9                 1.335358e-01 1 1  ON 9
 ud_0                 3.690007e-01 1 1  ON 10
 ud_1                 1.028903e-01 1 1  ON 11
 ud_2                -1.519485e-02 1 1  ON 12
 ud_3                -7.931628e-02 1 1  ON 13
 ud_4                -1.270498e-01 1 1  ON 14
 ud_5                -1.578129e-01 1 1  ON 15
 ud_6                -1.595042e-01 1 1  ON 16
 ud_7                -1.147320e-01 1 1  ON 17
 ud_8                -1.800065e-02 1 1  ON 18
 ud_9                 9.180277e-02 1 1  ON 19
 eO_0                -8.188537e-01 1 1  ON 20
 eO_1                -4.841739e-01 1 1  ON 21
 eO_2                -5.309175e-02 1 1  ON 22
 eO_3                 2.183911e-01 1 1  ON 23
 eO_4                 3.211700e-01 1 1  ON 24
 eO_5                 3.398182e-01 1 1  ON 25
 eO_6                 2.731204e-01 1 1  ON 26
 eO_7                 1.381661e-01 1 1  ON 27
 eO_8                 3.216461e-02 1 1  ON 28
 eO_9                 2.032754e-02 1 1  ON 29
eH1_0                -1.864073e-01 1 1  ON 30
eH1_1                -1.071012e-01 1 1  ON 31
eH1_2                -6.423954e-02 1 1  ON 32
eH1_3                -2.622503e-02 1 1  ON 33
eH1_4                 1.898723e-02 1 1  ON 34
eH1_5                 3.048632e-02 1 1  ON 35
eH1_6                 7.409136e-02 1 1  ON 36
eH1_7                 1.083961e-01 1 1  ON 37
eH1_8                 1.052172e-01 1 1  ON 38
eH1_9                 2.958860e-02 1 1  ON 39
eH2_0                -1.870550e-01 1 1  ON 40
eH2_1                -1.078566e-01 1 1  ON 41
eH2_2                -6.491128e-02 1 1  ON 42
eH2_3                -2.720151e-02 1 1  ON 43
eH2_4                 1.720011e-02 1 1  ON 44
eH2_5                 2.914250e-02 1 1  ON 45
eH2_6                 7.442731e-02 1 1  ON 46
eH2_7                 1.111758e-01 1 1  ON 47
eH2_8                 1.093133e-01 1 1  ON 48
eH2_9                 3.110592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2025e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1989
    reference variance = 0.192789
====================================================
  Execution time = 1.9136e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4897e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349048390459
                                         uncertainty =       0.006882226019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349048390459
                                         uncertainty =       0.006882226019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417711871
  error estimate for blocks of size 2^( 2) =       0.000428659069
  error estimate for blocks of size 2^( 3) =       0.000438505423
  error estimate for blocks of size 2^( 4) =       0.000445532968
  error estimate for blocks of size 2^( 5) =       0.000449651814
  error estimate for blocks of size 2^( 6) =       0.000452239995
  error estimate for blocks of size 2^( 7) =       0.000452588626

      target function =                  N/A
              le_mean =     -17.211586188548
             les_mean =     296.587665364902
             stat err =       0.000450003351
             autocorr =       1.160587425109
              std dev =       0.590733792458
             le_variance =       0.348966413552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721158618855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211586188548       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211585958378       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211586044679       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211585516503       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211585409344       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211585520680       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211585541053       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211585626612       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.628088e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211586188548       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211586124340       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211586145019       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211585967803       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211585926468       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211585960087       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211585967153       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211585985572       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.219359e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211586188548       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211586172017       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211586177049       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211586128772       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211586116183       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211586124887       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211586127114       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.168626e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4463e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.201677e-01 1 1  ON 0
 uu_1                 5.379920e-02 1 1  ON 1
 uu_2                -4.589400e-02 1 1  ON 2
 uu_3                -1.033956e-01 1 1  ON 3
 uu_4                -1.371516e-01 1 1  ON 4
 uu_5                -1.440360e-01 1 1  ON 5
 uu_6                -1.219183e-01 1 1  ON 6
 uu_7                -5.265862e-02 1 1  ON 7
 uu_8                 8.682765e-02 1 1  ON 8
 uu_9                 1.335478e-01 1 1  ON 9
 ud_0                 3.690409e-01 1 1  ON 10
 ud_1                 1.028690e-01 1 1  ON 11
 ud_2                -1.518072e-02 1 1  ON 12
 ud_3                -7.932356e-02 1 1  ON 13
 ud_4                -1.270561e-01 1 1  ON 14
 ud_5                -1.578227e-01 1 1  ON 15
 ud_6                -1.595137e-01 1 1  ON 16
 ud_7                -1.147338e-01 1 1  ON 17
 ud_8                -1.801229e-02 1 1  ON 18
 ud_9                 9.180397e-02 1 1  ON 19
 eO_0                -8.188700e-01 1 1  ON 20
 eO_1                -4.842161e-01 1 1  ON 21
 eO_2                -5.311108e-02 1 1  ON 22
 eO_3                 2.183624e-01 1 1  ON 23
 eO_4                 3.211909e-01 1 1  ON 24
 eO_5                 3.398360e-01 1 1  ON 25
 eO_6                 2.731472e-01 1 1  ON 26
 eO_7                 1.381987e-01 1 1  ON 27
 eO_8                 3.216945e-02 1 1  ON 28
 eO_9                 2.032994e-02 1 1  ON 29
eH1_0                -1.864369e-01 1 1  ON 30
eH1_1                -1.071086e-01 1 1  ON 31
eH1_2                -6.425877e-02 1 1  ON 32
eH1_3                -2.621448e-02 1 1  ON 33
eH1_4                 1.899572e-02 1 1  ON 34
eH1_5                 3.049175e-02 1 1  ON 35
eH1_6                 7.409777e-02 1 1  ON 36
eH1_7                 1.083945e-01 1 1  ON 37
eH1_8                 1.052364e-01 1 1  ON 38
eH1_9                 2.959464e-02 1 1  ON 39
eH2_0                -1.870552e-01 1 1  ON 40
eH2_1                -1.078627e-01 1 1  ON 41
eH2_2                -6.490708e-02 1 1  ON 42
eH2_3                -2.717464e-02 1 1  ON 43
eH2_4                 1.717903e-02 1 1  ON 44
eH2_5                 2.913729e-02 1 1  ON 45
eH2_6                 7.441541e-02 1 1  ON 46
eH2_7                 1.111696e-01 1 1  ON 47
eH2_8                 1.093257e-01 1 1  ON 48
eH2_9                 3.111076e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.261
    reference variance = 0.296821
====================================================
  Execution time = 1.8454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4055e-01
  Total weights = 2.0000e+06
  Execution time = 1.5720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340454137973
                                         uncertainty =       0.003263120325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340454137973
                                         uncertainty =       0.003263120325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412630319
  error estimate for blocks of size 2^( 2) =       0.000423079727
  error estimate for blocks of size 2^( 3) =       0.000432734502
  error estimate for blocks of size 2^( 4) =       0.000439558315
  error estimate for blocks of size 2^( 5) =       0.000442885797
  error estimate for blocks of size 2^( 6) =       0.000445967117
  error estimate for blocks of size 2^( 7) =       0.000447078260

      target function =                  N/A
              le_mean =     -17.212499100367
             les_mean =     296.610652669540
             stat err =       0.000443872372
             autocorr =       1.157161453001
              std dev =       0.583547392808
             le_variance =       0.340527559653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506874508
                                         uncertainty =       0.003263859901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340506874508
                                         uncertainty =       0.003263859901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412662247
  error estimate for blocks of size 2^( 2) =       0.000423108647
  error estimate for blocks of size 2^( 3) =       0.000432762198
  error estimate for blocks of size 2^( 4) =       0.000439583952
  error estimate for blocks of size 2^( 5) =       0.000442911702
  error estimate for blocks of size 2^( 6) =       0.000445993138
  error estimate for blocks of size 2^( 7) =       0.000447104762

      target function =                  N/A
              le_mean =     -17.212499764813
             les_mean =     296.610728244382
             stat err =       0.000443898389
             autocorr =       1.157118024558
              std dev =       0.583592547071
             le_variance =       0.340580260997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340495278277
                                         uncertainty =       0.003263700625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340495278277
                                         uncertainty =       0.003263700625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412655229
  error estimate for blocks of size 2^( 2) =       0.000423102538
  error estimate for blocks of size 2^( 3) =       0.000432756568
  error estimate for blocks of size 2^( 4) =       0.000439578887
  error estimate for blocks of size 2^( 5) =       0.000442906593
  error estimate for blocks of size 2^( 6) =       0.000445988086
  error estimate for blocks of size 2^( 7) =       0.000447099477

      target function =                  N/A
              le_mean =     -17.212499562992
             les_mean =     296.610709711178
             stat err =       0.000443893261
             autocorr =       1.157130652557
              std dev =       0.583582620950
             le_variance =       0.340568675475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340460426613
                                         uncertainty =       0.003263207318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340460426613
                                         uncertainty =       0.003263207318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412634127
  error estimate for blocks of size 2^( 2) =       0.000423083220
  error estimate for blocks of size 2^( 3) =       0.000432737893
  error estimate for blocks of size 2^( 4) =       0.000439561481
  error estimate for blocks of size 2^( 5) =       0.000442889002
  error estimate for blocks of size 2^( 6) =       0.000445970362
  error estimate for blocks of size 2^( 7) =       0.000447081500

      target function =                  N/A
              le_mean =     -17.212499164048
             les_mean =     296.610661147492
             stat err =       0.000443875586
             autocorr =       1.157156850568
              std dev =       0.583552778595
             le_variance =       0.340533845405


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212499100367        initial
     9.5367e-01     9.5367e+00             1.6281e-04       -17.212499764813  <--
     3.8147e+00     3.8147e+01             4.2194e-05       -17.212499562992
     1.5259e+01     1.5259e+02             1.1686e-05       -17.212499164048

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 2.6458e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.201240e-01 1 1  ON 0
 uu_1                 5.386630e-02 1 1  ON 1
 uu_2                -4.582884e-02 1 1  ON 2
 uu_3                -1.033782e-01 1 1  ON 3
 uu_4                -1.371186e-01 1 1  ON 4
 uu_5                -1.440468e-01 1 1  ON 5
 uu_6                -1.219986e-01 1 1  ON 6
 uu_7                -5.273495e-02 1 1  ON 7
 uu_8                 8.676372e-02 1 1  ON 8
 uu_9                 1.335830e-01 1 1  ON 9
 ud_0                 3.691183e-01 1 1  ON 10
 ud_1                 1.028420e-01 1 1  ON 11
 ud_2                -1.515070e-02 1 1  ON 12
 ud_3                -7.933153e-02 1 1  ON 13
 ud_4                -1.270728e-01 1 1  ON 14
 ud_5                -1.578493e-01 1 1  ON 15
 ud_6                -1.595409e-01 1 1  ON 16
 ud_7                -1.147400e-01 1 1  ON 17
 ud_8                -1.804692e-02 1 1  ON 18
 ud_9                 9.180741e-02 1 1  ON 19
 eO_0                -8.189245e-01 1 1  ON 20
 eO_1                -4.843367e-01 1 1  ON 21
 eO_2                -5.316615e-02 1 1  ON 22
 eO_3                 2.182802e-01 1 1  ON 23
 eO_4                 3.212505e-01 1 1  ON 24
 eO_5                 3.398892e-01 1 1  ON 25
 eO_6                 2.732260e-01 1 1  ON 26
 eO_7                 1.382944e-01 1 1  ON 27
 eO_8                 3.218370e-02 1 1  ON 28
 eO_9                 2.033702e-02 1 1  ON 29
eH1_0                -1.865257e-01 1 1  ON 30
eH1_1                -1.071301e-01 1 1  ON 31
eH1_2                -6.430792e-02 1 1  ON 32
eH1_3                -2.619184e-02 1 1  ON 33
eH1_4                 1.902013e-02 1 1  ON 34
eH1_5                 3.051002e-02 1 1  ON 35
eH1_6                 7.411720e-02 1 1  ON 36
eH1_7                 1.083899e-01 1 1  ON 37
eH1_8                 1.052929e-01 1 1  ON 38
eH1_9                 2.961243e-02 1 1  ON 39
eH2_0                -1.870580e-01 1 1  ON 40
eH2_1                -1.078717e-01 1 1  ON 41
eH2_2                -6.489624e-02 1 1  ON 42
eH2_3                -2.710709e-02 1 1  ON 43
eH2_4                 1.712838e-02 1 1  ON 44
eH2_5                 2.911856e-02 1 1  ON 45
eH2_6                 7.437886e-02 1 1  ON 46
eH2_7                 1.111510e-01 1 1  ON 47
eH2_8                 1.093622e-01 1 1  ON 48
eH2_9                 3.112501e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.3081
    reference variance = 0.383734
====================================================
  Execution time = 1.9152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352947888873
                                         uncertainty =       0.010073431717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352947888873
                                         uncertainty =       0.010073431717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420136981
  error estimate for blocks of size 2^( 2) =       0.000430666579
  error estimate for blocks of size 2^( 3) =       0.000440507809
  error estimate for blocks of size 2^( 4) =       0.000447790442
  error estimate for blocks of size 2^( 5) =       0.000451941776
  error estimate for blocks of size 2^( 6) =       0.000453221143
  error estimate for blocks of size 2^( 7) =       0.000453264878

      target function =                  N/A
              le_mean =     -17.211333744873
             les_mean =     296.583039265834
             stat err =       0.000451554560
             autocorr =       1.155150696624
              std dev =       0.594163416016
             le_variance =       0.353030164932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721133374487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211333744873       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211333777433       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211334427754       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211334827956       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211334751070       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211335041272       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211336196601       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211335621766       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211335564073       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 5.361538e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211333744873       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211333757781       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211334025916       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211334219764       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211334385409       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211334588812       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211334789153       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211334580692       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.531122e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211333744873       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211333748654       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211333831767       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211333888712       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211333968016       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211334047763       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211334073594       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.345820e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4467e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.202430e-01 1 1  ON 0
 uu_1                 5.391122e-02 1 1  ON 1
 uu_2                -4.584274e-02 1 1  ON 2
 uu_3                -1.034217e-01 1 1  ON 3
 uu_4                -1.371154e-01 1 1  ON 4
 uu_5                -1.441075e-01 1 1  ON 5
 uu_6                -1.220881e-01 1 1  ON 6
 uu_7                -5.279271e-02 1 1  ON 7
 uu_8                 8.669144e-02 1 1  ON 8
 uu_9                 1.336371e-01 1 1  ON 9
 ud_0                 3.691732e-01 1 1  ON 10
 ud_1                 1.028230e-01 1 1  ON 11
 ud_2                -1.511636e-02 1 1  ON 12
 ud_3                -7.928646e-02 1 1  ON 13
 ud_4                -1.271088e-01 1 1  ON 14
 ud_5                -1.579050e-01 1 1  ON 15
 ud_6                -1.595224e-01 1 1  ON 16
 ud_7                -1.148322e-01 1 1  ON 17
 ud_8                -1.813605e-02 1 1  ON 18
 ud_9                 9.182162e-02 1 1  ON 19
 eO_0                -8.190222e-01 1 1  ON 20
 eO_1                -4.844646e-01 1 1  ON 21
 eO_2                -5.325665e-02 1 1  ON 22
 eO_3                 2.183122e-01 1 1  ON 23
 eO_4                 3.212009e-01 1 1  ON 24
 eO_5                 3.398999e-01 1 1  ON 25
 eO_6                 2.733539e-01 1 1  ON 26
 eO_7                 1.384333e-01 1 1  ON 27
 eO_8                 3.220536e-02 1 1  ON 28
 eO_9                 2.034950e-02 1 1  ON 29
eH1_0                -1.866003e-01 1 1  ON 30
eH1_1                -1.071343e-01 1 1  ON 31
eH1_2                -6.427971e-02 1 1  ON 32
eH1_3                -2.616113e-02 1 1  ON 33
eH1_4                 1.898051e-02 1 1  ON 34
eH1_5                 3.048370e-02 1 1  ON 35
eH1_6                 7.409644e-02 1 1  ON 36
eH1_7                 1.083766e-01 1 1  ON 37
eH1_8                 1.053644e-01 1 1  ON 38
eH1_9                 2.963675e-02 1 1  ON 39
eH2_0                -1.871376e-01 1 1  ON 40
eH2_1                -1.079184e-01 1 1  ON 41
eH2_2                -6.491071e-02 1 1  ON 42
eH2_3                -2.709841e-02 1 1  ON 43
eH2_4                 1.728149e-02 1 1  ON 44
eH2_5                 2.908504e-02 1 1  ON 45
eH2_6                 7.429475e-02 1 1  ON 46
eH2_7                 1.111213e-01 1 1  ON 47
eH2_8                 1.094460e-01 1 1  ON 48
eH2_9                 3.115178e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1748
    reference variance = 0.161613
====================================================
  Execution time = 1.8491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.4596e-01
  Total weights = 2.0000e+06
  Execution time = 1.5716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345990574195
                                         uncertainty =       0.005309138657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345990574195
                                         uncertainty =       0.005309138657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415871884
  error estimate for blocks of size 2^( 2) =       0.000426383625
  error estimate for blocks of size 2^( 3) =       0.000436220664
  error estimate for blocks of size 2^( 4) =       0.000442937900
  error estimate for blocks of size 2^( 5) =       0.000448013002
  error estimate for blocks of size 2^( 6) =       0.000449229876
  error estimate for blocks of size 2^( 7) =       0.000449813827

      target function =                  N/A
              le_mean =     -17.212555336663
             les_mean =     296.617959892995
             stat err =       0.000447498651
             autocorr =       1.157882102722
              std dev =       0.588131658954
             le_variance =       0.345898848264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346135196255
                                         uncertainty =       0.005312831293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346135196255
                                         uncertainty =       0.005312831293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415958783
  error estimate for blocks of size 2^( 2) =       0.000426466451
  error estimate for blocks of size 2^( 3) =       0.000436301072
  error estimate for blocks of size 2^( 4) =       0.000443016454
  error estimate for blocks of size 2^( 5) =       0.000448090324
  error estimate for blocks of size 2^( 6) =       0.000449309069
  error estimate for blocks of size 2^( 7) =       0.000449896067

      target function =                  N/A
              le_mean =     -17.212556758428
             les_mean =     296.618153407868
             stat err =       0.000447577979
             autocorr =       1.157808737970
              std dev =       0.588254552724
             le_variance =       0.346043418801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346118016586
                                         uncertainty =       0.005311559157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346118016586
                                         uncertainty =       0.005311559157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415948465
  error estimate for blocks of size 2^( 2) =       0.000426456789
  error estimate for blocks of size 2^( 3) =       0.000436292360
  error estimate for blocks of size 2^( 4) =       0.000443008735
  error estimate for blocks of size 2^( 5) =       0.000448083176
  error estimate for blocks of size 2^( 6) =       0.000449301686
  error estimate for blocks of size 2^( 7) =       0.000449888451

      target function =                  N/A
              le_mean =     -17.212556388694
             les_mean =     296.618123512340
             stat err =       0.000447570512
             autocorr =       1.157827548696
              std dev =       0.588239960702
             le_variance =       0.346026251366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346012702778
                                         uncertainty =       0.005309535821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346012702778
                                         uncertainty =       0.005309535821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415885183
  error estimate for blocks of size 2^( 2) =       0.000426396294
  error estimate for blocks of size 2^( 3) =       0.000436233075
  error estimate for blocks of size 2^( 4) =       0.000442950193
  error estimate for blocks of size 2^( 5) =       0.000448025316
  error estimate for blocks of size 2^( 6) =       0.000449242442
  error estimate for blocks of size 2^( 7) =       0.000449826779

      target function =                  N/A
              le_mean =     -17.212555456406
             les_mean =     296.617986137069
             stat err =       0.000447511183
             autocorr =       1.157872900044
              std dev =       0.588150465595
             le_variance =       0.345920970179


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212555336663        initial
     2.3842e-01     2.3842e+00             5.3615e-04       -17.212556758428  <--
     9.5367e-01     9.5367e+00             1.5311e-04       -17.212556388694
     3.8147e+00     3.8147e+01             4.3458e-05       -17.212555456406

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.6442e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.204765e-01 1 1  ON 0
 uu_1                 5.399012e-02 1 1  ON 1
 uu_2                -4.582765e-02 1 1  ON 2
 uu_3                -1.034983e-01 1 1  ON 3
 uu_4                -1.371574e-01 1 1  ON 4
 uu_5                -1.441919e-01 1 1  ON 5
 uu_6                -1.223207e-01 1 1  ON 6
 uu_7                -5.296372e-02 1 1  ON 7
 uu_8                 8.648241e-02 1 1  ON 8
 uu_9                 1.337917e-01 1 1  ON 9
 ud_0                 3.692477e-01 1 1  ON 10
 ud_1                 1.028425e-01 1 1  ON 11
 ud_2                -1.505335e-02 1 1  ON 12
 ud_3                -7.921684e-02 1 1  ON 13
 ud_4                -1.271453e-01 1 1  ON 14
 ud_5                -1.579933e-01 1 1  ON 15
 ud_6                -1.594942e-01 1 1  ON 16
 ud_7                -1.151026e-01 1 1  ON 17
 ud_8                -1.839359e-02 1 1  ON 18
 ud_9                 9.186135e-02 1 1  ON 19
 eO_0                -8.193892e-01 1 1  ON 20
 eO_1                -4.847638e-01 1 1  ON 21
 eO_2                -5.348691e-02 1 1  ON 22
 eO_3                 2.183568e-01 1 1  ON 23
 eO_4                 3.211091e-01 1 1  ON 24
 eO_5                 3.399264e-01 1 1  ON 25
 eO_6                 2.737139e-01 1 1  ON 26
 eO_7                 1.388306e-01 1 1  ON 27
 eO_8                 3.226725e-02 1 1  ON 28
 eO_9                 2.038522e-02 1 1  ON 29
eH1_0                -1.867720e-01 1 1  ON 30
eH1_1                -1.071455e-01 1 1  ON 31
eH1_2                -6.423785e-02 1 1  ON 32
eH1_3                -2.610812e-02 1 1  ON 33
eH1_4                 1.891219e-02 1 1  ON 34
eH1_5                 3.040419e-02 1 1  ON 35
eH1_6                 7.403087e-02 1 1  ON 36
eH1_7                 1.083356e-01 1 1  ON 37
eH1_8                 1.055689e-01 1 1  ON 38
eH1_9                 2.970634e-02 1 1  ON 39
eH2_0                -1.873539e-01 1 1  ON 40
eH2_1                -1.080083e-01 1 1  ON 41
eH2_2                -6.495799e-02 1 1  ON 42
eH2_3                -2.706157e-02 1 1  ON 43
eH2_4                 1.758849e-02 1 1  ON 44
eH2_5                 2.905196e-02 1 1  ON 45
eH2_6                 7.406584e-02 1 1  ON 46
eH2_7                 1.110317e-01 1 1  ON 47
eH2_8                 1.096854e-01 1 1  ON 48
eH2_9                 3.122841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.0733
    reference variance = 0.493195
====================================================
  Execution time = 1.9081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5595e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355951730877
                                         uncertainty =       0.015187488447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355951730877
                                         uncertainty =       0.015187488447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421868103
  error estimate for blocks of size 2^( 2) =       0.000432485954
  error estimate for blocks of size 2^( 3) =       0.000442048599
  error estimate for blocks of size 2^( 4) =       0.000449030666
  error estimate for blocks of size 2^( 5) =       0.000453459503
  error estimate for blocks of size 2^( 6) =       0.000455908408
  error estimate for blocks of size 2^( 7) =       0.000455735356

      target function =                  N/A
              le_mean =     -17.212377196864
             les_mean =     296.621873981356
             stat err =       0.000453533483
             autocorr =       1.155753803330
              std dev =       0.596611592428
             le_variance =       0.355945392220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721237719686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212377196864       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212377445794       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212377087722       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212379048568       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212379668046       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212376241296       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212377927089       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212378132307       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212378375504       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212379524923       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212379726072       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212379528534       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 2.183190e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212377196864       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212377341107       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212377234120       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212378814534       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212378401047       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212376958709       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212377570848       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212377674943       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212377965767       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212377979383       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.080990e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212377196864       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212377250642       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212377246227       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212377939562       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212377805781       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212377401190       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212377472467       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.636975e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4349e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.201584e-01 1 1  ON 0
 uu_1                 5.408894e-02 1 1  ON 1
 uu_2                -4.568593e-02 1 1  ON 2
 uu_3                -1.033667e-01 1 1  ON 3
 uu_4                -1.372347e-01 1 1  ON 4
 uu_5                -1.441639e-01 1 1  ON 5
 uu_6                -1.222927e-01 1 1  ON 6
 uu_7                -5.322755e-02 1 1  ON 7
 uu_8                 8.621193e-02 1 1  ON 8
 uu_9                 1.339730e-01 1 1  ON 9
 ud_0                 3.692513e-01 1 1  ON 10
 ud_1                 1.028451e-01 1 1  ON 11
 ud_2                -1.486616e-02 1 1  ON 12
 ud_3                -7.912305e-02 1 1  ON 13
 ud_4                -1.269999e-01 1 1  ON 14
 ud_5                -1.576743e-01 1 1  ON 15
 ud_6                -1.598938e-01 1 1  ON 16
 ud_7                -1.153803e-01 1 1  ON 17
 ud_8                -1.866059e-02 1 1  ON 18
 ud_9                 9.180430e-02 1 1  ON 19
 eO_0                -8.195822e-01 1 1  ON 20
 eO_1                -4.850168e-01 1 1  ON 21
 eO_2                -5.386584e-02 1 1  ON 22
 eO_3                 2.177487e-01 1 1  ON 23
 eO_4                 3.211352e-01 1 1  ON 24
 eO_5                 3.401623e-01 1 1  ON 25
 eO_6                 2.742468e-01 1 1  ON 26
 eO_7                 1.393427e-01 1 1  ON 27
 eO_8                 3.233202e-02 1 1  ON 28
 eO_9                 2.040841e-02 1 1  ON 29
eH1_0                -1.864623e-01 1 1  ON 30
eH1_1                -1.072763e-01 1 1  ON 31
eH1_2                -6.427651e-02 1 1  ON 32
eH1_3                -2.604976e-02 1 1  ON 33
eH1_4                 1.860537e-02 1 1  ON 34
eH1_5                 3.017761e-02 1 1  ON 35
eH1_6                 7.397127e-02 1 1  ON 36
eH1_7                 1.083396e-01 1 1  ON 37
eH1_8                 1.058270e-01 1 1  ON 38
eH1_9                 2.978361e-02 1 1  ON 39
eH2_0                -1.875020e-01 1 1  ON 40
eH2_1                -1.080991e-01 1 1  ON 41
eH2_2                -6.490627e-02 1 1  ON 42
eH2_3                -2.693423e-02 1 1  ON 43
eH2_4                 1.760020e-02 1 1  ON 44
eH2_5                 2.910317e-02 1 1  ON 45
eH2_6                 7.376315e-02 1 1  ON 46
eH2_7                 1.109123e-01 1 1  ON 47
eH2_8                 1.099939e-01 1 1  ON 48
eH2_9                 3.131642e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.35428
====================================================
  Execution time = 1.8603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3865e-01
  Total weights = 2.0000e+06
  Execution time = 1.5795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338853498975
                                         uncertainty =       0.003746489953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338853498975
                                         uncertainty =       0.003746489953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411628586
  error estimate for blocks of size 2^( 2) =       0.000422438501
  error estimate for blocks of size 2^( 3) =       0.000432052830
  error estimate for blocks of size 2^( 4) =       0.000439316332
  error estimate for blocks of size 2^( 5) =       0.000442730432
  error estimate for blocks of size 2^( 6) =       0.000445822167
  error estimate for blocks of size 2^( 7) =       0.000447539212

      target function =                  N/A
              le_mean =     -17.212310480979
             les_mean =     296.602508109856
             stat err =       0.000443852036
             autocorr =       1.162693856714
              std dev =       0.582130729032
             le_variance =       0.338876185684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338505030979
                                         uncertainty =       0.003743204343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338505030979
                                         uncertainty =       0.003743204343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411416973
  error estimate for blocks of size 2^( 2) =       0.000422230517
  error estimate for blocks of size 2^( 3) =       0.000431850578
  error estimate for blocks of size 2^( 4) =       0.000439117923
  error estimate for blocks of size 2^( 5) =       0.000442536058
  error estimate for blocks of size 2^( 6) =       0.000445618322
  error estimate for blocks of size 2^( 7) =       0.000447344449

      target function =                  N/A
              le_mean =     -17.212310127575
             les_mean =     296.602147609158
             stat err =       0.000443654188
             autocorr =       1.162852853139
              std dev =       0.581831462363
             le_variance =       0.338527850595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338406631439
                                         uncertainty =       0.003741773445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338406631439
                                         uncertainty =       0.003741773445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411357217
  error estimate for blocks of size 2^( 2) =       0.000422173624
  error estimate for blocks of size 2^( 3) =       0.000431797474
  error estimate for blocks of size 2^( 4) =       0.000439068146
  error estimate for blocks of size 2^( 5) =       0.000442488643
  error estimate for blocks of size 2^( 6) =       0.000445567699
  error estimate for blocks of size 2^( 7) =       0.000447296132

      target function =                  N/A
              le_mean =     -17.212309732372
             les_mean =     296.602035674046
             stat err =       0.000443605155
             autocorr =       1.162933620480
              std dev =       0.581746955435
             le_variance =       0.338429520158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338746161987
                                         uncertainty =       0.003745435035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338746161987
                                         uncertainty =       0.003745435035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411563425
  error estimate for blocks of size 2^( 2) =       0.000422375128
  error estimate for blocks of size 2^( 3) =       0.000431991760
  error estimate for blocks of size 2^( 4) =       0.000439257041
  error estimate for blocks of size 2^( 5) =       0.000442672698
  error estimate for blocks of size 2^( 6) =       0.000445761480
  error estimate for blocks of size 2^( 7) =       0.000447482814

      target function =                  N/A
              le_mean =     -17.212309776893
             les_mean =     296.602376592146
             stat err =       0.000443793508
             autocorr =       1.162755345800
              std dev =       0.582038577599
             le_variance =       0.338768905814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212310480979        initial  <--
     5.9605e-02     5.9605e-01             2.1832e-03       -17.212310127575
     2.3842e-01     2.3842e+00             6.0810e-04       -17.212309732372
     9.5367e-01     9.5367e+00             1.6370e-04       -17.212309776893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.5818
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.204765e-01 1 1  ON 0
 uu_1                 5.399012e-02 1 1  ON 1
 uu_2                -4.582765e-02 1 1  ON 2
 uu_3                -1.034983e-01 1 1  ON 3
 uu_4                -1.371574e-01 1 1  ON 4
 uu_5                -1.441919e-01 1 1  ON 5
 uu_6                -1.223207e-01 1 1  ON 6
 uu_7                -5.296372e-02 1 1  ON 7
 uu_8                 8.648241e-02 1 1  ON 8
 uu_9                 1.337917e-01 1 1  ON 9
 ud_0                 3.692477e-01 1 1  ON 10
 ud_1                 1.028425e-01 1 1  ON 11
 ud_2                -1.505335e-02 1 1  ON 12
 ud_3                -7.921684e-02 1 1  ON 13
 ud_4                -1.271453e-01 1 1  ON 14
 ud_5                -1.579933e-01 1 1  ON 15
 ud_6                -1.594942e-01 1 1  ON 16
 ud_7                -1.151026e-01 1 1  ON 17
 ud_8                -1.839359e-02 1 1  ON 18
 ud_9                 9.186135e-02 1 1  ON 19
 eO_0                -8.193892e-01 1 1  ON 20
 eO_1                -4.847638e-01 1 1  ON 21
 eO_2                -5.348691e-02 1 1  ON 22
 eO_3                 2.183568e-01 1 1  ON 23
 eO_4                 3.211091e-01 1 1  ON 24
 eO_5                 3.399264e-01 1 1  ON 25
 eO_6                 2.737139e-01 1 1  ON 26
 eO_7                 1.388306e-01 1 1  ON 27
 eO_8                 3.226725e-02 1 1  ON 28
 eO_9                 2.038522e-02 1 1  ON 29
eH1_0                -1.867720e-01 1 1  ON 30
eH1_1                -1.071455e-01 1 1  ON 31
eH1_2                -6.423785e-02 1 1  ON 32
eH1_3                -2.610812e-02 1 1  ON 33
eH1_4                 1.891219e-02 1 1  ON 34
eH1_5                 3.040419e-02 1 1  ON 35
eH1_6                 7.403087e-02 1 1  ON 36
eH1_7                 1.083356e-01 1 1  ON 37
eH1_8                 1.055689e-01 1 1  ON 38
eH1_9                 2.970634e-02 1 1  ON 39
eH2_0                -1.873539e-01 1 1  ON 40
eH2_1                -1.080083e-01 1 1  ON 41
eH2_2                -6.495799e-02 1 1  ON 42
eH2_3                -2.706157e-02 1 1  ON 43
eH2_4                 1.758849e-02 1 1  ON 44
eH2_5                 2.905196e-02 1 1  ON 45
eH2_6                 7.406584e-02 1 1  ON 46
eH2_7                 1.110317e-01 1 1  ON 47
eH2_8                 1.096854e-01 1 1  ON 48
eH2_9                 3.122841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1452
    reference variance = 0.250873
====================================================
  Execution time = 1.9169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5158e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351591260666
                                         uncertainty =       0.008629263007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351591260666
                                         uncertainty =       0.008629263007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419275423
  error estimate for blocks of size 2^( 2) =       0.000429791718
  error estimate for blocks of size 2^( 3) =       0.000439013335
  error estimate for blocks of size 2^( 4) =       0.000446431946
  error estimate for blocks of size 2^( 5) =       0.000450271148
  error estimate for blocks of size 2^( 6) =       0.000454668117
  error estimate for blocks of size 2^( 7) =       0.000455381664

      target function =                  N/A
              le_mean =     -17.212232683569
             les_mean =     296.612537538353
             stat err =       0.000451688219
             autocorr =       1.160589706704
              std dev =       0.592944989707
             le_variance =       0.351583760819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721223268357e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212232683569       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212233892606       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212234560283       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212234622169       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212233848562       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212234526223       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212234326194       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212234534472       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.923709e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212232683569       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212233068911       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212233298754       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212233329134       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212233103888       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212233196340       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212233292993       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212233248060       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 8.729502e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212232683569       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212232787013       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212232851184       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212232859684       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212232804969       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212232817176       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212232848059       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.321532e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4512e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.204307e-01 1 1  ON 0
 uu_1                 5.399743e-02 1 1  ON 1
 uu_2                -4.584634e-02 1 1  ON 2
 uu_3                -1.034901e-01 1 1  ON 3
 uu_4                -1.371270e-01 1 1  ON 4
 uu_5                -1.441885e-01 1 1  ON 5
 uu_6                -1.223164e-01 1 1  ON 6
 uu_7                -5.298372e-02 1 1  ON 7
 uu_8                 8.646265e-02 1 1  ON 8
 uu_9                 1.338109e-01 1 1  ON 9
 ud_0                 3.692673e-01 1 1  ON 10
 ud_1                 1.028592e-01 1 1  ON 11
 ud_2                -1.505464e-02 1 1  ON 12
 ud_3                -7.923642e-02 1 1  ON 13
 ud_4                -1.271581e-01 1 1  ON 14
 ud_5                -1.580005e-01 1 1  ON 15
 ud_6                -1.594796e-01 1 1  ON 16
 ud_7                -1.151116e-01 1 1  ON 17
 ud_8                -1.841421e-02 1 1  ON 18
 ud_9                 9.185588e-02 1 1  ON 19
 eO_0                -8.194765e-01 1 1  ON 20
 eO_1                -4.847696e-01 1 1  ON 21
 eO_2                -5.349718e-02 1 1  ON 22
 eO_3                 2.183166e-01 1 1  ON 23
 eO_4                 3.210842e-01 1 1  ON 24
 eO_5                 3.399623e-01 1 1  ON 25
 eO_6                 2.737750e-01 1 1  ON 26
 eO_7                 1.388854e-01 1 1  ON 27
 eO_8                 3.227788e-02 1 1  ON 28
 eO_9                 2.038797e-02 1 1  ON 29
eH1_0                -1.867683e-01 1 1  ON 30
eH1_1                -1.071848e-01 1 1  ON 31
eH1_2                -6.427109e-02 1 1  ON 32
eH1_3                -2.612912e-02 1 1  ON 33
eH1_4                 1.891846e-02 1 1  ON 34
eH1_5                 3.043370e-02 1 1  ON 35
eH1_6                 7.403213e-02 1 1  ON 36
eH1_7                 1.083412e-01 1 1  ON 37
eH1_8                 1.056024e-01 1 1  ON 38
eH1_9                 2.971740e-02 1 1  ON 39
eH2_0                -1.873678e-01 1 1  ON 40
eH2_1                -1.079773e-01 1 1  ON 41
eH2_2                -6.494715e-02 1 1  ON 42
eH2_3                -2.708612e-02 1 1  ON 43
eH2_4                 1.757124e-02 1 1  ON 44
eH2_5                 2.904402e-02 1 1  ON 45
eH2_6                 7.403978e-02 1 1  ON 46
eH2_7                 1.110310e-01 1 1  ON 47
eH2_8                 1.097176e-01 1 1  ON 48
eH2_9                 3.123948e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1453
    reference variance = 0.186715
====================================================
  Execution time = 1.8935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4522e-01
  Total weights = 2.0000e+06
  Execution time = 1.5758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254906720
                                         uncertainty =       0.004814791169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254906720
                                         uncertainty =       0.004814791169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415455203
  error estimate for blocks of size 2^( 2) =       0.000425792972
  error estimate for blocks of size 2^( 3) =       0.000435627364
  error estimate for blocks of size 2^( 4) =       0.000442278419
  error estimate for blocks of size 2^( 5) =       0.000446312012
  error estimate for blocks of size 2^( 6) =       0.000450339938
  error estimate for blocks of size 2^( 7) =       0.000449864667

      target function =                  N/A
              le_mean =     -17.212107700406
             les_mean =     296.601857368967
             stat err =       0.000447198759
             autocorr =       1.158651357546
              std dev =       0.587542382453
             le_variance =       0.345206051178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345310820763
                                         uncertainty =       0.004814624241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345310820763
                                         uncertainty =       0.004814624241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415488895
  error estimate for blocks of size 2^( 2) =       0.000425824730
  error estimate for blocks of size 2^( 3) =       0.000435656875
  error estimate for blocks of size 2^( 4) =       0.000442304935
  error estimate for blocks of size 2^( 5) =       0.000446338949
  error estimate for blocks of size 2^( 6) =       0.000450366444
  error estimate for blocks of size 2^( 7) =       0.000449888253

      target function =                  N/A
              le_mean =     -17.212108362701
             les_mean =     296.601936160328
             stat err =       0.000447224645
             autocorr =       1.158597575822
              std dev =       0.587590030202
             le_variance =       0.345262043593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345287254894
                                         uncertainty =       0.004814580452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345287254894
                                         uncertainty =       0.004814580452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415474698
  error estimate for blocks of size 2^( 2) =       0.000425811273
  error estimate for blocks of size 2^( 3) =       0.000435644251
  error estimate for blocks of size 2^( 4) =       0.000442293438
  error estimate for blocks of size 2^( 5) =       0.000446327416
  error estimate for blocks of size 2^( 6) =       0.000450355080
  error estimate for blocks of size 2^( 7) =       0.000449877979

      target function =                  N/A
              le_mean =     -17.212108073827
             les_mean =     296.601902621567
             stat err =       0.000447213478
             autocorr =       1.158618892869
              std dev =       0.587569952516
             le_variance =       0.345238449099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345258861207
                                         uncertainty =       0.004814743821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345258861207
                                         uncertainty =       0.004814743821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415457587
  error estimate for blocks of size 2^( 2) =       0.000425795209
  error estimate for blocks of size 2^( 3) =       0.000435629427
  error estimate for blocks of size 2^( 4) =       0.000442280248
  error estimate for blocks of size 2^( 5) =       0.000446313905
  error estimate for blocks of size 2^( 6) =       0.000450341788
  error estimate for blocks of size 2^( 7) =       0.000449866223

      target function =                  N/A
              le_mean =     -17.212107745907
             les_mean =     296.601862896937
             stat err =       0.000447200541
             autocorr =       1.158647295713
              std dev =       0.587545753826
             le_variance =       0.345210012839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212107700406        initial
     5.9605e-01     5.9605e+00             2.9237e-04       -17.212108362701  <--
     2.3842e+00     2.3842e+01             8.7295e-05       -17.212108073827
     9.5367e+00     9.5367e+01             2.3215e-05       -17.212107745907

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.6920e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.203328e-01 1 1  ON 0
 uu_1                 5.400634e-02 1 1  ON 1
 uu_2                -4.589090e-02 1 1  ON 2
 uu_3                -1.034767e-01 1 1  ON 3
 uu_4                -1.370645e-01 1 1  ON 4
 uu_5                -1.441728e-01 1 1  ON 5
 uu_6                -1.223059e-01 1 1  ON 6
 uu_7                -5.304222e-02 1 1  ON 7
 uu_8                 8.640527e-02 1 1  ON 8
 uu_9                 1.338669e-01 1 1  ON 9
 ud_0                 3.693213e-01 1 1  ON 10
 ud_1                 1.028938e-01 1 1  ON 11
 ud_2                -1.505036e-02 1 1  ON 12
 ud_3                -7.927600e-02 1 1  ON 13
 ud_4                -1.271911e-01 1 1  ON 14
 ud_5                -1.580331e-01 1 1  ON 15
 ud_6                -1.594413e-01 1 1  ON 16
 ud_7                -1.151358e-01 1 1  ON 17
 ud_8                -1.847334e-02 1 1  ON 18
 ud_9                 9.184007e-02 1 1  ON 19
 eO_0                -8.196816e-01 1 1  ON 20
 eO_1                -4.848212e-01 1 1  ON 21
 eO_2                -5.354259e-02 1 1  ON 22
 eO_3                 2.182027e-01 1 1  ON 23
 eO_4                 3.210093e-01 1 1  ON 24
 eO_5                 3.400670e-01 1 1  ON 25
 eO_6                 2.739532e-01 1 1  ON 26
 eO_7                 1.390452e-01 1 1  ON 27
 eO_8                 3.230884e-02 1 1  ON 28
 eO_9                 2.039598e-02 1 1  ON 29
eH1_0                -1.867688e-01 1 1  ON 30
eH1_1                -1.072991e-01 1 1  ON 31
eH1_2                -6.435177e-02 1 1  ON 32
eH1_3                -2.619332e-02 1 1  ON 33
eH1_4                 1.893049e-02 1 1  ON 34
eH1_5                 3.052165e-02 1 1  ON 35
eH1_6                 7.403794e-02 1 1  ON 36
eH1_7                 1.083578e-01 1 1  ON 37
eH1_8                 1.056998e-01 1 1  ON 38
eH1_9                 2.974959e-02 1 1  ON 39
eH2_0                -1.873959e-01 1 1  ON 40
eH2_1                -1.079102e-01 1 1  ON 41
eH2_2                -6.491893e-02 1 1  ON 42
eH2_3                -2.714398e-02 1 1  ON 43
eH2_4                 1.752604e-02 1 1  ON 44
eH2_5                 2.901699e-02 1 1  ON 45
eH2_6                 7.396298e-02 1 1  ON 46
eH2_7                 1.110293e-01 1 1  ON 47
eH2_8                 1.098117e-01 1 1  ON 48
eH2_9                 3.127173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.341893
====================================================
  Execution time = 1.9072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3959e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339530520579
                                         uncertainty =       0.002769253377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339530520579
                                         uncertainty =       0.002769253377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412059797
  error estimate for blocks of size 2^( 2) =       0.000422550749
  error estimate for blocks of size 2^( 3) =       0.000431873927
  error estimate for blocks of size 2^( 4) =       0.000438729148
  error estimate for blocks of size 2^( 5) =       0.000443556399
  error estimate for blocks of size 2^( 6) =       0.000445494331
  error estimate for blocks of size 2^( 7) =       0.000447480300

      target function =                  N/A
              le_mean =     -17.211580787600
             les_mean =     296.578099591360
             stat err =       0.000443815045
             autocorr =       1.160068277689
              std dev =       0.582740553826
             le_variance =       0.339586553073


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721158078760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211580787600       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211580952785       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211581919536       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211582147274       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211580671034       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211581221194       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211581154283       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211581685756       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211580984400       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211581328843       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211581571857       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 7.616840e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211580787600       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211580854976       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211581425816       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211581693420       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211581301967       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211581372316       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211581566761       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211581369808       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.365074e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211580787600       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211580807602       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211581015883       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211581131734       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211581135203       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211581084513       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211581151637       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211581109034       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.517327e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4434e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.203240e-01 1 1  ON 0
 uu_1                 5.403695e-02 1 1  ON 1
 uu_2                -4.585898e-02 1 1  ON 2
 uu_3                -1.034454e-01 1 1  ON 3
 uu_4                -1.370355e-01 1 1  ON 4
 uu_5                -1.441182e-01 1 1  ON 5
 uu_6                -1.223422e-01 1 1  ON 6
 uu_7                -5.320465e-02 1 1  ON 7
 uu_8                 8.628034e-02 1 1  ON 8
 uu_9                 1.339263e-01 1 1  ON 9
 ud_0                 3.693691e-01 1 1  ON 10
 ud_1                 1.030007e-01 1 1  ON 11
 ud_2                -1.500016e-02 1 1  ON 12
 ud_3                -7.905291e-02 1 1  ON 13
 ud_4                -1.271781e-01 1 1  ON 14
 ud_5                -1.581021e-01 1 1  ON 15
 ud_6                -1.595560e-01 1 1  ON 16
 ud_7                -1.153127e-01 1 1  ON 17
 ud_8                -1.865959e-02 1 1  ON 18
 ud_9                 9.183963e-02 1 1  ON 19
 eO_0                -8.198172e-01 1 1  ON 20
 eO_1                -4.849200e-01 1 1  ON 21
 eO_2                -5.368648e-02 1 1  ON 22
 eO_3                 2.179662e-01 1 1  ON 23
 eO_4                 3.210994e-01 1 1  ON 24
 eO_5                 3.402032e-01 1 1  ON 25
 eO_6                 2.741149e-01 1 1  ON 26
 eO_7                 1.392233e-01 1 1  ON 27
 eO_8                 3.233060e-02 1 1  ON 28
 eO_9                 2.040883e-02 1 1  ON 29
eH1_0                -1.868017e-01 1 1  ON 30
eH1_1                -1.072020e-01 1 1  ON 31
eH1_2                -6.427015e-02 1 1  ON 32
eH1_3                -2.626715e-02 1 1  ON 33
eH1_4                 1.882475e-02 1 1  ON 34
eH1_5                 3.051558e-02 1 1  ON 35
eH1_6                 7.395586e-02 1 1  ON 36
eH1_7                 1.083277e-01 1 1  ON 37
eH1_8                 1.057979e-01 1 1  ON 38
eH1_9                 2.979129e-02 1 1  ON 39
eH2_0                -1.874376e-01 1 1  ON 40
eH2_1                -1.080600e-01 1 1  ON 41
eH2_2                -6.496186e-02 1 1  ON 42
eH2_3                -2.720417e-02 1 1  ON 43
eH2_4                 1.750952e-02 1 1  ON 44
eH2_5                 2.922798e-02 1 1  ON 45
eH2_6                 7.394842e-02 1 1  ON 46
eH2_7                 1.109867e-01 1 1  ON 47
eH2_8                 1.099169e-01 1 1  ON 48
eH2_9                 3.130604e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2656
    reference variance = 0.627082
====================================================
  Execution time = 1.8961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3884e-01
  Total weights = 2.0000e+06
  Execution time = 1.5703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338774944446
                                         uncertainty =       0.002642806544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338774944446
                                         uncertainty =       0.002642806544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411623340
  error estimate for blocks of size 2^( 2) =       0.000422208200
  error estimate for blocks of size 2^( 3) =       0.000431341590
  error estimate for blocks of size 2^( 4) =       0.000438335696
  error estimate for blocks of size 2^( 5) =       0.000442189183
  error estimate for blocks of size 2^( 6) =       0.000444491421
  error estimate for blocks of size 2^( 7) =       0.000446894241

      target function =                  N/A
              le_mean =     -17.211925700386
             les_mean =     296.589253694568
             stat err =       0.000442977635
             autocorr =       1.158146812184
              std dev =       0.582123310288
             le_variance =       0.338867548380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338685345947
                                         uncertainty =       0.002642778715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338685345947
                                         uncertainty =       0.002642778715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411569013
  error estimate for blocks of size 2^( 2) =       0.000422153797
  error estimate for blocks of size 2^( 3) =       0.000431290882
  error estimate for blocks of size 2^( 4) =       0.000438284034
  error estimate for blocks of size 2^( 5) =       0.000442134413
  error estimate for blocks of size 2^( 6) =       0.000444445791
  error estimate for blocks of size 2^( 7) =       0.000446852070

      target function =                  N/A
              le_mean =     -17.211922494978
             les_mean =     296.589053907891
             stat err =       0.000442929077
             autocorr =       1.158198625659
              std dev =       0.582046479360
             le_variance =       0.338778104135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720962899
                                         uncertainty =       0.002643095959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338720962899
                                         uncertainty =       0.002643095959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411590633
  error estimate for blocks of size 2^( 2) =       0.000422174420
  error estimate for blocks of size 2^( 3) =       0.000431310970
  error estimate for blocks of size 2^( 4) =       0.000438304135
  error estimate for blocks of size 2^( 5) =       0.000442153912
  error estimate for blocks of size 2^( 6) =       0.000444462734
  error estimate for blocks of size 2^( 7) =       0.000446866834

      target function =                  N/A
              le_mean =     -17.211922425224
             les_mean =     296.589087101085
             stat err =       0.000442946904
             autocorr =       1.158170170489
              std dev =       0.582077055517
             le_variance =       0.338813698559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338764685432
                                         uncertainty =       0.002642842952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338764685432
                                         uncertainty =       0.002642842952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411617116
  error estimate for blocks of size 2^( 2) =       0.000422201727
  error estimate for blocks of size 2^( 3) =       0.000431335590
  error estimate for blocks of size 2^( 4) =       0.000438329566
  error estimate for blocks of size 2^( 5) =       0.000442182369
  error estimate for blocks of size 2^( 6) =       0.000444485508
  error estimate for blocks of size 2^( 7) =       0.000446888034

      target function =                  N/A
              le_mean =     -17.211925035222
             les_mean =     296.589220549502
             stat err =       0.000442971369
             autocorr =       1.158149068793
              std dev =       0.582114508351
             le_variance =       0.338857300832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211925700386        initial  <--
     1.4901e-01     1.4901e+00             7.6168e-04       -17.211922494978
     5.9605e-01     5.9605e+00             2.3651e-04       -17.211922425224
     2.3842e+00     2.3842e+01             7.5173e-05       -17.211925035222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.9085
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.203328e-01 1 1  ON 0
 uu_1                 5.400634e-02 1 1  ON 1
 uu_2                -4.589090e-02 1 1  ON 2
 uu_3                -1.034767e-01 1 1  ON 3
 uu_4                -1.370645e-01 1 1  ON 4
 uu_5                -1.441728e-01 1 1  ON 5
 uu_6                -1.223059e-01 1 1  ON 6
 uu_7                -5.304222e-02 1 1  ON 7
 uu_8                 8.640527e-02 1 1  ON 8
 uu_9                 1.338669e-01 1 1  ON 9
 ud_0                 3.693213e-01 1 1  ON 10
 ud_1                 1.028938e-01 1 1  ON 11
 ud_2                -1.505036e-02 1 1  ON 12
 ud_3                -7.927600e-02 1 1  ON 13
 ud_4                -1.271911e-01 1 1  ON 14
 ud_5                -1.580331e-01 1 1  ON 15
 ud_6                -1.594413e-01 1 1  ON 16
 ud_7                -1.151358e-01 1 1  ON 17
 ud_8                -1.847334e-02 1 1  ON 18
 ud_9                 9.184007e-02 1 1  ON 19
 eO_0                -8.196816e-01 1 1  ON 20
 eO_1                -4.848212e-01 1 1  ON 21
 eO_2                -5.354259e-02 1 1  ON 22
 eO_3                 2.182027e-01 1 1  ON 23
 eO_4                 3.210093e-01 1 1  ON 24
 eO_5                 3.400670e-01 1 1  ON 25
 eO_6                 2.739532e-01 1 1  ON 26
 eO_7                 1.390452e-01 1 1  ON 27
 eO_8                 3.230884e-02 1 1  ON 28
 eO_9                 2.039598e-02 1 1  ON 29
eH1_0                -1.867688e-01 1 1  ON 30
eH1_1                -1.072991e-01 1 1  ON 31
eH1_2                -6.435177e-02 1 1  ON 32
eH1_3                -2.619332e-02 1 1  ON 33
eH1_4                 1.893049e-02 1 1  ON 34
eH1_5                 3.052165e-02 1 1  ON 35
eH1_6                 7.403794e-02 1 1  ON 36
eH1_7                 1.083578e-01 1 1  ON 37
eH1_8                 1.056998e-01 1 1  ON 38
eH1_9                 2.974959e-02 1 1  ON 39
eH2_0                -1.873959e-01 1 1  ON 40
eH2_1                -1.079102e-01 1 1  ON 41
eH2_2                -6.491893e-02 1 1  ON 42
eH2_3                -2.714398e-02 1 1  ON 43
eH2_4                 1.752604e-02 1 1  ON 44
eH2_5                 2.901699e-02 1 1  ON 45
eH2_6                 7.396298e-02 1 1  ON 46
eH2_7                 1.110293e-01 1 1  ON 47
eH2_8                 1.098117e-01 1 1  ON 48
eH2_9                 3.127173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1625
    reference variance = 0.21557
====================================================
  Execution time = 2.1130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4606e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346089436297
                                         uncertainty =       0.006470731801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346089436297
                                         uncertainty =       0.006470731801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415966797
  error estimate for blocks of size 2^( 2) =       0.000426501042
  error estimate for blocks of size 2^( 3) =       0.000436303772
  error estimate for blocks of size 2^( 4) =       0.000443218016
  error estimate for blocks of size 2^( 5) =       0.000447854653
  error estimate for blocks of size 2^( 6) =       0.000449455018
  error estimate for blocks of size 2^( 7) =       0.000448394798

      target function =                  N/A
              le_mean =     -17.211678153158
             les_mean =     296.587921426837
             stat err =       0.000447230622
             autocorr =       1.155967786729
              std dev =       0.588265885427
             le_variance =       0.346056751957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721167815316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211678153158       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211678337478       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211678842733       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211678707091       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211678579109       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211678858934       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211678773659       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.121435e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211678153158       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211678205342       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211678360678       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211678320021       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211678276966       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211678338007       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211678329128       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.918627e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211678153158       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211678166651       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211678207860       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211678197165       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211678185532       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211678199824       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211678198464       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.364704e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6376e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.203053e-01 1 1  ON 0
 uu_1                 5.400306e-02 1 1  ON 1
 uu_2                -4.586717e-02 1 1  ON 2
 uu_3                -1.034814e-01 1 1  ON 3
 uu_4                -1.370668e-01 1 1  ON 4
 uu_5                -1.441715e-01 1 1  ON 5
 uu_6                -1.223025e-01 1 1  ON 6
 uu_7                -5.304355e-02 1 1  ON 7
 uu_8                 8.639654e-02 1 1  ON 8
 uu_9                 1.338758e-01 1 1  ON 9
 ud_0                 3.693368e-01 1 1  ON 10
 ud_1                 1.028883e-01 1 1  ON 11
 ud_2                -1.505892e-02 1 1  ON 12
 ud_3                -7.927756e-02 1 1  ON 13
 ud_4                -1.271952e-01 1 1  ON 14
 ud_5                -1.580312e-01 1 1  ON 15
 ud_6                -1.594411e-01 1 1  ON 16
 ud_7                -1.151321e-01 1 1  ON 17
 ud_8                -1.848342e-02 1 1  ON 18
 ud_9                 9.183955e-02 1 1  ON 19
 eO_0                -8.196909e-01 1 1  ON 20
 eO_1                -4.848486e-01 1 1  ON 21
 eO_2                -5.354347e-02 1 1  ON 22
 eO_3                 2.181735e-01 1 1  ON 23
 eO_4                 3.210161e-01 1 1  ON 24
 eO_5                 3.400801e-01 1 1  ON 25
 eO_6                 2.739725e-01 1 1  ON 26
 eO_7                 1.390664e-01 1 1  ON 27
 eO_8                 3.231323e-02 1 1  ON 28
 eO_9                 2.039744e-02 1 1  ON 29
eH1_0                -1.867616e-01 1 1  ON 30
eH1_1                -1.073116e-01 1 1  ON 31
eH1_2                -6.435821e-02 1 1  ON 32
eH1_3                -2.618988e-02 1 1  ON 33
eH1_4                 1.890992e-02 1 1  ON 34
eH1_5                 3.053012e-02 1 1  ON 35
eH1_6                 7.404068e-02 1 1  ON 36
eH1_7                 1.083586e-01 1 1  ON 37
eH1_8                 1.057115e-01 1 1  ON 38
eH1_9                 2.975371e-02 1 1  ON 39
eH2_0                -1.874065e-01 1 1  ON 40
eH2_1                -1.079135e-01 1 1  ON 41
eH2_2                -6.492181e-02 1 1  ON 42
eH2_3                -2.713029e-02 1 1  ON 43
eH2_4                 1.751416e-02 1 1  ON 44
eH2_5                 2.903425e-02 1 1  ON 45
eH2_6                 7.395385e-02 1 1  ON 46
eH2_7                 1.110238e-01 1 1  ON 47
eH2_8                 1.098205e-01 1 1  ON 48
eH2_9                 3.127451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1776
    reference variance = 0.288262
====================================================
  Execution time = 1.9120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4219e-01
  Total weights = 2.0000e+06
  Execution time = 1.5808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342222276346
                                         uncertainty =       0.003356464488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342222276346
                                         uncertainty =       0.003356464488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413631802
  error estimate for blocks of size 2^( 2) =       0.000424283837
  error estimate for blocks of size 2^( 3) =       0.000433997225
  error estimate for blocks of size 2^( 4) =       0.000441363421
  error estimate for blocks of size 2^( 5) =       0.000446695491
  error estimate for blocks of size 2^( 6) =       0.000450636262
  error estimate for blocks of size 2^( 7) =       0.000453110994

      target function =                  N/A
              le_mean =     -17.211546177280
             les_mean =     296.579504176214
             stat err =       0.000447951542
             autocorr =       1.172827737685
              std dev =       0.584963703727
             le_variance =       0.342182534678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342242074275
                                         uncertainty =       0.003356931888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342242074275
                                         uncertainty =       0.003356931888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413643767
  error estimate for blocks of size 2^( 2) =       0.000424294488
  error estimate for blocks of size 2^( 3) =       0.000434006118
  error estimate for blocks of size 2^( 4) =       0.000441370449
  error estimate for blocks of size 2^( 5) =       0.000446701757
  error estimate for blocks of size 2^( 6) =       0.000450644021
  error estimate for blocks of size 2^( 7) =       0.000453119655

      target function =                  N/A
              le_mean =     -17.211545691092
             les_mean =     296.579507236618
             stat err =       0.000447958970
             autocorr =       1.172798785267
              std dev =       0.584980624619
             le_variance =       0.342202331179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235357169
                                         uncertainty =       0.003356757096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235357169
                                         uncertainty =       0.003356757096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413639707
  error estimate for blocks of size 2^( 2) =       0.000424290951
  error estimate for blocks of size 2^( 3) =       0.000434003262
  error estimate for blocks of size 2^( 4) =       0.000441368323
  error estimate for blocks of size 2^( 5) =       0.000446700010
  error estimate for blocks of size 2^( 6) =       0.000450641875
  error estimate for blocks of size 2^( 7) =       0.000453117186

      target function =                  N/A
              le_mean =     -17.211545882115
             les_mean =     296.579507095730
             stat err =       0.000447956848
             autocorr =       1.172810693303
              std dev =       0.584974883803
             le_variance =       0.342195614681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342224000961
                                         uncertainty =       0.003356503224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342224000961
                                         uncertainty =       0.003356503224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413632844
  error estimate for blocks of size 2^( 2) =       0.000424284775
  error estimate for blocks of size 2^( 3) =       0.000433998021
  error estimate for blocks of size 2^( 4) =       0.000441364067
  error estimate for blocks of size 2^( 5) =       0.000446696089
  error estimate for blocks of size 2^( 6) =       0.000450637013
  error estimate for blocks of size 2^( 7) =       0.000453111823

      target function =                  N/A
              le_mean =     -17.211546136310
             les_mean =     296.579504490429
             stat err =       0.000447952248
             autocorr =       1.172825523516
              std dev =       0.584965177754
             le_variance =       0.342184259185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211546177280        initial  <--
     1.4901e+00     1.4901e+01             1.1214e-04       -17.211545691092
     5.9605e+00     5.9605e+01             2.9186e-05       -17.211545882115
     2.3842e+01     2.3842e+02             7.3647e-06       -17.211546136310

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.1190
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.203328e-01 1 1  ON 0
 uu_1                 5.400634e-02 1 1  ON 1
 uu_2                -4.589090e-02 1 1  ON 2
 uu_3                -1.034767e-01 1 1  ON 3
 uu_4                -1.370645e-01 1 1  ON 4
 uu_5                -1.441728e-01 1 1  ON 5
 uu_6                -1.223059e-01 1 1  ON 6
 uu_7                -5.304222e-02 1 1  ON 7
 uu_8                 8.640527e-02 1 1  ON 8
 uu_9                 1.338669e-01 1 1  ON 9
 ud_0                 3.693213e-01 1 1  ON 10
 ud_1                 1.028938e-01 1 1  ON 11
 ud_2                -1.505036e-02 1 1  ON 12
 ud_3                -7.927600e-02 1 1  ON 13
 ud_4                -1.271911e-01 1 1  ON 14
 ud_5                -1.580331e-01 1 1  ON 15
 ud_6                -1.594413e-01 1 1  ON 16
 ud_7                -1.151358e-01 1 1  ON 17
 ud_8                -1.847334e-02 1 1  ON 18
 ud_9                 9.184007e-02 1 1  ON 19
 eO_0                -8.196816e-01 1 1  ON 20
 eO_1                -4.848212e-01 1 1  ON 21
 eO_2                -5.354259e-02 1 1  ON 22
 eO_3                 2.182027e-01 1 1  ON 23
 eO_4                 3.210093e-01 1 1  ON 24
 eO_5                 3.400670e-01 1 1  ON 25
 eO_6                 2.739532e-01 1 1  ON 26
 eO_7                 1.390452e-01 1 1  ON 27
 eO_8                 3.230884e-02 1 1  ON 28
 eO_9                 2.039598e-02 1 1  ON 29
eH1_0                -1.867688e-01 1 1  ON 30
eH1_1                -1.072991e-01 1 1  ON 31
eH1_2                -6.435177e-02 1 1  ON 32
eH1_3                -2.619332e-02 1 1  ON 33
eH1_4                 1.893049e-02 1 1  ON 34
eH1_5                 3.052165e-02 1 1  ON 35
eH1_6                 7.403794e-02 1 1  ON 36
eH1_7                 1.083578e-01 1 1  ON 37
eH1_8                 1.056998e-01 1 1  ON 38
eH1_9                 2.974959e-02 1 1  ON 39
eH2_0                -1.873959e-01 1 1  ON 40
eH2_1                -1.079102e-01 1 1  ON 41
eH2_2                -6.491893e-02 1 1  ON 42
eH2_3                -2.714398e-02 1 1  ON 43
eH2_4                 1.752604e-02 1 1  ON 44
eH2_5                 2.901699e-02 1 1  ON 45
eH2_6                 7.396298e-02 1 1  ON 46
eH2_7                 1.110293e-01 1 1  ON 47
eH2_8                 1.098117e-01 1 1  ON 48
eH2_9                 3.127173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3500e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2461
    reference variance = 0.301168
====================================================
  Execution time = 1.9399e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344231525558
                                         uncertainty =       0.006246519700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344231525558
                                         uncertainty =       0.006246519700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414911790
  error estimate for blocks of size 2^( 2) =       0.000425214093
  error estimate for blocks of size 2^( 3) =       0.000434653727
  error estimate for blocks of size 2^( 4) =       0.000441831385
  error estimate for blocks of size 2^( 5) =       0.000445828936
  error estimate for blocks of size 2^( 6) =       0.000447802908
  error estimate for blocks of size 2^( 7) =       0.000448136911

      target function =                  N/A
              le_mean =     -17.211715169576
             les_mean =     296.587442493390
             stat err =       0.000445900035
             autocorr =       1.154950739340
              std dev =       0.586773880577
             le_variance =       0.344303586928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171516958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211715169576       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211715200664       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211715218299       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211715157982       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211715173225       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211715158666       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211715162823       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.382635e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211715169576       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211715177417       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211715181961       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211715166733       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211715170334       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211715166794       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211715167796       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.488704e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211715169576       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211715171541       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211715172685       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211715168869       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211715169755       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211715168877       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211715169125       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 8.742227e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4766e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.203336e-01 1 1  ON 0
 uu_1                 5.400536e-02 1 1  ON 1
 uu_2                -4.588960e-02 1 1  ON 2
 uu_3                -1.034770e-01 1 1  ON 3
 uu_4                -1.370669e-01 1 1  ON 4
 uu_5                -1.441709e-01 1 1  ON 5
 uu_6                -1.223055e-01 1 1  ON 6
 uu_7                -5.304360e-02 1 1  ON 7
 uu_8                 8.640424e-02 1 1  ON 8
 uu_9                 1.338676e-01 1 1  ON 9
 ud_0                 3.693229e-01 1 1  ON 10
 ud_1                 1.028936e-01 1 1  ON 11
 ud_2                -1.505063e-02 1 1  ON 12
 ud_3                -7.927556e-02 1 1  ON 13
 ud_4                -1.271913e-01 1 1  ON 14
 ud_5                -1.580325e-01 1 1  ON 15
 ud_6                -1.594425e-01 1 1  ON 16
 ud_7                -1.151367e-01 1 1  ON 17
 ud_8                -1.847401e-02 1 1  ON 18
 ud_9                 9.184015e-02 1 1  ON 19
 eO_0                -8.196806e-01 1 1  ON 20
 eO_1                -4.848247e-01 1 1  ON 21
 eO_2                -5.354284e-02 1 1  ON 22
 eO_3                 2.181994e-01 1 1  ON 23
 eO_4                 3.210086e-01 1 1  ON 24
 eO_5                 3.400693e-01 1 1  ON 25
 eO_6                 2.739551e-01 1 1  ON 26
 eO_7                 1.390471e-01 1 1  ON 27
 eO_8                 3.230925e-02 1 1  ON 28
 eO_9                 2.039611e-02 1 1  ON 29
eH1_0                -1.867686e-01 1 1  ON 30
eH1_1                -1.072993e-01 1 1  ON 31
eH1_2                -6.435356e-02 1 1  ON 32
eH1_3                -2.619250e-02 1 1  ON 33
eH1_4                 1.892891e-02 1 1  ON 34
eH1_5                 3.052226e-02 1 1  ON 35
eH1_6                 7.403828e-02 1 1  ON 36
eH1_7                 1.083580e-01 1 1  ON 37
eH1_8                 1.057009e-01 1 1  ON 38
eH1_9                 2.974988e-02 1 1  ON 39
eH2_0                -1.873964e-01 1 1  ON 40
eH2_1                -1.079089e-01 1 1  ON 41
eH2_2                -6.491878e-02 1 1  ON 42
eH2_3                -2.714287e-02 1 1  ON 43
eH2_4                 1.752635e-02 1 1  ON 44
eH2_5                 2.901590e-02 1 1  ON 45
eH2_6                 7.396148e-02 1 1  ON 46
eH2_7                 1.110285e-01 1 1  ON 47
eH2_8                 1.098125e-01 1 1  ON 48
eH2_9                 3.127200e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1468
    reference variance = 0.486137
====================================================
  Execution time = 1.8493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4143e-01
  Total weights = 2.0000e+06
  Execution time = 1.5676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341496640630
                                         uncertainty =       0.002889021264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341496640630
                                         uncertainty =       0.002889021264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413175800
  error estimate for blocks of size 2^( 2) =       0.000423716712
  error estimate for blocks of size 2^( 3) =       0.000432532910
  error estimate for blocks of size 2^( 4) =       0.000439555036
  error estimate for blocks of size 2^( 5) =       0.000444114095
  error estimate for blocks of size 2^( 6) =       0.000447014201
  error estimate for blocks of size 2^( 7) =       0.000446541391

      target function =                  N/A
              le_mean =     -17.212270084469
             les_mean =     296.603669773771
             stat err =       0.000444306180
             autocorr =       1.156365045160
              std dev =       0.584318820310
             le_variance =       0.341428483768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341501532785
                                         uncertainty =       0.002889063356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341501532785
                                         uncertainty =       0.002889063356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413178761
  error estimate for blocks of size 2^( 2) =       0.000423719530
  error estimate for blocks of size 2^( 3) =       0.000432535544
  error estimate for blocks of size 2^( 4) =       0.000439557552
  error estimate for blocks of size 2^( 5) =       0.000444116381
  error estimate for blocks of size 2^( 6) =       0.000447016792
  error estimate for blocks of size 2^( 7) =       0.000446543567

      target function =                  N/A
              le_mean =     -17.212270136705
             les_mean =     296.603676465403
             stat err =       0.000444308573
             autocorr =       1.156360925403
              std dev =       0.584323007594
             le_variance =       0.341433377204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341499148257
                                         uncertainty =       0.002889042747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341499148257
                                         uncertainty =       0.002889042747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413177318
  error estimate for blocks of size 2^( 2) =       0.000423718156
  error estimate for blocks of size 2^( 3) =       0.000432534261
  error estimate for blocks of size 2^( 4) =       0.000439556326
  error estimate for blocks of size 2^( 5) =       0.000444115267
  error estimate for blocks of size 2^( 6) =       0.000447015529
  error estimate for blocks of size 2^( 7) =       0.000446542508

      target function =                  N/A
              le_mean =     -17.212270111025
             les_mean =     296.603673196244
             stat err =       0.000444307407
             autocorr =       1.156362936695
              std dev =       0.584320966662
             le_variance =       0.341430992081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341496955950
                                         uncertainty =       0.002889023963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341496955950
                                         uncertainty =       0.002889023963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413175991
  error estimate for blocks of size 2^( 2) =       0.000423716893
  error estimate for blocks of size 2^( 3) =       0.000432533080
  error estimate for blocks of size 2^( 4) =       0.000439555198
  error estimate for blocks of size 2^( 5) =       0.000444114242
  error estimate for blocks of size 2^( 6) =       0.000447014368
  error estimate for blocks of size 2^( 7) =       0.000446541531

      target function =                  N/A
              le_mean =     -17.212270087789
             les_mean =     296.603670203465
             stat err =       0.000444306335
             autocorr =       1.156364780018
              std dev =       0.584319090203
             le_variance =       0.341428799176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212270084469        initial
     1.4901e+01     1.4901e+02             1.3826e-05       -17.212270136705  <--
     5.9605e+01     5.9605e+02             3.4887e-06       -17.212270111025
     2.3842e+02     2.3842e+03             8.7422e-07       -17.212270087789

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.6508e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.203360e-01 1 1  ON 0
 uu_1                 5.400252e-02 1 1  ON 1
 uu_2                -4.588582e-02 1 1  ON 2
 uu_3                -1.034778e-01 1 1  ON 3
 uu_4                -1.370740e-01 1 1  ON 4
 uu_5                -1.441654e-01 1 1  ON 5
 uu_6                -1.223042e-01 1 1  ON 6
 uu_7                -5.304770e-02 1 1  ON 7
 uu_8                 8.640115e-02 1 1  ON 8
 uu_9                 1.338697e-01 1 1  ON 9
 ud_0                 3.693275e-01 1 1  ON 10
 ud_1                 1.028927e-01 1 1  ON 11
 ud_2                -1.505137e-02 1 1  ON 12
 ud_3                -7.927429e-02 1 1  ON 13
 ud_4                -1.271919e-01 1 1  ON 14
 ud_5                -1.580308e-01 1 1  ON 15
 ud_6                -1.594460e-01 1 1  ON 16
 ud_7                -1.151393e-01 1 1  ON 17
 ud_8                -1.847602e-02 1 1  ON 18
 ud_9                 9.184039e-02 1 1  ON 19
 eO_0                -8.196779e-01 1 1  ON 20
 eO_1                -4.848350e-01 1 1  ON 21
 eO_2                -5.354359e-02 1 1  ON 22
 eO_3                 2.181898e-01 1 1  ON 23
 eO_4                 3.210067e-01 1 1  ON 24
 eO_5                 3.400762e-01 1 1  ON 25
 eO_6                 2.739608e-01 1 1  ON 26
 eO_7                 1.390527e-01 1 1  ON 27
 eO_8                 3.231048e-02 1 1  ON 28
 eO_9                 2.039651e-02 1 1  ON 29
eH1_0                -1.867680e-01 1 1  ON 30
eH1_1                -1.072999e-01 1 1  ON 31
eH1_2                -6.435887e-02 1 1  ON 32
eH1_3                -2.619009e-02 1 1  ON 33
eH1_4                 1.892420e-02 1 1  ON 34
eH1_5                 3.052408e-02 1 1  ON 35
eH1_6                 7.403930e-02 1 1  ON 36
eH1_7                 1.083585e-01 1 1  ON 37
eH1_8                 1.057041e-01 1 1  ON 38
eH1_9                 2.975072e-02 1 1  ON 39
eH2_0                -1.873981e-01 1 1  ON 40
eH2_1                -1.079053e-01 1 1  ON 41
eH2_2                -6.491832e-02 1 1  ON 42
eH2_3                -2.713954e-02 1 1  ON 43
eH2_4                 1.752729e-02 1 1  ON 44
eH2_5                 2.901263e-02 1 1  ON 45
eH2_6                 7.395699e-02 1 1  ON 46
eH2_7                 1.110260e-01 1 1  ON 47
eH2_8                 1.098149e-01 1 1  ON 48
eH2_9                 3.127281e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1280e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1564
    reference variance = 0.381182
====================================================
  Execution time = 1.9406e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5384e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.1907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353839514076
                                         uncertainty =       0.012161566705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353839514076
                                         uncertainty =       0.012161566705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420619244
  error estimate for blocks of size 2^( 2) =       0.000430971584
  error estimate for blocks of size 2^( 3) =       0.000440254350
  error estimate for blocks of size 2^( 4) =       0.000446988122
  error estimate for blocks of size 2^( 5) =       0.000451780742
  error estimate for blocks of size 2^( 6) =       0.000454039535
  error estimate for blocks of size 2^( 7) =       0.000456541229

      target function =                  N/A
              le_mean =     -17.212114562781
             les_mean =     296.610728641518
             stat err =       0.000452337407
             autocorr =       1.156502915784
              std dev =       0.594845438875
             le_variance =       0.353841096150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211456278e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212114562781       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212114743858       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212114749112       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212114777574       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212114632514       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212114700090       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212114734912       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 4.288847e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212114562781       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212114610668       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212114612369       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212114620380       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212114583880       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212114601745       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212114608394       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.109929e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212114562781       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212114574928       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212114575383       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212114577448       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212114568315       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212114572847       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212114574374       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.800125e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4607e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.203355e-01 1 1  ON 0
 uu_1                 5.400117e-02 1 1  ON 1
 uu_2                -4.588132e-02 1 1  ON 2
 uu_3                -1.034770e-01 1 1  ON 3
 uu_4                -1.370707e-01 1 1  ON 4
 uu_5                -1.441662e-01 1 1  ON 5
 uu_6                -1.223075e-01 1 1  ON 6
 uu_7                -5.305191e-02 1 1  ON 7
 uu_8                 8.639751e-02 1 1  ON 8
 uu_9                 1.338721e-01 1 1  ON 9
 ud_0                 3.693312e-01 1 1  ON 10
 ud_1                 1.028912e-01 1 1  ON 11
 ud_2                -1.504644e-02 1 1  ON 12
 ud_3                -7.927078e-02 1 1  ON 13
 ud_4                -1.271920e-01 1 1  ON 14
 ud_5                -1.580329e-01 1 1  ON 15
 ud_6                -1.594494e-01 1 1  ON 16
 ud_7                -1.151415e-01 1 1  ON 17
 ud_8                -1.847966e-02 1 1  ON 18
 ud_9                 9.183904e-02 1 1  ON 19
 eO_0                -8.196777e-01 1 1  ON 20
 eO_1                -4.848461e-01 1 1  ON 21
 eO_2                -5.354626e-02 1 1  ON 22
 eO_3                 2.181789e-01 1 1  ON 23
 eO_4                 3.210075e-01 1 1  ON 24
 eO_5                 3.400828e-01 1 1  ON 25
 eO_6                 2.739689e-01 1 1  ON 26
 eO_7                 1.390601e-01 1 1  ON 27
 eO_8                 3.231153e-02 1 1  ON 28
 eO_9                 2.039671e-02 1 1  ON 29
eH1_0                -1.867685e-01 1 1  ON 30
eH1_1                -1.073103e-01 1 1  ON 31
eH1_2                -6.434898e-02 1 1  ON 32
eH1_3                -2.619670e-02 1 1  ON 33
eH1_4                 1.892236e-02 1 1  ON 34
eH1_5                 3.052675e-02 1 1  ON 35
eH1_6                 7.404036e-02 1 1  ON 36
eH1_7                 1.083588e-01 1 1  ON 37
eH1_8                 1.057082e-01 1 1  ON 38
eH1_9                 2.975185e-02 1 1  ON 39
eH2_0                -1.873974e-01 1 1  ON 40
eH2_1                -1.079133e-01 1 1  ON 41
eH2_2                -6.491852e-02 1 1  ON 42
eH2_3                -2.713489e-02 1 1  ON 43
eH2_4                 1.752947e-02 1 1  ON 44
eH2_5                 2.901581e-02 1 1  ON 45
eH2_6                 7.395125e-02 1 1  ON 46
eH2_7                 1.110246e-01 1 1  ON 47
eH2_8                 1.098186e-01 1 1  ON 48
eH2_9                 3.127373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1733
    reference variance = 0.136351
====================================================
  Execution time = 1.8972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4067e-01
  Total weights = 2.0000e+06
  Execution time = 1.5754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340714318924
                                         uncertainty =       0.003230595681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340714318924
                                         uncertainty =       0.003230595681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412720502
  error estimate for blocks of size 2^( 2) =       0.000423157529
  error estimate for blocks of size 2^( 3) =       0.000432722518
  error estimate for blocks of size 2^( 4) =       0.000439660612
  error estimate for blocks of size 2^( 5) =       0.000443699468
  error estimate for blocks of size 2^( 6) =       0.000444722951
  error estimate for blocks of size 2^( 7) =       0.000447700980

      target function =                  N/A
              le_mean =     -17.212185875388
             les_mean =     296.600018864077
             stat err =       0.000443946003
             autocorr =       1.157039574157
              std dev =       0.583674931358
             le_variance =       0.340676425496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340697684971
                                         uncertainty =       0.003230228924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340697684971
                                         uncertainty =       0.003230228924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412710424
  error estimate for blocks of size 2^( 2) =       0.000423147834
  error estimate for blocks of size 2^( 3) =       0.000432713364
  error estimate for blocks of size 2^( 4) =       0.000439651732
  error estimate for blocks of size 2^( 5) =       0.000443690283
  error estimate for blocks of size 2^( 6) =       0.000444714297
  error estimate for blocks of size 2^( 7) =       0.000447692399

      target function =                  N/A
              le_mean =     -17.212185910847
             les_mean =     296.600003446627
             stat err =       0.000443937178
             autocorr =       1.157050083145
              std dev =       0.583660678299
             le_variance =       0.340659787392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340705766693
                                         uncertainty =       0.003230403524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340705766693
                                         uncertainty =       0.003230403524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412715320
  error estimate for blocks of size 2^( 2) =       0.000423152551
  error estimate for blocks of size 2^( 3) =       0.000432717823
  error estimate for blocks of size 2^( 4) =       0.000439656067
  error estimate for blocks of size 2^( 5) =       0.000443694757
  error estimate for blocks of size 2^( 6) =       0.000444718522
  error estimate for blocks of size 2^( 7) =       0.000447696599

      target function =                  N/A
              le_mean =     -17.212185892388
             les_mean =     296.600010894248
             stat err =       0.000443941486
             autocorr =       1.157045087344
              std dev =       0.583667602713
             le_variance =       0.340667870457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340713241585
                                         uncertainty =       0.003230571362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340713241585
                                         uncertainty =       0.003230571362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412719849
  error estimate for blocks of size 2^( 2) =       0.000423156902
  error estimate for blocks of size 2^( 3) =       0.000432721927
  error estimate for blocks of size 2^( 4) =       0.000439660040
  error estimate for blocks of size 2^( 5) =       0.000443698874
  error estimate for blocks of size 2^( 6) =       0.000444722393
  error estimate for blocks of size 2^( 7) =       0.000447700428

      target function =                  N/A
              le_mean =     -17.212185877312
             les_mean =     296.600017852575
             stat err =       0.000443945434
             autocorr =       1.157040271365
              std dev =       0.583674008141
             le_variance =       0.340675347779


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212185875388        initial
     3.7253e+00     3.7253e+01             4.2888e-05       -17.212185910847  <--
     1.4901e+01     1.4901e+02             1.1099e-05       -17.212185892388
     5.9605e+01     5.9605e+02             2.8001e-06       -17.212185877312

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.6943e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.203337e-01 1 1  ON 0
 uu_1                 5.399842e-02 1 1  ON 1
 uu_2                -4.586914e-02 1 1  ON 2
 uu_3                -1.034740e-01 1 1  ON 3
 uu_4                -1.370614e-01 1 1  ON 4
 uu_5                -1.441684e-01 1 1  ON 5
 uu_6                -1.223170e-01 1 1  ON 6
 uu_7                -5.306450e-02 1 1  ON 7
 uu_8                 8.638667e-02 1 1  ON 8
 uu_9                 1.338790e-01 1 1  ON 9
 ud_0                 3.693408e-01 1 1  ON 10
 ud_1                 1.028885e-01 1 1  ON 11
 ud_2                -1.503301e-02 1 1  ON 12
 ud_3                -7.926007e-02 1 1  ON 13
 ud_4                -1.271919e-01 1 1  ON 14
 ud_5                -1.580393e-01 1 1  ON 15
 ud_6                -1.594595e-01 1 1  ON 16
 ud_7                -1.151484e-01 1 1  ON 17
 ud_8                -1.849050e-02 1 1  ON 18
 ud_9                 9.183500e-02 1 1  ON 19
 eO_0                -8.196785e-01 1 1  ON 20
 eO_1                -4.848779e-01 1 1  ON 21
 eO_2                -5.355422e-02 1 1  ON 22
 eO_3                 2.181472e-01 1 1  ON 23
 eO_4                 3.210098e-01 1 1  ON 24
 eO_5                 3.401023e-01 1 1  ON 25
 eO_6                 2.739931e-01 1 1  ON 26
 eO_7                 1.390823e-01 1 1  ON 27
 eO_8                 3.231465e-02 1 1  ON 28
 eO_9                 2.039731e-02 1 1  ON 29
eH1_0                -1.867704e-01 1 1  ON 30
eH1_1                -1.073396e-01 1 1  ON 31
eH1_2                -6.432205e-02 1 1  ON 32
eH1_3                -2.621517e-02 1 1  ON 33
eH1_4                 1.891676e-02 1 1  ON 34
eH1_5                 3.053453e-02 1 1  ON 35
eH1_6                 7.404351e-02 1 1  ON 36
eH1_7                 1.083595e-01 1 1  ON 37
eH1_8                 1.057205e-01 1 1  ON 38
eH1_9                 2.975520e-02 1 1  ON 39
eH2_0                -1.873958e-01 1 1  ON 40
eH2_1                -1.079362e-01 1 1  ON 41
eH2_2                -6.491899e-02 1 1  ON 42
eH2_3                -2.712177e-02 1 1  ON 43
eH2_4                 1.753614e-02 1 1  ON 44
eH2_5                 2.902531e-02 1 1  ON 45
eH2_6                 7.393411e-02 1 1  ON 46
eH2_7                 1.110204e-01 1 1  ON 47
eH2_8                 1.098293e-01 1 1  ON 48
eH2_9                 3.127647e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2458
    reference variance = 0.335843
====================================================
  Execution time = 1.9011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4625e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346366763391
                                         uncertainty =       0.003876419317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346366763391
                                         uncertainty =       0.003876419317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416081576
  error estimate for blocks of size 2^( 2) =       0.000426581151
  error estimate for blocks of size 2^( 3) =       0.000435316141
  error estimate for blocks of size 2^( 4) =       0.000442269647
  error estimate for blocks of size 2^( 5) =       0.000446418034
  error estimate for blocks of size 2^( 6) =       0.000449161286
  error estimate for blocks of size 2^( 7) =       0.000449334925

      target function =                  N/A
              le_mean =     -17.211585507583
             les_mean =     296.584923267491
             stat err =       0.000446795973
             autocorr =       1.153085547419
              std dev =       0.588428207835
             le_variance =       0.346247755776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721158550758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211585507583       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211585966805       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211585576094       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211585372566       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211585113559       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211585112768       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211585138376       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211585274129       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 1.444936e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211585507583       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211585636441       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211585507024       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211585443195       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211585324869       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211585333602       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211585343493       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 3.709931e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211585507583       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211585540814       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211585505629       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211585488524       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211585453403       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211585456113       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211585459210       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 9.441841e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4259e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.203458e-01 1 1  ON 0
 uu_1                 5.398252e-02 1 1  ON 1
 uu_2                -4.584556e-02 1 1  ON 2
 uu_3                -1.034718e-01 1 1  ON 3
 uu_4                -1.370942e-01 1 1  ON 4
 uu_5                -1.441486e-01 1 1  ON 5
 uu_6                -1.223178e-01 1 1  ON 6
 uu_7                -5.307286e-02 1 1  ON 7
 uu_8                 8.636885e-02 1 1  ON 8
 uu_9                 1.338844e-01 1 1  ON 9
 ud_0                 3.693668e-01 1 1  ON 10
 ud_1                 1.029016e-01 1 1  ON 11
 ud_2                -1.503621e-02 1 1  ON 12
 ud_3                -7.924281e-02 1 1  ON 13
 ud_4                -1.272142e-01 1 1  ON 14
 ud_5                -1.580334e-01 1 1  ON 15
 ud_6                -1.594689e-01 1 1  ON 16
 ud_7                -1.151601e-01 1 1  ON 17
 ud_8                -1.851034e-02 1 1  ON 18
 ud_9                 9.182730e-02 1 1  ON 19
 eO_0                -8.196791e-01 1 1  ON 20
 eO_1                -4.849070e-01 1 1  ON 21
 eO_2                -5.357780e-02 1 1  ON 22
 eO_3                 2.181101e-01 1 1  ON 23
 eO_4                 3.210122e-01 1 1  ON 24
 eO_5                 3.401206e-01 1 1  ON 25
 eO_6                 2.740233e-01 1 1  ON 26
 eO_7                 1.391149e-01 1 1  ON 27
 eO_8                 3.231972e-02 1 1  ON 28
 eO_9                 2.039756e-02 1 1  ON 29
eH1_0                -1.867688e-01 1 1  ON 30
eH1_1                -1.073553e-01 1 1  ON 31
eH1_2                -6.433635e-02 1 1  ON 32
eH1_3                -2.620699e-02 1 1  ON 33
eH1_4                 1.889703e-02 1 1  ON 34
eH1_5                 3.055227e-02 1 1  ON 35
eH1_6                 7.404749e-02 1 1  ON 36
eH1_7                 1.083580e-01 1 1  ON 37
eH1_8                 1.057367e-01 1 1  ON 38
eH1_9                 2.975864e-02 1 1  ON 39
eH2_0                -1.873672e-01 1 1  ON 40
eH2_1                -1.079616e-01 1 1  ON 41
eH2_2                -6.493000e-02 1 1  ON 42
eH2_3                -2.714295e-02 1 1  ON 43
eH2_4                 1.754549e-02 1 1  ON 44
eH2_5                 2.904581e-02 1 1  ON 45
eH2_6                 7.392177e-02 1 1  ON 46
eH2_7                 1.110055e-01 1 1  ON 47
eH2_8                 1.098454e-01 1 1  ON 48
eH2_9                 3.128390e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1481
    reference variance = 0.257244
====================================================
  Execution time = 1.8525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4497e-01
  Total weights = 2.0000e+06
  Execution time = 1.5720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344995247563
                                         uncertainty =       0.003811359904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344995247563
                                         uncertainty =       0.003811359904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415305035
  error estimate for blocks of size 2^( 2) =       0.000425972306
  error estimate for blocks of size 2^( 3) =       0.000436246223
  error estimate for blocks of size 2^( 4) =       0.000443217626
  error estimate for blocks of size 2^( 5) =       0.000447326963
  error estimate for blocks of size 2^( 6) =       0.000450153704
  error estimate for blocks of size 2^( 7) =       0.000451862980

      target function =                  N/A
              le_mean =     -17.211743918776
             les_mean =     296.589085097071
             stat err =       0.000448140318
             autocorr =       1.164377068748
              std dev =       0.587330012882
             le_variance =       0.344956544032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345049019648
                                         uncertainty =       0.003812476368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345049019648
                                         uncertainty =       0.003812476368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415337391
  error estimate for blocks of size 2^( 2) =       0.000426002587
  error estimate for blocks of size 2^( 3) =       0.000436273184
  error estimate for blocks of size 2^( 4) =       0.000443242608
  error estimate for blocks of size 2^( 5) =       0.000447351422
  error estimate for blocks of size 2^( 6) =       0.000450176713
  error estimate for blocks of size 2^( 7) =       0.000451880924

      target function =                  N/A
              le_mean =     -17.211743705685
             les_mean =     296.589131514337
             stat err =       0.000448162917
             autocorr =       1.164313077004
              std dev =       0.587375771265
             le_variance =       0.345010296670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030825384
                                         uncertainty =       0.003812071131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030825384
                                         uncertainty =       0.003812071131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415326445
  error estimate for blocks of size 2^( 2) =       0.000425992282
  error estimate for blocks of size 2^( 3) =       0.000436264112
  error estimate for blocks of size 2^( 4) =       0.000443234315
  error estimate for blocks of size 2^( 5) =       0.000447343163
  error estimate for blocks of size 2^( 6) =       0.000450168715
  error estimate for blocks of size 2^( 7) =       0.000451874349

      target function =                  N/A
              le_mean =     -17.211743749234
             les_mean =     296.589114828568
             stat err =       0.000448155135
             autocorr =       1.164334015560
              std dev =       0.587360291281
             le_variance =       0.344992111773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344999955815
                                         uncertainty =       0.003811457925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344999955815
                                         uncertainty =       0.003811457925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415307868
  error estimate for blocks of size 2^( 2) =       0.000425974943
  error estimate for blocks of size 2^( 3) =       0.000436248580
  error estimate for blocks of size 2^( 4) =       0.000443219822
  error estimate for blocks of size 2^( 5) =       0.000447329090
  error estimate for blocks of size 2^( 6) =       0.000450155664
  error estimate for blocks of size 2^( 7) =       0.000451864440

      target function =                  N/A
              le_mean =     -17.211743888533
             les_mean =     296.589088762942
             stat err =       0.000448142254
             autocorr =       1.164371240279
              std dev =       0.587334019923
             le_variance =       0.344961250959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211743918776        initial  <--
     9.3132e-01     9.3132e+00             1.4449e-04       -17.211743705685
     3.7253e+00     3.7253e+01             3.7099e-05       -17.211743749234
     1.4901e+01     1.4901e+02             9.4418e-06       -17.211743888533

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.5117
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.203337e-01 1 1  ON 0
 uu_1                 5.399842e-02 1 1  ON 1
 uu_2                -4.586914e-02 1 1  ON 2
 uu_3                -1.034740e-01 1 1  ON 3
 uu_4                -1.370614e-01 1 1  ON 4
 uu_5                -1.441684e-01 1 1  ON 5
 uu_6                -1.223170e-01 1 1  ON 6
 uu_7                -5.306450e-02 1 1  ON 7
 uu_8                 8.638667e-02 1 1  ON 8
 uu_9                 1.338790e-01 1 1  ON 9
 ud_0                 3.693408e-01 1 1  ON 10
 ud_1                 1.028885e-01 1 1  ON 11
 ud_2                -1.503301e-02 1 1  ON 12
 ud_3                -7.926007e-02 1 1  ON 13
 ud_4                -1.271919e-01 1 1  ON 14
 ud_5                -1.580393e-01 1 1  ON 15
 ud_6                -1.594595e-01 1 1  ON 16
 ud_7                -1.151484e-01 1 1  ON 17
 ud_8                -1.849050e-02 1 1  ON 18
 ud_9                 9.183500e-02 1 1  ON 19
 eO_0                -8.196785e-01 1 1  ON 20
 eO_1                -4.848779e-01 1 1  ON 21
 eO_2                -5.355422e-02 1 1  ON 22
 eO_3                 2.181472e-01 1 1  ON 23
 eO_4                 3.210098e-01 1 1  ON 24
 eO_5                 3.401023e-01 1 1  ON 25
 eO_6                 2.739931e-01 1 1  ON 26
 eO_7                 1.390823e-01 1 1  ON 27
 eO_8                 3.231465e-02 1 1  ON 28
 eO_9                 2.039731e-02 1 1  ON 29
eH1_0                -1.867704e-01 1 1  ON 30
eH1_1                -1.073396e-01 1 1  ON 31
eH1_2                -6.432205e-02 1 1  ON 32
eH1_3                -2.621517e-02 1 1  ON 33
eH1_4                 1.891676e-02 1 1  ON 34
eH1_5                 3.053453e-02 1 1  ON 35
eH1_6                 7.404351e-02 1 1  ON 36
eH1_7                 1.083595e-01 1 1  ON 37
eH1_8                 1.057205e-01 1 1  ON 38
eH1_9                 2.975520e-02 1 1  ON 39
eH2_0                -1.873958e-01 1 1  ON 40
eH2_1                -1.079362e-01 1 1  ON 41
eH2_2                -6.491899e-02 1 1  ON 42
eH2_3                -2.712177e-02 1 1  ON 43
eH2_4                 1.753614e-02 1 1  ON 44
eH2_5                 2.902531e-02 1 1  ON 45
eH2_6                 7.393411e-02 1 1  ON 46
eH2_7                 1.110204e-01 1 1  ON 47
eH2_8                 1.098293e-01 1 1  ON 48
eH2_9                 3.127647e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.471725
====================================================
  Execution time = 1.9078e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4331e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343207464807
                                         uncertainty =       0.002831126183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343207464807
                                         uncertainty =       0.002831126183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414313580
  error estimate for blocks of size 2^( 2) =       0.000425179327
  error estimate for blocks of size 2^( 3) =       0.000434596755
  error estimate for blocks of size 2^( 4) =       0.000441965716
  error estimate for blocks of size 2^( 5) =       0.000447242443
  error estimate for blocks of size 2^( 6) =       0.000450381703
  error estimate for blocks of size 2^( 7) =       0.000452195351

      target function =                  N/A
              le_mean =     -17.212082562078
             les_mean =     296.599097438062
             stat err =       0.000447946304
             autocorr =       1.168943650664
              std dev =       0.585927884571
             le_variance =       0.343311485918


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208256208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212082562078       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212082597105       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212082589303       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212082510571       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212082534618       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212082543144       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212082548498       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.083024e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212082562078       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212082570997       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212082569167       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212082549108       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212082554910       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212082557062       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212082558298       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.267662e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212082562078       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212082564318       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212082563869       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212082558830       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212082560267       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212082560805       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212082561108       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.320797e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4493e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.203317e-01 1 1  ON 0
 uu_1                 5.399975e-02 1 1  ON 1
 uu_2                -4.586660e-02 1 1  ON 2
 uu_3                -1.034733e-01 1 1  ON 3
 uu_4                -1.370611e-01 1 1  ON 4
 uu_5                -1.441707e-01 1 1  ON 5
 uu_6                -1.223177e-01 1 1  ON 6
 uu_7                -5.306602e-02 1 1  ON 7
 uu_8                 8.638479e-02 1 1  ON 8
 uu_9                 1.338802e-01 1 1  ON 9
 ud_0                 3.693417e-01 1 1  ON 10
 ud_1                 1.028876e-01 1 1  ON 11
 ud_2                -1.503312e-02 1 1  ON 12
 ud_3                -7.926001e-02 1 1  ON 13
 ud_4                -1.271926e-01 1 1  ON 14
 ud_5                -1.580369e-01 1 1  ON 15
 ud_6                -1.594609e-01 1 1  ON 16
 ud_7                -1.151493e-01 1 1  ON 17
 ud_8                -1.849185e-02 1 1  ON 18
 ud_9                 9.183497e-02 1 1  ON 19
 eO_0                -8.196793e-01 1 1  ON 20
 eO_1                -4.848819e-01 1 1  ON 21
 eO_2                -5.355949e-02 1 1  ON 22
 eO_3                 2.181452e-01 1 1  ON 23
 eO_4                 3.210126e-01 1 1  ON 24
 eO_5                 3.401037e-01 1 1  ON 25
 eO_6                 2.739962e-01 1 1  ON 26
 eO_7                 1.390858e-01 1 1  ON 27
 eO_8                 3.231520e-02 1 1  ON 28
 eO_9                 2.039747e-02 1 1  ON 29
eH1_0                -1.867720e-01 1 1  ON 30
eH1_1                -1.073392e-01 1 1  ON 31
eH1_2                -6.432166e-02 1 1  ON 32
eH1_3                -2.621623e-02 1 1  ON 33
eH1_4                 1.891733e-02 1 1  ON 34
eH1_5                 3.053486e-02 1 1  ON 35
eH1_6                 7.404158e-02 1 1  ON 36
eH1_7                 1.083594e-01 1 1  ON 37
eH1_8                 1.057226e-01 1 1  ON 38
eH1_9                 2.975590e-02 1 1  ON 39
eH2_0                -1.873956e-01 1 1  ON 40
eH2_1                -1.079333e-01 1 1  ON 41
eH2_2                -6.492247e-02 1 1  ON 42
eH2_3                -2.711885e-02 1 1  ON 43
eH2_4                 1.753477e-02 1 1  ON 44
eH2_5                 2.902491e-02 1 1  ON 45
eH2_6                 7.393271e-02 1 1  ON 46
eH2_7                 1.110185e-01 1 1  ON 47
eH2_8                 1.098309e-01 1 1  ON 48
eH2_9                 3.127700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1538
    reference variance = 0.554198
====================================================
  Execution time = 1.8926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3656e-01
  Total weights = 2.0000e+06
  Execution time = 1.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359585547
                                         uncertainty =       0.002693882450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359585547
                                         uncertainty =       0.002693882450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221581
  error estimate for blocks of size 2^( 2) =       0.000420462372
  error estimate for blocks of size 2^( 3) =       0.000430040349
  error estimate for blocks of size 2^( 4) =       0.000436745313
  error estimate for blocks of size 2^( 5) =       0.000441854437
  error estimate for blocks of size 2^( 6) =       0.000443069470
  error estimate for blocks of size 2^( 7) =       0.000442009721

      target function =                  N/A
              le_mean =     -17.211438826745
             les_mean =     296.570189809314
             stat err =       0.000440919735
             autocorr =       1.155266202764
              std dev =       0.580140923230
             le_variance =       0.336563490806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359860932
                                         uncertainty =       0.002693821160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359860932
                                         uncertainty =       0.002693821160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221745
  error estimate for blocks of size 2^( 2) =       0.000420462449
  error estimate for blocks of size 2^( 3) =       0.000430040388
  error estimate for blocks of size 2^( 4) =       0.000436745429
  error estimate for blocks of size 2^( 5) =       0.000441854459
  error estimate for blocks of size 2^( 6) =       0.000443069092
  error estimate for blocks of size 2^( 7) =       0.000442009240

      target function =                  N/A
              le_mean =     -17.211438913359
             les_mean =     296.570193060727
             stat err =       0.000440919555
             autocorr =       1.155264331219
              std dev =       0.580141155849
             le_variance =       0.336563760709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359807113
                                         uncertainty =       0.002693851747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359807113
                                         uncertainty =       0.002693851747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221714
  error estimate for blocks of size 2^( 2) =       0.000420462458
  error estimate for blocks of size 2^( 3) =       0.000430040416
  error estimate for blocks of size 2^( 4) =       0.000436745419
  error estimate for blocks of size 2^( 5) =       0.000441854494
  error estimate for blocks of size 2^( 6) =       0.000443069323
  error estimate for blocks of size 2^( 7) =       0.000442009523

      target function =                  N/A
              le_mean =     -17.211438870847
             les_mean =     296.570191546210
             stat err =       0.000440919690
             autocorr =       1.155265211801
              std dev =       0.580141111802
             le_variance =       0.336563709603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359615775
                                         uncertainty =       0.002693878610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359615775
                                         uncertainty =       0.002693878610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410221599
  error estimate for blocks of size 2^( 2) =       0.000420462384
  error estimate for blocks of size 2^( 3) =       0.000430040359
  error estimate for blocks of size 2^( 4) =       0.000436745328
  error estimate for blocks of size 2^( 5) =       0.000441854446
  error estimate for blocks of size 2^( 6) =       0.000443069453
  error estimate for blocks of size 2^( 7) =       0.000442009697

      target function =                  N/A
              le_mean =     -17.211438832268
             les_mean =     296.570190029307
             stat err =       0.000440919731
             autocorr =       1.155266077171
              std dev =       0.580140948983
             le_variance =       0.336563520687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211438826745        initial
     9.3132e+00     9.3132e+01             2.0830e-05       -17.211438913359  <--
     3.7253e+01     3.7253e+02             5.2677e-06       -17.211438870847
     1.4901e+02     1.4901e+03             1.3208e-06       -17.211438832268

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.6947e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.203259e-01 1 1  ON 0
 uu_1                 5.400374e-02 1 1  ON 1
 uu_2                -4.585920e-02 1 1  ON 2
 uu_3                -1.034709e-01 1 1  ON 3
 uu_4                -1.370605e-01 1 1  ON 4
 uu_5                -1.441775e-01 1 1  ON 5
 uu_6                -1.223198e-01 1 1  ON 6
 uu_7                -5.307058e-02 1 1  ON 7
 uu_8                 8.637917e-02 1 1  ON 8
 uu_9                 1.338840e-01 1 1  ON 9
 ud_0                 3.693441e-01 1 1  ON 10
 ud_1                 1.028852e-01 1 1  ON 11
 ud_2                -1.503343e-02 1 1  ON 12
 ud_3                -7.925979e-02 1 1  ON 13
 ud_4                -1.271947e-01 1 1  ON 14
 ud_5                -1.580296e-01 1 1  ON 15
 ud_6                -1.594650e-01 1 1  ON 16
 ud_7                -1.151521e-01 1 1  ON 17
 ud_8                -1.849589e-02 1 1  ON 18
 ud_9                 9.183489e-02 1 1  ON 19
 eO_0                -8.196817e-01 1 1  ON 20
 eO_1                -4.848938e-01 1 1  ON 21
 eO_2                -5.357505e-02 1 1  ON 22
 eO_3                 2.181394e-01 1 1  ON 23
 eO_4                 3.210211e-01 1 1  ON 24
 eO_5                 3.401078e-01 1 1  ON 25
 eO_6                 2.740056e-01 1 1  ON 26
 eO_7                 1.390964e-01 1 1  ON 27
 eO_8                 3.231683e-02 1 1  ON 28
 eO_9                 2.039794e-02 1 1  ON 29
eH1_0                -1.867769e-01 1 1  ON 30
eH1_1                -1.073379e-01 1 1  ON 31
eH1_2                -6.432062e-02 1 1  ON 32
eH1_3                -2.621929e-02 1 1  ON 33
eH1_4                 1.891899e-02 1 1  ON 34
eH1_5                 3.053586e-02 1 1  ON 35
eH1_6                 7.403581e-02 1 1  ON 36
eH1_7                 1.083591e-01 1 1  ON 37
eH1_8                 1.057290e-01 1 1  ON 38
eH1_9                 2.975798e-02 1 1  ON 39
eH2_0                -1.873950e-01 1 1  ON 40
eH2_1                -1.079247e-01 1 1  ON 41
eH2_2                -6.493259e-02 1 1  ON 42
eH2_3                -2.711029e-02 1 1  ON 43
eH2_4                 1.753076e-02 1 1  ON 44
eH2_5                 2.902369e-02 1 1  ON 45
eH2_6                 7.392853e-02 1 1  ON 46
eH2_7                 1.110129e-01 1 1  ON 47
eH2_8                 1.098355e-01 1 1  ON 48
eH2_9                 3.127857e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.19281
====================================================
  Execution time = 1.8817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4122e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341305890944
                                         uncertainty =       0.004504555885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341305890944
                                         uncertainty =       0.004504555885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413048548
  error estimate for blocks of size 2^( 2) =       0.000423373014
  error estimate for blocks of size 2^( 3) =       0.000432480352
  error estimate for blocks of size 2^( 4) =       0.000439500736
  error estimate for blocks of size 2^( 5) =       0.000443884324
  error estimate for blocks of size 2^( 6) =       0.000445915725
  error estimate for blocks of size 2^( 7) =       0.000445928487

      target function =                  N/A
              le_mean =     -17.211631614801
             les_mean =     296.581480879001
             stat err =       0.000443807318
             autocorr =       1.154480809806
              std dev =       0.584138858492
             le_variance =       0.341218206000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721163161480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211631614801       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211631910625       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211632002700       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211631978983       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211631962524       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211632001024       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211632052654       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 7.372236e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211631614801       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211631692973       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211631719458       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211631713389       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211631706777       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211631715986       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211631729133       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.854531e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211631614801       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211631634626       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211631641493       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211631639971       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211631638146       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211631640399       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211631643704       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.642507e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4113e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.203207e-01 1 1  ON 0
 uu_1                 5.400006e-02 1 1  ON 1
 uu_2                -4.585698e-02 1 1  ON 2
 uu_3                -1.034688e-01 1 1  ON 3
 uu_4                -1.370655e-01 1 1  ON 4
 uu_5                -1.441795e-01 1 1  ON 5
 uu_6                -1.223164e-01 1 1  ON 6
 uu_7                -5.307107e-02 1 1  ON 7
 uu_8                 8.637525e-02 1 1  ON 8
 uu_9                 1.338887e-01 1 1  ON 9
 ud_0                 3.693476e-01 1 1  ON 10
 ud_1                 1.028872e-01 1 1  ON 11
 ud_2                -1.503604e-02 1 1  ON 12
 ud_3                -7.926250e-02 1 1  ON 13
 ud_4                -1.271960e-01 1 1  ON 14
 ud_5                -1.580336e-01 1 1  ON 15
 ud_6                -1.594633e-01 1 1  ON 16
 ud_7                -1.151505e-01 1 1  ON 17
 ud_8                -1.849996e-02 1 1  ON 18
 ud_9                 9.183477e-02 1 1  ON 19
 eO_0                -8.196937e-01 1 1  ON 20
 eO_1                -4.848980e-01 1 1  ON 21
 eO_2                -5.358983e-02 1 1  ON 22
 eO_3                 2.181208e-01 1 1  ON 23
 eO_4                 3.210231e-01 1 1  ON 24
 eO_5                 3.401214e-01 1 1  ON 25
 eO_6                 2.740211e-01 1 1  ON 26
 eO_7                 1.391111e-01 1 1  ON 27
 eO_8                 3.231917e-02 1 1  ON 28
 eO_9                 2.039867e-02 1 1  ON 29
eH1_0                -1.867834e-01 1 1  ON 30
eH1_1                -1.073452e-01 1 1  ON 31
eH1_2                -6.432173e-02 1 1  ON 32
eH1_3                -2.622135e-02 1 1  ON 33
eH1_4                 1.891378e-02 1 1  ON 34
eH1_5                 3.053873e-02 1 1  ON 35
eH1_6                 7.404029e-02 1 1  ON 36
eH1_7                 1.083634e-01 1 1  ON 37
eH1_8                 1.057364e-01 1 1  ON 38
eH1_9                 2.975988e-02 1 1  ON 39
eH2_0                -1.873946e-01 1 1  ON 40
eH2_1                -1.079223e-01 1 1  ON 41
eH2_2                -6.493918e-02 1 1  ON 42
eH2_3                -2.710716e-02 1 1  ON 43
eH2_4                 1.752689e-02 1 1  ON 44
eH2_5                 2.902351e-02 1 1  ON 45
eH2_6                 7.392316e-02 1 1  ON 46
eH2_7                 1.110129e-01 1 1  ON 47
eH2_8                 1.098429e-01 1 1  ON 48
eH2_9                 3.128058e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1652
    reference variance = 0.183663
====================================================
  Execution time = 1.8416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3714e-01
  Total weights = 2.0000e+06
  Execution time = 1.5798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337219865507
                                         uncertainty =       0.002736884717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337219865507
                                         uncertainty =       0.002736884717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410568891
  error estimate for blocks of size 2^( 2) =       0.000421268889
  error estimate for blocks of size 2^( 3) =       0.000430925889
  error estimate for blocks of size 2^( 4) =       0.000438409080
  error estimate for blocks of size 2^( 5) =       0.000442148635
  error estimate for blocks of size 2^( 6) =       0.000444325373
  error estimate for blocks of size 2^( 7) =       0.000446012089

      target function =                  N/A
              le_mean =     -17.211783401410
             les_mean =     296.582621317009
             stat err =       0.000442723794
             autocorr =       1.162769545862
              std dev =       0.580632093949
             le_variance =       0.337133628524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337230388876
                                         uncertainty =       0.002736997754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337230388876
                                         uncertainty =       0.002736997754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410575302
  error estimate for blocks of size 2^( 2) =       0.000421274714
  error estimate for blocks of size 2^( 3) =       0.000430930859
  error estimate for blocks of size 2^( 4) =       0.000438413393
  error estimate for blocks of size 2^( 5) =       0.000442153101
  error estimate for blocks of size 2^( 6) =       0.000444329594
  error estimate for blocks of size 2^( 7) =       0.000446015440

      target function =                  N/A
              le_mean =     -17.211783325407
             les_mean =     296.582629228791
             stat err =       0.000442727882
             autocorr =       1.162754706254
              std dev =       0.580641159940
             le_variance =       0.337144156617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337225626775
                                         uncertainty =       0.002736946893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337225626775
                                         uncertainty =       0.002736946893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410572401
  error estimate for blocks of size 2^( 2) =       0.000421272066
  error estimate for blocks of size 2^( 3) =       0.000430928588
  error estimate for blocks of size 2^( 4) =       0.000438411418
  error estimate for blocks of size 2^( 5) =       0.000442151055
  error estimate for blocks of size 2^( 6) =       0.000444327662
  error estimate for blocks of size 2^( 7) =       0.000446013870

      target function =                  N/A
              le_mean =     -17.211783357348
             les_mean =     296.582625564147
             stat err =       0.000442726001
             autocorr =       1.162761259053
              std dev =       0.580637057418
             le_variance =       0.337139392447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337220598710
                                         uncertainty =       0.002736892663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337220598710
                                         uncertainty =       0.002736892663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410569338
  error estimate for blocks of size 2^( 2) =       0.000421269292
  error estimate for blocks of size 2^( 3) =       0.000430926231
  error estimate for blocks of size 2^( 4) =       0.000438409375
  error estimate for blocks of size 2^( 5) =       0.000442148941
  error estimate for blocks of size 2^( 6) =       0.000444325663
  error estimate for blocks of size 2^( 7) =       0.000446012312

      target function =                  N/A
              le_mean =     -17.211783395483
             les_mean =     296.582621846525
             stat err =       0.000442724073
             autocorr =       1.162768479551
              std dev =       0.580632725626
             le_variance =       0.337134362068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211783401410        initial  <--
     2.3283e+00     2.3283e+01             7.3722e-05       -17.211783325407
     9.3132e+00     9.3132e+01             1.8545e-05       -17.211783357348
     3.7253e+01     3.7253e+02             4.6425e-06       -17.211783395483

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.4156
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.203259e-01 1 1  ON 0
 uu_1                 5.400374e-02 1 1  ON 1
 uu_2                -4.585920e-02 1 1  ON 2
 uu_3                -1.034709e-01 1 1  ON 3
 uu_4                -1.370605e-01 1 1  ON 4
 uu_5                -1.441775e-01 1 1  ON 5
 uu_6                -1.223198e-01 1 1  ON 6
 uu_7                -5.307058e-02 1 1  ON 7
 uu_8                 8.637917e-02 1 1  ON 8
 uu_9                 1.338840e-01 1 1  ON 9
 ud_0                 3.693441e-01 1 1  ON 10
 ud_1                 1.028852e-01 1 1  ON 11
 ud_2                -1.503343e-02 1 1  ON 12
 ud_3                -7.925979e-02 1 1  ON 13
 ud_4                -1.271947e-01 1 1  ON 14
 ud_5                -1.580296e-01 1 1  ON 15
 ud_6                -1.594650e-01 1 1  ON 16
 ud_7                -1.151521e-01 1 1  ON 17
 ud_8                -1.849589e-02 1 1  ON 18
 ud_9                 9.183489e-02 1 1  ON 19
 eO_0                -8.196817e-01 1 1  ON 20
 eO_1                -4.848938e-01 1 1  ON 21
 eO_2                -5.357505e-02 1 1  ON 22
 eO_3                 2.181394e-01 1 1  ON 23
 eO_4                 3.210211e-01 1 1  ON 24
 eO_5                 3.401078e-01 1 1  ON 25
 eO_6                 2.740056e-01 1 1  ON 26
 eO_7                 1.390964e-01 1 1  ON 27
 eO_8                 3.231683e-02 1 1  ON 28
 eO_9                 2.039794e-02 1 1  ON 29
eH1_0                -1.867769e-01 1 1  ON 30
eH1_1                -1.073379e-01 1 1  ON 31
eH1_2                -6.432062e-02 1 1  ON 32
eH1_3                -2.621929e-02 1 1  ON 33
eH1_4                 1.891899e-02 1 1  ON 34
eH1_5                 3.053586e-02 1 1  ON 35
eH1_6                 7.403581e-02 1 1  ON 36
eH1_7                 1.083591e-01 1 1  ON 37
eH1_8                 1.057290e-01 1 1  ON 38
eH1_9                 2.975798e-02 1 1  ON 39
eH2_0                -1.873950e-01 1 1  ON 40
eH2_1                -1.079247e-01 1 1  ON 41
eH2_2                -6.493259e-02 1 1  ON 42
eH2_3                -2.711029e-02 1 1  ON 43
eH2_4                 1.753076e-02 1 1  ON 44
eH2_5                 2.902369e-02 1 1  ON 45
eH2_6                 7.392853e-02 1 1  ON 46
eH2_7                 1.110129e-01 1 1  ON 47
eH2_8                 1.098355e-01 1 1  ON 48
eH2_9                 3.127857e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2729
    reference variance = 0.287728
====================================================
  Execution time = 2.1162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4242e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342364804508
                                         uncertainty =       0.002713551070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342364804508
                                         uncertainty =       0.002713551070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413775816
  error estimate for blocks of size 2^( 2) =       0.000424335440
  error estimate for blocks of size 2^( 3) =       0.000434016009
  error estimate for blocks of size 2^( 4) =       0.000440910452
  error estimate for blocks of size 2^( 5) =       0.000446058992
  error estimate for blocks of size 2^( 6) =       0.000448218119
  error estimate for blocks of size 2^( 7) =       0.000451658213

      target function =                  N/A
              le_mean =     -17.212225190337
             les_mean =     296.603116683349
             stat err =       0.000446711444
             autocorr =       1.165531324133
              std dev =       0.585167370655
             le_variance =       0.342420851679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721222519034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212225190337       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212225183164       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212225173105       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212225169154       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212225171682       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212225167224       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212225175256       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.959635e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212225190337       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212225188534       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212225185978       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212225184904       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212225185451       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212225184354       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212225186398       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.993339e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212225190337       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212225189886       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212225189244       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212225188970       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212225189102       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212225188829       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212225189342       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.985452e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6433e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.203257e-01 1 1  ON 0
 uu_1                 5.400337e-02 1 1  ON 1
 uu_2                -4.585835e-02 1 1  ON 2
 uu_3                -1.034710e-01 1 1  ON 3
 uu_4                -1.370599e-01 1 1  ON 4
 uu_5                -1.441773e-01 1 1  ON 5
 uu_6                -1.223200e-01 1 1  ON 6
 uu_7                -5.307139e-02 1 1  ON 7
 uu_8                 8.637813e-02 1 1  ON 8
 uu_9                 1.338842e-01 1 1  ON 9
 ud_0                 3.693445e-01 1 1  ON 10
 ud_1                 1.028853e-01 1 1  ON 11
 ud_2                -1.503237e-02 1 1  ON 12
 ud_3                -7.925885e-02 1 1  ON 13
 ud_4                -1.271938e-01 1 1  ON 14
 ud_5                -1.580304e-01 1 1  ON 15
 ud_6                -1.594655e-01 1 1  ON 16
 ud_7                -1.151532e-01 1 1  ON 17
 ud_8                -1.849741e-02 1 1  ON 18
 ud_9                 9.183455e-02 1 1  ON 19
 eO_0                -8.196831e-01 1 1  ON 20
 eO_1                -4.848935e-01 1 1  ON 21
 eO_2                -5.357575e-02 1 1  ON 22
 eO_3                 2.181374e-01 1 1  ON 23
 eO_4                 3.210214e-01 1 1  ON 24
 eO_5                 3.401091e-01 1 1  ON 25
 eO_6                 2.740068e-01 1 1  ON 26
 eO_7                 1.390973e-01 1 1  ON 27
 eO_8                 3.231698e-02 1 1  ON 28
 eO_9                 2.039799e-02 1 1  ON 29
eH1_0                -1.867776e-01 1 1  ON 30
eH1_1                -1.073383e-01 1 1  ON 31
eH1_2                -6.431867e-02 1 1  ON 32
eH1_3                -2.621996e-02 1 1  ON 33
eH1_4                 1.891870e-02 1 1  ON 34
eH1_5                 3.053593e-02 1 1  ON 35
eH1_6                 7.403523e-02 1 1  ON 36
eH1_7                 1.083588e-01 1 1  ON 37
eH1_8                 1.057296e-01 1 1  ON 38
eH1_9                 2.975813e-02 1 1  ON 39
eH2_0                -1.873948e-01 1 1  ON 40
eH2_1                -1.079244e-01 1 1  ON 41
eH2_2                -6.493292e-02 1 1  ON 42
eH2_3                -2.711001e-02 1 1  ON 43
eH2_4                 1.753193e-02 1 1  ON 44
eH2_5                 2.902254e-02 1 1  ON 45
eH2_6                 7.392777e-02 1 1  ON 46
eH2_7                 1.110125e-01 1 1  ON 47
eH2_8                 1.098359e-01 1 1  ON 48
eH2_9                 3.127882e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.245583
====================================================
  Execution time = 1.8557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4190e-01
  Total weights = 2.0000e+06
  Execution time = 1.5784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341889756317
                                         uncertainty =       0.005659237355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341889756317
                                         uncertainty =       0.005659237355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413462903
  error estimate for blocks of size 2^( 2) =       0.000424259247
  error estimate for blocks of size 2^( 3) =       0.000433667533
  error estimate for blocks of size 2^( 4) =       0.000440869423
  error estimate for blocks of size 2^( 5) =       0.000444936178
  error estimate for blocks of size 2^( 6) =       0.000447885055
  error estimate for blocks of size 2^( 7) =       0.000449821887

      target function =                  N/A
              le_mean =     -17.211612014289
             les_mean =     296.581491103102
             stat err =       0.000445878136
             autocorr =       1.162945211427
              std dev =       0.584724844377
             le_variance =       0.341903143632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341886938953
                                         uncertainty =       0.005659154615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341886938953
                                         uncertainty =       0.005659154615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413461199
  error estimate for blocks of size 2^( 2) =       0.000424257616
  error estimate for blocks of size 2^( 3) =       0.000433666022
  error estimate for blocks of size 2^( 4) =       0.000440868020
  error estimate for blocks of size 2^( 5) =       0.000444934733
  error estimate for blocks of size 2^( 6) =       0.000447883740
  error estimate for blocks of size 2^( 7) =       0.000449820436

      target function =                  N/A
              le_mean =     -17.211612023542
             les_mean =     296.581488604195
             stat err =       0.000445876732
             autocorr =       1.162947474984
              std dev =       0.584722435174
             le_variance =       0.341900326195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341888329276
                                         uncertainty =       0.005659196162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341888329276
                                         uncertainty =       0.005659196162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413462040
  error estimate for blocks of size 2^( 2) =       0.000424258421
  error estimate for blocks of size 2^( 3) =       0.000433666768
  error estimate for blocks of size 2^( 4) =       0.000440868713
  error estimate for blocks of size 2^( 5) =       0.000444935446
  error estimate for blocks of size 2^( 6) =       0.000447884388
  error estimate for blocks of size 2^( 7) =       0.000449821152

      target function =                  N/A
              le_mean =     -17.211612018811
             les_mean =     296.581489831663
             stat err =       0.000445877425
             autocorr =       1.162946357705
              std dev =       0.584723624072
             le_variance =       0.341901716548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341889577318
                                         uncertainty =       0.005659232211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341889577318
                                         uncertainty =       0.005659232211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413462794
  error estimate for blocks of size 2^( 2) =       0.000424259144
  error estimate for blocks of size 2^( 3) =       0.000433667437
  error estimate for blocks of size 2^( 4) =       0.000440869334
  error estimate for blocks of size 2^( 5) =       0.000444936086
  error estimate for blocks of size 2^( 6) =       0.000447884971
  error estimate for blocks of size 2^( 7) =       0.000449821794

      target function =                  N/A
              le_mean =     -17.211612014846
             les_mean =     296.581490943259
             stat err =       0.000445878046
             autocorr =       1.162945355157
              std dev =       0.584724691310
             le_variance =       0.341902964628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211612014289        initial
     2.3283e+01     2.3283e+02             7.9596e-06       -17.211612023542  <--
     9.3132e+01     9.3132e+02             1.9933e-06       -17.211612018811
     3.7253e+02     3.7253e+03             4.9855e-07       -17.211612014846

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.6558e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.203252e-01 1 1  ON 0
 uu_1                 5.400229e-02 1 1  ON 1
 uu_2                -4.585585e-02 1 1  ON 2
 uu_3                -1.034712e-01 1 1  ON 3
 uu_4                -1.370580e-01 1 1  ON 4
 uu_5                -1.441765e-01 1 1  ON 5
 uu_6                -1.223207e-01 1 1  ON 6
 uu_7                -5.307382e-02 1 1  ON 7
 uu_8                 8.637502e-02 1 1  ON 8
 uu_9                 1.338850e-01 1 1  ON 9
 ud_0                 3.693459e-01 1 1  ON 10
 ud_1                 1.028855e-01 1 1  ON 11
 ud_2                -1.502925e-02 1 1  ON 12
 ud_3                -7.925603e-02 1 1  ON 13
 ud_4                -1.271909e-01 1 1  ON 14
 ud_5                -1.580327e-01 1 1  ON 15
 ud_6                -1.594668e-01 1 1  ON 16
 ud_7                -1.151562e-01 1 1  ON 17
 ud_8                -1.850196e-02 1 1  ON 18
 ud_9                 9.183352e-02 1 1  ON 19
 eO_0                -8.196876e-01 1 1  ON 20
 eO_1                -4.848929e-01 1 1  ON 21
 eO_2                -5.357782e-02 1 1  ON 22
 eO_3                 2.181314e-01 1 1  ON 23
 eO_4                 3.210221e-01 1 1  ON 24
 eO_5                 3.401130e-01 1 1  ON 25
 eO_6                 2.740103e-01 1 1  ON 26
 eO_7                 1.391001e-01 1 1  ON 27
 eO_8                 3.231744e-02 1 1  ON 28
 eO_9                 2.039815e-02 1 1  ON 29
eH1_0                -1.867795e-01 1 1  ON 30
eH1_1                -1.073393e-01 1 1  ON 31
eH1_2                -6.431288e-02 1 1  ON 32
eH1_3                -2.622192e-02 1 1  ON 33
eH1_4                 1.891785e-02 1 1  ON 34
eH1_5                 3.053614e-02 1 1  ON 35
eH1_6                 7.403350e-02 1 1  ON 36
eH1_7                 1.083578e-01 1 1  ON 37
eH1_8                 1.057313e-01 1 1  ON 38
eH1_9                 2.975857e-02 1 1  ON 39
eH2_0                -1.873942e-01 1 1  ON 40
eH2_1                -1.079236e-01 1 1  ON 41
eH2_2                -6.493389e-02 1 1  ON 42
eH2_3                -2.710918e-02 1 1  ON 43
eH2_4                 1.753541e-02 1 1  ON 44
eH2_5                 2.901911e-02 1 1  ON 45
eH2_6                 7.392550e-02 1 1  ON 46
eH2_7                 1.110111e-01 1 1  ON 47
eH2_8                 1.098372e-01 1 1  ON 48
eH2_9                 3.127956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2997e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1706
    reference variance = 0.218111
====================================================
  Execution time = 1.8982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4619e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346214986850
                                         uncertainty =       0.004591021707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346214986850
                                         uncertainty =       0.004591021707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416049359
  error estimate for blocks of size 2^( 2) =       0.000426350494
  error estimate for blocks of size 2^( 3) =       0.000436455396
  error estimate for blocks of size 2^( 4) =       0.000443931880
  error estimate for blocks of size 2^( 5) =       0.000447881461
  error estimate for blocks of size 2^( 6) =       0.000451277353
  error estimate for blocks of size 2^( 7) =       0.000451509669

      target function =                  N/A
              le_mean =     -17.211060040834
             les_mean =     296.566781693910
             stat err =       0.000448650091
             autocorr =       1.162855647311
              std dev =       0.588382645741
             le_variance =       0.346194137809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721106004083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211060040834       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211059977575       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211059892242       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211059781848       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211059833787       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211059820107       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211059840384       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 3.753438e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211060040834       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211060024586       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211060002350       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211059972801       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211059985607       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211059982646       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211059987525       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 9.762703e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211060040834       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211060036744       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211060031125       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211060023604       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211060026788       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211060026081       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211060027289       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.465894e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4205e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.203308e-01 1 1  ON 0
 uu_1                 5.400026e-02 1 1  ON 1
 uu_2                -4.585889e-02 1 1  ON 2
 uu_3                -1.034720e-01 1 1  ON 3
 uu_4                -1.370644e-01 1 1  ON 4
 uu_5                -1.441725e-01 1 1  ON 5
 uu_6                -1.223213e-01 1 1  ON 6
 uu_7                -5.307372e-02 1 1  ON 7
 uu_8                 8.637290e-02 1 1  ON 8
 uu_9                 1.338871e-01 1 1  ON 9
 ud_0                 3.693521e-01 1 1  ON 10
 ud_1                 1.028898e-01 1 1  ON 11
 ud_2                -1.503174e-02 1 1  ON 12
 ud_3                -7.925366e-02 1 1  ON 13
 ud_4                -1.271922e-01 1 1  ON 14
 ud_5                -1.580357e-01 1 1  ON 15
 ud_6                -1.594696e-01 1 1  ON 16
 ud_7                -1.151584e-01 1 1  ON 17
 ud_8                -1.850461e-02 1 1  ON 18
 ud_9                 9.183266e-02 1 1  ON 19
 eO_0                -8.196861e-01 1 1  ON 20
 eO_1                -4.849026e-01 1 1  ON 21
 eO_2                -5.357818e-02 1 1  ON 22
 eO_3                 2.181269e-01 1 1  ON 23
 eO_4                 3.210216e-01 1 1  ON 24
 eO_5                 3.401159e-01 1 1  ON 25
 eO_6                 2.740148e-01 1 1  ON 26
 eO_7                 1.391051e-01 1 1  ON 27
 eO_8                 3.231817e-02 1 1  ON 28
 eO_9                 2.039833e-02 1 1  ON 29
eH1_0                -1.867776e-01 1 1  ON 30
eH1_1                -1.073377e-01 1 1  ON 31
eH1_2                -6.431400e-02 1 1  ON 32
eH1_3                -2.622498e-02 1 1  ON 33
eH1_4                 1.891403e-02 1 1  ON 34
eH1_5                 3.053555e-02 1 1  ON 35
eH1_6                 7.403477e-02 1 1  ON 36
eH1_7                 1.083580e-01 1 1  ON 37
eH1_8                 1.057338e-01 1 1  ON 38
eH1_9                 2.975946e-02 1 1  ON 39
eH2_0                -1.873894e-01 1 1  ON 40
eH2_1                -1.079271e-01 1 1  ON 41
eH2_2                -6.493464e-02 1 1  ON 42
eH2_3                -2.711199e-02 1 1  ON 43
eH2_4                 1.753634e-02 1 1  ON 44
eH2_5                 2.902003e-02 1 1  ON 45
eH2_6                 7.392355e-02 1 1  ON 46
eH2_7                 1.110094e-01 1 1  ON 47
eH2_8                 1.098396e-01 1 1  ON 48
eH2_9                 3.128052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2497
    reference variance = 0.210268
====================================================
  Execution time = 1.8654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4377e-01
  Total weights = 2.0000e+06
  Execution time = 1.5794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343848025600
                                         uncertainty =       0.007318069688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343848025600
                                         uncertainty =       0.007318069688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414587623
  error estimate for blocks of size 2^( 2) =       0.000425446074
  error estimate for blocks of size 2^( 3) =       0.000434957580
  error estimate for blocks of size 2^( 4) =       0.000441683913
  error estimate for blocks of size 2^( 5) =       0.000446007075
  error estimate for blocks of size 2^( 6) =       0.000446246311
  error estimate for blocks of size 2^( 7) =       0.000447908212

      target function =                  N/A
              le_mean =     -17.212100006615
             les_mean =     296.600152259324
             stat err =       0.000445461378
             autocorr =       1.154482748243
              std dev =       0.586315438545
             le_variance =       0.343765793476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343876272450
                                         uncertainty =       0.007317081719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343876272450
                                         uncertainty =       0.007317081719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414604647
  error estimate for blocks of size 2^( 2) =       0.000425462312
  error estimate for blocks of size 2^( 3) =       0.000434973132
  error estimate for blocks of size 2^( 4) =       0.000441698729
  error estimate for blocks of size 2^( 5) =       0.000446021577
  error estimate for blocks of size 2^( 6) =       0.000446260376
  error estimate for blocks of size 2^( 7) =       0.000447921093

      target function =                  N/A
              le_mean =     -17.212099950572
             les_mean =     296.600178563301
             stat err =       0.000445475444
             autocorr =       1.154460842998
              std dev =       0.586339514885
             le_variance =       0.343794026715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343862758640
                                         uncertainty =       0.007317542071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343862758640
                                         uncertainty =       0.007317542071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414596502
  error estimate for blocks of size 2^( 2) =       0.000425454539
  error estimate for blocks of size 2^( 3) =       0.000434965690
  error estimate for blocks of size 2^( 4) =       0.000441691640
  error estimate for blocks of size 2^( 5) =       0.000446014636
  error estimate for blocks of size 2^( 6) =       0.000446253643
  error estimate for blocks of size 2^( 7) =       0.000447914917

      target function =                  N/A
              le_mean =     -17.212099975412
             les_mean =     296.600165911048
             stat err =       0.000445468709
             autocorr =       1.154471293803
              std dev =       0.586327996402
             le_variance =       0.343780519364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343849886451
                                         uncertainty =       0.007318002591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343849886451
                                         uncertainty =       0.007318002591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414588744
  error estimate for blocks of size 2^( 2) =       0.000425447143
  error estimate for blocks of size 2^( 3) =       0.000434958604
  error estimate for blocks of size 2^( 4) =       0.000441684889
  error estimate for blocks of size 2^( 5) =       0.000446008029
  error estimate for blocks of size 2^( 6) =       0.000446247236
  error estimate for blocks of size 2^( 7) =       0.000447909058

      target function =                  N/A
              le_mean =     -17.212100002470
             les_mean =     296.600153976581
             stat err =       0.000445462303
             autocorr =       1.154481299448
              std dev =       0.586317024673
             le_variance =       0.343767653422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212100006615        initial  <--
     5.8208e+00     5.8208e+01             3.7534e-05       -17.212099950572
     2.3283e+01     2.3283e+02             9.7627e-06       -17.212099975412
     9.3132e+01     9.3132e+02             2.4659e-06       -17.212100002470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.6577
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.203252e-01 1 1  ON 0
 uu_1                 5.400229e-02 1 1  ON 1
 uu_2                -4.585585e-02 1 1  ON 2
 uu_3                -1.034712e-01 1 1  ON 3
 uu_4                -1.370580e-01 1 1  ON 4
 uu_5                -1.441765e-01 1 1  ON 5
 uu_6                -1.223207e-01 1 1  ON 6
 uu_7                -5.307382e-02 1 1  ON 7
 uu_8                 8.637502e-02 1 1  ON 8
 uu_9                 1.338850e-01 1 1  ON 9
 ud_0                 3.693459e-01 1 1  ON 10
 ud_1                 1.028855e-01 1 1  ON 11
 ud_2                -1.502925e-02 1 1  ON 12
 ud_3                -7.925603e-02 1 1  ON 13
 ud_4                -1.271909e-01 1 1  ON 14
 ud_5                -1.580327e-01 1 1  ON 15
 ud_6                -1.594668e-01 1 1  ON 16
 ud_7                -1.151562e-01 1 1  ON 17
 ud_8                -1.850196e-02 1 1  ON 18
 ud_9                 9.183352e-02 1 1  ON 19
 eO_0                -8.196876e-01 1 1  ON 20
 eO_1                -4.848929e-01 1 1  ON 21
 eO_2                -5.357782e-02 1 1  ON 22
 eO_3                 2.181314e-01 1 1  ON 23
 eO_4                 3.210221e-01 1 1  ON 24
 eO_5                 3.401130e-01 1 1  ON 25
 eO_6                 2.740103e-01 1 1  ON 26
 eO_7                 1.391001e-01 1 1  ON 27
 eO_8                 3.231744e-02 1 1  ON 28
 eO_9                 2.039815e-02 1 1  ON 29
eH1_0                -1.867795e-01 1 1  ON 30
eH1_1                -1.073393e-01 1 1  ON 31
eH1_2                -6.431288e-02 1 1  ON 32
eH1_3                -2.622192e-02 1 1  ON 33
eH1_4                 1.891785e-02 1 1  ON 34
eH1_5                 3.053614e-02 1 1  ON 35
eH1_6                 7.403350e-02 1 1  ON 36
eH1_7                 1.083578e-01 1 1  ON 37
eH1_8                 1.057313e-01 1 1  ON 38
eH1_9                 2.975857e-02 1 1  ON 39
eH2_0                -1.873942e-01 1 1  ON 40
eH2_1                -1.079236e-01 1 1  ON 41
eH2_2                -6.493389e-02 1 1  ON 42
eH2_3                -2.710918e-02 1 1  ON 43
eH2_4                 1.753541e-02 1 1  ON 44
eH2_5                 2.901911e-02 1 1  ON 45
eH2_6                 7.392550e-02 1 1  ON 46
eH2_7                 1.110111e-01 1 1  ON 47
eH2_8                 1.098372e-01 1 1  ON 48
eH2_9                 3.127956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2095
    reference variance = 0.247812
====================================================
  Execution time = 1.8886e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4122e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341309362246
                                         uncertainty =       0.003330241737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341309362246
                                         uncertainty =       0.003330241737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413049936
  error estimate for blocks of size 2^( 2) =       0.000423913012
  error estimate for blocks of size 2^( 3) =       0.000433526943
  error estimate for blocks of size 2^( 4) =       0.000440751068
  error estimate for blocks of size 2^( 5) =       0.000445184340
  error estimate for blocks of size 2^( 6) =       0.000447183568
  error estimate for blocks of size 2^( 7) =       0.000447952867

      target function =                  N/A
              le_mean =     -17.211320137659
             les_mean =     296.570761209594
             stat err =       0.000445267961
             autocorr =       1.162084677222
              std dev =       0.584140821380
             le_variance =       0.341220499203


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721132013766e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211320137659       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211320139677       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211320144067       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211320140335       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211320145824       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211320143599       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211320143595       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.530839e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211320137659       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211320138165       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211320139273       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211320138338       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211320139709       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211320139148       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211320139147       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 8.840587e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211320137659       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211320137786       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211320138064       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211320137830       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211320138172       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211320138032       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211320138031       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.210993e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4215e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.203251e-01 1 1  ON 0
 uu_1                 5.400236e-02 1 1  ON 1
 uu_2                -4.585575e-02 1 1  ON 2
 uu_3                -1.034711e-01 1 1  ON 3
 uu_4                -1.370581e-01 1 1  ON 4
 uu_5                -1.441765e-01 1 1  ON 5
 uu_6                -1.223209e-01 1 1  ON 6
 uu_7                -5.307404e-02 1 1  ON 7
 uu_8                 8.637488e-02 1 1  ON 8
 uu_9                 1.338852e-01 1 1  ON 9
 ud_0                 3.693465e-01 1 1  ON 10
 ud_1                 1.028859e-01 1 1  ON 11
 ud_2                -1.502949e-02 1 1  ON 12
 ud_3                -7.925588e-02 1 1  ON 13
 ud_4                -1.271908e-01 1 1  ON 14
 ud_5                -1.580328e-01 1 1  ON 15
 ud_6                -1.594673e-01 1 1  ON 16
 ud_7                -1.151565e-01 1 1  ON 17
 ud_8                -1.850214e-02 1 1  ON 18
 ud_9                 9.183348e-02 1 1  ON 19
 eO_0                -8.196876e-01 1 1  ON 20
 eO_1                -4.848933e-01 1 1  ON 21
 eO_2                -5.357780e-02 1 1  ON 22
 eO_3                 2.181305e-01 1 1  ON 23
 eO_4                 3.210221e-01 1 1  ON 24
 eO_5                 3.401132e-01 1 1  ON 25
 eO_6                 2.740107e-01 1 1  ON 26
 eO_7                 1.391006e-01 1 1  ON 27
 eO_8                 3.231754e-02 1 1  ON 28
 eO_9                 2.039818e-02 1 1  ON 29
eH1_0                -1.867793e-01 1 1  ON 30
eH1_1                -1.073396e-01 1 1  ON 31
eH1_2                -6.431303e-02 1 1  ON 32
eH1_3                -2.622215e-02 1 1  ON 33
eH1_4                 1.891779e-02 1 1  ON 34
eH1_5                 3.053647e-02 1 1  ON 35
eH1_6                 7.403343e-02 1 1  ON 36
eH1_7                 1.083576e-01 1 1  ON 37
eH1_8                 1.057316e-01 1 1  ON 38
eH1_9                 2.975868e-02 1 1  ON 39
eH2_0                -1.873941e-01 1 1  ON 40
eH2_1                -1.079240e-01 1 1  ON 41
eH2_2                -6.493397e-02 1 1  ON 42
eH2_3                -2.710939e-02 1 1  ON 43
eH2_4                 1.753565e-02 1 1  ON 44
eH2_5                 2.901906e-02 1 1  ON 45
eH2_6                 7.392531e-02 1 1  ON 46
eH2_7                 1.110111e-01 1 1  ON 47
eH2_8                 1.098376e-01 1 1  ON 48
eH2_9                 3.127968e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.251
    reference variance = 0.218603
====================================================
  Execution time = 1.8617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3785e-01
  Total weights = 2.0000e+06
  Execution time = 1.5678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337939548253
                                         uncertainty =       0.002687790399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337939548253
                                         uncertainty =       0.002687790399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411002000
  error estimate for blocks of size 2^( 2) =       0.000421642629
  error estimate for blocks of size 2^( 3) =       0.000431420028
  error estimate for blocks of size 2^( 4) =       0.000438622106
  error estimate for blocks of size 2^( 5) =       0.000443334207
  error estimate for blocks of size 2^( 6) =       0.000445511544
  error estimate for blocks of size 2^( 7) =       0.000444557817

      target function =                  N/A
              le_mean =     -17.211370679808
             les_mean =     296.569125797284
             stat err =       0.000443006418
             autocorr =       1.161802123644
              std dev =       0.581244602943
             le_variance =       0.337845288450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941331029
                                         uncertainty =       0.002687800575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337941331029
                                         uncertainty =       0.002687800575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411003084
  error estimate for blocks of size 2^( 2) =       0.000421643620
  error estimate for blocks of size 2^( 3) =       0.000431420935
  error estimate for blocks of size 2^( 4) =       0.000438622962
  error estimate for blocks of size 2^( 5) =       0.000443335062
  error estimate for blocks of size 2^( 6) =       0.000445512407
  error estimate for blocks of size 2^( 7) =       0.000444558701

      target function =                  N/A
              le_mean =     -17.211370686705
             les_mean =     296.569127816727
             stat err =       0.000443007283
             autocorr =       1.161800528152
              std dev =       0.581246135898
             le_variance =       0.337847070496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337940442994
                                         uncertainty =       0.002687795517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337940442994
                                         uncertainty =       0.002687795517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411002544
  error estimate for blocks of size 2^( 2) =       0.000421643126
  error estimate for blocks of size 2^( 3) =       0.000431420483
  error estimate for blocks of size 2^( 4) =       0.000438622535
  error estimate for blocks of size 2^( 5) =       0.000443334636
  error estimate for blocks of size 2^( 6) =       0.000445511977
  error estimate for blocks of size 2^( 7) =       0.000444558261

      target function =                  N/A
              le_mean =     -17.211370683273
             les_mean =     296.569126810937
             stat err =       0.000443006852
             autocorr =       1.161801322769
              std dev =       0.581245372303
             le_variance =       0.337846182824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337939660196
                                         uncertainty =       0.002687791040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337939660196
                                         uncertainty =       0.002687791040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411002068
  error estimate for blocks of size 2^( 2) =       0.000421642691
  error estimate for blocks of size 2^( 3) =       0.000431420085
  error estimate for blocks of size 2^( 4) =       0.000438622160
  error estimate for blocks of size 2^( 5) =       0.000443334261
  error estimate for blocks of size 2^( 6) =       0.000445511598
  error estimate for blocks of size 2^( 7) =       0.000444557872

      target function =                  N/A
              le_mean =     -17.211370680241
             les_mean =     296.569125924091
             stat err =       0.000443006473
             autocorr =       1.161802023437
              std dev =       0.581244699200
             le_variance =       0.337845400348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211370679808        initial
     5.8208e+01     5.8208e+02             3.5308e-06       -17.211370686705  <--
     2.3283e+02     2.3283e+03             8.8406e-07       -17.211370683273
     9.3132e+02     9.3132e+03             2.2110e-07       -17.211370680241

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.6566e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.203247e-01 1 1  ON 0
 uu_1                 5.400258e-02 1 1  ON 1
 uu_2                -4.585543e-02 1 1  ON 2
 uu_3                -1.034709e-01 1 1  ON 3
 uu_4                -1.370581e-01 1 1  ON 4
 uu_5                -1.441765e-01 1 1  ON 5
 uu_6                -1.223217e-01 1 1  ON 6
 uu_7                -5.307470e-02 1 1  ON 7
 uu_8                 8.637446e-02 1 1  ON 8
 uu_9                 1.338859e-01 1 1  ON 9
 ud_0                 3.693481e-01 1 1  ON 10
 ud_1                 1.028870e-01 1 1  ON 11
 ud_2                -1.503018e-02 1 1  ON 12
 ud_3                -7.925544e-02 1 1  ON 13
 ud_4                -1.271905e-01 1 1  ON 14
 ud_5                -1.580331e-01 1 1  ON 15
 ud_6                -1.594688e-01 1 1  ON 16
 ud_7                -1.151574e-01 1 1  ON 17
 ud_8                -1.850270e-02 1 1  ON 18
 ud_9                 9.183336e-02 1 1  ON 19
 eO_0                -8.196875e-01 1 1  ON 20
 eO_1                -4.848948e-01 1 1  ON 21
 eO_2                -5.357776e-02 1 1  ON 22
 eO_3                 2.181279e-01 1 1  ON 23
 eO_4                 3.210220e-01 1 1  ON 24
 eO_5                 3.401140e-01 1 1  ON 25
 eO_6                 2.740119e-01 1 1  ON 26
 eO_7                 1.391023e-01 1 1  ON 27
 eO_8                 3.231784e-02 1 1  ON 28
 eO_9                 2.039825e-02 1 1  ON 29
eH1_0                -1.867786e-01 1 1  ON 30
eH1_1                -1.073404e-01 1 1  ON 31
eH1_2                -6.431346e-02 1 1  ON 32
eH1_3                -2.622285e-02 1 1  ON 33
eH1_4                 1.891761e-02 1 1  ON 34
eH1_5                 3.053747e-02 1 1  ON 35
eH1_6                 7.403322e-02 1 1  ON 36
eH1_7                 1.083570e-01 1 1  ON 37
eH1_8                 1.057324e-01 1 1  ON 38
eH1_9                 2.975900e-02 1 1  ON 39
eH2_0                -1.873936e-01 1 1  ON 40
eH2_1                -1.079252e-01 1 1  ON 41
eH2_2                -6.493422e-02 1 1  ON 42
eH2_3                -2.711000e-02 1 1  ON 43
eH2_4                 1.753635e-02 1 1  ON 44
eH2_5                 2.901890e-02 1 1  ON 45
eH2_6                 7.392475e-02 1 1  ON 46
eH2_7                 1.110112e-01 1 1  ON 47
eH2_8                 1.098386e-01 1 1  ON 48
eH2_9                 3.128002e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0788e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1628
    reference variance = 0.186793
====================================================
  Execution time = 1.8781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709413150
                                         uncertainty =       0.002852828335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709413150
                                         uncertainty =       0.002852828335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412133662
  error estimate for blocks of size 2^( 2) =       0.000422325343
  error estimate for blocks of size 2^( 3) =       0.000431738543
  error estimate for blocks of size 2^( 4) =       0.000439069163
  error estimate for blocks of size 2^( 5) =       0.000442984903
  error estimate for blocks of size 2^( 6) =       0.000445631545
  error estimate for blocks of size 2^( 7) =       0.000447106807

      target function =                  N/A
              le_mean =     -17.212439445562
             les_mean =     296.607779808156
             stat err =       0.000443698104
             autocorr =       1.159041457615
              std dev =       0.582845014449
             le_variance =       0.339708310868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721243944556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212439445562       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212439438771       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212439445076       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212439482980       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212439502071       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212439504032       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212439501528       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.055516e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212439445562       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212439443851       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212439445458       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212439455047       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212439460039       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212439460429       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212439459824       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.655098e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212439445562       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212439445134       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212439445537       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212439447942       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212439449204       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212439449295       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212439449145       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 6.647939e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4119e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.203224e-01 1 1  ON 0
 uu_1                 5.400290e-02 1 1  ON 1
 uu_2                -4.585462e-02 1 1  ON 2
 uu_3                -1.034710e-01 1 1  ON 3
 uu_4                -1.370575e-01 1 1  ON 4
 uu_5                -1.441756e-01 1 1  ON 5
 uu_6                -1.223211e-01 1 1  ON 6
 uu_7                -5.307615e-02 1 1  ON 7
 uu_8                 8.637334e-02 1 1  ON 8
 uu_9                 1.338865e-01 1 1  ON 9
 ud_0                 3.693482e-01 1 1  ON 10
 ud_1                 1.028878e-01 1 1  ON 11
 ud_2                -1.502999e-02 1 1  ON 12
 ud_3                -7.925461e-02 1 1  ON 13
 ud_4                -1.271904e-01 1 1  ON 14
 ud_5                -1.580338e-01 1 1  ON 15
 ud_6                -1.594695e-01 1 1  ON 16
 ud_7                -1.151576e-01 1 1  ON 17
 ud_8                -1.850363e-02 1 1  ON 18
 ud_9                 9.183324e-02 1 1  ON 19
 eO_0                -8.196895e-01 1 1  ON 20
 eO_1                -4.848964e-01 1 1  ON 21
 eO_2                -5.357749e-02 1 1  ON 22
 eO_3                 2.181252e-01 1 1  ON 23
 eO_4                 3.210225e-01 1 1  ON 24
 eO_5                 3.401149e-01 1 1  ON 25
 eO_6                 2.740138e-01 1 1  ON 26
 eO_7                 1.391044e-01 1 1  ON 27
 eO_8                 3.231812e-02 1 1  ON 28
 eO_9                 2.039835e-02 1 1  ON 29
eH1_0                -1.867795e-01 1 1  ON 30
eH1_1                -1.073387e-01 1 1  ON 31
eH1_2                -6.431331e-02 1 1  ON 32
eH1_3                -2.622265e-02 1 1  ON 33
eH1_4                 1.891645e-02 1 1  ON 34
eH1_5                 3.053608e-02 1 1  ON 35
eH1_6                 7.403313e-02 1 1  ON 36
eH1_7                 1.083570e-01 1 1  ON 37
eH1_8                 1.057335e-01 1 1  ON 38
eH1_9                 2.975922e-02 1 1  ON 39
eH2_0                -1.873924e-01 1 1  ON 40
eH2_1                -1.079262e-01 1 1  ON 41
eH2_2                -6.493291e-02 1 1  ON 42
eH2_3                -2.710870e-02 1 1  ON 43
eH2_4                 1.753406e-02 1 1  ON 44
eH2_5                 2.901912e-02 1 1  ON 45
eH2_6                 7.392374e-02 1 1  ON 46
eH2_7                 1.110102e-01 1 1  ON 47
eH2_8                 1.098395e-01 1 1  ON 48
eH2_9                 3.128031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2645
    reference variance = 0.31731
====================================================
  Execution time = 1.8399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3858e-01
  Total weights = 2.0000e+06
  Execution time = 1.5853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338468733882
                                         uncertainty =       0.003156370350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338468733882
                                         uncertainty =       0.003156370350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411451331
  error estimate for blocks of size 2^( 2) =       0.000422290185
  error estimate for blocks of size 2^( 3) =       0.000431889686
  error estimate for blocks of size 2^( 4) =       0.000438823831
  error estimate for blocks of size 2^( 5) =       0.000443617145
  error estimate for blocks of size 2^( 6) =       0.000445024531
  error estimate for blocks of size 2^( 7) =       0.000445422568

      target function =                  N/A
              le_mean =     -17.212397708454
             les_mean =     296.605219100243
             stat err =       0.000443222019
             autocorr =       1.160394634874
              std dev =       0.581880052537
             le_variance =       0.338584395540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338464790928
                                         uncertainty =       0.003156322462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338464790928
                                         uncertainty =       0.003156322462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411448939
  error estimate for blocks of size 2^( 2) =       0.000422287765
  error estimate for blocks of size 2^( 3) =       0.000431887299
  error estimate for blocks of size 2^( 4) =       0.000438821452
  error estimate for blocks of size 2^( 5) =       0.000443614694
  error estimate for blocks of size 2^( 6) =       0.000445022021
  error estimate for blocks of size 2^( 7) =       0.000445419839

      target function =                  N/A
              le_mean =     -17.212397807433
             les_mean =     296.605218571217
             stat err =       0.000443219502
             autocorr =       1.160394944303
              std dev =       0.581876670068
             le_variance =       0.338580459170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338466713231
                                         uncertainty =       0.003156345774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338466713231
                                         uncertainty =       0.003156345774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411450105
  error estimate for blocks of size 2^( 2) =       0.000422288945
  error estimate for blocks of size 2^( 3) =       0.000431888463
  error estimate for blocks of size 2^( 4) =       0.000438822612
  error estimate for blocks of size 2^( 5) =       0.000443615888
  error estimate for blocks of size 2^( 6) =       0.000445023245
  error estimate for blocks of size 2^( 7) =       0.000445421169

      target function =                  N/A
              le_mean =     -17.212397758807
             les_mean =     296.605218816378
             stat err =       0.000443220729
             autocorr =       1.160394792253
              std dev =       0.581878319136
             le_variance =       0.338582378281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338468479664
                                         uncertainty =       0.003156367258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338468479664
                                         uncertainty =       0.003156367258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411451177
  error estimate for blocks of size 2^( 2) =       0.000422290029
  error estimate for blocks of size 2^( 3) =       0.000431889532
  error estimate for blocks of size 2^( 4) =       0.000438823678
  error estimate for blocks of size 2^( 5) =       0.000443616987
  error estimate for blocks of size 2^( 6) =       0.000445024369
  error estimate for blocks of size 2^( 7) =       0.000445422392

      target function =                  N/A
              le_mean =     -17.212397714768
             les_mean =     296.605219063804
             stat err =       0.000443221857
             autocorr =       1.160394654587
              std dev =       0.581879834458
             le_variance =       0.338584141749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212397708454        initial
     1.4552e+01     1.4552e+02             1.0555e-05       -17.212397807433  <--
     5.8208e+01     5.8208e+02             2.6551e-06       -17.212397758807
     2.3283e+02     2.3283e+03             6.6479e-07       -17.212397714768

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 2.6399e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.203157e-01 1 1  ON 0
 uu_1                 5.400390e-02 1 1  ON 1
 uu_2                -4.585231e-02 1 1  ON 2
 uu_3                -1.034710e-01 1 1  ON 3
 uu_4                -1.370556e-01 1 1  ON 4
 uu_5                -1.441728e-01 1 1  ON 5
 uu_6                -1.223192e-01 1 1  ON 6
 uu_7                -5.308049e-02 1 1  ON 7
 uu_8                 8.636998e-02 1 1  ON 8
 uu_9                 1.338881e-01 1 1  ON 9
 ud_0                 3.693484e-01 1 1  ON 10
 ud_1                 1.028899e-01 1 1  ON 11
 ud_2                -1.502939e-02 1 1  ON 12
 ud_3                -7.925218e-02 1 1  ON 13
 ud_4                -1.271902e-01 1 1  ON 14
 ud_5                -1.580359e-01 1 1  ON 15
 ud_6                -1.594715e-01 1 1  ON 16
 ud_7                -1.151583e-01 1 1  ON 17
 ud_8                -1.850641e-02 1 1  ON 18
 ud_9                 9.183289e-02 1 1  ON 19
 eO_0                -8.196951e-01 1 1  ON 20
 eO_1                -4.849012e-01 1 1  ON 21
 eO_2                -5.357667e-02 1 1  ON 22
 eO_3                 2.181173e-01 1 1  ON 23
 eO_4                 3.210241e-01 1 1  ON 24
 eO_5                 3.401175e-01 1 1  ON 25
 eO_6                 2.740194e-01 1 1  ON 26
 eO_7                 1.391108e-01 1 1  ON 27
 eO_8                 3.231897e-02 1 1  ON 28
 eO_9                 2.039865e-02 1 1  ON 29
eH1_0                -1.867821e-01 1 1  ON 30
eH1_1                -1.073336e-01 1 1  ON 31
eH1_2                -6.431279e-02 1 1  ON 32
eH1_3                -2.622204e-02 1 1  ON 33
eH1_4                 1.891297e-02 1 1  ON 34
eH1_5                 3.053191e-02 1 1  ON 35
eH1_6                 7.403284e-02 1 1  ON 36
eH1_7                 1.083571e-01 1 1  ON 37
eH1_8                 1.057369e-01 1 1  ON 38
eH1_9                 2.975987e-02 1 1  ON 39
eH2_0                -1.873889e-01 1 1  ON 40
eH2_1                -1.079290e-01 1 1  ON 41
eH2_2                -6.492903e-02 1 1  ON 42
eH2_3                -2.710484e-02 1 1  ON 43
eH2_4                 1.752728e-02 1 1  ON 44
eH2_5                 2.901974e-02 1 1  ON 45
eH2_6                 7.392069e-02 1 1  ON 46
eH2_7                 1.110073e-01 1 1  ON 47
eH2_8                 1.098420e-01 1 1  ON 48
eH2_9                 3.128116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0523e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2369
    reference variance = 0.305516
====================================================
  Execution time = 1.8952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4208e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342140614934
                                         uncertainty =       0.002882018380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342140614934
                                         uncertainty =       0.002882018380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413567683
  error estimate for blocks of size 2^( 2) =       0.000424452556
  error estimate for blocks of size 2^( 3) =       0.000433441063
  error estimate for blocks of size 2^( 4) =       0.000440396054
  error estimate for blocks of size 2^( 5) =       0.000444789992
  error estimate for blocks of size 2^( 6) =       0.000446456493
  error estimate for blocks of size 2^( 7) =       0.000449310971

      target function =                  N/A
              le_mean =     -17.212216476655
             les_mean =     296.602472324777
             stat err =       0.000445238378
             autocorr =       1.159022838808
              std dev =       0.584873026030
             le_variance =       0.342076456577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721221647666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212216476655       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212216546661       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212216598098       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212216576579       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212216621624       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212216598958       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212216608153       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 3.500912e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212216476655       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212216494940       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212216508522       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212216502218       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212216511514       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212216507324       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212216509264       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 9.035853e-06

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212216476655       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212216481278       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212216484722       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212216483083       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212216485266       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212216484315       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212216484771       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.278654e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4248e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.203098e-01 1 1  ON 0
 uu_1                 5.400861e-02 1 1  ON 1
 uu_2                -4.585033e-02 1 1  ON 2
 uu_3                -1.034670e-01 1 1  ON 3
 uu_4                -1.370554e-01 1 1  ON 4
 uu_5                -1.441776e-01 1 1  ON 5
 uu_6                -1.223228e-01 1 1  ON 6
 uu_7                -5.308326e-02 1 1  ON 7
 uu_8                 8.636706e-02 1 1  ON 8
 uu_9                 1.338922e-01 1 1  ON 9
 ud_0                 3.693517e-01 1 1  ON 10
 ud_1                 1.028848e-01 1 1  ON 11
 ud_2                -1.502672e-02 1 1  ON 12
 ud_3                -7.925331e-02 1 1  ON 13
 ud_4                -1.271862e-01 1 1  ON 14
 ud_5                -1.580376e-01 1 1  ON 15
 ud_6                -1.594736e-01 1 1  ON 16
 ud_7                -1.151576e-01 1 1  ON 17
 ud_8                -1.851113e-02 1 1  ON 18
 ud_9                 9.183310e-02 1 1  ON 19
 eO_0                -8.197025e-01 1 1  ON 20
 eO_1                -4.849038e-01 1 1  ON 21
 eO_2                -5.358570e-02 1 1  ON 22
 eO_3                 2.181088e-01 1 1  ON 23
 eO_4                 3.210289e-01 1 1  ON 24
 eO_5                 3.401213e-01 1 1  ON 25
 eO_6                 2.740272e-01 1 1  ON 26
 eO_7                 1.391194e-01 1 1  ON 27
 eO_8                 3.232055e-02 1 1  ON 28
 eO_9                 2.039929e-02 1 1  ON 29
eH1_0                -1.867796e-01 1 1  ON 30
eH1_1                -1.073381e-01 1 1  ON 31
eH1_2                -6.431418e-02 1 1  ON 32
eH1_3                -2.622444e-02 1 1  ON 33
eH1_4                 1.891059e-02 1 1  ON 34
eH1_5                 3.053543e-02 1 1  ON 35
eH1_6                 7.403134e-02 1 1  ON 36
eH1_7                 1.083569e-01 1 1  ON 37
eH1_8                 1.057416e-01 1 1  ON 38
eH1_9                 2.976125e-02 1 1  ON 39
eH2_0                -1.873885e-01 1 1  ON 40
eH2_1                -1.079276e-01 1 1  ON 41
eH2_2                -6.492693e-02 1 1  ON 42
eH2_3                -2.711205e-02 1 1  ON 43
eH2_4                 1.752274e-02 1 1  ON 44
eH2_5                 2.902486e-02 1 1  ON 45
eH2_6                 7.391908e-02 1 1  ON 46
eH2_7                 1.110059e-01 1 1  ON 47
eH2_8                 1.098461e-01 1 1  ON 48
eH2_9                 3.128229e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2272
    reference variance = 0.21738
====================================================
  Execution time = 1.8664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3931e-01
  Total weights = 2.0000e+06
  Execution time = 1.5698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339205706092
                                         uncertainty =       0.003643646566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339205706092
                                         uncertainty =       0.003643646566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411892068
  error estimate for blocks of size 2^( 2) =       0.000422463319
  error estimate for blocks of size 2^( 3) =       0.000431708732
  error estimate for blocks of size 2^( 4) =       0.000438747288
  error estimate for blocks of size 2^( 5) =       0.000443124381
  error estimate for blocks of size 2^( 6) =       0.000444907691
  error estimate for blocks of size 2^( 7) =       0.000447099058

      target function =                  N/A
              le_mean =     -17.211765413281
             les_mean =     296.584178623755
             stat err =       0.000443469604
             autocorr =       1.159206638045
              std dev =       0.582503349007
             le_variance =       0.339310151604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339209345276
                                         uncertainty =       0.003643392013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339209345276
                                         uncertainty =       0.003643392013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411894277
  error estimate for blocks of size 2^( 2) =       0.000422465521
  error estimate for blocks of size 2^( 3) =       0.000431711116
  error estimate for blocks of size 2^( 4) =       0.000438749572
  error estimate for blocks of size 2^( 5) =       0.000443126531
  error estimate for blocks of size 2^( 6) =       0.000444910033
  error estimate for blocks of size 2^( 7) =       0.000447100729

      target function =                  N/A
              le_mean =     -17.211765450172
             les_mean =     296.584183532516
             stat err =       0.000443471716
             autocorr =       1.159205245801
              std dev =       0.582506472445
             le_variance =       0.339313790440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339208048720
                                         uncertainty =       0.003643512083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339208048720
                                         uncertainty =       0.003643512083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411893490
  error estimate for blocks of size 2^( 2) =       0.000422464736
  error estimate for blocks of size 2^( 3) =       0.000431710257
  error estimate for blocks of size 2^( 4) =       0.000438748760
  error estimate for blocks of size 2^( 5) =       0.000443125775
  error estimate for blocks of size 2^( 6) =       0.000444909179
  error estimate for blocks of size 2^( 7) =       0.000447100172

      target function =                  N/A
              le_mean =     -17.211765429960
             les_mean =     296.584181541267
             stat err =       0.000443470972
             autocorr =       1.159205779735
              std dev =       0.582505360442
             le_variance =       0.339312494944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339206015704
                                         uncertainty =       0.003643629511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339206015704
                                         uncertainty =       0.003643629511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411892256
  error estimate for blocks of size 2^( 2) =       0.000422463506
  error estimate for blocks of size 2^( 3) =       0.000431708933
  error estimate for blocks of size 2^( 4) =       0.000438747483
  error estimate for blocks of size 2^( 5) =       0.000443124565
  error estimate for blocks of size 2^( 6) =       0.000444907888
  error estimate for blocks of size 2^( 7) =       0.000447099206

      target function =                  N/A
              le_mean =     -17.211765415203
             les_mean =     296.584178999656
             stat err =       0.000443469785
             autocorr =       1.159206525783
              std dev =       0.582503614871
             le_variance =       0.339310461338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211765413281        initial
     3.6380e+00     3.6380e+01             3.5009e-05       -17.211765450172  <--
     1.4552e+01     1.4552e+02             9.0359e-06       -17.211765429960
     5.8208e+01     5.8208e+02             2.2787e-06       -17.211765415203

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 2.6602e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.202934e-01 1 1  ON 0
 uu_1                 5.402184e-02 1 1  ON 1
 uu_2                -4.584462e-02 1 1  ON 2
 uu_3                -1.034557e-01 1 1  ON 3
 uu_4                -1.370548e-01 1 1  ON 4
 uu_5                -1.441916e-01 1 1  ON 5
 uu_6                -1.223336e-01 1 1  ON 6
 uu_7                -5.309154e-02 1 1  ON 7
 uu_8                 8.635836e-02 1 1  ON 8
 uu_9                 1.339042e-01 1 1  ON 9
 ud_0                 3.693598e-01 1 1  ON 10
 ud_1                 1.028721e-01 1 1  ON 11
 ud_2                -1.502007e-02 1 1  ON 12
 ud_3                -7.925529e-02 1 1  ON 13
 ud_4                -1.271756e-01 1 1  ON 14
 ud_5                -1.580419e-01 1 1  ON 15
 ud_6                -1.594796e-01 1 1  ON 16
 ud_7                -1.151555e-01 1 1  ON 17
 ud_8                -1.852521e-02 1 1  ON 18
 ud_9                 9.183373e-02 1 1  ON 19
 eO_0                -8.197243e-01 1 1  ON 20
 eO_1                -4.849126e-01 1 1  ON 21
 eO_2                -5.361168e-02 1 1  ON 22
 eO_3                 2.180832e-01 1 1  ON 23
 eO_4                 3.210431e-01 1 1  ON 24
 eO_5                 3.401327e-01 1 1  ON 25
 eO_6                 2.740505e-01 1 1  ON 26
 eO_7                 1.391447e-01 1 1  ON 27
 eO_8                 3.232525e-02 1 1  ON 28
 eO_9                 2.040118e-02 1 1  ON 29
eH1_0                -1.867722e-01 1 1  ON 30
eH1_1                -1.073511e-01 1 1  ON 31
eH1_2                -6.431845e-02 1 1  ON 32
eH1_3                -2.623154e-02 1 1  ON 33
eH1_4                 1.890367e-02 1 1  ON 34
eH1_5                 3.054582e-02 1 1  ON 35
eH1_6                 7.402690e-02 1 1  ON 36
eH1_7                 1.083563e-01 1 1  ON 37
eH1_8                 1.057552e-01 1 1  ON 38
eH1_9                 2.976538e-02 1 1  ON 39
eH2_0                -1.873872e-01 1 1  ON 40
eH2_1                -1.079238e-01 1 1  ON 41
eH2_2                -6.492154e-02 1 1  ON 42
eH2_3                -2.713263e-02 1 1  ON 43
eH2_4                 1.750920e-02 1 1  ON 44
eH2_5                 2.903996e-02 1 1  ON 45
eH2_6                 7.391435e-02 1 1  ON 46
eH2_7                 1.110015e-01 1 1  ON 47
eH2_8                 1.098581e-01 1 1  ON 48
eH2_9                 3.128565e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0858e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.163741
====================================================
  Execution time = 1.8804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342361259039
                                         uncertainty =       0.004813449213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342361259039
                                         uncertainty =       0.004813449213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413674345
  error estimate for blocks of size 2^( 2) =       0.000424212253
  error estimate for blocks of size 2^( 3) =       0.000434017650
  error estimate for blocks of size 2^( 4) =       0.000440836558
  error estimate for blocks of size 2^( 5) =       0.000444208353
  error estimate for blocks of size 2^( 6) =       0.000447704194
  error estimate for blocks of size 2^( 7) =       0.000448618834

      target function =                  N/A
              le_mean =     -17.211972816703
             les_mean =     296.594260998817
             stat err =       0.000445341985
             autocorr =       1.158964426013
              std dev =       0.585023868766
             le_variance =       0.342252927025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197281670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211972816703       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211972770286       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211972662801       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211972594429       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211972591984       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211972723952       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211972730879       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211972704370       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 1.554398e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211972816703       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211972803709       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211972763857       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211972735282       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211972743546       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211972774661       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211972769372       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 3.927248e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211972816703       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211972813354       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211972802234       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211972794133       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211972796960       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211972804332       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211972803375       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 9.822659e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4024e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.202909e-01 1 1  ON 0
 uu_1                 5.402226e-02 1 1  ON 1
 uu_2                -4.583901e-02 1 1  ON 2
 uu_3                -1.034631e-01 1 1  ON 3
 uu_4                -1.370713e-01 1 1  ON 4
 uu_5                -1.441784e-01 1 1  ON 5
 uu_6                -1.223384e-01 1 1  ON 6
 uu_7                -5.309956e-02 1 1  ON 7
 uu_8                 8.634534e-02 1 1  ON 8
 uu_9                 1.339175e-01 1 1  ON 9
 ud_0                 3.693566e-01 1 1  ON 10
 ud_1                 1.028943e-01 1 1  ON 11
 ud_2                -1.501521e-02 1 1  ON 12
 ud_3                -7.923111e-02 1 1  ON 13
 ud_4                -1.271721e-01 1 1  ON 14
 ud_5                -1.580399e-01 1 1  ON 15
 ud_6                -1.595131e-01 1 1  ON 16
 ud_7                -1.151796e-01 1 1  ON 17
 ud_8                -1.854295e-02 1 1  ON 18
 ud_9                 9.183668e-02 1 1  ON 19
 eO_0                -8.197610e-01 1 1  ON 20
 eO_1                -4.849277e-01 1 1  ON 21
 eO_2                -5.363290e-02 1 1  ON 22
 eO_3                 2.180512e-01 1 1  ON 23
 eO_4                 3.210593e-01 1 1  ON 24
 eO_5                 3.401530e-01 1 1  ON 25
 eO_6                 2.740722e-01 1 1  ON 26
 eO_7                 1.391778e-01 1 1  ON 27
 eO_8                 3.233447e-02 1 1  ON 28
 eO_9                 2.040376e-02 1 1  ON 29
eH1_0                -1.867752e-01 1 1  ON 30
eH1_1                -1.073191e-01 1 1  ON 31
eH1_2                -6.429985e-02 1 1  ON 32
eH1_3                -2.623376e-02 1 1  ON 33
eH1_4                 1.889953e-02 1 1  ON 34
eH1_5                 3.050654e-02 1 1  ON 35
eH1_6                 7.399769e-02 1 1  ON 36
eH1_7                 1.083553e-01 1 1  ON 37
eH1_8                 1.057740e-01 1 1  ON 38
eH1_9                 2.977078e-02 1 1  ON 39
eH2_0                -1.873676e-01 1 1  ON 40
eH2_1                -1.079223e-01 1 1  ON 41
eH2_2                -6.494932e-02 1 1  ON 42
eH2_3                -2.714170e-02 1 1  ON 43
eH2_4                 1.751691e-02 1 1  ON 44
eH2_5                 2.904518e-02 1 1  ON 45
eH2_6                 7.390141e-02 1 1  ON 46
eH2_7                 1.109927e-01 1 1  ON 47
eH2_8                 1.098747e-01 1 1  ON 48
eH2_9                 3.129203e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0945
    reference variance = 0.831967
====================================================
  Execution time = 1.8551e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3846e-01
  Total weights = 2.0000e+06
  Execution time = 1.5694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338457998478
                                         uncertainty =       0.002336096641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338457998478
                                         uncertainty =       0.002336096641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411379981
  error estimate for blocks of size 2^( 2) =       0.000422219363
  error estimate for blocks of size 2^( 3) =       0.000431984687
  error estimate for blocks of size 2^( 4) =       0.000439116731
  error estimate for blocks of size 2^( 5) =       0.000442696451
  error estimate for blocks of size 2^( 6) =       0.000442679387
  error estimate for blocks of size 2^( 7) =       0.000445264688

      target function =                  N/A
              le_mean =     -17.211654669917
             les_mean =     296.579523284470
             stat err =       0.000442439314
             autocorr =       1.156701005771
              std dev =       0.581779148154
             le_variance =       0.338466977226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338448722216
                                         uncertainty =       0.002335727083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338448722216
                                         uncertainty =       0.002335727083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411374321
  error estimate for blocks of size 2^( 2) =       0.000422214086
  error estimate for blocks of size 2^( 3) =       0.000431978843
  error estimate for blocks of size 2^( 4) =       0.000439108984
  error estimate for blocks of size 2^( 5) =       0.000442687426
  error estimate for blocks of size 2^( 6) =       0.000442673054
  error estimate for blocks of size 2^( 7) =       0.000445258497

      target function =                  N/A
              le_mean =     -17.211654982989
             les_mean =     296.579524747929
             stat err =       0.000442431990
             autocorr =       1.156694541107
              std dev =       0.581771143744
             le_variance =       0.338457663694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338444740261
                                         uncertainty =       0.002335799673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338444740261
                                         uncertainty =       0.002335799673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411371907
  error estimate for blocks of size 2^( 2) =       0.000422211698
  error estimate for blocks of size 2^( 3) =       0.000431976807
  error estimate for blocks of size 2^( 4) =       0.000439107882
  error estimate for blocks of size 2^( 5) =       0.000442686720
  error estimate for blocks of size 2^( 6) =       0.000442671320
  error estimate for blocks of size 2^( 7) =       0.000445256758

      target function =                  N/A
              le_mean =     -17.211654825644
             les_mean =     296.579515360113
             stat err =       0.000442430670
             autocorr =       1.156701211765
              std dev =       0.581767730485
             le_variance =       0.338453692233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338455949316
                                         uncertainty =       0.002336054026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338455949316
                                         uncertainty =       0.002336054026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411378733
  error estimate for blocks of size 2^( 2) =       0.000422218172
  error estimate for blocks of size 2^( 3) =       0.000431983468
  error estimate for blocks of size 2^( 4) =       0.000439115387
  error estimate for blocks of size 2^( 5) =       0.000442694981
  error estimate for blocks of size 2^( 6) =       0.000442678139
  error estimate for blocks of size 2^( 7) =       0.000445263463

      target function =                  N/A
              le_mean =     -17.211654688071
             les_mean =     296.579521856471
             stat err =       0.000442437993
             autocorr =       1.156701112584
              std dev =       0.581777383805
             le_variance =       0.338464924306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211654669917        initial
     9.0949e-01     9.0949e+00             1.5544e-04       -17.211654982989  <--
     3.6380e+00     3.6380e+01             3.9272e-05       -17.211654825644
     1.4552e+01     1.4552e+02             9.8227e-06       -17.211654688071

*****************************************************************************
Applying the update for shift_i =   9.0949e-01     and shift_s =   9.0949e+00
*****************************************************************************

  Execution time = 3.0450e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.202879e-01 1 1  ON 0
 uu_1                 5.402475e-02 1 1  ON 1
 uu_2                -4.583162e-02 1 1  ON 2
 uu_3                -1.034796e-01 1 1  ON 3
 uu_4                -1.371120e-01 1 1  ON 4
 uu_5                -1.441513e-01 1 1  ON 5
 uu_6                -1.223527e-01 1 1  ON 6
 uu_7                -5.312280e-02 1 1  ON 7
 uu_8                 8.630611e-02 1 1  ON 8
 uu_9                 1.339573e-01 1 1  ON 9
 ud_0                 3.693693e-01 1 1  ON 10
 ud_1                 1.029442e-01 1 1  ON 11
 ud_2                -1.499172e-02 1 1  ON 12
 ud_3                -7.917540e-02 1 1  ON 13
 ud_4                -1.271598e-01 1 1  ON 14
 ud_5                -1.580368e-01 1 1  ON 15
 ud_6                -1.596101e-01 1 1  ON 16
 ud_7                -1.152516e-01 1 1  ON 17
 ud_8                -1.859670e-02 1 1  ON 18
 ud_9                 9.184551e-02 1 1  ON 19
 eO_0                -8.198602e-01 1 1  ON 20
 eO_1                -4.849841e-01 1 1  ON 21
 eO_2                -5.369600e-02 1 1  ON 22
 eO_3                 2.179603e-01 1 1  ON 23
 eO_4                 3.211019e-01 1 1  ON 24
 eO_5                 3.402132e-01 1 1  ON 25
 eO_6                 2.741378e-01 1 1  ON 26
 eO_7                 1.392776e-01 1 1  ON 27
 eO_8                 3.236228e-02 1 1  ON 28
 eO_9                 2.041154e-02 1 1  ON 29
eH1_0                -1.867780e-01 1 1  ON 30
eH1_1                -1.072370e-01 1 1  ON 31
eH1_2                -6.424750e-02 1 1  ON 32
eH1_3                -2.623329e-02 1 1  ON 33
eH1_4                 1.889040e-02 1 1  ON 34
eH1_5                 3.039038e-02 1 1  ON 35
eH1_6                 7.390887e-02 1 1  ON 36
eH1_7                 1.083523e-01 1 1  ON 37
eH1_8                 1.058305e-01 1 1  ON 38
eH1_9                 2.978707e-02 1 1  ON 39
eH2_0                -1.873153e-01 1 1  ON 40
eH2_1                -1.079272e-01 1 1  ON 41
eH2_2                -6.501646e-02 1 1  ON 42
eH2_3                -2.716741e-02 1 1  ON 43
eH2_4                 1.753788e-02 1 1  ON 44
eH2_5                 2.906069e-02 1 1  ON 45
eH2_6                 7.386263e-02 1 1  ON 46
eH2_7                 1.109665e-01 1 1  ON 47
eH2_8                 1.099246e-01 1 1  ON 48
eH2_9                 3.131127e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4480e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2722
    reference variance = 0.41281
====================================================
  Execution time = 1.8927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5283e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352793347723
                                         uncertainty =       0.006800277757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352793347723
                                         uncertainty =       0.006800277757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420016702
  error estimate for blocks of size 2^( 2) =       0.000430434925
  error estimate for blocks of size 2^( 3) =       0.000439473669
  error estimate for blocks of size 2^( 4) =       0.000446275765
  error estimate for blocks of size 2^( 5) =       0.000451044114
  error estimate for blocks of size 2^( 6) =       0.000454145011
  error estimate for blocks of size 2^( 7) =       0.000454981112

      target function =                  N/A
              le_mean =     -17.211809838810
             les_mean =     296.599225810404
             stat err =       0.000451611500
             autocorr =       1.156103896925
              std dev =       0.593993315997
             le_variance =       0.352828059449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721180983881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211809838810       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211810303677       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211812528354       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211812634128       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211813230948       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211813768941       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211813277326       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211813684904       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211813434653       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e-01 is 4.983139e-04

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211809838810       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211810012458       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211810599649       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211810859883       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211811312090       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211811406423       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211811216589       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211811302521       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 1.838306e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211809838810       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211809888342       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211810029289       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211810129256       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211810291529       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211810298211       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211810260320       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 5.416229e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4301e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.203274e-01 1 1  ON 0
 uu_1                 5.410071e-02 1 1  ON 1
 uu_2                -4.585098e-02 1 1  ON 2
 uu_3                -1.035251e-01 1 1  ON 3
 uu_4                -1.371403e-01 1 1  ON 4
 uu_5                -1.441771e-01 1 1  ON 5
 uu_6                -1.223898e-01 1 1  ON 6
 uu_7                -5.316625e-02 1 1  ON 7
 uu_8                 8.624871e-02 1 1  ON 8
 uu_9                 1.340141e-01 1 1  ON 9
 ud_0                 3.694723e-01 1 1  ON 10
 ud_1                 1.029920e-01 1 1  ON 11
 ud_2                -1.497548e-02 1 1  ON 12
 ud_3                -7.919644e-02 1 1  ON 13
 ud_4                -1.271982e-01 1 1  ON 14
 ud_5                -1.578529e-01 1 1  ON 15
 ud_6                -1.597442e-01 1 1  ON 16
 ud_7                -1.153439e-01 1 1  ON 17
 ud_8                -1.871169e-02 1 1  ON 18
 ud_9                 9.182515e-02 1 1  ON 19
 eO_0                -8.199765e-01 1 1  ON 20
 eO_1                -4.850907e-01 1 1  ON 21
 eO_2                -5.365602e-02 1 1  ON 22
 eO_3                 2.178172e-01 1 1  ON 23
 eO_4                 3.210572e-01 1 1  ON 24
 eO_5                 3.403246e-01 1 1  ON 25
 eO_6                 2.742398e-01 1 1  ON 26
 eO_7                 1.393984e-01 1 1  ON 27
 eO_8                 3.237894e-02 1 1  ON 28
 eO_9                 2.042070e-02 1 1  ON 29
eH1_0                -1.867291e-01 1 1  ON 30
eH1_1                -1.072631e-01 1 1  ON 31
eH1_2                -6.425939e-02 1 1  ON 32
eH1_3                -2.623366e-02 1 1  ON 33
eH1_4                 1.879483e-02 1 1  ON 34
eH1_5                 3.038086e-02 1 1  ON 35
eH1_6                 7.390295e-02 1 1  ON 36
eH1_7                 1.083543e-01 1 1  ON 37
eH1_8                 1.058931e-01 1 1  ON 38
eH1_9                 2.981032e-02 1 1  ON 39
eH2_0                -1.873813e-01 1 1  ON 40
eH2_1                -1.080709e-01 1 1  ON 41
eH2_2                -6.495159e-02 1 1  ON 42
eH2_3                -2.709950e-02 1 1  ON 43
eH2_4                 1.761454e-02 1 1  ON 44
eH2_5                 2.906744e-02 1 1  ON 45
eH2_6                 7.382621e-02 1 1  ON 46
eH2_7                 1.109126e-01 1 1  ON 47
eH2_8                 1.099801e-01 1 1  ON 48
eH2_9                 3.132966e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1816
    reference variance = 0.209475
====================================================
  Execution time = 1.8731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7210e+01
  VMC Evar = 3.4387e-01
  Total weights = 2.0000e+06
  Execution time = 1.5658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343673356995
                                         uncertainty =       0.003210577682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343673356995
                                         uncertainty =       0.003210577682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414587232
  error estimate for blocks of size 2^( 2) =       0.000425399770
  error estimate for blocks of size 2^( 3) =       0.000434664234
  error estimate for blocks of size 2^( 4) =       0.000441445149
  error estimate for blocks of size 2^( 5) =       0.000446437546
  error estimate for blocks of size 2^( 6) =       0.000447733490
  error estimate for blocks of size 2^( 7) =       0.000447827939

      target function =                  N/A
              le_mean =     -17.210351084724
             les_mean =     296.539949433994
             stat err =       0.000445861031
             autocorr =       1.156557383190
              std dev =       0.586314886733
             le_variance =       0.343765146405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343937927140
                                         uncertainty =       0.003215460784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343937927140
                                         uncertainty =       0.003215460784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414746805
  error estimate for blocks of size 2^( 2) =       0.000425549791
  error estimate for blocks of size 2^( 3) =       0.000434805700
  error estimate for blocks of size 2^( 4) =       0.000441581237
  error estimate for blocks of size 2^( 5) =       0.000446578329
  error estimate for blocks of size 2^( 6) =       0.000447869317
  error estimate for blocks of size 2^( 7) =       0.000447958670

      target function =                  N/A
              le_mean =     -17.210352627976
             les_mean =     296.540267232112
             stat err =       0.000445996888
             autocorr =       1.156371976297
              std dev =       0.586540556854
             le_variance =       0.344029824835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343881905185
                                         uncertainty =       0.003214881279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343881905185
                                         uncertainty =       0.003214881279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414713026
  error estimate for blocks of size 2^( 2) =       0.000425518316
  error estimate for blocks of size 2^( 3) =       0.000434776190
  error estimate for blocks of size 2^( 4) =       0.000441552341
  error estimate for blocks of size 2^( 5) =       0.000446549101
  error estimate for blocks of size 2^( 6) =       0.000447841349
  error estimate for blocks of size 2^( 7) =       0.000447933005

      target function =                  N/A
              le_mean =     -17.210352090208
             les_mean =     296.540192685096
             stat err =       0.000445968949
             autocorr =       1.156415461123
              std dev =       0.586492786100
             le_variance =       0.343973788147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343704608697
                                         uncertainty =       0.003211194907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343704608697
                                         uncertainty =       0.003211194907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414606086
  error estimate for blocks of size 2^( 2) =       0.000425417542
  error estimate for blocks of size 2^( 3) =       0.000434681023
  error estimate for blocks of size 2^( 4) =       0.000441461187
  error estimate for blocks of size 2^( 5) =       0.000446454261
  error estimate for blocks of size 2^( 6) =       0.000447749726
  error estimate for blocks of size 2^( 7) =       0.000447843802

      target function =                  N/A
              le_mean =     -17.210351154100
             les_mean =     296.539983089146
             stat err =       0.000445877244
             autocorr =       1.156536303929
              std dev =       0.586341550299
             le_variance =       0.343796413607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210351084724        initial
     2.2737e-01     2.2737e+00             4.9831e-04       -17.210352627976  <--
     9.0949e-01     9.0949e+00             1.8383e-04       -17.210352090208
     3.6380e+00     3.6380e+01             5.4162e-05       -17.210351154100

*****************************************************************************
Applying the update for shift_i =   2.2737e-01     and shift_s =   2.2737e+00
*****************************************************************************

  Execution time = 2.6679e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.204370e-01 1 1  ON 0
 uu_1                 5.417704e-02 1 1  ON 1
 uu_2                -4.587912e-02 1 1  ON 2
 uu_3                -1.035957e-01 1 1  ON 3
 uu_4                -1.372282e-01 1 1  ON 4
 uu_5                -1.442429e-01 1 1  ON 5
 uu_6                -1.224687e-01 1 1  ON 6
 uu_7                -5.327909e-02 1 1  ON 7
 uu_8                 8.608052e-02 1 1  ON 8
 uu_9                 1.341854e-01 1 1  ON 9
 ud_0                 3.696669e-01 1 1  ON 10
 ud_1                 1.031186e-01 1 1  ON 11
 ud_2                -1.490527e-02 1 1  ON 12
 ud_3                -7.917616e-02 1 1  ON 13
 ud_4                -1.272154e-01 1 1  ON 14
 ud_5                -1.575385e-01 1 1  ON 15
 ud_6                -1.600230e-01 1 1  ON 16
 ud_7                -1.155827e-01 1 1  ON 17
 ud_8                -1.905394e-02 1 1  ON 18
 ud_9                 9.176430e-02 1 1  ON 19
 eO_0                -8.203091e-01 1 1  ON 20
 eO_1                -4.852994e-01 1 1  ON 21
 eO_2                -5.374181e-02 1 1  ON 22
 eO_3                 2.174697e-01 1 1  ON 23
 eO_4                 3.208825e-01 1 1  ON 24
 eO_5                 3.406744e-01 1 1  ON 25
 eO_6                 2.745631e-01 1 1  ON 26
 eO_7                 1.397647e-01 1 1  ON 27
 eO_8                 3.242930e-02 1 1  ON 28
 eO_9                 2.044826e-02 1 1  ON 29
eH1_0                -1.866538e-01 1 1  ON 30
eH1_1                -1.073642e-01 1 1  ON 31
eH1_2                -6.430206e-02 1 1  ON 32
eH1_3                -2.624374e-02 1 1  ON 33
eH1_4                 1.862054e-02 1 1  ON 34
eH1_5                 3.033578e-02 1 1  ON 35
eH1_6                 7.388828e-02 1 1  ON 36
eH1_7                 1.083683e-01 1 1  ON 37
eH1_8                 1.060835e-01 1 1  ON 38
eH1_9                 2.988053e-02 1 1  ON 39
eH2_0                -1.875999e-01 1 1  ON 40
eH2_1                -1.082661e-01 1 1  ON 41
eH2_2                -6.486861e-02 1 1  ON 42
eH2_3                -2.697166e-02 1 1  ON 43
eH2_4                 1.778907e-02 1 1  ON 44
eH2_5                 2.910012e-02 1 1  ON 45
eH2_6                 7.372507e-02 1 1  ON 46
eH2_7                 1.107559e-01 1 1  ON 47
eH2_8                 1.101481e-01 1 1  ON 48
eH2_9                 3.138513e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.260911
====================================================
  Execution time = 1.8943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5289e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.2342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352813026346
                                         uncertainty =       0.006968553421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352813026346
                                         uncertainty =       0.006968553421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420055130
  error estimate for blocks of size 2^( 2) =       0.000430433799
  error estimate for blocks of size 2^( 3) =       0.000439284323
  error estimate for blocks of size 2^( 4) =       0.000445807008
  error estimate for blocks of size 2^( 5) =       0.000449398471
  error estimate for blocks of size 2^( 6) =       0.000451287673
  error estimate for blocks of size 2^( 7) =       0.000451354480

      target function =                  N/A
              le_mean =     -17.211364550352
             les_mean =     296.583962132985
             stat err =       0.000449461908
             autocorr =       1.144914870574
              std dev =       0.594047661645
             le_variance =       0.352892624305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721136455035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-02, overlap shift 5.6843e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211364550352       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211363317304       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211363902888       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211365148054       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211365655791       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211366171915       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211366820264       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211367759367       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211366886789       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211368072214       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211367912564       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211367123099       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e-02 is 2.209259e-03

solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211364550352       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211363778120       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211363832944       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211364738334       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211364935760       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211365066562       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211365387244       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211365505472       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211365292816       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211365502608       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e-01 is 5.902876e-04

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211364550352       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211364240826       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211364147836       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211364558043       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211364578766       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211364539833       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211364652662       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211364646768       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 1.836666e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4189e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.203894e-01 1 1  ON 0
 uu_1                 5.402576e-02 1 1  ON 1
 uu_2                -4.598096e-02 1 1  ON 2
 uu_3                -1.037058e-01 1 1  ON 3
 uu_4                -1.372889e-01 1 1  ON 4
 uu_5                -1.441179e-01 1 1  ON 5
 uu_6                -1.223190e-01 1 1  ON 6
 uu_7                -5.343795e-02 1 1  ON 7
 uu_8                 8.582823e-02 1 1  ON 8
 uu_9                 1.343621e-01 1 1  ON 9
 ud_0                 3.698085e-01 1 1  ON 10
 ud_1                 1.032131e-01 1 1  ON 11
 ud_2                -1.486756e-02 1 1  ON 12
 ud_3                -7.909346e-02 1 1  ON 13
 ud_4                -1.272295e-01 1 1  ON 14
 ud_5                -1.579339e-01 1 1  ON 15
 ud_6                -1.598700e-01 1 1  ON 16
 ud_7                -1.156636e-01 1 1  ON 17
 ud_8                -1.934330e-02 1 1  ON 18
 ud_9                 9.170454e-02 1 1  ON 19
 eO_0                -8.204719e-01 1 1  ON 20
 eO_1                -4.856474e-01 1 1  ON 21
 eO_2                -5.405940e-02 1 1  ON 22
 eO_3                 2.168794e-01 1 1  ON 23
 eO_4                 3.206009e-01 1 1  ON 24
 eO_5                 3.411202e-01 1 1  ON 25
 eO_6                 2.751140e-01 1 1  ON 26
 eO_7                 1.403134e-01 1 1  ON 27
 eO_8                 3.249188e-02 1 1  ON 28
 eO_9                 2.047450e-02 1 1  ON 29
eH1_0                -1.865720e-01 1 1  ON 30
eH1_1                -1.071367e-01 1 1  ON 31
eH1_2                -6.445730e-02 1 1  ON 32
eH1_3                -2.646231e-02 1 1  ON 33
eH1_4                 1.885370e-02 1 1  ON 34
eH1_5                 2.995892e-02 1 1  ON 35
eH1_6                 7.362083e-02 1 1  ON 36
eH1_7                 1.083548e-01 1 1  ON 37
eH1_8                 1.064214e-01 1 1  ON 38
eH1_9                 2.998155e-02 1 1  ON 39
eH2_0                -1.875471e-01 1 1  ON 40
eH2_1                -1.083568e-01 1 1  ON 41
eH2_2                -6.502771e-02 1 1  ON 42
eH2_3                -2.745433e-02 1 1  ON 43
eH2_4                 1.778318e-02 1 1  ON 44
eH2_5                 2.939155e-02 1 1  ON 45
eH2_6                 7.363307e-02 1 1  ON 46
eH2_7                 1.107771e-01 1 1  ON 47
eH2_8                 1.104607e-01 1 1  ON 48
eH2_9                 3.150786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.156
    reference variance = 0.215075
====================================================
  Execution time = 1.8863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5732e-01
  Total weights = 2.0000e+06
  Execution time = 1.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357296186061
                                         uncertainty =       0.016117540479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357296186061
                                         uncertainty =       0.016117540479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422621622
  error estimate for blocks of size 2^( 2) =       0.000432607021
  error estimate for blocks of size 2^( 3) =       0.000442055704
  error estimate for blocks of size 2^( 4) =       0.000449000518
  error estimate for blocks of size 2^( 5) =       0.000453127996
  error estimate for blocks of size 2^( 6) =       0.000454553766
  error estimate for blocks of size 2^( 7) =       0.000457662632

      target function =                  N/A
              le_mean =     -17.212385431168
             les_mean =     296.623430122632
             stat err =       0.000453586228
             autocorr =       1.151904023303
              std dev =       0.597677229079
             le_variance =       0.357218070160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357462698332
                                         uncertainty =       0.016097667857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357462698332
                                         uncertainty =       0.016097667857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422720032
  error estimate for blocks of size 2^( 2) =       0.000432702734
  error estimate for blocks of size 2^( 3) =       0.000442149019
  error estimate for blocks of size 2^( 4) =       0.000449087632
  error estimate for blocks of size 2^( 5) =       0.000453206085
  error estimate for blocks of size 2^( 6) =       0.000454631561
  error estimate for blocks of size 2^( 7) =       0.000457734441

      target function =                  N/A
              le_mean =     -17.212386464979
             les_mean =     296.623632091785
             stat err =       0.000453664930
             autocorr =       1.151767336262
              std dev =       0.597816402165
             le_variance =       0.357384450698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357512520428
                                         uncertainty =       0.016093172763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357512520428
                                         uncertainty =       0.016093172763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422749465
  error estimate for blocks of size 2^( 2) =       0.000432731009
  error estimate for blocks of size 2^( 3) =       0.000442176357
  error estimate for blocks of size 2^( 4) =       0.000449114142
  error estimate for blocks of size 2^( 5) =       0.000453231692
  error estimate for blocks of size 2^( 6) =       0.000454652787
  error estimate for blocks of size 2^( 7) =       0.000457749121

      target function =                  N/A
              le_mean =     -17.212386812539
             les_mean =     296.623693825395
             stat err =       0.000453686936
             autocorr =       1.151718689272
              std dev =       0.597858026317
             le_variance =       0.357434219631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357352432338
                                         uncertainty =       0.016113142468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357352432338
                                         uncertainty =       0.016113142468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422654867
  error estimate for blocks of size 2^( 2) =       0.000432638962
  error estimate for blocks of size 2^( 3) =       0.000442086777
  error estimate for blocks of size 2^( 4) =       0.000449030211
  error estimate for blocks of size 2^( 5) =       0.000453155993
  error estimate for blocks of size 2^( 6) =       0.000454580437
  error estimate for blocks of size 2^( 7) =       0.000457686429

      target function =                  N/A
              le_mean =     -17.212385341447
             les_mean =     296.623483237707
             stat err =       0.000453613268
             autocorr =       1.151860134604
              std dev =       0.597724245698
             le_variance =       0.357274273896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212385431168        initial
     5.6843e-02     5.6843e-01             2.2093e-03       -17.212386464979
     2.2737e-01     2.2737e+00             5.9029e-04       -17.212386812539  <--
     9.0949e-01     9.0949e+00             1.8367e-04       -17.212385341447

*****************************************************************************
Applying the update for shift_i =   2.2737e-01     and shift_s =   2.2737e+00
*****************************************************************************

  Execution time = 2.6818e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.203894e-01 1 1  ON 0
 uu_1                 5.402576e-02 1 1  ON 1
 uu_2                -4.598096e-02 1 1  ON 2
 uu_3                -1.037058e-01 1 1  ON 3
 uu_4                -1.372889e-01 1 1  ON 4
 uu_5                -1.441179e-01 1 1  ON 5
 uu_6                -1.223190e-01 1 1  ON 6
 uu_7                -5.343795e-02 1 1  ON 7
 uu_8                 8.582823e-02 1 1  ON 8
 uu_9                 1.343621e-01 1 1  ON 9
 ud_0                 3.698085e-01 1 1  ON 10
 ud_1                 1.032131e-01 1 1  ON 11
 ud_2                -1.486756e-02 1 1  ON 12
 ud_3                -7.909346e-02 1 1  ON 13
 ud_4                -1.272295e-01 1 1  ON 14
 ud_5                -1.579339e-01 1 1  ON 15
 ud_6                -1.598700e-01 1 1  ON 16
 ud_7                -1.156636e-01 1 1  ON 17
 ud_8                -1.934330e-02 1 1  ON 18
 ud_9                 9.170454e-02 1 1  ON 19
 eO_0                -8.204719e-01 1 1  ON 20
 eO_1                -4.856474e-01 1 1  ON 21
 eO_2                -5.405940e-02 1 1  ON 22
 eO_3                 2.168794e-01 1 1  ON 23
 eO_4                 3.206009e-01 1 1  ON 24
 eO_5                 3.411202e-01 1 1  ON 25
 eO_6                 2.751140e-01 1 1  ON 26
 eO_7                 1.403134e-01 1 1  ON 27
 eO_8                 3.249188e-02 1 1  ON 28
 eO_9                 2.047450e-02 1 1  ON 29
eH1_0                -1.865720e-01 1 1  ON 30
eH1_1                -1.071367e-01 1 1  ON 31
eH1_2                -6.445730e-02 1 1  ON 32
eH1_3                -2.646231e-02 1 1  ON 33
eH1_4                 1.885370e-02 1 1  ON 34
eH1_5                 2.995892e-02 1 1  ON 35
eH1_6                 7.362083e-02 1 1  ON 36
eH1_7                 1.083548e-01 1 1  ON 37
eH1_8                 1.064214e-01 1 1  ON 38
eH1_9                 2.998155e-02 1 1  ON 39
eH2_0                -1.875471e-01 1 1  ON 40
eH2_1                -1.083568e-01 1 1  ON 41
eH2_2                -6.502771e-02 1 1  ON 42
eH2_3                -2.745433e-02 1 1  ON 43
eH2_4                 1.778318e-02 1 1  ON 44
eH2_5                 2.939155e-02 1 1  ON 45
eH2_6                 7.363307e-02 1 1  ON 46
eH2_7                 1.107771e-01 1 1  ON 47
eH2_8                 1.104607e-01 1 1  ON 48
eH2_9                 3.150786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1011e+01 secs
  Total Execution time = 2.0595e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
