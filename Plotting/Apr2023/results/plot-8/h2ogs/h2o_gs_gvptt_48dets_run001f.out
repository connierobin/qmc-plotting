Rank =    0  Free Memory = 76617 MB
Rank =    1  Free Memory = 76617 MB
Rank =    2  Free Memory = 76617 MB
Rank =    3  Free Memory = 76616 MB
Rank =    4  Free Memory = 76616 MB
Rank =    5  Free Memory = 76616 MB
Rank =    6  Free Memory = 76616 MB
Rank =    7  Free Memory = 76616 MB
Rank =    8  Free Memory = 76616 MB
Rank =    9  Free Memory = 76616 MB
Rank =   10  Free Memory = 76616 MB
Rank =   11  Free Memory = 76616 MB
Rank =   12  Free Memory = 76616 MB
Rank =   13  Free Memory = 76616 MB
Rank =   14  Free Memory = 76615 MB
Rank =   15  Free Memory = 76601 MB
Rank =   16  Free Memory = 76600 MB
Rank =   17  Free Memory = 76600 MB
Rank =   18  Free Memory = 76600 MB
Rank =   19  Free Memory = 76599 MB
Rank =   20  Free Memory = 76599 MB
Rank =   21  Free Memory = 76599 MB
Rank =   22  Free Memory = 76599 MB
Rank =   23  Free Memory = 76599 MB
Rank =   24  Free Memory = 76599 MB
Rank =   25  Free Memory = 76599 MB
Rank =   26  Free Memory = 76599 MB
Rank =   27  Free Memory = 76599 MB
Rank =   28  Free Memory = 76599 MB
Rank =   29  Free Memory = 76599 MB
Rank =   30  Free Memory = 76599 MB
Rank =   31  Free Memory = 76599 MB
Rank =   32  Free Memory = 79140 MB
Rank =   33  Free Memory = 79140 MB
Rank =   34  Free Memory = 79140 MB
Rank =   35  Free Memory = 79140 MB
Rank =   36  Free Memory = 79140 MB
Rank =   37  Free Memory = 79140 MB
Rank =   38  Free Memory = 79140 MB
Rank =   39  Free Memory = 79140 MB
Rank =   40  Free Memory = 79140 MB
Rank =   41  Free Memory = 79140 MB
Rank =   42  Free Memory = 79140 MB
Rank =   43  Free Memory = 79140 MB
Rank =   44  Free Memory = 79140 MB
Rank =   45  Free Memory = 79140 MB
Rank =   46  Free Memory = 79140 MB
Rank =   47  Free Memory = 79140 MB
Rank =   48  Free Memory = 79140 MB
Rank =   49  Free Memory = 79140 MB
Rank =   50  Free Memory = 79140 MB
Rank =   51  Free Memory = 79140 MB
Rank =   52  Free Memory = 79140 MB
Rank =   53  Free Memory = 79139 MB
Rank =   54  Free Memory = 79139 MB
Rank =   55  Free Memory = 79139 MB
Rank =   56  Free Memory = 79139 MB
Rank =   57  Free Memory = 79139 MB
Rank =   58  Free Memory = 79139 MB
Rank =   59  Free Memory = 79139 MB
Rank =   60  Free Memory = 79139 MB
Rank =   61  Free Memory = 79139 MB
Rank =   62  Free Memory = 79139 MB
Rank =   63  Free Memory = 79139 MB
Rank =   64  Free Memory = 66979 MB
Rank =   65  Free Memory = 66979 MB
Rank =   66  Free Memory = 66979 MB
Rank =   67  Free Memory = 66979 MB
Rank =   68  Free Memory = 66979 MB
Rank =   69  Free Memory = 66979 MB
Rank =   70  Free Memory = 66979 MB
Rank =   71  Free Memory = 66979 MB
Rank =   72  Free Memory = 66979 MB
Rank =   73  Free Memory = 66978 MB
Rank =   74  Free Memory = 66978 MB
Rank =   75  Free Memory = 66978 MB
Rank =   76  Free Memory = 66978 MB
Rank =   77  Free Memory = 66978 MB
Rank =   78  Free Memory = 66978 MB
Rank =   79  Free Memory = 66978 MB
Rank =   80  Free Memory = 66978 MB
Rank =   81  Free Memory = 66978 MB
Rank =   82  Free Memory = 66978 MB
Rank =   83  Free Memory = 66978 MB
Rank =   84  Free Memory = 66978 MB
Rank =   85  Free Memory = 66978 MB
Rank =   86  Free Memory = 66978 MB
Rank =   87  Free Memory = 66978 MB
Rank =   88  Free Memory = 66978 MB
Rank =   89  Free Memory = 66978 MB
Rank =   90  Free Memory = 66978 MB
Rank =   91  Free Memory = 66978 MB
Rank =   92  Free Memory = 66978 MB
Rank =   93  Free Memory = 66978 MB
Rank =   94  Free Memory = 66978 MB
Rank =   95  Free Memory = 66978 MB
Rank =   96  Free Memory = 87327 MB
Rank =   97  Free Memory = 87327 MB
Rank =   98  Free Memory = 87327 MB
Rank =   99  Free Memory = 87327 MB
Rank =  100  Free Memory = 87327 MB
Rank =  101  Free Memory = 87327 MB
Rank =  102  Free Memory = 87327 MB
Rank =  103  Free Memory = 87327 MB
Rank =  104  Free Memory = 87327 MB
Rank =  105  Free Memory = 87327 MB
Rank =  106  Free Memory = 87327 MB
Rank =  107  Free Memory = 87327 MB
Rank =  108  Free Memory = 87327 MB
Rank =  109  Free Memory = 87327 MB
Rank =  110  Free Memory = 87327 MB
Rank =  111  Free Memory = 87327 MB
Rank =  112  Free Memory = 87327 MB
Rank =  113  Free Memory = 87327 MB
Rank =  114  Free Memory = 87327 MB
Rank =  115  Free Memory = 87327 MB
Rank =  116  Free Memory = 87327 MB
Rank =  117  Free Memory = 87327 MB
Rank =  118  Free Memory = 87327 MB
Rank =  119  Free Memory = 87327 MB
Rank =  120  Free Memory = 87327 MB
Rank =  121  Free Memory = 87327 MB
Rank =  122  Free Memory = 87327 MB
Rank =  123  Free Memory = 87327 MB
Rank =  124  Free Memory = 87327 MB
Rank =  125  Free Memory = 87327 MB
Rank =  126  Free Memory = 87327 MB
Rank =  127  Free Memory = 87327 MB
  Input file(s): opt_h2o_gs_gvptt_48dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_48dets_run001f.xml

  Project = H2O
  date    = 2023-05-14 15:43:30 PDT
  host    = n0022.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 18

  Range of prime numbers to use as seeds over processors and threads = 71-857


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.932486e-01    1         1  ON     0
     uu_1                 2.876171e-02    1         1  ON     1
     uu_2                -6.968869e-02    1         1  ON     2
     uu_3                -1.271982e-01    1         1  ON     3
     uu_4                -1.624019e-01    1         1  ON     4
     uu_5                -1.731305e-01    1         1  ON     5
     uu_6                -1.585900e-01    1         1  ON     6
     uu_7                -1.110782e-01    1         1  ON     7
     uu_8                -3.634125e-02    1         1  ON     8
     uu_9                 2.143639e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.553741e-01    1         1  ON     0
     ud_1                 9.353829e-02    1         1  ON     1
     ud_2                -1.941920e-02    1         1  ON     2
     ud_3                -8.085652e-02    1         1  ON     3
     ud_4                -1.285622e-01    1         1  ON     4
     ud_5                -1.623164e-01    1         1  ON     5
     ud_6                -1.719113e-01    1         1  ON     6
     ud_7                -1.451569e-01    1         1  ON     7
     ud_8                -9.344509e-02    1         1  ON     8
     ud_9                 4.270027e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.023949e-01    1         1  ON     0
     eO_1                -5.750486e-01    1         1  ON     1
     eO_2                -1.550335e-01    1         1  ON     2
     eO_3                 1.119659e-01    1         1  ON     3
     eO_4                 2.238030e-01    1         1  ON     4
     eO_5                 2.974370e-01    1         1  ON     5
     eO_6                 3.092104e-01    1         1  ON     6
     eO_7                 4.645352e-01    1         1  ON     7
     eO_8                 1.268489e-01    1         1  ON     8
     eO_9                 5.428770e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.142369e-01    1         1  ON     0
     eH1_1                -1.352238e-01    1         1  ON     1
     eH1_2                -9.252529e-02    1         1  ON     2
     eH1_3                -5.421423e-02    1         1  ON     3
     eH1_4                -7.659244e-03    1         1  ON     4
     eH1_5                 4.140180e-03    1         1  ON     5
     eH1_6                 4.926856e-02    1         1  ON     6
     eH1_7                 5.245259e-02    1         1  ON     7
     eH1_8                 2.208607e-01    1         1  ON     8
     eH1_9                 1.118297e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.089031e-01    1         1  ON     0
     eH2_1                -1.300880e-01    1         1  ON     1
     eH2_2                -8.741009e-02    1         1  ON     2
     eH2_3                -4.934167e-02    1         1  ON     3
     eH2_4                -3.210796e-03    1         1  ON     4
     eH2_5                 7.612977e-03    1         1  ON     5
     eH2_6                 4.784831e-02    1         1  ON     6
     eH2_7                 1.002682e-02    1         1  ON     7
     eH2_8                 2.462071e-01    1         1  ON     8
     eH2_9                 1.127408e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 48 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.689470e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 19 unique up determinants.
Found 19 unique down determinants.
Number of terms in pairs array: 18
Number of terms in pairs array: 18
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1008e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2289
    reference variance = 0.388301
====================================================
  Execution time = 3.0632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2910e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329106143082
                                         uncertainty =       0.005783768648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329106143082
                                         uncertainty =       0.005783768648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405646743
  error estimate for blocks of size 2^( 2) =       0.000415740162
  error estimate for blocks of size 2^( 3) =       0.000425248881
  error estimate for blocks of size 2^( 4) =       0.000432188288
  error estimate for blocks of size 2^( 5) =       0.000436708637
  error estimate for blocks of size 2^( 6) =       0.000438698381
  error estimate for blocks of size 2^( 7) =       0.000439614545

      target function =                  N/A
              le_mean =     -17.214755514166
             les_mean =     296.676905808132
             stat err =       0.000436802463
             autocorr =       1.159509122649
              std dev =       0.573671125435
             le_variance =       0.329098560158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721475551417e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214755514166       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214758840560       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214759824138       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214759435695       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214760676492       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214760382554       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214760513522       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214761436672       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214761235821       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214761258444       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.476244e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214755514166       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214756874047       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214757423910       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214757245030       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214757777656       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214757616344       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214757581237       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214757737201       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.630062e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214755514166       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214755918323       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214756104704       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214756057231       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214756226397       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214756168400       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214756153060       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214756174543       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.256826e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005851 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9096e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.933224e-01                 1 1 ON  0
uu_1  2.871456e-02                 1 1 ON  1
uu_2  -6.974547e-02                1 1 ON  2
uu_3  -1.271970e-01                1 1 ON  3
uu_4  -1.624629e-01                1 1 ON  4
uu_5  -1.731529e-01                1 1 ON  5
uu_6  -1.586258e-01                1 1 ON  6
uu_7  -1.110209e-01                1 1 ON  7
uu_8  -3.629494e-02                1 1 ON  8
uu_9  2.143497e-01                 1 1 ON  9
ud_0  3.556608e-01                 1 1 ON  10
ud_1  9.366857e-02                 1 1 ON  11
ud_2  -1.951887e-02                1 1 ON  12
ud_3  -8.107774e-02                1 1 ON  13
ud_4  -1.286717e-01                1 1 ON  14
ud_5  -1.623520e-01                1 1 ON  15
ud_6  -1.719182e-01                1 1 ON  16
ud_7  -1.451421e-01                1 1 ON  17
ud_8  -9.341193e-02                1 1 ON  18
ud_9  4.268293e-02                 1 1 ON  19
eO_0  -9.028579e-01                1 1 ON  20
eO_1  -5.752021e-01                1 1 ON  21
eO_2  -1.548479e-01                1 1 ON  22
eO_3  1.122536e-01                 1 1 ON  23
eO_4  2.239164e-01                 1 1 ON  24
eO_5  2.973987e-01                 1 1 ON  25
eO_6  3.092400e-01                 1 1 ON  26
eO_7  4.645315e-01                 1 1 ON  27
eO_8  1.268773e-01                 1 1 ON  28
eO_9  5.429692e-02                 1 1 ON  29
eH1_0 -2.142102e-01                1 1 ON  30
eH1_1 -1.352495e-01                1 1 ON  31
eH1_2 -9.258204e-02                1 1 ON  32
eH1_3 -5.422403e-02                1 1 ON  33
eH1_4 -7.696507e-03                1 1 ON  34
eH1_5 4.224049e-03                 1 1 ON  35
eH1_6 4.925203e-02                 1 1 ON  36
eH1_7 5.249074e-02                 1 1 ON  37
eH1_8 2.208479e-01                 1 1 ON  38
eH1_9 1.118323e-01                 1 1 ON  39
eH2_0 -2.090285e-01                1 1 ON  40
eH2_1 -1.301094e-01                1 1 ON  41
eH2_2 -8.741263e-02                1 1 ON  42
eH2_3 -4.927672e-02                1 1 ON  43
eH2_4 -3.235426e-03                1 1 ON  44
eH2_5 7.623124e-03                 1 1 ON  45
eH2_6 4.784893e-02                 1 1 ON  46
eH2_7 1.011894e-02                 1 1 ON  47
eH2_8 2.461980e-01                 1 1 ON  48
eH2_9 1.127502e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1649
    reference variance = 0.141323
====================================================
  Execution time = 3.0288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2702e-01
  Total weights = 2.0000e+06
  Execution time = 2.7087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326675935604
                                         uncertainty =       0.003652700621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326675935604
                                         uncertainty =       0.003652700621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404174723
  error estimate for blocks of size 2^( 2) =       0.000414230553
  error estimate for blocks of size 2^( 3) =       0.000422986129
  error estimate for blocks of size 2^( 4) =       0.000430005840
  error estimate for blocks of size 2^( 5) =       0.000433497875
  error estimate for blocks of size 2^( 6) =       0.000436648943
  error estimate for blocks of size 2^( 7) =       0.000438077073

      target function =                  N/A
              le_mean =     -17.215041764173
             les_mean =     296.684377192006
             stat err =       0.000434557432
             autocorr =       1.155995294023
              std dev =       0.571589374577
             le_variance =       0.326714413130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327489243812
                                         uncertainty =       0.003662539268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327489243812
                                         uncertainty =       0.003662539268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404677562
  error estimate for blocks of size 2^( 2) =       0.000414706256
  error estimate for blocks of size 2^( 3) =       0.000423431073
  error estimate for blocks of size 2^( 4) =       0.000430432134
  error estimate for blocks of size 2^( 5) =       0.000433907925
  error estimate for blocks of size 2^( 6) =       0.000437052930
  error estimate for blocks of size 2^( 7) =       0.000438475259

      target function =                  N/A
              le_mean =     -17.215043206025
             les_mean =     296.685240279243
             stat err =       0.000434967062
             autocorr =       1.155299255677
              std dev =       0.572300495993
             le_variance =       0.327527857714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327299338853
                                         uncertainty =       0.003659799650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327299338853
                                         uncertainty =       0.003659799650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404560200
  error estimate for blocks of size 2^( 2) =       0.000414594443
  error estimate for blocks of size 2^( 3) =       0.000423325992
  error estimate for blocks of size 2^( 4) =       0.000430331774
  error estimate for blocks of size 2^( 5) =       0.000433811396
  error estimate for blocks of size 2^( 6) =       0.000436958257
  error estimate for blocks of size 2^( 7) =       0.000438381162

      target function =                  N/A
              le_mean =     -17.215042703285
             les_mean =     296.685033022670
             stat err =       0.000434870647
             autocorr =       1.155457244739
              std dev =       0.572134521255
             le_variance =       0.327337910412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326765780994
                                         uncertainty =       0.003653698756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326765780994
                                         uncertainty =       0.003653698756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404230301
  error estimate for blocks of size 2^( 2) =       0.000414282889
  error estimate for blocks of size 2^( 3) =       0.000423034863
  error estimate for blocks of size 2^( 4) =       0.000430052495
  error estimate for blocks of size 2^( 5) =       0.000433542689
  error estimate for blocks of size 2^( 6) =       0.000436693165
  error estimate for blocks of size 2^( 7) =       0.000438120557

      target function =                  N/A
              le_mean =     -17.215041799572
             les_mean =     296.684468269409
             stat err =       0.000434602226
             autocorr =       1.155915705417
              std dev =       0.571667973395
             le_variance =       0.326804271806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215041764173        initial
     2.5000e-01     2.5000e+00             1.4762e-03       -17.215043206025  <--
     1.0000e+00     1.0000e+01             4.6301e-04       -17.215042703285
     4.0000e+00     4.0000e+01             1.2568e-04       -17.215041799572

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3929e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.934740e-01 1 1  ON 0
 uu_1                 2.865588e-02 1 1  ON 1
 uu_2                -6.982014e-02 1 1  ON 2
 uu_3                -1.272768e-01 1 1  ON 3
 uu_4                -1.626214e-01 1 1  ON 4
 uu_5                -1.732620e-01 1 1  ON 5
 uu_6                -1.587351e-01 1 1  ON 6
 uu_7                -1.108556e-01 1 1  ON 7
 uu_8                -3.615629e-02 1 1  ON 8
 uu_9                 2.143073e-01 1 1  ON 9
 ud_0                 3.561279e-01 1 1  ON 10
 ud_1                 9.388463e-02 1 1  ON 11
 ud_2                -1.963279e-02 1 1  ON 12
 ud_3                -8.144500e-02 1 1  ON 13
 ud_4                -1.289892e-01 1 1  ON 14
 ud_5                -1.624429e-01 1 1  ON 15
 ud_6                -1.719009e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330820e-02 1 1  ON 18
 ud_9                 4.263164e-02 1 1  ON 19
 eO_0                -9.038711e-01 1 1  ON 20
 eO_1                -5.756640e-01 1 1  ON 21
 eO_2                -1.546119e-01 1 1  ON 22
 eO_3                 1.129409e-01 1 1  ON 23
 eO_4                 2.243224e-01 1 1  ON 24
 eO_5                 2.973333e-01 1 1  ON 25
 eO_6                 3.093346e-01 1 1  ON 26
 eO_7                 4.645205e-01 1 1  ON 27
 eO_8                 1.269631e-01 1 1  ON 28
 eO_9                 5.432482e-02 1 1  ON 29
eH1_0                -2.141872e-01 1 1  ON 30
eH1_1                -1.353535e-01 1 1  ON 31
eH1_2                -9.269271e-02 1 1  ON 32
eH1_3                -5.425315e-02 1 1  ON 33
eH1_4                -7.785631e-03 1 1  ON 34
eH1_5                 4.443069e-03 1 1  ON 35
eH1_6                 4.922874e-02 1 1  ON 36
eH1_7                 5.261225e-02 1 1  ON 37
eH1_8                 2.208098e-01 1 1  ON 38
eH1_9                 1.118405e-01 1 1  ON 39
eH2_0                -2.093106e-01 1 1  ON 40
eH2_1                -1.301738e-01 1 1  ON 41
eH2_2                -8.743136e-02 1 1  ON 42
eH2_3                -4.921061e-02 1 1  ON 43
eH2_4                -3.289961e-03 1 1  ON 44
eH2_5                 7.657200e-03 1 1  ON 45
eH2_6                 4.786867e-02 1 1  ON 46
eH2_7                 1.039963e-02 1 1  ON 47
eH2_8                 2.461707e-01 1 1  ON 48
eH2_9                 1.127788e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1874
    reference variance = 0.185561
====================================================
  Execution time = 3.3054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326821643004
                                         uncertainty =       0.003783892267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326821643004
                                         uncertainty =       0.003783892267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404237093
  error estimate for blocks of size 2^( 2) =       0.000414276603
  error estimate for blocks of size 2^( 3) =       0.000423447779
  error estimate for blocks of size 2^( 4) =       0.000430435758
  error estimate for blocks of size 2^( 5) =       0.000433735160
  error estimate for blocks of size 2^( 6) =       0.000437144143
  error estimate for blocks of size 2^( 7) =       0.000438363087

      target function =                  N/A
              le_mean =     -17.214733273433
             les_mean =     296.673856766228
             stat err =       0.000434919537
             autocorr =       1.157565329171
              std dev =       0.571677578885
             le_variance =       0.326815254200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721473327343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214733273433       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214734210775       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214734840101       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214735056102       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214735304229       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214737354031       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214738255741       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214737790520       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214737549203       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214737978876       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214738647941       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214738184034       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.451417e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214733273433       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214733905015       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214734178757       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214734175763       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214734134922       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214735217397       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214735527114       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214735584440       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214735512167       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.266199e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214733273433       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214733547463       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214733624323       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214733586621       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214733493867       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214733857942       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214733916887       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214733982319       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.786100e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1526e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.933754e-01 1 1  ON 0
 uu_1                 2.851515e-02 1 1  ON 1
 uu_2                -7.002834e-02 1 1  ON 2
 uu_3                -1.274852e-01 1 1  ON 3
 uu_4                -1.628276e-01 1 1  ON 4
 uu_5                -1.730606e-01 1 1  ON 5
 uu_6                -1.583804e-01 1 1  ON 6
 uu_7                -1.106993e-01 1 1  ON 7
 uu_8                -3.613489e-02 1 1  ON 8
 uu_9                 2.142038e-01 1 1  ON 9
 ud_0                 3.565598e-01 1 1  ON 10
 ud_1                 9.424603e-02 1 1  ON 11
 ud_2                -1.977826e-02 1 1  ON 12
 ud_3                -8.172855e-02 1 1  ON 13
 ud_4                -1.294702e-01 1 1  ON 14
 ud_5                -1.627833e-01 1 1  ON 15
 ud_6                -1.717297e-01 1 1  ON 16
 ud_7                -1.449728e-01 1 1  ON 17
 ud_8                -9.324292e-02 1 1  ON 18
 ud_9                 4.257698e-02 1 1  ON 19
 eO_0                -9.051373e-01 1 1  ON 20
 eO_1                -5.764105e-01 1 1  ON 21
 eO_2                -1.543321e-01 1 1  ON 22
 eO_3                 1.137774e-01 1 1  ON 23
 eO_4                 2.248714e-01 1 1  ON 24
 eO_5                 2.974692e-01 1 1  ON 25
 eO_6                 3.094760e-01 1 1  ON 26
 eO_7                 4.644597e-01 1 1  ON 27
 eO_8                 1.270360e-01 1 1  ON 28
 eO_9                 5.434949e-02 1 1  ON 29
eH1_0                -2.142429e-01 1 1  ON 30
eH1_1                -1.352718e-01 1 1  ON 31
eH1_2                -9.250914e-02 1 1  ON 32
eH1_3                -5.418926e-02 1 1  ON 33
eH1_4                -7.968670e-03 1 1  ON 34
eH1_5                 4.461475e-03 1 1  ON 35
eH1_6                 4.911107e-02 1 1  ON 36
eH1_7                 5.260735e-02 1 1  ON 37
eH1_8                 2.207524e-01 1 1  ON 38
eH1_9                 1.118643e-01 1 1  ON 39
eH2_0                -2.093007e-01 1 1  ON 40
eH2_1                -1.303276e-01 1 1  ON 41
eH2_2                -8.738479e-02 1 1  ON 42
eH2_3                -4.941531e-02 1 1  ON 43
eH2_4                -3.307023e-03 1 1  ON 44
eH2_5                 7.707462e-03 1 1  ON 45
eH2_6                 4.772489e-02 1 1  ON 46
eH2_7                 1.082129e-02 1 1  ON 47
eH2_8                 2.461381e-01 1 1  ON 48
eH2_9                 1.127846e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2549
    reference variance = 0.513349
====================================================
  Execution time = 2.9922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.4075e-01
  Total weights = 2.0000e+06
  Execution time = 2.7478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340328634967
                                         uncertainty =       0.008977910759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340328634967
                                         uncertainty =       0.008977910759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412507417
  error estimate for blocks of size 2^( 2) =       0.000423012988
  error estimate for blocks of size 2^( 3) =       0.000431859072
  error estimate for blocks of size 2^( 4) =       0.000437978793
  error estimate for blocks of size 2^( 5) =       0.000441467362
  error estimate for blocks of size 2^( 6) =       0.000444148206
  error estimate for blocks of size 2^( 7) =       0.000446111543

      target function =                  N/A
              le_mean =     -17.215030425426
             les_mean =     296.697597115646
             stat err =       0.000442426476
             autocorr =       1.150320061715
              std dev =       0.583373583099
             le_variance =       0.340324737457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341238288162
                                         uncertainty =       0.008984138990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341238288162
                                         uncertainty =       0.008984138990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413058346
  error estimate for blocks of size 2^( 2) =       0.000423541340
  error estimate for blocks of size 2^( 3) =       0.000432355078
  error estimate for blocks of size 2^( 4) =       0.000438453033
  error estimate for blocks of size 2^( 5) =       0.000441931263
  error estimate for blocks of size 2^( 6) =       0.000444606062
  error estimate for blocks of size 2^( 7) =       0.000446549906

      target function =                  N/A
              le_mean =     -17.215029568138
             les_mean =     296.698477256301
             stat err =       0.000442885066
             autocorr =       1.149633122875
              std dev =       0.584152715513
             le_variance =       0.341234395041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341185681313
                                         uncertainty =       0.008983002734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341185681313
                                         uncertainty =       0.008983002734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413026466
  error estimate for blocks of size 2^( 2) =       0.000423508309
  error estimate for blocks of size 2^( 3) =       0.000432322176
  error estimate for blocks of size 2^( 4) =       0.000438422472
  error estimate for blocks of size 2^( 5) =       0.000441901321
  error estimate for blocks of size 2^( 6) =       0.000444576183
  error estimate for blocks of size 2^( 7) =       0.000446523943

      target function =                  N/A
              le_mean =     -17.215029043400
             les_mean =     296.698406517897
             stat err =       0.000442855980
             autocorr =       1.149659583687
              std dev =       0.584107629955
             le_variance =       0.341181723371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340470829295
                                         uncertainty =       0.008978660036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340470829295
                                         uncertainty =       0.008978660036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412593576
  error estimate for blocks of size 2^( 2) =       0.000423094341
  error estimate for blocks of size 2^( 3) =       0.000431934136
  error estimate for blocks of size 2^( 4) =       0.000438050506
  error estimate for blocks of size 2^( 5) =       0.000441537413
  error estimate for blocks of size 2^( 6) =       0.000444216854
  error estimate for blocks of size 2^( 7) =       0.000446178905

      target function =                  N/A
              le_mean =     -17.215029606919
             les_mean =     296.697711113974
             stat err =       0.000442495920
             autocorr =       1.150200674301
              std dev =       0.583495430232
             le_variance =       0.340466917102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215030425426        initial  <--
     6.2500e-02     6.2500e-01             3.4514e-03       -17.215029568138
     2.5000e-01     2.5000e+00             1.2662e-03       -17.215029043400
     1.0000e+00     1.0000e+01             3.7861e-04       -17.215029606919

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6825
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.934740e-01 1 1  ON 0
 uu_1                 2.865588e-02 1 1  ON 1
 uu_2                -6.982014e-02 1 1  ON 2
 uu_3                -1.272768e-01 1 1  ON 3
 uu_4                -1.626214e-01 1 1  ON 4
 uu_5                -1.732620e-01 1 1  ON 5
 uu_6                -1.587351e-01 1 1  ON 6
 uu_7                -1.108556e-01 1 1  ON 7
 uu_8                -3.615629e-02 1 1  ON 8
 uu_9                 2.143073e-01 1 1  ON 9
 ud_0                 3.561279e-01 1 1  ON 10
 ud_1                 9.388463e-02 1 1  ON 11
 ud_2                -1.963279e-02 1 1  ON 12
 ud_3                -8.144500e-02 1 1  ON 13
 ud_4                -1.289892e-01 1 1  ON 14
 ud_5                -1.624429e-01 1 1  ON 15
 ud_6                -1.719009e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330820e-02 1 1  ON 18
 ud_9                 4.263164e-02 1 1  ON 19
 eO_0                -9.038711e-01 1 1  ON 20
 eO_1                -5.756640e-01 1 1  ON 21
 eO_2                -1.546119e-01 1 1  ON 22
 eO_3                 1.129409e-01 1 1  ON 23
 eO_4                 2.243224e-01 1 1  ON 24
 eO_5                 2.973333e-01 1 1  ON 25
 eO_6                 3.093346e-01 1 1  ON 26
 eO_7                 4.645205e-01 1 1  ON 27
 eO_8                 1.269631e-01 1 1  ON 28
 eO_9                 5.432482e-02 1 1  ON 29
eH1_0                -2.141872e-01 1 1  ON 30
eH1_1                -1.353535e-01 1 1  ON 31
eH1_2                -9.269271e-02 1 1  ON 32
eH1_3                -5.425315e-02 1 1  ON 33
eH1_4                -7.785631e-03 1 1  ON 34
eH1_5                 4.443069e-03 1 1  ON 35
eH1_6                 4.922874e-02 1 1  ON 36
eH1_7                 5.261225e-02 1 1  ON 37
eH1_8                 2.208098e-01 1 1  ON 38
eH1_9                 1.118405e-01 1 1  ON 39
eH2_0                -2.093106e-01 1 1  ON 40
eH2_1                -1.301738e-01 1 1  ON 41
eH2_2                -8.743136e-02 1 1  ON 42
eH2_3                -4.921061e-02 1 1  ON 43
eH2_4                -3.289961e-03 1 1  ON 44
eH2_5                 7.657200e-03 1 1  ON 45
eH2_6                 4.786867e-02 1 1  ON 46
eH2_7                 1.039963e-02 1 1  ON 47
eH2_8                 2.461707e-01 1 1  ON 48
eH2_9                 1.127788e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1993
    reference variance = 0.220271
====================================================
  Execution time = 3.0365e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331202707232
                                         uncertainty =       0.004771410402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331202707232
                                         uncertainty =       0.004771410402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406860792
  error estimate for blocks of size 2^( 2) =       0.000416990075
  error estimate for blocks of size 2^( 3) =       0.000426082959
  error estimate for blocks of size 2^( 4) =       0.000432629148
  error estimate for blocks of size 2^( 5) =       0.000437745983
  error estimate for blocks of size 2^( 6) =       0.000440479745
  error estimate for blocks of size 2^( 7) =       0.000441713992

      target function =                  N/A
              le_mean =     -17.214422173702
             les_mean =     296.667402017587
             stat err =       0.000438142217
             autocorr =       1.159680948290
              std dev =       0.575388050513
             le_variance =       0.331071408673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721442217370e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214422173702       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214422823486       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214423101894       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214423801453       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214425043178       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214424877884       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214424860906       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214424742357       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214424758535       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.164592e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214422173702       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214422377339       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214422457968       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214422641487       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214423021690       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214422983442       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214422967455       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214422960494       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.378636e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214422173702       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214422228057       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214422249490       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214422295058       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214422394012       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214422385895       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214422381956       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.419760e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8867e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.934242e-01 1 1  ON 0
 uu_1                 2.869538e-02 1 1  ON 1
 uu_2                -6.980808e-02 1 1  ON 2
 uu_3                -1.272648e-01 1 1  ON 3
 uu_4                -1.626204e-01 1 1  ON 4
 uu_5                -1.732751e-01 1 1  ON 5
 uu_6                -1.587268e-01 1 1  ON 6
 uu_7                -1.108727e-01 1 1  ON 7
 uu_8                -3.615549e-02 1 1  ON 8
 uu_9                 2.142964e-01 1 1  ON 9
 ud_0                 3.562084e-01 1 1  ON 10
 ud_1                 9.390931e-02 1 1  ON 11
 ud_2                -1.965220e-02 1 1  ON 12
 ud_3                -8.148027e-02 1 1  ON 13
 ud_4                -1.290059e-01 1 1  ON 14
 ud_5                -1.624332e-01 1 1  ON 15
 ud_6                -1.718983e-01 1 1  ON 16
 ud_7                -1.451108e-01 1 1  ON 17
 ud_8                -9.332582e-02 1 1  ON 18
 ud_9                 4.261867e-02 1 1  ON 19
 eO_0                -9.040090e-01 1 1  ON 20
 eO_1                -5.757540e-01 1 1  ON 21
 eO_2                -1.545709e-01 1 1  ON 22
 eO_3                 1.130430e-01 1 1  ON 23
 eO_4                 2.244094e-01 1 1  ON 24
 eO_5                 2.973327e-01 1 1  ON 25
 eO_6                 3.093352e-01 1 1  ON 26
 eO_7                 4.645078e-01 1 1  ON 27
 eO_8                 1.269686e-01 1 1  ON 28
 eO_9                 5.432733e-02 1 1  ON 29
eH1_0                -2.142137e-01 1 1  ON 30
eH1_1                -1.353310e-01 1 1  ON 31
eH1_2                -9.262830e-02 1 1  ON 32
eH1_3                -5.429069e-02 1 1  ON 33
eH1_4                -7.762830e-03 1 1  ON 34
eH1_5                 4.449312e-03 1 1  ON 35
eH1_6                 4.919494e-02 1 1  ON 36
eH1_7                 5.259865e-02 1 1  ON 37
eH1_8                 2.207979e-01 1 1  ON 38
eH1_9                 1.118447e-01 1 1  ON 39
eH2_0                -2.093100e-01 1 1  ON 40
eH2_1                -1.302028e-01 1 1  ON 41
eH2_2                -8.741029e-02 1 1  ON 42
eH2_3                -4.921082e-02 1 1  ON 43
eH2_4                -3.306538e-03 1 1  ON 44
eH2_5                 7.644830e-03 1 1  ON 45
eH2_6                 4.786230e-02 1 1  ON 46
eH2_7                 1.044980e-02 1 1  ON 47
eH2_8                 2.461625e-01 1 1  ON 48
eH2_9                 1.127774e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2641
    reference variance = 0.145458
====================================================
  Execution time = 2.9747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3213e-01
  Total weights = 2.0000e+06
  Execution time = 2.7515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332135500618
                                         uncertainty =       0.005727457685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332135500618
                                         uncertainty =       0.005727457685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407473328
  error estimate for blocks of size 2^( 2) =       0.000417272333
  error estimate for blocks of size 2^( 3) =       0.000426025941
  error estimate for blocks of size 2^( 4) =       0.000432417655
  error estimate for blocks of size 2^( 5) =       0.000436338667
  error estimate for blocks of size 2^( 6) =       0.000440660169
  error estimate for blocks of size 2^( 7) =       0.000442389461

      target function =                  N/A
              le_mean =     -17.214578846380
             les_mean =     296.673793718567
             stat err =       0.000437951488
             autocorr =       1.155190580272
              std dev =       0.576254307042
             le_variance =       0.332069026385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332309743497
                                         uncertainty =       0.005732592368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332309743497
                                         uncertainty =       0.005732592368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407580139
  error estimate for blocks of size 2^( 2) =       0.000417372036
  error estimate for blocks of size 2^( 3) =       0.000426121149
  error estimate for blocks of size 2^( 4) =       0.000432508850
  error estimate for blocks of size 2^( 5) =       0.000436428145
  error estimate for blocks of size 2^( 6) =       0.000440748780
  error estimate for blocks of size 2^( 7) =       0.000442479269

      target function =                  N/A
              le_mean =     -17.214577914211
             les_mean =     296.673935737084
             stat err =       0.000438041261
             autocorr =       1.155058593708
              std dev =       0.576405359761
             le_variance =       0.332243138761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332252670527
                                         uncertainty =       0.005730744421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332252670527
                                         uncertainty =       0.005730744421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407545154
  error estimate for blocks of size 2^( 2) =       0.000417339229
  error estimate for blocks of size 2^( 3) =       0.000426089918
  error estimate for blocks of size 2^( 4) =       0.000432478933
  error estimate for blocks of size 2^( 5) =       0.000436398821
  error estimate for blocks of size 2^( 6) =       0.000440719812
  error estimate for blocks of size 2^( 7) =       0.000442449660

      target function =                  N/A
              le_mean =     -17.214578243487
             les_mean =     296.673890039827
             stat err =       0.000438011807
             autocorr =       1.155101552207
              std dev =       0.576355883802
             le_variance =       0.332186104793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332152128368
                                         uncertainty =       0.005727919305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332152128368
                                         uncertainty =       0.005727919305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407483521
  error estimate for blocks of size 2^( 2) =       0.000417281816
  error estimate for blocks of size 2^( 3) =       0.000426035009
  error estimate for blocks of size 2^( 4) =       0.000432426344
  error estimate for blocks of size 2^( 5) =       0.000436347190
  error estimate for blocks of size 2^( 6) =       0.000440668653
  error estimate for blocks of size 2^( 7) =       0.000442397991

      target function =                  N/A
              le_mean =     -17.214578751361
             les_mean =     296.673807061290
             stat err =       0.000437960045
             autocorr =       1.155177925280
              std dev =       0.576268722482
             le_variance =       0.332085640511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214578846380        initial  <--
     6.2500e-01     6.2500e+00             5.1646e-04       -17.214577914211
     2.5000e+00     2.5000e+01             1.3786e-04       -17.214578243487
     1.0000e+01     1.0000e+02             3.4198e-05       -17.214578751361

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5195
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.934740e-01 1 1  ON 0
 uu_1                 2.865588e-02 1 1  ON 1
 uu_2                -6.982014e-02 1 1  ON 2
 uu_3                -1.272768e-01 1 1  ON 3
 uu_4                -1.626214e-01 1 1  ON 4
 uu_5                -1.732620e-01 1 1  ON 5
 uu_6                -1.587351e-01 1 1  ON 6
 uu_7                -1.108556e-01 1 1  ON 7
 uu_8                -3.615629e-02 1 1  ON 8
 uu_9                 2.143073e-01 1 1  ON 9
 ud_0                 3.561279e-01 1 1  ON 10
 ud_1                 9.388463e-02 1 1  ON 11
 ud_2                -1.963279e-02 1 1  ON 12
 ud_3                -8.144500e-02 1 1  ON 13
 ud_4                -1.289892e-01 1 1  ON 14
 ud_5                -1.624429e-01 1 1  ON 15
 ud_6                -1.719009e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330820e-02 1 1  ON 18
 ud_9                 4.263164e-02 1 1  ON 19
 eO_0                -9.038711e-01 1 1  ON 20
 eO_1                -5.756640e-01 1 1  ON 21
 eO_2                -1.546119e-01 1 1  ON 22
 eO_3                 1.129409e-01 1 1  ON 23
 eO_4                 2.243224e-01 1 1  ON 24
 eO_5                 2.973333e-01 1 1  ON 25
 eO_6                 3.093346e-01 1 1  ON 26
 eO_7                 4.645205e-01 1 1  ON 27
 eO_8                 1.269631e-01 1 1  ON 28
 eO_9                 5.432482e-02 1 1  ON 29
eH1_0                -2.141872e-01 1 1  ON 30
eH1_1                -1.353535e-01 1 1  ON 31
eH1_2                -9.269271e-02 1 1  ON 32
eH1_3                -5.425315e-02 1 1  ON 33
eH1_4                -7.785631e-03 1 1  ON 34
eH1_5                 4.443069e-03 1 1  ON 35
eH1_6                 4.922874e-02 1 1  ON 36
eH1_7                 5.261225e-02 1 1  ON 37
eH1_8                 2.208098e-01 1 1  ON 38
eH1_9                 1.118405e-01 1 1  ON 39
eH2_0                -2.093106e-01 1 1  ON 40
eH2_1                -1.301738e-01 1 1  ON 41
eH2_2                -8.743136e-02 1 1  ON 42
eH2_3                -4.921061e-02 1 1  ON 43
eH2_4                -3.289961e-03 1 1  ON 44
eH2_5                 7.657200e-03 1 1  ON 45
eH2_6                 4.786867e-02 1 1  ON 46
eH2_7                 1.039963e-02 1 1  ON 47
eH2_8                 2.461707e-01 1 1  ON 48
eH2_9                 1.127788e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2392e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.155901
====================================================
  Execution time = 3.0255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.4576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345853601293
                                         uncertainty =       0.021956843495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345853601293
                                         uncertainty =       0.021956843495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415787956
  error estimate for blocks of size 2^( 2) =       0.000425834195
  error estimate for blocks of size 2^( 3) =       0.000434633368
  error estimate for blocks of size 2^( 4) =       0.000441102498
  error estimate for blocks of size 2^( 5) =       0.000444408811
  error estimate for blocks of size 2^( 6) =       0.000447115608
  error estimate for blocks of size 2^( 7) =       0.000447965742

      target function =                  N/A
              le_mean =     -17.214686527649
             les_mean =     296.691191320384
             stat err =       0.000445148165
             autocorr =       1.146213094340
              std dev =       0.588012965884
             le_variance =       0.345759248048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721468652765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214686527649       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214686681959       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214686751143       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214686817632       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214686903347       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214686912343       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214686877354       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.089276e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214686527649       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214686568006       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214686586198       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214686603401       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214686625749       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214686627216       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214686619158       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.540641e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214686527649       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214686537856       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214686542464       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214686546804       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214686552453       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214686552771       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214686550798       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 3.863278e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8822e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.934746e-01 1 1  ON 0
 uu_1                 2.865669e-02 1 1  ON 1
 uu_2                -6.982095e-02 1 1  ON 2
 uu_3                -1.272780e-01 1 1  ON 3
 uu_4                -1.626231e-01 1 1  ON 4
 uu_5                -1.732654e-01 1 1  ON 5
 uu_6                -1.587339e-01 1 1  ON 6
 uu_7                -1.108524e-01 1 1  ON 7
 uu_8                -3.615501e-02 1 1  ON 8
 uu_9                 2.143063e-01 1 1  ON 9
 ud_0                 3.561328e-01 1 1  ON 10
 ud_1                 9.389233e-02 1 1  ON 11
 ud_2                -1.963808e-02 1 1  ON 12
 ud_3                -8.144901e-02 1 1  ON 13
 ud_4                -1.289882e-01 1 1  ON 14
 ud_5                -1.624449e-01 1 1  ON 15
 ud_6                -1.719006e-01 1 1  ON 16
 ud_7                -1.450841e-01 1 1  ON 17
 ud_8                -9.330861e-02 1 1  ON 18
 ud_9                 4.263100e-02 1 1  ON 19
 eO_0                -9.038865e-01 1 1  ON 20
 eO_1                -5.756715e-01 1 1  ON 21
 eO_2                -1.546052e-01 1 1  ON 22
 eO_3                 1.129524e-01 1 1  ON 23
 eO_4                 2.243280e-01 1 1  ON 24
 eO_5                 2.973314e-01 1 1  ON 25
 eO_6                 3.093353e-01 1 1  ON 26
 eO_7                 4.645198e-01 1 1  ON 27
 eO_8                 1.269638e-01 1 1  ON 28
 eO_9                 5.432497e-02 1 1  ON 29
eH1_0                -2.141901e-01 1 1  ON 30
eH1_1                -1.353522e-01 1 1  ON 31
eH1_2                -9.268931e-02 1 1  ON 32
eH1_3                -5.425280e-02 1 1  ON 33
eH1_4                -7.784033e-03 1 1  ON 34
eH1_5                 4.440003e-03 1 1  ON 35
eH1_6                 4.922707e-02 1 1  ON 36
eH1_7                 5.261284e-02 1 1  ON 37
eH1_8                 2.208098e-01 1 1  ON 38
eH1_9                 1.118407e-01 1 1  ON 39
eH2_0                -2.093115e-01 1 1  ON 40
eH2_1                -1.301780e-01 1 1  ON 41
eH2_2                -8.742751e-02 1 1  ON 42
eH2_3                -4.921002e-02 1 1  ON 43
eH2_4                -3.288341e-03 1 1  ON 44
eH2_5                 7.656128e-03 1 1  ON 45
eH2_6                 4.786666e-02 1 1  ON 46
eH2_7                 1.040226e-02 1 1  ON 47
eH2_8                 2.461701e-01 1 1  ON 48
eH2_9                 1.127788e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2653
    reference variance = 0.151309
====================================================
  Execution time = 2.9806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2951e-01
  Total weights = 2.0000e+06
  Execution time = 2.7428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329552156110
                                         uncertainty =       0.003988174378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329552156110
                                         uncertainty =       0.003988174378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405897503
  error estimate for blocks of size 2^( 2) =       0.000416355811
  error estimate for blocks of size 2^( 3) =       0.000425435276
  error estimate for blocks of size 2^( 4) =       0.000432183401
  error estimate for blocks of size 2^( 5) =       0.000436343547
  error estimate for blocks of size 2^( 6) =       0.000437381548
  error estimate for blocks of size 2^( 7) =       0.000438898257

      target function =                  N/A
              le_mean =     -17.213773510085
             les_mean =     296.643503858005
             stat err =       0.000436201688
             autocorr =       1.154893466978
              std dev =       0.574025754013
             le_variance =       0.329505566270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329573235061
                                         uncertainty =       0.003988340221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329573235061
                                         uncertainty =       0.003988340221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405910481
  error estimate for blocks of size 2^( 2) =       0.000416367795
  error estimate for blocks of size 2^( 3) =       0.000425446411
  error estimate for blocks of size 2^( 4) =       0.000432193865
  error estimate for blocks of size 2^( 5) =       0.000436353901
  error estimate for blocks of size 2^( 6) =       0.000437391464
  error estimate for blocks of size 2^( 7) =       0.000438908497

      target function =                  N/A
              le_mean =     -17.213773443949
             les_mean =     296.643522652407
             stat err =       0.000436211932
             autocorr =       1.154873858134
              std dev =       0.574044107674
             le_variance =       0.329526637555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329562585625
                                         uncertainty =       0.003988252284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329562585625
                                         uncertainty =       0.003988252284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405903924
  error estimate for blocks of size 2^( 2) =       0.000416361723
  error estimate for blocks of size 2^( 3) =       0.000425440750
  error estimate for blocks of size 2^( 4) =       0.000432188529
  error estimate for blocks of size 2^( 5) =       0.000436348625
  error estimate for blocks of size 2^( 6) =       0.000437386408
  error estimate for blocks of size 2^( 7) =       0.000438903283

      target function =                  N/A
              le_mean =     -17.213773473588
             les_mean =     296.643513027038
             stat err =       0.000436206711
             autocorr =       1.154883523934
              std dev =       0.574034834987
             le_variance =       0.329515991779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553453881
                                         uncertainty =       0.003988183928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553453881
                                         uncertainty =       0.003988183928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405898302
  error estimate for blocks of size 2^( 2) =       0.000416356546
  error estimate for blocks of size 2^( 3) =       0.000425435955
  error estimate for blocks of size 2^( 4) =       0.000432184037
  error estimate for blocks of size 2^( 5) =       0.000436344177
  error estimate for blocks of size 2^( 6) =       0.000437382151
  error estimate for blocks of size 2^( 7) =       0.000438898881

      target function =                  N/A
              le_mean =     -17.213773505273
             les_mean =     296.643504989633
             stat err =       0.000436202311
             autocorr =       1.154892219873
              std dev =       0.574026883982
             le_variance =       0.329506863534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213773510085        initial  <--
     6.2500e+00     6.2500e+01             6.0893e-05       -17.213773443949
     2.5000e+01     2.5000e+02             1.5406e-05       -17.213773473588
     1.0000e+02     1.0000e+03             3.8633e-06       -17.213773505273

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5849
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.934740e-01 1 1  ON 0
 uu_1                 2.865588e-02 1 1  ON 1
 uu_2                -6.982014e-02 1 1  ON 2
 uu_3                -1.272768e-01 1 1  ON 3
 uu_4                -1.626214e-01 1 1  ON 4
 uu_5                -1.732620e-01 1 1  ON 5
 uu_6                -1.587351e-01 1 1  ON 6
 uu_7                -1.108556e-01 1 1  ON 7
 uu_8                -3.615629e-02 1 1  ON 8
 uu_9                 2.143073e-01 1 1  ON 9
 ud_0                 3.561279e-01 1 1  ON 10
 ud_1                 9.388463e-02 1 1  ON 11
 ud_2                -1.963279e-02 1 1  ON 12
 ud_3                -8.144500e-02 1 1  ON 13
 ud_4                -1.289892e-01 1 1  ON 14
 ud_5                -1.624429e-01 1 1  ON 15
 ud_6                -1.719009e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330820e-02 1 1  ON 18
 ud_9                 4.263164e-02 1 1  ON 19
 eO_0                -9.038711e-01 1 1  ON 20
 eO_1                -5.756640e-01 1 1  ON 21
 eO_2                -1.546119e-01 1 1  ON 22
 eO_3                 1.129409e-01 1 1  ON 23
 eO_4                 2.243224e-01 1 1  ON 24
 eO_5                 2.973333e-01 1 1  ON 25
 eO_6                 3.093346e-01 1 1  ON 26
 eO_7                 4.645205e-01 1 1  ON 27
 eO_8                 1.269631e-01 1 1  ON 28
 eO_9                 5.432482e-02 1 1  ON 29
eH1_0                -2.141872e-01 1 1  ON 30
eH1_1                -1.353535e-01 1 1  ON 31
eH1_2                -9.269271e-02 1 1  ON 32
eH1_3                -5.425315e-02 1 1  ON 33
eH1_4                -7.785631e-03 1 1  ON 34
eH1_5                 4.443069e-03 1 1  ON 35
eH1_6                 4.922874e-02 1 1  ON 36
eH1_7                 5.261225e-02 1 1  ON 37
eH1_8                 2.208098e-01 1 1  ON 38
eH1_9                 1.118405e-01 1 1  ON 39
eH2_0                -2.093106e-01 1 1  ON 40
eH2_1                -1.301738e-01 1 1  ON 41
eH2_2                -8.743136e-02 1 1  ON 42
eH2_3                -4.921061e-02 1 1  ON 43
eH2_4                -3.289961e-03 1 1  ON 44
eH2_5                 7.657200e-03 1 1  ON 45
eH2_6                 4.786867e-02 1 1  ON 46
eH2_7                 1.039963e-02 1 1  ON 47
eH2_8                 2.461707e-01 1 1  ON 48
eH2_9                 1.127788e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.230342
====================================================
  Execution time = 3.0189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3014e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330196690417
                                         uncertainty =       0.006983927395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330196690417
                                         uncertainty =       0.006983927395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406290107
  error estimate for blocks of size 2^( 2) =       0.000416355933
  error estimate for blocks of size 2^( 3) =       0.000425617965
  error estimate for blocks of size 2^( 4) =       0.000432519685
  error estimate for blocks of size 2^( 5) =       0.000436223462
  error estimate for blocks of size 2^( 6) =       0.000437551125
  error estimate for blocks of size 2^( 7) =       0.000436633372

      target function =                  N/A
              le_mean =     -17.214209127943
             les_mean =     296.659139038330
             stat err =       0.000435731911
             autocorr =       1.150181128107
              std dev =       0.574580980231
             le_variance =       0.330143302843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721420912794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214209127943       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214209128958       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214209129148       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214209138219       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214209153123       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214209148224       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214209143617       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.751756e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214209127943       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214209128197       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214209128244       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214209130512       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214209134247       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214209133025       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214209131874       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.438580e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214209127943       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214209128007       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214209128018       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214209128585       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214209129520       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214209129214       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214209128926       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 3.596848e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8624e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.934742e-01 1 1  ON 0
 uu_1                 2.865575e-02 1 1  ON 1
 uu_2                -6.982033e-02 1 1  ON 2
 uu_3                -1.272771e-01 1 1  ON 3
 uu_4                -1.626215e-01 1 1  ON 4
 uu_5                -1.732622e-01 1 1  ON 5
 uu_6                -1.587348e-01 1 1  ON 6
 uu_7                -1.108555e-01 1 1  ON 7
 uu_8                -3.615615e-02 1 1  ON 8
 uu_9                 2.143072e-01 1 1  ON 9
 ud_0                 3.561282e-01 1 1  ON 10
 ud_1                 9.388545e-02 1 1  ON 11
 ud_2                -1.963314e-02 1 1  ON 12
 ud_3                -8.144528e-02 1 1  ON 13
 ud_4                -1.289898e-01 1 1  ON 14
 ud_5                -1.624431e-01 1 1  ON 15
 ud_6                -1.719007e-01 1 1  ON 16
 ud_7                -1.450821e-01 1 1  ON 17
 ud_8                -9.330822e-02 1 1  ON 18
 ud_9                 4.263159e-02 1 1  ON 19
 eO_0                -9.038726e-01 1 1  ON 20
 eO_1                -5.756651e-01 1 1  ON 21
 eO_2                -1.546113e-01 1 1  ON 22
 eO_3                 1.129420e-01 1 1  ON 23
 eO_4                 2.243230e-01 1 1  ON 24
 eO_5                 2.973333e-01 1 1  ON 25
 eO_6                 3.093347e-01 1 1  ON 26
 eO_7                 4.645205e-01 1 1  ON 27
 eO_8                 1.269632e-01 1 1  ON 28
 eO_9                 5.432485e-02 1 1  ON 29
eH1_0                -2.141872e-01 1 1  ON 30
eH1_1                -1.353535e-01 1 1  ON 31
eH1_2                -9.269232e-02 1 1  ON 32
eH1_3                -5.425320e-02 1 1  ON 33
eH1_4                -7.785619e-03 1 1  ON 34
eH1_5                 4.443040e-03 1 1  ON 35
eH1_6                 4.922848e-02 1 1  ON 36
eH1_7                 5.261221e-02 1 1  ON 37
eH1_8                 2.208098e-01 1 1  ON 38
eH1_9                 1.118405e-01 1 1  ON 39
eH2_0                -2.093108e-01 1 1  ON 40
eH2_1                -1.301739e-01 1 1  ON 41
eH2_2                -8.743109e-02 1 1  ON 42
eH2_3                -4.921084e-02 1 1  ON 43
eH2_4                -3.290011e-03 1 1  ON 44
eH2_5                 7.657102e-03 1 1  ON 45
eH2_6                 4.786871e-02 1 1  ON 46
eH2_7                 1.040006e-02 1 1  ON 47
eH2_8                 2.461706e-01 1 1  ON 48
eH2_9                 1.127788e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.176567
====================================================
  Execution time = 2.9953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2225e-01
  Total weights = 2.0000e+06
  Execution time = 2.8146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322335927256
                                         uncertainty =       0.002862026393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322335927256
                                         uncertainty =       0.002862026393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400639
  error estimate for blocks of size 2^( 2) =       0.000411380422
  error estimate for blocks of size 2^( 3) =       0.000420383503
  error estimate for blocks of size 2^( 4) =       0.000427780338
  error estimate for blocks of size 2^( 5) =       0.000431356981
  error estimate for blocks of size 2^( 6) =       0.000432160597
  error estimate for blocks of size 2^( 7) =       0.000432710624

      target function =                  N/A
              le_mean =     -17.213718200300
             les_mean =     296.634339063877
             stat err =       0.000431002135
             autocorr =       1.152929426376
              std dev =       0.567666227349
             le_variance =       0.322244945673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322337095128
                                         uncertainty =       0.002862035173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322337095128
                                         uncertainty =       0.002862035173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401401366
  error estimate for blocks of size 2^( 2) =       0.000411381098
  error estimate for blocks of size 2^( 3) =       0.000420384092
  error estimate for blocks of size 2^( 4) =       0.000427780890
  error estimate for blocks of size 2^( 5) =       0.000431357514
  error estimate for blocks of size 2^( 6) =       0.000432161120
  error estimate for blocks of size 2^( 7) =       0.000432711089

      target function =                  N/A
              le_mean =     -17.213718209059
             les_mean =     296.634340532579
             stat err =       0.000431002653
             autocorr =       1.152928024431
              std dev =       0.567667255356
             le_variance =       0.322246112804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322336508365
                                         uncertainty =       0.002862030746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322336508365
                                         uncertainty =       0.002862030746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401401001
  error estimate for blocks of size 2^( 2) =       0.000411380758
  error estimate for blocks of size 2^( 3) =       0.000420383796
  error estimate for blocks of size 2^( 4) =       0.000427780612
  error estimate for blocks of size 2^( 5) =       0.000431357246
  error estimate for blocks of size 2^( 6) =       0.000432160856
  error estimate for blocks of size 2^( 7) =       0.000432710854

      target function =                  N/A
              le_mean =     -17.213718204706
             les_mean =     296.634339796319
             stat err =       0.000431002392
             autocorr =       1.152928725459
              std dev =       0.567666738862
             le_variance =       0.322245526411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322335999798
                                         uncertainty =       0.002862026936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322335999798
                                         uncertainty =       0.002862026936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400684
  error estimate for blocks of size 2^( 2) =       0.000411380464
  error estimate for blocks of size 2^( 3) =       0.000420383540
  error estimate for blocks of size 2^( 4) =       0.000427780372
  error estimate for blocks of size 2^( 5) =       0.000431357014
  error estimate for blocks of size 2^( 6) =       0.000432160629
  error estimate for blocks of size 2^( 7) =       0.000432710652

      target function =                  N/A
              le_mean =     -17.213718200850
             les_mean =     296.634339155332
             stat err =       0.000431002167
             autocorr =       1.152929338757
              std dev =       0.567666291202
             le_variance =       0.322245018167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213718200300        initial
     6.2500e+01     6.2500e+02             5.7518e-06       -17.213718209059  <--
     2.5000e+02     2.5000e+03             1.4386e-06       -17.213718204706
     1.0000e+03     1.0000e+04             3.5968e-07       -17.213718200850

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.6188e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.934747e-01 1 1  ON 0
 uu_1                 2.865537e-02 1 1  ON 1
 uu_2                -6.982087e-02 1 1  ON 2
 uu_3                -1.272780e-01 1 1  ON 3
 uu_4                -1.626218e-01 1 1  ON 4
 uu_5                -1.732628e-01 1 1  ON 5
 uu_6                -1.587339e-01 1 1  ON 6
 uu_7                -1.108550e-01 1 1  ON 7
 uu_8                -3.615573e-02 1 1  ON 8
 uu_9                 2.143069e-01 1 1  ON 9
 ud_0                 3.561292e-01 1 1  ON 10
 ud_1                 9.388791e-02 1 1  ON 11
 ud_2                -1.963420e-02 1 1  ON 12
 ud_3                -8.144615e-02 1 1  ON 13
 ud_4                -1.289914e-01 1 1  ON 14
 ud_5                -1.624437e-01 1 1  ON 15
 ud_6                -1.719001e-01 1 1  ON 16
 ud_7                -1.450824e-01 1 1  ON 17
 ud_8                -9.330829e-02 1 1  ON 18
 ud_9                 4.263146e-02 1 1  ON 19
 eO_0                -9.038769e-01 1 1  ON 20
 eO_1                -5.756682e-01 1 1  ON 21
 eO_2                -1.546094e-01 1 1  ON 22
 eO_3                 1.129452e-01 1 1  ON 23
 eO_4                 2.243247e-01 1 1  ON 24
 eO_5                 2.973333e-01 1 1  ON 25
 eO_6                 3.093349e-01 1 1  ON 26
 eO_7                 4.645204e-01 1 1  ON 27
 eO_8                 1.269635e-01 1 1  ON 28
 eO_9                 5.432497e-02 1 1  ON 29
eH1_0                -2.141873e-01 1 1  ON 30
eH1_1                -1.353534e-01 1 1  ON 31
eH1_2                -9.269116e-02 1 1  ON 32
eH1_3                -5.425335e-02 1 1  ON 33
eH1_4                -7.785584e-03 1 1  ON 34
eH1_5                 4.442952e-03 1 1  ON 35
eH1_6                 4.922769e-02 1 1  ON 36
eH1_7                 5.261209e-02 1 1  ON 37
eH1_8                 2.208096e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093117e-01 1 1  ON 40
eH2_1                -1.301743e-01 1 1  ON 41
eH2_2                -8.743031e-02 1 1  ON 42
eH2_3                -4.921152e-02 1 1  ON 43
eH2_4                -3.290164e-03 1 1  ON 44
eH2_5                 7.656809e-03 1 1  ON 45
eH2_6                 4.786884e-02 1 1  ON 46
eH2_7                 1.040136e-02 1 1  ON 47
eH2_8                 2.461705e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.190017
====================================================
  Execution time = 3.0315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2869e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328731427619
                                         uncertainty =       0.008006107265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328731427619
                                         uncertainty =       0.008006107265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405395722
  error estimate for blocks of size 2^( 2) =       0.000415674389
  error estimate for blocks of size 2^( 3) =       0.000424666680
  error estimate for blocks of size 2^( 4) =       0.000431562403
  error estimate for blocks of size 2^( 5) =       0.000436780132
  error estimate for blocks of size 2^( 6) =       0.000438457098
  error estimate for blocks of size 2^( 7) =       0.000438883644

      target function =                  N/A
              le_mean =     -17.214716227766
             les_mean =     296.675146021572
             stat err =       0.000436420819
             autocorr =       1.158917701779
              std dev =       0.573316128673
             le_variance =       0.328691383397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721471622777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214716227766       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214716249181       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214716288910       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214716295074       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214716282334       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214716272881       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214716278861       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.149256e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214716227766       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214716233212       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214716243346       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214716245011       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214716242071       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214716239565       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214716241015       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.395775e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214716227766       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214716229134       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214716231680       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214716232104       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214716231386       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214716230750       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214716231110       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.350366e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8802e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.934745e-01 1 1  ON 0
 uu_1                 2.865520e-02 1 1  ON 1
 uu_2                -6.982172e-02 1 1  ON 2
 uu_3                -1.272778e-01 1 1  ON 3
 uu_4                -1.626222e-01 1 1  ON 4
 uu_5                -1.732637e-01 1 1  ON 5
 uu_6                -1.587335e-01 1 1  ON 6
 uu_7                -1.108543e-01 1 1  ON 7
 uu_8                -3.615497e-02 1 1  ON 8
 uu_9                 2.143067e-01 1 1  ON 9
 ud_0                 3.561326e-01 1 1  ON 10
 ud_1                 9.388902e-02 1 1  ON 11
 ud_2                -1.963581e-02 1 1  ON 12
 ud_3                -8.144726e-02 1 1  ON 13
 ud_4                -1.289933e-01 1 1  ON 14
 ud_5                -1.624450e-01 1 1  ON 15
 ud_6                -1.718999e-01 1 1  ON 16
 ud_7                -1.450824e-01 1 1  ON 17
 ud_8                -9.330761e-02 1 1  ON 18
 ud_9                 4.263139e-02 1 1  ON 19
 eO_0                -9.038823e-01 1 1  ON 20
 eO_1                -5.756709e-01 1 1  ON 21
 eO_2                -1.546079e-01 1 1  ON 22
 eO_3                 1.129486e-01 1 1  ON 23
 eO_4                 2.243265e-01 1 1  ON 24
 eO_5                 2.973337e-01 1 1  ON 25
 eO_6                 3.093355e-01 1 1  ON 26
 eO_7                 4.645202e-01 1 1  ON 27
 eO_8                 1.269639e-01 1 1  ON 28
 eO_9                 5.432510e-02 1 1  ON 29
eH1_0                -2.141877e-01 1 1  ON 30
eH1_1                -1.353551e-01 1 1  ON 31
eH1_2                -9.268992e-02 1 1  ON 32
eH1_3                -5.425489e-02 1 1  ON 33
eH1_4                -7.785935e-03 1 1  ON 34
eH1_5                 4.445072e-03 1 1  ON 35
eH1_6                 4.922744e-02 1 1  ON 36
eH1_7                 5.261265e-02 1 1  ON 37
eH1_8                 2.208095e-01 1 1  ON 38
eH1_9                 1.118407e-01 1 1  ON 39
eH2_0                -2.093116e-01 1 1  ON 40
eH2_1                -1.301726e-01 1 1  ON 41
eH2_2                -8.743003e-02 1 1  ON 42
eH2_3                -4.921176e-02 1 1  ON 43
eH2_4                -3.292419e-03 1 1  ON 44
eH2_5                 7.655196e-03 1 1  ON 45
eH2_6                 4.786944e-02 1 1  ON 46
eH2_7                 1.040289e-02 1 1  ON 47
eH2_8                 2.461702e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.252
    reference variance = 0.354482
====================================================
  Execution time = 2.9917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3290e-01
  Total weights = 2.0000e+06
  Execution time = 2.7522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332973939974
                                         uncertainty =       0.011350216023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332973939974
                                         uncertainty =       0.011350216023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407979239
  error estimate for blocks of size 2^( 2) =       0.000417946416
  error estimate for blocks of size 2^( 3) =       0.000427313140
  error estimate for blocks of size 2^( 4) =       0.000433723090
  error estimate for blocks of size 2^( 5) =       0.000437666172
  error estimate for blocks of size 2^( 6) =       0.000440043174
  error estimate for blocks of size 2^( 7) =       0.000439935384

      target function =                  N/A
              le_mean =     -17.213649463058
             les_mean =     296.642621788800
             stat err =       0.000437841955
             autocorr =       1.151751065415
              std dev =       0.576969772363
             le_variance =       0.332894118221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332988830574
                                         uncertainty =       0.011350473799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332988830574
                                         uncertainty =       0.011350473799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407988363
  error estimate for blocks of size 2^( 2) =       0.000417955046
  error estimate for blocks of size 2^( 3) =       0.000427321290
  error estimate for blocks of size 2^( 4) =       0.000433730924
  error estimate for blocks of size 2^( 5) =       0.000437673705
  error estimate for blocks of size 2^( 6) =       0.000440050755
  error estimate for blocks of size 2^( 7) =       0.000439942407

      target function =                  N/A
              le_mean =     -17.213649409057
             les_mean =     296.642634820459
             stat err =       0.000437849448
             autocorr =       1.151738966089
              std dev =       0.576982676506
             le_variance =       0.332909008988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332981491248
                                         uncertainty =       0.011350345752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332981491248
                                         uncertainty =       0.011350345752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407983866
  error estimate for blocks of size 2^( 2) =       0.000417950792
  error estimate for blocks of size 2^( 3) =       0.000427317272
  error estimate for blocks of size 2^( 4) =       0.000433727063
  error estimate for blocks of size 2^( 5) =       0.000437669992
  error estimate for blocks of size 2^( 6) =       0.000440047019
  error estimate for blocks of size 2^( 7) =       0.000439938946

      target function =                  N/A
              le_mean =     -17.213649435103
             les_mean =     296.642628377782
             stat err =       0.000437845755
             autocorr =       1.151744930435
              std dev =       0.576976316333
             le_variance =       0.332901669609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332974887181
                                         uncertainty =       0.011350232263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332974887181
                                         uncertainty =       0.011350232263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407979819
  error estimate for blocks of size 2^( 2) =       0.000417946965
  error estimate for blocks of size 2^( 3) =       0.000427313659
  error estimate for blocks of size 2^( 4) =       0.000433723588
  error estimate for blocks of size 2^( 5) =       0.000437666652
  error estimate for blocks of size 2^( 6) =       0.000440043656
  error estimate for blocks of size 2^( 7) =       0.000439935831

      target function =                  N/A
              le_mean =     -17.213649459521
             les_mean =     296.642622614248
             stat err =       0.000437842432
             autocorr =       1.151750295769
              std dev =       0.576970593222
             le_variance =       0.332895065443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213649463058        initial  <--
     1.5625e+01     1.5625e+02             2.1493e-05       -17.213649409057
     6.2500e+01     6.2500e+02             5.3958e-06       -17.213649435103
     2.5000e+02     2.5000e+03             1.3504e-06       -17.213649459521

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7251
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.934747e-01 1 1  ON 0
 uu_1                 2.865537e-02 1 1  ON 1
 uu_2                -6.982087e-02 1 1  ON 2
 uu_3                -1.272780e-01 1 1  ON 3
 uu_4                -1.626218e-01 1 1  ON 4
 uu_5                -1.732628e-01 1 1  ON 5
 uu_6                -1.587339e-01 1 1  ON 6
 uu_7                -1.108550e-01 1 1  ON 7
 uu_8                -3.615573e-02 1 1  ON 8
 uu_9                 2.143069e-01 1 1  ON 9
 ud_0                 3.561292e-01 1 1  ON 10
 ud_1                 9.388791e-02 1 1  ON 11
 ud_2                -1.963420e-02 1 1  ON 12
 ud_3                -8.144615e-02 1 1  ON 13
 ud_4                -1.289914e-01 1 1  ON 14
 ud_5                -1.624437e-01 1 1  ON 15
 ud_6                -1.719001e-01 1 1  ON 16
 ud_7                -1.450824e-01 1 1  ON 17
 ud_8                -9.330829e-02 1 1  ON 18
 ud_9                 4.263146e-02 1 1  ON 19
 eO_0                -9.038769e-01 1 1  ON 20
 eO_1                -5.756682e-01 1 1  ON 21
 eO_2                -1.546094e-01 1 1  ON 22
 eO_3                 1.129452e-01 1 1  ON 23
 eO_4                 2.243247e-01 1 1  ON 24
 eO_5                 2.973333e-01 1 1  ON 25
 eO_6                 3.093349e-01 1 1  ON 26
 eO_7                 4.645204e-01 1 1  ON 27
 eO_8                 1.269635e-01 1 1  ON 28
 eO_9                 5.432497e-02 1 1  ON 29
eH1_0                -2.141873e-01 1 1  ON 30
eH1_1                -1.353534e-01 1 1  ON 31
eH1_2                -9.269116e-02 1 1  ON 32
eH1_3                -5.425335e-02 1 1  ON 33
eH1_4                -7.785584e-03 1 1  ON 34
eH1_5                 4.442952e-03 1 1  ON 35
eH1_6                 4.922769e-02 1 1  ON 36
eH1_7                 5.261209e-02 1 1  ON 37
eH1_8                 2.208096e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093117e-01 1 1  ON 40
eH2_1                -1.301743e-01 1 1  ON 41
eH2_2                -8.743031e-02 1 1  ON 42
eH2_3                -4.921152e-02 1 1  ON 43
eH2_4                -3.290164e-03 1 1  ON 44
eH2_5                 7.656809e-03 1 1  ON 45
eH2_6                 4.786884e-02 1 1  ON 46
eH2_7                 1.040136e-02 1 1  ON 47
eH2_8                 2.461705e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2533e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.233
    reference variance = 0.617376
====================================================
  Execution time = 3.0560e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3186e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331915802227
                                         uncertainty =       0.005843044053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331915802227
                                         uncertainty =       0.005843044053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407343777
  error estimate for blocks of size 2^( 2) =       0.000417063034
  error estimate for blocks of size 2^( 3) =       0.000426130294
  error estimate for blocks of size 2^( 4) =       0.000432774331
  error estimate for blocks of size 2^( 5) =       0.000435692740
  error estimate for blocks of size 2^( 6) =       0.000438686212
  error estimate for blocks of size 2^( 7) =       0.000440878285

      target function =                  N/A
              le_mean =     -17.214269985084
             les_mean =     296.662948858513
             stat err =       0.000437007892
             autocorr =       1.150949818138
              std dev =       0.576071093772
             le_variance =       0.331857905079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721426998508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214269985084       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214269990500       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214269995374       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214269996782       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214269995252       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214269996251       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214269996482       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214269996385       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.221453e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214269985084       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214269986439       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214269987659       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214269988012       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214269987630       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214269987879       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214269987935       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.550740e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214269985084       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214269985423       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214269985728       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214269985816       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214269985721       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214269985783       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214269985797       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.387810e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9279e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.934748e-01 1 1  ON 0
 uu_1                 2.865518e-02 1 1  ON 1
 uu_2                -6.982089e-02 1 1  ON 2
 uu_3                -1.272780e-01 1 1  ON 3
 uu_4                -1.626219e-01 1 1  ON 4
 uu_5                -1.732627e-01 1 1  ON 5
 uu_6                -1.587339e-01 1 1  ON 6
 uu_7                -1.108549e-01 1 1  ON 7
 uu_8                -3.615573e-02 1 1  ON 8
 uu_9                 2.143069e-01 1 1  ON 9
 ud_0                 3.561295e-01 1 1  ON 10
 ud_1                 9.388817e-02 1 1  ON 11
 ud_2                -1.963420e-02 1 1  ON 12
 ud_3                -8.144624e-02 1 1  ON 13
 ud_4                -1.289917e-01 1 1  ON 14
 ud_5                -1.624438e-01 1 1  ON 15
 ud_6                -1.719002e-01 1 1  ON 16
 ud_7                -1.450824e-01 1 1  ON 17
 ud_8                -9.330831e-02 1 1  ON 18
 ud_9                 4.263142e-02 1 1  ON 19
 eO_0                -9.038773e-01 1 1  ON 20
 eO_1                -5.756686e-01 1 1  ON 21
 eO_2                -1.546093e-01 1 1  ON 22
 eO_3                 1.129458e-01 1 1  ON 23
 eO_4                 2.243249e-01 1 1  ON 24
 eO_5                 2.973332e-01 1 1  ON 25
 eO_6                 3.093349e-01 1 1  ON 26
 eO_7                 4.645204e-01 1 1  ON 27
 eO_8                 1.269635e-01 1 1  ON 28
 eO_9                 5.432498e-02 1 1  ON 29
eH1_0                -2.141875e-01 1 1  ON 30
eH1_1                -1.353533e-01 1 1  ON 31
eH1_2                -9.269098e-02 1 1  ON 32
eH1_3                -5.425327e-02 1 1  ON 33
eH1_4                -7.785631e-03 1 1  ON 34
eH1_5                 4.442860e-03 1 1  ON 35
eH1_6                 4.922755e-02 1 1  ON 36
eH1_7                 5.261209e-02 1 1  ON 37
eH1_8                 2.208096e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093118e-01 1 1  ON 40
eH2_1                -1.301743e-01 1 1  ON 41
eH2_2                -8.743033e-02 1 1  ON 42
eH2_3                -4.921163e-02 1 1  ON 43
eH2_4                -3.289989e-03 1 1  ON 44
eH2_5                 7.656828e-03 1 1  ON 45
eH2_6                 4.786880e-02 1 1  ON 46
eH2_7                 1.040146e-02 1 1  ON 47
eH2_8                 2.461704e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2089
    reference variance = 0.214727
====================================================
  Execution time = 3.0417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2663e-01
  Total weights = 2.0000e+06
  Execution time = 2.7034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326695412893
                                         uncertainty =       0.004476143567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326695412893
                                         uncertainty =       0.004476143567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404124833
  error estimate for blocks of size 2^( 2) =       0.000414054378
  error estimate for blocks of size 2^( 3) =       0.000422969810
  error estimate for blocks of size 2^( 4) =       0.000429637576
  error estimate for blocks of size 2^( 5) =       0.000433116100
  error estimate for blocks of size 2^( 6) =       0.000436708047
  error estimate for blocks of size 2^( 7) =       0.000436069622

      target function =                  N/A
              le_mean =     -17.214718712572
             les_mean =     296.673173951056
             stat err =       0.000433882836
             autocorr =       1.152693554023
              std dev =       0.571518819816
             le_variance =       0.326633761404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696163743
                                         uncertainty =       0.004476150321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326696163743
                                         uncertainty =       0.004476150321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404125298
  error estimate for blocks of size 2^( 2) =       0.000414054817
  error estimate for blocks of size 2^( 3) =       0.000422970218
  error estimate for blocks of size 2^( 4) =       0.000429637955
  error estimate for blocks of size 2^( 5) =       0.000433116477
  error estimate for blocks of size 2^( 6) =       0.000436708447
  error estimate for blocks of size 2^( 7) =       0.000436070033

      target function =                  N/A
              le_mean =     -17.214718715359
             les_mean =     296.673174798058
             stat err =       0.000433883228
             autocorr =       1.152692985397
              std dev =       0.571519476863
             le_variance =       0.326634512434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326695768810
                                         uncertainty =       0.004476146745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326695768810
                                         uncertainty =       0.004476146745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404125053
  error estimate for blocks of size 2^( 2) =       0.000414054586
  error estimate for blocks of size 2^( 3) =       0.000422970003
  error estimate for blocks of size 2^( 4) =       0.000429637755
  error estimate for blocks of size 2^( 5) =       0.000433116278
  error estimate for blocks of size 2^( 6) =       0.000436708238
  error estimate for blocks of size 2^( 7) =       0.000436069819

      target function =                  N/A
              le_mean =     -17.214718714159
             les_mean =     296.673174361719
             stat err =       0.000433883022
             autocorr =       1.152693286601
              std dev =       0.571519131279
             le_variance =       0.326634117418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326695457383
                                         uncertainty =       0.004476143964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326695457383
                                         uncertainty =       0.004476143964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404124861
  error estimate for blocks of size 2^( 2) =       0.000414054404
  error estimate for blocks of size 2^( 3) =       0.000422969834
  error estimate for blocks of size 2^( 4) =       0.000429637599
  error estimate for blocks of size 2^( 5) =       0.000433116122
  error estimate for blocks of size 2^( 6) =       0.000436708071
  error estimate for blocks of size 2^( 7) =       0.000436069647

      target function =                  N/A
              le_mean =     -17.214718712770
             les_mean =     296.673174002381
             stat err =       0.000433882860
             autocorr =       1.152693520601
              std dev =       0.571518858749
             le_variance =       0.326633805906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214718712572        initial
     1.5625e+02     1.5625e+03             2.2215e-06       -17.214718715359  <--
     6.2500e+02     6.2500e+03             5.5507e-07       -17.214718714159
     2.5000e+03     2.5000e+04             1.3878e-07       -17.214718712770

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 4.4056e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.934753e-01 1 1  ON 0
 uu_1                 2.865463e-02 1 1  ON 1
 uu_2                -6.982092e-02 1 1  ON 2
 uu_3                -1.272782e-01 1 1  ON 3
 uu_4                -1.626220e-01 1 1  ON 4
 uu_5                -1.732624e-01 1 1  ON 5
 uu_6                -1.587339e-01 1 1  ON 6
 uu_7                -1.108548e-01 1 1  ON 7
 uu_8                -3.615570e-02 1 1  ON 8
 uu_9                 2.143067e-01 1 1  ON 9
 ud_0                 3.561305e-01 1 1  ON 10
 ud_1                 9.388894e-02 1 1  ON 11
 ud_2                -1.963422e-02 1 1  ON 12
 ud_3                -8.144651e-02 1 1  ON 13
 ud_4                -1.289923e-01 1 1  ON 14
 ud_5                -1.624441e-01 1 1  ON 15
 ud_6                -1.719006e-01 1 1  ON 16
 ud_7                -1.450826e-01 1 1  ON 17
 ud_8                -9.330837e-02 1 1  ON 18
 ud_9                 4.263131e-02 1 1  ON 19
 eO_0                -9.038786e-01 1 1  ON 20
 eO_1                -5.756699e-01 1 1  ON 21
 eO_2                -1.546090e-01 1 1  ON 22
 eO_3                 1.129474e-01 1 1  ON 23
 eO_4                 2.243258e-01 1 1  ON 24
 eO_5                 2.973328e-01 1 1  ON 25
 eO_6                 3.093350e-01 1 1  ON 26
 eO_7                 4.645203e-01 1 1  ON 27
 eO_8                 1.269636e-01 1 1  ON 28
 eO_9                 5.432500e-02 1 1  ON 29
eH1_0                -2.141879e-01 1 1  ON 30
eH1_1                -1.353530e-01 1 1  ON 31
eH1_2                -9.269038e-02 1 1  ON 32
eH1_3                -5.425302e-02 1 1  ON 33
eH1_4                -7.785799e-03 1 1  ON 34
eH1_5                 4.442594e-03 1 1  ON 35
eH1_6                 4.922715e-02 1 1  ON 36
eH1_7                 5.261209e-02 1 1  ON 37
eH1_8                 2.208096e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093120e-01 1 1  ON 40
eH2_1                -1.301743e-01 1 1  ON 41
eH2_2                -8.743044e-02 1 1  ON 42
eH2_3                -4.921197e-02 1 1  ON 43
eH2_4                -3.289461e-03 1 1  ON 44
eH2_5                 7.656889e-03 1 1  ON 45
eH2_6                 4.786868e-02 1 1  ON 46
eH2_7                 1.040178e-02 1 1  ON 47
eH2_8                 2.461703e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2625
    reference variance = 0.421358
====================================================
  Execution time = 3.0665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2323e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323260701517
                                         uncertainty =       0.003195960056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323260701517
                                         uncertainty =       0.003195960056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402012384
  error estimate for blocks of size 2^( 2) =       0.000411807408
  error estimate for blocks of size 2^( 3) =       0.000420915633
  error estimate for blocks of size 2^( 4) =       0.000427004992
  error estimate for blocks of size 2^( 5) =       0.000431356731
  error estimate for blocks of size 2^( 6) =       0.000433621150
  error estimate for blocks of size 2^( 7) =       0.000434277279

      target function =                  N/A
              le_mean =     -17.214325175584
             les_mean =     296.656219002989
             stat err =       0.000431565038
             autocorr =       1.152427585283
              std dev =       0.568531365764
             le_variance =       0.323227913857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721432517558e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214325175584       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214325189491       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214325210554       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214325218306       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214325226392       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214325233290       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214325230925       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 8.796318e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214325175584       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214325179072       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214325184379       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214325186324       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214325188356       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214325190078       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214325189482       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.202512e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214325175584       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214325176457       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214325177786       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214325178273       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214325178781       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214325179212       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214325179063       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.508430e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9278e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.934755e-01 1 1  ON 0
 uu_1                 2.865491e-02 1 1  ON 1
 uu_2                -6.982118e-02 1 1  ON 2
 uu_3                -1.272784e-01 1 1  ON 3
 uu_4                -1.626223e-01 1 1  ON 4
 uu_5                -1.732628e-01 1 1  ON 5
 uu_6                -1.587335e-01 1 1  ON 6
 uu_7                -1.108548e-01 1 1  ON 7
 uu_8                -3.615577e-02 1 1  ON 8
 uu_9                 2.143065e-01 1 1  ON 9
 ud_0                 3.561315e-01 1 1  ON 10
 ud_1                 9.388975e-02 1 1  ON 11
 ud_2                -1.963475e-02 1 1  ON 12
 ud_3                -8.144687e-02 1 1  ON 13
 ud_4                -1.289931e-01 1 1  ON 14
 ud_5                -1.624439e-01 1 1  ON 15
 ud_6                -1.719006e-01 1 1  ON 16
 ud_7                -1.450828e-01 1 1  ON 17
 ud_8                -9.330855e-02 1 1  ON 18
 ud_9                 4.263116e-02 1 1  ON 19
 eO_0                -9.038808e-01 1 1  ON 20
 eO_1                -5.756712e-01 1 1  ON 21
 eO_2                -1.546082e-01 1 1  ON 22
 eO_3                 1.129495e-01 1 1  ON 23
 eO_4                 2.243265e-01 1 1  ON 24
 eO_5                 2.973325e-01 1 1  ON 25
 eO_6                 3.093351e-01 1 1  ON 26
 eO_7                 4.645202e-01 1 1  ON 27
 eO_8                 1.269637e-01 1 1  ON 28
 eO_9                 5.432503e-02 1 1  ON 29
eH1_0                -2.141884e-01 1 1  ON 30
eH1_1                -1.353534e-01 1 1  ON 31
eH1_2                -9.268982e-02 1 1  ON 32
eH1_3                -5.425287e-02 1 1  ON 33
eH1_4                -7.785590e-03 1 1  ON 34
eH1_5                 4.442989e-03 1 1  ON 35
eH1_6                 4.922676e-02 1 1  ON 36
eH1_7                 5.261212e-02 1 1  ON 37
eH1_8                 2.208095e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093119e-01 1 1  ON 40
eH2_1                -1.301747e-01 1 1  ON 41
eH2_2                -8.743085e-02 1 1  ON 42
eH2_3                -4.921240e-02 1 1  ON 43
eH2_4                -3.289048e-03 1 1  ON 44
eH2_5                 7.657150e-03 1 1  ON 45
eH2_6                 4.786871e-02 1 1  ON 46
eH2_7                 1.040238e-02 1 1  ON 47
eH2_8                 2.461701e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1765
    reference variance = 0.242366
====================================================
  Execution time = 3.0091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2767e-01
  Total weights = 2.0000e+06
  Execution time = 2.6909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327679947710
                                         uncertainty =       0.003363109929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327679947710
                                         uncertainty =       0.003363109929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404767243
  error estimate for blocks of size 2^( 2) =       0.000414824468
  error estimate for blocks of size 2^( 3) =       0.000423745091
  error estimate for blocks of size 2^( 4) =       0.000430960693
  error estimate for blocks of size 2^( 5) =       0.000435878536
  error estimate for blocks of size 2^( 6) =       0.000437214974
  error estimate for blocks of size 2^( 7) =       0.000437573968

      target function =                  N/A
              le_mean =     -17.214015359734
             les_mean =     296.649997683776
             stat err =       0.000435407043
             autocorr =       1.157124745174
              std dev =       0.572427325055
             le_variance =       0.327673042469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327684467307
                                         uncertainty =       0.003363166274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327684467307
                                         uncertainty =       0.003363166274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404770036
  error estimate for blocks of size 2^( 2) =       0.000414827079
  error estimate for blocks of size 2^( 3) =       0.000423747523
  error estimate for blocks of size 2^( 4) =       0.000430962981
  error estimate for blocks of size 2^( 5) =       0.000435880770
  error estimate for blocks of size 2^( 6) =       0.000437217129
  error estimate for blocks of size 2^( 7) =       0.000437576129

      target function =                  N/A
              le_mean =     -17.214015354221
             les_mean =     296.650002014801
             stat err =       0.000435409252
             autocorr =       1.157120525413
              std dev =       0.572431273849
             le_variance =       0.327677563281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327682216424
                                         uncertainty =       0.003363138256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327682216424
                                         uncertainty =       0.003363138256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404768645
  error estimate for blocks of size 2^( 2) =       0.000414825778
  error estimate for blocks of size 2^( 3) =       0.000423746311
  error estimate for blocks of size 2^( 4) =       0.000430961841
  error estimate for blocks of size 2^( 5) =       0.000435879657
  error estimate for blocks of size 2^( 6) =       0.000437216055
  error estimate for blocks of size 2^( 7) =       0.000437575053

      target function =                  N/A
              le_mean =     -17.214015356935
             les_mean =     296.649999856755
             stat err =       0.000435408151
             autocorr =       1.157122624467
              std dev =       0.572429307251
             le_variance =       0.327675311800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680231567
                                         uncertainty =       0.003363113474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327680231567
                                         uncertainty =       0.003363113474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404767419
  error estimate for blocks of size 2^( 2) =       0.000414824632
  error estimate for blocks of size 2^( 3) =       0.000423745244
  error estimate for blocks of size 2^( 4) =       0.000430960836
  error estimate for blocks of size 2^( 5) =       0.000435878676
  error estimate for blocks of size 2^( 6) =       0.000437215109
  error estimate for blocks of size 2^( 7) =       0.000437574104

      target function =                  N/A
              le_mean =     -17.214015359381
             les_mean =     296.649997955559
             stat err =       0.000435407181
             autocorr =       1.157124479732
              std dev =       0.572427573063
             le_variance =       0.327673326403


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214015359734        initial  <--
     3.9062e+01     3.9062e+02             8.7963e-06       -17.214015354221
     1.5625e+02     1.5625e+03             2.2025e-06       -17.214015356935
     6.2500e+02     6.2500e+03             5.5084e-07       -17.214015359381

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6615
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.934753e-01 1 1  ON 0
 uu_1                 2.865463e-02 1 1  ON 1
 uu_2                -6.982092e-02 1 1  ON 2
 uu_3                -1.272782e-01 1 1  ON 3
 uu_4                -1.626220e-01 1 1  ON 4
 uu_5                -1.732624e-01 1 1  ON 5
 uu_6                -1.587339e-01 1 1  ON 6
 uu_7                -1.108548e-01 1 1  ON 7
 uu_8                -3.615570e-02 1 1  ON 8
 uu_9                 2.143067e-01 1 1  ON 9
 ud_0                 3.561305e-01 1 1  ON 10
 ud_1                 9.388894e-02 1 1  ON 11
 ud_2                -1.963422e-02 1 1  ON 12
 ud_3                -8.144651e-02 1 1  ON 13
 ud_4                -1.289923e-01 1 1  ON 14
 ud_5                -1.624441e-01 1 1  ON 15
 ud_6                -1.719006e-01 1 1  ON 16
 ud_7                -1.450826e-01 1 1  ON 17
 ud_8                -9.330837e-02 1 1  ON 18
 ud_9                 4.263131e-02 1 1  ON 19
 eO_0                -9.038786e-01 1 1  ON 20
 eO_1                -5.756699e-01 1 1  ON 21
 eO_2                -1.546090e-01 1 1  ON 22
 eO_3                 1.129474e-01 1 1  ON 23
 eO_4                 2.243258e-01 1 1  ON 24
 eO_5                 2.973328e-01 1 1  ON 25
 eO_6                 3.093350e-01 1 1  ON 26
 eO_7                 4.645203e-01 1 1  ON 27
 eO_8                 1.269636e-01 1 1  ON 28
 eO_9                 5.432500e-02 1 1  ON 29
eH1_0                -2.141879e-01 1 1  ON 30
eH1_1                -1.353530e-01 1 1  ON 31
eH1_2                -9.269038e-02 1 1  ON 32
eH1_3                -5.425302e-02 1 1  ON 33
eH1_4                -7.785799e-03 1 1  ON 34
eH1_5                 4.442594e-03 1 1  ON 35
eH1_6                 4.922715e-02 1 1  ON 36
eH1_7                 5.261209e-02 1 1  ON 37
eH1_8                 2.208096e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093120e-01 1 1  ON 40
eH2_1                -1.301743e-01 1 1  ON 41
eH2_2                -8.743044e-02 1 1  ON 42
eH2_3                -4.921197e-02 1 1  ON 43
eH2_4                -3.289461e-03 1 1  ON 44
eH2_5                 7.656889e-03 1 1  ON 45
eH2_6                 4.786868e-02 1 1  ON 46
eH2_7                 1.040178e-02 1 1  ON 47
eH2_8                 2.461703e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2744
    reference variance = 0.651846
====================================================
  Execution time = 3.1004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2456e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324581244636
                                         uncertainty =       0.005775269313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324581244636
                                         uncertainty =       0.005775269313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402838509
  error estimate for blocks of size 2^( 2) =       0.000412968935
  error estimate for blocks of size 2^( 3) =       0.000422342987
  error estimate for blocks of size 2^( 4) =       0.000429548751
  error estimate for blocks of size 2^( 5) =       0.000434021954
  error estimate for blocks of size 2^( 6) =       0.000434148865
  error estimate for blocks of size 2^( 7) =       0.000435144706

      target function =                  N/A
              le_mean =     -17.213862588972
             les_mean =     296.641622798818
             stat err =       0.000433216069
             autocorr =       1.156504039168
              std dev =       0.569699683250
             le_variance =       0.324557729095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721386258897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213862588972       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213862587313       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213862587359       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213862588955       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213862589256       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213862589545       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213862589823       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 9.643944e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213862588972       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213862588557       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213862588568       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213862588967       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213862589043       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213862589115       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213862589185       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.411322e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213862588972       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213862588868       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213862588871       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213862588969       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213862588989       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213862589011       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213862589026       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 6.028514e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0695e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.934753e-01 1 1  ON 0
 uu_1                 2.865464e-02 1 1  ON 1
 uu_2                -6.982093e-02 1 1  ON 2
 uu_3                -1.272783e-01 1 1  ON 3
 uu_4                -1.626220e-01 1 1  ON 4
 uu_5                -1.732624e-01 1 1  ON 5
 uu_6                -1.587339e-01 1 1  ON 6
 uu_7                -1.108548e-01 1 1  ON 7
 uu_8                -3.615568e-02 1 1  ON 8
 uu_9                 2.143067e-01 1 1  ON 9
 ud_0                 3.561306e-01 1 1  ON 10
 ud_1                 9.388903e-02 1 1  ON 11
 ud_2                -1.963431e-02 1 1  ON 12
 ud_3                -8.144656e-02 1 1  ON 13
 ud_4                -1.289924e-01 1 1  ON 14
 ud_5                -1.624441e-01 1 1  ON 15
 ud_6                -1.719006e-01 1 1  ON 16
 ud_7                -1.450826e-01 1 1  ON 17
 ud_8                -9.330838e-02 1 1  ON 18
 ud_9                 4.263131e-02 1 1  ON 19
 eO_0                -9.038788e-01 1 1  ON 20
 eO_1                -5.756701e-01 1 1  ON 21
 eO_2                -1.546088e-01 1 1  ON 22
 eO_3                 1.129476e-01 1 1  ON 23
 eO_4                 2.243259e-01 1 1  ON 24
 eO_5                 2.973328e-01 1 1  ON 25
 eO_6                 3.093350e-01 1 1  ON 26
 eO_7                 4.645203e-01 1 1  ON 27
 eO_8                 1.269636e-01 1 1  ON 28
 eO_9                 5.432501e-02 1 1  ON 29
eH1_0                -2.141879e-01 1 1  ON 30
eH1_1                -1.353529e-01 1 1  ON 31
eH1_2                -9.269030e-02 1 1  ON 32
eH1_3                -5.425303e-02 1 1  ON 33
eH1_4                -7.785900e-03 1 1  ON 34
eH1_5                 4.442583e-03 1 1  ON 35
eH1_6                 4.922714e-02 1 1  ON 36
eH1_7                 5.261208e-02 1 1  ON 37
eH1_8                 2.208095e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093121e-01 1 1  ON 40
eH2_1                -1.301743e-01 1 1  ON 41
eH2_2                -8.743045e-02 1 1  ON 42
eH2_3                -4.921196e-02 1 1  ON 43
eH2_4                -3.289456e-03 1 1  ON 44
eH2_5                 7.656798e-03 1 1  ON 45
eH2_6                 4.786866e-02 1 1  ON 46
eH2_7                 1.040183e-02 1 1  ON 47
eH2_8                 2.461703e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1628
    reference variance = 0.192524
====================================================
  Execution time = 3.1385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2536e-01
  Total weights = 2.0000e+06
  Execution time = 2.6871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324452893
                                         uncertainty =       0.004535108997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324452893
                                         uncertainty =       0.004535108997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403337813
  error estimate for blocks of size 2^( 2) =       0.000413506520
  error estimate for blocks of size 2^( 3) =       0.000422684409
  error estimate for blocks of size 2^( 4) =       0.000429553512
  error estimate for blocks of size 2^( 5) =       0.000433093398
  error estimate for blocks of size 2^( 6) =       0.000435323294
  error estimate for blocks of size 2^( 7) =       0.000435077293

      target function =                  N/A
              le_mean =     -17.213985222862
             les_mean =     296.646649872591
             stat err =       0.000433261874
             autocorr =       1.153886443288
              std dev =       0.570405804975
             le_variance =       0.325362782350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324968134
                                         uncertainty =       0.004535108197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324968134
                                         uncertainty =       0.004535108197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403338133
  error estimate for blocks of size 2^( 2) =       0.000413506823
  error estimate for blocks of size 2^( 3) =       0.000422684691
  error estimate for blocks of size 2^( 4) =       0.000429553777
  error estimate for blocks of size 2^( 5) =       0.000433093655
  error estimate for blocks of size 2^( 6) =       0.000435323547
  error estimate for blocks of size 2^( 7) =       0.000435077552

      target function =                  N/A
              le_mean =     -17.213985226048
             les_mean =     296.646650498206
             stat err =       0.000433262133
             autocorr =       1.153885988980
              std dev =       0.570406257242
             le_variance =       0.325363298301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324710564
                                         uncertainty =       0.004535108595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324710564
                                         uncertainty =       0.004535108595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403337973
  error estimate for blocks of size 2^( 2) =       0.000413506672
  error estimate for blocks of size 2^( 3) =       0.000422684550
  error estimate for blocks of size 2^( 4) =       0.000429553645
  error estimate for blocks of size 2^( 5) =       0.000433093527
  error estimate for blocks of size 2^( 6) =       0.000435323421
  error estimate for blocks of size 2^( 7) =       0.000435077422

      target function =                  N/A
              le_mean =     -17.213985224457
             les_mean =     296.646650185523
             stat err =       0.000433262004
             autocorr =       1.153886216029
              std dev =       0.570406031154
             le_variance =       0.325363040376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324485103
                                         uncertainty =       0.004535108947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324485103
                                         uncertainty =       0.004535108947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403337833
  error estimate for blocks of size 2^( 2) =       0.000413506539
  error estimate for blocks of size 2^( 3) =       0.000422684426
  error estimate for blocks of size 2^( 4) =       0.000429553529
  error estimate for blocks of size 2^( 5) =       0.000433093414
  error estimate for blocks of size 2^( 6) =       0.000435323310
  error estimate for blocks of size 2^( 7) =       0.000435077309

      target function =                  N/A
              le_mean =     -17.213985223062
             les_mean =     296.646649911710
             stat err =       0.000433261891
             autocorr =       1.153886414877
              std dev =       0.570405833249
             le_variance =       0.325362814604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213985222862        initial
     3.9062e+02     3.9062e+03             9.6439e-07       -17.213985226048  <--
     1.5625e+03     1.5625e+04             2.4113e-07       -17.213985224457
     6.2500e+03     6.2500e+04             6.0285e-08       -17.213985223062

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 4.4991e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.934754e-01 1 1  ON 0
 uu_1                 2.865470e-02 1 1  ON 1
 uu_2                -6.982097e-02 1 1  ON 2
 uu_3                -1.272785e-01 1 1  ON 3
 uu_4                -1.626219e-01 1 1  ON 4
 uu_5                -1.732624e-01 1 1  ON 5
 uu_6                -1.587340e-01 1 1  ON 6
 uu_7                -1.108548e-01 1 1  ON 7
 uu_8                -3.615561e-02 1 1  ON 8
 uu_9                 2.143067e-01 1 1  ON 9
 ud_0                 3.561309e-01 1 1  ON 10
 ud_1                 9.388933e-02 1 1  ON 11
 ud_2                -1.963457e-02 1 1  ON 12
 ud_3                -8.144671e-02 1 1  ON 13
 ud_4                -1.289925e-01 1 1  ON 14
 ud_5                -1.624440e-01 1 1  ON 15
 ud_6                -1.719006e-01 1 1  ON 16
 ud_7                -1.450827e-01 1 1  ON 17
 ud_8                -9.330839e-02 1 1  ON 18
 ud_9                 4.263130e-02 1 1  ON 19
 eO_0                -9.038796e-01 1 1  ON 20
 eO_1                -5.756706e-01 1 1  ON 21
 eO_2                -1.546084e-01 1 1  ON 22
 eO_3                 1.129480e-01 1 1  ON 23
 eO_4                 2.243263e-01 1 1  ON 24
 eO_5                 2.973327e-01 1 1  ON 25
 eO_6                 3.093349e-01 1 1  ON 26
 eO_7                 4.645202e-01 1 1  ON 27
 eO_8                 1.269636e-01 1 1  ON 28
 eO_9                 5.432503e-02 1 1  ON 29
eH1_0                -2.141879e-01 1 1  ON 30
eH1_1                -1.353527e-01 1 1  ON 31
eH1_2                -9.269006e-02 1 1  ON 32
eH1_3                -5.425306e-02 1 1  ON 33
eH1_4                -7.786203e-03 1 1  ON 34
eH1_5                 4.442550e-03 1 1  ON 35
eH1_6                 4.922712e-02 1 1  ON 36
eH1_7                 5.261207e-02 1 1  ON 37
eH1_8                 2.208095e-01 1 1  ON 38
eH1_9                 1.118407e-01 1 1  ON 39
eH2_0                -2.093121e-01 1 1  ON 40
eH2_1                -1.301740e-01 1 1  ON 41
eH2_2                -8.743049e-02 1 1  ON 42
eH2_3                -4.921192e-02 1 1  ON 43
eH2_4                -3.289442e-03 1 1  ON 44
eH2_5                 7.656527e-03 1 1  ON 45
eH2_6                 4.786862e-02 1 1  ON 46
eH2_7                 1.040197e-02 1 1  ON 47
eH2_8                 2.461703e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2428
    reference variance = 0.247834
====================================================
  Execution time = 3.1124e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3800e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338019573499
                                         uncertainty =       0.010561414903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338019573499
                                         uncertainty =       0.010561414903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411098560
  error estimate for blocks of size 2^( 2) =       0.000421259502
  error estimate for blocks of size 2^( 3) =       0.000429920973
  error estimate for blocks of size 2^( 4) =       0.000436983502
  error estimate for blocks of size 2^( 5) =       0.000441211262
  error estimate for blocks of size 2^( 6) =       0.000442467853
  error estimate for blocks of size 2^( 7) =       0.000444185289

      target function =                  N/A
              le_mean =     -17.214691259738
             les_mean =     296.683599051563
             stat err =       0.000441211976
             autocorr =       1.151867894757
              std dev =       0.581381159354
             le_variance =       0.338004052452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721469125974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214691259738       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214691267219       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214691277003       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214691283415       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214691280043       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214691277793       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214691281452       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.213567e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214691259738       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214691261611       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214691264060       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214691265665       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214691264819       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214691264256       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214691265170       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 8.035682e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214691259738       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214691260207       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214691260819       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214691261220       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214691261009       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214691260868       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214691261097       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.009030e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9568e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.934755e-01 1 1  ON 0
 uu_1                 2.865454e-02 1 1  ON 1
 uu_2                -6.982107e-02 1 1  ON 2
 uu_3                -1.272786e-01 1 1  ON 3
 uu_4                -1.626220e-01 1 1  ON 4
 uu_5                -1.732624e-01 1 1  ON 5
 uu_6                -1.587338e-01 1 1  ON 6
 uu_7                -1.108548e-01 1 1  ON 7
 uu_8                -3.615563e-02 1 1  ON 8
 uu_9                 2.143066e-01 1 1  ON 9
 ud_0                 3.561312e-01 1 1  ON 10
 ud_1                 9.388957e-02 1 1  ON 11
 ud_2                -1.963477e-02 1 1  ON 12
 ud_3                -8.144692e-02 1 1  ON 13
 ud_4                -1.289931e-01 1 1  ON 14
 ud_5                -1.624438e-01 1 1  ON 15
 ud_6                -1.719004e-01 1 1  ON 16
 ud_7                -1.450827e-01 1 1  ON 17
 ud_8                -9.330848e-02 1 1  ON 18
 ud_9                 4.263121e-02 1 1  ON 19
 eO_0                -9.038804e-01 1 1  ON 20
 eO_1                -5.756713e-01 1 1  ON 21
 eO_2                -1.546080e-01 1 1  ON 22
 eO_3                 1.129484e-01 1 1  ON 23
 eO_4                 2.243269e-01 1 1  ON 24
 eO_5                 2.973329e-01 1 1  ON 25
 eO_6                 3.093350e-01 1 1  ON 26
 eO_7                 4.645201e-01 1 1  ON 27
 eO_8                 1.269637e-01 1 1  ON 28
 eO_9                 5.432504e-02 1 1  ON 29
eH1_0                -2.141879e-01 1 1  ON 30
eH1_1                -1.353526e-01 1 1  ON 31
eH1_2                -9.268970e-02 1 1  ON 32
eH1_3                -5.425304e-02 1 1  ON 33
eH1_4                -7.786261e-03 1 1  ON 34
eH1_5                 4.442370e-03 1 1  ON 35
eH1_6                 4.922692e-02 1 1  ON 36
eH1_7                 5.261207e-02 1 1  ON 37
eH1_8                 2.208094e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093120e-01 1 1  ON 40
eH2_1                -1.301741e-01 1 1  ON 41
eH2_2                -8.743055e-02 1 1  ON 42
eH2_3                -4.921195e-02 1 1  ON 43
eH2_4                -3.289827e-03 1 1  ON 44
eH2_5                 7.656548e-03 1 1  ON 45
eH2_6                 4.786881e-02 1 1  ON 46
eH2_7                 1.040224e-02 1 1  ON 47
eH2_8                 2.461702e-01 1 1  ON 48
eH2_9                 1.127789e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1424
    reference variance = 0.44128
====================================================
  Execution time = 3.0038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3277e-01
  Total weights = 2.0000e+06
  Execution time = 2.6971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332794763882
                                         uncertainty =       0.006374835604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332794763882
                                         uncertainty =       0.006374835604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407901391
  error estimate for blocks of size 2^( 2) =       0.000417713081
  error estimate for blocks of size 2^( 3) =       0.000426943862
  error estimate for blocks of size 2^( 4) =       0.000432885512
  error estimate for blocks of size 2^( 5) =       0.000437361423
  error estimate for blocks of size 2^( 6) =       0.000440143033
  error estimate for blocks of size 2^( 7) =       0.000442672174

      target function =                  N/A
              le_mean =     -17.213451179241
             les_mean =     296.635668423302
             stat err =       0.000438265536
             autocorr =       1.154421129793
              std dev =       0.576859679265
             le_variance =       0.332767089562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332796439966
                                         uncertainty =       0.006374864428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332796439966
                                         uncertainty =       0.006374864428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407902418
  error estimate for blocks of size 2^( 2) =       0.000417714053
  error estimate for blocks of size 2^( 3) =       0.000426944772
  error estimate for blocks of size 2^( 4) =       0.000432886373
  error estimate for blocks of size 2^( 5) =       0.000437362222
  error estimate for blocks of size 2^( 6) =       0.000440143814
  error estimate for blocks of size 2^( 7) =       0.000442672934

      target function =                  N/A
              le_mean =     -17.213451187794
             les_mean =     296.635670393763
             stat err =       0.000438266336
             autocorr =       1.154419529420
              std dev =       0.576861131983
             le_variance =       0.332768765593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332795603475
                                         uncertainty =       0.006374850041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332795603475
                                         uncertainty =       0.006374850041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407901906
  error estimate for blocks of size 2^( 2) =       0.000417713568
  error estimate for blocks of size 2^( 3) =       0.000426944318
  error estimate for blocks of size 2^( 4) =       0.000432885943
  error estimate for blocks of size 2^( 5) =       0.000437361823
  error estimate for blocks of size 2^( 6) =       0.000440143424
  error estimate for blocks of size 2^( 7) =       0.000442672554

      target function =                  N/A
              le_mean =     -17.213451183531
             les_mean =     296.635669410542
             stat err =       0.000438265936
             autocorr =       1.154420327737
              std dev =       0.576860406969
             le_variance =       0.332767929129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332794868878
                                         uncertainty =       0.006374837410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332794868878
                                         uncertainty =       0.006374837410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407901455
  error estimate for blocks of size 2^( 2) =       0.000417713142
  error estimate for blocks of size 2^( 3) =       0.000426943919
  error estimate for blocks of size 2^( 4) =       0.000432885566
  error estimate for blocks of size 2^( 5) =       0.000437361473
  error estimate for blocks of size 2^( 6) =       0.000440143082
  error estimate for blocks of size 2^( 7) =       0.000442672221

      target function =                  N/A
              le_mean =     -17.213451179778
             les_mean =     296.635668546758
             stat err =       0.000438265586
             autocorr =       1.154421029478
              std dev =       0.576859770269
             le_variance =       0.332767194554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213451179241        initial
     9.7656e+01     9.7656e+02             3.2136e-06       -17.213451187794  <--
     3.9062e+02     3.9062e+03             8.0357e-07       -17.213451183531
     1.5625e+03     1.5625e+04             2.0090e-07       -17.213451179778

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.3650e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.934757e-01 1 1  ON 0
 uu_1                 2.865406e-02 1 1  ON 1
 uu_2                -6.982138e-02 1 1  ON 2
 uu_3                -1.272789e-01 1 1  ON 3
 uu_4                -1.626221e-01 1 1  ON 4
 uu_5                -1.732623e-01 1 1  ON 5
 uu_6                -1.587331e-01 1 1  ON 6
 uu_7                -1.108545e-01 1 1  ON 7
 uu_8                -3.615566e-02 1 1  ON 8
 uu_9                 2.143063e-01 1 1  ON 9
 ud_0                 3.561324e-01 1 1  ON 10
 ud_1                 9.389030e-02 1 1  ON 11
 ud_2                -1.963539e-02 1 1  ON 12
 ud_3                -8.144755e-02 1 1  ON 13
 ud_4                -1.289946e-01 1 1  ON 14
 ud_5                -1.624432e-01 1 1  ON 15
 ud_6                -1.718997e-01 1 1  ON 16
 ud_7                -1.450826e-01 1 1  ON 17
 ud_8                -9.330877e-02 1 1  ON 18
 ud_9                 4.263092e-02 1 1  ON 19
 eO_0                -9.038828e-01 1 1  ON 20
 eO_1                -5.756735e-01 1 1  ON 21
 eO_2                -1.546070e-01 1 1  ON 22
 eO_3                 1.129494e-01 1 1  ON 23
 eO_4                 2.243288e-01 1 1  ON 24
 eO_5                 2.973334e-01 1 1  ON 25
 eO_6                 3.093352e-01 1 1  ON 26
 eO_7                 4.645199e-01 1 1  ON 27
 eO_8                 1.269638e-01 1 1  ON 28
 eO_9                 5.432508e-02 1 1  ON 29
eH1_0                -2.141877e-01 1 1  ON 30
eH1_1                -1.353524e-01 1 1  ON 31
eH1_2                -9.268863e-02 1 1  ON 32
eH1_3                -5.425297e-02 1 1  ON 33
eH1_4                -7.786435e-03 1 1  ON 34
eH1_5                 4.441829e-03 1 1  ON 35
eH1_6                 4.922633e-02 1 1  ON 36
eH1_7                 5.261208e-02 1 1  ON 37
eH1_8                 2.208092e-01 1 1  ON 38
eH1_9                 1.118406e-01 1 1  ON 39
eH2_0                -2.093117e-01 1 1  ON 40
eH2_1                -1.301743e-01 1 1  ON 41
eH2_2                -8.743074e-02 1 1  ON 42
eH2_3                -4.921203e-02 1 1  ON 43
eH2_4                -3.290980e-03 1 1  ON 44
eH2_5                 7.656613e-03 1 1  ON 45
eH2_6                 4.786940e-02 1 1  ON 46
eH2_7                 1.040305e-02 1 1  ON 47
eH2_8                 2.461700e-01 1 1  ON 48
eH2_9                 1.127790e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2213
    reference variance = 0.19295
====================================================
  Execution time = 3.0768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333820044334
                                         uncertainty =       0.004639942009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333820044334
                                         uncertainty =       0.004639942009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408530654
  error estimate for blocks of size 2^( 2) =       0.000418436058
  error estimate for blocks of size 2^( 3) =       0.000427139676
  error estimate for blocks of size 2^( 4) =       0.000433096849
  error estimate for blocks of size 2^( 5) =       0.000437532470
  error estimate for blocks of size 2^( 6) =       0.000440495178
  error estimate for blocks of size 2^( 7) =       0.000443460173

      target function =                  N/A
              le_mean =     -17.214444486961
             les_mean =     296.670893418901
             stat err =       0.000438646168
             autocorr =       1.152867454546
              std dev =       0.577749592069
             le_variance =       0.333794591136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721444448696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214444486961       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214444499040       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214444492175       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214444534908       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214444502688       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214444509873       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214444514363       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.598838e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214444486961       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214444489994       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214444488264       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214444499007       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214444490853       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214444492656       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214444493773       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.007399e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214444486961       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214444487720       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214444487287       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214444489976       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214444487931       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214444488383       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214444488662       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.002496e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9342e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.934758e-01 1 1  ON 0
 uu_1                 2.865409e-02 1 1  ON 1
 uu_2                -6.982163e-02 1 1  ON 2
 uu_3                -1.272791e-01 1 1  ON 3
 uu_4                -1.626219e-01 1 1  ON 4
 uu_5                -1.732620e-01 1 1  ON 5
 uu_6                -1.587336e-01 1 1  ON 6
 uu_7                -1.108543e-01 1 1  ON 7
 uu_8                -3.615552e-02 1 1  ON 8
 uu_9                 2.143059e-01 1 1  ON 9
 ud_0                 3.561333e-01 1 1  ON 10
 ud_1                 9.389146e-02 1 1  ON 11
 ud_2                -1.963622e-02 1 1  ON 12
 ud_3                -8.144847e-02 1 1  ON 13
 ud_4                -1.289957e-01 1 1  ON 14
 ud_5                -1.624429e-01 1 1  ON 15
 ud_6                -1.718994e-01 1 1  ON 16
 ud_7                -1.450825e-01 1 1  ON 17
 ud_8                -9.330884e-02 1 1  ON 18
 ud_9                 4.263068e-02 1 1  ON 19
 eO_0                -9.038868e-01 1 1  ON 20
 eO_1                -5.756754e-01 1 1  ON 21
 eO_2                -1.546062e-01 1 1  ON 22
 eO_3                 1.129521e-01 1 1  ON 23
 eO_4                 2.243308e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093355e-01 1 1  ON 26
 eO_7                 4.645197e-01 1 1  ON 27
 eO_8                 1.269640e-01 1 1  ON 28
 eO_9                 5.432512e-02 1 1  ON 29
eH1_0                -2.141883e-01 1 1  ON 30
eH1_1                -1.353528e-01 1 1  ON 31
eH1_2                -9.268790e-02 1 1  ON 32
eH1_3                -5.425326e-02 1 1  ON 33
eH1_4                -7.786220e-03 1 1  ON 34
eH1_5                 4.443169e-03 1 1  ON 35
eH1_6                 4.922556e-02 1 1  ON 36
eH1_7                 5.261194e-02 1 1  ON 37
eH1_8                 2.208091e-01 1 1  ON 38
eH1_9                 1.118407e-01 1 1  ON 39
eH2_0                -2.093129e-01 1 1  ON 40
eH2_1                -1.301732e-01 1 1  ON 41
eH2_2                -8.743103e-02 1 1  ON 42
eH2_3                -4.921315e-02 1 1  ON 43
eH2_4                -3.291358e-03 1 1  ON 44
eH2_5                 7.656795e-03 1 1  ON 45
eH2_6                 4.786989e-02 1 1  ON 46
eH2_7                 1.040420e-02 1 1  ON 47
eH2_8                 2.461698e-01 1 1  ON 48
eH2_9                 1.127790e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.161663
====================================================
  Execution time = 3.0232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2626e-01
  Total weights = 2.0000e+06
  Execution time = 2.6739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326324824085
                                         uncertainty =       0.004666962753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326324824085
                                         uncertainty =       0.004666962753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403895097
  error estimate for blocks of size 2^( 2) =       0.000414087613
  error estimate for blocks of size 2^( 3) =       0.000423253792
  error estimate for blocks of size 2^( 4) =       0.000430111507
  error estimate for blocks of size 2^( 5) =       0.000434663432
  error estimate for blocks of size 2^( 6) =       0.000437935916
  error estimate for blocks of size 2^( 7) =       0.000440457699

      target function =                  N/A
              le_mean =     -17.213811185895
             les_mean =     296.641557878660
             stat err =       0.000435792139
             autocorr =       1.164183988292
              std dev =       0.571193923418
             le_variance =       0.326262498150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326328672695
                                         uncertainty =       0.004666998251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326328672695
                                         uncertainty =       0.004666998251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403897479
  error estimate for blocks of size 2^( 2) =       0.000414089866
  error estimate for blocks of size 2^( 3) =       0.000423255888
  error estimate for blocks of size 2^( 4) =       0.000430113574
  error estimate for blocks of size 2^( 5) =       0.000434665476
  error estimate for blocks of size 2^( 6) =       0.000437937807
  error estimate for blocks of size 2^( 7) =       0.000440459517

      target function =                  N/A
              le_mean =     -17.213811192867
             les_mean =     296.641561967194
             stat err =       0.000435794094
             autocorr =       1.164180700202
              std dev =       0.571197292230
             le_variance =       0.326266346651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326326748850
                                         uncertainty =       0.004666980051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326326748850
                                         uncertainty =       0.004666980051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403896288
  error estimate for blocks of size 2^( 2) =       0.000414088739
  error estimate for blocks of size 2^( 3) =       0.000423254840
  error estimate for blocks of size 2^( 4) =       0.000430112540
  error estimate for blocks of size 2^( 5) =       0.000434664453
  error estimate for blocks of size 2^( 6) =       0.000437936860
  error estimate for blocks of size 2^( 7) =       0.000440458606

      target function =                  N/A
              le_mean =     -17.213811189385
             les_mean =     296.641559923537
             stat err =       0.000435793115
             autocorr =       1.164182336141
              std dev =       0.571195608228
             le_variance =       0.326264422859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326325064659
                                         uncertainty =       0.004666964901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326325064659
                                         uncertainty =       0.004666964901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403895246
  error estimate for blocks of size 2^( 2) =       0.000414087754
  error estimate for blocks of size 2^( 3) =       0.000423253923
  error estimate for blocks of size 2^( 4) =       0.000430111636
  error estimate for blocks of size 2^( 5) =       0.000434663560
  error estimate for blocks of size 2^( 6) =       0.000437936034
  error estimate for blocks of size 2^( 7) =       0.000440457813

      target function =                  N/A
              le_mean =     -17.213811186326
             les_mean =     296.641558134079
             stat err =       0.000435792261
             autocorr =       1.164183781500
              std dev =       0.571194134001
             le_variance =       0.326262738717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213811185895        initial
     2.4414e+01     2.4414e+02             1.5988e-05       -17.213811192867  <--
     9.7656e+01     9.7656e+02             4.0074e-06       -17.213811189385
     3.9062e+02     3.9062e+03             1.0025e-06       -17.213811186326

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.3720e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262997e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.3246
    reference variance = 0.239138
====================================================
  Execution time = 3.0755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3277e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818207864
                                         uncertainty =       0.003721034578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818207864
                                         uncertainty =       0.003721034578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407900945
  error estimate for blocks of size 2^( 2) =       0.000417878255
  error estimate for blocks of size 2^( 3) =       0.000426488582
  error estimate for blocks of size 2^( 4) =       0.000433572791
  error estimate for blocks of size 2^( 5) =       0.000437307297
  error estimate for blocks of size 2^( 6) =       0.000439568886
  error estimate for blocks of size 2^( 7) =       0.000438433235

      target function =                  N/A
              le_mean =     -17.214083487208
             les_mean =     296.657436500548
             stat err =       0.000437220552
             autocorr =       1.148925088909
              std dev =       0.576859048952
             le_variance =       0.332766362357


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721408348721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214083487208       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214083595010       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214083628008       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214083659615       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214083716287       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214083713784       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214083731695       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.745476e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214083487208       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214083514722       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214083523954       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214083533714       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214083548148       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214083546863       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214083550268       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.228388e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214083487208       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214083494123       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214083496497       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214083499065       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214083502694       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214083502332       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214083503110       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.098611e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9245e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.934752e-01 1 1  ON 0
 uu_1                 2.865474e-02 1 1  ON 1
 uu_2                -6.982207e-02 1 1  ON 2
 uu_3                -1.272788e-01 1 1  ON 3
 uu_4                -1.626206e-01 1 1  ON 4
 uu_5                -1.732655e-01 1 1  ON 5
 uu_6                -1.587332e-01 1 1  ON 6
 uu_7                -1.108528e-01 1 1  ON 7
 uu_8                -3.615482e-02 1 1  ON 8
 uu_9                 2.143037e-01 1 1  ON 9
 ud_0                 3.561482e-01 1 1  ON 10
 ud_1                 9.389693e-02 1 1  ON 11
 ud_2                -1.964104e-02 1 1  ON 12
 ud_3                -8.145353e-02 1 1  ON 13
 ud_4                -1.290067e-01 1 1  ON 14
 ud_5                -1.624424e-01 1 1  ON 15
 ud_6                -1.718955e-01 1 1  ON 16
 ud_7                -1.450843e-01 1 1  ON 17
 ud_8                -9.331011e-02 1 1  ON 18
 ud_9                 4.262887e-02 1 1  ON 19
 eO_0                -9.039093e-01 1 1  ON 20
 eO_1                -5.756890e-01 1 1  ON 21
 eO_2                -1.546037e-01 1 1  ON 22
 eO_3                 1.129720e-01 1 1  ON 23
 eO_4                 2.243449e-01 1 1  ON 24
 eO_5                 2.973317e-01 1 1  ON 25
 eO_6                 3.093367e-01 1 1  ON 26
 eO_7                 4.645185e-01 1 1  ON 27
 eO_8                 1.269652e-01 1 1  ON 28
 eO_9                 5.432538e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353549e-01 1 1  ON 31
eH1_2                -9.268269e-02 1 1  ON 32
eH1_3                -5.425250e-02 1 1  ON 33
eH1_4                -7.786603e-03 1 1  ON 34
eH1_5                 4.446421e-03 1 1  ON 35
eH1_6                 4.922106e-02 1 1  ON 36
eH1_7                 5.261159e-02 1 1  ON 37
eH1_8                 2.208081e-01 1 1  ON 38
eH1_9                 1.118410e-01 1 1  ON 39
eH2_0                -2.093159e-01 1 1  ON 40
eH2_1                -1.301722e-01 1 1  ON 41
eH2_2                -8.742976e-02 1 1  ON 42
eH2_3                -4.921470e-02 1 1  ON 43
eH2_4                -3.293370e-03 1 1  ON 44
eH2_5                 7.656303e-03 1 1  ON 45
eH2_6                 4.786924e-02 1 1  ON 46
eH2_7                 1.041077e-02 1 1  ON 47
eH2_8                 2.461681e-01 1 1  ON 48
eH2_9                 1.127792e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2628
    reference variance = 0.352129
====================================================
  Execution time = 2.9912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2523e-01
  Total weights = 2.0000e+06
  Execution time = 2.6947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325239225885
                                         uncertainty =       0.004332492021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325239225885
                                         uncertainty =       0.004332492021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403250459
  error estimate for blocks of size 2^( 2) =       0.000413759795
  error estimate for blocks of size 2^( 3) =       0.000422540157
  error estimate for blocks of size 2^( 4) =       0.000428471983
  error estimate for blocks of size 2^( 5) =       0.000432710612
  error estimate for blocks of size 2^( 6) =       0.000434602666
  error estimate for blocks of size 2^( 7) =       0.000436728511

      target function =                  N/A
              le_mean =     -17.214828059764
             les_mean =     296.675526829831
             stat err =       0.000433128443
             autocorr =       1.153675495474
              std dev =       0.570282268002
             le_variance =       0.325221865197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325279558856
                                         uncertainty =       0.004333097182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325279558856
                                         uncertainty =       0.004333097182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403275472
  error estimate for blocks of size 2^( 2) =       0.000413783405
  error estimate for blocks of size 2^( 3) =       0.000422562488
  error estimate for blocks of size 2^( 4) =       0.000428493430
  error estimate for blocks of size 2^( 5) =       0.000432731843
  error estimate for blocks of size 2^( 6) =       0.000434623040
  error estimate for blocks of size 2^( 7) =       0.000436748468

      target function =                  N/A
              le_mean =     -17.214828021243
             les_mean =     296.675565850364
             stat err =       0.000433149195
             autocorr =       1.153642927458
              std dev =       0.570317641351
             le_variance =       0.325262212037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325260288792
                                         uncertainty =       0.004332810882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325260288792
                                         uncertainty =       0.004332810882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403263521
  error estimate for blocks of size 2^( 2) =       0.000413772127
  error estimate for blocks of size 2^( 3) =       0.000422551824
  error estimate for blocks of size 2^( 4) =       0.000428483193
  error estimate for blocks of size 2^( 5) =       0.000432721718
  error estimate for blocks of size 2^( 6) =       0.000434613319
  error estimate for blocks of size 2^( 7) =       0.000436738945

      target function =                  N/A
              le_mean =     -17.214828035579
             les_mean =     296.675547067417
             stat err =       0.000433139294
             autocorr =       1.153658558003
              std dev =       0.570300741270
             le_variance =       0.325242935493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325241888057
                                         uncertainty =       0.004332532421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325241888057
                                         uncertainty =       0.004332532421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403252110
  error estimate for blocks of size 2^( 2) =       0.000413761354
  error estimate for blocks of size 2^( 3) =       0.000422541632
  error estimate for blocks of size 2^( 4) =       0.000428473400
  error estimate for blocks of size 2^( 5) =       0.000432712017
  error estimate for blocks of size 2^( 6) =       0.000434604013
  error estimate for blocks of size 2^( 7) =       0.000436729830

      target function =                  N/A
              le_mean =     -17.214828056494
             les_mean =     296.675529380347
             stat err =       0.000433129815
             autocorr =       1.153673356190
              std dev =       0.570284602903
             le_variance =       0.325224528308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214828059764        initial  <--
     6.1035e+00     6.1035e+01             4.7455e-05       -17.214828021243
     2.4414e+01     2.4414e+02             1.2284e-05       -17.214828035579
     9.7656e+01     9.7656e+02             3.0986e-06       -17.214828056494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5145
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262997e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1327
    reference variance = 0.239675
====================================================
  Execution time = 3.2559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3736e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337376512785
                                         uncertainty =       0.008428830202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337376512785
                                         uncertainty =       0.008428830202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410706530
  error estimate for blocks of size 2^( 2) =       0.000420371767
  error estimate for blocks of size 2^( 3) =       0.000429362789
  error estimate for blocks of size 2^( 4) =       0.000436330282
  error estimate for blocks of size 2^( 5) =       0.000440942423
  error estimate for blocks of size 2^( 6) =       0.000444625864
  error estimate for blocks of size 2^( 7) =       0.000443502895

      target function =                  N/A
              le_mean =     -17.214054144684
             les_mean =     296.661019634805
             stat err =       0.000441350366
             autocorr =       1.154791999742
              std dev =       0.580826744726
             le_variance =       0.337359707389


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721405414468e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214054144684       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214054155424       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214054198546       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214054212275       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214054218785       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214054217174       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214054211648       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214054212306       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 8.278053e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214054144684       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214054147374       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214054158202       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214054161652       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214054163276       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214054162876       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214054161500       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214054161665       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.071946e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214054144684       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214054145356       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214054148066       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214054148930       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214054149336       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214054149236       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214054148893       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214054148932       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.181389e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1153e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.934756e-01 1 1  ON 0
 uu_1                 2.865414e-02 1 1  ON 1
 uu_2                -6.982232e-02 1 1  ON 2
 uu_3                -1.272802e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732604e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615488e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561362e-01 1 1  ON 10
 ud_1                 9.389562e-02 1 1  ON 11
 ud_2                -1.963891e-02 1 1  ON 12
 ud_3                -8.145169e-02 1 1  ON 13
 ud_4                -1.289992e-01 1 1  ON 14
 ud_5                -1.624421e-01 1 1  ON 15
 ud_6                -1.718985e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330890e-02 1 1  ON 18
 ud_9                 4.262994e-02 1 1  ON 19
 eO_0                -9.039008e-01 1 1  ON 20
 eO_1                -5.756822e-01 1 1  ON 21
 eO_2                -1.546030e-01 1 1  ON 22
 eO_3                 1.129618e-01 1 1  ON 23
 eO_4                 2.243374e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269646e-01 1 1  ON 28
 eO_9                 5.432529e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353549e-01 1 1  ON 31
eH1_2                -9.268516e-02 1 1  ON 32
eH1_3                -5.425415e-02 1 1  ON 33
eH1_4                -7.785984e-03 1 1  ON 34
eH1_5                 4.447469e-03 1 1  ON 35
eH1_6                 4.922326e-02 1 1  ON 36
eH1_7                 5.261159e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093165e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743208e-02 1 1  ON 42
eH2_3                -4.921650e-02 1 1  ON 43
eH2_4                -3.292541e-03 1 1  ON 44
eH2_5                 7.657254e-03 1 1  ON 45
eH2_6                 4.787137e-02 1 1  ON 46
eH2_7                 1.040806e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2856
    reference variance = 0.317556
====================================================
  Execution time = 3.0211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2456e-01
  Total weights = 2.0000e+06
  Execution time = 2.6869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583822276
                                         uncertainty =       0.002833103799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583822276
                                         uncertainty =       0.002833103799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402839519
  error estimate for blocks of size 2^( 2) =       0.000413211867
  error estimate for blocks of size 2^( 3) =       0.000422176140
  error estimate for blocks of size 2^( 4) =       0.000428112246
  error estimate for blocks of size 2^( 5) =       0.000431065427
  error estimate for blocks of size 2^( 6) =       0.000433392339
  error estimate for blocks of size 2^( 7) =       0.000437957037

      target function =                  N/A
              le_mean =     -17.214054922391
             les_mean =     296.648246064449
             stat err =       0.000432631762
             autocorr =       1.153380658619
              std dev =       0.569701110775
             le_variance =       0.324559355618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324584484542
                                         uncertainty =       0.002833099103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324584484542
                                         uncertainty =       0.002833099103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402839929
  error estimate for blocks of size 2^( 2) =       0.000413212228
  error estimate for blocks of size 2^( 3) =       0.000422176443
  error estimate for blocks of size 2^( 4) =       0.000428112527
  error estimate for blocks of size 2^( 5) =       0.000431065733
  error estimate for blocks of size 2^( 6) =       0.000433392748
  error estimate for blocks of size 2^( 7) =       0.000437957348

      target function =                  N/A
              le_mean =     -17.214054902929
             les_mean =     296.648246055279
             stat err =       0.000432632089
             autocorr =       1.153380052708
              std dev =       0.569701690819
             le_variance =       0.324560016522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324584147374
                                         uncertainty =       0.002833101367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324584147374
                                         uncertainty =       0.002833101367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402839720
  error estimate for blocks of size 2^( 2) =       0.000413212044
  error estimate for blocks of size 2^( 3) =       0.000422176288
  error estimate for blocks of size 2^( 4) =       0.000428112383
  error estimate for blocks of size 2^( 5) =       0.000431065577
  error estimate for blocks of size 2^( 6) =       0.000433392541
  error estimate for blocks of size 2^( 7) =       0.000437957189

      target function =                  N/A
              le_mean =     -17.214054912611
             les_mean =     296.648246052126
             stat err =       0.000432631922
             autocorr =       1.153380359418
              std dev =       0.569701395500
             le_variance =       0.324559680035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583862714
                                         uncertainty =       0.002833103492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583862714
                                         uncertainty =       0.002833103492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402839544
  error estimate for blocks of size 2^( 2) =       0.000413211889
  error estimate for blocks of size 2^( 3) =       0.000422176158
  error estimate for blocks of size 2^( 4) =       0.000428112263
  error estimate for blocks of size 2^( 5) =       0.000431065446
  error estimate for blocks of size 2^( 6) =       0.000433392365
  error estimate for blocks of size 2^( 7) =       0.000437957056

      target function =                  N/A
              le_mean =     -17.214054921166
             les_mean =     296.648246062612
             stat err =       0.000432631782
             autocorr =       1.153380621326
              std dev =       0.569701146190
             le_variance =       0.324559395970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214054922391        initial  <--
     6.1035e+01     6.1035e+02             8.2781e-06       -17.214054902929
     2.4414e+02     2.4414e+03             2.0719e-06       -17.214054912611
     9.7656e+02     9.7656e+03             5.1814e-07       -17.214054921166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7872
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262997e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1354
    reference variance = 0.30765
====================================================
  Execution time = 3.0778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2155e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321465178059
                                         uncertainty =       0.003394436043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321465178059
                                         uncertainty =       0.003394436043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400969636
  error estimate for blocks of size 2^( 2) =       0.000411088994
  error estimate for blocks of size 2^( 3) =       0.000420665530
  error estimate for blocks of size 2^( 4) =       0.000427299254
  error estimate for blocks of size 2^( 5) =       0.000432071553
  error estimate for blocks of size 2^( 6) =       0.000434387761
  error estimate for blocks of size 2^( 7) =       0.000438298844

      target function =                  N/A
              le_mean =     -17.214289967014
             les_mean =     296.653332205449
             stat err =       0.000433014353
             autocorr =       1.166223025681
              std dev =       0.567056697161
             le_variance =       0.321553297795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721428996701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214289967014       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214289966528       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214289965527       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214289966014       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214289965782       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214289966227       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214289965799       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214289965872       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 5.069354e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214289967014       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214289966892       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214289966642       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214289966764       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214289966706       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214289966817       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214289966711       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214289966727       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.267660e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214289967014       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214289966983       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214289966921       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214289966952       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214289966944       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214289967005       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214289966885       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214289966948       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 3.169352e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9244e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865416e-02 1 1  ON 1
 uu_2                -6.982240e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732609e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615506e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561360e-01 1 1  ON 10
 ud_1                 9.389494e-02 1 1  ON 11
 ud_2                -1.963870e-02 1 1  ON 12
 ud_3                -8.145129e-02 1 1  ON 13
 ud_4                -1.289990e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330907e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038989e-01 1 1  ON 20
 eO_1                -5.756811e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129604e-01 1 1  ON 23
 eO_4                 2.243370e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268568e-02 1 1  ON 32
eH1_3                -5.425412e-02 1 1  ON 33
eH1_4                -7.785623e-03 1 1  ON 34
eH1_5                 4.447161e-03 1 1  ON 35
eH1_6                 4.922320e-02 1 1  ON 36
eH1_7                 5.261155e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301699e-01 1 1  ON 41
eH2_2                -8.743195e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292500e-03 1 1  ON 44
eH2_5                 7.657368e-03 1 1  ON 45
eH2_6                 4.787137e-02 1 1  ON 46
eH2_7                 1.040767e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1564
    reference variance = 0.184663
====================================================
  Execution time = 3.0045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3275e-01
  Total weights = 2.0000e+06
  Execution time = 2.6894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672133979
                                         uncertainty =       0.007836890954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672133979
                                         uncertainty =       0.007836890954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407892853
  error estimate for blocks of size 2^( 2) =       0.000417786665
  error estimate for blocks of size 2^( 3) =       0.000427294278
  error estimate for blocks of size 2^( 4) =       0.000434041504
  error estimate for blocks of size 2^( 5) =       0.000437140057
  error estimate for blocks of size 2^( 6) =       0.000437175546
  error estimate for blocks of size 2^( 7) =       0.000438323316

      target function =                  N/A
              le_mean =     -17.214068791606
             les_mean =     296.656917354796
             stat err =       0.000436670106
             autocorr =       1.146079464057
              std dev =       0.576847604671
             le_variance =       0.332753159015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672654977
                                         uncertainty =       0.007836906512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672654977
                                         uncertainty =       0.007836906512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407893173
  error estimate for blocks of size 2^( 2) =       0.000417786967
  error estimate for blocks of size 2^( 3) =       0.000427294564
  error estimate for blocks of size 2^( 4) =       0.000434041775
  error estimate for blocks of size 2^( 5) =       0.000437140321
  error estimate for blocks of size 2^( 6) =       0.000437175802
  error estimate for blocks of size 2^( 7) =       0.000438323574

      target function =                  N/A
              le_mean =     -17.214068788710
             les_mean =     296.656917776523
             stat err =       0.000436670368
             autocorr =       1.146079045327
              std dev =       0.576848056654
             le_variance =       0.332753680466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672394557
                                         uncertainty =       0.007836898736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672394557
                                         uncertainty =       0.007836898736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407893013
  error estimate for blocks of size 2^( 2) =       0.000417786816
  error estimate for blocks of size 2^( 3) =       0.000427294421
  error estimate for blocks of size 2^( 4) =       0.000434041639
  error estimate for blocks of size 2^( 5) =       0.000437140189
  error estimate for blocks of size 2^( 6) =       0.000437175674
  error estimate for blocks of size 2^( 7) =       0.000438323445

      target function =                  N/A
              le_mean =     -17.214068790157
             les_mean =     296.656917565711
             stat err =       0.000436670237
             autocorr =       1.146079254620
              std dev =       0.576847830731
             le_variance =       0.332753419819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672166553
                                         uncertainty =       0.007836891926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332672166553
                                         uncertainty =       0.007836891926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407892873
  error estimate for blocks of size 2^( 2) =       0.000417786684
  error estimate for blocks of size 2^( 3) =       0.000427294296
  error estimate for blocks of size 2^( 4) =       0.000434041521
  error estimate for blocks of size 2^( 5) =       0.000437140073
  error estimate for blocks of size 2^( 6) =       0.000437175562
  error estimate for blocks of size 2^( 7) =       0.000438323332

      target function =                  N/A
              le_mean =     -17.214068791425
             les_mean =     296.656917381161
             stat err =       0.000436670122
             autocorr =       1.146079437876
              std dev =       0.576847632931
             le_variance =       0.332753191618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214068791606        initial  <--
     6.1035e+02     6.1035e+03             5.0694e-07       -17.214068788710
     2.4414e+03     2.4414e+04             1.2677e-07       -17.214068790157
     9.7656e+03     9.7656e+04             3.1694e-08       -17.214068791425

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6557
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262997e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2919e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.3355
    reference variance = 0.435556
====================================================
  Execution time = 3.0897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325181745286
                                         uncertainty =       0.004243258760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325181745286
                                         uncertainty =       0.004243258760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403179076
  error estimate for blocks of size 2^( 2) =       0.000413659262
  error estimate for blocks of size 2^( 3) =       0.000422996683
  error estimate for blocks of size 2^( 4) =       0.000429461511
  error estimate for blocks of size 2^( 5) =       0.000432923317
  error estimate for blocks of size 2^( 6) =       0.000435651474
  error estimate for blocks of size 2^( 7) =       0.000436203448

      target function =                  N/A
              le_mean =     -17.213502672815
             les_mean =     296.629780838717
             stat err =       0.000433559937
             autocorr =       1.156384655006
              std dev =       0.570181316994
             le_variance =       0.325106734249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721350267282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213502672815       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213502672899       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213502673024       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213502672988       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213502672963       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213502672929       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213502672951       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.535534e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213502672815       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213502672836       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213502672868       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213502672861       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213502672854       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213502672845       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213502672846       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.133888e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213502672815       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213502672821       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213502672828       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213502672832       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213502672824       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213502672822       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213502672814       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.834724e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9438e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615508e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447183e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301699e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292505e-03 1 1  ON 44
eH2_5                 7.657340e-03 1 1  ON 45
eH2_6                 4.787135e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1941
    reference variance = 0.344403
====================================================
  Execution time = 3.0002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2203e-01
  Total weights = 2.0000e+06
  Execution time = 2.6906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036563354
                                         uncertainty =       0.002528969795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036563354
                                         uncertainty =       0.002528969795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401265630
  error estimate for blocks of size 2^( 2) =       0.000411736916
  error estimate for blocks of size 2^( 3) =       0.000421044290
  error estimate for blocks of size 2^( 4) =       0.000427514356
  error estimate for blocks of size 2^( 5) =       0.000430826029
  error estimate for blocks of size 2^( 6) =       0.000432943651
  error estimate for blocks of size 2^( 7) =       0.000436373458

      target function =                  N/A
              le_mean =     -17.214473673689
             les_mean =     296.660131912557
             stat err =       0.000431914373
             autocorr =       1.158594305092
              std dev =       0.567475295886
             le_variance =       0.322028211441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036600252
                                         uncertainty =       0.002528970138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036600252
                                         uncertainty =       0.002528970138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401265653
  error estimate for blocks of size 2^( 2) =       0.000411736938
  error estimate for blocks of size 2^( 3) =       0.000421044310
  error estimate for blocks of size 2^( 4) =       0.000427514375
  error estimate for blocks of size 2^( 5) =       0.000430826048
  error estimate for blocks of size 2^( 6) =       0.000432943670
  error estimate for blocks of size 2^( 7) =       0.000436373477

      target function =                  N/A
              le_mean =     -17.214473673610
             les_mean =     296.660131946728
             stat err =       0.000431914393
             autocorr =       1.158594276011
              std dev =       0.567475328401
             le_variance =       0.322028248344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036581803
                                         uncertainty =       0.002528969966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036581803
                                         uncertainty =       0.002528969966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401265641
  error estimate for blocks of size 2^( 2) =       0.000411736927
  error estimate for blocks of size 2^( 3) =       0.000421044300
  error estimate for blocks of size 2^( 4) =       0.000427514366
  error estimate for blocks of size 2^( 5) =       0.000430826039
  error estimate for blocks of size 2^( 6) =       0.000432943660
  error estimate for blocks of size 2^( 7) =       0.000436373468

      target function =                  N/A
              le_mean =     -17.214473673649
             les_mean =     296.660131929643
             stat err =       0.000431914383
             autocorr =       1.158594290556
              std dev =       0.567475312144
             le_variance =       0.322028229893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036565660
                                         uncertainty =       0.002528969816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036565660
                                         uncertainty =       0.002528969816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401265631
  error estimate for blocks of size 2^( 2) =       0.000411736917
  error estimate for blocks of size 2^( 3) =       0.000421044291
  error estimate for blocks of size 2^( 4) =       0.000427514357
  error estimate for blocks of size 2^( 5) =       0.000430826030
  error estimate for blocks of size 2^( 6) =       0.000432943652
  error estimate for blocks of size 2^( 7) =       0.000436373459

      target function =                  N/A
              le_mean =     -17.214473673684
             les_mean =     296.660131914693
             stat err =       0.000431914375
             autocorr =       1.158594303278
              std dev =       0.567475297918
             le_variance =       0.322028213747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214473673689        initial  <--
     6.1035e+03     6.1035e+04             4.5355e-08       -17.214473673610
     2.4414e+04     2.4414e+05             1.1339e-08       -17.214473673649
     9.7656e+04     9.7656e+05             2.8347e-09       -17.214473673684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5848
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262997e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2288
    reference variance = 0.257276
====================================================
  Execution time = 3.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325438272974
                                         uncertainty =       0.003155433180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325438272974
                                         uncertainty =       0.003155433180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403369181
  error estimate for blocks of size 2^( 2) =       0.000413426469
  error estimate for blocks of size 2^( 3) =       0.000422621674
  error estimate for blocks of size 2^( 4) =       0.000429061531
  error estimate for blocks of size 2^( 5) =       0.000433187544
  error estimate for blocks of size 2^( 6) =       0.000435439328
  error estimate for blocks of size 2^( 7) =       0.000437531932

      target function =                  N/A
              le_mean =     -17.214393568374
             les_mean =     296.660759156357
             stat err =       0.000433805084
             autocorr =       1.156601759466
              std dev =       0.570450166255
             le_variance =       0.325413392180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721439356837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214393568374       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214393568373       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214393568386       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214393568403       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214393568411       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214393568439       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214393568428       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.030593e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214393568374       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214393568374       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214393568377       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214393568637       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214393568394       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214393568381       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214393568429       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.257649e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214393568374       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214393568374       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214393568375       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214393568376       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214393568376       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214393568376       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214393568189       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.144123e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8959e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262997e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2691
    reference variance = 0.159492
====================================================
  Execution time = 3.2374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2262e-01
  Total weights = 2.0000e+06
  Execution time = 2.7014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551246007
                                         uncertainty =       0.005148252839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551246007
                                         uncertainty =       0.005148252839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401631851
  error estimate for blocks of size 2^( 2) =       0.000411637341
  error estimate for blocks of size 2^( 3) =       0.000420708519
  error estimate for blocks of size 2^( 4) =       0.000427673227
  error estimate for blocks of size 2^( 5) =       0.000430914801
  error estimate for blocks of size 2^( 6) =       0.000431480140
  error estimate for blocks of size 2^( 7) =       0.000433747550

      target function =                  N/A
              le_mean =     -17.214290084988
             les_mean =     296.654399256368
             stat err =       0.000430953929
             autocorr =       1.151344779186
              std dev =       0.567993210825
             le_variance =       0.322616287543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551249260
                                         uncertainty =       0.005148252919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551249260
                                         uncertainty =       0.005148252919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401631853
  error estimate for blocks of size 2^( 2) =       0.000411637342
  error estimate for blocks of size 2^( 3) =       0.000420708521
  error estimate for blocks of size 2^( 4) =       0.000427673229
  error estimate for blocks of size 2^( 5) =       0.000430914803
  error estimate for blocks of size 2^( 6) =       0.000431480142
  error estimate for blocks of size 2^( 7) =       0.000433747551

      target function =                  N/A
              le_mean =     -17.214290084991
             les_mean =     296.654399259698
             stat err =       0.000430953931
             autocorr =       1.151344776962
              std dev =       0.567993213688
             le_variance =       0.322616290795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551247633
                                         uncertainty =       0.005148252879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551247633
                                         uncertainty =       0.005148252879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401631852
  error estimate for blocks of size 2^( 2) =       0.000411637342
  error estimate for blocks of size 2^( 3) =       0.000420708520
  error estimate for blocks of size 2^( 4) =       0.000427673228
  error estimate for blocks of size 2^( 5) =       0.000430914802
  error estimate for blocks of size 2^( 6) =       0.000431480141
  error estimate for blocks of size 2^( 7) =       0.000433747550

      target function =                  N/A
              le_mean =     -17.214290084990
             les_mean =     296.654399258033
             stat err =       0.000430953930
             autocorr =       1.151344778076
              std dev =       0.567993212256
             le_variance =       0.322616289169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551246210
                                         uncertainty =       0.005148252844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322551246210
                                         uncertainty =       0.005148252844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401631851
  error estimate for blocks of size 2^( 2) =       0.000411637341
  error estimate for blocks of size 2^( 3) =       0.000420708519
  error estimate for blocks of size 2^( 4) =       0.000427673227
  error estimate for blocks of size 2^( 5) =       0.000430914801
  error estimate for blocks of size 2^( 6) =       0.000431480140
  error estimate for blocks of size 2^( 7) =       0.000433747550

      target function =                  N/A
              le_mean =     -17.214290084989
             les_mean =     296.654399256576
             stat err =       0.000430953929
             autocorr =       1.151344779050
              std dev =       0.567993211004
             le_variance =       0.322616287747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214290084988        initial
     6.1035e+04     6.1035e+05             5.0306e-09       -17.214290084991  <--
     2.4414e+05     2.4414e+06             1.2576e-09       -17.214290084990
     9.7656e+05     9.7656e+06             3.1441e-10       -17.214290084989

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 4.6001e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2417
    reference variance = 0.345829
====================================================
  Execution time = 3.0820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2445e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324441814968
                                         uncertainty =       0.003132077837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324441814968
                                         uncertainty =       0.003132077837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402774389
  error estimate for blocks of size 2^( 2) =       0.000413104584
  error estimate for blocks of size 2^( 3) =       0.000421902032
  error estimate for blocks of size 2^( 4) =       0.000428008474
  error estimate for blocks of size 2^( 5) =       0.000432883713
  error estimate for blocks of size 2^( 6) =       0.000435447387
  error estimate for blocks of size 2^( 7) =       0.000436646505

      target function =                  N/A
              le_mean =     -17.214899851463
             les_mean =     296.677231151138
             stat err =       0.000433246520
             autocorr =       1.157034928713
              std dev =       0.569609004013
             le_variance =       0.324454417452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721489985146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214899851463       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214899851463       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214899851481       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214899851530       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214899851555       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214899851570       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214899851555       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.148250e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214899851463       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214899851463       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214899851468       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214899851481       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214899851569       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214899851462       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214899851478       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.370647e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214899851463       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214899851463       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214899851464       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214899851469       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214899849438       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214899851510       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214899851655       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.342664e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9367e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301699e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292505e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1978
    reference variance = 0.270813
====================================================
  Execution time = 2.9845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2566e-01
  Total weights = 2.0000e+06
  Execution time = 2.6987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629119872
                                         uncertainty =       0.003757231145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629119872
                                         uncertainty =       0.003757231145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403519624
  error estimate for blocks of size 2^( 2) =       0.000413589752
  error estimate for blocks of size 2^( 3) =       0.000422493177
  error estimate for blocks of size 2^( 4) =       0.000428927124
  error estimate for blocks of size 2^( 5) =       0.000432256094
  error estimate for blocks of size 2^( 6) =       0.000433853252
  error estimate for blocks of size 2^( 7) =       0.000434966482

      target function =                  N/A
              le_mean =     -17.213986270551
             les_mean =     296.646979333549
             stat err =       0.000432500738
             autocorr =       1.148799891823
              std dev =       0.570662924737
             le_variance =       0.325656173669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629135915
                                         uncertainty =       0.003757231246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629135915
                                         uncertainty =       0.003757231246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403519634
  error estimate for blocks of size 2^( 2) =       0.000413589761
  error estimate for blocks of size 2^( 3) =       0.000422493185
  error estimate for blocks of size 2^( 4) =       0.000428927133
  error estimate for blocks of size 2^( 5) =       0.000432256103
  error estimate for blocks of size 2^( 6) =       0.000433853261
  error estimate for blocks of size 2^( 7) =       0.000434966491

      target function =                  N/A
              le_mean =     -17.213986270520
             les_mean =     296.646979348523
             stat err =       0.000432500747
             autocorr =       1.148799881169
              std dev =       0.570662938795
             le_variance =       0.325656189715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629127894
                                         uncertainty =       0.003757231195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629127894
                                         uncertainty =       0.003757231195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403519629
  error estimate for blocks of size 2^( 2) =       0.000413589757
  error estimate for blocks of size 2^( 3) =       0.000422493181
  error estimate for blocks of size 2^( 4) =       0.000428927129
  error estimate for blocks of size 2^( 5) =       0.000432256098
  error estimate for blocks of size 2^( 6) =       0.000433853256
  error estimate for blocks of size 2^( 7) =       0.000434966487

      target function =                  N/A
              le_mean =     -17.213986270535
             les_mean =     296.646979341036
             stat err =       0.000432500743
             autocorr =       1.148799886494
              std dev =       0.570662931766
             le_variance =       0.325656181692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629120874
                                         uncertainty =       0.003757231151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325629120874
                                         uncertainty =       0.003757231151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403519624
  error estimate for blocks of size 2^( 2) =       0.000413589752
  error estimate for blocks of size 2^( 3) =       0.000422493177
  error estimate for blocks of size 2^( 4) =       0.000428927125
  error estimate for blocks of size 2^( 5) =       0.000432256095
  error estimate for blocks of size 2^( 6) =       0.000433853252
  error estimate for blocks of size 2^( 7) =       0.000434966483

      target function =                  N/A
              le_mean =     -17.213986270549
             les_mean =     296.646979334485
             stat err =       0.000432500739
             autocorr =       1.148799891156
              std dev =       0.570662925615
             le_variance =       0.325656174672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213986270551        initial  <--
     1.5259e+04     1.5259e+05             2.1482e-08       -17.213986270520
     6.1035e+04     6.1035e+05             5.3706e-09       -17.213986270535
     2.4414e+05     2.4414e+06             1.3427e-09       -17.213986270549

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4355
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.230352
====================================================
  Execution time = 3.0665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331155514912
                                         uncertainty =       0.004794698871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331155514912
                                         uncertainty =       0.004794698871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406883946
  error estimate for blocks of size 2^( 2) =       0.000417213451
  error estimate for blocks of size 2^( 3) =       0.000426398609
  error estimate for blocks of size 2^( 4) =       0.000433406794
  error estimate for blocks of size 2^( 5) =       0.000436182031
  error estimate for blocks of size 2^( 6) =       0.000439329575
  error estimate for blocks of size 2^( 7) =       0.000441083209

      target function =                  N/A
              le_mean =     -17.214269689931
             les_mean =     296.662189883818
             stat err =       0.000437500402
             autocorr =       1.156154310363
              std dev =       0.575420795332
             le_variance =       0.331109091700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721426968993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214269689931       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214269689936       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214269689940       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214269689940       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214269689933       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214269689910       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214269689806       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.132216e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214269689931       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214269689932       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214269689933       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214269690090       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214269689975       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214269689517       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214269690485       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 5.330550e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214269689931       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214269689931       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214269689931       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214269689931       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214269687565       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214269689467       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214269693512       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.332642e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9115e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982237e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2836
    reference variance = 0.255783
====================================================
  Execution time = 2.9948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2529e-01
  Total weights = 2.0000e+06
  Execution time = 2.6845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636312
                                         uncertainty =       0.003526086712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636312
                                         uncertainty =       0.003526086712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403293543
  error estimate for blocks of size 2^( 2) =       0.000413308780
  error estimate for blocks of size 2^( 3) =       0.000422127919
  error estimate for blocks of size 2^( 4) =       0.000428647019
  error estimate for blocks of size 2^( 5) =       0.000432355274
  error estimate for blocks of size 2^( 6) =       0.000435085306
  error estimate for blocks of size 2^( 7) =       0.000436629909

      target function =                  N/A
              le_mean =     -17.214569685007
             les_mean =     296.666700640695
             stat err =       0.000433179377
             autocorr =       1.153700305344
              std dev =       0.570343197879
             le_variance =       0.325291363367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636455
                                         uncertainty =       0.003526086717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636455
                                         uncertainty =       0.003526086717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403293543
  error estimate for blocks of size 2^( 2) =       0.000413308780
  error estimate for blocks of size 2^( 3) =       0.000422127919
  error estimate for blocks of size 2^( 4) =       0.000428647019
  error estimate for blocks of size 2^( 5) =       0.000432355274
  error estimate for blocks of size 2^( 6) =       0.000435085306
  error estimate for blocks of size 2^( 7) =       0.000436629909

      target function =                  N/A
              le_mean =     -17.214569685011
             les_mean =     296.666700640975
             stat err =       0.000433179377
             autocorr =       1.153700304884
              std dev =       0.570343198005
             le_variance =       0.325291363510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636383
                                         uncertainty =       0.003526086714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636383
                                         uncertainty =       0.003526086714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403293543
  error estimate for blocks of size 2^( 2) =       0.000413308780
  error estimate for blocks of size 2^( 3) =       0.000422127919
  error estimate for blocks of size 2^( 4) =       0.000428647019
  error estimate for blocks of size 2^( 5) =       0.000432355274
  error estimate for blocks of size 2^( 6) =       0.000435085306
  error estimate for blocks of size 2^( 7) =       0.000436629909

      target function =                  N/A
              le_mean =     -17.214569685009
             les_mean =     296.666700640835
             stat err =       0.000433179377
             autocorr =       1.153700305116
              std dev =       0.570343197942
             le_variance =       0.325291363438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636321
                                         uncertainty =       0.003526086712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188636321
                                         uncertainty =       0.003526086712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403293543
  error estimate for blocks of size 2^( 2) =       0.000413308780
  error estimate for blocks of size 2^( 3) =       0.000422127919
  error estimate for blocks of size 2^( 4) =       0.000428647019
  error estimate for blocks of size 2^( 5) =       0.000432355274
  error estimate for blocks of size 2^( 6) =       0.000435085306
  error estimate for blocks of size 2^( 7) =       0.000436629909

      target function =                  N/A
              le_mean =     -17.214569685008
             les_mean =     296.666700640712
             stat err =       0.000433179377
             autocorr =       1.153700305317
              std dev =       0.570343197887
             le_variance =       0.325291363376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214569685007        initial
     1.5259e+05     1.5259e+06             2.1322e-09       -17.214569685011  <--
     6.1035e+05     6.1035e+06             5.3306e-10       -17.214569685009
     2.4414e+06     2.4414e+07             1.3326e-10       -17.214569685008

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 4.3501e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982237e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921646e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2621e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2218
    reference variance = 0.622775
====================================================
  Execution time = 3.0773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2491e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324777509246
                                         uncertainty =       0.005075102817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324777509246
                                         uncertainty =       0.005075102817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403058710
  error estimate for blocks of size 2^( 2) =       0.000412818671
  error estimate for blocks of size 2^( 3) =       0.000421499995
  error estimate for blocks of size 2^( 4) =       0.000428216796
  error estimate for blocks of size 2^( 5) =       0.000431614250
  error estimate for blocks of size 2^( 6) =       0.000434761852
  error estimate for blocks of size 2^( 7) =       0.000437865271

      target function =                  N/A
              le_mean =     -17.214151190300
             les_mean =     296.651913686982
             stat err =       0.000433114542
             autocorr =       1.154699322397
              std dev =       0.570011093700
             le_variance =       0.324912646941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721415119030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214151190300       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214151190262       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214151190246       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214151190225       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214151190265       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214151190259       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214151190349       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.001572e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214151190300       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214151190290       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214151190286       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214151190284       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214151190283       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214151190142       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214151190388       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.503935e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214151190300       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214151190297       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214151190296       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214151190199       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214151190319       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214151190074       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214151190040       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 6.259841e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9391e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389488e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268572e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447181e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292506e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1733
    reference variance = 0.237812
====================================================
  Execution time = 3.0061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2786e-01
  Total weights = 2.0000e+06
  Execution time = 2.6888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949536470
                                         uncertainty =       0.003129161020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949536470
                                         uncertainty =       0.003129161020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404884377
  error estimate for blocks of size 2^( 2) =       0.000415371817
  error estimate for blocks of size 2^( 3) =       0.000424648542
  error estimate for blocks of size 2^( 4) =       0.000431121734
  error estimate for blocks of size 2^( 5) =       0.000434606238
  error estimate for blocks of size 2^( 6) =       0.000437450955
  error estimate for blocks of size 2^( 7) =       0.000436670420

      target function =                  N/A
              le_mean =     -17.214672027344
             les_mean =     296.672795562423
             stat err =       0.000434962337
             autocorr =       1.154094226054
              std dev =       0.572592977034
             le_variance =       0.327862717348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949544609
                                         uncertainty =       0.003129161137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949544609
                                         uncertainty =       0.003129161137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404884382
  error estimate for blocks of size 2^( 2) =       0.000415371822
  error estimate for blocks of size 2^( 3) =       0.000424648546
  error estimate for blocks of size 2^( 4) =       0.000431121738
  error estimate for blocks of size 2^( 5) =       0.000434606243
  error estimate for blocks of size 2^( 6) =       0.000437450960
  error estimate for blocks of size 2^( 7) =       0.000436670424

      target function =                  N/A
              le_mean =     -17.214672027389
             les_mean =     296.672795572112
             stat err =       0.000434962341
             autocorr =       1.154094220408
              std dev =       0.572592984137
             le_variance =       0.327862725483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949540540
                                         uncertainty =       0.003129161079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949540540
                                         uncertainty =       0.003129161079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404884379
  error estimate for blocks of size 2^( 2) =       0.000415371819
  error estimate for blocks of size 2^( 3) =       0.000424648544
  error estimate for blocks of size 2^( 4) =       0.000431121736
  error estimate for blocks of size 2^( 5) =       0.000434606241
  error estimate for blocks of size 2^( 6) =       0.000437450958
  error estimate for blocks of size 2^( 7) =       0.000436670422

      target function =                  N/A
              le_mean =     -17.214672027366
             les_mean =     296.672795567267
             stat err =       0.000434962339
             autocorr =       1.154094223235
              std dev =       0.572592980585
             le_variance =       0.327862721416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949536978
                                         uncertainty =       0.003129161027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327949536978
                                         uncertainty =       0.003129161027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404884377
  error estimate for blocks of size 2^( 2) =       0.000415371817
  error estimate for blocks of size 2^( 3) =       0.000424648542
  error estimate for blocks of size 2^( 4) =       0.000431121734
  error estimate for blocks of size 2^( 5) =       0.000434606239
  error estimate for blocks of size 2^( 6) =       0.000437450956
  error estimate for blocks of size 2^( 7) =       0.000436670420

      target function =                  N/A
              le_mean =     -17.214672027346
             les_mean =     296.672795563028
             stat err =       0.000434962337
             autocorr =       1.154094225701
              std dev =       0.572592977478
             le_variance =       0.327862717857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214672027344        initial
     3.8147e+04     3.8147e+05             1.0016e-08       -17.214672027389  <--
     1.5259e+05     1.5259e+06             2.5039e-09       -17.214672027366
     6.1035e+05     6.1035e+06             6.2598e-10       -17.214672027346

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 4.3650e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3048e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2599
    reference variance = 0.271141
====================================================
  Execution time = 3.3022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2637e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326385838480
                                         uncertainty =       0.004916438422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326385838480
                                         uncertainty =       0.004916438422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403961150
  error estimate for blocks of size 2^( 2) =       0.000414169707
  error estimate for blocks of size 2^( 3) =       0.000423353554
  error estimate for blocks of size 2^( 4) =       0.000429986021
  error estimate for blocks of size 2^( 5) =       0.000434902326
  error estimate for blocks of size 2^( 6) =       0.000437563539
  error estimate for blocks of size 2^( 7) =       0.000437819589

      target function =                  N/A
              le_mean =     -17.214899599975
             les_mean =     296.679137296049
             stat err =       0.000435067869
             autocorr =       1.159938115866
              std dev =       0.571287337537
             le_variance =       0.326369222031


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721489959997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214899599975       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214899600028       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214899600046       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214899599990       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214899599975       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214899599964       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214899600025       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.345965e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214899599975       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214899599988       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214899599992       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214899599982       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214899599967       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214899599987       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214899600201       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 8.364954e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214899599975       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214899599978       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214899599979       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214899600070       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214899599976       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214899599976       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214899599866       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.091241e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1677e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447182e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292504e-03 1 1  ON 44
eH2_5                 7.657343e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2687
    reference variance = 0.672753
====================================================
  Execution time = 2.9988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3995e-01
  Total weights = 2.0000e+06
  Execution time = 2.6957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034938805
                                         uncertainty =       0.012281771310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034938805
                                         uncertainty =       0.012281771310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283009
  error estimate for blocks of size 2^( 2) =       0.000422131340
  error estimate for blocks of size 2^( 3) =       0.000430885462
  error estimate for blocks of size 2^( 4) =       0.000437072096
  error estimate for blocks of size 2^( 5) =       0.000441448776
  error estimate for blocks of size 2^( 6) =       0.000443068054
  error estimate for blocks of size 2^( 7) =       0.000443788961

      target function =                  N/A
              le_mean =     -17.214710137087
             les_mean =     296.686199493639
             stat err =       0.000441344472
             autocorr =       1.145946934173
              std dev =       0.583056223453
             le_variance =       0.339954559707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034941308
                                         uncertainty =       0.012281771334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034941308
                                         uncertainty =       0.012281771334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283011
  error estimate for blocks of size 2^( 2) =       0.000422131341
  error estimate for blocks of size 2^( 3) =       0.000430885463
  error estimate for blocks of size 2^( 4) =       0.000437072097
  error estimate for blocks of size 2^( 5) =       0.000441448776
  error estimate for blocks of size 2^( 6) =       0.000443068054
  error estimate for blocks of size 2^( 7) =       0.000443788961

      target function =                  N/A
              le_mean =     -17.214710136899
             les_mean =     296.686199489681
             stat err =       0.000441344472
             autocorr =       1.145946927079
              std dev =       0.583056225588
             le_variance =       0.339954562197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034940057
                                         uncertainty =       0.012281771322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034940057
                                         uncertainty =       0.012281771322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283010
  error estimate for blocks of size 2^( 2) =       0.000422131340
  error estimate for blocks of size 2^( 3) =       0.000430885463
  error estimate for blocks of size 2^( 4) =       0.000437072096
  error estimate for blocks of size 2^( 5) =       0.000441448776
  error estimate for blocks of size 2^( 6) =       0.000443068054
  error estimate for blocks of size 2^( 7) =       0.000443788961

      target function =                  N/A
              le_mean =     -17.214710136993
             les_mean =     296.686199491659
             stat err =       0.000441344472
             autocorr =       1.145946930625
              std dev =       0.583056224520
             le_variance =       0.339954560952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034938962
                                         uncertainty =       0.012281771311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340034938962
                                         uncertainty =       0.012281771311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283010
  error estimate for blocks of size 2^( 2) =       0.000422131340
  error estimate for blocks of size 2^( 3) =       0.000430885462
  error estimate for blocks of size 2^( 4) =       0.000437072096
  error estimate for blocks of size 2^( 5) =       0.000441448776
  error estimate for blocks of size 2^( 6) =       0.000443068054
  error estimate for blocks of size 2^( 7) =       0.000443788961

      target function =                  N/A
              le_mean =     -17.214710137075
             les_mean =     296.686199493391
             stat err =       0.000441344472
             autocorr =       1.145946933735
              std dev =       0.583056223586
             le_variance =       0.339954559863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214710137087        initial  <--
     9.5367e+03     9.5367e+04             3.3460e-08       -17.214710136899
     3.8147e+04     3.8147e+05             8.3650e-09       -17.214710136993
     1.5259e+05     1.5259e+06             2.0912e-09       -17.214710137075

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5868
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922325e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5270e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1277
    reference variance = 0.392004
====================================================
  Execution time = 3.0546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326100805097
                                         uncertainty =       0.002989457837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326100805097
                                         uncertainty =       0.002989457837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403862262
  error estimate for blocks of size 2^( 2) =       0.000413856438
  error estimate for blocks of size 2^( 3) =       0.000422863425
  error estimate for blocks of size 2^( 4) =       0.000429106504
  error estimate for blocks of size 2^( 5) =       0.000433968685
  error estimate for blocks of size 2^( 6) =       0.000437436784
  error estimate for blocks of size 2^( 7) =       0.000437705326

      target function =                  N/A
              le_mean =     -17.214126158049
             les_mean =     296.652348675225
             stat err =       0.000434554325
             autocorr =       1.157768171246
              std dev =       0.571147488061
             le_variance =       0.326209453119


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721412615805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214126158049       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214126158050       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214126158055       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214126158067       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214126158055       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214126158058       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214126158064       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 3.642140e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214126158049       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214126158049       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214126158050       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214126158059       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214126158040       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214126158173       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214126157617       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 9.105348e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214126158049       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214126158049       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214126158049       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214126158042       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214126157877       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214126158988       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214126158797       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 2.276333e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9035e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785591e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1659
    reference variance = 0.290069
====================================================
  Execution time = 2.9806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2244e-01
  Total weights = 2.0000e+06
  Execution time = 2.6946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427922313
                                         uncertainty =       0.002924463614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427922313
                                         uncertainty =       0.002924463614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523207
  error estimate for blocks of size 2^( 2) =       0.000411521200
  error estimate for blocks of size 2^( 3) =       0.000420626957
  error estimate for blocks of size 2^( 4) =       0.000427271436
  error estimate for blocks of size 2^( 5) =       0.000431506724
  error estimate for blocks of size 2^( 6) =       0.000434202690
  error estimate for blocks of size 2^( 7) =       0.000433563725

      target function =                  N/A
              le_mean =     -17.214496090764
             les_mean =     296.661317268771
             stat err =       0.000431636143
             autocorr =       1.155618018473
              std dev =       0.567839564558
             le_variance =       0.322441771077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427923692
                                         uncertainty =       0.002924463630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427923692
                                         uncertainty =       0.002924463630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523208
  error estimate for blocks of size 2^( 2) =       0.000411521201
  error estimate for blocks of size 2^( 3) =       0.000420626958
  error estimate for blocks of size 2^( 4) =       0.000427271436
  error estimate for blocks of size 2^( 5) =       0.000431506724
  error estimate for blocks of size 2^( 6) =       0.000434202690
  error estimate for blocks of size 2^( 7) =       0.000433563726

      target function =                  N/A
              le_mean =     -17.214496090781
             les_mean =     296.661317270749
             stat err =       0.000431636144
             autocorr =       1.155618017088
              std dev =       0.567839565773
             le_variance =       0.322441772457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427923002
                                         uncertainty =       0.002924463622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427923002
                                         uncertainty =       0.002924463622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523207
  error estimate for blocks of size 2^( 2) =       0.000411521201
  error estimate for blocks of size 2^( 3) =       0.000420626958
  error estimate for blocks of size 2^( 4) =       0.000427271436
  error estimate for blocks of size 2^( 5) =       0.000431506724
  error estimate for blocks of size 2^( 6) =       0.000434202690
  error estimate for blocks of size 2^( 7) =       0.000433563725

      target function =                  N/A
              le_mean =     -17.214496090772
             les_mean =     296.661317269760
             stat err =       0.000431636144
             autocorr =       1.155618017779
              std dev =       0.567839565165
             le_variance =       0.322441771767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427922399
                                         uncertainty =       0.002924463615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322427922399
                                         uncertainty =       0.002924463615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523207
  error estimate for blocks of size 2^( 2) =       0.000411521200
  error estimate for blocks of size 2^( 3) =       0.000420626957
  error estimate for blocks of size 2^( 4) =       0.000427271436
  error estimate for blocks of size 2^( 5) =       0.000431506724
  error estimate for blocks of size 2^( 6) =       0.000434202690
  error estimate for blocks of size 2^( 7) =       0.000433563725

      target function =                  N/A
              le_mean =     -17.214496090765
             les_mean =     296.661317268895
             stat err =       0.000431636143
             autocorr =       1.155618018384
              std dev =       0.567839564634
             le_variance =       0.322441771163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214496090764        initial
     9.5367e+04     9.5367e+05             3.6421e-09       -17.214496090781  <--
     3.8147e+05     3.8147e+06             9.1053e-10       -17.214496090772
     1.5259e+06     1.5259e+07             2.2763e-10       -17.214496090765

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 4.3399e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2364
    reference variance = 0.196501
====================================================
  Execution time = 3.0765e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2828e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328248672408
                                         uncertainty =       0.005001584184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328248672408
                                         uncertainty =       0.005001584184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405142013
  error estimate for blocks of size 2^( 2) =       0.000415471079
  error estimate for blocks of size 2^( 3) =       0.000424824292
  error estimate for blocks of size 2^( 4) =       0.000431414004
  error estimate for blocks of size 2^( 5) =       0.000435523683
  error estimate for blocks of size 2^( 6) =       0.000436341495
  error estimate for blocks of size 2^( 7) =       0.000436332903

      target function =                  N/A
              le_mean =     -17.214520881608
             les_mean =     296.668009119966
             stat err =       0.000434903021
             autocorr =       1.152312537085
              std dev =       0.572957328948
             le_variance =       0.328280100795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721452088161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214520881608       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214520881596       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214520881603       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214520881618       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214520881604       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214520881588       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214520881605       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.416458e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214520881608       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214520881605       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214520881607       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214520881606       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214520881668       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214520881554       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214520881656       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 3.541155e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214520881608       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214520881607       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214520881607       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214520881606       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214520881599       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214520881682       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214520881567       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 8.852896e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9259e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145123e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2949
    reference variance = 0.261562
====================================================
  Execution time = 2.9984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2256e-01
  Total weights = 2.0000e+06
  Execution time = 2.6816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260897395
                                         uncertainty =       0.002525128090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260897395
                                         uncertainty =       0.002525128090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401599557
  error estimate for blocks of size 2^( 2) =       0.000411891596
  error estimate for blocks of size 2^( 3) =       0.000420869979
  error estimate for blocks of size 2^( 4) =       0.000427478287
  error estimate for blocks of size 2^( 5) =       0.000431723096
  error estimate for blocks of size 2^( 6) =       0.000433837451
  error estimate for blocks of size 2^( 7) =       0.000435075197

      target function =                  N/A
              le_mean =     -17.214513808066
             les_mean =     296.662049895672
             stat err =       0.000432028508
             autocorr =       1.157279764460
              std dev =       0.567947540586
             le_variance =       0.322564408858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260902756
                                         uncertainty =       0.002525128141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260902756
                                         uncertainty =       0.002525128141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401599561
  error estimate for blocks of size 2^( 2) =       0.000411891599
  error estimate for blocks of size 2^( 3) =       0.000420869982
  error estimate for blocks of size 2^( 4) =       0.000427478290
  error estimate for blocks of size 2^( 5) =       0.000431723099
  error estimate for blocks of size 2^( 6) =       0.000433837453
  error estimate for blocks of size 2^( 7) =       0.000435075199

      target function =                  N/A
              le_mean =     -17.214513808039
             les_mean =     296.662049900102
             stat err =       0.000432028510
             autocorr =       1.157279757244
              std dev =       0.567947545300
             le_variance =       0.322564414212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260900076
                                         uncertainty =       0.002525128116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260900076
                                         uncertainty =       0.002525128116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401599559
  error estimate for blocks of size 2^( 2) =       0.000411891597
  error estimate for blocks of size 2^( 3) =       0.000420869981
  error estimate for blocks of size 2^( 4) =       0.000427478288
  error estimate for blocks of size 2^( 5) =       0.000431723097
  error estimate for blocks of size 2^( 6) =       0.000433837452
  error estimate for blocks of size 2^( 7) =       0.000435075198

      target function =                  N/A
              le_mean =     -17.214513808053
             les_mean =     296.662049897887
             stat err =       0.000432028509
             autocorr =       1.157279760859
              std dev =       0.567947542943
             le_variance =       0.322564411535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260897730
                                         uncertainty =       0.002525128093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322260897730
                                         uncertainty =       0.002525128093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401599558
  error estimate for blocks of size 2^( 2) =       0.000411891596
  error estimate for blocks of size 2^( 3) =       0.000420869980
  error estimate for blocks of size 2^( 4) =       0.000427478287
  error estimate for blocks of size 2^( 5) =       0.000431723096
  error estimate for blocks of size 2^( 6) =       0.000433837451
  error estimate for blocks of size 2^( 7) =       0.000435075197

      target function =                  N/A
              le_mean =     -17.214513808064
             les_mean =     296.662049895949
             stat err =       0.000432028508
             autocorr =       1.157279764012
              std dev =       0.567947540881
             le_variance =       0.322564409192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214513808066        initial  <--
     2.3842e+04     2.3842e+05             1.4165e-08       -17.214513808039
     9.5367e+04     9.5367e+05             3.5412e-09       -17.214513808053
     3.8147e+05     3.8147e+06             8.8529e-10       -17.214513808064

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5551
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2819e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2423
    reference variance = 0.25796
====================================================
  Execution time = 3.0463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3046e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483105397
                                         uncertainty =       0.005265046253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483105397
                                         uncertainty =       0.005265046253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406484362
  error estimate for blocks of size 2^( 2) =       0.000416776041
  error estimate for blocks of size 2^( 3) =       0.000425905526
  error estimate for blocks of size 2^( 4) =       0.000431750870
  error estimate for blocks of size 2^( 5) =       0.000436631059
  error estimate for blocks of size 2^( 6) =       0.000439244497
  error estimate for blocks of size 2^( 7) =       0.000439768794

      target function =                  N/A
              le_mean =     -17.215820158819
             les_mean =     296.714922649371
             stat err =       0.000436848805
             autocorr =       1.154980411827
              std dev =       0.574855698231
             le_variance =       0.330459073789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721582015882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820158819       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820158822       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820158823       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820158823       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215820158793       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215820158879       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215820158826       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.553863e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820158819       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820158820       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820158820       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820158820       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215820158435       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215820155697       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215820158520       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.884676e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820158819       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820158820       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820158820       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820158551       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215820160024       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215820161860       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215820158795       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 9.711598e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9187e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657345e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.280955
====================================================
  Execution time = 3.1592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2716e-01
  Total weights = 2.0000e+06
  Execution time = 2.8756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711863
                                         uncertainty =       0.002818386911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711863
                                         uncertainty =       0.002818386911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404452327
  error estimate for blocks of size 2^( 2) =       0.000414150543
  error estimate for blocks of size 2^( 3) =       0.000422936610
  error estimate for blocks of size 2^( 4) =       0.000429619655
  error estimate for blocks of size 2^( 5) =       0.000433031717
  error estimate for blocks of size 2^( 6) =       0.000434236801
  error estimate for blocks of size 2^( 7) =       0.000436400775

      target function =                  N/A
              le_mean =     -17.214208509411
             les_mean =     296.656137811940
             stat err =       0.000433322237
             autocorr =       1.147855648828
              std dev =       0.571981966524
             le_variance =       0.327163370028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711679
                                         uncertainty =       0.002818386914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711679
                                         uncertainty =       0.002818386914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404452327
  error estimate for blocks of size 2^( 2) =       0.000414150543
  error estimate for blocks of size 2^( 3) =       0.000422936610
  error estimate for blocks of size 2^( 4) =       0.000429619655
  error estimate for blocks of size 2^( 5) =       0.000433031717
  error estimate for blocks of size 2^( 6) =       0.000434236801
  error estimate for blocks of size 2^( 7) =       0.000436400775

      target function =                  N/A
              le_mean =     -17.214208509407
             les_mean =     296.656137811600
             stat err =       0.000433322237
             autocorr =       1.147855648836
              std dev =       0.571981966363
             le_variance =       0.327163369844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711771
                                         uncertainty =       0.002818386912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711771
                                         uncertainty =       0.002818386912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404452327
  error estimate for blocks of size 2^( 2) =       0.000414150543
  error estimate for blocks of size 2^( 3) =       0.000422936610
  error estimate for blocks of size 2^( 4) =       0.000429619655
  error estimate for blocks of size 2^( 5) =       0.000433031717
  error estimate for blocks of size 2^( 6) =       0.000434236801
  error estimate for blocks of size 2^( 7) =       0.000436400775

      target function =                  N/A
              le_mean =     -17.214208509409
             les_mean =     296.656137811770
             stat err =       0.000433322237
             autocorr =       1.147855648834
              std dev =       0.571981966443
             le_variance =       0.327163369936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711851
                                         uncertainty =       0.002818386911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190711851
                                         uncertainty =       0.002818386911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404452327
  error estimate for blocks of size 2^( 2) =       0.000414150543
  error estimate for blocks of size 2^( 3) =       0.000422936610
  error estimate for blocks of size 2^( 4) =       0.000429619655
  error estimate for blocks of size 2^( 5) =       0.000433031717
  error estimate for blocks of size 2^( 6) =       0.000434236801
  error estimate for blocks of size 2^( 7) =       0.000436400775

      target function =                  N/A
              le_mean =     -17.214208509411
             les_mean =     296.656137811919
             stat err =       0.000433322237
             autocorr =       1.147855648827
              std dev =       0.571981966514
             le_variance =       0.327163370017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214208509411        initial  <--
     2.3842e+05     2.3842e+06             1.5539e-09       -17.214208509407
     9.5367e+05     9.5367e+06             3.8847e-10       -17.214208509409
     3.8147e+06     3.8147e+07             9.7116e-11       -17.214208509411

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3503
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4543e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.317572
====================================================
  Execution time = 3.0743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320673579500
                                         uncertainty =       0.002464563065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320673579500
                                         uncertainty =       0.002464563065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400460971
  error estimate for blocks of size 2^( 2) =       0.000411014208
  error estimate for blocks of size 2^( 3) =       0.000419458920
  error estimate for blocks of size 2^( 4) =       0.000425627624
  error estimate for blocks of size 2^( 5) =       0.000429777815
  error estimate for blocks of size 2^( 6) =       0.000430725171
  error estimate for blocks of size 2^( 7) =       0.000430693212

      target function =                  N/A
              le_mean =     -17.215088143664
             les_mean =     296.679997612895
             stat err =       0.000429205956
             autocorr =       1.148711809759
              std dev =       0.566337336890
             le_variance =       0.320737979156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721508814366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215088143664       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215088143664       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215088143663       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215088143488       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215088144467       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215088144868       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215088144442       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.340542e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215088143664       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215088143664       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215088143664       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215088146415       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215088139118       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215088148635       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215088147471       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 3.351334e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215088143664       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215088143664       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215088143664       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215088143664       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215088125223       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215088143868       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215088181199       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 8.378479e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9381e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1873
    reference variance = 0.236864
====================================================
  Execution time = 3.0266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2938e-01
  Total weights = 2.0000e+06
  Execution time = 2.6727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946533
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946533
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405819275
  error estimate for blocks of size 2^( 2) =       0.000416073803
  error estimate for blocks of size 2^( 3) =       0.000425013767
  error estimate for blocks of size 2^( 4) =       0.000431897425
  error estimate for blocks of size 2^( 5) =       0.000436938557
  error estimate for blocks of size 2^( 6) =       0.000438092318
  error estimate for blocks of size 2^( 7) =       0.000440022287

      target function =                  N/A
              le_mean =     -17.215028642395
             les_mean =     296.686589561286
             stat err =       0.000436737647
             autocorr =       1.158179619445
              std dev =       0.573915122206
             le_variance =       0.329378567497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946649
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946649
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405819275
  error estimate for blocks of size 2^( 2) =       0.000416073803
  error estimate for blocks of size 2^( 3) =       0.000425013767
  error estimate for blocks of size 2^( 4) =       0.000431897425
  error estimate for blocks of size 2^( 5) =       0.000436938557
  error estimate for blocks of size 2^( 6) =       0.000438092318
  error estimate for blocks of size 2^( 7) =       0.000440022287

      target function =                  N/A
              le_mean =     -17.215028642395
             les_mean =     296.686589561392
             stat err =       0.000436737647
             autocorr =       1.158179619350
              std dev =       0.573915122307
             le_variance =       0.329378567613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946591
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946591
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405819275
  error estimate for blocks of size 2^( 2) =       0.000416073803
  error estimate for blocks of size 2^( 3) =       0.000425013767
  error estimate for blocks of size 2^( 4) =       0.000431897425
  error estimate for blocks of size 2^( 5) =       0.000436938557
  error estimate for blocks of size 2^( 6) =       0.000438092318
  error estimate for blocks of size 2^( 7) =       0.000440022287

      target function =                  N/A
              le_mean =     -17.215028642395
             les_mean =     296.686589561339
             stat err =       0.000436737647
             autocorr =       1.158179619394
              std dev =       0.573915122257
             le_variance =       0.329378567555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946540
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329420946540
                                         uncertainty =       0.005722207350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405819275
  error estimate for blocks of size 2^( 2) =       0.000416073803
  error estimate for blocks of size 2^( 3) =       0.000425013767
  error estimate for blocks of size 2^( 4) =       0.000431897425
  error estimate for blocks of size 2^( 5) =       0.000436938557
  error estimate for blocks of size 2^( 6) =       0.000438092318
  error estimate for blocks of size 2^( 7) =       0.000440022287

      target function =                  N/A
              le_mean =     -17.215028642395
             les_mean =     296.686589561293
             stat err =       0.000436737647
             autocorr =       1.158179619442
              std dev =       0.573915122212
             le_variance =       0.329378567504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215028642395        initial  <--
     2.3842e+06     2.3842e+07             1.3405e-10       -17.215028642395
     9.5367e+06     9.5367e+07             3.3513e-11       -17.215028642395
     3.8147e+07     3.8147e+08             8.3785e-12       -17.215028642395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7724
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.681602
====================================================
  Execution time = 3.0922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2391e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323924434940
                                         uncertainty =       0.002912980971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323924434940
                                         uncertainty =       0.002912980971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402438143
  error estimate for blocks of size 2^( 2) =       0.000412351014
  error estimate for blocks of size 2^( 3) =       0.000421848424
  error estimate for blocks of size 2^( 4) =       0.000428947377
  error estimate for blocks of size 2^( 5) =       0.000432331747
  error estimate for blocks of size 2^( 6) =       0.000436615442
  error estimate for blocks of size 2^( 7) =       0.000440723672

      target function =                  N/A
              le_mean =     -17.214714844603
             les_mean =     296.670319936588
             stat err =       0.000434654559
             autocorr =       1.166514676156
              std dev =       0.569133479569
             le_variance =       0.323912917567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721471484460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214714844603       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214714844603       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214714844602       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214714844603       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214714845506       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214714851223       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214714833840       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.208814e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214714844603       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214714844603       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214714844603       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214714844603       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214714868573       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214714840328       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214714855634       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.022020e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214714844603       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214714844603       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214714844603       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214714869389       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214715072094       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214714500999       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214714871316       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 7.557702e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064008 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9479e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.282965
====================================================
  Execution time = 3.0051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2978e-01
  Total weights = 2.0000e+06
  Execution time = 2.6993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323272
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323272
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406069417
  error estimate for blocks of size 2^( 2) =       0.000416273394
  error estimate for blocks of size 2^( 3) =       0.000424737776
  error estimate for blocks of size 2^( 4) =       0.000431192298
  error estimate for blocks of size 2^( 5) =       0.000434443716
  error estimate for blocks of size 2^( 6) =       0.000437451569
  error estimate for blocks of size 2^( 7) =       0.000435347188

      target function =                  N/A
              le_mean =     -17.213996348758
             les_mean =     296.651454872706
             stat err =       0.000434608692
             autocorr =       1.145503057821
              std dev =       0.574268876524
             le_variance =       0.329784742544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323280
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323280
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406069417
  error estimate for blocks of size 2^( 2) =       0.000416273394
  error estimate for blocks of size 2^( 3) =       0.000424737776
  error estimate for blocks of size 2^( 4) =       0.000431192298
  error estimate for blocks of size 2^( 5) =       0.000434443716
  error estimate for blocks of size 2^( 6) =       0.000437451569
  error estimate for blocks of size 2^( 7) =       0.000435347188

      target function =                  N/A
              le_mean =     -17.213996348758
             les_mean =     296.651454872713
             stat err =       0.000434608692
             autocorr =       1.145503057812
              std dev =       0.574268876531
             le_variance =       0.329784742552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323276
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323276
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406069417
  error estimate for blocks of size 2^( 2) =       0.000416273394
  error estimate for blocks of size 2^( 3) =       0.000424737776
  error estimate for blocks of size 2^( 4) =       0.000431192298
  error estimate for blocks of size 2^( 5) =       0.000434443716
  error estimate for blocks of size 2^( 6) =       0.000437451569
  error estimate for blocks of size 2^( 7) =       0.000435347188

      target function =                  N/A
              le_mean =     -17.213996348758
             les_mean =     296.651454872709
             stat err =       0.000434608692
             autocorr =       1.145503057815
              std dev =       0.574268876527
             le_variance =       0.329784742548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323273
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329883323273
                                         uncertainty =       0.003961983091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406069417
  error estimate for blocks of size 2^( 2) =       0.000416273394
  error estimate for blocks of size 2^( 3) =       0.000424737776
  error estimate for blocks of size 2^( 4) =       0.000431192298
  error estimate for blocks of size 2^( 5) =       0.000434443716
  error estimate for blocks of size 2^( 6) =       0.000437451569
  error estimate for blocks of size 2^( 7) =       0.000435347188

      target function =                  N/A
              le_mean =     -17.213996348758
             les_mean =     296.651454872706
             stat err =       0.000434608692
             autocorr =       1.145503057822
              std dev =       0.574268876524
             le_variance =       0.329784742544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213996348758        initial  <--
     2.3842e+07     2.3842e+08             1.2088e-11       -17.213996348758
     9.5367e+07     9.5367e+08             3.0220e-12       -17.213996348758
     3.8147e+08     3.8147e+09             7.5577e-13       -17.213996348758

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6551
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.191866
====================================================
  Execution time = 3.0756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2569e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325718234140
                                         uncertainty =       0.003634382641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325718234140
                                         uncertainty =       0.003634382641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403541061
  error estimate for blocks of size 2^( 2) =       0.000413683035
  error estimate for blocks of size 2^( 3) =       0.000422598077
  error estimate for blocks of size 2^( 4) =       0.000429369982
  error estimate for blocks of size 2^( 5) =       0.000433218621
  error estimate for blocks of size 2^( 6) =       0.000436165125
  error estimate for blocks of size 2^( 7) =       0.000437311863

      target function =                  N/A
              le_mean =     -17.214434249150
             les_mean =     296.662437131742
             stat err =       0.000434016398
             autocorr =       1.156742821596
              std dev =       0.570693241833
             le_variance =       0.325690776274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721443424915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214434249150       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214434249150       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214434249150       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214434249150       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214434250163       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214434272279       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214434139623       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.260770e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214434249150       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214434249150       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214434249150       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214434226782       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214434249532       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214434913531       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214434233870       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 3.149801e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214434249150       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214434249150       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214434249150       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214434450077       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214433198876       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214434204551       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214434757630       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 7.891496e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9234e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1891
    reference variance = 0.182501
====================================================
  Execution time = 2.9962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.4334e-01
  Total weights = 2.0000e+06
  Execution time = 2.6898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414329383
  error estimate for blocks of size 2^( 2) =       0.000423946887
  error estimate for blocks of size 2^( 3) =       0.000432942249
  error estimate for blocks of size 2^( 4) =       0.000439405322
  error estimate for blocks of size 2^( 5) =       0.000443066798
  error estimate for blocks of size 2^( 6) =       0.000444777324
  error estimate for blocks of size 2^( 7) =       0.000445332448

      target function =                  N/A
              le_mean =     -17.214233237665
             les_mean =     296.673163464855
             stat err =       0.000443145473
             autocorr =       1.143934523243
              std dev =       0.585950233220
             le_variance =       0.343337675811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414329383
  error estimate for blocks of size 2^( 2) =       0.000423946887
  error estimate for blocks of size 2^( 3) =       0.000432942249
  error estimate for blocks of size 2^( 4) =       0.000439405322
  error estimate for blocks of size 2^( 5) =       0.000443066798
  error estimate for blocks of size 2^( 6) =       0.000444777324
  error estimate for blocks of size 2^( 7) =       0.000445332448

      target function =                  N/A
              le_mean =     -17.214233237665
             les_mean =     296.673163464856
             stat err =       0.000443145473
             autocorr =       1.143934523251
              std dev =       0.585950233220
             le_variance =       0.343337675811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414329383
  error estimate for blocks of size 2^( 2) =       0.000423946887
  error estimate for blocks of size 2^( 3) =       0.000432942249
  error estimate for blocks of size 2^( 4) =       0.000439405322
  error estimate for blocks of size 2^( 5) =       0.000443066798
  error estimate for blocks of size 2^( 6) =       0.000444777324
  error estimate for blocks of size 2^( 7) =       0.000445332448

      target function =                  N/A
              le_mean =     -17.214233237665
             les_mean =     296.673163464855
             stat err =       0.000443145473
             autocorr =       1.143934523249
              std dev =       0.585950233220
             le_variance =       0.343337675811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343432232211
                                         uncertainty =       0.017249568495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414329383
  error estimate for blocks of size 2^( 2) =       0.000423946887
  error estimate for blocks of size 2^( 3) =       0.000432942249
  error estimate for blocks of size 2^( 4) =       0.000439405322
  error estimate for blocks of size 2^( 5) =       0.000443066798
  error estimate for blocks of size 2^( 6) =       0.000444777324
  error estimate for blocks of size 2^( 7) =       0.000445332448

      target function =                  N/A
              le_mean =     -17.214233237665
             les_mean =     296.673163464855
             stat err =       0.000443145473
             autocorr =       1.143934523242
              std dev =       0.585950233220
             le_variance =       0.343337675811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214233237665        initial  <--
     2.3842e+08     2.3842e+09             1.2608e-12       -17.214233237665
     9.5367e+08     9.5367e+09             3.1498e-13       -17.214233237665
     3.8147e+09     3.8147e+10             7.8915e-14       -17.214233237665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5452
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.246011
====================================================
  Execution time = 3.0696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326149482627
                                         uncertainty =       0.005533603123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326149482627
                                         uncertainty =       0.005533603123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403778825
  error estimate for blocks of size 2^( 2) =       0.000414358296
  error estimate for blocks of size 2^( 3) =       0.000423619467
  error estimate for blocks of size 2^( 4) =       0.000430786503
  error estimate for blocks of size 2^( 5) =       0.000434872712
  error estimate for blocks of size 2^( 6) =       0.000436912892
  error estimate for blocks of size 2^( 7) =       0.000437070073

      target function =                  N/A
              le_mean =     -17.214512308206
             les_mean =     296.665508524783
             stat err =       0.000434910545
             autocorr =       1.160146399941
              std dev =       0.571029489988
             le_variance =       0.326074678436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721451230821e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214512308206       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214512308206       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214512308206       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214512308206       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214508813512       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214518777727       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214514567546       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 1.665002e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214512308206       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214512308206       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214512308206       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214512481422       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214509845993       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214509955334       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214504539525       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214515287340       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 4.269963e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214512308206       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214512308206       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214512308206       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214512308206       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214499017251       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214512308206       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214521797922       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214506395373       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214518191186       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214566404845       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214349377275       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214477628702       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214520959329       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214493583194       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214401315530       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213735484414       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211761424062       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213862350098       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216289138747       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214429810538       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.212801615047       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.211425699694       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215883689532       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214054667135       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217592285720       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216853870507       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.204030914114       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216950686320       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217148660054       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.242112890254       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.211581684262       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.212966868694       residual = 2.92e-03           smallest_sin_value = 9.98e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 1.075295e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9417e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2849
    reference variance = 0.328967
====================================================
  Execution time = 3.0184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2488e-01
  Total weights = 2.0000e+06
  Execution time = 2.6817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403039466
  error estimate for blocks of size 2^( 2) =       0.000413353037
  error estimate for blocks of size 2^( 3) =       0.000422100271
  error estimate for blocks of size 2^( 4) =       0.000429941839
  error estimate for blocks of size 2^( 5) =       0.000434753123
  error estimate for blocks of size 2^( 6) =       0.000436307300
  error estimate for blocks of size 2^( 7) =       0.000438107366

      target function =                  N/A
              le_mean =     -17.214164474314
             les_mean =     296.652340008230
             stat err =       0.000434777407
             autocorr =       1.163693977604
              std dev =       0.569983878673
             le_variance =       0.324881621948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403039466
  error estimate for blocks of size 2^( 2) =       0.000413353037
  error estimate for blocks of size 2^( 3) =       0.000422100271
  error estimate for blocks of size 2^( 4) =       0.000429941839
  error estimate for blocks of size 2^( 5) =       0.000434753123
  error estimate for blocks of size 2^( 6) =       0.000436307300
  error estimate for blocks of size 2^( 7) =       0.000438107366

      target function =                  N/A
              le_mean =     -17.214164474314
             les_mean =     296.652340008230
             stat err =       0.000434777407
             autocorr =       1.163693977599
              std dev =       0.569983878673
             le_variance =       0.324881621948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403039466
  error estimate for blocks of size 2^( 2) =       0.000413353037
  error estimate for blocks of size 2^( 3) =       0.000422100271
  error estimate for blocks of size 2^( 4) =       0.000429941839
  error estimate for blocks of size 2^( 5) =       0.000434753123
  error estimate for blocks of size 2^( 6) =       0.000436307300
  error estimate for blocks of size 2^( 7) =       0.000438107366

      target function =                  N/A
              le_mean =     -17.214164474314
             les_mean =     296.652340008230
             stat err =       0.000434777407
             autocorr =       1.163693977604
              std dev =       0.569983878673
             le_variance =       0.324881621948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324798021247
                                         uncertainty =       0.003622812993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403039466
  error estimate for blocks of size 2^( 2) =       0.000413353037
  error estimate for blocks of size 2^( 3) =       0.000422100271
  error estimate for blocks of size 2^( 4) =       0.000429941839
  error estimate for blocks of size 2^( 5) =       0.000434753123
  error estimate for blocks of size 2^( 6) =       0.000436307300
  error estimate for blocks of size 2^( 7) =       0.000438107366

      target function =                  N/A
              le_mean =     -17.214164474314
             les_mean =     296.652340008230
             stat err =       0.000434777407
             autocorr =       1.163693977602
              std dev =       0.569983878674
             le_variance =       0.324881621948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214164474314        initial  <--
     2.3842e+09     2.3842e+10             1.6650e-13       -17.214164474314
     9.5367e+09     9.5367e+10             4.2700e-14       -17.214164474314
     3.8147e+10     3.8147e+11             1.0753e-14       -17.214164474314

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7387
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2489
    reference variance = 0.180184
====================================================
  Execution time = 3.0632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3145e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331545245557
                                         uncertainty =       0.009087444195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331545245557
                                         uncertainty =       0.009087444195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407093173
  error estimate for blocks of size 2^( 2) =       0.000417201816
  error estimate for blocks of size 2^( 3) =       0.000426658195
  error estimate for blocks of size 2^( 4) =       0.000433118251
  error estimate for blocks of size 2^( 5) =       0.000436814296
  error estimate for blocks of size 2^( 6) =       0.000441211738
  error estimate for blocks of size 2^( 7) =       0.000441148183

      target function =                  N/A
              le_mean =     -17.214223389545
             les_mean =     296.660936442339
             stat err =       0.000438073117
             autocorr =       1.157992021324
              std dev =       0.575716686314
             le_variance =       0.331449702900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721422338955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214223389545       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214223389545       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214223389545       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214219755663       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214226714836       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214228659840       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214226136958       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 1.386187e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214223389545       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214223389545       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214223389545       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214223389545       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214201298714       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214230480205       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214309546026       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214251274664       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214078199704       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214472005607       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215835430624       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214127408066       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213460470311       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214306511037       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213680018251       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213422276054       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.212776637401       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.208403308049       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216481504468       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.223301761532       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.202716923591       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.220058190720       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.224737429361       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.210358824434       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.233810862237       residual = 6.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216266611161       residual = 9.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.246736624942       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.169139675547       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.229222217957       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.003855990482       residual = 6.76e+00           smallest_sin_value = 9.98e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 3.439717e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214223389545       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214223389545       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214223389545       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214223389545       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214223389545       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213922406069       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214223371261       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214929933590       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212199015710       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210532337047       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215954501367       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214062214748       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215364594782       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214022928552       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.210857644784       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.212704340934       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.191675155422       residual = 7.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211052861186       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.209140895958       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.195566657564       residual = 5.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.209927397342       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215411159889       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.212884225011       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.172689743735       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.269434525038       residual = 5.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.127088790054       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.119033705312       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.251286236242       residual = 2.22e-01           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.178310806812       residual = 1.98e-01           smallest_sin_value = 9.97e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 7.969460e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9236e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.145226
====================================================
  Execution time = 3.0184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 4.1894e-01
  Total weights = 2.0000e+06
  Execution time = 2.6850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457677580
  error estimate for blocks of size 2^( 2) =       0.000466289423
  error estimate for blocks of size 2^( 3) =       0.000474152434
  error estimate for blocks of size 2^( 4) =       0.000480160256
  error estimate for blocks of size 2^( 5) =       0.000484079228
  error estimate for blocks of size 2^( 6) =       0.000485930796
  error estimate for blocks of size 2^( 7) =       0.000486723436

      target function =                  N/A
              le_mean =     -17.215161201394
             les_mean =     296.780712515736
             stat err =       0.000484223429
             autocorr =       1.119366537681
              std dev =       0.647253841420
             le_variance =       0.418937535233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457677580
  error estimate for blocks of size 2^( 2) =       0.000466289423
  error estimate for blocks of size 2^( 3) =       0.000474152434
  error estimate for blocks of size 2^( 4) =       0.000480160256
  error estimate for blocks of size 2^( 5) =       0.000484079228
  error estimate for blocks of size 2^( 6) =       0.000485930796
  error estimate for blocks of size 2^( 7) =       0.000486723436

      target function =                  N/A
              le_mean =     -17.215161201394
             les_mean =     296.780712515736
             stat err =       0.000484223429
             autocorr =       1.119366537679
              std dev =       0.647253841420
             le_variance =       0.418937535233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457677580
  error estimate for blocks of size 2^( 2) =       0.000466289423
  error estimate for blocks of size 2^( 3) =       0.000474152434
  error estimate for blocks of size 2^( 4) =       0.000480160256
  error estimate for blocks of size 2^( 5) =       0.000484079228
  error estimate for blocks of size 2^( 6) =       0.000485930796
  error estimate for blocks of size 2^( 7) =       0.000486723436

      target function =                  N/A
              le_mean =     -17.215161201394
             les_mean =     296.780712515736
             stat err =       0.000484223429
             autocorr =       1.119366537681
              std dev =       0.647253841420
             le_variance =       0.418937535233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419080599470
                                         uncertainty =       0.093004364443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457677580
  error estimate for blocks of size 2^( 2) =       0.000466289423
  error estimate for blocks of size 2^( 3) =       0.000474152434
  error estimate for blocks of size 2^( 4) =       0.000480160256
  error estimate for blocks of size 2^( 5) =       0.000484079228
  error estimate for blocks of size 2^( 6) =       0.000485930796
  error estimate for blocks of size 2^( 7) =       0.000486723436

      target function =                  N/A
              le_mean =     -17.215161201394
             les_mean =     296.780712515736
             stat err =       0.000484223429
             autocorr =       1.119366537681
              std dev =       0.647253841420
             le_variance =       0.418937535233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215161201394        initial  <--
     2.3842e+10     2.3842e+11             1.3862e-14       -17.215161201394
     9.5367e+10     9.5367e+11             3.4397e-15       -17.215161201394
     3.8147e+11     3.8147e+12             7.9695e-16       -17.215161201394

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7281
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2969e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2324
    reference variance = 0.197706
====================================================
  Execution time = 3.0570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2189e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322005869289
                                         uncertainty =       0.002975760317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322005869289
                                         uncertainty =       0.002975760317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401182558
  error estimate for blocks of size 2^( 2) =       0.000411388507
  error estimate for blocks of size 2^( 3) =       0.000419937121
  error estimate for blocks of size 2^( 4) =       0.000426554036
  error estimate for blocks of size 2^( 5) =       0.000430089928
  error estimate for blocks of size 2^( 6) =       0.000433271125
  error estimate for blocks of size 2^( 7) =       0.000432421262

      target function =                  N/A
              le_mean =     -17.214816143036
             les_mean =     296.671789567816
             stat err =       0.000430584088
             autocorr =       1.151945324144
              std dev =       0.567357815005
             le_variance =       0.321894890247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721481614304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214816143036       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214816143036       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214816143036       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214816143036       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214816143036       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214839920922       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214932186184       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215083273930       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215123108314       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215688560093       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212786388576       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214543615457       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214981152486       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211360433980       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216560597114       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.198770063048       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.223407239792       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.243977263277       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.196401193771       residual = 5.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.229622698634       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.232185149025       residual = 4.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213464335541       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.186141569860       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217532709896       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.210637896433       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.159445493447       residual = 4.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.201057110975       residual = 2.97e-02           smallest_sin_value = 9.96e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 1.457993e-15

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214816143036       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214816143036       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214816143036       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214816143036       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214816143036       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214490546701       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214748967485       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212253322367       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216291190803       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.218687665397       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.221185328371       residual = 6.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212357302807       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.180967740390       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.208276658776       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211775564989       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.253035983369       residual = 2.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.244018486517       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.199187527640       residual = 4.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217646898525       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.227041878272       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.245574173090       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213750390744       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.237965910156       residual = 9.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.224191956647       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.187356086716       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.294767961039       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.448777079073       residual = 9.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.217337632822       residual = 4.24e-02           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.946056013534       residual = 1.06e+01           smallest_sin_value = 9.97e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.147525039385       residual = 7.58e-01           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.56e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 3.690612e-16

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214816143036       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214816143036       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214816143036       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214816143036       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214748151945       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215303211452       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.222374709756       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.220597536899       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.252568485065       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.204782096088       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.179829297840       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.185598780704       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.226886015167       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.281755887043       residual = 7.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.219319108535       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.058550178804       residual = 3.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.284274536354       residual = 7.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.417305546351       residual = 6.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.898143476203       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.485420233265       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.112551299385       residual = 1.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.305782962278       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.598747472496       residual = 2.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.097749659244       residual = 2.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.835562531726       residual = 6.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.617759017570       residual = 2.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.803535668124       residual = 5.66e+01           smallest_sin_value = 9.98e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9155e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1442
    reference variance = 0.542156
====================================================
  Execution time = 2.9852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1983e-01
  Total weights = 2.0000e+06
  Execution time = 2.6912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399895764
  error estimate for blocks of size 2^( 2) =       0.000409921046
  error estimate for blocks of size 2^( 3) =       0.000418616622
  error estimate for blocks of size 2^( 4) =       0.000424839896
  error estimate for blocks of size 2^( 5) =       0.000429105907
  error estimate for blocks of size 2^( 6) =       0.000432692248
  error estimate for blocks of size 2^( 7) =       0.000434170477

      target function =                  N/A
              le_mean =     -17.214425373120
             les_mean =     296.656274011444
             stat err =       0.000430202132
             autocorr =       1.157314804217
              std dev =       0.565538013453
             le_variance =       0.319833244660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399895764
  error estimate for blocks of size 2^( 2) =       0.000409921046
  error estimate for blocks of size 2^( 3) =       0.000418616622
  error estimate for blocks of size 2^( 4) =       0.000424839896
  error estimate for blocks of size 2^( 5) =       0.000429105907
  error estimate for blocks of size 2^( 6) =       0.000432692248
  error estimate for blocks of size 2^( 7) =       0.000434170477

      target function =                  N/A
              le_mean =     -17.214425373120
             les_mean =     296.656274011444
             stat err =       0.000430202132
             autocorr =       1.157314804216
              std dev =       0.565538013453
             le_variance =       0.319833244660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399895764
  error estimate for blocks of size 2^( 2) =       0.000409921046
  error estimate for blocks of size 2^( 3) =       0.000418616622
  error estimate for blocks of size 2^( 4) =       0.000424839896
  error estimate for blocks of size 2^( 5) =       0.000429105907
  error estimate for blocks of size 2^( 6) =       0.000432692248
  error estimate for blocks of size 2^( 7) =       0.000434170477

      target function =                  N/A
              le_mean =     -17.214425373120
             les_mean =     296.656274011444
             stat err =       0.000430202132
             autocorr =       1.157314804219
              std dev =       0.565538013453
             le_variance =       0.319833244660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319792540395
                                         uncertainty =       0.002574728812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399895764
  error estimate for blocks of size 2^( 2) =       0.000409921046
  error estimate for blocks of size 2^( 3) =       0.000418616622
  error estimate for blocks of size 2^( 4) =       0.000424839896
  error estimate for blocks of size 2^( 5) =       0.000429105907
  error estimate for blocks of size 2^( 6) =       0.000432692248
  error estimate for blocks of size 2^( 7) =       0.000434170477

      target function =                  N/A
              le_mean =     -17.214425373120
             les_mean =     296.656274011444
             stat err =       0.000430202132
             autocorr =       1.157314804217
              std dev =       0.565538013453
             le_variance =       0.319833244660


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214425373120        initial  <--
     2.3842e+11     2.3842e+12             1.4580e-15       -17.214425373120
     9.5367e+11     9.5367e+12             3.6906e-16       -17.214425373120
     3.8147e+12     3.8147e+13             0.0000e+00       -17.214425373120

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4245
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.319826
====================================================
  Execution time = 3.0466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2752e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327554876303
                                         uncertainty =       0.007002478495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327554876303
                                         uncertainty =       0.007002478495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404670078
  error estimate for blocks of size 2^( 2) =       0.000414514925
  error estimate for blocks of size 2^( 3) =       0.000423171044
  error estimate for blocks of size 2^( 4) =       0.000430252938
  error estimate for blocks of size 2^( 5) =       0.000433520180
  error estimate for blocks of size 2^( 6) =       0.000436694364
  error estimate for blocks of size 2^( 7) =       0.000437661801

      target function =                  N/A
              le_mean =     -17.214751389144
             les_mean =     296.675180970485
             stat err =       0.000434532321
             autocorr =       1.153033654979
              std dev =       0.572289912716
             le_variance =       0.327515744197


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721475138914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214751389144       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214751389144       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214751389144       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214751389144       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214837242991       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212454532482       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214472389862       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212815977492       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.204401786164       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.225622723203       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.174682614380       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.192650620130       residual = 6.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.196587665524       residual = 5.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.169076991362       residual = 3.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.139232035145       residual = 8.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.137339815374       residual = 8.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.289654936097       residual = 8.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.113255522521       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.449250872717       residual = 8.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.397547340185       residual = 5.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.496957144961       residual = 1.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.264805236548       residual = 5.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.211887768774       residual = 6.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.162667708969       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.617766035370       residual = 3.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.266358733096       residual = 5.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.421010711087       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.401896565086       residual = 5.39e+00           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.347077838672       residual = 1.24e+01           smallest_sin_value = 9.97e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.50e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 6.498755e-17

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214751389144       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214751389144       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214751389144       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213110282895       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213695709080       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.221593747517       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.281798623503       residual = 7.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.261302563726       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.267521851215       residual = 4.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.358283857492       residual = 3.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.192728452434       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.346560411832       residual = 3.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.207950828063       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.258788763867       residual = 3.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.297171148530       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.248629234506       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.454872737211       residual = 9.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.188161437303       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -14.523209994833       residual = 1.10e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.835276225326       residual = 3.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.822376528546       residual = 5.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -18.551382461737       residual = 2.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.479978576490       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.235414725201       residual = 1.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.235199929771       residual = 2.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -20.014800333154       residual = 1.19e+03           smallest_sin_value = 9.99e-01
davidson iteration   26:   krylov dim =  27   energy =     -18.080134110469       residual = 1.27e+02           smallest_sin_value = 9.96e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 1.370510e-17

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214751389144       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214751389144       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214751389144       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215371308809       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.207101042429       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.231938140120       residual = 4.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.400977362755       residual = 5.24e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.350638977239       residual = 2.79e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.005978215632       residual = 6.50e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.291439869453       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.150872471264       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.220028278515       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -18.795551097781       residual = 4.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -19.995030457480       residual = 1.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -13.513355206347       residual = 2.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.490533236377       residual = 2.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -19.181757710629       residual = 5.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215727130413       residual = 3.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -19.186056197429       residual = 5.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -10.571162454775       residual = 6.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.092279053846       residual = 3.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.330482959487       residual = 2.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -23.969128025655       residual = 7.45e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -19.518519010656       residual = 8.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.995436586894       residual = 5.54e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -15.522775399721       residual = 1.41e+03           smallest_sin_value = 9.99e-01
davidson iteration   26:   krylov dim =  27   energy =     -15.742318104638       residual = 8.62e+02           smallest_sin_value = 9.93e-01
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 3.426275e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9070e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.231469
====================================================
  Execution time = 2.9910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2725e-01
  Total weights = 2.0000e+06
  Execution time = 2.6976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404506431
  error estimate for blocks of size 2^( 2) =       0.000414752703
  error estimate for blocks of size 2^( 3) =       0.000423627690
  error estimate for blocks of size 2^( 4) =       0.000430697751
  error estimate for blocks of size 2^( 5) =       0.000433850212
  error estimate for blocks of size 2^( 6) =       0.000434480190
  error estimate for blocks of size 2^( 7) =       0.000437044158

      target function =                  N/A
              le_mean =     -17.214588583676
             les_mean =     296.669310847227
             stat err =       0.000434018078
             autocorr =       1.151237100827
              std dev =       0.572058480946
             le_variance =       0.327250905622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404506431
  error estimate for blocks of size 2^( 2) =       0.000414752703
  error estimate for blocks of size 2^( 3) =       0.000423627690
  error estimate for blocks of size 2^( 4) =       0.000430697751
  error estimate for blocks of size 2^( 5) =       0.000433850212
  error estimate for blocks of size 2^( 6) =       0.000434480190
  error estimate for blocks of size 2^( 7) =       0.000437044158

      target function =                  N/A
              le_mean =     -17.214588583676
             les_mean =     296.669310847227
             stat err =       0.000434018078
             autocorr =       1.151237100827
              std dev =       0.572058480946
             le_variance =       0.327250905622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404506431
  error estimate for blocks of size 2^( 2) =       0.000414752703
  error estimate for blocks of size 2^( 3) =       0.000423627690
  error estimate for blocks of size 2^( 4) =       0.000430697751
  error estimate for blocks of size 2^( 5) =       0.000433850212
  error estimate for blocks of size 2^( 6) =       0.000434480190
  error estimate for blocks of size 2^( 7) =       0.000437044158

      target function =                  N/A
              le_mean =     -17.214588583676
             les_mean =     296.669310847227
             stat err =       0.000434018078
             autocorr =       1.151237100829
              std dev =       0.572058480946
             le_variance =       0.327250905622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327319733315
                                         uncertainty =       0.003869790090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404506431
  error estimate for blocks of size 2^( 2) =       0.000414752703
  error estimate for blocks of size 2^( 3) =       0.000423627690
  error estimate for blocks of size 2^( 4) =       0.000430697751
  error estimate for blocks of size 2^( 5) =       0.000433850212
  error estimate for blocks of size 2^( 6) =       0.000434480190
  error estimate for blocks of size 2^( 7) =       0.000437044158

      target function =                  N/A
              le_mean =     -17.214588583676
             les_mean =     296.669310847227
             stat err =       0.000434018078
             autocorr =       1.151237100827
              std dev =       0.572058480946
             le_variance =       0.327250905622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214588583676        initial  <--
     2.3842e+12     2.3842e+13             6.4988e-17       -17.214588583676
     9.5367e+12     9.5367e+13             1.3705e-17       -17.214588583676
     3.8147e+13     3.8147e+14             3.4263e-18       -17.214588583676

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5117
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2705
    reference variance = 0.747518
====================================================
  Execution time = 3.3031e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2659e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326616587121
                                         uncertainty =       0.004029192456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326616587121
                                         uncertainty =       0.004029192456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404096404
  error estimate for blocks of size 2^( 2) =       0.000414344062
  error estimate for blocks of size 2^( 3) =       0.000423141789
  error estimate for blocks of size 2^( 4) =       0.000429741183
  error estimate for blocks of size 2^( 5) =       0.000434483958
  error estimate for blocks of size 2^( 6) =       0.000436495266
  error estimate for blocks of size 2^( 7) =       0.000438464916

      target function =                  N/A
              le_mean =     -17.214482393735
             les_mean =     296.664991728869
             stat err =       0.000434796331
             autocorr =       1.157715288629
              std dev =       0.571478615470
             le_variance =       0.326587807940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721448239374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214482393735       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214482393735       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214482393735       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214482393735       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214482393735       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.326461952039       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215197123267       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.430233397027       residual = 5.70e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.756972894279       residual = 3.48e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.441930969725       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.978585365748       residual = 9.18e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.019605401265       residual = 5.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.531352338455       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.800496066489       residual = 4.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.491955853180       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -19.906989802098       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -19.120856361780       residual = 6.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.622818866811       residual = 5.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =      -8.116210351299       residual = 1.26e+04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -12.749446479189       residual = 3.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -26.470333173790       residual = 1.31e+04           smallest_sin_value = 1.00e+00
davidson iteration   19 stopping due to too large eigenvalue change
davidson solver did not converge after         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 4.005675e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214482393735       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214482393735       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1779e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.455922
====================================================
  Execution time = 3.0134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3017e-01
  Total weights = 2.0000e+06
  Execution time = 2.6955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406308667
  error estimate for blocks of size 2^( 2) =       0.000416631397
  error estimate for blocks of size 2^( 3) =       0.000425213627
  error estimate for blocks of size 2^( 4) =       0.000431771151
  error estimate for blocks of size 2^( 5) =       0.000435051177
  error estimate for blocks of size 2^( 6) =       0.000438520598
  error estimate for blocks of size 2^( 7) =       0.000438821682

      target function =                  N/A
              le_mean =     -17.214701614556
             les_mean =     296.676124978222
             stat err =       0.000436041152
             autocorr =       1.151709063817
              std dev =       0.574607226809
             le_variance =       0.330173465101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406308667
  error estimate for blocks of size 2^( 2) =       0.000416631397
  error estimate for blocks of size 2^( 3) =       0.000425213627
  error estimate for blocks of size 2^( 4) =       0.000431771151
  error estimate for blocks of size 2^( 5) =       0.000435051177
  error estimate for blocks of size 2^( 6) =       0.000438520598
  error estimate for blocks of size 2^( 7) =       0.000438821682

      target function =                  N/A
              le_mean =     -17.214701614556
             les_mean =     296.676124978222
             stat err =       0.000436041152
             autocorr =       1.151709063817
              std dev =       0.574607226809
             le_variance =       0.330173465101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406308667
  error estimate for blocks of size 2^( 2) =       0.000416631397
  error estimate for blocks of size 2^( 3) =       0.000425213627
  error estimate for blocks of size 2^( 4) =       0.000431771151
  error estimate for blocks of size 2^( 5) =       0.000435051177
  error estimate for blocks of size 2^( 6) =       0.000438520598
  error estimate for blocks of size 2^( 7) =       0.000438821682

      target function =                  N/A
              le_mean =     -17.214701614556
             les_mean =     296.676124978222
             stat err =       0.000436041152
             autocorr =       1.151709063817
              std dev =       0.574607226809
             le_variance =       0.330173465101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330216490626
                                         uncertainty =       0.003660621671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406308667
  error estimate for blocks of size 2^( 2) =       0.000416631397
  error estimate for blocks of size 2^( 3) =       0.000425213627
  error estimate for blocks of size 2^( 4) =       0.000431771151
  error estimate for blocks of size 2^( 5) =       0.000435051177
  error estimate for blocks of size 2^( 6) =       0.000438520598
  error estimate for blocks of size 2^( 7) =       0.000438821682

      target function =                  N/A
              le_mean =     -17.214701614556
             les_mean =     296.676124978222
             stat err =       0.000436041152
             autocorr =       1.151709063817
              std dev =       0.574607226809
             le_variance =       0.330173465101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214701614556        initial  <--
     2.3842e+13     2.3842e+14             0.0000e+00       -17.214701614556
     9.5367e+13     9.5367e+14             4.0057e-19       -17.214701614556
     3.8147e+14     3.8147e+15             0.0000e+00       -17.214701614556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7267
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5511e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2651
    reference variance = 0.282188
====================================================
  Execution time = 3.0939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2072e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320565325532
                                         uncertainty =       0.002751216579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320565325532
                                         uncertainty =       0.002751216579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400449512
  error estimate for blocks of size 2^( 2) =       0.000410886540
  error estimate for blocks of size 2^( 3) =       0.000420318101
  error estimate for blocks of size 2^( 4) =       0.000427574136
  error estimate for blocks of size 2^( 5) =       0.000431482181
  error estimate for blocks of size 2^( 6) =       0.000433051403
  error estimate for blocks of size 2^( 7) =       0.000435924767

      target function =                  N/A
              le_mean =     -17.214021632506
             les_mean =     296.643260227041
             stat err =       0.000432008122
             autocorr =       1.163826618183
              std dev =       0.566321130652
             le_variance =       0.320719623024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721402163251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214021632506       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214021632506       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214021632506       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214021632506       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214021632506       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214021632506       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9405e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.274607
====================================================
  Execution time = 3.0099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2703e-01
  Total weights = 2.0000e+06
  Execution time = 2.6857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404372831
  error estimate for blocks of size 2^( 2) =       0.000414636422
  error estimate for blocks of size 2^( 3) =       0.000423382733
  error estimate for blocks of size 2^( 4) =       0.000430021892
  error estimate for blocks of size 2^( 5) =       0.000435354288
  error estimate for blocks of size 2^( 6) =       0.000437413842
  error estimate for blocks of size 2^( 7) =       0.000438400099

      target function =                  N/A
              le_mean =     -17.214246516864
             les_mean =     296.657317752661
             stat err =       0.000435297531
             autocorr =       1.158799955351
              std dev =       0.571869541778
             le_variance =       0.327034772813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404372831
  error estimate for blocks of size 2^( 2) =       0.000414636422
  error estimate for blocks of size 2^( 3) =       0.000423382733
  error estimate for blocks of size 2^( 4) =       0.000430021892
  error estimate for blocks of size 2^( 5) =       0.000435354288
  error estimate for blocks of size 2^( 6) =       0.000437413842
  error estimate for blocks of size 2^( 7) =       0.000438400099

      target function =                  N/A
              le_mean =     -17.214246516864
             les_mean =     296.657317752661
             stat err =       0.000435297531
             autocorr =       1.158799955351
              std dev =       0.571869541778
             le_variance =       0.327034772813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404372831
  error estimate for blocks of size 2^( 2) =       0.000414636422
  error estimate for blocks of size 2^( 3) =       0.000423382733
  error estimate for blocks of size 2^( 4) =       0.000430021892
  error estimate for blocks of size 2^( 5) =       0.000435354288
  error estimate for blocks of size 2^( 6) =       0.000437413842
  error estimate for blocks of size 2^( 7) =       0.000438400099

      target function =                  N/A
              le_mean =     -17.214246516864
             les_mean =     296.657317752661
             stat err =       0.000435297531
             autocorr =       1.158799955351
              std dev =       0.571869541778
             le_variance =       0.327034772813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980571468
                                         uncertainty =       0.003804699299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404372831
  error estimate for blocks of size 2^( 2) =       0.000414636422
  error estimate for blocks of size 2^( 3) =       0.000423382733
  error estimate for blocks of size 2^( 4) =       0.000430021892
  error estimate for blocks of size 2^( 5) =       0.000435354288
  error estimate for blocks of size 2^( 6) =       0.000437413842
  error estimate for blocks of size 2^( 7) =       0.000438400099

      target function =                  N/A
              le_mean =     -17.214246516864
             les_mean =     296.657317752661
             stat err =       0.000435297531
             autocorr =       1.158799955351
              std dev =       0.571869541778
             le_variance =       0.327034772813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214246516864        initial  <--
     2.3842e+14     2.3842e+15             0.0000e+00       -17.214246516864
     9.5367e+14     9.5367e+15             0.0000e+00       -17.214246516864
     3.8147e+15     3.8147e+16             0.0000e+00       -17.214246516864

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6694
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.175378
====================================================
  Execution time = 3.0509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321137405681
                                         uncertainty =       0.004654239534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321137405681
                                         uncertainty =       0.004654239534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400693834
  error estimate for blocks of size 2^( 2) =       0.000410865764
  error estimate for blocks of size 2^( 3) =       0.000420038105
  error estimate for blocks of size 2^( 4) =       0.000426477256
  error estimate for blocks of size 2^( 5) =       0.000430549909
  error estimate for blocks of size 2^( 6) =       0.000434374500
  error estimate for blocks of size 2^( 7) =       0.000436996407

      target function =                  N/A
              le_mean =     -17.214070389498
             les_mean =     296.645330311469
             stat err =       0.000432099518
             autocorr =       1.162899663426
              std dev =       0.566666654605
             le_variance =       0.321111097441


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721407038950e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214070389498       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214070389498       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214070389498       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214070389498       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214070389498       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214070389498       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8908e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1639
    reference variance = 0.169387
====================================================
  Execution time = 3.0641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2273e-01
  Total weights = 2.0000e+06
  Execution time = 2.6939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699825
  error estimate for blocks of size 2^( 2) =       0.000412269024
  error estimate for blocks of size 2^( 3) =       0.000421365384
  error estimate for blocks of size 2^( 4) =       0.000427807479
  error estimate for blocks of size 2^( 5) =       0.000432363592
  error estimate for blocks of size 2^( 6) =       0.000434605860
  error estimate for blocks of size 2^( 7) =       0.000437168715

      target function =                  N/A
              le_mean =     -17.214243113369
             les_mean =     296.652891303026
             stat err =       0.000432986411
             autocorr =       1.161837124760
              std dev =       0.568089339983
             le_variance =       0.322725498202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699825
  error estimate for blocks of size 2^( 2) =       0.000412269024
  error estimate for blocks of size 2^( 3) =       0.000421365384
  error estimate for blocks of size 2^( 4) =       0.000427807479
  error estimate for blocks of size 2^( 5) =       0.000432363592
  error estimate for blocks of size 2^( 6) =       0.000434605860
  error estimate for blocks of size 2^( 7) =       0.000437168715

      target function =                  N/A
              le_mean =     -17.214243113369
             les_mean =     296.652891303026
             stat err =       0.000432986411
             autocorr =       1.161837124760
              std dev =       0.568089339983
             le_variance =       0.322725498202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699825
  error estimate for blocks of size 2^( 2) =       0.000412269024
  error estimate for blocks of size 2^( 3) =       0.000421365384
  error estimate for blocks of size 2^( 4) =       0.000427807479
  error estimate for blocks of size 2^( 5) =       0.000432363592
  error estimate for blocks of size 2^( 6) =       0.000434605860
  error estimate for blocks of size 2^( 7) =       0.000437168715

      target function =                  N/A
              le_mean =     -17.214243113369
             les_mean =     296.652891303026
             stat err =       0.000432986411
             autocorr =       1.161837124760
              std dev =       0.568089339983
             le_variance =       0.322725498202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322777202721
                                         uncertainty =       0.002692796561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699825
  error estimate for blocks of size 2^( 2) =       0.000412269024
  error estimate for blocks of size 2^( 3) =       0.000421365384
  error estimate for blocks of size 2^( 4) =       0.000427807479
  error estimate for blocks of size 2^( 5) =       0.000432363592
  error estimate for blocks of size 2^( 6) =       0.000434605860
  error estimate for blocks of size 2^( 7) =       0.000437168715

      target function =                  N/A
              le_mean =     -17.214243113369
             les_mean =     296.652891303026
             stat err =       0.000432986411
             autocorr =       1.161837124760
              std dev =       0.568089339983
             le_variance =       0.322725498202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214243113369        initial  <--
     2.3842e+15     2.3842e+16             0.0000e+00       -17.214243113369
     9.5367e+15     9.5367e+16             0.0000e+00       -17.214243113369
     3.8147e+16     3.8147e+17             0.0000e+00       -17.214243113369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3054
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2251
    reference variance = 0.250103
====================================================
  Execution time = 3.0535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323889754644
                                         uncertainty =       0.002464703789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323889754644
                                         uncertainty =       0.002464703789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402406727
  error estimate for blocks of size 2^( 2) =       0.000412680907
  error estimate for blocks of size 2^( 3) =       0.000421512005
  error estimate for blocks of size 2^( 4) =       0.000428320774
  error estimate for blocks of size 2^( 5) =       0.000432515943
  error estimate for blocks of size 2^( 6) =       0.000434414729
  error estimate for blocks of size 2^( 7) =       0.000434790976

      target function =                  N/A
              le_mean =     -17.215362709788
             les_mean =     296.692575416235
             stat err =       0.000432510605
             autocorr =       1.155215630058
              std dev =       0.569089051568
             le_variance =       0.323862348615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721536270979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215362709788       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215362709788       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215362709788       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215362709788       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215362709788       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215362709788       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9012e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.226
    reference variance = 0.153918
====================================================
  Execution time = 3.2341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2626e-01
  Total weights = 2.0000e+06
  Execution time = 2.6927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403894702
  error estimate for blocks of size 2^( 2) =       0.000413968430
  error estimate for blocks of size 2^( 3) =       0.000422960721
  error estimate for blocks of size 2^( 4) =       0.000428852828
  error estimate for blocks of size 2^( 5) =       0.000433544379
  error estimate for blocks of size 2^( 6) =       0.000437359677
  error estimate for blocks of size 2^( 7) =       0.000437198304

      target function =                  N/A
              le_mean =     -17.214011249471
             les_mean =     296.648444994035
             stat err =       0.000434238797
             autocorr =       1.155901782021
              std dev =       0.571193365042
             le_variance =       0.326261860268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403894702
  error estimate for blocks of size 2^( 2) =       0.000413968430
  error estimate for blocks of size 2^( 3) =       0.000422960721
  error estimate for blocks of size 2^( 4) =       0.000428852828
  error estimate for blocks of size 2^( 5) =       0.000433544379
  error estimate for blocks of size 2^( 6) =       0.000437359677
  error estimate for blocks of size 2^( 7) =       0.000437198304

      target function =                  N/A
              le_mean =     -17.214011249471
             les_mean =     296.648444994035
             stat err =       0.000434238797
             autocorr =       1.155901782021
              std dev =       0.571193365042
             le_variance =       0.326261860268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403894702
  error estimate for blocks of size 2^( 2) =       0.000413968430
  error estimate for blocks of size 2^( 3) =       0.000422960721
  error estimate for blocks of size 2^( 4) =       0.000428852828
  error estimate for blocks of size 2^( 5) =       0.000433544379
  error estimate for blocks of size 2^( 6) =       0.000437359677
  error estimate for blocks of size 2^( 7) =       0.000437198304

      target function =                  N/A
              le_mean =     -17.214011249471
             les_mean =     296.648444994035
             stat err =       0.000434238797
             autocorr =       1.155901782021
              std dev =       0.571193365042
             le_variance =       0.326261860268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326223687159
                                         uncertainty =       0.010852832606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403894702
  error estimate for blocks of size 2^( 2) =       0.000413968430
  error estimate for blocks of size 2^( 3) =       0.000422960721
  error estimate for blocks of size 2^( 4) =       0.000428852828
  error estimate for blocks of size 2^( 5) =       0.000433544379
  error estimate for blocks of size 2^( 6) =       0.000437359677
  error estimate for blocks of size 2^( 7) =       0.000437198304

      target function =                  N/A
              le_mean =     -17.214011249471
             les_mean =     296.648444994035
             stat err =       0.000434238797
             autocorr =       1.155901782021
              std dev =       0.571193365042
             le_variance =       0.326261860268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214011249471        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -17.214011249471
     9.5367e+16     9.5367e+17             0.0000e+00       -17.214011249471
     3.8147e+17     3.8147e+18             0.0000e+00       -17.214011249471

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9211
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2286
    reference variance = 0.266031
====================================================
  Execution time = 3.0289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3477e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334814963946
                                         uncertainty =       0.007312775025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334814963946
                                         uncertainty =       0.007312775025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409129210
  error estimate for blocks of size 2^( 2) =       0.000419003386
  error estimate for blocks of size 2^( 3) =       0.000427522947
  error estimate for blocks of size 2^( 4) =       0.000434264739
  error estimate for blocks of size 2^( 5) =       0.000439337623
  error estimate for blocks of size 2^( 6) =       0.000441499592
  error estimate for blocks of size 2^( 7) =       0.000441733402

      target function =                  N/A
              le_mean =     -17.214772869051
             les_mean =     296.683178186543
             stat err =       0.000439208839
             autocorr =       1.152447548355
              std dev =       0.578596077520
             le_variance =       0.334773420921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721477286905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214772869051       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214772869051       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214772869051       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 5.772117e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214772869051       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214772869051       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214772869051       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 1.443029e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214772869051       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214772869051       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214772869051       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 3.607573e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8856e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2301
    reference variance = 0.300772
====================================================
  Execution time = 3.0015e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2948e-01
  Total weights = 2.0000e+06
  Execution time = 2.6949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405881203
  error estimate for blocks of size 2^( 2) =       0.000416101080
  error estimate for blocks of size 2^( 3) =       0.000425019106
  error estimate for blocks of size 2^( 4) =       0.000431215973
  error estimate for blocks of size 2^( 5) =       0.000434857536
  error estimate for blocks of size 2^( 6) =       0.000437095210
  error estimate for blocks of size 2^( 7) =       0.000437651637

      target function =                  N/A
              le_mean =     -17.214686365767
             les_mean =     296.674905609415
             stat err =       0.000435205089
             autocorr =       1.149714613265
              std dev =       0.574002702445
             le_variance =       0.329479102414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405881203
  error estimate for blocks of size 2^( 2) =       0.000416101080
  error estimate for blocks of size 2^( 3) =       0.000425019106
  error estimate for blocks of size 2^( 4) =       0.000431215973
  error estimate for blocks of size 2^( 5) =       0.000434857536
  error estimate for blocks of size 2^( 6) =       0.000437095210
  error estimate for blocks of size 2^( 7) =       0.000437651637

      target function =                  N/A
              le_mean =     -17.214686365767
             les_mean =     296.674905609415
             stat err =       0.000435205089
             autocorr =       1.149714613265
              std dev =       0.574002702445
             le_variance =       0.329479102414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405881203
  error estimate for blocks of size 2^( 2) =       0.000416101080
  error estimate for blocks of size 2^( 3) =       0.000425019106
  error estimate for blocks of size 2^( 4) =       0.000431215973
  error estimate for blocks of size 2^( 5) =       0.000434857536
  error estimate for blocks of size 2^( 6) =       0.000437095210
  error estimate for blocks of size 2^( 7) =       0.000437651637

      target function =                  N/A
              le_mean =     -17.214686365767
             les_mean =     296.674905609415
             stat err =       0.000435205089
             autocorr =       1.149714613265
              std dev =       0.574002702445
             le_variance =       0.329479102414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329097122777
                                         uncertainty =       0.004219016493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405881203
  error estimate for blocks of size 2^( 2) =       0.000416101080
  error estimate for blocks of size 2^( 3) =       0.000425019106
  error estimate for blocks of size 2^( 4) =       0.000431215973
  error estimate for blocks of size 2^( 5) =       0.000434857536
  error estimate for blocks of size 2^( 6) =       0.000437095210
  error estimate for blocks of size 2^( 7) =       0.000437651637

      target function =                  N/A
              le_mean =     -17.214686365767
             les_mean =     296.674905609415
             stat err =       0.000435205089
             autocorr =       1.149714613265
              std dev =       0.574002702445
             le_variance =       0.329479102414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214686365767        initial  <--
     2.3842e+17     2.3842e+18             5.7721e-22       -17.214686365767
     9.5367e+17     9.5367e+18             1.4430e-22       -17.214686365767
     3.8147e+18     3.8147e+19             3.6076e-23       -17.214686365767

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6340
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2495e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1721
    reference variance = 0.277941
====================================================
  Execution time = 3.0645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2282e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322909951615
                                         uncertainty =       0.002433202449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322909951615
                                         uncertainty =       0.002433202449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401759853
  error estimate for blocks of size 2^( 2) =       0.000412050864
  error estimate for blocks of size 2^( 3) =       0.000420992283
  error estimate for blocks of size 2^( 4) =       0.000427882175
  error estimate for blocks of size 2^( 5) =       0.000431226499
  error estimate for blocks of size 2^( 6) =       0.000433104296
  error estimate for blocks of size 2^( 7) =       0.000435169275

      target function =                  N/A
              le_mean =     -17.215135284710
             les_mean =     296.683704667726
             stat err =       0.000431845561
             autocorr =       1.155377347878
              std dev =       0.568174232306
             le_variance =       0.322821958256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721513528471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215135284710       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215135284710       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215135284710       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215135284710       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215135284710       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215135284710       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9116e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.181826
====================================================
  Execution time = 3.0412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2913e-01
  Total weights = 2.0000e+06
  Execution time = 2.6792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405666547
  error estimate for blocks of size 2^( 2) =       0.000415799586
  error estimate for blocks of size 2^( 3) =       0.000424301665
  error estimate for blocks of size 2^( 4) =       0.000431204167
  error estimate for blocks of size 2^( 5) =       0.000435338399
  error estimate for blocks of size 2^( 6) =       0.000437733094
  error estimate for blocks of size 2^( 7) =       0.000440289140

      target function =                  N/A
              le_mean =     -17.214253925179
             les_mean =     296.659668731120
             stat err =       0.000436141200
             autocorr =       1.155888217610
              std dev =       0.573699132962
             le_variance =       0.329130695161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405666547
  error estimate for blocks of size 2^( 2) =       0.000415799586
  error estimate for blocks of size 2^( 3) =       0.000424301665
  error estimate for blocks of size 2^( 4) =       0.000431204167
  error estimate for blocks of size 2^( 5) =       0.000435338399
  error estimate for blocks of size 2^( 6) =       0.000437733094
  error estimate for blocks of size 2^( 7) =       0.000440289140

      target function =                  N/A
              le_mean =     -17.214253925179
             les_mean =     296.659668731120
             stat err =       0.000436141200
             autocorr =       1.155888217610
              std dev =       0.573699132962
             le_variance =       0.329130695161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405666547
  error estimate for blocks of size 2^( 2) =       0.000415799586
  error estimate for blocks of size 2^( 3) =       0.000424301665
  error estimate for blocks of size 2^( 4) =       0.000431204167
  error estimate for blocks of size 2^( 5) =       0.000435338399
  error estimate for blocks of size 2^( 6) =       0.000437733094
  error estimate for blocks of size 2^( 7) =       0.000440289140

      target function =                  N/A
              le_mean =     -17.214253925179
             les_mean =     296.659668731120
             stat err =       0.000436141200
             autocorr =       1.155888217610
              std dev =       0.573699132962
             le_variance =       0.329130695161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329154958550
                                         uncertainty =       0.003672659872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405666547
  error estimate for blocks of size 2^( 2) =       0.000415799586
  error estimate for blocks of size 2^( 3) =       0.000424301665
  error estimate for blocks of size 2^( 4) =       0.000431204167
  error estimate for blocks of size 2^( 5) =       0.000435338399
  error estimate for blocks of size 2^( 6) =       0.000437733094
  error estimate for blocks of size 2^( 7) =       0.000440289140

      target function =                  N/A
              le_mean =     -17.214253925179
             les_mean =     296.659668731120
             stat err =       0.000436141200
             autocorr =       1.155888217610
              std dev =       0.573699132962
             le_variance =       0.329130695161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214253925179        initial  <--
     2.3842e+18     2.3842e+19             0.0000e+00       -17.214253925179
     9.5367e+18     9.5367e+19             0.0000e+00       -17.214253925179
     3.8147e+19     3.8147e+20             0.0000e+00       -17.214253925179

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9836
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3105e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1691
    reference variance = 0.194604
====================================================
  Execution time = 3.0435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2854e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328640323207
                                         uncertainty =       0.005745175915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328640323207
                                         uncertainty =       0.005745175915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405299677
  error estimate for blocks of size 2^( 2) =       0.000415194799
  error estimate for blocks of size 2^( 3) =       0.000424669101
  error estimate for blocks of size 2^( 4) =       0.000431076765
  error estimate for blocks of size 2^( 5) =       0.000435514592
  error estimate for blocks of size 2^( 6) =       0.000435910822
  error estimate for blocks of size 2^( 7) =       0.000434643793

      target function =                  N/A
              le_mean =     -17.214726751653
             les_mean =     296.675352625878
             stat err =       0.000434286493
             autocorr =       1.148153964274
              std dev =       0.573180299806
             le_variance =       0.328535656085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721472675165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214726751653       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214726751653       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214726751653       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214726751653       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214726751653       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214726751653       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9048e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.219878
====================================================
  Execution time = 3.0052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.5666e-01
  Total weights = 2.0000e+06
  Execution time = 2.6995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422289093
  error estimate for blocks of size 2^( 2) =       0.000431747297
  error estimate for blocks of size 2^( 3) =       0.000440177434
  error estimate for blocks of size 2^( 4) =       0.000446309625
  error estimate for blocks of size 2^( 5) =       0.000450921945
  error estimate for blocks of size 2^( 6) =       0.000453592496
  error estimate for blocks of size 2^( 7) =       0.000454482464

      target function =                  N/A
              le_mean =     -17.213982034698
             les_mean =     296.677833468575
             stat err =       0.000451326632
             autocorr =       1.142252703021
              std dev =       0.597206962437
             le_variance =       0.356656155983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422289093
  error estimate for blocks of size 2^( 2) =       0.000431747297
  error estimate for blocks of size 2^( 3) =       0.000440177434
  error estimate for blocks of size 2^( 4) =       0.000446309625
  error estimate for blocks of size 2^( 5) =       0.000450921945
  error estimate for blocks of size 2^( 6) =       0.000453592496
  error estimate for blocks of size 2^( 7) =       0.000454482464

      target function =                  N/A
              le_mean =     -17.213982034698
             les_mean =     296.677833468575
             stat err =       0.000451326632
             autocorr =       1.142252703021
              std dev =       0.597206962437
             le_variance =       0.356656155983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422289093
  error estimate for blocks of size 2^( 2) =       0.000431747297
  error estimate for blocks of size 2^( 3) =       0.000440177434
  error estimate for blocks of size 2^( 4) =       0.000446309625
  error estimate for blocks of size 2^( 5) =       0.000450921945
  error estimate for blocks of size 2^( 6) =       0.000453592496
  error estimate for blocks of size 2^( 7) =       0.000454482464

      target function =                  N/A
              le_mean =     -17.213982034698
             les_mean =     296.677833468575
             stat err =       0.000451326632
             autocorr =       1.142252703021
              std dev =       0.597206962437
             le_variance =       0.356656155983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356774390737
                                         uncertainty =       0.023739453936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422289093
  error estimate for blocks of size 2^( 2) =       0.000431747297
  error estimate for blocks of size 2^( 3) =       0.000440177434
  error estimate for blocks of size 2^( 4) =       0.000446309625
  error estimate for blocks of size 2^( 5) =       0.000450921945
  error estimate for blocks of size 2^( 6) =       0.000453592496
  error estimate for blocks of size 2^( 7) =       0.000454482464

      target function =                  N/A
              le_mean =     -17.213982034698
             les_mean =     296.677833468575
             stat err =       0.000451326632
             autocorr =       1.142252703021
              std dev =       0.597206962437
             le_variance =       0.356656155983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213982034698        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -17.213982034698
     9.5367e+19     9.5367e+20             0.0000e+00       -17.213982034698
     3.8147e+20     3.8147e+21             0.0000e+00       -17.213982034698

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6871
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1917
    reference variance = 0.345892
====================================================
  Execution time = 3.2741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329491925300
                                         uncertainty =       0.004820854635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329491925300
                                         uncertainty =       0.004820854635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405879219
  error estimate for blocks of size 2^( 2) =       0.000415809748
  error estimate for blocks of size 2^( 3) =       0.000424770398
  error estimate for blocks of size 2^( 4) =       0.000430675009
  error estimate for blocks of size 2^( 5) =       0.000435011462
  error estimate for blocks of size 2^( 6) =       0.000436830737
  error estimate for blocks of size 2^( 7) =       0.000438255300

      target function =                  N/A
              le_mean =     -17.214931452711
             les_mean =     296.683340636922
             stat err =       0.000435193127
             autocorr =       1.149662656316
              std dev =       0.573999895578
             le_variance =       0.329475880124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721493145271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214931452711       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214931452711       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214931452711       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214931452711       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214931452711       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214931452711       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1228e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1864
    reference variance = 0.224165
====================================================
  Execution time = 3.0292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2310e-01
  Total weights = 2.0000e+06
  Execution time = 2.7127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401934611
  error estimate for blocks of size 2^( 2) =       0.000411536955
  error estimate for blocks of size 2^( 3) =       0.000420356665
  error estimate for blocks of size 2^( 4) =       0.000427215119
  error estimate for blocks of size 2^( 5) =       0.000431678418
  error estimate for blocks of size 2^( 6) =       0.000433991829
  error estimate for blocks of size 2^( 7) =       0.000438025487

      target function =                  N/A
              le_mean =     -17.215269464303
             les_mean =     296.688605430741
             stat err =       0.000432727713
             autocorr =       1.159093866398
              std dev =       0.568421378668
             le_variance =       0.323102863727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401934611
  error estimate for blocks of size 2^( 2) =       0.000411536955
  error estimate for blocks of size 2^( 3) =       0.000420356665
  error estimate for blocks of size 2^( 4) =       0.000427215119
  error estimate for blocks of size 2^( 5) =       0.000431678418
  error estimate for blocks of size 2^( 6) =       0.000433991829
  error estimate for blocks of size 2^( 7) =       0.000438025487

      target function =                  N/A
              le_mean =     -17.215269464303
             les_mean =     296.688605430741
             stat err =       0.000432727713
             autocorr =       1.159093866398
              std dev =       0.568421378668
             le_variance =       0.323102863727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401934611
  error estimate for blocks of size 2^( 2) =       0.000411536955
  error estimate for blocks of size 2^( 3) =       0.000420356665
  error estimate for blocks of size 2^( 4) =       0.000427215119
  error estimate for blocks of size 2^( 5) =       0.000431678418
  error estimate for blocks of size 2^( 6) =       0.000433991829
  error estimate for blocks of size 2^( 7) =       0.000438025487

      target function =                  N/A
              le_mean =     -17.215269464303
             les_mean =     296.688605430741
             stat err =       0.000432727713
             autocorr =       1.159093866398
              std dev =       0.568421378668
             le_variance =       0.323102863727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323122062275
                                         uncertainty =       0.003075028918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401934611
  error estimate for blocks of size 2^( 2) =       0.000411536955
  error estimate for blocks of size 2^( 3) =       0.000420356665
  error estimate for blocks of size 2^( 4) =       0.000427215119
  error estimate for blocks of size 2^( 5) =       0.000431678418
  error estimate for blocks of size 2^( 6) =       0.000433991829
  error estimate for blocks of size 2^( 7) =       0.000438025487

      target function =                  N/A
              le_mean =     -17.215269464303
             les_mean =     296.688605430741
             stat err =       0.000432727713
             autocorr =       1.159093866398
              std dev =       0.568421378668
             le_variance =       0.323102863727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215269464303        initial  <--
     2.3842e+20     2.3842e+21             0.0000e+00       -17.215269464303
     9.5367e+20     9.5367e+21             0.0000e+00       -17.215269464303
     3.8147e+21     3.8147e+22             0.0000e+00       -17.215269464303

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9628
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5196e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.201
    reference variance = 0.346658
====================================================
  Execution time = 3.0381e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1996e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319989669033
                                         uncertainty =       0.002961610724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319989669033
                                         uncertainty =       0.002961610724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399974213
  error estimate for blocks of size 2^( 2) =       0.000409621665
  error estimate for blocks of size 2^( 3) =       0.000418590883
  error estimate for blocks of size 2^( 4) =       0.000425329624
  error estimate for blocks of size 2^( 5) =       0.000429457490
  error estimate for blocks of size 2^( 6) =       0.000431304577
  error estimate for blocks of size 2^( 7) =       0.000433146308

      target function =                  N/A
              le_mean =     -17.215360383188
             les_mean =     296.688591704624
             stat err =       0.000429809500
             autocorr =       1.154750172600
              std dev =       0.565648956131
             le_variance =       0.319958741572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721536038319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215360383188       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215360383188       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215360383188       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215360383188       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215360383188       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215360383188       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183222 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8970e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.213
    reference variance = 0.251483
====================================================
  Execution time = 3.0125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2415e-01
  Total weights = 2.0000e+06
  Execution time = 2.7453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402588030
  error estimate for blocks of size 2^( 2) =       0.000412963986
  error estimate for blocks of size 2^( 3) =       0.000421811355
  error estimate for blocks of size 2^( 4) =       0.000427998299
  error estimate for blocks of size 2^( 5) =       0.000431575720
  error estimate for blocks of size 2^( 6) =       0.000434601343
  error estimate for blocks of size 2^( 7) =       0.000436358811

      target function =                  N/A
              le_mean =     -17.214483618030
             les_mean =     296.662600316958
             stat err =       0.000432633543
             autocorr =       1.154831603807
              std dev =       0.569345451907
             le_variance =       0.324154243607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402588030
  error estimate for blocks of size 2^( 2) =       0.000412963986
  error estimate for blocks of size 2^( 3) =       0.000421811355
  error estimate for blocks of size 2^( 4) =       0.000427998299
  error estimate for blocks of size 2^( 5) =       0.000431575720
  error estimate for blocks of size 2^( 6) =       0.000434601343
  error estimate for blocks of size 2^( 7) =       0.000436358811

      target function =                  N/A
              le_mean =     -17.214483618030
             les_mean =     296.662600316958
             stat err =       0.000432633543
             autocorr =       1.154831603807
              std dev =       0.569345451907
             le_variance =       0.324154243607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402588030
  error estimate for blocks of size 2^( 2) =       0.000412963986
  error estimate for blocks of size 2^( 3) =       0.000421811355
  error estimate for blocks of size 2^( 4) =       0.000427998299
  error estimate for blocks of size 2^( 5) =       0.000431575720
  error estimate for blocks of size 2^( 6) =       0.000434601343
  error estimate for blocks of size 2^( 7) =       0.000436358811

      target function =                  N/A
              le_mean =     -17.214483618030
             les_mean =     296.662600316958
             stat err =       0.000432633543
             autocorr =       1.154831603807
              std dev =       0.569345451907
             le_variance =       0.324154243607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324078768408
                                         uncertainty =       0.003781094298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402588030
  error estimate for blocks of size 2^( 2) =       0.000412963986
  error estimate for blocks of size 2^( 3) =       0.000421811355
  error estimate for blocks of size 2^( 4) =       0.000427998299
  error estimate for blocks of size 2^( 5) =       0.000431575720
  error estimate for blocks of size 2^( 6) =       0.000434601343
  error estimate for blocks of size 2^( 7) =       0.000436358811

      target function =                  N/A
              le_mean =     -17.214483618030
             les_mean =     296.662600316958
             stat err =       0.000432633543
             autocorr =       1.154831603807
              std dev =       0.569345451907
             le_variance =       0.324154243607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214483618030        initial  <--
     2.3842e+21     2.3842e+22             0.0000e+00       -17.214483618030
     9.5367e+21     9.5367e+22             0.0000e+00       -17.214483618030
     3.8147e+22     3.8147e+23             0.0000e+00       -17.214483618030

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9073
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 14088 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1784
    reference variance = 0.332483
====================================================
  Execution time = 3.0427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2777e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327833792529
                                         uncertainty =       0.004316619001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327833792529
                                         uncertainty =       0.004316619001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404825066
  error estimate for blocks of size 2^( 2) =       0.000414942495
  error estimate for blocks of size 2^( 3) =       0.000424385793
  error estimate for blocks of size 2^( 4) =       0.000431183188
  error estimate for blocks of size 2^( 5) =       0.000435840131
  error estimate for blocks of size 2^( 6) =       0.000439860396
  error estimate for blocks of size 2^( 7) =       0.000440538412

      target function =                  N/A
              le_mean =     -17.214976180595
             les_mean =     296.683171402272
             stat err =       0.000436855532
             autocorr =       1.164503742581
              std dev =       0.572509098348
             le_variance =       0.327766667692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721497618060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214976180595       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214976180595       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214976180595       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214976180595       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214976180595       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214976180595       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8982e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2359
    reference variance = 0.422997
====================================================
  Execution time = 2.9910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1879e-01
  Total weights = 2.0000e+06
  Execution time = 2.7552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399245339
  error estimate for blocks of size 2^( 2) =       0.000409311336
  error estimate for blocks of size 2^( 3) =       0.000418256737
  error estimate for blocks of size 2^( 4) =       0.000425131684
  error estimate for blocks of size 2^( 5) =       0.000428904177
  error estimate for blocks of size 2^( 6) =       0.000430999402
  error estimate for blocks of size 2^( 7) =       0.000431709490

      target function =                  N/A
              le_mean =     -17.214048935244
             les_mean =     296.642274267092
             stat err =       0.000429186188
             autocorr =       1.155611261575
              std dev =       0.564618173217
             le_variance =       0.318793681527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399245339
  error estimate for blocks of size 2^( 2) =       0.000409311336
  error estimate for blocks of size 2^( 3) =       0.000418256737
  error estimate for blocks of size 2^( 4) =       0.000425131684
  error estimate for blocks of size 2^( 5) =       0.000428904177
  error estimate for blocks of size 2^( 6) =       0.000430999402
  error estimate for blocks of size 2^( 7) =       0.000431709490

      target function =                  N/A
              le_mean =     -17.214048935244
             les_mean =     296.642274267092
             stat err =       0.000429186188
             autocorr =       1.155611261575
              std dev =       0.564618173217
             le_variance =       0.318793681527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399245339
  error estimate for blocks of size 2^( 2) =       0.000409311336
  error estimate for blocks of size 2^( 3) =       0.000418256737
  error estimate for blocks of size 2^( 4) =       0.000425131684
  error estimate for blocks of size 2^( 5) =       0.000428904177
  error estimate for blocks of size 2^( 6) =       0.000430999402
  error estimate for blocks of size 2^( 7) =       0.000431709490

      target function =                  N/A
              le_mean =     -17.214048935244
             les_mean =     296.642274267092
             stat err =       0.000429186188
             autocorr =       1.155611261575
              std dev =       0.564618173217
             le_variance =       0.318793681527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856461466
                                         uncertainty =       0.002665146299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399245339
  error estimate for blocks of size 2^( 2) =       0.000409311336
  error estimate for blocks of size 2^( 3) =       0.000418256737
  error estimate for blocks of size 2^( 4) =       0.000425131684
  error estimate for blocks of size 2^( 5) =       0.000428904177
  error estimate for blocks of size 2^( 6) =       0.000430999402
  error estimate for blocks of size 2^( 7) =       0.000431709490

      target function =                  N/A
              le_mean =     -17.214048935244
             les_mean =     296.642274267092
             stat err =       0.000429186188
             autocorr =       1.155611261575
              std dev =       0.564618173217
             le_variance =       0.318793681527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214048935244        initial  <--
     2.3842e+22     2.3842e+23             0.0000e+00       -17.214048935244
     9.5367e+22     9.5367e+23             0.0000e+00       -17.214048935244
     3.8147e+23     3.8147e+24             0.0000e+00       -17.214048935244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7815
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.934759e-01 1 1  ON 0
 uu_1                 2.865419e-02 1 1  ON 1
 uu_2                -6.982238e-02 1 1  ON 2
 uu_3                -1.272797e-01 1 1  ON 3
 uu_4                -1.626213e-01 1 1  ON 4
 uu_5                -1.732608e-01 1 1  ON 5
 uu_6                -1.587350e-01 1 1  ON 6
 uu_7                -1.108537e-01 1 1  ON 7
 uu_8                -3.615509e-02 1 1  ON 8
 uu_9                 2.143047e-01 1 1  ON 9
 ud_0                 3.561359e-01 1 1  ON 10
 ud_1                 9.389489e-02 1 1  ON 11
 ud_2                -1.963867e-02 1 1  ON 12
 ud_3                -8.145122e-02 1 1  ON 13
 ud_4                -1.289989e-01 1 1  ON 14
 ud_5                -1.624419e-01 1 1  ON 15
 ud_6                -1.718984e-01 1 1  ON 16
 ud_7                -1.450820e-01 1 1  ON 17
 ud_8                -9.330908e-02 1 1  ON 18
 ud_9                 4.262996e-02 1 1  ON 19
 eO_0                -9.038988e-01 1 1  ON 20
 eO_1                -5.756810e-01 1 1  ON 21
 eO_2                -1.546040e-01 1 1  ON 22
 eO_3                 1.129603e-01 1 1  ON 23
 eO_4                 2.243369e-01 1 1  ON 24
 eO_5                 2.973335e-01 1 1  ON 25
 eO_6                 3.093364e-01 1 1  ON 26
 eO_7                 4.645193e-01 1 1  ON 27
 eO_8                 1.269644e-01 1 1  ON 28
 eO_9                 5.432525e-02 1 1  ON 29
eH1_0                -2.141899e-01 1 1  ON 30
eH1_1                -1.353543e-01 1 1  ON 31
eH1_2                -9.268571e-02 1 1  ON 32
eH1_3                -5.425413e-02 1 1  ON 33
eH1_4                -7.785592e-03 1 1  ON 34
eH1_5                 4.447180e-03 1 1  ON 35
eH1_6                 4.922324e-02 1 1  ON 36
eH1_7                 5.261153e-02 1 1  ON 37
eH1_8                 2.208088e-01 1 1  ON 38
eH1_9                 1.118408e-01 1 1  ON 39
eH2_0                -2.093163e-01 1 1  ON 40
eH2_1                -1.301698e-01 1 1  ON 41
eH2_2                -8.743192e-02 1 1  ON 42
eH2_3                -4.921647e-02 1 1  ON 43
eH2_4                -3.292507e-03 1 1  ON 44
eH2_5                 7.657346e-03 1 1  ON 45
eH2_6                 4.787136e-02 1 1  ON 46
eH2_7                 1.040764e-02 1 1  ON 47
eH2_8                 2.461692e-01 1 1  ON 48
eH2_9                 1.127793e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2768e+01 secs
  Total Execution time = 3.3375e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
