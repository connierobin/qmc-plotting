Rank =    0  Free Memory = 72082 MB
Rank =    1  Free Memory = 72082 MB
Rank =    2  Free Memory = 72082 MB
Rank =    3  Free Memory = 72082 MB
Rank =    4  Free Memory = 72081 MB
Rank =    5  Free Memory = 72081 MB
Rank =    6  Free Memory = 72081 MB
Rank =    7  Free Memory = 72080 MB
Rank =    8  Free Memory = 72080 MB
Rank =    9  Free Memory = 72080 MB
Rank =   10  Free Memory = 72080 MB
Rank =   11  Free Memory = 72080 MB
Rank =   12  Free Memory = 72080 MB
Rank =   13  Free Memory = 72080 MB
Rank =   14  Free Memory = 72079 MB
Rank =   15  Free Memory = 72065 MB
Rank =   16  Free Memory = 72065 MB
Rank =   17  Free Memory = 72065 MB
Rank =   18  Free Memory = 72065 MB
Rank =   19  Free Memory = 72065 MB
Rank =   20  Free Memory = 72065 MB
Rank =   21  Free Memory = 72065 MB
Rank =   22  Free Memory = 72065 MB
Rank =   23  Free Memory = 72065 MB
Rank =   24  Free Memory = 72065 MB
Rank =   25  Free Memory = 72065 MB
Rank =   26  Free Memory = 72065 MB
Rank =   27  Free Memory = 72065 MB
Rank =   28  Free Memory = 72065 MB
Rank =   29  Free Memory = 72064 MB
Rank =   30  Free Memory = 72064 MB
Rank =   31  Free Memory = 72064 MB
Rank =   32  Free Memory = 72550 MB
Rank =   33  Free Memory = 72550 MB
Rank =   34  Free Memory = 72550 MB
Rank =   35  Free Memory = 72550 MB
Rank =   36  Free Memory = 72550 MB
Rank =   37  Free Memory = 72550 MB
Rank =   38  Free Memory = 72550 MB
Rank =   39  Free Memory = 72550 MB
Rank =   40  Free Memory = 72550 MB
Rank =   41  Free Memory = 72550 MB
Rank =   42  Free Memory = 72550 MB
Rank =   43  Free Memory = 72550 MB
Rank =   44  Free Memory = 72550 MB
Rank =   45  Free Memory = 72550 MB
Rank =   46  Free Memory = 72550 MB
Rank =   47  Free Memory = 72550 MB
Rank =   48  Free Memory = 72550 MB
Rank =   49  Free Memory = 72550 MB
Rank =   50  Free Memory = 72550 MB
Rank =   51  Free Memory = 72550 MB
Rank =   52  Free Memory = 72550 MB
Rank =   53  Free Memory = 72550 MB
Rank =   54  Free Memory = 72550 MB
Rank =   55  Free Memory = 72550 MB
Rank =   56  Free Memory = 72550 MB
Rank =   57  Free Memory = 72550 MB
Rank =   58  Free Memory = 72550 MB
Rank =   59  Free Memory = 72550 MB
Rank =   60  Free Memory = 72550 MB
Rank =   61  Free Memory = 72550 MB
Rank =   62  Free Memory = 72550 MB
Rank =   63  Free Memory = 72550 MB
Rank =   64  Free Memory = 76857 MB
Rank =   65  Free Memory = 76857 MB
Rank =   66  Free Memory = 76857 MB
Rank =   67  Free Memory = 76857 MB
Rank =   68  Free Memory = 76857 MB
Rank =   69  Free Memory = 76857 MB
Rank =   70  Free Memory = 76857 MB
Rank =   71  Free Memory = 76857 MB
Rank =   72  Free Memory = 76857 MB
Rank =   73  Free Memory = 76857 MB
Rank =   74  Free Memory = 76857 MB
Rank =   75  Free Memory = 76857 MB
Rank =   76  Free Memory = 76857 MB
Rank =   77  Free Memory = 76857 MB
Rank =   78  Free Memory = 76857 MB
Rank =   79  Free Memory = 76857 MB
Rank =   80  Free Memory = 76857 MB
Rank =   81  Free Memory = 76857 MB
Rank =   82  Free Memory = 76857 MB
Rank =   83  Free Memory = 76857 MB
Rank =   84  Free Memory = 76857 MB
Rank =   85  Free Memory = 76857 MB
Rank =   86  Free Memory = 76857 MB
Rank =   87  Free Memory = 76857 MB
Rank =   88  Free Memory = 76857 MB
Rank =   89  Free Memory = 76857 MB
Rank =   90  Free Memory = 76857 MB
Rank =   91  Free Memory = 76857 MB
Rank =   92  Free Memory = 76857 MB
Rank =   93  Free Memory = 76857 MB
Rank =   94  Free Memory = 76857 MB
Rank =   95  Free Memory = 76857 MB
Rank =   96  Free Memory = 68297 MB
Rank =   97  Free Memory = 68297 MB
Rank =   98  Free Memory = 68297 MB
Rank =   99  Free Memory = 68297 MB
Rank =  100  Free Memory = 68297 MB
Rank =  101  Free Memory = 68297 MB
Rank =  102  Free Memory = 68297 MB
Rank =  103  Free Memory = 68297 MB
Rank =  104  Free Memory = 68297 MB
Rank =  105  Free Memory = 68296 MB
Rank =  106  Free Memory = 68296 MB
Rank =  107  Free Memory = 68296 MB
Rank =  108  Free Memory = 68296 MB
Rank =  109  Free Memory = 68296 MB
Rank =  110  Free Memory = 68296 MB
Rank =  111  Free Memory = 68296 MB
Rank =  112  Free Memory = 68296 MB
Rank =  113  Free Memory = 68296 MB
Rank =  114  Free Memory = 68296 MB
Rank =  115  Free Memory = 68296 MB
Rank =  116  Free Memory = 68296 MB
Rank =  117  Free Memory = 68296 MB
Rank =  118  Free Memory = 68296 MB
Rank =  119  Free Memory = 68296 MB
Rank =  120  Free Memory = 68296 MB
Rank =  121  Free Memory = 68296 MB
Rank =  122  Free Memory = 68296 MB
Rank =  123  Free Memory = 68296 MB
Rank =  124  Free Memory = 68296 MB
Rank =  125  Free Memory = 68296 MB
Rank =  126  Free Memory = 68296 MB
Rank =  127  Free Memory = 68296 MB
  Input file(s): opt_h2o_gs_gvptt_32dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_32dets_run001b.xml

  Project = H2O
  date    = 2023-05-11 02:47:43 PDT
  host    = n0093.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 447

  Range of prime numbers to use as seeds over processors and threads = 3169-4217


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 32 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.707747e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 11 unique up determinants.
Found 11 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.5878e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2336
    reference variance = 0.200911
====================================================
  Execution time = 3.2855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.2068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320678331730
                                         uncertainty =       0.002441194988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320678331730
                                         uncertainty =       0.002441194988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400425849
  error estimate for blocks of size 2^( 2) =       0.000414323139
  error estimate for blocks of size 2^( 3) =       0.000426460418
  error estimate for blocks of size 2^( 4) =       0.000435845784
  error estimate for blocks of size 2^( 5) =       0.000441976881
  error estimate for blocks of size 2^( 6) =       0.000443853544
  error estimate for blocks of size 2^( 7) =       0.000446087760

      target function =                  N/A
              le_mean =     -17.207453236870
             les_mean =     296.417128459277
             stat err =       0.000441940992
             autocorr =       1.218103983774
              std dev =       0.566287665895
             le_variance =       0.320681720545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.720745323687e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.207453236870       residual = 5.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.208081095356       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.208357039752       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.208723580946       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.208908693747       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.209009460498       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.209054339593       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.209081084315       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.209088597441       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.209088886509       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.209089205350       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.209088775990       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.209088624591       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.333905e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.207453236870       residual = 5.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.207732522432       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.207847916302       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.208008472005       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.208087700762       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.208120299249       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.208125493294       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.208129076451       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.208130280814       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.208130641397       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.208130556086       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 7.452895e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.207453236870       residual = 5.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.207539950160       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.207575844499       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.207627600567       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.207650650308       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.207658943847       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.207659704005       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.207660254362       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.207660530748       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.207660566309       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.207660565857       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.183412e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1803e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.934373e-01                 1 1 ON  0
uu_1  3.775387e-02                 1 1 ON  1
uu_2  -4.729897e-02                1 1 ON  2
uu_3  -9.490218e-02                1 1 ON  3
uu_4  -1.251987e-01                1 1 ON  4
uu_5  -1.325228e-01                1 1 ON  5
uu_6  -1.095181e-01                1 1 ON  6
uu_7  -3.360976e-02                1 1 ON  7
uu_8  1.029367e-01                 1 1 ON  8
uu_9  1.188600e-01                 1 1 ON  9
ud_0  3.222505e-01                 1 1 ON  10
ud_1  7.852211e-02                 1 1 ON  11
ud_2  -1.131232e-02                1 1 ON  12
ud_3  -5.891750e-02                1 1 ON  13
ud_4  -1.076059e-01                1 1 ON  14
ud_5  -1.488877e-01                1 1 ON  15
ud_6  -1.580231e-01                1 1 ON  16
ud_7  -1.083513e-01                1 1 ON  17
ud_8  9.509383e-03                 1 1 ON  18
ud_9  9.248878e-02                 1 1 ON  19
eO_0  -6.886223e-01                1 1 ON  20
eO_1  -4.059141e-01                1 1 ON  21
eO_2  -5.418785e-02                1 1 ON  22
eO_3  1.661429e-01                 1 1 ON  23
eO_4  2.641937e-01                 1 1 ON  24
eO_5  3.063081e-01                 1 1 ON  25
eO_6  2.480869e-01                 1 1 ON  26
eO_7  1.082018e-01                 1 1 ON  27
eO_8  2.729005e-02                 1 1 ON  28
eO_9  1.813946e-02                 1 1 ON  29
eH1_0 -1.761525e-01                1 1 ON  30
eH1_1 -9.853327e-02                1 1 ON  31
eH1_2 -6.258090e-02                1 1 ON  32
eH1_3 -2.816454e-02                1 1 ON  33
eH1_4 1.814988e-02                 1 1 ON  34
eH1_5 3.102902e-02                 1 1 ON  35
eH1_6 7.763583e-02                 1 1 ON  36
eH1_7 1.113920e-01                 1 1 ON  37
eH1_8 8.858385e-02                 1 1 ON  38
eH1_9 2.360870e-02                 1 1 ON  39
eH2_0 -1.777861e-01                1 1 ON  40
eH2_1 -1.002323e-01                1 1 ON  41
eH2_2 -6.458566e-02                1 1 ON  42
eH2_3 -2.974753e-02                1 1 ON  43
eH2_4 1.670079e-02                 1 1 ON  44
eH2_5 3.149475e-02                 1 1 ON  45
eH2_6 7.990087e-02                 1 1 ON  46
eH2_7 1.151199e-01                 1 1 ON  47
eH2_8 9.162975e-02                 1 1 ON  48
eH2_9 2.562821e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.3953
    reference variance = 2.50798
====================================================
  Execution time = 3.1773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.3332e-01
  Total weights = 2.0000e+06
  Execution time = 2.6585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332196488653
                                         uncertainty =       0.006332774028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332196488653
                                         uncertainty =       0.006332774028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407664980
  error estimate for blocks of size 2^( 2) =       0.000421618878
  error estimate for blocks of size 2^( 3) =       0.000433539504
  error estimate for blocks of size 2^( 4) =       0.000442236933
  error estimate for blocks of size 2^( 5) =       0.000446941347
  error estimate for blocks of size 2^( 6) =       0.000449524530
  error estimate for blocks of size 2^( 7) =       0.000451583393

      target function =                  N/A
              le_mean =     -17.207835545097
             les_mean =     296.441985452297
             stat err =       0.000447571551
             autocorr =       1.205363778666
              std dev =       0.576525343242
             le_variance =       0.332381471400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338445180875
                                         uncertainty =       0.006324380269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338445180875
                                         uncertainty =       0.006324380269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411487351
  error estimate for blocks of size 2^( 2) =       0.000423555275
  error estimate for blocks of size 2^( 3) =       0.000433992754
  error estimate for blocks of size 2^( 4) =       0.000441729441
  error estimate for blocks of size 2^( 5) =       0.000446118069
  error estimate for blocks of size 2^( 6) =       0.000448400237
  error estimate for blocks of size 2^( 7) =       0.000449761697

      target function =                  N/A
              le_mean =     -17.207983682604
             les_mean =     296.453345931992
             stat err =       0.000446502361
             autocorr =       1.177428488589
              std dev =       0.581930992951
             le_variance =       0.338643680556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336576758069
                                         uncertainty =       0.006315702828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336576758069
                                         uncertainty =       0.006315702828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410348502
  error estimate for blocks of size 2^( 2) =       0.000422757970
  error estimate for blocks of size 2^( 3) =       0.000433490585
  error estimate for blocks of size 2^( 4) =       0.000441428991
  error estimate for blocks of size 2^( 5) =       0.000445901255
  error estimate for blocks of size 2^( 6) =       0.000448252302
  error estimate for blocks of size 2^( 7) =       0.000449665967

      target function =                  N/A
              le_mean =     -17.207842289480
             les_mean =     296.446607877028
             stat err =       0.000446312129
             autocorr =       1.182964397666
              std dev =       0.580320416491
             le_variance =       0.336771785796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332175676458
                                         uncertainty =       0.006328714301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332175676458
                                         uncertainty =       0.006328714301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407653030
  error estimate for blocks of size 2^( 2) =       0.000421346599
  error estimate for blocks of size 2^( 3) =       0.000433073805
  error estimate for blocks of size 2^( 4) =       0.000441650730
  error estimate for blocks of size 2^( 5) =       0.000446317969
  error estimate for blocks of size 2^( 6) =       0.000448864061
  error estimate for blocks of size 2^( 7) =       0.000450817302

      target function =                  N/A
              le_mean =     -17.207746087350
             les_mean =     296.438887226713
             stat err =       0.000446912515
             autocorr =       1.201887127754
              std dev =       0.576508444152
             le_variance =       0.332361986178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.207835545097        initial
     2.5000e-01     2.5000e+00             2.3339e-02       -17.207983682604  <--
     1.0000e+00     1.0000e+01             7.4529e-03       -17.207842289480
     4.0000e+00     4.0000e+01             2.1834e-03       -17.207746087350

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5187e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.970522e-01 1 1  ON 0
 uu_1                 4.011605e-02 1 1  ON 1
 uu_2                -4.932050e-02 1 1  ON 2
 uu_3                -9.749089e-02 1 1  ON 3
 uu_4                -1.258527e-01 1 1  ON 4
 uu_5                -1.320434e-01 1 1  ON 5
 uu_6                -1.098097e-01 1 1  ON 6
 uu_7                -3.448540e-02 1 1  ON 7
 uu_8                 1.025211e-01 1 1  ON 8
 uu_9                 1.190232e-01 1 1  ON 9
 ud_0                 3.333936e-01 1 1  ON 10
 ud_1                 8.238154e-02 1 1  ON 11
 ud_2                -1.561679e-02 1 1  ON 12
 ud_3                -6.524786e-02 1 1  ON 13
 ud_4                -1.106912e-01 1 1  ON 14
 ud_5                -1.484457e-01 1 1  ON 15
 ud_6                -1.582960e-01 1 1  ON 16
 ud_7                -1.094135e-01 1 1  ON 17
 ud_8                 8.866963e-03 1 1  ON 18
 ud_9                 9.250330e-02 1 1  ON 19
 eO_0                -7.045084e-01 1 1  ON 20
 eO_1                -4.115937e-01 1 1  ON 21
 eO_2                -4.330219e-02 1 1  ON 22
 eO_3                 1.765241e-01 1 1  ON 23
 eO_4                 2.657582e-01 1 1  ON 24
 eO_5                 3.048854e-01 1 1  ON 25
 eO_6                 2.478756e-01 1 1  ON 26
 eO_7                 1.084531e-01 1 1  ON 27
 eO_8                 2.735176e-02 1 1  ON 28
 eO_9                 1.817115e-02 1 1  ON 29
eH1_0                -1.772511e-01 1 1  ON 30
eH1_1                -9.928899e-02 1 1  ON 31
eH1_2                -6.284571e-02 1 1  ON 32
eH1_3                -2.714900e-02 1 1  ON 33
eH1_4                 1.898791e-02 1 1  ON 34
eH1_5                 3.165778e-02 1 1  ON 35
eH1_6                 7.723155e-02 1 1  ON 36
eH1_7                 1.111270e-01 1 1  ON 37
eH1_8                 8.877095e-02 1 1  ON 38
eH1_9                 2.368852e-02 1 1  ON 39
eH2_0                -1.787267e-01 1 1  ON 40
eH2_1                -1.009124e-01 1 1  ON 41
eH2_2                -6.466218e-02 1 1  ON 42
eH2_3                -2.886019e-02 1 1  ON 43
eH2_4                 1.754077e-02 1 1  ON 44
eH2_5                 3.227603e-02 1 1  ON 45
eH2_6                 7.916402e-02 1 1  ON 46
eH2_7                 1.148094e-01 1 1  ON 47
eH2_8                 9.179375e-02 1 1  ON 48
eH2_9                 2.567626e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6998e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2624
    reference variance = 0.199795
====================================================
  Execution time = 3.1891e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 3.2461e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324712653326
                                         uncertainty =       0.003602796889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324712653326
                                         uncertainty =       0.003602796889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402871496
  error estimate for blocks of size 2^( 2) =       0.000415159945
  error estimate for blocks of size 2^( 3) =       0.000426175635
  error estimate for blocks of size 2^( 4) =       0.000433892465
  error estimate for blocks of size 2^( 5) =       0.000437157352
  error estimate for blocks of size 2^( 6) =       0.000439014254
  error estimate for blocks of size 2^( 7) =       0.000440977199

      target function =                  N/A
              le_mean =     -17.210289527516
             les_mean =     296.518676342692
             stat err =       0.000437760317
             autocorr =       1.180700370557
              std dev =       0.569746333093
             le_variance =       0.324610884073


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721028952752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210289527516       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210431956199       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210579832634       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210715503000       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210805567413       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210898917791       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210933907540       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210985958934       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.210998936459       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211008256781       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211017978488       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211017732660       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211019309908       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211017857439       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211018090199       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211018245254       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211018333627       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.733731e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210289527516       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210381237377       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210466734145       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210554832858       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210609939097       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210644948213       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210649494848       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210668177671       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.210669670901       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210670629028       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.210670872648       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.210671050811       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.210670845537       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.522318e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210289527516       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210327354971       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210361227357       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210398149941       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210420679989       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210427156888       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210427076648       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210430856523       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.210431088277       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210431204992       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.210431193975       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.736341e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4343e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.009897e-01 1 1  ON 0
 uu_1                 4.199976e-02 1 1  ON 1
 uu_2                -5.048263e-02 1 1  ON 2
 uu_3                -9.998958e-02 1 1  ON 3
 uu_4                -1.273729e-01 1 1  ON 4
 uu_5                -1.319630e-01 1 1  ON 5
 uu_6                -1.100598e-01 1 1  ON 6
 uu_7                -3.529781e-02 1 1  ON 7
 uu_8                 1.021733e-01 1 1  ON 8
 uu_9                 1.193028e-01 1 1  ON 9
 ud_0                 3.421560e-01 1 1  ON 10
 ud_1                 8.540568e-02 1 1  ON 11
 ud_2                -1.818759e-02 1 1  ON 12
 ud_3                -7.044564e-02 1 1  ON 13
 ud_4                -1.144098e-01 1 1  ON 14
 ud_5                -1.484932e-01 1 1  ON 15
 ud_6                -1.576088e-01 1 1  ON 16
 ud_7                -1.101350e-01 1 1  ON 17
 ud_8                 8.203042e-03 1 1  ON 18
 ud_9                 9.256330e-02 1 1  ON 19
 eO_0                -7.197316e-01 1 1  ON 20
 eO_1                -4.174814e-01 1 1  ON 21
 eO_2                -3.564751e-02 1 1  ON 22
 eO_3                 1.873966e-01 1 1  ON 23
 eO_4                 2.689554e-01 1 1  ON 24
 eO_5                 3.036582e-01 1 1  ON 25
 eO_6                 2.478306e-01 1 1  ON 26
 eO_7                 1.089016e-01 1 1  ON 27
 eO_8                 2.744434e-02 1 1  ON 28
 eO_9                 1.823478e-02 1 1  ON 29
eH1_0                -1.784255e-01 1 1  ON 30
eH1_1                -1.002652e-01 1 1  ON 31
eH1_2                -6.281537e-02 1 1  ON 32
eH1_3                -2.635647e-02 1 1  ON 33
eH1_4                 1.978177e-02 1 1  ON 34
eH1_5                 3.276004e-02 1 1  ON 35
eH1_6                 7.661785e-02 1 1  ON 36
eH1_7                 1.108090e-01 1 1  ON 37
eH1_8                 8.901878e-02 1 1  ON 38
eH1_9                 2.376678e-02 1 1  ON 39
eH2_0                -1.800481e-01 1 1  ON 40
eH2_1                -1.019991e-01 1 1  ON 41
eH2_2                -6.444486e-02 1 1  ON 42
eH2_3                -2.799911e-02 1 1  ON 43
eH2_4                 1.873503e-02 1 1  ON 44
eH2_5                 3.320284e-02 1 1  ON 45
eH2_6                 7.839007e-02 1 1  ON 46
eH2_7                 1.143685e-01 1 1  ON 47
eH2_8                 9.203935e-02 1 1  ON 48
eH2_9                 2.578332e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.485804
====================================================
  Execution time = 3.2901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3615e-01
  Total weights = 2.0000e+06
  Execution time = 2.6506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329549295948
                                         uncertainty =       0.007489989993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329549295948
                                         uncertainty =       0.007489989993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405902780
  error estimate for blocks of size 2^( 2) =       0.000417443228
  error estimate for blocks of size 2^( 3) =       0.000428261648
  error estimate for blocks of size 2^( 4) =       0.000436166282
  error estimate for blocks of size 2^( 5) =       0.000440969326
  error estimate for blocks of size 2^( 6) =       0.000443355158
  error estimate for blocks of size 2^( 7) =       0.000445517998

      target function =                  N/A
              le_mean =     -17.211020906330
             les_mean =     296.548754606589
             stat err =       0.000441502191
             autocorr =       1.183100600835
              std dev =       0.574033216118
             le_variance =       0.329514133206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776523263
                                         uncertainty =       0.007826472770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776523263
                                         uncertainty =       0.007826472770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413968562
  error estimate for blocks of size 2^( 2) =       0.000424442294
  error estimate for blocks of size 2^( 3) =       0.000434329449
  error estimate for blocks of size 2^( 4) =       0.000441583002
  error estimate for blocks of size 2^( 5) =       0.000446068904
  error estimate for blocks of size 2^( 6) =       0.000448352888
  error estimate for blocks of size 2^( 7) =       0.000450389034

      target function =                  N/A
              le_mean =     -17.211040375012
             les_mean =     296.562650559390
             stat err =       0.000446598457
             autocorr =       1.163857247427
              std dev =       0.585439954615
             le_variance =       0.342739940459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345035579769
                                         uncertainty =       0.007823815545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345035579769
                                         uncertainty =       0.007823815545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415330735
  error estimate for blocks of size 2^( 2) =       0.000425778599
  error estimate for blocks of size 2^( 3) =       0.000435665600
  error estimate for blocks of size 2^( 4) =       0.000442942400
  error estimate for blocks of size 2^( 5) =       0.000447405628
  error estimate for blocks of size 2^( 6) =       0.000449689114
  error estimate for blocks of size 2^( 7) =       0.000451678684

      target function =                  N/A
              le_mean =     -17.211109462511
             les_mean =     296.567287997612
             stat err =       0.000447928956
             autocorr =       1.163135027384
              std dev =       0.587366358902
             le_variance =       0.344999239570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331968570570
                                         uncertainty =       0.007546229554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331968570570
                                         uncertainty =       0.007546229554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407389971
  error estimate for blocks of size 2^( 2) =       0.000418676155
  error estimate for blocks of size 2^( 3) =       0.000429289665
  error estimate for blocks of size 2^( 4) =       0.000437063612
  error estimate for blocks of size 2^( 5) =       0.000441792823
  error estimate for blocks of size 2^( 6) =       0.000444156332
  error estimate for blocks of size 2^( 7) =       0.000446279943

      target function =                  N/A
              le_mean =     -17.210936249639
             les_mean =     296.548259599677
             stat err =       0.000442323177
             autocorr =       1.178850486605
              std dev =       0.576136421794
             le_variance =       0.331933176518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211020906330        initial
     6.2500e-02     6.2500e-01             3.7337e-02       -17.211040375012
     2.5000e-01     2.5000e+00             1.5223e-02       -17.211109462511  <--
     1.0000e+00     1.0000e+01             4.7363e-03       -17.210936249639

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.6263e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.009897e-01 1 1  ON 0
 uu_1                 4.199976e-02 1 1  ON 1
 uu_2                -5.048263e-02 1 1  ON 2
 uu_3                -9.998958e-02 1 1  ON 3
 uu_4                -1.273729e-01 1 1  ON 4
 uu_5                -1.319630e-01 1 1  ON 5
 uu_6                -1.100598e-01 1 1  ON 6
 uu_7                -3.529781e-02 1 1  ON 7
 uu_8                 1.021733e-01 1 1  ON 8
 uu_9                 1.193028e-01 1 1  ON 9
 ud_0                 3.421560e-01 1 1  ON 10
 ud_1                 8.540568e-02 1 1  ON 11
 ud_2                -1.818759e-02 1 1  ON 12
 ud_3                -7.044564e-02 1 1  ON 13
 ud_4                -1.144098e-01 1 1  ON 14
 ud_5                -1.484932e-01 1 1  ON 15
 ud_6                -1.576088e-01 1 1  ON 16
 ud_7                -1.101350e-01 1 1  ON 17
 ud_8                 8.203042e-03 1 1  ON 18
 ud_9                 9.256330e-02 1 1  ON 19
 eO_0                -7.197316e-01 1 1  ON 20
 eO_1                -4.174814e-01 1 1  ON 21
 eO_2                -3.564751e-02 1 1  ON 22
 eO_3                 1.873966e-01 1 1  ON 23
 eO_4                 2.689554e-01 1 1  ON 24
 eO_5                 3.036582e-01 1 1  ON 25
 eO_6                 2.478306e-01 1 1  ON 26
 eO_7                 1.089016e-01 1 1  ON 27
 eO_8                 2.744434e-02 1 1  ON 28
 eO_9                 1.823478e-02 1 1  ON 29
eH1_0                -1.784255e-01 1 1  ON 30
eH1_1                -1.002652e-01 1 1  ON 31
eH1_2                -6.281537e-02 1 1  ON 32
eH1_3                -2.635647e-02 1 1  ON 33
eH1_4                 1.978177e-02 1 1  ON 34
eH1_5                 3.276004e-02 1 1  ON 35
eH1_6                 7.661785e-02 1 1  ON 36
eH1_7                 1.108090e-01 1 1  ON 37
eH1_8                 8.901878e-02 1 1  ON 38
eH1_9                 2.376678e-02 1 1  ON 39
eH2_0                -1.800481e-01 1 1  ON 40
eH2_1                -1.019991e-01 1 1  ON 41
eH2_2                -6.444486e-02 1 1  ON 42
eH2_3                -2.799911e-02 1 1  ON 43
eH2_4                 1.873503e-02 1 1  ON 44
eH2_5                 3.320284e-02 1 1  ON 45
eH2_6                 7.839007e-02 1 1  ON 46
eH2_7                 1.143685e-01 1 1  ON 47
eH2_8                 9.203935e-02 1 1  ON 48
eH2_9                 2.578332e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.0610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7282e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2307
    reference variance = 0.287905
====================================================
  Execution time = 3.1352e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 3.3105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331084037674
                                         uncertainty =       0.002656859851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331084037674
                                         uncertainty =       0.002656859851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406847023
  error estimate for blocks of size 2^( 2) =       0.000417854031
  error estimate for blocks of size 2^( 3) =       0.000427424398
  error estimate for blocks of size 2^( 4) =       0.000435004080
  error estimate for blocks of size 2^( 5) =       0.000439734573
  error estimate for blocks of size 2^( 6) =       0.000442338243
  error estimate for blocks of size 2^( 7) =       0.000443589023

      target function =                  N/A
              le_mean =     -17.210375403470
             les_mean =     296.528070363441
             stat err =       0.000440166480
             autocorr =       1.170500617305
              std dev =       0.575368578055
             le_variance =       0.331049000613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721037540347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210375403470       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210425979901       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210513709275       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210581041938       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210616082772       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210660896671       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210670635397       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210677028966       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.210683052978       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210695562710       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.210697870188       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.210697807835       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.210699552147       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.210699748304       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.210699367047       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.210698730541       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.777995e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210375403470       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210405432598       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210457006058       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210486103556       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210509978402       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210524125033       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210524474497       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210525519165       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.210526426460       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210528658683       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.210528504196       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.210528341109       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.088140e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210375403470       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210386842864       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210406714165       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210416343104       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210425368232       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210427967454       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210427427950       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210427572640       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.210427671752       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210427975910       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.210427971993       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.339689e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0122e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.038080e-01 1 1  ON 0
 uu_1                 4.301898e-02 1 1  ON 1
 uu_2                -5.097520e-02 1 1  ON 2
 uu_3                -1.016923e-01 1 1  ON 3
 uu_4                -1.289834e-01 1 1  ON 4
 uu_5                -1.321888e-01 1 1  ON 5
 uu_6                -1.099268e-01 1 1  ON 6
 uu_7                -3.595524e-02 1 1  ON 7
 uu_8                 1.019197e-01 1 1  ON 8
 uu_9                 1.196942e-01 1 1  ON 9
 ud_0                 3.465647e-01 1 1  ON 10
 ud_1                 8.740252e-02 1 1  ON 11
 ud_2                -1.882610e-02 1 1  ON 12
 ud_3                -7.320417e-02 1 1  ON 13
 ud_4                -1.169359e-01 1 1  ON 14
 ud_5                -1.489812e-01 1 1  ON 15
 ud_6                -1.570211e-01 1 1  ON 16
 ud_7                -1.106500e-01 1 1  ON 17
 ud_8                 7.580734e-03 1 1  ON 18
 ud_9                 9.268159e-02 1 1  ON 19
 eO_0                -7.306130e-01 1 1  ON 20
 eO_1                -4.219514e-01 1 1  ON 21
 eO_2                -3.199834e-02 1 1  ON 22
 eO_3                 1.952470e-01 1 1  ON 23
 eO_4                 2.724419e-01 1 1  ON 24
 eO_5                 3.032314e-01 1 1  ON 25
 eO_6                 2.479608e-01 1 1  ON 26
 eO_7                 1.093070e-01 1 1  ON 27
 eO_8                 2.752955e-02 1 1  ON 28
 eO_9                 1.831935e-02 1 1  ON 29
eH1_0                -1.795611e-01 1 1  ON 30
eH1_1                -1.012617e-01 1 1  ON 31
eH1_2                -6.254477e-02 1 1  ON 32
eH1_3                -2.623410e-02 1 1  ON 33
eH1_4                 2.000007e-02 1 1  ON 34
eH1_5                 3.393641e-02 1 1  ON 35
eH1_6                 7.660687e-02 1 1  ON 36
eH1_7                 1.106375e-01 1 1  ON 37
eH1_8                 8.933954e-02 1 1  ON 38
eH1_9                 2.390337e-02 1 1  ON 39
eH2_0                -1.806741e-01 1 1  ON 40
eH2_1                -1.026698e-01 1 1  ON 41
eH2_2                -6.419724e-02 1 1  ON 42
eH2_3                -2.763412e-02 1 1  ON 43
eH2_4                 1.879003e-02 1 1  ON 44
eH2_5                 3.384312e-02 1 1  ON 45
eH2_6                 7.803687e-02 1 1  ON 46
eH2_7                 1.142386e-01 1 1  ON 47
eH2_8                 9.235573e-02 1 1  ON 48
eH2_9                 2.589948e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 0.23056
====================================================
  Execution time = 3.1016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5593e-01
  Total weights = 2.0000e+06
  Execution time = 2.6613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352018477136
                                         uncertainty =       0.007742438873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352018477136
                                         uncertainty =       0.007742438873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419487669
  error estimate for blocks of size 2^( 2) =       0.000430641172
  error estimate for blocks of size 2^( 3) =       0.000440363821
  error estimate for blocks of size 2^( 4) =       0.000446954531
  error estimate for blocks of size 2^( 5) =       0.000452363295
  error estimate for blocks of size 2^( 6) =       0.000455181773
  error estimate for blocks of size 2^( 7) =       0.000457203317

      target function =                  N/A
              le_mean =     -17.211459076782
             les_mean =     296.586263185258
             stat err =       0.000452925729
             autocorr =       1.165777275110
              std dev =       0.593245151253
             le_variance =       0.351939809485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360257390598
                                         uncertainty =       0.007908791756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360257390598
                                         uncertainty =       0.007908791756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424368876
  error estimate for blocks of size 2^( 2) =       0.000435032009
  error estimate for blocks of size 2^( 3) =       0.000444304376
  error estimate for blocks of size 2^( 4) =       0.000450539358
  error estimate for blocks of size 2^( 5) =       0.000455757318
  error estimate for blocks of size 2^( 6) =       0.000458502563
  error estimate for blocks of size 2^( 7) =       0.000460497385

      target function =                  N/A
              le_mean =     -17.211494256432
             les_mean =     296.595712245221
             stat err =       0.000456324156
             autocorr =       1.156271627421
              std dev =       0.600148220120
             le_variance =       0.360177886113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360565883224
                                         uncertainty =       0.007921497918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360565883224
                                         uncertainty =       0.007921497918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424550528
  error estimate for blocks of size 2^( 2) =       0.000435233115
  error estimate for blocks of size 2^( 3) =       0.000444533688
  error estimate for blocks of size 2^( 4) =       0.000450807518
  error estimate for blocks of size 2^( 5) =       0.000456036741
  error estimate for blocks of size 2^( 6) =       0.000458774605
  error estimate for blocks of size 2^( 7) =       0.000460755333

      target function =                  N/A
              le_mean =     -17.211481846718
             les_mean =     296.595593480735
             stat err =       0.000456593549
             autocorr =       1.156646833460
              std dev =       0.600405114144
             le_variance =       0.360486301090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353446435419
                                         uncertainty =       0.007775890227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353446435419
                                         uncertainty =       0.007775890227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420337722
  error estimate for blocks of size 2^( 2) =       0.000431395328
  error estimate for blocks of size 2^( 3) =       0.000441034988
  error estimate for blocks of size 2^( 4) =       0.000447566687
  error estimate for blocks of size 2^( 5) =       0.000452941341
  error estimate for blocks of size 2^( 6) =       0.000455742592
  error estimate for blocks of size 2^( 7) =       0.000457755057

      target function =                  N/A
              le_mean =     -17.211435090830
             les_mean =     296.586865310577
             stat err =       0.000453501419
             autocorr =       1.164020338314
              std dev =       0.594447307518
             le_variance =       0.353367601415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211459076782        initial
     6.2500e-02     6.2500e-01             2.7780e-02       -17.211494256432  <--
     2.5000e-01     2.5000e+00             1.0881e-02       -17.211481846718
     1.0000e+00     1.0000e+01             3.3397e-03       -17.211435090830

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 4.4385e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.079587e-01 1 1  ON 0
 uu_1                 4.503829e-02 1 1  ON 1
 uu_2                -5.075431e-02 1 1  ON 2
 uu_3                -1.034488e-01 1 1  ON 3
 uu_4                -1.318354e-01 1 1  ON 4
 uu_5                -1.342341e-01 1 1  ON 5
 uu_6                -1.103363e-01 1 1  ON 6
 uu_7                -3.761814e-02 1 1  ON 7
 uu_8                 1.012375e-01 1 1  ON 8
 uu_9                 1.209106e-01 1 1  ON 9
 ud_0                 3.514120e-01 1 1  ON 10
 ud_1                 9.028462e-02 1 1  ON 11
 ud_2                -1.842906e-02 1 1  ON 12
 ud_3                -7.543179e-02 1 1  ON 13
 ud_4                -1.203457e-01 1 1  ON 14
 ud_5                -1.511610e-01 1 1  ON 15
 ud_6                -1.565757e-01 1 1  ON 16
 ud_7                -1.115305e-01 1 1  ON 17
 ud_8                 5.956610e-03 1 1  ON 18
 ud_9                 9.307799e-02 1 1  ON 19
 eO_0                -7.475116e-01 1 1  ON 20
 eO_1                -4.313369e-01 1 1  ON 21
 eO_2                -3.104967e-02 1 1  ON 22
 eO_3                 2.061079e-01 1 1  ON 23
 eO_4                 2.827412e-01 1 1  ON 24
 eO_5                 3.045295e-01 1 1  ON 25
 eO_6                 2.487402e-01 1 1  ON 26
 eO_7                 1.105985e-01 1 1  ON 27
 eO_8                 2.780533e-02 1 1  ON 28
 eO_9                 1.858150e-02 1 1  ON 29
eH1_0                -1.816932e-01 1 1  ON 30
eH1_1                -1.029309e-01 1 1  ON 31
eH1_2                -6.249891e-02 1 1  ON 32
eH1_3                -2.610587e-02 1 1  ON 33
eH1_4                 1.987328e-02 1 1  ON 34
eH1_5                 3.531248e-02 1 1  ON 35
eH1_6                 7.746974e-02 1 1  ON 36
eH1_7                 1.104795e-01 1 1  ON 37
eH1_8                 9.036764e-02 1 1  ON 38
eH1_9                 2.433233e-02 1 1  ON 39
eH2_0                -1.819283e-01 1 1  ON 40
eH2_1                -1.038693e-01 1 1  ON 41
eH2_2                -6.384900e-02 1 1  ON 42
eH2_3                -2.720352e-02 1 1  ON 43
eH2_4                 1.861921e-02 1 1  ON 44
eH2_5                 3.438745e-02 1 1  ON 45
eH2_6                 7.792501e-02 1 1  ON 46
eH2_7                 1.141670e-01 1 1  ON 47
eH2_8                 9.335564e-02 1 1  ON 48
eH2_9                 2.626202e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7258e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.336
    reference variance = 0.219391
====================================================
  Execution time = 3.1401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3780e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337822228086
                                         uncertainty =       0.003802023455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337822228086
                                         uncertainty =       0.003802023455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410975868
  error estimate for blocks of size 2^( 2) =       0.000422042496
  error estimate for blocks of size 2^( 3) =       0.000432139439
  error estimate for blocks of size 2^( 4) =       0.000439054564
  error estimate for blocks of size 2^( 5) =       0.000443619439
  error estimate for blocks of size 2^( 6) =       0.000446410179
  error estimate for blocks of size 2^( 7) =       0.000448677362

      target function =                  N/A
              le_mean =     -17.211291739366
             les_mean =     296.566365496609
             stat err =       0.000444440386
             autocorr =       1.169484282258
              std dev =       0.581207646145
             le_variance =       0.337802327938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721129173937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211291739366       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211293287427       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211319574758       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211324411680       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211334880488       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211352399613       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211360129509       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211367872459       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211372263145       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211373509464       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211380669120       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211382519217       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211379390090       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211379272979       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211384280870       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211386605113       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211386845612       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211387179219       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211386495314       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.211385590195       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.211386152622       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 3.201059e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211291739366       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211292967012       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211314177017       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211315204222       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211321084736       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211331610637       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211334047263       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211337399320       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211337757609       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211336879512       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211338601674       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211339015227       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211338065167       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211337894081       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211338728048       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.411826e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211291739366       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211292410976       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211303518857       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211302352193       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211304354310       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211307792277       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211308016801       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211308885774       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211308655906       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211308261614       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211308394865       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.954896e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0160e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.120835e-01 1 1  ON 0
 uu_1                 4.775455e-02 1 1  ON 1
 uu_2                -4.963654e-02 1 1  ON 2
 uu_3                -1.042235e-01 1 1  ON 3
 uu_4                -1.339576e-01 1 1  ON 4
 uu_5                -1.364016e-01 1 1  ON 5
 uu_6                -1.117445e-01 1 1  ON 6
 uu_7                -3.952906e-02 1 1  ON 7
 uu_8                 9.961117e-02 1 1  ON 8
 uu_9                 1.217125e-01 1 1  ON 9
 ud_0                 3.550695e-01 1 1  ON 10
 ud_1                 9.255846e-02 1 1  ON 11
 ud_2                -1.760711e-02 1 1  ON 12
 ud_3                -7.642797e-02 1 1  ON 13
 ud_4                -1.224385e-01 1 1  ON 14
 ud_5                -1.539891e-01 1 1  ON 15
 ud_6                -1.564394e-01 1 1  ON 16
 ud_7                -1.116392e-01 1 1  ON 17
 ud_8                 3.874889e-03 1 1  ON 18
 ud_9                 9.297575e-02 1 1  ON 19
 eO_0                -7.616298e-01 1 1  ON 20
 eO_1                -4.403442e-01 1 1  ON 21
 eO_2                -3.235565e-02 1 1  ON 22
 eO_3                 2.137762e-01 1 1  ON 23
 eO_4                 2.934575e-01 1 1  ON 24
 eO_5                 3.069734e-01 1 1  ON 25
 eO_6                 2.499206e-01 1 1  ON 26
 eO_7                 1.123824e-01 1 1  ON 27
 eO_8                 2.804596e-02 1 1  ON 28
 eO_9                 1.873760e-02 1 1  ON 29
eH1_0                -1.828402e-01 1 1  ON 30
eH1_1                -1.043785e-01 1 1  ON 31
eH1_2                -6.249569e-02 1 1  ON 32
eH1_3                -2.584779e-02 1 1  ON 33
eH1_4                 1.952230e-02 1 1  ON 34
eH1_5                 3.548821e-02 1 1  ON 35
eH1_6                 7.833554e-02 1 1  ON 36
eH1_7                 1.103195e-01 1 1  ON 37
eH1_8                 9.158034e-02 1 1  ON 38
eH1_9                 2.474842e-02 1 1  ON 39
eH2_0                -1.846560e-01 1 1  ON 40
eH2_1                -1.048589e-01 1 1  ON 41
eH2_2                -6.343180e-02 1 1  ON 42
eH2_3                -2.657222e-02 1 1  ON 43
eH2_4                 1.950146e-02 1 1  ON 44
eH2_5                 3.495455e-02 1 1  ON 45
eH2_6                 7.832868e-02 1 1  ON 46
eH2_7                 1.136482e-01 1 1  ON 47
eH2_8                 9.415122e-02 1 1  ON 48
eH2_9                 2.659706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2273
    reference variance = 0.267528
====================================================
  Execution time = 3.0966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3441e-01
  Total weights = 2.0000e+06
  Execution time = 2.6618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331492788043
                                         uncertainty =       0.002434606182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331492788043
                                         uncertainty =       0.002434606182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407094671
  error estimate for blocks of size 2^( 2) =       0.000417996788
  error estimate for blocks of size 2^( 3) =       0.000428114420
  error estimate for blocks of size 2^( 4) =       0.000435676154
  error estimate for blocks of size 2^( 5) =       0.000439938771
  error estimate for blocks of size 2^( 6) =       0.000442229196
  error estimate for blocks of size 2^( 7) =       0.000444273689

      target function =                  N/A
              le_mean =     -17.211589680784
             les_mean =     296.570271316625
             stat err =       0.000440529453
             autocorr =       1.171005846928
              std dev =       0.575718805224
             le_variance =       0.331452142689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336604279833
                                         uncertainty =       0.002477300885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336604279833
                                         uncertainty =       0.002477300885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410220706
  error estimate for blocks of size 2^( 2) =       0.000420895941
  error estimate for blocks of size 2^( 3) =       0.000430756825
  error estimate for blocks of size 2^( 4) =       0.000438134714
  error estimate for blocks of size 2^( 5) =       0.000442308889
  error estimate for blocks of size 2^( 6) =       0.000444588582
  error estimate for blocks of size 2^( 7) =       0.000446688310

      target function =                  N/A
              le_mean =     -17.211567574193
             les_mean =     296.574620247419
             stat err =       0.000442930124
             autocorr =       1.165830145903
              std dev =       0.580139685503
             le_variance =       0.336562054695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337709110832
                                         uncertainty =       0.002489106710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337709110832
                                         uncertainty =       0.002489106710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410893201
  error estimate for blocks of size 2^( 2) =       0.000421540892
  error estimate for blocks of size 2^( 3) =       0.000431378929
  error estimate for blocks of size 2^( 4) =       0.000438742328
  error estimate for blocks of size 2^( 5) =       0.000442907520
  error estimate for blocks of size 2^( 6) =       0.000445200959
  error estimate for blocks of size 2^( 7) =       0.000447316046

      target function =                  N/A
              le_mean =     -17.211573705099
             les_mean =     296.575935682479
             stat err =       0.000443541713
             autocorr =       1.165228314518
              std dev =       0.581090737531
             le_variance =       0.337666445245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332856766759
                                         uncertainty =       0.002447459300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332856766759
                                         uncertainty =       0.002447459300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407931159
  error estimate for blocks of size 2^( 2) =       0.000418765660
  error estimate for blocks of size 2^( 3) =       0.000428814682
  error estimate for blocks of size 2^( 4) =       0.000436329252
  error estimate for blocks of size 2^( 5) =       0.000440567495
  error estimate for blocks of size 2^( 6) =       0.000442860337
  error estimate for blocks of size 2^( 7) =       0.000444923040

      target function =                  N/A
              le_mean =     -17.211568535404
             les_mean =     296.570906943678
             stat err =       0.000441170031
             autocorr =       1.169602388671
              std dev =       0.576901777764
             le_variance =       0.332815661187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211589680784        initial  <--
     1.5625e-02     1.5625e-01             3.2011e-02       -17.211567574193
     6.2500e-02     6.2500e-01             1.4118e-02       -17.211573705099
     2.5000e-01     2.5000e+00             4.9549e-03       -17.211568535404

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3036
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.079587e-01 1 1  ON 0
 uu_1                 4.503829e-02 1 1  ON 1
 uu_2                -5.075431e-02 1 1  ON 2
 uu_3                -1.034488e-01 1 1  ON 3
 uu_4                -1.318354e-01 1 1  ON 4
 uu_5                -1.342341e-01 1 1  ON 5
 uu_6                -1.103363e-01 1 1  ON 6
 uu_7                -3.761814e-02 1 1  ON 7
 uu_8                 1.012375e-01 1 1  ON 8
 uu_9                 1.209106e-01 1 1  ON 9
 ud_0                 3.514120e-01 1 1  ON 10
 ud_1                 9.028462e-02 1 1  ON 11
 ud_2                -1.842906e-02 1 1  ON 12
 ud_3                -7.543179e-02 1 1  ON 13
 ud_4                -1.203457e-01 1 1  ON 14
 ud_5                -1.511610e-01 1 1  ON 15
 ud_6                -1.565757e-01 1 1  ON 16
 ud_7                -1.115305e-01 1 1  ON 17
 ud_8                 5.956610e-03 1 1  ON 18
 ud_9                 9.307799e-02 1 1  ON 19
 eO_0                -7.475116e-01 1 1  ON 20
 eO_1                -4.313369e-01 1 1  ON 21
 eO_2                -3.104967e-02 1 1  ON 22
 eO_3                 2.061079e-01 1 1  ON 23
 eO_4                 2.827412e-01 1 1  ON 24
 eO_5                 3.045295e-01 1 1  ON 25
 eO_6                 2.487402e-01 1 1  ON 26
 eO_7                 1.105985e-01 1 1  ON 27
 eO_8                 2.780533e-02 1 1  ON 28
 eO_9                 1.858150e-02 1 1  ON 29
eH1_0                -1.816932e-01 1 1  ON 30
eH1_1                -1.029309e-01 1 1  ON 31
eH1_2                -6.249891e-02 1 1  ON 32
eH1_3                -2.610587e-02 1 1  ON 33
eH1_4                 1.987328e-02 1 1  ON 34
eH1_5                 3.531248e-02 1 1  ON 35
eH1_6                 7.746974e-02 1 1  ON 36
eH1_7                 1.104795e-01 1 1  ON 37
eH1_8                 9.036764e-02 1 1  ON 38
eH1_9                 2.433233e-02 1 1  ON 39
eH2_0                -1.819283e-01 1 1  ON 40
eH2_1                -1.038693e-01 1 1  ON 41
eH2_2                -6.384900e-02 1 1  ON 42
eH2_3                -2.720352e-02 1 1  ON 43
eH2_4                 1.861921e-02 1 1  ON 44
eH2_5                 3.438745e-02 1 1  ON 45
eH2_6                 7.792501e-02 1 1  ON 46
eH2_7                 1.141670e-01 1 1  ON 47
eH2_8                 9.335564e-02 1 1  ON 48
eH2_9                 2.626202e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7264e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1765
    reference variance = 0.209914
====================================================
  Execution time = 3.1451e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3261e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332591688277
                                         uncertainty =       0.002643925322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332591688277
                                         uncertainty =       0.002643925322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407806477
  error estimate for blocks of size 2^( 2) =       0.000419040780
  error estimate for blocks of size 2^( 3) =       0.000428767478
  error estimate for blocks of size 2^( 4) =       0.000436062208
  error estimate for blocks of size 2^( 5) =       0.000441178069
  error estimate for blocks of size 2^( 6) =       0.000444626287
  error estimate for blocks of size 2^( 7) =       0.000446820825

      target function =                  N/A
              le_mean =     -17.211243287449
             les_mean =     296.559507579484
             stat err =       0.000442171847
             autocorr =       1.175638869445
              std dev =       0.576725451163
             le_variance =       0.332612246020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721124328745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211243287449       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211247017102       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211259888676       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211264267643       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211270728147       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211270672764       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211271186391       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211273955581       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211274425599       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211273981992       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211274081859       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211274243274       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 7.307792e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211243287449       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211244874666       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211250638792       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211251863817       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211253626858       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211253059259       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211253059903       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211253729560       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211253763585       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211253718566       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.239194e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211243287449       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211243768755       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211245600683       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211245956565       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211246361659       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211246134686       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211246120483       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211246247180       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211246250787       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.020155e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0304e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.087274e-01 1 1  ON 0
 uu_1                 4.545557e-02 1 1  ON 1
 uu_2                -5.077545e-02 1 1  ON 2
 uu_3                -1.036644e-01 1 1  ON 3
 uu_4                -1.323050e-01 1 1  ON 4
 uu_5                -1.346456e-01 1 1  ON 5
 uu_6                -1.104268e-01 1 1  ON 6
 uu_7                -3.771729e-02 1 1  ON 7
 uu_8                 1.011495e-01 1 1  ON 8
 uu_9                 1.210027e-01 1 1  ON 9
 ud_0                 3.521275e-01 1 1  ON 10
 ud_1                 9.063397e-02 1 1  ON 11
 ud_2                -1.850637e-02 1 1  ON 12
 ud_3                -7.586545e-02 1 1  ON 13
 ud_4                -1.207431e-01 1 1  ON 14
 ud_5                -1.514828e-01 1 1  ON 15
 ud_6                -1.564011e-01 1 1  ON 16
 ud_7                -1.114837e-01 1 1  ON 17
 ud_8                 5.787961e-03 1 1  ON 18
 ud_9                 9.308590e-02 1 1  ON 19
 eO_0                -7.497508e-01 1 1  ON 20
 eO_1                -4.325377e-01 1 1  ON 21
 eO_2                -3.088063e-02 1 1  ON 22
 eO_3                 2.076987e-01 1 1  ON 23
 eO_4                 2.839459e-01 1 1  ON 24
 eO_5                 3.045657e-01 1 1  ON 25
 eO_6                 2.489026e-01 1 1  ON 26
 eO_7                 1.108184e-01 1 1  ON 27
 eO_8                 2.784019e-02 1 1  ON 28
 eO_9                 1.859145e-02 1 1  ON 29
eH1_0                -1.817447e-01 1 1  ON 30
eH1_1                -1.032140e-01 1 1  ON 31
eH1_2                -6.251575e-02 1 1  ON 32
eH1_3                -2.606712e-02 1 1  ON 33
eH1_4                 2.005743e-02 1 1  ON 34
eH1_5                 3.532951e-02 1 1  ON 35
eH1_6                 7.743345e-02 1 1  ON 36
eH1_7                 1.104683e-01 1 1  ON 37
eH1_8                 9.048715e-02 1 1  ON 38
eH1_9                 2.436216e-02 1 1  ON 39
eH2_0                -1.821913e-01 1 1  ON 40
eH2_1                -1.040071e-01 1 1  ON 41
eH2_2                -6.384263e-02 1 1  ON 42
eH2_3                -2.704886e-02 1 1  ON 43
eH2_4                 1.861189e-02 1 1  ON 44
eH2_5                 3.445522e-02 1 1  ON 45
eH2_6                 7.799725e-02 1 1  ON 46
eH2_7                 1.141217e-01 1 1  ON 47
eH2_8                 9.345375e-02 1 1  ON 48
eH2_9                 2.630279e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1413
    reference variance = 0.22043
====================================================
  Execution time = 3.0987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5254e-01
  Total weights = 2.0000e+06
  Execution time = 2.6644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351403822926
                                         uncertainty =       0.009432315538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351403822926
                                         uncertainty =       0.009432315538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419343105
  error estimate for blocks of size 2^( 2) =       0.000430109852
  error estimate for blocks of size 2^( 3) =       0.000439724322
  error estimate for blocks of size 2^( 4) =       0.000446639845
  error estimate for blocks of size 2^( 5) =       0.000450375812
  error estimate for blocks of size 2^( 6) =       0.000452940456
  error estimate for blocks of size 2^( 7) =       0.000455294669

      target function =                  N/A
              le_mean =     -17.211749387389
             les_mean =     296.596014077013
             stat err =       0.000451312695
             autocorr =       1.158286751003
              std dev =       0.593040705676
             le_variance =       0.351697278589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353565109125
                                         uncertainty =       0.009485839567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353565109125
                                         uncertainty =       0.009485839567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420629813
  error estimate for blocks of size 2^( 2) =       0.000431309725
  error estimate for blocks of size 2^( 3) =       0.000440831331
  error estimate for blocks of size 2^( 4) =       0.000447667945
  error estimate for blocks of size 2^( 5) =       0.000451375336
  error estimate for blocks of size 2^( 6) =       0.000453874009
  error estimate for blocks of size 2^( 7) =       0.000456232648

      target function =                  N/A
              le_mean =     -17.211745028686
             les_mean =     296.598025635177
             stat err =       0.000452287484
             autocorr =       1.156189544833
              std dev =       0.594860386663
             le_variance =       0.353858879621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353112808274
                                         uncertainty =       0.009478119507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353112808274
                                         uncertainty =       0.009478119507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420360760
  error estimate for blocks of size 2^( 2) =       0.000431062243
  error estimate for blocks of size 2^( 3) =       0.000440607933
  error estimate for blocks of size 2^( 4) =       0.000447468138
  error estimate for blocks of size 2^( 5) =       0.000451180934
  error estimate for blocks of size 2^( 6) =       0.000453692970
  error estimate for blocks of size 2^( 7) =       0.000456048412

      target function =                  N/A
              le_mean =     -17.211744994870
             les_mean =     296.597571928385
             stat err =       0.000452097613
             autocorr =       1.156698285465
              std dev =       0.594479887504
             le_variance =       0.353406336647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351661126092
                                         uncertainty =       0.009439485315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351661126092
                                         uncertainty =       0.009439485315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419496474
  error estimate for blocks of size 2^( 2) =       0.000430253186
  error estimate for blocks of size 2^( 3) =       0.000439857194
  error estimate for blocks of size 2^( 4) =       0.000446764754
  error estimate for blocks of size 2^( 5) =       0.000450497026
  error estimate for blocks of size 2^( 6) =       0.000453053435
  error estimate for blocks of size 2^( 7) =       0.000455407478

      target function =                  N/A
              le_mean =     -17.211748084682
             les_mean =     296.596226538344
             stat err =       0.000451430673
             autocorr =       1.158045169217
              std dev =       0.593257603218
             le_variance =       0.351954583776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211749387389        initial  <--
     1.5625e-01     1.5625e+00             7.3078e-03       -17.211745028686
     6.2500e-01     6.2500e+00             2.2392e-03       -17.211744994870
     2.5000e+00     2.5000e+01             6.0202e-04       -17.211748084682

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.1348
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.079587e-01 1 1  ON 0
 uu_1                 4.503829e-02 1 1  ON 1
 uu_2                -5.075431e-02 1 1  ON 2
 uu_3                -1.034488e-01 1 1  ON 3
 uu_4                -1.318354e-01 1 1  ON 4
 uu_5                -1.342341e-01 1 1  ON 5
 uu_6                -1.103363e-01 1 1  ON 6
 uu_7                -3.761814e-02 1 1  ON 7
 uu_8                 1.012375e-01 1 1  ON 8
 uu_9                 1.209106e-01 1 1  ON 9
 ud_0                 3.514120e-01 1 1  ON 10
 ud_1                 9.028462e-02 1 1  ON 11
 ud_2                -1.842906e-02 1 1  ON 12
 ud_3                -7.543179e-02 1 1  ON 13
 ud_4                -1.203457e-01 1 1  ON 14
 ud_5                -1.511610e-01 1 1  ON 15
 ud_6                -1.565757e-01 1 1  ON 16
 ud_7                -1.115305e-01 1 1  ON 17
 ud_8                 5.956610e-03 1 1  ON 18
 ud_9                 9.307799e-02 1 1  ON 19
 eO_0                -7.475116e-01 1 1  ON 20
 eO_1                -4.313369e-01 1 1  ON 21
 eO_2                -3.104967e-02 1 1  ON 22
 eO_3                 2.061079e-01 1 1  ON 23
 eO_4                 2.827412e-01 1 1  ON 24
 eO_5                 3.045295e-01 1 1  ON 25
 eO_6                 2.487402e-01 1 1  ON 26
 eO_7                 1.105985e-01 1 1  ON 27
 eO_8                 2.780533e-02 1 1  ON 28
 eO_9                 1.858150e-02 1 1  ON 29
eH1_0                -1.816932e-01 1 1  ON 30
eH1_1                -1.029309e-01 1 1  ON 31
eH1_2                -6.249891e-02 1 1  ON 32
eH1_3                -2.610587e-02 1 1  ON 33
eH1_4                 1.987328e-02 1 1  ON 34
eH1_5                 3.531248e-02 1 1  ON 35
eH1_6                 7.746974e-02 1 1  ON 36
eH1_7                 1.104795e-01 1 1  ON 37
eH1_8                 9.036764e-02 1 1  ON 38
eH1_9                 2.433233e-02 1 1  ON 39
eH2_0                -1.819283e-01 1 1  ON 40
eH2_1                -1.038693e-01 1 1  ON 41
eH2_2                -6.384900e-02 1 1  ON 42
eH2_3                -2.720352e-02 1 1  ON 43
eH2_4                 1.861921e-02 1 1  ON 44
eH2_5                 3.438745e-02 1 1  ON 45
eH2_6                 7.792501e-02 1 1  ON 46
eH2_7                 1.141670e-01 1 1  ON 47
eH2_8                 9.335564e-02 1 1  ON 48
eH2_9                 2.626202e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7243e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1869
    reference variance = 0.270363
====================================================
  Execution time = 3.1174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4069e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340681873089
                                         uncertainty =       0.004354718984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340681873089
                                         uncertainty =       0.004354718984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412730321
  error estimate for blocks of size 2^( 2) =       0.000423667143
  error estimate for blocks of size 2^( 3) =       0.000433500948
  error estimate for blocks of size 2^( 4) =       0.000440605280
  error estimate for blocks of size 2^( 5) =       0.000445207809
  error estimate for blocks of size 2^( 6) =       0.000448057667
  error estimate for blocks of size 2^( 7) =       0.000445684827

      target function =                  N/A
              le_mean =     -17.211646732819
             les_mean =     296.581475721299
             stat err =       0.000444888896
             autocorr =       1.161904359586
              std dev =       0.583688818038
             le_variance =       0.340692636303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721164673282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211646732819       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211647482838       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211649929401       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211650578383       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211650994468       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211651309381       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211651420190       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211651372414       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211651397704       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 9.091459e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211646732819       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211646935425       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211647593621       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211647734075       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211647833575       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211647919161       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211647942353       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211647933732       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.348031e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211646732819       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211646784511       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211646952321       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211646985659       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211647010172       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211647032012       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211647037612       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211647035934       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 5.917842e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0099e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.080069e-01 1 1  ON 0
 uu_1                 4.508810e-02 1 1  ON 1
 uu_2                -5.074241e-02 1 1  ON 2
 uu_3                -1.034652e-01 1 1  ON 3
 uu_4                -1.318706e-01 1 1  ON 4
 uu_5                -1.342603e-01 1 1  ON 5
 uu_6                -1.103487e-01 1 1  ON 6
 uu_7                -3.764080e-02 1 1  ON 7
 uu_8                 1.012225e-01 1 1  ON 8
 uu_9                 1.209181e-01 1 1  ON 9
 ud_0                 3.515008e-01 1 1  ON 10
 ud_1                 9.032032e-02 1 1  ON 11
 ud_2                -1.843099e-02 1 1  ON 12
 ud_3                -7.547362e-02 1 1  ON 13
 ud_4                -1.203800e-01 1 1  ON 14
 ud_5                -1.511932e-01 1 1  ON 15
 ud_6                -1.565582e-01 1 1  ON 16
 ud_7                -1.115405e-01 1 1  ON 17
 ud_8                 5.931867e-03 1 1  ON 18
 ud_9                 9.307551e-02 1 1  ON 19
 eO_0                -7.477464e-01 1 1  ON 20
 eO_1                -4.314602e-01 1 1  ON 21
 eO_2                -3.102293e-02 1 1  ON 22
 eO_3                 2.062641e-01 1 1  ON 23
 eO_4                 2.828774e-01 1 1  ON 24
 eO_5                 3.045409e-01 1 1  ON 25
 eO_6                 2.487450e-01 1 1  ON 26
 eO_7                 1.106165e-01 1 1  ON 27
 eO_8                 2.780821e-02 1 1  ON 28
 eO_9                 1.858258e-02 1 1  ON 29
eH1_0                -1.817166e-01 1 1  ON 30
eH1_1                -1.029666e-01 1 1  ON 31
eH1_2                -6.250373e-02 1 1  ON 32
eH1_3                -2.609425e-02 1 1  ON 33
eH1_4                 1.987038e-02 1 1  ON 34
eH1_5                 3.534237e-02 1 1  ON 35
eH1_6                 7.748811e-02 1 1  ON 36
eH1_7                 1.104748e-01 1 1  ON 37
eH1_8                 9.037533e-02 1 1  ON 38
eH1_9                 2.433505e-02 1 1  ON 39
eH2_0                -1.819420e-01 1 1  ON 40
eH2_1                -1.038931e-01 1 1  ON 41
eH2_2                -6.384818e-02 1 1  ON 42
eH2_3                -2.719744e-02 1 1  ON 43
eH2_4                 1.863279e-02 1 1  ON 44
eH2_5                 3.440314e-02 1 1  ON 45
eH2_6                 7.792707e-02 1 1  ON 46
eH2_7                 1.141572e-01 1 1  ON 47
eH2_8                 9.336214e-02 1 1  ON 48
eH2_9                 2.626442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1753
    reference variance = 0.173972
====================================================
  Execution time = 3.0957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4208e-01
  Total weights = 2.0000e+06
  Execution time = 2.6622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341951407913
                                         uncertainty =       0.003522845202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341951407913
                                         uncertainty =       0.003522845202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413521074
  error estimate for blocks of size 2^( 2) =       0.000424487153
  error estimate for blocks of size 2^( 3) =       0.000434377668
  error estimate for blocks of size 2^( 4) =       0.000441222957
  error estimate for blocks of size 2^( 5) =       0.000445917320
  error estimate for blocks of size 2^( 6) =       0.000448947472
  error estimate for blocks of size 2^( 7) =       0.000449593299

      target function =                  N/A
              le_mean =     -17.211229762655
             les_mean =     296.568429129902
             stat err =       0.000446420262
             autocorr =       1.165446927489
              std dev =       0.584807111781
             le_variance =       0.341999357989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342245466232
                                         uncertainty =       0.003525630479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342245466232
                                         uncertainty =       0.003525630479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413698852
  error estimate for blocks of size 2^( 2) =       0.000424651130
  error estimate for blocks of size 2^( 3) =       0.000434528692
  error estimate for blocks of size 2^( 4) =       0.000441365503
  error estimate for blocks of size 2^( 5) =       0.000446055429
  error estimate for blocks of size 2^( 6) =       0.000449081331
  error estimate for blocks of size 2^( 7) =       0.000449726405

      target function =                  N/A
              le_mean =     -17.211230621729
             les_mean =     296.568752823236
             stat err =       0.000446557167
             autocorr =       1.165159812479
              std dev =       0.585058527023
             le_variance =       0.342293480042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342115034974
                                         uncertainty =       0.003524454661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342115034974
                                         uncertainty =       0.003524454661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413620007
  error estimate for blocks of size 2^( 2) =       0.000424578478
  error estimate for blocks of size 2^( 3) =       0.000434461983
  error estimate for blocks of size 2^( 4) =       0.000441302709
  error estimate for blocks of size 2^( 5) =       0.000445994623
  error estimate for blocks of size 2^( 6) =       0.000449022600
  error estimate for blocks of size 2^( 7) =       0.000449667908

      target function =                  N/A
              le_mean =     -17.211230186071
             les_mean =     296.568607366777
             stat err =       0.000446496960
             autocorr =       1.165289780975
              std dev =       0.584947023192
             le_variance =       0.342163019941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341972368376
                                         uncertainty =       0.003523051898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341972368376
                                         uncertainty =       0.003523051898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413533749
  error estimate for blocks of size 2^( 2) =       0.000424498852
  error estimate for blocks of size 2^( 3) =       0.000434388472
  error estimate for blocks of size 2^( 4) =       0.000441233179
  error estimate for blocks of size 2^( 5) =       0.000445927227
  error estimate for blocks of size 2^( 6) =       0.000448957104
  error estimate for blocks of size 2^( 7) =       0.000449602863

      target function =                  N/A
              le_mean =     -17.211229812154
             les_mean =     296.568451798692
             stat err =       0.000446430093
             autocorr =       1.165426816393
              std dev =       0.584825036165
             le_variance =       0.342020322925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211229762655        initial
     1.5625e+00     1.5625e+01             9.0915e-04       -17.211230621729  <--
     6.2500e+00     6.2500e+01             2.3480e-04       -17.211230186071
     2.5000e+01     2.5000e+02             5.9178e-05       -17.211229812154

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.4284e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.081587e-01 1 1  ON 0
 uu_1                 4.522488e-02 1 1  ON 1
 uu_2                -5.070641e-02 1 1  ON 2
 uu_3                -1.035105e-01 1 1  ON 3
 uu_4                -1.319727e-01 1 1  ON 4
 uu_5                -1.343413e-01 1 1  ON 5
 uu_6                -1.103868e-01 1 1  ON 6
 uu_7                -3.770844e-02 1 1  ON 7
 uu_8                 1.011773e-01 1 1  ON 8
 uu_9                 1.209408e-01 1 1  ON 9
 ud_0                 3.517364e-01 1 1  ON 10
 ud_1                 9.042983e-02 1 1  ON 11
 ud_2                -1.842686e-02 1 1  ON 12
 ud_3                -7.558345e-02 1 1  ON 13
 ud_4                -1.204824e-01 1 1  ON 14
 ud_5                -1.512863e-01 1 1  ON 15
 ud_6                -1.565084e-01 1 1  ON 16
 ud_7                -1.115699e-01 1 1  ON 17
 ud_8                 5.857724e-03 1 1  ON 18
 ud_9                 9.306806e-02 1 1  ON 19
 eO_0                -7.484207e-01 1 1  ON 20
 eO_1                -4.318265e-01 1 1  ON 21
 eO_2                -3.096304e-02 1 1  ON 22
 eO_3                 2.067084e-01 1 1  ON 23
 eO_4                 2.832890e-01 1 1  ON 24
 eO_5                 3.045810e-01 1 1  ON 25
 eO_6                 2.487605e-01 1 1  ON 26
 eO_7                 1.106712e-01 1 1  ON 27
 eO_8                 2.781694e-02 1 1  ON 28
 eO_9                 1.858586e-02 1 1  ON 29
eH1_0                -1.817862e-01 1 1  ON 30
eH1_1                -1.030655e-01 1 1  ON 31
eH1_2                -6.251865e-02 1 1  ON 32
eH1_3                -2.606884e-02 1 1  ON 33
eH1_4                 1.986409e-02 1 1  ON 34
eH1_5                 3.542774e-02 1 1  ON 35
eH1_6                 7.754494e-02 1 1  ON 36
eH1_7                 1.104613e-01 1 1  ON 37
eH1_8                 9.039866e-02 1 1  ON 38
eH1_9                 2.434328e-02 1 1  ON 39
eH2_0                -1.819831e-01 1 1  ON 40
eH2_1                -1.039625e-01 1 1  ON 41
eH2_2                -6.384601e-02 1 1  ON 42
eH2_3                -2.718010e-02 1 1  ON 43
eH2_4                 1.867090e-02 1 1  ON 44
eH2_5                 3.444872e-02 1 1  ON 45
eH2_6                 7.793557e-02 1 1  ON 46
eH2_7                 1.141282e-01 1 1  ON 47
eH2_8                 9.338187e-02 1 1  ON 48
eH2_9                 2.627167e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2234
    reference variance = 0.567877
====================================================
  Execution time = 3.1692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733081024
                                         uncertainty =       0.003282718004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334733081024
                                         uncertainty =       0.003282718004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409064909
  error estimate for blocks of size 2^( 2) =       0.000419785571
  error estimate for blocks of size 2^( 3) =       0.000429388730
  error estimate for blocks of size 2^( 4) =       0.000436650138
  error estimate for blocks of size 2^( 5) =       0.000440569665
  error estimate for blocks of size 2^( 6) =       0.000443360491
  error estimate for blocks of size 2^( 7) =       0.000442224990

      target function =                  N/A
              le_mean =     -17.211509482380
             les_mean =     296.570726694157
             stat err =       0.000440701321
             autocorr =       1.160657958078
              std dev =       0.578505142105
             le_variance =       0.334668199442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721150948238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211509482380       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211512167420       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211516777911       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211521813640       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211525550324       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211524511888       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211524645110       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211524287893       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211524482311       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211524377487       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.151047e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211509482380       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211510305351       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211511765855       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211513178755       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211514031336       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211513757144       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211513748506       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211513717318       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211513733261       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 8.730054e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211509482380       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211509700444       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211510092160       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211510455325       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211510656286       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211510592841       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211510586224       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211510583981       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.246540e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0437e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.084124e-01 1 1  ON 0
 uu_1                 4.538132e-02 1 1  ON 1
 uu_2                -5.067641e-02 1 1  ON 2
 uu_3                -1.035770e-01 1 1  ON 3
 uu_4                -1.321208e-01 1 1  ON 4
 uu_5                -1.344737e-01 1 1  ON 5
 uu_6                -1.103962e-01 1 1  ON 6
 uu_7                -3.780039e-02 1 1  ON 7
 uu_8                 1.011102e-01 1 1  ON 8
 uu_9                 1.209718e-01 1 1  ON 9
 ud_0                 3.520329e-01 1 1  ON 10
 ud_1                 9.058984e-02 1 1  ON 11
 ud_2                -1.840414e-02 1 1  ON 12
 ud_3                -7.566233e-02 1 1  ON 13
 ud_4                -1.206465e-01 1 1  ON 14
 ud_5                -1.514135e-01 1 1  ON 15
 ud_6                -1.564476e-01 1 1  ON 16
 ud_7                -1.116422e-01 1 1  ON 17
 ud_8                 5.742535e-03 1 1  ON 18
 ud_9                 9.305534e-02 1 1  ON 19
 eO_0                -7.492937e-01 1 1  ON 20
 eO_1                -4.323062e-01 1 1  ON 21
 eO_2                -3.090101e-02 1 1  ON 22
 eO_3                 2.073433e-01 1 1  ON 23
 eO_4                 2.838166e-01 1 1  ON 24
 eO_5                 3.046003e-01 1 1  ON 25
 eO_6                 2.487909e-01 1 1  ON 26
 eO_7                 1.107324e-01 1 1  ON 27
 eO_8                 2.782609e-02 1 1  ON 28
 eO_9                 1.858971e-02 1 1  ON 29
eH1_0                -1.818145e-01 1 1  ON 30
eH1_1                -1.030787e-01 1 1  ON 31
eH1_2                -6.252777e-02 1 1  ON 32
eH1_3                -2.606459e-02 1 1  ON 33
eH1_4                 1.988519e-02 1 1  ON 34
eH1_5                 3.545713e-02 1 1  ON 35
eH1_6                 7.751145e-02 1 1  ON 36
eH1_7                 1.104235e-01 1 1  ON 37
eH1_8                 9.044141e-02 1 1  ON 38
eH1_9                 2.435725e-02 1 1  ON 39
eH2_0                -1.820654e-01 1 1  ON 40
eH2_1                -1.040561e-01 1 1  ON 41
eH2_2                -6.380439e-02 1 1  ON 42
eH2_3                -2.715160e-02 1 1  ON 43
eH2_4                 1.865948e-02 1 1  ON 44
eH2_5                 3.452876e-02 1 1  ON 45
eH2_6                 7.795758e-02 1 1  ON 46
eH2_7                 1.140998e-01 1 1  ON 47
eH2_8                 9.341573e-02 1 1  ON 48
eH2_9                 2.628100e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.155
    reference variance = 0.571029
====================================================
  Execution time = 3.1152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4683e-01
  Total weights = 2.0000e+06
  Execution time = 2.6639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346607210179
                                         uncertainty =       0.007327994172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346607210179
                                         uncertainty =       0.007327994172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416263961
  error estimate for blocks of size 2^( 2) =       0.000426600169
  error estimate for blocks of size 2^( 3) =       0.000436025279
  error estimate for blocks of size 2^( 4) =       0.000442927522
  error estimate for blocks of size 2^( 5) =       0.000447401585
  error estimate for blocks of size 2^( 6) =       0.000449914390
  error estimate for blocks of size 2^( 7) =       0.000452128198

      target function =                  N/A
              le_mean =     -17.211120657722
             les_mean =     296.569225491023
             stat err =       0.000448092924
             autocorr =       1.158773479973
              std dev =       0.588686138483
             le_variance =       0.346551369642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347493306493
                                         uncertainty =       0.007349144097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347493306493
                                         uncertainty =       0.007349144097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416795747
  error estimate for blocks of size 2^( 2) =       0.000427092082
  error estimate for blocks of size 2^( 3) =       0.000436478202
  error estimate for blocks of size 2^( 4) =       0.000443352322
  error estimate for blocks of size 2^( 5) =       0.000447817934
  error estimate for blocks of size 2^( 6) =       0.000450333300
  error estimate for blocks of size 2^( 7) =       0.000452539117

      target function =                  N/A
              le_mean =     -17.211120768354
             les_mean =     296.570115319353
             stat err =       0.000448510668
             autocorr =       1.157974502419
              std dev =       0.589438198799
             le_variance =       0.347437390203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347171656795
                                         uncertainty =       0.007341479175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347171656795
                                         uncertainty =       0.007341479175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416602772
  error estimate for blocks of size 2^( 2) =       0.000426914179
  error estimate for blocks of size 2^( 3) =       0.000436315721
  error estimate for blocks of size 2^( 4) =       0.000443200998
  error estimate for blocks of size 2^( 5) =       0.000447670670
  error estimate for blocks of size 2^( 6) =       0.000450184993
  error estimate for blocks of size 2^( 7) =       0.000452394097

      target function =                  N/A
              le_mean =     -17.211120342860
             les_mean =     296.569779022747
             stat err =       0.000448362690
             autocorr =       1.158282833724
              std dev =       0.589165290808
             le_variance =       0.347115739893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346684204395
                                         uncertainty =       0.007329858034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346684204395
                                         uncertainty =       0.007329858034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416310192
  error estimate for blocks of size 2^( 2) =       0.000426643000
  error estimate for blocks of size 2^( 3) =       0.000436064941
  error estimate for blocks of size 2^( 4) =       0.000442964908
  error estimate for blocks of size 2^( 5) =       0.000447438445
  error estimate for blocks of size 2^( 6) =       0.000449951423
  error estimate for blocks of size 2^( 7) =       0.000452164595

      target function =                  N/A
              le_mean =     -17.211120555561
             les_mean =     296.569298956599
             stat err =       0.000448129843
             autocorr =       1.158707039819
              std dev =       0.588751519630
             le_variance =       0.346628351867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211120657722        initial
     3.9062e-01     3.9062e+00             3.1510e-03       -17.211120768354  <--
     1.5625e+00     1.5625e+01             8.7301e-04       -17.211120342860
     6.2500e+00     6.2500e+01             2.2465e-04       -17.211120555561

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.4533e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.090943e-01 1 1  ON 0
 uu_1                 4.578381e-02 1 1  ON 1
 uu_2                -5.054126e-02 1 1  ON 2
 uu_3                -1.037379e-01 1 1  ON 3
 uu_4                -1.324932e-01 1 1  ON 4
 uu_5                -1.348653e-01 1 1  ON 5
 uu_6                -1.104497e-01 1 1  ON 6
 uu_7                -3.806838e-02 1 1  ON 7
 uu_8                 1.009128e-01 1 1  ON 8
 uu_9                 1.210640e-01 1 1  ON 9
 ud_0                 3.527198e-01 1 1  ON 10
 ud_1                 9.101765e-02 1 1  ON 11
 ud_2                -1.827162e-02 1 1  ON 12
 ud_3                -7.582122e-02 1 1  ON 13
 ud_4                -1.210280e-01 1 1  ON 14
 ud_5                -1.517708e-01 1 1  ON 15
 ud_6                -1.563102e-01 1 1  ON 16
 ud_7                -1.118458e-01 1 1  ON 17
 ud_8                 5.405935e-03 1 1  ON 18
 ud_9                 9.301790e-02 1 1  ON 19
 eO_0                -7.515718e-01 1 1  ON 20
 eO_1                -4.336526e-01 1 1  ON 21
 eO_2                -3.087576e-02 1 1  ON 22
 eO_3                 2.089255e-01 1 1  ON 23
 eO_4                 2.854033e-01 1 1  ON 24
 eO_5                 3.047033e-01 1 1  ON 25
 eO_6                 2.488838e-01 1 1  ON 26
 eO_7                 1.109149e-01 1 1  ON 27
 eO_8                 2.785357e-02 1 1  ON 28
 eO_9                 1.860117e-02 1 1  ON 29
eH1_0                -1.818838e-01 1 1  ON 30
eH1_1                -1.031534e-01 1 1  ON 31
eH1_2                -6.252257e-02 1 1  ON 32
eH1_3                -2.604013e-02 1 1  ON 33
eH1_4                 1.990906e-02 1 1  ON 34
eH1_5                 3.553215e-02 1 1  ON 35
eH1_6                 7.743449e-02 1 1  ON 36
eH1_7                 1.103158e-01 1 1  ON 37
eH1_8                 9.056865e-02 1 1  ON 38
eH1_9                 2.439888e-02 1 1  ON 39
eH2_0                -1.822845e-01 1 1  ON 40
eH2_1                -1.042755e-01 1 1  ON 41
eH2_2                -6.373913e-02 1 1  ON 42
eH2_3                -2.707653e-02 1 1  ON 43
eH2_4                 1.863333e-02 1 1  ON 44
eH2_5                 3.472224e-02 1 1  ON 45
eH2_6                 7.803811e-02 1 1  ON 46
eH2_7                 1.140203e-01 1 1  ON 47
eH2_8                 9.351657e-02 1 1  ON 48
eH2_9                 2.630877e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1906
    reference variance = 0.298147
====================================================
  Execution time = 3.1509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3694e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336957101892
                                         uncertainty =       0.003078682883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336957101892
                                         uncertainty =       0.003078682883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410449927
  error estimate for blocks of size 2^( 2) =       0.000421342757
  error estimate for blocks of size 2^( 3) =       0.000431457647
  error estimate for blocks of size 2^( 4) =       0.000438987696
  error estimate for blocks of size 2^( 5) =       0.000443006049
  error estimate for blocks of size 2^( 6) =       0.000444929596
  error estimate for blocks of size 2^( 7) =       0.000446449860

      target function =                  N/A
              le_mean =     -17.211236172797
             les_mean =     296.563588713228
             stat err =       0.000443343300
             autocorr =       1.166701975053
              std dev =       0.580463854096
             le_variance =       0.336938285912


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721123617280e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211236172797       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211235940245       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211244081108       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211255491140       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211261631246       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211269680722       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211268373488       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211268917972       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211267892016       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211268734077       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211269044913       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211269077953       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211269429910       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 9.117084e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211236172797       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211236068485       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211239780343       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211244331326       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211245967678       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211247786671       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211247099204       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211247194025       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211246987450       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211247147435       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.899724e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211236172797       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211236140258       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211237315021       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211238617582       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211239058613       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211239390068       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211239202732       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211239244824       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211239217262       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 7.943640e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201714 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0418e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.100257e-01 1 1  ON 0
 uu_1                 4.624223e-02 1 1  ON 1
 uu_2                -5.037102e-02 1 1  ON 2
 uu_3                -1.039448e-01 1 1  ON 3
 uu_4                -1.330465e-01 1 1  ON 4
 uu_5                -1.355088e-01 1 1  ON 5
 uu_6                -1.106551e-01 1 1  ON 6
 uu_7                -3.821599e-02 1 1  ON 7
 uu_8                 1.007505e-01 1 1  ON 8
 uu_9                 1.212082e-01 1 1  ON 9
 ud_0                 3.534188e-01 1 1  ON 10
 ud_1                 9.147755e-02 1 1  ON 11
 ud_2                -1.821098e-02 1 1  ON 12
 ud_3                -7.613645e-02 1 1  ON 13
 ud_4                -1.216476e-01 1 1  ON 14
 ud_5                -1.520783e-01 1 1  ON 15
 ud_6                -1.561253e-01 1 1  ON 16
 ud_7                -1.119319e-01 1 1  ON 17
 ud_8                 5.060619e-03 1 1  ON 18
 ud_9                 9.306422e-02 1 1  ON 19
 eO_0                -7.544715e-01 1 1  ON 20
 eO_1                -4.354397e-01 1 1  ON 21
 eO_2                -3.089869e-02 1 1  ON 22
 eO_3                 2.107869e-01 1 1  ON 23
 eO_4                 2.875038e-01 1 1  ON 24
 eO_5                 3.048796e-01 1 1  ON 25
 eO_6                 2.490364e-01 1 1  ON 26
 eO_7                 1.112272e-01 1 1  ON 27
 eO_8                 2.790544e-02 1 1  ON 28
 eO_9                 1.862159e-02 1 1  ON 29
eH1_0                -1.820011e-01 1 1  ON 30
eH1_1                -1.033890e-01 1 1  ON 31
eH1_2                -6.259690e-02 1 1  ON 32
eH1_3                -2.614801e-02 1 1  ON 33
eH1_4                 1.982344e-02 1 1  ON 34
eH1_5                 3.577241e-02 1 1  ON 35
eH1_6                 7.751883e-02 1 1  ON 36
eH1_7                 1.103173e-01 1 1  ON 37
eH1_8                 9.076473e-02 1 1  ON 38
eH1_9                 2.446845e-02 1 1  ON 39
eH2_0                -1.825723e-01 1 1  ON 40
eH2_1                -1.045462e-01 1 1  ON 41
eH2_2                -6.376861e-02 1 1  ON 42
eH2_3                -2.695178e-02 1 1  ON 43
eH2_4                 1.870564e-02 1 1  ON 44
eH2_5                 3.494541e-02 1 1  ON 45
eH2_6                 7.807547e-02 1 1  ON 46
eH2_7                 1.139353e-01 1 1  ON 47
eH2_8                 9.364666e-02 1 1  ON 48
eH2_9                 2.635815e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2582
    reference variance = 0.274441
====================================================
  Execution time = 3.0845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4419e-01
  Total weights = 2.0000e+06
  Execution time = 2.6625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343484443489
                                         uncertainty =       0.010201950380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343484443489
                                         uncertainty =       0.010201950380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414393721
  error estimate for blocks of size 2^( 2) =       0.000424965001
  error estimate for blocks of size 2^( 3) =       0.000434235561
  error estimate for blocks of size 2^( 4) =       0.000440794611
  error estimate for blocks of size 2^( 5) =       0.000444479732
  error estimate for blocks of size 2^( 6) =       0.000447805605
  error estimate for blocks of size 2^( 7) =       0.000447197026

      target function =                  N/A
              le_mean =     -17.211119595731
             les_mean =     296.566081878162
             stat err =       0.000445069243
             autocorr =       1.153529844251
              std dev =       0.586041219811
             le_variance =       0.343444311318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345424769091
                                         uncertainty =       0.010365462484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345424769091
                                         uncertainty =       0.010365462484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415562087
  error estimate for blocks of size 2^( 2) =       0.000426056769
  error estimate for blocks of size 2^( 3) =       0.000435241193
  error estimate for blocks of size 2^( 4) =       0.000441720034
  error estimate for blocks of size 2^( 5) =       0.000445367954
  error estimate for blocks of size 2^( 6) =       0.000448679749
  error estimate for blocks of size 2^( 7) =       0.000448040397

      target function =                  N/A
              le_mean =     -17.211120038856
             les_mean =     296.568036514743
             stat err =       0.000445952034
             autocorr =       1.151607437361
              std dev =       0.587693538780
             le_variance =       0.345383695524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344997343732
                                         uncertainty =       0.010325798734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344997343732
                                         uncertainty =       0.010325798734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415304999
  error estimate for blocks of size 2^( 2) =       0.000425820193
  error estimate for blocks of size 2^( 3) =       0.000435027406
  error estimate for blocks of size 2^( 4) =       0.000441527346
  error estimate for blocks of size 2^( 5) =       0.000445185841
  error estimate for blocks of size 2^( 6) =       0.000448501862
  error estimate for blocks of size 2^( 7) =       0.000447870358

      target function =                  N/A
              le_mean =     -17.211116489426
             les_mean =     296.567487124876
             stat err =       0.000445771352
             autocorr =       1.152099506747
              std dev =       0.587329962420
             le_variance =       0.344956484756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343709606804
                                         uncertainty =       0.010219961196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343709606804
                                         uncertainty =       0.010219961196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414529471
  error estimate for blocks of size 2^( 2) =       0.000425092129
  error estimate for blocks of size 2^( 3) =       0.000434353111
  error estimate for blocks of size 2^( 4) =       0.000440903334
  error estimate for blocks of size 2^( 5) =       0.000444584586
  error estimate for blocks of size 2^( 6) =       0.000447908979
  error estimate for blocks of size 2^( 7) =       0.000447297111

      target function =                  N/A
              le_mean =     -17.211118333664
             les_mean =     296.566263488411
             stat err =       0.000445173503
             autocorr =       1.153314595977
              std dev =       0.586233200061
             le_variance =       0.343669364853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211119595731        initial
     9.7656e-02     9.7656e-01             9.1171e-03       -17.211120038856  <--
     3.9062e-01     3.9062e+00             2.8997e-03       -17.211116489426
     1.5625e+00     1.5625e+01             7.9436e-04       -17.211118333664

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.4228e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.117203e-01 1 1  ON 0
 uu_1                 4.736296e-02 1 1  ON 1
 uu_2                -4.983530e-02 1 1  ON 2
 uu_3                -1.041604e-01 1 1  ON 3
 uu_4                -1.340775e-01 1 1  ON 4
 uu_5                -1.369490e-01 1 1  ON 5
 uu_6                -1.114281e-01 1 1  ON 6
 uu_7                -3.870932e-02 1 1  ON 7
 uu_8                 1.002648e-01 1 1  ON 8
 uu_9                 1.216457e-01 1 1  ON 9
 ud_0                 3.547178e-01 1 1  ON 10
 ud_1                 9.241963e-02 1 1  ON 11
 ud_2                -1.785819e-02 1 1  ON 12
 ud_3                -7.650569e-02 1 1  ON 13
 ud_4                -1.226600e-01 1 1  ON 14
 ud_5                -1.529798e-01 1 1  ON 15
 ud_6                -1.560456e-01 1 1  ON 16
 ud_7                -1.121450e-01 1 1  ON 17
 ud_8                 4.066861e-03 1 1  ON 18
 ud_9                 9.320593e-02 1 1  ON 19
 eO_0                -7.606888e-01 1 1  ON 20
 eO_1                -4.396952e-01 1 1  ON 21
 eO_2                -3.189202e-02 1 1  ON 22
 eO_3                 2.138403e-01 1 1  ON 23
 eO_4                 2.929515e-01 1 1  ON 24
 eO_5                 3.060235e-01 1 1  ON 25
 eO_6                 2.495905e-01 1 1  ON 26
 eO_7                 1.121695e-01 1 1  ON 27
 eO_8                 2.806394e-02 1 1  ON 28
 eO_9                 1.868381e-02 1 1  ON 29
eH1_0                -1.823963e-01 1 1  ON 30
eH1_1                -1.039607e-01 1 1  ON 31
eH1_2                -6.281889e-02 1 1  ON 32
eH1_3                -2.628942e-02 1 1  ON 33
eH1_4                 1.964297e-02 1 1  ON 34
eH1_5                 3.594073e-02 1 1  ON 35
eH1_6                 7.788406e-02 1 1  ON 36
eH1_7                 1.103991e-01 1 1  ON 37
eH1_8                 9.136130e-02 1 1  ON 38
eH1_9                 2.467940e-02 1 1  ON 39
eH2_0                -1.832151e-01 1 1  ON 40
eH2_1                -1.050875e-01 1 1  ON 41
eH2_2                -6.380697e-02 1 1  ON 42
eH2_3                -2.679531e-02 1 1  ON 43
eH2_4                 1.887582e-02 1 1  ON 44
eH2_5                 3.514445e-02 1 1  ON 45
eH2_6                 7.830167e-02 1 1  ON 46
eH2_7                 1.137514e-01 1 1  ON 47
eH2_8                 9.404268e-02 1 1  ON 48
eH2_9                 2.650784e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3255
    reference variance = 0.327005
====================================================
  Execution time = 3.1694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335761426914
                                         uncertainty =       0.002689641970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335761426914
                                         uncertainty =       0.002689641970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409732300
  error estimate for blocks of size 2^( 2) =       0.000420372969
  error estimate for blocks of size 2^( 3) =       0.000430070941
  error estimate for blocks of size 2^( 4) =       0.000437312965
  error estimate for blocks of size 2^( 5) =       0.000440890580
  error estimate for blocks of size 2^( 6) =       0.000443663668
  error estimate for blocks of size 2^( 7) =       0.000442838109

      target function =                  N/A
              le_mean =     -17.211274649138
             les_mean =     296.563735995566
             stat err =       0.000441176331
             autocorr =       1.159375196717
              std dev =       0.579448975658
             le_variance =       0.335761115391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721127464914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211274649138       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211282792910       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211300258762       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211310862340       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211320479230       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211319584157       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211319607333       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211323343556       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211326460293       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211323525702       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211324101100       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211324586217       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211327018421       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211325541267       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211325358441       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211327833066       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211327472384       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211328182663       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.738597e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211274649138       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211280972217       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211290993156       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211296716779       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211301231880       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211297867213       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211297265584       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211298430225       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211298950892       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211298279389       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211298155191       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211298018469       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211298320193       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 6.287807e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211274649138       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211277987131       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211281895201       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211283585577       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211284997973       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211283144273       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211282873727       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211283032403       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211283089160       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211283088367       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.934398e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4129e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.131759e-01 1 1  ON 0
 uu_1                 4.829508e-02 1 1  ON 1
 uu_2                -4.943968e-02 1 1  ON 2
 uu_3                -1.042460e-01 1 1  ON 3
 uu_4                -1.346540e-01 1 1  ON 4
 uu_5                -1.376212e-01 1 1  ON 5
 uu_6                -1.122555e-01 1 1  ON 6
 uu_7                -3.985781e-02 1 1  ON 7
 uu_8                 9.951833e-02 1 1  ON 8
 uu_9                 1.221276e-01 1 1  ON 9
 ud_0                 3.563837e-01 1 1  ON 10
 ud_1                 9.382530e-02 1 1  ON 11
 ud_2                -1.714772e-02 1 1  ON 12
 ud_3                -7.650025e-02 1 1  ON 13
 ud_4                -1.233379e-01 1 1  ON 14
 ud_5                -1.545293e-01 1 1  ON 15
 ud_6                -1.567418e-01 1 1  ON 16
 ud_7                -1.123166e-01 1 1  ON 17
 ud_8                 2.703234e-03 1 1  ON 18
 ud_9                 9.319919e-02 1 1  ON 19
 eO_0                -7.669767e-01 1 1  ON 20
 eO_1                -4.443536e-01 1 1  ON 21
 eO_2                -3.370986e-02 1 1  ON 22
 eO_3                 2.160085e-01 1 1  ON 23
 eO_4                 2.988908e-01 1 1  ON 24
 eO_5                 3.083173e-01 1 1  ON 25
 eO_6                 2.504754e-01 1 1  ON 26
 eO_7                 1.133683e-01 1 1  ON 27
 eO_8                 2.819470e-02 1 1  ON 28
 eO_9                 1.874021e-02 1 1  ON 29
eH1_0                -1.829543e-01 1 1  ON 30
eH1_1                -1.043361e-01 1 1  ON 31
eH1_2                -6.283683e-02 1 1  ON 32
eH1_3                -2.593384e-02 1 1  ON 33
eH1_4                 1.955558e-02 1 1  ON 34
eH1_5                 3.627136e-02 1 1  ON 35
eH1_6                 7.791499e-02 1 1  ON 36
eH1_7                 1.099384e-01 1 1  ON 37
eH1_8                 9.183501e-02 1 1  ON 38
eH1_9                 2.489812e-02 1 1  ON 39
eH2_0                -1.841078e-01 1 1  ON 40
eH2_1                -1.056310e-01 1 1  ON 41
eH2_2                -6.388524e-02 1 1  ON 42
eH2_3                -2.639541e-02 1 1  ON 43
eH2_4                 1.938077e-02 1 1  ON 44
eH2_5                 3.493394e-02 1 1  ON 45
eH2_6                 7.808188e-02 1 1  ON 46
eH2_7                 1.138004e-01 1 1  ON 47
eH2_8                 9.483273e-02 1 1  ON 48
eH2_9                 2.668683e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1851
    reference variance = 0.350405
====================================================
  Execution time = 3.1662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4467e-01
  Total weights = 2.0000e+06
  Execution time = 2.6586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343629019908
                                         uncertainty =       0.004388130658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343629019908
                                         uncertainty =       0.004388130658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414508411
  error estimate for blocks of size 2^( 2) =       0.000424847820
  error estimate for blocks of size 2^( 3) =       0.000434439427
  error estimate for blocks of size 2^( 4) =       0.000441647041
  error estimate for blocks of size 2^( 5) =       0.000444679694
  error estimate for blocks of size 2^( 6) =       0.000447486469
  error estimate for blocks of size 2^( 7) =       0.000448729463

      target function =                  N/A
              le_mean =     -17.212223032131
             les_mean =     296.604255980933
             stat err =       0.000445635667
             autocorr =       1.155827946160
              std dev =       0.586203416009
             le_variance =       0.343634444941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345904701727
                                         uncertainty =       0.004422706713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345904701727
                                         uncertainty =       0.004422706713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415878705
  error estimate for blocks of size 2^( 2) =       0.000426135097
  error estimate for blocks of size 2^( 3) =       0.000435616465
  error estimate for blocks of size 2^( 4) =       0.000442749788
  error estimate for blocks of size 2^( 5) =       0.000445737696
  error estimate for blocks of size 2^( 6) =       0.000448583772
  error estimate for blocks of size 2^( 7) =       0.000449832061

      target function =                  N/A
              le_mean =     -17.212222645015
             les_mean =     296.606518403323
             stat err =       0.000446725829
             autocorr =       1.153848424733
              std dev =       0.588141305053
             le_variance =       0.345910194710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345747965841
                                         uncertainty =       0.004416460400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345747965841
                                         uncertainty =       0.004416460400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415784623
  error estimate for blocks of size 2^( 2) =       0.000426048507
  error estimate for blocks of size 2^( 3) =       0.000435541968
  error estimate for blocks of size 2^( 4) =       0.000442688869
  error estimate for blocks of size 2^( 5) =       0.000445684302
  error estimate for blocks of size 2^( 6) =       0.000448529840
  error estimate for blocks of size 2^( 7) =       0.000449785308

      target function =                  N/A
              le_mean =     -17.212220168836
             les_mean =     296.606276672712
             stat err =       0.000446672080
             autocorr =       1.154092891477
              std dev =       0.588008252592
             le_variance =       0.345753705117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344013504711
                                         uncertainty =       0.004392754129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344013504711
                                         uncertainty =       0.004392754129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414740316
  error estimate for blocks of size 2^( 2) =       0.000425063816
  error estimate for blocks of size 2^( 3) =       0.000434636621
  error estimate for blocks of size 2^( 4) =       0.000441833751
  error estimate for blocks of size 2^( 5) =       0.000444859787
  error estimate for blocks of size 2^( 6) =       0.000447673594
  error estimate for blocks of size 2^( 7) =       0.000448919803

      target function =                  N/A
              le_mean =     -17.212219762917
             les_mean =     296.604528054271
             stat err =       0.000445821734
             autocorr =       1.155500038808
              std dev =       0.586531379654
             le_variance =       0.344019059319


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212223032131        initial  <--
     2.4414e-02     2.4414e-01             1.7386e-02       -17.212222645015
     9.7656e-02     9.7656e-01             6.2878e-03       -17.212220168836
     3.9062e-01     3.9062e+00             1.9344e-03       -17.212219762917

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9803
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.117203e-01 1 1  ON 0
 uu_1                 4.736296e-02 1 1  ON 1
 uu_2                -4.983530e-02 1 1  ON 2
 uu_3                -1.041604e-01 1 1  ON 3
 uu_4                -1.340775e-01 1 1  ON 4
 uu_5                -1.369490e-01 1 1  ON 5
 uu_6                -1.114281e-01 1 1  ON 6
 uu_7                -3.870932e-02 1 1  ON 7
 uu_8                 1.002648e-01 1 1  ON 8
 uu_9                 1.216457e-01 1 1  ON 9
 ud_0                 3.547178e-01 1 1  ON 10
 ud_1                 9.241963e-02 1 1  ON 11
 ud_2                -1.785819e-02 1 1  ON 12
 ud_3                -7.650569e-02 1 1  ON 13
 ud_4                -1.226600e-01 1 1  ON 14
 ud_5                -1.529798e-01 1 1  ON 15
 ud_6                -1.560456e-01 1 1  ON 16
 ud_7                -1.121450e-01 1 1  ON 17
 ud_8                 4.066861e-03 1 1  ON 18
 ud_9                 9.320593e-02 1 1  ON 19
 eO_0                -7.606888e-01 1 1  ON 20
 eO_1                -4.396952e-01 1 1  ON 21
 eO_2                -3.189202e-02 1 1  ON 22
 eO_3                 2.138403e-01 1 1  ON 23
 eO_4                 2.929515e-01 1 1  ON 24
 eO_5                 3.060235e-01 1 1  ON 25
 eO_6                 2.495905e-01 1 1  ON 26
 eO_7                 1.121695e-01 1 1  ON 27
 eO_8                 2.806394e-02 1 1  ON 28
 eO_9                 1.868381e-02 1 1  ON 29
eH1_0                -1.823963e-01 1 1  ON 30
eH1_1                -1.039607e-01 1 1  ON 31
eH1_2                -6.281889e-02 1 1  ON 32
eH1_3                -2.628942e-02 1 1  ON 33
eH1_4                 1.964297e-02 1 1  ON 34
eH1_5                 3.594073e-02 1 1  ON 35
eH1_6                 7.788406e-02 1 1  ON 36
eH1_7                 1.103991e-01 1 1  ON 37
eH1_8                 9.136130e-02 1 1  ON 38
eH1_9                 2.467940e-02 1 1  ON 39
eH2_0                -1.832151e-01 1 1  ON 40
eH2_1                -1.050875e-01 1 1  ON 41
eH2_2                -6.380697e-02 1 1  ON 42
eH2_3                -2.679531e-02 1 1  ON 43
eH2_4                 1.887582e-02 1 1  ON 44
eH2_5                 3.514445e-02 1 1  ON 45
eH2_6                 7.830167e-02 1 1  ON 46
eH2_7                 1.137514e-01 1 1  ON 47
eH2_8                 9.404268e-02 1 1  ON 48
eH2_9                 2.650784e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2105
    reference variance = 0.161857
====================================================
  Execution time = 3.1493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339055497969
                                         uncertainty =       0.003258611339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339055497969
                                         uncertainty =       0.003258611339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411690147
  error estimate for blocks of size 2^( 2) =       0.000422199233
  error estimate for blocks of size 2^( 3) =       0.000431716371
  error estimate for blocks of size 2^( 4) =       0.000438376326
  error estimate for blocks of size 2^( 5) =       0.000442477373
  error estimate for blocks of size 2^( 6) =       0.000444904505
  error estimate for blocks of size 2^( 7) =       0.000447068257

      target function =                  N/A
              le_mean =     -17.211842828229
             les_mean =     296.586510927673
             stat err =       0.000443206615
             autocorr =       1.158968207570
              std dev =       0.582217788727
             le_variance =       0.338977553510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721184282823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211842828229       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211844016443       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211846378603       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211849582712       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211855954298       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211855024800       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211854043679       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211854332160       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211854428491       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211854530665       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211854195791       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 3.076339e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211842828229       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211843257430       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211844165907       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211845225156       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211846948362       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211846493468       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211846360956       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211846318500       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211846363690       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 8.629212e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211842828229       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211842948956       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211843214853       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211843502971       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211843945498       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211843811824       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211843789527       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211843778013       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 2.229141e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0392e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.119529e-01 1 1  ON 0
 uu_1                 4.747670e-02 1 1  ON 1
 uu_2                -4.983115e-02 1 1  ON 2
 uu_3                -1.042499e-01 1 1  ON 3
 uu_4                -1.342816e-01 1 1  ON 4
 uu_5                -1.370514e-01 1 1  ON 5
 uu_6                -1.114262e-01 1 1  ON 6
 uu_7                -3.879307e-02 1 1  ON 7
 uu_8                 1.002151e-01 1 1  ON 8
 uu_9                 1.217300e-01 1 1  ON 9
 ud_0                 3.548883e-01 1 1  ON 10
 ud_1                 9.251309e-02 1 1  ON 11
 ud_2                -1.778731e-02 1 1  ON 12
 ud_3                -7.658513e-02 1 1  ON 13
 ud_4                -1.227747e-01 1 1  ON 14
 ud_5                -1.531915e-01 1 1  ON 15
 ud_6                -1.560316e-01 1 1  ON 16
 ud_7                -1.120885e-01 1 1  ON 17
 ud_8                 3.974252e-03 1 1  ON 18
 ud_9                 9.322146e-02 1 1  ON 19
 eO_0                -7.615518e-01 1 1  ON 20
 eO_1                -4.402479e-01 1 1  ON 21
 eO_2                -3.203790e-02 1 1  ON 22
 eO_3                 2.141867e-01 1 1  ON 23
 eO_4                 2.936616e-01 1 1  ON 24
 eO_5                 3.062422e-01 1 1  ON 25
 eO_6                 2.497031e-01 1 1  ON 26
 eO_7                 1.122972e-01 1 1  ON 27
 eO_8                 2.808488e-02 1 1  ON 28
 eO_9                 1.869825e-02 1 1  ON 29
eH1_0                -1.824524e-01 1 1  ON 30
eH1_1                -1.041121e-01 1 1  ON 31
eH1_2                -6.284351e-02 1 1  ON 32
eH1_3                -2.613040e-02 1 1  ON 33
eH1_4                 1.965035e-02 1 1  ON 34
eH1_5                 3.588033e-02 1 1  ON 35
eH1_6                 7.791229e-02 1 1  ON 36
eH1_7                 1.104028e-01 1 1  ON 37
eH1_8                 9.142845e-02 1 1  ON 38
eH1_9                 2.469920e-02 1 1  ON 39
eH2_0                -1.833646e-01 1 1  ON 40
eH2_1                -1.051123e-01 1 1  ON 41
eH2_2                -6.376268e-02 1 1  ON 42
eH2_3                -2.677540e-02 1 1  ON 43
eH2_4                 1.890883e-02 1 1  ON 44
eH2_5                 3.511410e-02 1 1  ON 45
eH2_6                 7.830844e-02 1 1  ON 46
eH2_7                 1.137281e-01 1 1  ON 47
eH2_8                 9.411956e-02 1 1  ON 48
eH2_9                 2.653703e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1737
    reference variance = 0.368682
====================================================
  Execution time = 3.1303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3639e-01
  Total weights = 2.0000e+06
  Execution time = 2.6468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336305275371
                                         uncertainty =       0.002792498332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336305275371
                                         uncertainty =       0.002792498332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410018513
  error estimate for blocks of size 2^( 2) =       0.000420475971
  error estimate for blocks of size 2^( 3) =       0.000430085526
  error estimate for blocks of size 2^( 4) =       0.000436916780
  error estimate for blocks of size 2^( 5) =       0.000441073105
  error estimate for blocks of size 2^( 6) =       0.000442129103
  error estimate for blocks of size 2^( 7) =       0.000441366642

      target function =                  N/A
              le_mean =     -17.211540347390
             les_mean =     296.573351324293
             stat err =       0.000440371408
             autocorr =       1.153536373607
              std dev =       0.579853742406
             le_variance =       0.336230362582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807164947
                                         uncertainty =       0.002796044405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807164947
                                         uncertainty =       0.002796044405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410324499
  error estimate for blocks of size 2^( 2) =       0.000420764843
  error estimate for blocks of size 2^( 3) =       0.000430352757
  error estimate for blocks of size 2^( 4) =       0.000437166274
  error estimate for blocks of size 2^( 5) =       0.000441319497
  error estimate for blocks of size 2^( 6) =       0.000442380150
  error estimate for blocks of size 2^( 7) =       0.000441615860

      target function =                  N/A
              le_mean =     -17.211543132934
             les_mean =     296.573949237109
             stat err =       0.000440620445
             autocorr =       1.153119707756
              std dev =       0.580286471160
             le_variance =       0.336732388612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336627427953
                                         uncertainty =       0.002794657689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336627427953
                                         uncertainty =       0.002794657689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410214954
  error estimate for blocks of size 2^( 2) =       0.000420662164
  error estimate for blocks of size 2^( 3) =       0.000430259129
  error estimate for blocks of size 2^( 4) =       0.000437080395
  error estimate for blocks of size 2^( 5) =       0.000441236060
  error estimate for blocks of size 2^( 6) =       0.000442294961
  error estimate for blocks of size 2^( 7) =       0.000441532825

      target function =                  N/A
              le_mean =     -17.211541314084
             les_mean =     296.573706854951
             stat err =       0.000440536060
             autocorr =       1.153293783611
              std dev =       0.580131551293
             le_variance =       0.336552616806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336348437318
                                         uncertainty =       0.002792781167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336348437318
                                         uncertainty =       0.002792781167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410044838
  error estimate for blocks of size 2^( 2) =       0.000420500944
  error estimate for blocks of size 2^( 3) =       0.000430108865
  error estimate for blocks of size 2^( 4) =       0.000436938850
  error estimate for blocks of size 2^( 5) =       0.000441095117
  error estimate for blocks of size 2^( 6) =       0.000442151533
  error estimate for blocks of size 2^( 7) =       0.000441389194

      target function =                  N/A
              le_mean =     -17.211540389500
             les_mean =     296.573395949507
             stat err =       0.000440393674
             autocorr =       1.153504905089
              std dev =       0.579890971009
             le_variance =       0.336273538257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211540347390        initial
     2.4414e-01     2.4414e+00             3.0763e-03       -17.211543132934  <--
     9.7656e-01     9.7656e+00             8.6292e-04       -17.211541314084
     3.9062e+00     3.9062e+01             2.2291e-04       -17.211540389500

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.4597e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.124980e-01 1 1  ON 0
 uu_1                 4.777063e-02 1 1  ON 1
 uu_2                -4.975636e-02 1 1  ON 2
 uu_3                -1.044253e-01 1 1  ON 3
 uu_4                -1.347312e-01 1 1  ON 4
 uu_5                -1.374303e-01 1 1  ON 5
 uu_6                -1.114738e-01 1 1  ON 6
 uu_7                -3.903574e-02 1 1  ON 7
 uu_8                 1.000699e-01 1 1  ON 8
 uu_9                 1.219804e-01 1 1  ON 9
 ud_0                 3.552897e-01 1 1  ON 10
 ud_1                 9.280510e-02 1 1  ON 11
 ud_2                -1.763300e-02 1 1  ON 12
 ud_3                -7.670470e-02 1 1  ON 13
 ud_4                -1.230890e-01 1 1  ON 14
 ud_5                -1.536985e-01 1 1  ON 15
 ud_6                -1.560892e-01 1 1  ON 16
 ud_7                -1.119452e-01 1 1  ON 17
 ud_8                 3.704364e-03 1 1  ON 18
 ud_9                 9.326817e-02 1 1  ON 19
 eO_0                -7.637652e-01 1 1  ON 20
 eO_1                -4.418255e-01 1 1  ON 21
 eO_2                -3.256753e-02 1 1  ON 22
 eO_3                 2.149514e-01 1 1  ON 23
 eO_4                 2.956506e-01 1 1  ON 24
 eO_5                 3.069494e-01 1 1  ON 25
 eO_6                 2.500468e-01 1 1  ON 26
 eO_7                 1.126765e-01 1 1  ON 27
 eO_8                 2.814740e-02 1 1  ON 28
 eO_9                 1.874118e-02 1 1  ON 29
eH1_0                -1.826301e-01 1 1  ON 30
eH1_1                -1.043985e-01 1 1  ON 31
eH1_2                -6.286062e-02 1 1  ON 32
eH1_3                -2.587407e-02 1 1  ON 33
eH1_4                 1.970649e-02 1 1  ON 34
eH1_5                 3.567398e-02 1 1  ON 35
eH1_6                 7.799190e-02 1 1  ON 36
eH1_7                 1.104183e-01 1 1  ON 37
eH1_8                 9.162838e-02 1 1  ON 38
eH1_9                 2.475811e-02 1 1  ON 39
eH2_0                -1.836867e-01 1 1  ON 40
eH2_1                -1.051945e-01 1 1  ON 41
eH2_2                -6.369023e-02 1 1  ON 42
eH2_3                -2.672410e-02 1 1  ON 43
eH2_4                 1.896589e-02 1 1  ON 44
eH2_5                 3.500102e-02 1 1  ON 45
eH2_6                 7.833770e-02 1 1  ON 46
eH2_7                 1.136667e-01 1 1  ON 47
eH2_8                 9.434854e-02 1 1  ON 48
eH2_9                 2.662382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.17989
====================================================
  Execution time = 3.1771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5221e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352268440207
                                         uncertainty =       0.009811576758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352268440207
                                         uncertainty =       0.009811576758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419646619
  error estimate for blocks of size 2^( 2) =       0.000430219519
  error estimate for blocks of size 2^( 3) =       0.000439134866
  error estimate for blocks of size 2^( 4) =       0.000446920920
  error estimate for blocks of size 2^( 5) =       0.000451299708
  error estimate for blocks of size 2^( 6) =       0.000454811400
  error estimate for blocks of size 2^( 7) =       0.000455622489

      target function =                  N/A
              le_mean =     -17.211155095412
             les_mean =     296.576066112277
             stat err =       0.000452163629
             autocorr =       1.160977475841
              std dev =       0.593469940319
             le_variance =       0.352206570063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721115509541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211155095412       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211161193205       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211171794274       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211180185711       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211185066890       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211187219282       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211190465290       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211190438834       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211192898666       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211193266294       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211192104547       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211191951367       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211192349545       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211192257556       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211191926880       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 8.832115e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211155095412       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211158712638       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211163650618       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211165496935       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211167856534       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211168217580       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211168937156       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211168715425       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211169068092       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211168980426       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211168886070       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 2.864979e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211155095412       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211156472253       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211158041039       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211158503914       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211159148204       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211159226270       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211159347937       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211159290169       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211159298992       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 8.118516e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0622e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.129319e-01 1 1  ON 0
 uu_1                 4.832552e-02 1 1  ON 1
 uu_2                -4.951713e-02 1 1  ON 2
 uu_3                -1.044088e-01 1 1  ON 3
 uu_4                -1.348076e-01 1 1  ON 4
 uu_5                -1.378458e-01 1 1  ON 5
 uu_6                -1.121770e-01 1 1  ON 6
 uu_7                -3.939373e-02 1 1  ON 7
 uu_8                 9.980951e-02 1 1  ON 8
 uu_9                 1.222085e-01 1 1  ON 9
 ud_0                 3.559709e-01 1 1  ON 10
 ud_1                 9.341121e-02 1 1  ON 11
 ud_2                -1.739905e-02 1 1  ON 12
 ud_3                -7.670737e-02 1 1  ON 13
 ud_4                -1.233047e-01 1 1  ON 14
 ud_5                -1.545562e-01 1 1  ON 15
 ud_6                -1.563097e-01 1 1  ON 16
 ud_7                -1.120530e-01 1 1  ON 17
 ud_8                 3.270554e-03 1 1  ON 18
 ud_9                 9.331450e-02 1 1  ON 19
 eO_0                -7.666302e-01 1 1  ON 20
 eO_1                -4.438292e-01 1 1  ON 21
 eO_2                -3.309322e-02 1 1  ON 22
 eO_3                 2.160798e-01 1 1  ON 23
 eO_4                 2.981739e-01 1 1  ON 24
 eO_5                 3.078077e-01 1 1  ON 25
 eO_6                 2.503262e-01 1 1  ON 26
 eO_7                 1.131418e-01 1 1  ON 27
 eO_8                 2.821769e-02 1 1  ON 28
 eO_9                 1.876832e-02 1 1  ON 29
eH1_0                -1.831274e-01 1 1  ON 30
eH1_1                -1.045491e-01 1 1  ON 31
eH1_2                -6.297803e-02 1 1  ON 32
eH1_3                -2.597186e-02 1 1  ON 33
eH1_4                 1.970002e-02 1 1  ON 34
eH1_5                 3.582432e-02 1 1  ON 35
eH1_6                 7.811990e-02 1 1  ON 36
eH1_7                 1.104841e-01 1 1  ON 37
eH1_8                 9.198440e-02 1 1  ON 38
eH1_9                 2.488841e-02 1 1  ON 39
eH2_0                -1.837608e-01 1 1  ON 40
eH2_1                -1.054255e-01 1 1  ON 41
eH2_2                -6.373061e-02 1 1  ON 42
eH2_3                -2.658881e-02 1 1  ON 43
eH2_4                 1.862783e-02 1 1  ON 44
eH2_5                 3.499684e-02 1 1  ON 45
eH2_6                 7.867035e-02 1 1  ON 46
eH2_7                 1.135441e-01 1 1  ON 47
eH2_8                 9.456807e-02 1 1  ON 48
eH2_9                 2.671403e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.144
    reference variance = 0.427771
====================================================
  Execution time = 3.1203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4283e-01
  Total weights = 2.0000e+06
  Execution time = 2.6748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342380050112
                                         uncertainty =       0.004648642607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342380050112
                                         uncertainty =       0.004648642607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413766430
  error estimate for blocks of size 2^( 2) =       0.000424317446
  error estimate for blocks of size 2^( 3) =       0.000434062781
  error estimate for blocks of size 2^( 4) =       0.000441552417
  error estimate for blocks of size 2^( 5) =       0.000446281186
  error estimate for blocks of size 2^( 6) =       0.000449010239
  error estimate for blocks of size 2^( 7) =       0.000450678906

      target function =                  N/A
              le_mean =     -17.210933683550
             les_mean =     296.558643405476
             stat err =       0.000446880687
             autocorr =       1.166467564939
              std dev =       0.585154096904
             le_variance =       0.342405317124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343525545012
                                         uncertainty =       0.004656180396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343525545012
                                         uncertainty =       0.004656180396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414458337
  error estimate for blocks of size 2^( 2) =       0.000424959645
  error estimate for blocks of size 2^( 3) =       0.000434644543
  error estimate for blocks of size 2^( 4) =       0.000442073511
  error estimate for blocks of size 2^( 5) =       0.000446780476
  error estimate for blocks of size 2^( 6) =       0.000449493440
  error estimate for blocks of size 2^( 7) =       0.000451164254

      target function =                  N/A
              le_mean =     -17.210934548610
             les_mean =     296.559819291061
             stat err =       0.000447377920
             autocorr =       1.165164736605
              std dev =       0.586132601288
             le_variance =       0.343551426293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343239506369
                                         uncertainty =       0.004657256909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343239506369
                                         uncertainty =       0.004657256909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414285695
  error estimate for blocks of size 2^( 2) =       0.000424798215
  error estimate for blocks of size 2^( 3) =       0.000434499245
  error estimate for blocks of size 2^( 4) =       0.000441946264
  error estimate for blocks of size 2^( 5) =       0.000446663428
  error estimate for blocks of size 2^( 6) =       0.000449377520
  error estimate for blocks of size 2^( 7) =       0.000451050180

      target function =                  N/A
              le_mean =     -17.210935300033
             les_mean =     296.559559003995
             stat err =       0.000447259348
             autocorr =       1.165517981659
              std dev =       0.585888448164
             le_variance =       0.343265273692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342501668810
                                         uncertainty =       0.004650287044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342501668810
                                         uncertainty =       0.004650287044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413839958
  error estimate for blocks of size 2^( 2) =       0.000424384632
  error estimate for blocks of size 2^( 3) =       0.000434122972
  error estimate for blocks of size 2^( 4) =       0.000441606391
  error estimate for blocks of size 2^( 5) =       0.000446333996
  error estimate for blocks of size 2^( 6) =       0.000449060367
  error estimate for blocks of size 2^( 7) =       0.000450729721

      target function =                  N/A
              le_mean =     -17.210933617636
             les_mean =     296.558762841344
             stat err =       0.000446932619
             autocorr =       1.166324132462
              std dev =       0.585258081462
             le_variance =       0.342527021917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210933683550        initial
     6.1035e-02     6.1035e-01             8.8321e-03       -17.210934548610
     2.4414e-01     2.4414e+00             2.8650e-03       -17.210935300033  <--
     9.7656e-01     9.7656e+00             8.1185e-04       -17.210933617636

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.4611e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.129319e-01 1 1  ON 0
 uu_1                 4.832552e-02 1 1  ON 1
 uu_2                -4.951713e-02 1 1  ON 2
 uu_3                -1.044088e-01 1 1  ON 3
 uu_4                -1.348076e-01 1 1  ON 4
 uu_5                -1.378458e-01 1 1  ON 5
 uu_6                -1.121770e-01 1 1  ON 6
 uu_7                -3.939373e-02 1 1  ON 7
 uu_8                 9.980951e-02 1 1  ON 8
 uu_9                 1.222085e-01 1 1  ON 9
 ud_0                 3.559709e-01 1 1  ON 10
 ud_1                 9.341121e-02 1 1  ON 11
 ud_2                -1.739905e-02 1 1  ON 12
 ud_3                -7.670737e-02 1 1  ON 13
 ud_4                -1.233047e-01 1 1  ON 14
 ud_5                -1.545562e-01 1 1  ON 15
 ud_6                -1.563097e-01 1 1  ON 16
 ud_7                -1.120530e-01 1 1  ON 17
 ud_8                 3.270554e-03 1 1  ON 18
 ud_9                 9.331450e-02 1 1  ON 19
 eO_0                -7.666302e-01 1 1  ON 20
 eO_1                -4.438292e-01 1 1  ON 21
 eO_2                -3.309322e-02 1 1  ON 22
 eO_3                 2.160798e-01 1 1  ON 23
 eO_4                 2.981739e-01 1 1  ON 24
 eO_5                 3.078077e-01 1 1  ON 25
 eO_6                 2.503262e-01 1 1  ON 26
 eO_7                 1.131418e-01 1 1  ON 27
 eO_8                 2.821769e-02 1 1  ON 28
 eO_9                 1.876832e-02 1 1  ON 29
eH1_0                -1.831274e-01 1 1  ON 30
eH1_1                -1.045491e-01 1 1  ON 31
eH1_2                -6.297803e-02 1 1  ON 32
eH1_3                -2.597186e-02 1 1  ON 33
eH1_4                 1.970002e-02 1 1  ON 34
eH1_5                 3.582432e-02 1 1  ON 35
eH1_6                 7.811990e-02 1 1  ON 36
eH1_7                 1.104841e-01 1 1  ON 37
eH1_8                 9.198440e-02 1 1  ON 38
eH1_9                 2.488841e-02 1 1  ON 39
eH2_0                -1.837608e-01 1 1  ON 40
eH2_1                -1.054255e-01 1 1  ON 41
eH2_2                -6.373061e-02 1 1  ON 42
eH2_3                -2.658881e-02 1 1  ON 43
eH2_4                 1.862783e-02 1 1  ON 44
eH2_5                 3.499684e-02 1 1  ON 45
eH2_6                 7.867035e-02 1 1  ON 46
eH2_7                 1.135441e-01 1 1  ON 47
eH2_8                 9.456807e-02 1 1  ON 48
eH2_9                 2.671403e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.157872
====================================================
  Execution time = 3.1752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3662e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336677127261
                                         uncertainty =       0.003583709061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336677127261
                                         uncertainty =       0.003583709061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410257819
  error estimate for blocks of size 2^( 2) =       0.000420563102
  error estimate for blocks of size 2^( 3) =       0.000429884416
  error estimate for blocks of size 2^( 4) =       0.000436803244
  error estimate for blocks of size 2^( 5) =       0.000442723607
  error estimate for blocks of size 2^( 6) =       0.000445114531
  error estimate for blocks of size 2^( 7) =       0.000445191344

      target function =                  N/A
              le_mean =     -17.211359455195
             les_mean =     296.567517083560
             stat err =       0.000442458182
             autocorr =       1.163136613199
              std dev =       0.580192171563
             le_variance =       0.336622955943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721135945519e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211359455195       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211362033358       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211364016055       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211366632102       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211378428768       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211376725833       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211377926424       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211378411200       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211378430732       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211378852962       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211378425798       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211379589281       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211378973250       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.211378943109       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 6.805711e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211359455195       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211360827599       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211361922840       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211363235720       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211367801870       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211366229571       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211365910934       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211365926509       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211366035471       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211366127487       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 2.090951e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211359455195       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211359933263       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211360358645       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211360784915       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211362008836       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211361524421       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211361355874       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211361365425       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 5.609121e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0775e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.135501e-01 1 1  ON 0
 uu_1                 4.880442e-02 1 1  ON 1
 uu_2                -4.920371e-02 1 1  ON 2
 uu_3                -1.043259e-01 1 1  ON 3
 uu_4                -1.349921e-01 1 1  ON 4
 uu_5                -1.381675e-01 1 1  ON 5
 uu_6                -1.126583e-01 1 1  ON 6
 uu_7                -3.994221e-02 1 1  ON 7
 uu_8                 9.945680e-02 1 1  ON 8
 uu_9                 1.223848e-01 1 1  ON 9
 ud_0                 3.564617e-01 1 1  ON 10
 ud_1                 9.382334e-02 1 1  ON 11
 ud_2                -1.707203e-02 1 1  ON 12
 ud_3                -7.667345e-02 1 1  ON 13
 ud_4                -1.234541e-01 1 1  ON 14
 ud_5                -1.551202e-01 1 1  ON 15
 ud_6                -1.565566e-01 1 1  ON 16
 ud_7                -1.120235e-01 1 1  ON 17
 ud_8                 2.816667e-03 1 1  ON 18
 ud_9                 9.328455e-02 1 1  ON 19
 eO_0                -7.686664e-01 1 1  ON 20
 eO_1                -4.455768e-01 1 1  ON 21
 eO_2                -3.375297e-02 1 1  ON 22
 eO_3                 2.166225e-01 1 1  ON 23
 eO_4                 3.002649e-01 1 1  ON 24
 eO_5                 3.086942e-01 1 1  ON 25
 eO_6                 2.506842e-01 1 1  ON 26
 eO_7                 1.136165e-01 1 1  ON 27
 eO_8                 2.828570e-02 1 1  ON 28
 eO_9                 1.878447e-02 1 1  ON 29
eH1_0                -1.834084e-01 1 1  ON 30
eH1_1                -1.047211e-01 1 1  ON 31
eH1_2                -6.299752e-02 1 1  ON 32
eH1_3                -2.590483e-02 1 1  ON 33
eH1_4                 1.957414e-02 1 1  ON 34
eH1_5                 3.583361e-02 1 1  ON 35
eH1_6                 7.832921e-02 1 1  ON 36
eH1_7                 1.104977e-01 1 1  ON 37
eH1_8                 9.221445e-02 1 1  ON 38
eH1_9                 2.494881e-02 1 1  ON 39
eH2_0                -1.839394e-01 1 1  ON 40
eH2_1                -1.055220e-01 1 1  ON 41
eH2_2                -6.362866e-02 1 1  ON 42
eH2_3                -2.663493e-02 1 1  ON 43
eH2_4                 1.859902e-02 1 1  ON 44
eH2_5                 3.493464e-02 1 1  ON 45
eH2_6                 7.873959e-02 1 1  ON 46
eH2_7                 1.134452e-01 1 1  ON 47
eH2_8                 9.482369e-02 1 1  ON 48
eH2_9                 2.679083e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1722
    reference variance = 0.180972
====================================================
  Execution time = 3.1092e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5156e-01
  Total weights = 2.0000e+06
  Execution time = 2.6744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351449692789
                                         uncertainty =       0.010887804964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351449692789
                                         uncertainty =       0.010887804964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419122987
  error estimate for blocks of size 2^( 2) =       0.000429714520
  error estimate for blocks of size 2^( 3) =       0.000439177809
  error estimate for blocks of size 2^( 4) =       0.000445652208
  error estimate for blocks of size 2^( 5) =       0.000450330413
  error estimate for blocks of size 2^( 6) =       0.000451902910
  error estimate for blocks of size 2^( 7) =       0.000453639778

      target function =                  N/A
              le_mean =     -17.211623839120
             les_mean =     296.591323160055
             stat err =       0.000450381327
             autocorr =       1.154722934484
              std dev =       0.592729412433
             le_variance =       0.351328156364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352222905082
                                         uncertainty =       0.010908809153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352222905082
                                         uncertainty =       0.010908809153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419583805
  error estimate for blocks of size 2^( 2) =       0.000430150126
  error estimate for blocks of size 2^( 3) =       0.000439579122
  error estimate for blocks of size 2^( 4) =       0.000446016531
  error estimate for blocks of size 2^( 5) =       0.000450668820
  error estimate for blocks of size 2^( 6) =       0.000452235601
  error estimate for blocks of size 2^( 7) =       0.000453966585

      target function =                  N/A
              le_mean =     -17.211619714330
             les_mean =     296.591954153978
             stat err =       0.000450721884
             autocorr =       1.153931038632
              std dev =       0.593381107973
             le_variance =       0.352101139300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351923246054
                                         uncertainty =       0.010900218486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351923246054
                                         uncertainty =       0.010900218486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419405274
  error estimate for blocks of size 2^( 2) =       0.000429981789
  error estimate for blocks of size 2^( 3) =       0.000439424128
  error estimate for blocks of size 2^( 4) =       0.000445874792
  error estimate for blocks of size 2^( 5) =       0.000450536645
  error estimate for blocks of size 2^( 6) =       0.000452105153
  error estimate for blocks of size 2^( 7) =       0.000453836363

      target function =                  N/A
              le_mean =     -17.211619814830
             les_mean =     296.591658041758
             stat err =       0.000450588238
             autocorr =       1.154228856706
              std dev =       0.593128626372
             le_variance =       0.351801567422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351518125950
                                         uncertainty =       0.010889941949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351518125950
                                         uncertainty =       0.010889941949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419163793
  error estimate for blocks of size 2^( 2) =       0.000429753217
  error estimate for blocks of size 2^( 3) =       0.000439213663
  error estimate for blocks of size 2^( 4) =       0.000445684685
  error estimate for blocks of size 2^( 5) =       0.000450360640
  error estimate for blocks of size 2^( 6) =       0.000451932883
  error estimate for blocks of size 2^( 7) =       0.000453668400

      target function =                  N/A
              le_mean =     -17.211622867137
             les_mean =     296.591358115331
             stat err =       0.000450411652
             autocorr =       1.154653591426
              std dev =       0.592787120708
             le_variance =       0.351396570477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211623839120        initial  <--
     6.1035e-02     6.1035e-01             6.8057e-03       -17.211619714330
     2.4414e-01     2.4414e+00             2.0910e-03       -17.211619814830
     9.7656e-01     9.7656e+00             5.6091e-04       -17.211622867137

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.1588
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.129319e-01 1 1  ON 0
 uu_1                 4.832552e-02 1 1  ON 1
 uu_2                -4.951713e-02 1 1  ON 2
 uu_3                -1.044088e-01 1 1  ON 3
 uu_4                -1.348076e-01 1 1  ON 4
 uu_5                -1.378458e-01 1 1  ON 5
 uu_6                -1.121770e-01 1 1  ON 6
 uu_7                -3.939373e-02 1 1  ON 7
 uu_8                 9.980951e-02 1 1  ON 8
 uu_9                 1.222085e-01 1 1  ON 9
 ud_0                 3.559709e-01 1 1  ON 10
 ud_1                 9.341121e-02 1 1  ON 11
 ud_2                -1.739905e-02 1 1  ON 12
 ud_3                -7.670737e-02 1 1  ON 13
 ud_4                -1.233047e-01 1 1  ON 14
 ud_5                -1.545562e-01 1 1  ON 15
 ud_6                -1.563097e-01 1 1  ON 16
 ud_7                -1.120530e-01 1 1  ON 17
 ud_8                 3.270554e-03 1 1  ON 18
 ud_9                 9.331450e-02 1 1  ON 19
 eO_0                -7.666302e-01 1 1  ON 20
 eO_1                -4.438292e-01 1 1  ON 21
 eO_2                -3.309322e-02 1 1  ON 22
 eO_3                 2.160798e-01 1 1  ON 23
 eO_4                 2.981739e-01 1 1  ON 24
 eO_5                 3.078077e-01 1 1  ON 25
 eO_6                 2.503262e-01 1 1  ON 26
 eO_7                 1.131418e-01 1 1  ON 27
 eO_8                 2.821769e-02 1 1  ON 28
 eO_9                 1.876832e-02 1 1  ON 29
eH1_0                -1.831274e-01 1 1  ON 30
eH1_1                -1.045491e-01 1 1  ON 31
eH1_2                -6.297803e-02 1 1  ON 32
eH1_3                -2.597186e-02 1 1  ON 33
eH1_4                 1.970002e-02 1 1  ON 34
eH1_5                 3.582432e-02 1 1  ON 35
eH1_6                 7.811990e-02 1 1  ON 36
eH1_7                 1.104841e-01 1 1  ON 37
eH1_8                 9.198440e-02 1 1  ON 38
eH1_9                 2.488841e-02 1 1  ON 39
eH2_0                -1.837608e-01 1 1  ON 40
eH2_1                -1.054255e-01 1 1  ON 41
eH2_2                -6.373061e-02 1 1  ON 42
eH2_3                -2.658881e-02 1 1  ON 43
eH2_4                 1.862783e-02 1 1  ON 44
eH2_5                 3.499684e-02 1 1  ON 45
eH2_6                 7.867035e-02 1 1  ON 46
eH2_7                 1.135441e-01 1 1  ON 47
eH2_8                 9.456807e-02 1 1  ON 48
eH2_9                 2.671403e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1904
    reference variance = 0.250998
====================================================
  Execution time = 3.1544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346017638682
                                         uncertainty =       0.006395382699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346017638682
                                         uncertainty =       0.006395382699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415955744
  error estimate for blocks of size 2^( 2) =       0.000426364581
  error estimate for blocks of size 2^( 3) =       0.000435239026
  error estimate for blocks of size 2^( 4) =       0.000442428763
  error estimate for blocks of size 2^( 5) =       0.000444982228
  error estimate for blocks of size 2^( 6) =       0.000448427142
  error estimate for blocks of size 2^( 7) =       0.000450005017

      target function =                  N/A
              le_mean =     -17.211168708933
             les_mean =     296.570366515951
             stat err =       0.000446460788
             autocorr =       1.152052818216
              std dev =       0.588250254233
             le_variance =       0.346038361605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721116870893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211168708933       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211168372715       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211170399057       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211170140460       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211171039554       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211170813074       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211171047072       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211170914382       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.211170928855       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 9.424751e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211168708933       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211168610148       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211169221892       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211169131418       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211169321477       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211169288945       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211169311071       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 2.420032e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211168708933       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211168683105       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211168844368       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211168819852       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211168865398       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211168860078       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211168861376       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 6.108965e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0359e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.129781e-01 1 1  ON 0
 uu_1                 4.834829e-02 1 1  ON 1
 uu_2                -4.950347e-02 1 1  ON 2
 uu_3                -1.044215e-01 1 1  ON 3
 uu_4                -1.347938e-01 1 1  ON 4
 uu_5                -1.378962e-01 1 1  ON 5
 uu_6                -1.122154e-01 1 1  ON 6
 uu_7                -3.942859e-02 1 1  ON 7
 uu_8                 9.978916e-02 1 1  ON 8
 uu_9                 1.222360e-01 1 1  ON 9
 ud_0                 3.560186e-01 1 1  ON 10
 ud_1                 9.345310e-02 1 1  ON 11
 ud_2                -1.739007e-02 1 1  ON 12
 ud_3                -7.671873e-02 1 1  ON 13
 ud_4                -1.233536e-01 1 1  ON 14
 ud_5                -1.545953e-01 1 1  ON 15
 ud_6                -1.562967e-01 1 1  ON 16
 ud_7                -1.120575e-01 1 1  ON 17
 ud_8                 3.231470e-03 1 1  ON 18
 ud_9                 9.331866e-02 1 1  ON 19
 eO_0                -7.668722e-01 1 1  ON 20
 eO_1                -4.440203e-01 1 1  ON 21
 eO_2                -3.314985e-02 1 1  ON 22
 eO_3                 2.161746e-01 1 1  ON 23
 eO_4                 2.983810e-01 1 1  ON 24
 eO_5                 3.078916e-01 1 1  ON 25
 eO_6                 2.503645e-01 1 1  ON 26
 eO_7                 1.131911e-01 1 1  ON 27
 eO_8                 2.822788e-02 1 1  ON 28
 eO_9                 1.877160e-02 1 1  ON 29
eH1_0                -1.831731e-01 1 1  ON 30
eH1_1                -1.045815e-01 1 1  ON 31
eH1_2                -6.293877e-02 1 1  ON 32
eH1_3                -2.596807e-02 1 1  ON 33
eH1_4                 1.965536e-02 1 1  ON 34
eH1_5                 3.581115e-02 1 1  ON 35
eH1_6                 7.816353e-02 1 1  ON 36
eH1_7                 1.104933e-01 1 1  ON 37
eH1_8                 9.201486e-02 1 1  ON 38
eH1_9                 2.489687e-02 1 1  ON 39
eH2_0                -1.837616e-01 1 1  ON 40
eH2_1                -1.054239e-01 1 1  ON 41
eH2_2                -6.374854e-02 1 1  ON 42
eH2_3                -2.655311e-02 1 1  ON 43
eH2_4                 1.856854e-02 1 1  ON 44
eH2_5                 3.496334e-02 1 1  ON 45
eH2_6                 7.869689e-02 1 1  ON 46
eH2_7                 1.135475e-01 1 1  ON 47
eH2_8                 9.459896e-02 1 1  ON 48
eH2_9                 2.672488e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.329365
====================================================
  Execution time = 3.0935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.6016e-01
  Total weights = 2.0000e+06
  Execution time = 2.6670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360172811808
                                         uncertainty =       0.018878612250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360172811808
                                         uncertainty =       0.018878612250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424340287
  error estimate for blocks of size 2^( 2) =       0.000434237691
  error estimate for blocks of size 2^( 3) =       0.000443163228
  error estimate for blocks of size 2^( 4) =       0.000450401116
  error estimate for blocks of size 2^( 5) =       0.000454236857
  error estimate for blocks of size 2^( 6) =       0.000458008145
  error estimate for blocks of size 2^( 7) =       0.000459727524

      target function =                  N/A
              le_mean =     -17.211178293946
             les_mean =     296.584787445082
             stat err =       0.000455593410
             autocorr =       1.152726654262
              std dev =       0.600107789620
             le_variance =       0.360129359162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360288222103
                                         uncertainty =       0.018881158089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360288222103
                                         uncertainty =       0.018881158089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424408292
  error estimate for blocks of size 2^( 2) =       0.000434300763
  error estimate for blocks of size 2^( 3) =       0.000443222120
  error estimate for blocks of size 2^( 4) =       0.000450456969
  error estimate for blocks of size 2^( 5) =       0.000454288402
  error estimate for blocks of size 2^( 6) =       0.000458060566
  error estimate for blocks of size 2^( 7) =       0.000459775048

      target function =                  N/A
              le_mean =     -17.211177623659
             les_mean =     296.584879810057
             stat err =       0.000455645246
             autocorr =       1.152619509450
              std dev =       0.600203962862
             le_variance =       0.360244797035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360239326050
                                         uncertainty =       0.018881110218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360239326050
                                         uncertainty =       0.018881110218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424379482
  error estimate for blocks of size 2^( 2) =       0.000434273960
  error estimate for blocks of size 2^( 3) =       0.000443197250
  error estimate for blocks of size 2^( 4) =       0.000450433384
  error estimate for blocks of size 2^( 5) =       0.000454266817
  error estimate for blocks of size 2^( 6) =       0.000458038828
  error estimate for blocks of size 2^( 7) =       0.000459755643

      target function =                  N/A
              le_mean =     -17.211177748978
             les_mean =     296.584835216016
             stat err =       0.000455623668
             autocorr =       1.152666829165
              std dev =       0.600163218806
             le_variance =       0.360195889208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360180954003
                                         uncertainty =       0.018878940615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360180954003
                                         uncertainty =       0.018878940615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424345086
  error estimate for blocks of size 2^( 2) =       0.000434242115
  error estimate for blocks of size 2^( 3) =       0.000443167377
  error estimate for blocks of size 2^( 4) =       0.000450405040
  error estimate for blocks of size 2^( 5) =       0.000454240479
  error estimate for blocks of size 2^( 6) =       0.000458011880
  error estimate for blocks of size 2^( 7) =       0.000459730951

      target function =                  N/A
              le_mean =     -17.211178207517
             les_mean =     296.584792614059
             stat err =       0.000455597087
             autocorr =       1.152719193075
              std dev =       0.600114575075
             le_variance =       0.360137503218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211178293946        initial  <--
     6.1035e-01     6.1035e+00             9.4248e-04       -17.211177623659
     2.4414e+00     2.4414e+01             2.4200e-04       -17.211177748978
     9.7656e+00     9.7656e+01             6.1090e-05       -17.211178207517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2773
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.129319e-01 1 1  ON 0
 uu_1                 4.832552e-02 1 1  ON 1
 uu_2                -4.951713e-02 1 1  ON 2
 uu_3                -1.044088e-01 1 1  ON 3
 uu_4                -1.348076e-01 1 1  ON 4
 uu_5                -1.378458e-01 1 1  ON 5
 uu_6                -1.121770e-01 1 1  ON 6
 uu_7                -3.939373e-02 1 1  ON 7
 uu_8                 9.980951e-02 1 1  ON 8
 uu_9                 1.222085e-01 1 1  ON 9
 ud_0                 3.559709e-01 1 1  ON 10
 ud_1                 9.341121e-02 1 1  ON 11
 ud_2                -1.739905e-02 1 1  ON 12
 ud_3                -7.670737e-02 1 1  ON 13
 ud_4                -1.233047e-01 1 1  ON 14
 ud_5                -1.545562e-01 1 1  ON 15
 ud_6                -1.563097e-01 1 1  ON 16
 ud_7                -1.120530e-01 1 1  ON 17
 ud_8                 3.270554e-03 1 1  ON 18
 ud_9                 9.331450e-02 1 1  ON 19
 eO_0                -7.666302e-01 1 1  ON 20
 eO_1                -4.438292e-01 1 1  ON 21
 eO_2                -3.309322e-02 1 1  ON 22
 eO_3                 2.160798e-01 1 1  ON 23
 eO_4                 2.981739e-01 1 1  ON 24
 eO_5                 3.078077e-01 1 1  ON 25
 eO_6                 2.503262e-01 1 1  ON 26
 eO_7                 1.131418e-01 1 1  ON 27
 eO_8                 2.821769e-02 1 1  ON 28
 eO_9                 1.876832e-02 1 1  ON 29
eH1_0                -1.831274e-01 1 1  ON 30
eH1_1                -1.045491e-01 1 1  ON 31
eH1_2                -6.297803e-02 1 1  ON 32
eH1_3                -2.597186e-02 1 1  ON 33
eH1_4                 1.970002e-02 1 1  ON 34
eH1_5                 3.582432e-02 1 1  ON 35
eH1_6                 7.811990e-02 1 1  ON 36
eH1_7                 1.104841e-01 1 1  ON 37
eH1_8                 9.198440e-02 1 1  ON 38
eH1_9                 2.488841e-02 1 1  ON 39
eH2_0                -1.837608e-01 1 1  ON 40
eH2_1                -1.054255e-01 1 1  ON 41
eH2_2                -6.373061e-02 1 1  ON 42
eH2_3                -2.658881e-02 1 1  ON 43
eH2_4                 1.862783e-02 1 1  ON 44
eH2_5                 3.499684e-02 1 1  ON 45
eH2_6                 7.867035e-02 1 1  ON 46
eH2_7                 1.135441e-01 1 1  ON 47
eH2_8                 9.456807e-02 1 1  ON 48
eH2_9                 2.671403e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4642e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2762
    reference variance = 0.60688
====================================================
  Execution time = 3.1610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4015e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340154123563
                                         uncertainty =       0.002650707085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340154123563
                                         uncertainty =       0.002650707085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412400330
  error estimate for blocks of size 2^( 2) =       0.000423335211
  error estimate for blocks of size 2^( 3) =       0.000432137460
  error estimate for blocks of size 2^( 4) =       0.000438924844
  error estimate for blocks of size 2^( 5) =       0.000442662156
  error estimate for blocks of size 2^( 6) =       0.000444622259
  error estimate for blocks of size 2^( 7) =       0.000446325058

      target function =                  N/A
              le_mean =     -17.211078801948
             les_mean =     296.561381421154
             stat err =       0.000443133579
             autocorr =       1.154599362331
              std dev =       0.583222139800
             le_variance =       0.340148064353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721107880195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211078801948       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211078880712       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211078815728       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211079039860       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211079000331       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211079040478       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211079019628       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 8.927060e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211078801948       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211078822028       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211078803927       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211078861498       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211078851748       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211078861224       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211078855969       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 2.235289e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211078801948       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211078806993       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211078802345       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211078816811       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211078814399       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211078816738       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211078815422       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 5.590303e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0607e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.129407e-01 1 1  ON 0
 uu_1                 4.833025e-02 1 1  ON 1
 uu_2                -4.951492e-02 1 1  ON 2
 uu_3                -1.044074e-01 1 1  ON 3
 uu_4                -1.348121e-01 1 1  ON 4
 uu_5                -1.378490e-01 1 1  ON 5
 uu_6                -1.121830e-01 1 1  ON 6
 uu_7                -3.940217e-02 1 1  ON 7
 uu_8                 9.980643e-02 1 1  ON 8
 uu_9                 1.222117e-01 1 1  ON 9
 ud_0                 3.559766e-01 1 1  ON 10
 ud_1                 9.341698e-02 1 1  ON 11
 ud_2                -1.739790e-02 1 1  ON 12
 ud_3                -7.670528e-02 1 1  ON 13
 ud_4                -1.233144e-01 1 1  ON 14
 ud_5                -1.545598e-01 1 1  ON 15
 ud_6                -1.563095e-01 1 1  ON 16
 ud_7                -1.120540e-01 1 1  ON 17
 ud_8                 3.265630e-03 1 1  ON 18
 ud_9                 9.331493e-02 1 1  ON 19
 eO_0                -7.666525e-01 1 1  ON 20
 eO_1                -4.438467e-01 1 1  ON 21
 eO_2                -3.310601e-02 1 1  ON 22
 eO_3                 2.160926e-01 1 1  ON 23
 eO_4                 2.981956e-01 1 1  ON 24
 eO_5                 3.078160e-01 1 1  ON 25
 eO_6                 2.503295e-01 1 1  ON 26
 eO_7                 1.131460e-01 1 1  ON 27
 eO_8                 2.821877e-02 1 1  ON 28
 eO_9                 1.876907e-02 1 1  ON 29
eH1_0                -1.831294e-01 1 1  ON 30
eH1_1                -1.045565e-01 1 1  ON 31
eH1_2                -6.297698e-02 1 1  ON 32
eH1_3                -2.597059e-02 1 1  ON 33
eH1_4                 1.969934e-02 1 1  ON 34
eH1_5                 3.582568e-02 1 1  ON 35
eH1_6                 7.812195e-02 1 1  ON 36
eH1_7                 1.104836e-01 1 1  ON 37
eH1_8                 9.198746e-02 1 1  ON 38
eH1_9                 2.488943e-02 1 1  ON 39
eH2_0                -1.837645e-01 1 1  ON 40
eH2_1                -1.054272e-01 1 1  ON 41
eH2_2                -6.373183e-02 1 1  ON 42
eH2_3                -2.658733e-02 1 1  ON 43
eH2_4                 1.862836e-02 1 1  ON 44
eH2_5                 3.499519e-02 1 1  ON 45
eH2_6                 7.867283e-02 1 1  ON 46
eH2_7                 1.135437e-01 1 1  ON 47
eH2_8                 9.457073e-02 1 1  ON 48
eH2_9                 2.671515e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.252001
====================================================
  Execution time = 3.1403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4004e-01
  Total weights = 2.0000e+06
  Execution time = 2.6639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339742256073
                                         uncertainty =       0.002605116698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339742256073
                                         uncertainty =       0.002605116698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412330577
  error estimate for blocks of size 2^( 2) =       0.000423128397
  error estimate for blocks of size 2^( 3) =       0.000432400324
  error estimate for blocks of size 2^( 4) =       0.000439394275
  error estimate for blocks of size 2^( 5) =       0.000443943818
  error estimate for blocks of size 2^( 6) =       0.000446833520
  error estimate for blocks of size 2^( 7) =       0.000447419249

      target function =                  N/A
              le_mean =     -17.211185499047
             les_mean =     296.564939122219
             stat err =       0.000444397715
             autocorr =       1.161589162387
              std dev =       0.583123494315
             le_variance =       0.340033009623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339759622137
                                         uncertainty =       0.002605080284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339759622137
                                         uncertainty =       0.002605080284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412341115
  error estimate for blocks of size 2^( 2) =       0.000423138095
  error estimate for blocks of size 2^( 3) =       0.000432409047
  error estimate for blocks of size 2^( 4) =       0.000439402492
  error estimate for blocks of size 2^( 5) =       0.000443951988
  error estimate for blocks of size 2^( 6) =       0.000446842240
  error estimate for blocks of size 2^( 7) =       0.000447428536

      target function =                  N/A
              le_mean =     -17.211185507197
             les_mean =     296.564956783602
             stat err =       0.000444406314
             autocorr =       1.161574740901
              std dev =       0.583138397350
             le_variance =       0.340050390464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751133035
                                         uncertainty =       0.002605095600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751133035
                                         uncertainty =       0.002605095600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412335964
  error estimate for blocks of size 2^( 2) =       0.000423133354
  error estimate for blocks of size 2^( 3) =       0.000432404786
  error estimate for blocks of size 2^( 4) =       0.000439398485
  error estimate for blocks of size 2^( 5) =       0.000443948005
  error estimate for blocks of size 2^( 6) =       0.000446838002
  error estimate for blocks of size 2^( 7) =       0.000447424026

      target function =                  N/A
              le_mean =     -17.211185500099
             les_mean =     296.564948043008
             stat err =       0.000444402129
             autocorr =       1.161581886443
              std dev =       0.583131112380
             le_variance =       0.340041894226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339743371866
                                         uncertainty =       0.002605113964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339743371866
                                         uncertainty =       0.002605113964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412331254
  error estimate for blocks of size 2^( 2) =       0.000423129020
  error estimate for blocks of size 2^( 3) =       0.000432400885
  error estimate for blocks of size 2^( 4) =       0.000439394804
  error estimate for blocks of size 2^( 5) =       0.000443944345
  error estimate for blocks of size 2^( 6) =       0.000446834084
  error estimate for blocks of size 2^( 7) =       0.000447419850

      target function =                  N/A
              le_mean =     -17.211185498985
             les_mean =     296.564940236830
             stat err =       0.000444398271
             autocorr =       1.161588250273
              std dev =       0.583124451878
             le_variance =       0.340034126378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211185499047        initial
     6.1035e+00     6.1035e+01             8.9271e-05       -17.211185507197  <--
     2.4414e+01     2.4414e+02             2.2353e-05       -17.211185500099
     9.7656e+01     9.7656e+02             5.5903e-06       -17.211185498985

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.4746e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.129667e-01 1 1  ON 0
 uu_1                 4.834433e-02 1 1  ON 1
 uu_2                -4.950788e-02 1 1  ON 2
 uu_3                -1.044032e-01 1 1  ON 3
 uu_4                -1.348254e-01 1 1  ON 4
 uu_5                -1.378588e-01 1 1  ON 5
 uu_6                -1.122006e-01 1 1  ON 6
 uu_7                -3.942736e-02 1 1  ON 7
 uu_8                 9.979723e-02 1 1  ON 8
 uu_9                 1.222215e-01 1 1  ON 9
 ud_0                 3.559937e-01 1 1  ON 10
 ud_1                 9.343382e-02 1 1  ON 11
 ud_2                -1.739398e-02 1 1  ON 12
 ud_3                -7.669980e-02 1 1  ON 13
 ud_4                -1.233422e-01 1 1  ON 14
 ud_5                -1.545712e-01 1 1  ON 15
 ud_6                -1.563090e-01 1 1  ON 16
 ud_7                -1.120568e-01 1 1  ON 17
 ud_8                 3.250930e-03 1 1  ON 18
 ud_9                 9.331622e-02 1 1  ON 19
 eO_0                -7.667194e-01 1 1  ON 20
 eO_1                -4.438991e-01 1 1  ON 21
 eO_2                -3.314379e-02 1 1  ON 22
 eO_3                 2.161308e-01 1 1  ON 23
 eO_4                 2.982602e-01 1 1  ON 24
 eO_5                 3.078407e-01 1 1  ON 25
 eO_6                 2.503392e-01 1 1  ON 26
 eO_7                 1.131585e-01 1 1  ON 27
 eO_8                 2.822200e-02 1 1  ON 28
 eO_9                 1.877130e-02 1 1  ON 29
eH1_0                -1.831352e-01 1 1  ON 30
eH1_1                -1.045782e-01 1 1  ON 31
eH1_2                -6.297431e-02 1 1  ON 32
eH1_3                -2.596684e-02 1 1  ON 33
eH1_4                 1.969749e-02 1 1  ON 34
eH1_5                 3.582963e-02 1 1  ON 35
eH1_6                 7.812807e-02 1 1  ON 36
eH1_7                 1.104821e-01 1 1  ON 37
eH1_8                 9.199661e-02 1 1  ON 38
eH1_9                 2.489244e-02 1 1  ON 39
eH2_0                -1.837757e-01 1 1  ON 40
eH2_1                -1.054324e-01 1 1  ON 41
eH2_2                -6.373541e-02 1 1  ON 42
eH2_3                -2.658281e-02 1 1  ON 43
eH2_4                 1.862995e-02 1 1  ON 44
eH2_5                 3.499017e-02 1 1  ON 45
eH2_6                 7.868022e-02 1 1  ON 46
eH2_7                 1.135423e-01 1 1  ON 47
eH2_8                 9.457869e-02 1 1  ON 48
eH2_9                 2.671847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1686
    reference variance = 0.391671
====================================================
  Execution time = 3.1620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3987e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339504911906
                                         uncertainty =       0.002881609046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339504911906
                                         uncertainty =       0.002881609046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412234281
  error estimate for blocks of size 2^( 2) =       0.000422770043
  error estimate for blocks of size 2^( 3) =       0.000432011977
  error estimate for blocks of size 2^( 4) =       0.000438997031
  error estimate for blocks of size 2^( 5) =       0.000443158482
  error estimate for blocks of size 2^( 6) =       0.000444671991
  error estimate for blocks of size 2^( 7) =       0.000448119989

      target function =                  N/A
              le_mean =     -17.211482761429
             les_mean =     296.575012881067
             stat err =       0.000443736873
             autocorr =       1.158678182798
              std dev =       0.582987310363
             le_variance =       0.339874204044


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721148276143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211482761429       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211482640953       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211483015496       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211483299325       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211483345984       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211483669249       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211483687361       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211483721388       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 4.108690e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211482761429       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211482727389       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211482832680       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211482884610       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211482936253       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211482975395       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211482983317       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 1.021042e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211482761429       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211482752633       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211482779678       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211482786501       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211482793682       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211482813795       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211482815928       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 2.552887e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229116 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0487e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.130030e-01 1 1  ON 0
 uu_1                 4.835293e-02 1 1  ON 1
 uu_2                -4.950388e-02 1 1  ON 2
 uu_3                -1.043944e-01 1 1  ON 3
 uu_4                -1.348485e-01 1 1  ON 4
 uu_5                -1.378819e-01 1 1  ON 5
 uu_6                -1.122098e-01 1 1  ON 6
 uu_7                -3.943996e-02 1 1  ON 7
 uu_8                 9.978742e-02 1 1  ON 8
 uu_9                 1.222297e-01 1 1  ON 9
 ud_0                 3.560222e-01 1 1  ON 10
 ud_1                 9.345466e-02 1 1  ON 11
 ud_2                -1.738217e-02 1 1  ON 12
 ud_3                -7.671838e-02 1 1  ON 13
 ud_4                -1.233502e-01 1 1  ON 14
 ud_5                -1.545929e-01 1 1  ON 15
 ud_6                -1.563121e-01 1 1  ON 16
 ud_7                -1.120581e-01 1 1  ON 17
 ud_8                 3.234968e-03 1 1  ON 18
 ud_9                 9.331543e-02 1 1  ON 19
 eO_0                -7.668215e-01 1 1  ON 20
 eO_1                -4.439882e-01 1 1  ON 21
 eO_2                -3.315775e-02 1 1  ON 22
 eO_3                 2.161611e-01 1 1  ON 23
 eO_4                 2.983583e-01 1 1  ON 24
 eO_5                 3.078759e-01 1 1  ON 25
 eO_6                 2.503573e-01 1 1  ON 26
 eO_7                 1.131779e-01 1 1  ON 27
 eO_8                 2.822449e-02 1 1  ON 28
 eO_9                 1.877213e-02 1 1  ON 29
eH1_0                -1.831568e-01 1 1  ON 30
eH1_1                -1.046027e-01 1 1  ON 31
eH1_2                -6.296835e-02 1 1  ON 32
eH1_3                -2.595825e-02 1 1  ON 33
eH1_4                 1.970370e-02 1 1  ON 34
eH1_5                 3.582369e-02 1 1  ON 35
eH1_6                 7.814340e-02 1 1  ON 36
eH1_7                 1.104851e-01 1 1  ON 37
eH1_8                 9.200600e-02 1 1  ON 38
eH1_9                 2.489522e-02 1 1  ON 39
eH2_0                -1.837996e-01 1 1  ON 40
eH2_1                -1.054541e-01 1 1  ON 41
eH2_2                -6.372149e-02 1 1  ON 42
eH2_3                -2.657686e-02 1 1  ON 43
eH2_4                 1.865000e-02 1 1  ON 44
eH2_5                 3.498194e-02 1 1  ON 45
eH2_6                 7.867641e-02 1 1  ON 46
eH2_7                 1.135419e-01 1 1  ON 47
eH2_8                 9.459158e-02 1 1  ON 48
eH2_9                 2.672216e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.227622
====================================================
  Execution time = 3.1166e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4721e-01
  Total weights = 2.0000e+06
  Execution time = 2.6540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347144979319
                                         uncertainty =       0.005039071207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347144979319
                                         uncertainty =       0.005039071207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416654327
  error estimate for blocks of size 2^( 2) =       0.000426881421
  error estimate for blocks of size 2^( 3) =       0.000436443873
  error estimate for blocks of size 2^( 4) =       0.000443108961
  error estimate for blocks of size 2^( 5) =       0.000447667551
  error estimate for blocks of size 2^( 6) =       0.000449711070
  error estimate for blocks of size 2^( 7) =       0.000453768842

      target function =                  N/A
              le_mean =     -17.211349150694
             les_mean =     296.577741069172
             stat err =       0.000448564106
             autocorr =       1.159036854344
              std dev =       0.589238199447
             le_variance =       0.347201655688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347198773290
                                         uncertainty =       0.005039595508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347198773290
                                         uncertainty =       0.005039595508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416686597
  error estimate for blocks of size 2^( 2) =       0.000426911672
  error estimate for blocks of size 2^( 3) =       0.000436471320
  error estimate for blocks of size 2^( 4) =       0.000443134317
  error estimate for blocks of size 2^( 5) =       0.000447691971
  error estimate for blocks of size 2^( 6) =       0.000449735336
  error estimate for blocks of size 2^( 7) =       0.000453793880

      target function =                  N/A
              le_mean =     -17.211349008089
             les_mean =     296.577789944431
             stat err =       0.000448588876
             autocorr =       1.158985327427
              std dev =       0.589283836385
             le_variance =       0.347255439824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347170832601
                                         uncertainty =       0.005039317739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347170832601
                                         uncertainty =       0.005039317739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416669839
  error estimate for blocks of size 2^( 2) =       0.000426896012
  error estimate for blocks of size 2^( 3) =       0.000436456998
  error estimate for blocks of size 2^( 4) =       0.000443120965
  error estimate for blocks of size 2^( 5) =       0.000447679077
  error estimate for blocks of size 2^( 6) =       0.000449722613
  error estimate for blocks of size 2^( 7) =       0.000453780722

      target function =                  N/A
              le_mean =     -17.211349033144
             les_mean =     296.577762876234
             stat err =       0.000448575844
             autocorr =       1.159011212150
              std dev =       0.589260137084
             le_variance =       0.347227509157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347148152246
                                         uncertainty =       0.005039101653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347148152246
                                         uncertainty =       0.005039101653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416656231
  error estimate for blocks of size 2^( 2) =       0.000426883213
  error estimate for blocks of size 2^( 3) =       0.000436445481
  error estimate for blocks of size 2^( 4) =       0.000443110428
  error estimate for blocks of size 2^( 5) =       0.000447668957
  error estimate for blocks of size 2^( 6) =       0.000449712481
  error estimate for blocks of size 2^( 7) =       0.000453770297

      target function =                  N/A
              le_mean =     -17.211349133740
             les_mean =     296.577743658818
             stat err =       0.000448565541
             autocorr =       1.159033674677
              std dev =       0.589240892092
             le_variance =       0.347204828914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211349150694        initial  <--
     1.5259e+00     1.5259e+01             4.1087e-04       -17.211349008089
     6.1035e+00     6.1035e+01             1.0210e-04       -17.211349033144
     2.4414e+01     2.4414e+02             2.5529e-05       -17.211349133740

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5279
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.129667e-01 1 1  ON 0
 uu_1                 4.834433e-02 1 1  ON 1
 uu_2                -4.950788e-02 1 1  ON 2
 uu_3                -1.044032e-01 1 1  ON 3
 uu_4                -1.348254e-01 1 1  ON 4
 uu_5                -1.378588e-01 1 1  ON 5
 uu_6                -1.122006e-01 1 1  ON 6
 uu_7                -3.942736e-02 1 1  ON 7
 uu_8                 9.979723e-02 1 1  ON 8
 uu_9                 1.222215e-01 1 1  ON 9
 ud_0                 3.559937e-01 1 1  ON 10
 ud_1                 9.343382e-02 1 1  ON 11
 ud_2                -1.739398e-02 1 1  ON 12
 ud_3                -7.669980e-02 1 1  ON 13
 ud_4                -1.233422e-01 1 1  ON 14
 ud_5                -1.545712e-01 1 1  ON 15
 ud_6                -1.563090e-01 1 1  ON 16
 ud_7                -1.120568e-01 1 1  ON 17
 ud_8                 3.250930e-03 1 1  ON 18
 ud_9                 9.331622e-02 1 1  ON 19
 eO_0                -7.667194e-01 1 1  ON 20
 eO_1                -4.438991e-01 1 1  ON 21
 eO_2                -3.314379e-02 1 1  ON 22
 eO_3                 2.161308e-01 1 1  ON 23
 eO_4                 2.982602e-01 1 1  ON 24
 eO_5                 3.078407e-01 1 1  ON 25
 eO_6                 2.503392e-01 1 1  ON 26
 eO_7                 1.131585e-01 1 1  ON 27
 eO_8                 2.822200e-02 1 1  ON 28
 eO_9                 1.877130e-02 1 1  ON 29
eH1_0                -1.831352e-01 1 1  ON 30
eH1_1                -1.045782e-01 1 1  ON 31
eH1_2                -6.297431e-02 1 1  ON 32
eH1_3                -2.596684e-02 1 1  ON 33
eH1_4                 1.969749e-02 1 1  ON 34
eH1_5                 3.582963e-02 1 1  ON 35
eH1_6                 7.812807e-02 1 1  ON 36
eH1_7                 1.104821e-01 1 1  ON 37
eH1_8                 9.199661e-02 1 1  ON 38
eH1_9                 2.489244e-02 1 1  ON 39
eH2_0                -1.837757e-01 1 1  ON 40
eH2_1                -1.054324e-01 1 1  ON 41
eH2_2                -6.373541e-02 1 1  ON 42
eH2_3                -2.658281e-02 1 1  ON 43
eH2_4                 1.862995e-02 1 1  ON 44
eH2_5                 3.499017e-02 1 1  ON 45
eH2_6                 7.868022e-02 1 1  ON 46
eH2_7                 1.135423e-01 1 1  ON 47
eH2_8                 9.457869e-02 1 1  ON 48
eH2_9                 2.671847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5020e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.247196
====================================================
  Execution time = 3.1676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5060e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350717960885
                                         uncertainty =       0.007824473459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350717960885
                                         uncertainty =       0.007824473459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418690286
  error estimate for blocks of size 2^( 2) =       0.000429062473
  error estimate for blocks of size 2^( 3) =       0.000438473424
  error estimate for blocks of size 2^( 4) =       0.000445416430
  error estimate for blocks of size 2^( 5) =       0.000450732311
  error estimate for blocks of size 2^( 6) =       0.000453078066
  error estimate for blocks of size 2^( 7) =       0.000454586271

      target function =                  N/A
              le_mean =     -17.211380537234
             les_mean =     296.582222933391
             stat err =       0.000450953269
             autocorr =       1.160051606362
              std dev =       0.592117480916
             le_variance =       0.350603111206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721138053723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211380537234       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211380628592       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211380744725       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211380734125       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211380779041       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211380814996       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211380786323       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.402393e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211380537234       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211380560289       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211380589902       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211380587149       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211380598300       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211380607361       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211380600359       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 8.512428e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211380537234       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211380543012       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211380550452       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211380549757       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211380552539       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211380554810       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211380553070       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.128508e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1057e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.129720e-01 1 1  ON 0
 uu_1                 4.834706e-02 1 1  ON 1
 uu_2                -4.950739e-02 1 1  ON 2
 uu_3                -1.044041e-01 1 1  ON 3
 uu_4                -1.348258e-01 1 1  ON 4
 uu_5                -1.378616e-01 1 1  ON 5
 uu_6                -1.122040e-01 1 1  ON 6
 uu_7                -3.942993e-02 1 1  ON 7
 uu_8                 9.979613e-02 1 1  ON 8
 uu_9                 1.222226e-01 1 1  ON 9
 ud_0                 3.559991e-01 1 1  ON 10
 ud_1                 9.343400e-02 1 1  ON 11
 ud_2                -1.739297e-02 1 1  ON 12
 ud_3                -7.669956e-02 1 1  ON 13
 ud_4                -1.233424e-01 1 1  ON 14
 ud_5                -1.545737e-01 1 1  ON 15
 ud_6                -1.563117e-01 1 1  ON 16
 ud_7                -1.120577e-01 1 1  ON 17
 ud_8                 3.249388e-03 1 1  ON 18
 ud_9                 9.331641e-02 1 1  ON 19
 eO_0                -7.667267e-01 1 1  ON 20
 eO_1                -4.439072e-01 1 1  ON 21
 eO_2                -3.314619e-02 1 1  ON 22
 eO_3                 2.161330e-01 1 1  ON 23
 eO_4                 2.982687e-01 1 1  ON 24
 eO_5                 3.078441e-01 1 1  ON 25
 eO_6                 2.503405e-01 1 1  ON 26
 eO_7                 1.131604e-01 1 1  ON 27
 eO_8                 2.822241e-02 1 1  ON 28
 eO_9                 1.877151e-02 1 1  ON 29
eH1_0                -1.831357e-01 1 1  ON 30
eH1_1                -1.045788e-01 1 1  ON 31
eH1_2                -6.297373e-02 1 1  ON 32
eH1_3                -2.596691e-02 1 1  ON 33
eH1_4                 1.969634e-02 1 1  ON 34
eH1_5                 3.582921e-02 1 1  ON 35
eH1_6                 7.812859e-02 1 1  ON 36
eH1_7                 1.104821e-01 1 1  ON 37
eH1_8                 9.199763e-02 1 1  ON 38
eH1_9                 2.489291e-02 1 1  ON 39
eH2_0                -1.837755e-01 1 1  ON 40
eH2_1                -1.054333e-01 1 1  ON 41
eH2_2                -6.373491e-02 1 1  ON 42
eH2_3                -2.658286e-02 1 1  ON 43
eH2_4                 1.862791e-02 1 1  ON 44
eH2_5                 3.499061e-02 1 1  ON 45
eH2_6                 7.868071e-02 1 1  ON 46
eH2_7                 1.135422e-01 1 1  ON 47
eH2_8                 9.457970e-02 1 1  ON 48
eH2_9                 2.671882e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2629
    reference variance = 0.325435
====================================================
  Execution time = 3.1568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4730e-01
  Total weights = 2.0000e+06
  Execution time = 2.6626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347252622086
                                         uncertainty =       0.004291113999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347252622086
                                         uncertainty =       0.004291113999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416709615
  error estimate for blocks of size 2^( 2) =       0.000427128357
  error estimate for blocks of size 2^( 3) =       0.000436856495
  error estimate for blocks of size 2^( 4) =       0.000442257512
  error estimate for blocks of size 2^( 5) =       0.000446386612
  error estimate for blocks of size 2^( 6) =       0.000447331898
  error estimate for blocks of size 2^( 7) =       0.000447827721

      target function =                  N/A
              le_mean =     -17.212094395638
             les_mean =     296.603487117765
             stat err =       0.000445950936
             autocorr =       1.145267973454
              std dev =       0.589316389600
             le_variance =       0.347293807051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347274493434
                                         uncertainty =       0.004291397764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347274493434
                                         uncertainty =       0.004291397764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416722746
  error estimate for blocks of size 2^( 2) =       0.000427140971
  error estimate for blocks of size 2^( 3) =       0.000436868601
  error estimate for blocks of size 2^( 4) =       0.000442269056
  error estimate for blocks of size 2^( 5) =       0.000446397827
  error estimate for blocks of size 2^( 6) =       0.000447342827
  error estimate for blocks of size 2^( 7) =       0.000447838555

      target function =                  N/A
              le_mean =     -17.212094432974
             les_mean =     296.603510290107
             stat err =       0.000445962066
             autocorr =       1.145252966555
              std dev =       0.589334959212
             le_variance =       0.347315694150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347263735066
                                         uncertainty =       0.004291257503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347263735066
                                         uncertainty =       0.004291257503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416716287
  error estimate for blocks of size 2^( 2) =       0.000427134767
  error estimate for blocks of size 2^( 3) =       0.000436862648
  error estimate for blocks of size 2^( 4) =       0.000442263381
  error estimate for blocks of size 2^( 5) =       0.000446392315
  error estimate for blocks of size 2^( 6) =       0.000447337455
  error estimate for blocks of size 2^( 7) =       0.000447833232

      target function =                  N/A
              le_mean =     -17.212094414279
             les_mean =     296.603498880517
             stat err =       0.000445956596
             autocorr =       1.145260369253
              std dev =       0.589325825100
             le_variance =       0.347304928130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347254016733
                                         uncertainty =       0.004291131989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347254016733
                                         uncertainty =       0.004291131989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416710453
  error estimate for blocks of size 2^( 2) =       0.000427129161
  error estimate for blocks of size 2^( 3) =       0.000436857267
  error estimate for blocks of size 2^( 4) =       0.000442258249
  error estimate for blocks of size 2^( 5) =       0.000446387328
  error estimate for blocks of size 2^( 6) =       0.000447332595
  error estimate for blocks of size 2^( 7) =       0.000447828413

      target function =                  N/A
              le_mean =     -17.212094397947
             les_mean =     296.603488592901
             stat err =       0.000445951646
             autocorr =       1.145267019626
              std dev =       0.589317573739
             le_variance =       0.347295202718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212094395638        initial
     1.5259e+01     1.5259e+02             3.4024e-05       -17.212094432974  <--
     6.1035e+01     6.1035e+02             8.5124e-06       -17.212094414279
     2.4414e+02     2.4414e+03             2.1285e-06       -17.212094397947

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 4.4920e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.129875e-01 1 1  ON 0
 uu_1                 4.835512e-02 1 1  ON 1
 uu_2                -4.950586e-02 1 1  ON 2
 uu_3                -1.044066e-01 1 1  ON 3
 uu_4                -1.348272e-01 1 1  ON 4
 uu_5                -1.378697e-01 1 1  ON 5
 uu_6                -1.122139e-01 1 1  ON 6
 uu_7                -3.943760e-02 1 1  ON 7
 uu_8                 9.979283e-02 1 1  ON 8
 uu_9                 1.222261e-01 1 1  ON 9
 ud_0                 3.560150e-01 1 1  ON 10
 ud_1                 9.343471e-02 1 1  ON 11
 ud_2                -1.738993e-02 1 1  ON 12
 ud_3                -7.669879e-02 1 1  ON 13
 ud_4                -1.233430e-01 1 1  ON 14
 ud_5                -1.545812e-01 1 1  ON 15
 ud_6                -1.563195e-01 1 1  ON 16
 ud_7                -1.120603e-01 1 1  ON 17
 ud_8                 3.244771e-03 1 1  ON 18
 ud_9                 9.331697e-02 1 1  ON 19
 eO_0                -7.667485e-01 1 1  ON 20
 eO_1                -4.439315e-01 1 1  ON 21
 eO_2                -3.315339e-02 1 1  ON 22
 eO_3                 2.161394e-01 1 1  ON 23
 eO_4                 2.982942e-01 1 1  ON 24
 eO_5                 3.078542e-01 1 1  ON 25
 eO_6                 2.503442e-01 1 1  ON 26
 eO_7                 1.131659e-01 1 1  ON 27
 eO_8                 2.822366e-02 1 1  ON 28
 eO_9                 1.877213e-02 1 1  ON 29
eH1_0                -1.831369e-01 1 1  ON 30
eH1_1                -1.045808e-01 1 1  ON 31
eH1_2                -6.297205e-02 1 1  ON 32
eH1_3                -2.596708e-02 1 1  ON 33
eH1_4                 1.969290e-02 1 1  ON 34
eH1_5                 3.582793e-02 1 1  ON 35
eH1_6                 7.813016e-02 1 1  ON 36
eH1_7                 1.104822e-01 1 1  ON 37
eH1_8                 9.200070e-02 1 1  ON 38
eH1_9                 2.489430e-02 1 1  ON 39
eH2_0                -1.837748e-01 1 1  ON 40
eH2_1                -1.054358e-01 1 1  ON 41
eH2_2                -6.373348e-02 1 1  ON 42
eH2_3                -2.658298e-02 1 1  ON 43
eH2_4                 1.862181e-02 1 1  ON 44
eH2_5                 3.499192e-02 1 1  ON 45
eH2_6                 7.868217e-02 1 1  ON 46
eH2_7                 1.135417e-01 1 1  ON 47
eH2_8                 9.458272e-02 1 1  ON 48
eH2_9                 2.671984e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1296
    reference variance = 0.263333
====================================================
  Execution time = 3.1666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4838e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348491370580
                                         uncertainty =       0.008264949798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348491370580
                                         uncertainty =       0.008264949798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417358515
  error estimate for blocks of size 2^( 2) =       0.000427840885
  error estimate for blocks of size 2^( 3) =       0.000437177206
  error estimate for blocks of size 2^( 4) =       0.000443663760
  error estimate for blocks of size 2^( 5) =       0.000447688204
  error estimate for blocks of size 2^( 6) =       0.000450295611
  error estimate for blocks of size 2^( 7) =       0.000450192707

      target function =                  N/A
              le_mean =     -17.211271972153
             les_mean =     296.576258985930
             stat err =       0.000447960071
             autocorr =       1.152020086046
              std dev =       0.590234072813
             le_variance =       0.348376260709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721127197215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211271972153       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211272179326       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211272286112       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211272698750       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211272678910       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211272747950       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211272715990       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211272707552       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.489269e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211271972153       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211272026099       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211272051561       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211272161758       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211272156322       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211272172506       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211272164824       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211272162842       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.725090e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211271972153       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211271985781       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211271992070       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211272020091       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211272018701       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211272022681       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211272020783       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211272020297       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 9.312263e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0401e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.130046e-01 1 1  ON 0
 uu_1                 4.835536e-02 1 1  ON 1
 uu_2                -4.950414e-02 1 1  ON 2
 uu_3                -1.044107e-01 1 1  ON 3
 uu_4                -1.348316e-01 1 1  ON 4
 uu_5                -1.378792e-01 1 1  ON 5
 uu_6                -1.122187e-01 1 1  ON 6
 uu_7                -3.944443e-02 1 1  ON 7
 uu_8                 9.978809e-02 1 1  ON 8
 uu_9                 1.222316e-01 1 1  ON 9
 ud_0                 3.560210e-01 1 1  ON 10
 ud_1                 9.343953e-02 1 1  ON 11
 ud_2                -1.738003e-02 1 1  ON 12
 ud_3                -7.670070e-02 1 1  ON 13
 ud_4                -1.233420e-01 1 1  ON 14
 ud_5                -1.545986e-01 1 1  ON 15
 ud_6                -1.563278e-01 1 1  ON 16
 ud_7                -1.120606e-01 1 1  ON 17
 ud_8                 3.239815e-03 1 1  ON 18
 ud_9                 9.331975e-02 1 1  ON 19
 eO_0                -7.667857e-01 1 1  ON 20
 eO_1                -4.439583e-01 1 1  ON 21
 eO_2                -3.316360e-02 1 1  ON 22
 eO_3                 2.161526e-01 1 1  ON 23
 eO_4                 2.983279e-01 1 1  ON 24
 eO_5                 3.078633e-01 1 1  ON 25
 eO_6                 2.503492e-01 1 1  ON 26
 eO_7                 1.131745e-01 1 1  ON 27
 eO_8                 2.822554e-02 1 1  ON 28
 eO_9                 1.877340e-02 1 1  ON 29
eH1_0                -1.831379e-01 1 1  ON 30
eH1_1                -1.045851e-01 1 1  ON 31
eH1_2                -6.297516e-02 1 1  ON 32
eH1_3                -2.596810e-02 1 1  ON 33
eH1_4                 1.969247e-02 1 1  ON 34
eH1_5                 3.582690e-02 1 1  ON 35
eH1_6                 7.813099e-02 1 1  ON 36
eH1_7                 1.104816e-01 1 1  ON 37
eH1_8                 9.200625e-02 1 1  ON 38
eH1_9                 2.489670e-02 1 1  ON 39
eH2_0                -1.837821e-01 1 1  ON 40
eH2_1                -1.054491e-01 1 1  ON 41
eH2_2                -6.372361e-02 1 1  ON 42
eH2_3                -2.659102e-02 1 1  ON 43
eH2_4                 1.862326e-02 1 1  ON 44
eH2_5                 3.499577e-02 1 1  ON 45
eH2_6                 7.868896e-02 1 1  ON 46
eH2_7                 1.135413e-01 1 1  ON 47
eH2_8                 9.458758e-02 1 1  ON 48
eH2_9                 2.672162e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2215
    reference variance = 0.307048
====================================================
  Execution time = 3.0917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.0000e+06
  Execution time = 2.6646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336838512006
                                         uncertainty =       0.002380591326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336838512006
                                         uncertainty =       0.002380591326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410349799
  error estimate for blocks of size 2^( 2) =       0.000421139940
  error estimate for blocks of size 2^( 3) =       0.000431029964
  error estimate for blocks of size 2^( 4) =       0.000438672559
  error estimate for blocks of size 2^( 5) =       0.000441832122
  error estimate for blocks of size 2^( 6) =       0.000444241215
  error estimate for blocks of size 2^( 7) =       0.000446964754

      target function =                  N/A
              le_mean =     -17.211567538371
             les_mean =     296.574830875203
             stat err =       0.000442927663
             autocorr =       1.165083786332
              std dev =       0.580322251583
             le_variance =       0.336773915683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336842855495
                                         uncertainty =       0.002380639527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336842855495
                                         uncertainty =       0.002380639527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410352439
  error estimate for blocks of size 2^( 2) =       0.000421142380
  error estimate for blocks of size 2^( 3) =       0.000431032277
  error estimate for blocks of size 2^( 4) =       0.000438674789
  error estimate for blocks of size 2^( 5) =       0.000441834656
  error estimate for blocks of size 2^( 6) =       0.000444243550
  error estimate for blocks of size 2^( 7) =       0.000446968482

      target function =                  N/A
              le_mean =     -17.211567674685
             les_mean =     296.574839901054
             stat err =       0.000442930369
             autocorr =       1.165083032942
              std dev =       0.580325985286
             le_variance =       0.336778249198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336839811846
                                         uncertainty =       0.002380610806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336839811846
                                         uncertainty =       0.002380610806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410350588
  error estimate for blocks of size 2^( 2) =       0.000421140663
  error estimate for blocks of size 2^( 3) =       0.000431030660
  error estimate for blocks of size 2^( 4) =       0.000438673238
  error estimate for blocks of size 2^( 5) =       0.000441832996
  error estimate for blocks of size 2^( 6) =       0.000444241967
  error estimate for blocks of size 2^( 7) =       0.000446966274

      target function =                  N/A
              le_mean =     -17.211567608934
             les_mean =     296.574834598997
             stat err =       0.000442928619
             autocorr =       1.165084335269
              std dev =       0.580323367153
             le_variance =       0.336775210464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336838641877
                                         uncertainty =       0.002380593600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336838641877
                                         uncertainty =       0.002380593600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410349878
  error estimate for blocks of size 2^( 2) =       0.000421140012
  error estimate for blocks of size 2^( 3) =       0.000431030033
  error estimate for blocks of size 2^( 4) =       0.000438672627
  error estimate for blocks of size 2^( 5) =       0.000441832216
  error estimate for blocks of size 2^( 6) =       0.000444241293
  error estimate for blocks of size 2^( 7) =       0.000446964931

      target function =                  N/A
              le_mean =     -17.211567547023
             les_mean =     296.574831302267
             stat err =       0.000442927767
             autocorr =       1.165083887424
              std dev =       0.580322362933
             le_variance =       0.336774044920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211567538371        initial
     3.8147e+00     3.8147e+01             1.4893e-04       -17.211567674685  <--
     1.5259e+01     1.5259e+02             3.7251e-05       -17.211567608934
     6.1035e+01     6.1035e+02             9.3123e-06       -17.211567547023

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.4308e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.130539e-01 1 1  ON 0
 uu_1                 4.835731e-02 1 1  ON 1
 uu_2                -4.949907e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348454e-01 1 1  ON 4
 uu_5                -1.379070e-01 1 1  ON 5
 uu_6                -1.122333e-01 1 1  ON 6
 uu_7                -3.946493e-02 1 1  ON 7
 uu_8                 9.977389e-02 1 1  ON 8
 uu_9                 1.222480e-01 1 1  ON 9
 ud_0                 3.560393e-01 1 1  ON 10
 ud_1                 9.345488e-02 1 1  ON 11
 ud_2                -1.735289e-02 1 1  ON 12
 ud_3                -7.670476e-02 1 1  ON 13
 ud_4                -1.233410e-01 1 1  ON 14
 ud_5                -1.546486e-01 1 1  ON 15
 ud_6                -1.563528e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                 3.224988e-03 1 1  ON 18
 ud_9                 9.332802e-02 1 1  ON 19
 eO_0                -7.668974e-01 1 1  ON 20
 eO_1                -4.440377e-01 1 1  ON 21
 eO_2                -3.319391e-02 1 1  ON 22
 eO_3                 2.161917e-01 1 1  ON 23
 eO_4                 2.984284e-01 1 1  ON 24
 eO_5                 3.078905e-01 1 1  ON 25
 eO_6                 2.503643e-01 1 1  ON 26
 eO_7                 1.132004e-01 1 1  ON 27
 eO_8                 2.823114e-02 1 1  ON 28
 eO_9                 1.877718e-02 1 1  ON 29
eH1_0                -1.831409e-01 1 1  ON 30
eH1_1                -1.045982e-01 1 1  ON 31
eH1_2                -6.298421e-02 1 1  ON 32
eH1_3                -2.597123e-02 1 1  ON 33
eH1_4                 1.969124e-02 1 1  ON 34
eH1_5                 3.582397e-02 1 1  ON 35
eH1_6                 7.813347e-02 1 1  ON 36
eH1_7                 1.104798e-01 1 1  ON 37
eH1_8                 9.202277e-02 1 1  ON 38
eH1_9                 2.490387e-02 1 1  ON 39
eH2_0                -1.838043e-01 1 1  ON 40
eH2_1                -1.054869e-01 1 1  ON 41
eH2_2                -6.369669e-02 1 1  ON 42
eH2_3                -2.661366e-02 1 1  ON 43
eH2_4                 1.862696e-02 1 1  ON 44
eH2_5                 3.500726e-02 1 1  ON 45
eH2_6                 7.870928e-02 1 1  ON 46
eH2_7                 1.135403e-01 1 1  ON 47
eH2_8                 9.460205e-02 1 1  ON 48
eH2_9                 2.672693e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.208
    reference variance = 0.24812
====================================================
  Execution time = 3.1608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5359e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353602411362
                                         uncertainty =       0.007549788621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353602411362
                                         uncertainty =       0.007549788621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420468014
  error estimate for blocks of size 2^( 2) =       0.000431134276
  error estimate for blocks of size 2^( 3) =       0.000440568958
  error estimate for blocks of size 2^( 4) =       0.000448003868
  error estimate for blocks of size 2^( 5) =       0.000451216394
  error estimate for blocks of size 2^( 6) =       0.000454915052
  error estimate for blocks of size 2^( 7) =       0.000455939151

      target function =                  N/A
              le_mean =     -17.210760042888
             les_mean =     296.563847778792
             stat err =       0.000452518616
             autocorr =       1.158262441509
              std dev =       0.594631568057
             le_variance =       0.353586701729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721076004289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210760042888       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210760492454       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210760802034       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210760620715       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210761905666       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210761665942       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210761831124       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210761881162       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 6.015779e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210760042888       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210760172214       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210760275030       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210760196369       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210760529199       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210760472159       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210760506083       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210760520086       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.528489e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210760042888       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210760076485       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210760104290       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210760082027       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210760165359       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210760151785       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210760159815       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210760163494       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.836442e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0392e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.130942e-01 1 1  ON 0
 uu_1                 4.838008e-02 1 1  ON 1
 uu_2                -4.947374e-02 1 1  ON 2
 uu_3                -1.044111e-01 1 1  ON 3
 uu_4                -1.348845e-01 1 1  ON 4
 uu_5                -1.379290e-01 1 1  ON 5
 uu_6                -1.122635e-01 1 1  ON 6
 uu_7                -3.949764e-02 1 1  ON 7
 uu_8                 9.976578e-02 1 1  ON 8
 uu_9                 1.222652e-01 1 1  ON 9
 ud_0                 3.560883e-01 1 1  ON 10
 ud_1                 9.347573e-02 1 1  ON 11
 ud_2                -1.733918e-02 1 1  ON 12
 ud_3                -7.670510e-02 1 1  ON 13
 ud_4                -1.233670e-01 1 1  ON 14
 ud_5                -1.546539e-01 1 1  ON 15
 ud_6                -1.563687e-01 1 1  ON 16
 ud_7                -1.120720e-01 1 1  ON 17
 ud_8                 3.190061e-03 1 1  ON 18
 ud_9                 9.332639e-02 1 1  ON 19
 eO_0                -7.670294e-01 1 1  ON 20
 eO_1                -4.441618e-01 1 1  ON 21
 eO_2                -3.327200e-02 1 1  ON 22
 eO_3                 2.162649e-01 1 1  ON 23
 eO_4                 2.985813e-01 1 1  ON 24
 eO_5                 3.079422e-01 1 1  ON 25
 eO_6                 2.503829e-01 1 1  ON 26
 eO_7                 1.132289e-01 1 1  ON 27
 eO_8                 2.823793e-02 1 1  ON 28
 eO_9                 1.877894e-02 1 1  ON 29
eH1_0                -1.831701e-01 1 1  ON 30
eH1_1                -1.045965e-01 1 1  ON 31
eH1_2                -6.296898e-02 1 1  ON 32
eH1_3                -2.596557e-02 1 1  ON 33
eH1_4                 1.966916e-02 1 1  ON 34
eH1_5                 3.583374e-02 1 1  ON 35
eH1_6                 7.813365e-02 1 1  ON 36
eH1_7                 1.104743e-01 1 1  ON 37
eH1_8                 9.203947e-02 1 1  ON 38
eH1_9                 2.491027e-02 1 1  ON 39
eH2_0                -1.838247e-01 1 1  ON 40
eH2_1                -1.055093e-01 1 1  ON 41
eH2_2                -6.369709e-02 1 1  ON 42
eH2_3                -2.660108e-02 1 1  ON 43
eH2_4                 1.863739e-02 1 1  ON 44
eH2_5                 3.499960e-02 1 1  ON 45
eH2_6                 7.871776e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461841e-02 1 1  ON 48
eH2_9                 2.673179e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.0972
    reference variance = 0.506207
====================================================
  Execution time = 3.1063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4113e-01
  Total weights = 2.0000e+06
  Execution time = 2.6609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341199265134
                                         uncertainty =       0.005778717755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341199265134
                                         uncertainty =       0.005778717755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412976602
  error estimate for blocks of size 2^( 2) =       0.000423420107
  error estimate for blocks of size 2^( 3) =       0.000432609801
  error estimate for blocks of size 2^( 4) =       0.000439248743
  error estimate for blocks of size 2^( 5) =       0.000442501546
  error estimate for blocks of size 2^( 6) =       0.000444860406
  error estimate for blocks of size 2^( 7) =       0.000448100387

      target function =                  N/A
              le_mean =     -17.211784703019
             les_mean =     296.586631839809
             stat err =       0.000443677771
             autocorr =       1.154208975792
              std dev =       0.584037111209
             le_variance =       0.341099347269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341296645943
                                         uncertainty =       0.005781208294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341296645943
                                         uncertainty =       0.005781208294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413035517
  error estimate for blocks of size 2^( 2) =       0.000423475153
  error estimate for blocks of size 2^( 3) =       0.000432660501
  error estimate for blocks of size 2^( 4) =       0.000439298001
  error estimate for blocks of size 2^( 5) =       0.000442551379
  error estimate for blocks of size 2^( 6) =       0.000444909031
  error estimate for blocks of size 2^( 7) =       0.000448145969

      target function =                  N/A
              le_mean =     -17.211784613632
             les_mean =     296.586726091969
             stat err =       0.000443726095
             autocorr =       1.154131097711
              std dev =       0.584120429796
             le_variance =       0.341196676505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341257255065
                                         uncertainty =       0.005780199131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341257255065
                                         uncertainty =       0.005780199131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413011687
  error estimate for blocks of size 2^( 2) =       0.000423452942
  error estimate for blocks of size 2^( 3) =       0.000432640301
  error estimate for blocks of size 2^( 4) =       0.000439278507
  error estimate for blocks of size 2^( 5) =       0.000442531673
  error estimate for blocks of size 2^( 6) =       0.000444889723
  error estimate for blocks of size 2^( 7) =       0.000448127801

      target function =                  N/A
              le_mean =     -17.211784616534
             les_mean =     296.586686821820
             stat err =       0.000443706926
             autocorr =       1.154164560250
              std dev =       0.584086728517
             le_variance =       0.341157306430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341206959947
                                         uncertainty =       0.005778913824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341206959947
                                         uncertainty =       0.005778913824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412981257
  error estimate for blocks of size 2^( 2) =       0.000423424465
  error estimate for blocks of size 2^( 3) =       0.000432613858
  error estimate for blocks of size 2^( 4) =       0.000439252707
  error estimate for blocks of size 2^( 5) =       0.000442505557
  error estimate for blocks of size 2^( 6) =       0.000444864307
  error estimate for blocks of size 2^( 7) =       0.000448104034

      target function =                  N/A
              le_mean =     -17.211784687967
             les_mean =     296.586639012352
             stat err =       0.000443681651
             autocorr =       1.154203143315
              std dev =       0.584043695271
             le_variance =       0.341107037985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211784703019        initial  <--
     9.5367e-01     9.5367e+00             6.0158e-04       -17.211784613632
     3.8147e+00     3.8147e+01             1.5285e-04       -17.211784616534
     1.5259e+01     1.5259e+02             3.8364e-05       -17.211784687967

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3751
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.130539e-01 1 1  ON 0
 uu_1                 4.835731e-02 1 1  ON 1
 uu_2                -4.949907e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348454e-01 1 1  ON 4
 uu_5                -1.379070e-01 1 1  ON 5
 uu_6                -1.122333e-01 1 1  ON 6
 uu_7                -3.946493e-02 1 1  ON 7
 uu_8                 9.977389e-02 1 1  ON 8
 uu_9                 1.222480e-01 1 1  ON 9
 ud_0                 3.560393e-01 1 1  ON 10
 ud_1                 9.345488e-02 1 1  ON 11
 ud_2                -1.735289e-02 1 1  ON 12
 ud_3                -7.670476e-02 1 1  ON 13
 ud_4                -1.233410e-01 1 1  ON 14
 ud_5                -1.546486e-01 1 1  ON 15
 ud_6                -1.563528e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                 3.224988e-03 1 1  ON 18
 ud_9                 9.332802e-02 1 1  ON 19
 eO_0                -7.668974e-01 1 1  ON 20
 eO_1                -4.440377e-01 1 1  ON 21
 eO_2                -3.319391e-02 1 1  ON 22
 eO_3                 2.161917e-01 1 1  ON 23
 eO_4                 2.984284e-01 1 1  ON 24
 eO_5                 3.078905e-01 1 1  ON 25
 eO_6                 2.503643e-01 1 1  ON 26
 eO_7                 1.132004e-01 1 1  ON 27
 eO_8                 2.823114e-02 1 1  ON 28
 eO_9                 1.877718e-02 1 1  ON 29
eH1_0                -1.831409e-01 1 1  ON 30
eH1_1                -1.045982e-01 1 1  ON 31
eH1_2                -6.298421e-02 1 1  ON 32
eH1_3                -2.597123e-02 1 1  ON 33
eH1_4                 1.969124e-02 1 1  ON 34
eH1_5                 3.582397e-02 1 1  ON 35
eH1_6                 7.813347e-02 1 1  ON 36
eH1_7                 1.104798e-01 1 1  ON 37
eH1_8                 9.202277e-02 1 1  ON 38
eH1_9                 2.490387e-02 1 1  ON 39
eH2_0                -1.838043e-01 1 1  ON 40
eH2_1                -1.054869e-01 1 1  ON 41
eH2_2                -6.369669e-02 1 1  ON 42
eH2_3                -2.661366e-02 1 1  ON 43
eH2_4                 1.862696e-02 1 1  ON 44
eH2_5                 3.500726e-02 1 1  ON 45
eH2_6                 7.870928e-02 1 1  ON 46
eH2_7                 1.135403e-01 1 1  ON 47
eH2_8                 9.460205e-02 1 1  ON 48
eH2_9                 2.672693e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1218
    reference variance = 0.339866
====================================================
  Execution time = 3.1666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4548e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345474002693
                                         uncertainty =       0.004231039947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345474002693
                                         uncertainty =       0.004231039947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415622200
  error estimate for blocks of size 2^( 2) =       0.000426152151
  error estimate for blocks of size 2^( 3) =       0.000436162310
  error estimate for blocks of size 2^( 4) =       0.000443024800
  error estimate for blocks of size 2^( 5) =       0.000447564969
  error estimate for blocks of size 2^( 6) =       0.000447939177
  error estimate for blocks of size 2^( 7) =       0.000448296716

      target function =                  N/A
              le_mean =     -17.211331320253
             les_mean =     296.575409268832
             stat err =       0.000446706415
             autocorr =       1.155172671474
              std dev =       0.587778551879
             le_variance =       0.345483626049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721133132025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211331320253       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211331332141       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211331311908       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211331344542       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211331342113       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211331406406       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211331428852       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211331432831       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 6.806491e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211331320253       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211331323264       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211331318068       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211331325815       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211331325314       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211331340859       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211331346732       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.685866e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211331320253       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211331321008       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211331319701       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211331321609       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211331321492       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211331325343       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211331326828       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 4.217324e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239266 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0526e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.130583e-01 1 1  ON 0
 uu_1                 4.835708e-02 1 1  ON 1
 uu_2                -4.949738e-02 1 1  ON 2
 uu_3                -1.044242e-01 1 1  ON 3
 uu_4                -1.348448e-01 1 1  ON 4
 uu_5                -1.379084e-01 1 1  ON 5
 uu_6                -1.122350e-01 1 1  ON 6
 uu_7                -3.946742e-02 1 1  ON 7
 uu_8                 9.977211e-02 1 1  ON 8
 uu_9                 1.222494e-01 1 1  ON 9
 ud_0                 3.560435e-01 1 1  ON 10
 ud_1                 9.346130e-02 1 1  ON 11
 ud_2                -1.734977e-02 1 1  ON 12
 ud_3                -7.670639e-02 1 1  ON 13
 ud_4                -1.233434e-01 1 1  ON 14
 ud_5                -1.546526e-01 1 1  ON 15
 ud_6                -1.563565e-01 1 1  ON 16
 ud_7                -1.120622e-01 1 1  ON 17
 ud_8                 3.221746e-03 1 1  ON 18
 ud_9                 9.332818e-02 1 1  ON 19
 eO_0                -7.669143e-01 1 1  ON 20
 eO_1                -4.440508e-01 1 1  ON 21
 eO_2                -3.319927e-02 1 1  ON 22
 eO_3                 2.162020e-01 1 1  ON 23
 eO_4                 2.984425e-01 1 1  ON 24
 eO_5                 3.078957e-01 1 1  ON 25
 eO_6                 2.503662e-01 1 1  ON 26
 eO_7                 1.132033e-01 1 1  ON 27
 eO_8                 2.823166e-02 1 1  ON 28
 eO_9                 1.877738e-02 1 1  ON 29
eH1_0                -1.831436e-01 1 1  ON 30
eH1_1                -1.045989e-01 1 1  ON 31
eH1_2                -6.298463e-02 1 1  ON 32
eH1_3                -2.597008e-02 1 1  ON 33
eH1_4                 1.969053e-02 1 1  ON 34
eH1_5                 3.582282e-02 1 1  ON 35
eH1_6                 7.813512e-02 1 1  ON 36
eH1_7                 1.104804e-01 1 1  ON 37
eH1_8                 9.202461e-02 1 1  ON 38
eH1_9                 2.490429e-02 1 1  ON 39
eH2_0                -1.838060e-01 1 1  ON 40
eH2_1                -1.054868e-01 1 1  ON 41
eH2_2                -6.369548e-02 1 1  ON 42
eH2_3                -2.661132e-02 1 1  ON 43
eH2_4                 1.862484e-02 1 1  ON 44
eH2_5                 3.500589e-02 1 1  ON 45
eH2_6                 7.870966e-02 1 1  ON 46
eH2_7                 1.135392e-01 1 1  ON 47
eH2_8                 9.460358e-02 1 1  ON 48
eH2_9                 2.672752e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2397
    reference variance = 0.310591
====================================================
  Execution time = 3.0890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7210e+01
  VMC Evar = 3.4506e-01
  Total weights = 2.0000e+06
  Execution time = 2.6695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344898448440
                                         uncertainty =       0.010157809454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344898448440
                                         uncertainty =       0.010157809454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415364371
  error estimate for blocks of size 2^( 2) =       0.000426021810
  error estimate for blocks of size 2^( 3) =       0.000435045293
  error estimate for blocks of size 2^( 4) =       0.000441950015
  error estimate for blocks of size 2^( 5) =       0.000445215067
  error estimate for blocks of size 2^( 6) =       0.000447977200
  error estimate for blocks of size 2^( 7) =       0.000450095290

      target function =                  N/A
              le_mean =     -17.210314671540
             les_mean =     296.539986042333
             stat err =       0.000446309393
             autocorr =       1.154552196272
              std dev =       0.587413926839
             le_variance =       0.345055121444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344901029064
                                         uncertainty =       0.010157782623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344901029064
                                         uncertainty =       0.010157782623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415365939
  error estimate for blocks of size 2^( 2) =       0.000426023227
  error estimate for blocks of size 2^( 3) =       0.000435046394
  error estimate for blocks of size 2^( 4) =       0.000441950839
  error estimate for blocks of size 2^( 5) =       0.000445215727
  error estimate for blocks of size 2^( 6) =       0.000447977553
  error estimate for blocks of size 2^( 7) =       0.000450095868

      target function =                  N/A
              le_mean =     -17.210314636784
             les_mean =     296.539987450700
             stat err =       0.000446309997
             autocorr =       1.154546605782
              std dev =       0.587416143906
             le_variance =       0.345057726121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344899192395
                                         uncertainty =       0.010157791094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344899192395
                                         uncertainty =       0.010157791094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415364826
  error estimate for blocks of size 2^( 2) =       0.000426022212
  error estimate for blocks of size 2^( 3) =       0.000435045558
  error estimate for blocks of size 2^( 4) =       0.000441950148
  error estimate for blocks of size 2^( 5) =       0.000445215131
  error estimate for blocks of size 2^( 6) =       0.000447977105
  error estimate for blocks of size 2^( 7) =       0.000450095301

      target function =                  N/A
              le_mean =     -17.210314654558
             les_mean =     296.539986213854
             stat err =       0.000446309421
             autocorr =       1.154549812760
              std dev =       0.587414570375
             le_variance =       0.345055877489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344898532482
                                         uncertainty =       0.010157806945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344898532482
                                         uncertainty =       0.010157806945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415364423
  error estimate for blocks of size 2^( 2) =       0.000426021855
  error estimate for blocks of size 2^( 3) =       0.000435045321
  error estimate for blocks of size 2^( 4) =       0.000441950026
  error estimate for blocks of size 2^( 5) =       0.000445215070
  error estimate for blocks of size 2^( 6) =       0.000447977183
  error estimate for blocks of size 2^( 7) =       0.000450095286

      target function =                  N/A
              le_mean =     -17.210314669354
             les_mean =     296.539986052636
             stat err =       0.000446309391
             autocorr =       1.154551902696
              std dev =       0.587413999661
             le_variance =       0.345055206998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210314671540        initial  <--
     9.5367e+00     9.5367e+01             6.8065e-05       -17.210314636784
     3.8147e+01     3.8147e+02             1.6859e-05       -17.210314654558
     1.5259e+02     1.5259e+03             4.2173e-06       -17.210314669354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6430
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.130539e-01 1 1  ON 0
 uu_1                 4.835731e-02 1 1  ON 1
 uu_2                -4.949907e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348454e-01 1 1  ON 4
 uu_5                -1.379070e-01 1 1  ON 5
 uu_6                -1.122333e-01 1 1  ON 6
 uu_7                -3.946493e-02 1 1  ON 7
 uu_8                 9.977389e-02 1 1  ON 8
 uu_9                 1.222480e-01 1 1  ON 9
 ud_0                 3.560393e-01 1 1  ON 10
 ud_1                 9.345488e-02 1 1  ON 11
 ud_2                -1.735289e-02 1 1  ON 12
 ud_3                -7.670476e-02 1 1  ON 13
 ud_4                -1.233410e-01 1 1  ON 14
 ud_5                -1.546486e-01 1 1  ON 15
 ud_6                -1.563528e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                 3.224988e-03 1 1  ON 18
 ud_9                 9.332802e-02 1 1  ON 19
 eO_0                -7.668974e-01 1 1  ON 20
 eO_1                -4.440377e-01 1 1  ON 21
 eO_2                -3.319391e-02 1 1  ON 22
 eO_3                 2.161917e-01 1 1  ON 23
 eO_4                 2.984284e-01 1 1  ON 24
 eO_5                 3.078905e-01 1 1  ON 25
 eO_6                 2.503643e-01 1 1  ON 26
 eO_7                 1.132004e-01 1 1  ON 27
 eO_8                 2.823114e-02 1 1  ON 28
 eO_9                 1.877718e-02 1 1  ON 29
eH1_0                -1.831409e-01 1 1  ON 30
eH1_1                -1.045982e-01 1 1  ON 31
eH1_2                -6.298421e-02 1 1  ON 32
eH1_3                -2.597123e-02 1 1  ON 33
eH1_4                 1.969124e-02 1 1  ON 34
eH1_5                 3.582397e-02 1 1  ON 35
eH1_6                 7.813347e-02 1 1  ON 36
eH1_7                 1.104798e-01 1 1  ON 37
eH1_8                 9.202277e-02 1 1  ON 38
eH1_9                 2.490387e-02 1 1  ON 39
eH2_0                -1.838043e-01 1 1  ON 40
eH2_1                -1.054869e-01 1 1  ON 41
eH2_2                -6.369669e-02 1 1  ON 42
eH2_3                -2.661366e-02 1 1  ON 43
eH2_4                 1.862696e-02 1 1  ON 44
eH2_5                 3.500726e-02 1 1  ON 45
eH2_6                 7.870928e-02 1 1  ON 46
eH2_7                 1.135403e-01 1 1  ON 47
eH2_8                 9.460205e-02 1 1  ON 48
eH2_9                 2.672693e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1698
    reference variance = 0.302732
====================================================
  Execution time = 3.1498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352449256070
                                         uncertainty =       0.009838169432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352449256070
                                         uncertainty =       0.009838169432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419786349
  error estimate for blocks of size 2^( 2) =       0.000430390748
  error estimate for blocks of size 2^( 3) =       0.000439794744
  error estimate for blocks of size 2^( 4) =       0.000446082255
  error estimate for blocks of size 2^( 5) =       0.000449392823
  error estimate for blocks of size 2^( 6) =       0.000452427046
  error estimate for blocks of size 2^( 7) =       0.000454872272

      target function =                  N/A
              le_mean =     -17.211832513607
             les_mean =     296.599619457338
             stat err =       0.000450693599
             autocorr =       1.152673098943
              std dev =       0.593667547621
             le_variance =       0.352441157099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183251361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211832513607       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211832519039       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211832518607       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211832524223       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211832534072       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211832534901       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211832533879       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 6.155440e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211832513607       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211832514967       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211832514858       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211832516263       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211832518728       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211832518935       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211832518680       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.539026e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211832513607       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211832513947       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211832513920       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211832514271       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211832514887       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211832514939       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211832514877       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 3.847670e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0304e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.130544e-01 1 1  ON 0
 uu_1                 4.835776e-02 1 1  ON 1
 uu_2                -4.949881e-02 1 1  ON 2
 uu_3                -1.044223e-01 1 1  ON 3
 uu_4                -1.348456e-01 1 1  ON 4
 uu_5                -1.379073e-01 1 1  ON 5
 uu_6                -1.122338e-01 1 1  ON 6
 uu_7                -3.946522e-02 1 1  ON 7
 uu_8                 9.977374e-02 1 1  ON 8
 uu_9                 1.222482e-01 1 1  ON 9
 ud_0                 3.560398e-01 1 1  ON 10
 ud_1                 9.345501e-02 1 1  ON 11
 ud_2                -1.735283e-02 1 1  ON 12
 ud_3                -7.670476e-02 1 1  ON 13
 ud_4                -1.233412e-01 1 1  ON 14
 ud_5                -1.546488e-01 1 1  ON 15
 ud_6                -1.563530e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                 3.224727e-03 1 1  ON 18
 ud_9                 9.332804e-02 1 1  ON 19
 eO_0                -7.668989e-01 1 1  ON 20
 eO_1                -4.440392e-01 1 1  ON 21
 eO_2                -3.319433e-02 1 1  ON 22
 eO_3                 2.161923e-01 1 1  ON 23
 eO_4                 2.984299e-01 1 1  ON 24
 eO_5                 3.078911e-01 1 1  ON 25
 eO_6                 2.503645e-01 1 1  ON 26
 eO_7                 1.132007e-01 1 1  ON 27
 eO_8                 2.823120e-02 1 1  ON 28
 eO_9                 1.877721e-02 1 1  ON 29
eH1_0                -1.831409e-01 1 1  ON 30
eH1_1                -1.045985e-01 1 1  ON 31
eH1_2                -6.298419e-02 1 1  ON 32
eH1_3                -2.597134e-02 1 1  ON 33
eH1_4                 1.969118e-02 1 1  ON 34
eH1_5                 3.582397e-02 1 1  ON 35
eH1_6                 7.813362e-02 1 1  ON 36
eH1_7                 1.104799e-01 1 1  ON 37
eH1_8                 9.202299e-02 1 1  ON 38
eH1_9                 2.490393e-02 1 1  ON 39
eH2_0                -1.838043e-01 1 1  ON 40
eH2_1                -1.054870e-01 1 1  ON 41
eH2_2                -6.369674e-02 1 1  ON 42
eH2_3                -2.661380e-02 1 1  ON 43
eH2_4                 1.862706e-02 1 1  ON 44
eH2_5                 3.500729e-02 1 1  ON 45
eH2_6                 7.870935e-02 1 1  ON 46
eH2_7                 1.135402e-01 1 1  ON 47
eH2_8                 9.460221e-02 1 1  ON 48
eH2_9                 2.672698e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.0476
    reference variance = 0.192772
====================================================
  Execution time = 3.0790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.6437e-01
  Total weights = 2.0000e+06
  Execution time = 2.6592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364432083913
                                         uncertainty =       0.012918844858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364432083913
                                         uncertainty =       0.012918844858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426831745
  error estimate for blocks of size 2^( 2) =       0.000436573682
  error estimate for blocks of size 2^( 3) =       0.000445410275
  error estimate for blocks of size 2^( 4) =       0.000451565719
  error estimate for blocks of size 2^( 5) =       0.000455012601
  error estimate for blocks of size 2^( 6) =       0.000457959325
  error estimate for blocks of size 2^( 7) =       0.000460039867

      target function =                  N/A
              le_mean =     -17.211398587008
             les_mean =     296.596611816317
             stat err =       0.000456144378
             autocorr =       1.142066068341
              std dev =       0.603631243108
             le_variance =       0.364370677656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364434126658
                                         uncertainty =       0.012918934334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364434126658
                                         uncertainty =       0.012918934334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426832941
  error estimate for blocks of size 2^( 2) =       0.000436574820
  error estimate for blocks of size 2^( 3) =       0.000445411350
  error estimate for blocks of size 2^( 4) =       0.000451566742
  error estimate for blocks of size 2^( 5) =       0.000455013595
  error estimate for blocks of size 2^( 6) =       0.000457960307
  error estimate for blocks of size 2^( 7) =       0.000460040869

      target function =                  N/A
              le_mean =     -17.211398590948
             les_mean =     296.596613993787
             stat err =       0.000456145378
             autocorr =       1.142064676584
              std dev =       0.603632934393
             le_variance =       0.364372719484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364433107283
                                         uncertainty =       0.012918889675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364433107283
                                         uncertainty =       0.012918889675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426832344
  error estimate for blocks of size 2^( 2) =       0.000436574252
  error estimate for blocks of size 2^( 3) =       0.000445410814
  error estimate for blocks of size 2^( 4) =       0.000451566231
  error estimate for blocks of size 2^( 5) =       0.000455013099
  error estimate for blocks of size 2^( 6) =       0.000457959817
  error estimate for blocks of size 2^( 7) =       0.000460040369

      target function =                  N/A
              le_mean =     -17.211398588976
             les_mean =     296.596612906977
             stat err =       0.000456144879
             autocorr =       1.142065371505
              std dev =       0.603632090405
             le_variance =       0.364371700567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364432211896
                                         uncertainty =       0.012918850463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364432211896
                                         uncertainty =       0.012918850463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426831820
  error estimate for blocks of size 2^( 2) =       0.000436573753
  error estimate for blocks of size 2^( 3) =       0.000445410342
  error estimate for blocks of size 2^( 4) =       0.000451565783
  error estimate for blocks of size 2^( 5) =       0.000455012664
  error estimate for blocks of size 2^( 6) =       0.000457959387
  error estimate for blocks of size 2^( 7) =       0.000460039930

      target function =                  N/A
              le_mean =     -17.211398587253
             les_mean =     296.596611952701
             stat err =       0.000456144441
             autocorr =       1.142065981201
              std dev =       0.603631349071
             le_variance =       0.364370805581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211398587008        initial
     9.5367e+01     9.5367e+02             6.1554e-06       -17.211398590948  <--
     3.8147e+02     3.8147e+03             1.5390e-06       -17.211398588976
     1.5259e+03     1.5259e+04             3.8477e-07       -17.211398587253

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 4.4118e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.130559e-01 1 1  ON 0
 uu_1                 4.835912e-02 1 1  ON 1
 uu_2                -4.949804e-02 1 1  ON 2
 uu_3                -1.044226e-01 1 1  ON 3
 uu_4                -1.348460e-01 1 1  ON 4
 uu_5                -1.379085e-01 1 1  ON 5
 uu_6                -1.122354e-01 1 1  ON 6
 uu_7                -3.946610e-02 1 1  ON 7
 uu_8                 9.977331e-02 1 1  ON 8
 uu_9                 1.222488e-01 1 1  ON 9
 ud_0                 3.560412e-01 1 1  ON 10
 ud_1                 9.345541e-02 1 1  ON 11
 ud_2                -1.735264e-02 1 1  ON 12
 ud_3                -7.670475e-02 1 1  ON 13
 ud_4                -1.233418e-01 1 1  ON 14
 ud_5                -1.546493e-01 1 1  ON 15
 ud_6                -1.563537e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                 3.223944e-03 1 1  ON 18
 ud_9                 9.332809e-02 1 1  ON 19
 eO_0                -7.669034e-01 1 1  ON 20
 eO_1                -4.440437e-01 1 1  ON 21
 eO_2                -3.319558e-02 1 1  ON 22
 eO_3                 2.161942e-01 1 1  ON 23
 eO_4                 2.984346e-01 1 1  ON 24
 eO_5                 3.078928e-01 1 1  ON 25
 eO_6                 2.503653e-01 1 1  ON 26
 eO_7                 1.132016e-01 1 1  ON 27
 eO_8                 2.823136e-02 1 1  ON 28
 eO_9                 1.877730e-02 1 1  ON 29
eH1_0                -1.831411e-01 1 1  ON 30
eH1_1                -1.045994e-01 1 1  ON 31
eH1_2                -6.298413e-02 1 1  ON 32
eH1_3                -2.597166e-02 1 1  ON 33
eH1_4                 1.969102e-02 1 1  ON 34
eH1_5                 3.582394e-02 1 1  ON 35
eH1_6                 7.813405e-02 1 1  ON 36
eH1_7                 1.104801e-01 1 1  ON 37
eH1_8                 9.202366e-02 1 1  ON 38
eH1_9                 2.490410e-02 1 1  ON 39
eH2_0                -1.838043e-01 1 1  ON 40
eH2_1                -1.054875e-01 1 1  ON 41
eH2_2                -6.369688e-02 1 1  ON 42
eH2_3                -2.661422e-02 1 1  ON 43
eH2_4                 1.862736e-02 1 1  ON 44
eH2_5                 3.500739e-02 1 1  ON 45
eH2_6                 7.870956e-02 1 1  ON 46
eH2_7                 1.135400e-01 1 1  ON 47
eH2_8                 9.460266e-02 1 1  ON 48
eH2_9                 2.672715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4427e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.179724
====================================================
  Execution time = 3.1177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4771e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347691363870
                                         uncertainty =       0.008410726956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347691363870
                                         uncertainty =       0.008410726956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416960987
  error estimate for blocks of size 2^( 2) =       0.000427261266
  error estimate for blocks of size 2^( 3) =       0.000436961284
  error estimate for blocks of size 2^( 4) =       0.000444293770
  error estimate for blocks of size 2^( 5) =       0.000448485914
  error estimate for blocks of size 2^( 6) =       0.000450957187
  error estimate for blocks of size 2^( 7) =       0.000452845883

      target function =                  N/A
              le_mean =     -17.211497956632
             les_mean =     296.583374666672
             stat err =       0.000449145688
             autocorr =       1.160335623990
              std dev =       0.589671882799
             le_variance =       0.347712929363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721149795663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211497956633       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211497969276       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211497957339       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211497968904       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211497987848       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211497988631       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211497989938       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 2.449976e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211497956633       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211497959826       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211497956808       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211497959757       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211497964324       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211497964525       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211497964855       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 6.128048e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211497956633       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211497957433       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211497956676       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211497957418       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211497958549       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211497958599       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211497958681       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.532205e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0093e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.130590e-01 1 1  ON 0
 uu_1                 4.835996e-02 1 1  ON 1
 uu_2                -4.949753e-02 1 1  ON 2
 uu_3                -1.044224e-01 1 1  ON 3
 uu_4                -1.348469e-01 1 1  ON 4
 uu_5                -1.379093e-01 1 1  ON 5
 uu_6                -1.122367e-01 1 1  ON 6
 uu_7                -3.946785e-02 1 1  ON 7
 uu_8                 9.977248e-02 1 1  ON 8
 uu_9                 1.222493e-01 1 1  ON 9
 ud_0                 3.560430e-01 1 1  ON 10
 ud_1                 9.345693e-02 1 1  ON 11
 ud_2                -1.735285e-02 1 1  ON 12
 ud_3                -7.670443e-02 1 1  ON 13
 ud_4                -1.233428e-01 1 1  ON 14
 ud_5                -1.546498e-01 1 1  ON 15
 ud_6                -1.563540e-01 1 1  ON 16
 ud_7                -1.120624e-01 1 1  ON 17
 ud_8                 3.222532e-03 1 1  ON 18
 ud_9                 9.332796e-02 1 1  ON 19
 eO_0                -7.669095e-01 1 1  ON 20
 eO_1                -4.440486e-01 1 1  ON 21
 eO_2                -3.319777e-02 1 1  ON 22
 eO_3                 2.161966e-01 1 1  ON 23
 eO_4                 2.984407e-01 1 1  ON 24
 eO_5                 3.078952e-01 1 1  ON 25
 eO_6                 2.503661e-01 1 1  ON 26
 eO_7                 1.132027e-01 1 1  ON 27
 eO_8                 2.823155e-02 1 1  ON 28
 eO_9                 1.877734e-02 1 1  ON 29
eH1_0                -1.831421e-01 1 1  ON 30
eH1_1                -1.046003e-01 1 1  ON 31
eH1_2                -6.298272e-02 1 1  ON 32
eH1_3                -2.597113e-02 1 1  ON 33
eH1_4                 1.969063e-02 1 1  ON 34
eH1_5                 3.582320e-02 1 1  ON 35
eH1_6                 7.813458e-02 1 1  ON 36
eH1_7                 1.104798e-01 1 1  ON 37
eH1_8                 9.202418e-02 1 1  ON 38
eH1_9                 2.490427e-02 1 1  ON 39
eH2_0                -1.838054e-01 1 1  ON 40
eH2_1                -1.054880e-01 1 1  ON 41
eH2_2                -6.369628e-02 1 1  ON 42
eH2_3                -2.661428e-02 1 1  ON 43
eH2_4                 1.862818e-02 1 1  ON 44
eH2_5                 3.500685e-02 1 1  ON 45
eH2_6                 7.870940e-02 1 1  ON 46
eH2_7                 1.135398e-01 1 1  ON 47
eH2_8                 9.460347e-02 1 1  ON 48
eH2_9                 2.672736e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2684
    reference variance = 0.912983
====================================================
  Execution time = 3.0972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4234e-01
  Total weights = 2.0000e+06
  Execution time = 2.6592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342023077374
                                         uncertainty =       0.003335268078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342023077374
                                         uncertainty =       0.003335268078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413725113
  error estimate for blocks of size 2^( 2) =       0.000424549512
  error estimate for blocks of size 2^( 3) =       0.000433868957
  error estimate for blocks of size 2^( 4) =       0.000440254870
  error estimate for blocks of size 2^( 5) =       0.000443649258
  error estimate for blocks of size 2^( 6) =       0.000446283101
  error estimate for blocks of size 2^( 7) =       0.000446911057

      target function =                  N/A
              le_mean =     -17.211140830661
             les_mean =     296.565705459178
             stat err =       0.000444274571
             autocorr =       1.153132327754
              std dev =       0.585095665269
             le_variance =       0.342336937517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342029262458
                                         uncertainty =       0.003335328092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342029262458
                                         uncertainty =       0.003335328092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413728851
  error estimate for blocks of size 2^( 2) =       0.000424553024
  error estimate for blocks of size 2^( 3) =       0.000433872254
  error estimate for blocks of size 2^( 4) =       0.000440258027
  error estimate for blocks of size 2^( 5) =       0.000443652326
  error estimate for blocks of size 2^( 6) =       0.000446286094
  error estimate for blocks of size 2^( 7) =       0.000446914063

      target function =                  N/A
              le_mean =     -17.211140788174
             les_mean =     296.565710183003
             stat err =       0.000444277628
             autocorr =       1.153127354723
              std dev =       0.585100951817
             le_variance =       0.342343123817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342026189865
                                         uncertainty =       0.003335298196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342026189865
                                         uncertainty =       0.003335298196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413726994
  error estimate for blocks of size 2^( 2) =       0.000424551279
  error estimate for blocks of size 2^( 3) =       0.000433870616
  error estimate for blocks of size 2^( 4) =       0.000440256459
  error estimate for blocks of size 2^( 5) =       0.000443650802
  error estimate for blocks of size 2^( 6) =       0.000446284607
  error estimate for blocks of size 2^( 7) =       0.000446912569

      target function =                  N/A
              le_mean =     -17.211140808651
             les_mean =     296.565707814694
             stat err =       0.000444276109
             autocorr =       1.153129823821
              std dev =       0.585098325615
             le_variance =       0.342340050638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342023467029
                                         uncertainty =       0.003335271846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342023467029
                                         uncertainty =       0.003335271846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413725348
  error estimate for blocks of size 2^( 2) =       0.000424549733
  error estimate for blocks of size 2^( 3) =       0.000433869164
  error estimate for blocks of size 2^( 4) =       0.000440255069
  error estimate for blocks of size 2^( 5) =       0.000443649452
  error estimate for blocks of size 2^( 6) =       0.000446283289
  error estimate for blocks of size 2^( 7) =       0.000446911246

      target function =                  N/A
              le_mean =     -17.211140827879
             les_mean =     296.565705753176
             stat err =       0.000444274764
             autocorr =       1.153132014187
              std dev =       0.585095998321
             le_variance =       0.342337327251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211140830661        initial  <--
     2.3842e+01     2.3842e+02             2.4500e-05       -17.211140788174
     9.5367e+01     9.5367e+02             6.1280e-06       -17.211140808651
     3.8147e+02     3.8147e+03             1.5322e-06       -17.211140827879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2944
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.130559e-01 1 1  ON 0
 uu_1                 4.835912e-02 1 1  ON 1
 uu_2                -4.949804e-02 1 1  ON 2
 uu_3                -1.044226e-01 1 1  ON 3
 uu_4                -1.348460e-01 1 1  ON 4
 uu_5                -1.379085e-01 1 1  ON 5
 uu_6                -1.122354e-01 1 1  ON 6
 uu_7                -3.946610e-02 1 1  ON 7
 uu_8                 9.977331e-02 1 1  ON 8
 uu_9                 1.222488e-01 1 1  ON 9
 ud_0                 3.560412e-01 1 1  ON 10
 ud_1                 9.345541e-02 1 1  ON 11
 ud_2                -1.735264e-02 1 1  ON 12
 ud_3                -7.670475e-02 1 1  ON 13
 ud_4                -1.233418e-01 1 1  ON 14
 ud_5                -1.546493e-01 1 1  ON 15
 ud_6                -1.563537e-01 1 1  ON 16
 ud_7                -1.120618e-01 1 1  ON 17
 ud_8                 3.223944e-03 1 1  ON 18
 ud_9                 9.332809e-02 1 1  ON 19
 eO_0                -7.669034e-01 1 1  ON 20
 eO_1                -4.440437e-01 1 1  ON 21
 eO_2                -3.319558e-02 1 1  ON 22
 eO_3                 2.161942e-01 1 1  ON 23
 eO_4                 2.984346e-01 1 1  ON 24
 eO_5                 3.078928e-01 1 1  ON 25
 eO_6                 2.503653e-01 1 1  ON 26
 eO_7                 1.132016e-01 1 1  ON 27
 eO_8                 2.823136e-02 1 1  ON 28
 eO_9                 1.877730e-02 1 1  ON 29
eH1_0                -1.831411e-01 1 1  ON 30
eH1_1                -1.045994e-01 1 1  ON 31
eH1_2                -6.298413e-02 1 1  ON 32
eH1_3                -2.597166e-02 1 1  ON 33
eH1_4                 1.969102e-02 1 1  ON 34
eH1_5                 3.582394e-02 1 1  ON 35
eH1_6                 7.813405e-02 1 1  ON 36
eH1_7                 1.104801e-01 1 1  ON 37
eH1_8                 9.202366e-02 1 1  ON 38
eH1_9                 2.490410e-02 1 1  ON 39
eH2_0                -1.838043e-01 1 1  ON 40
eH2_1                -1.054875e-01 1 1  ON 41
eH2_2                -6.369688e-02 1 1  ON 42
eH2_3                -2.661422e-02 1 1  ON 43
eH2_4                 1.862736e-02 1 1  ON 44
eH2_5                 3.500739e-02 1 1  ON 45
eH2_6                 7.870956e-02 1 1  ON 46
eH2_7                 1.135400e-01 1 1  ON 47
eH2_8                 9.460266e-02 1 1  ON 48
eH2_9                 2.672715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4393e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1989
    reference variance = 0.246838
====================================================
  Execution time = 3.1477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4902e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349066695669
                                         uncertainty =       0.005688318746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349066695669
                                         uncertainty =       0.005688318746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417742153
  error estimate for blocks of size 2^( 2) =       0.000428516454
  error estimate for blocks of size 2^( 3) =       0.000438248255
  error estimate for blocks of size 2^( 4) =       0.000445577874
  error estimate for blocks of size 2^( 5) =       0.000449276729
  error estimate for blocks of size 2^( 6) =       0.000452569615
  error estimate for blocks of size 2^( 7) =       0.000455730613

      target function =                  N/A
              le_mean =     -17.210636330110
             les_mean =     296.555019726141
             stat err =       0.000450788708
             autocorr =       1.164473085108
              std dev =       0.590776618827
             le_variance =       0.349017013353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721063633011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210636330110       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210636333441       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210636339500       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210636343039       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210636344004       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210636343332       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210636342928       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210636342584       residual = 9.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 2.358603e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210636330110       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210636330943       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210636332460       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210636333346       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210636333590       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210636333418       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210636333317       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210636333232       residual = 9.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 5.895986e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210636330110       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210636330318       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210636330697       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210636330919       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210636330979       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210636330933       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210636330914       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210636330898       residual = 9.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.473964e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0274e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.130562e-01 1 1  ON 0
 uu_1                 4.835929e-02 1 1  ON 1
 uu_2                -4.949802e-02 1 1  ON 2
 uu_3                -1.044227e-01 1 1  ON 3
 uu_4                -1.348461e-01 1 1  ON 4
 uu_5                -1.379087e-01 1 1  ON 5
 uu_6                -1.122355e-01 1 1  ON 6
 uu_7                -3.946623e-02 1 1  ON 7
 uu_8                 9.977323e-02 1 1  ON 8
 uu_9                 1.222489e-01 1 1  ON 9
 ud_0                 3.560415e-01 1 1  ON 10
 ud_1                 9.345558e-02 1 1  ON 11
 ud_2                -1.735266e-02 1 1  ON 12
 ud_3                -7.670478e-02 1 1  ON 13
 ud_4                -1.233420e-01 1 1  ON 14
 ud_5                -1.546494e-01 1 1  ON 15
 ud_6                -1.563538e-01 1 1  ON 16
 ud_7                -1.120619e-01 1 1  ON 17
 ud_8                 3.223828e-03 1 1  ON 18
 ud_9                 9.332812e-02 1 1  ON 19
 eO_0                -7.669040e-01 1 1  ON 20
 eO_1                -4.440442e-01 1 1  ON 21
 eO_2                -3.319573e-02 1 1  ON 22
 eO_3                 2.161946e-01 1 1  ON 23
 eO_4                 2.984351e-01 1 1  ON 24
 eO_5                 3.078929e-01 1 1  ON 25
 eO_6                 2.503654e-01 1 1  ON 26
 eO_7                 1.132018e-01 1 1  ON 27
 eO_8                 2.823139e-02 1 1  ON 28
 eO_9                 1.877732e-02 1 1  ON 29
eH1_0                -1.831413e-01 1 1  ON 30
eH1_1                -1.045995e-01 1 1  ON 31
eH1_2                -6.298406e-02 1 1  ON 32
eH1_3                -2.597159e-02 1 1  ON 33
eH1_4                 1.969095e-02 1 1  ON 34
eH1_5                 3.582398e-02 1 1  ON 35
eH1_6                 7.813406e-02 1 1  ON 36
eH1_7                 1.104800e-01 1 1  ON 37
eH1_8                 9.202373e-02 1 1  ON 38
eH1_9                 2.490412e-02 1 1  ON 39
eH2_0                -1.838044e-01 1 1  ON 40
eH2_1                -1.054875e-01 1 1  ON 41
eH2_2                -6.369691e-02 1 1  ON 42
eH2_3                -2.661419e-02 1 1  ON 43
eH2_4                 1.862734e-02 1 1  ON 44
eH2_5                 3.500742e-02 1 1  ON 45
eH2_6                 7.870954e-02 1 1  ON 46
eH2_7                 1.135400e-01 1 1  ON 47
eH2_8                 9.460274e-02 1 1  ON 48
eH2_9                 2.672718e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1807
    reference variance = 0.160244
====================================================
  Execution time = 3.0976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4568e-01
  Total weights = 2.0000e+06
  Execution time = 2.6553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345786494844
                                         uncertainty =       0.005587884626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345786494844
                                         uncertainty =       0.005587884626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415741542
  error estimate for blocks of size 2^( 2) =       0.000425845819
  error estimate for blocks of size 2^( 3) =       0.000435280448
  error estimate for blocks of size 2^( 4) =       0.000442315623
  error estimate for blocks of size 2^( 5) =       0.000446419270
  error estimate for blocks of size 2^( 6) =       0.000449662672
  error estimate for blocks of size 2^( 7) =       0.000450258135

      target function =                  N/A
              le_mean =     -17.210510831822
             les_mean =     296.547364979543
             stat err =       0.000447163925
             autocorr =       1.156875632115
              std dev =       0.587947327671
             le_variance =       0.345682060115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345787429601
                                         uncertainty =       0.005587899168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345787429601
                                         uncertainty =       0.005587899168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415742104
  error estimate for blocks of size 2^( 2) =       0.000425846346
  error estimate for blocks of size 2^( 3) =       0.000435280933
  error estimate for blocks of size 2^( 4) =       0.000442316075
  error estimate for blocks of size 2^( 5) =       0.000446419703
  error estimate for blocks of size 2^( 6) =       0.000449663116
  error estimate for blocks of size 2^( 7) =       0.000450258559

      target function =                  N/A
              le_mean =     -17.210510833434
             les_mean =     296.547365969688
             stat err =       0.000447164363
             autocorr =       1.156874772265
              std dev =       0.587948122532
             le_variance =       0.345682994789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345786962512
                                         uncertainty =       0.005587891900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345786962512
                                         uncertainty =       0.005587891900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415741824
  error estimate for blocks of size 2^( 2) =       0.000425846083
  error estimate for blocks of size 2^( 3) =       0.000435280690
  error estimate for blocks of size 2^( 4) =       0.000442315849
  error estimate for blocks of size 2^( 5) =       0.000446419487
  error estimate for blocks of size 2^( 6) =       0.000449662894
  error estimate for blocks of size 2^( 7) =       0.000450258347

      target function =                  N/A
              le_mean =     -17.210510832630
             les_mean =     296.547365474971
             stat err =       0.000447164144
             autocorr =       1.156875201912
              std dev =       0.587947725348
             le_variance =       0.345682527742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345786553311
                                         uncertainty =       0.005587885536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345786553311
                                         uncertainty =       0.005587885536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415741578
  error estimate for blocks of size 2^( 2) =       0.000425845852
  error estimate for blocks of size 2^( 3) =       0.000435280478
  error estimate for blocks of size 2^( 4) =       0.000442315652
  error estimate for blocks of size 2^( 5) =       0.000446419297
  error estimate for blocks of size 2^( 6) =       0.000449662700
  error estimate for blocks of size 2^( 7) =       0.000450258162

      target function =                  N/A
              le_mean =     -17.210510831923
             les_mean =     296.547365041480
             stat err =       0.000447163953
             autocorr =       1.156875578330
              std dev =       0.587947377388
             le_variance =       0.345682118577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210510831822        initial
     2.3842e+02     2.3842e+03             2.3586e-06       -17.210510833434  <--
     9.5367e+02     9.5367e+03             5.8960e-07       -17.210510832630
     3.8147e+03     3.8147e+04             1.4740e-07       -17.210510831923

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 4.4326e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.130570e-01 1 1  ON 0
 uu_1                 4.835978e-02 1 1  ON 1
 uu_2                -4.949796e-02 1 1  ON 2
 uu_3                -1.044229e-01 1 1  ON 3
 uu_4                -1.348463e-01 1 1  ON 4
 uu_5                -1.379091e-01 1 1  ON 5
 uu_6                -1.122359e-01 1 1  ON 6
 uu_7                -3.946662e-02 1 1  ON 7
 uu_8                 9.977299e-02 1 1  ON 8
 uu_9                 1.222491e-01 1 1  ON 9
 ud_0                 3.560421e-01 1 1  ON 10
 ud_1                 9.345608e-02 1 1  ON 11
 ud_2                -1.735272e-02 1 1  ON 12
 ud_3                -7.670488e-02 1 1  ON 13
 ud_4                -1.233423e-01 1 1  ON 14
 ud_5                -1.546497e-01 1 1  ON 15
 ud_6                -1.563540e-01 1 1  ON 16
 ud_7                -1.120620e-01 1 1  ON 17
 ud_8                 3.223482e-03 1 1  ON 18
 ud_9                 9.332819e-02 1 1  ON 19
 eO_0                -7.669058e-01 1 1  ON 20
 eO_1                -4.440460e-01 1 1  ON 21
 eO_2                -3.319619e-02 1 1  ON 22
 eO_3                 2.161957e-01 1 1  ON 23
 eO_4                 2.984367e-01 1 1  ON 24
 eO_5                 3.078934e-01 1 1  ON 25
 eO_6                 2.503656e-01 1 1  ON 26
 eO_7                 1.132021e-01 1 1  ON 27
 eO_8                 2.823145e-02 1 1  ON 28
 eO_9                 1.877736e-02 1 1  ON 29
eH1_0                -1.831417e-01 1 1  ON 30
eH1_1                -1.045997e-01 1 1  ON 31
eH1_2                -6.298386e-02 1 1  ON 32
eH1_3                -2.597138e-02 1 1  ON 33
eH1_4                 1.969077e-02 1 1  ON 34
eH1_5                 3.582408e-02 1 1  ON 35
eH1_6                 7.813411e-02 1 1  ON 36
eH1_7                 1.104800e-01 1 1  ON 37
eH1_8                 9.202394e-02 1 1  ON 38
eH1_9                 2.490419e-02 1 1  ON 39
eH2_0                -1.838045e-01 1 1  ON 40
eH2_1                -1.054876e-01 1 1  ON 41
eH2_2                -6.369699e-02 1 1  ON 42
eH2_3                -2.661413e-02 1 1  ON 43
eH2_4                 1.862728e-02 1 1  ON 44
eH2_5                 3.500751e-02 1 1  ON 45
eH2_6                 7.870947e-02 1 1  ON 46
eH2_7                 1.135399e-01 1 1  ON 47
eH2_8                 9.460298e-02 1 1  ON 48
eH2_9                 2.672726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4605e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.259
    reference variance = 0.202393
====================================================
  Execution time = 3.1722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343885350497
                                         uncertainty =       0.003889380598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343885350497
                                         uncertainty =       0.003889380598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414645364
  error estimate for blocks of size 2^( 2) =       0.000425241845
  error estimate for blocks of size 2^( 3) =       0.000434659220
  error estimate for blocks of size 2^( 4) =       0.000441978520
  error estimate for blocks of size 2^( 5) =       0.000446711906
  error estimate for blocks of size 2^( 6) =       0.000448342053
  error estimate for blocks of size 2^( 7) =       0.000449729075

      target function =                  N/A
              le_mean =     -17.212475819792
             les_mean =     296.613185231274
             stat err =       0.000446690388
             autocorr =       1.160538591437
              std dev =       0.586397097777
             le_variance =       0.343861556281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721247581979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212475819792       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212475827005       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212475847924       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212475870287       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212475849936       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212475856635       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212475858618       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 9.989352e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212475819792       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212475821599       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212475826854       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212475832457       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212475827369       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212475829015       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212475829529       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 2.498290e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212475819792       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212475820244       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212475821559       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212475822961       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212475821689       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212475822098       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212475822228       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 6.246321e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248881 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4207e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.130579e-01 1 1  ON 0
 uu_1                 4.835969e-02 1 1  ON 1
 uu_2                -4.949779e-02 1 1  ON 2
 uu_3                -1.044231e-01 1 1  ON 3
 uu_4                -1.348463e-01 1 1  ON 4
 uu_5                -1.379097e-01 1 1  ON 5
 uu_6                -1.122365e-01 1 1  ON 6
 uu_7                -3.946703e-02 1 1  ON 7
 uu_8                 9.977287e-02 1 1  ON 8
 uu_9                 1.222495e-01 1 1  ON 9
 ud_0                 3.560424e-01 1 1  ON 10
 ud_1                 9.345647e-02 1 1  ON 11
 ud_2                -1.735224e-02 1 1  ON 12
 ud_3                -7.670525e-02 1 1  ON 13
 ud_4                -1.233430e-01 1 1  ON 14
 ud_5                -1.546499e-01 1 1  ON 15
 ud_6                -1.563542e-01 1 1  ON 16
 ud_7                -1.120619e-01 1 1  ON 17
 ud_8                 3.223162e-03 1 1  ON 18
 ud_9                 9.332828e-02 1 1  ON 19
 eO_0                -7.669083e-01 1 1  ON 20
 eO_1                -4.440474e-01 1 1  ON 21
 eO_2                -3.319703e-02 1 1  ON 22
 eO_3                 2.161966e-01 1 1  ON 23
 eO_4                 2.984386e-01 1 1  ON 24
 eO_5                 3.078941e-01 1 1  ON 25
 eO_6                 2.503661e-01 1 1  ON 26
 eO_7                 1.132027e-01 1 1  ON 27
 eO_8                 2.823158e-02 1 1  ON 28
 eO_9                 1.877742e-02 1 1  ON 29
eH1_0                -1.831418e-01 1 1  ON 30
eH1_1                -1.045999e-01 1 1  ON 31
eH1_2                -6.298388e-02 1 1  ON 32
eH1_3                -2.597120e-02 1 1  ON 33
eH1_4                 1.969073e-02 1 1  ON 34
eH1_5                 3.582353e-02 1 1  ON 35
eH1_6                 7.813411e-02 1 1  ON 36
eH1_7                 1.104801e-01 1 1  ON 37
eH1_8                 9.202433e-02 1 1  ON 38
eH1_9                 2.490435e-02 1 1  ON 39
eH2_0                -1.838049e-01 1 1  ON 40
eH2_1                -1.054875e-01 1 1  ON 41
eH2_2                -6.369695e-02 1 1  ON 42
eH2_3                -2.661445e-02 1 1  ON 43
eH2_4                 1.862756e-02 1 1  ON 44
eH2_5                 3.500728e-02 1 1  ON 45
eH2_6                 7.870943e-02 1 1  ON 46
eH2_7                 1.135400e-01 1 1  ON 47
eH2_8                 9.460331e-02 1 1  ON 48
eH2_9                 2.672738e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1784
    reference variance = 0.255944
====================================================
  Execution time = 3.1613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4045e-01
  Total weights = 2.0000e+06
  Execution time = 2.6762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416341229
                                         uncertainty =       0.003611266619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416341229
                                         uncertainty =       0.003611266619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412582236
  error estimate for blocks of size 2^( 2) =       0.000423284339
  error estimate for blocks of size 2^( 3) =       0.000432925970
  error estimate for blocks of size 2^( 4) =       0.000439676449
  error estimate for blocks of size 2^( 5) =       0.000444371823
  error estimate for blocks of size 2^( 6) =       0.000448075774
  error estimate for blocks of size 2^( 7) =       0.000445790684

      target function =                  N/A
              le_mean =     -17.210703636320
             les_mean =     296.548767690771
             stat err =       0.000444478683
             autocorr =       1.160595339648
              std dev =       0.583479394443
             le_variance =       0.340448203740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416658040
                                         uncertainty =       0.003611250660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416658040
                                         uncertainty =       0.003611250660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412582429
  error estimate for blocks of size 2^( 2) =       0.000423284534
  error estimate for blocks of size 2^( 3) =       0.000432926169
  error estimate for blocks of size 2^( 4) =       0.000439676635
  error estimate for blocks of size 2^( 5) =       0.000444371977
  error estimate for blocks of size 2^( 6) =       0.000448075976
  error estimate for blocks of size 2^( 7) =       0.000445790862

      target function =                  N/A
              le_mean =     -17.210703624169
             les_mean =     296.548767589866
             stat err =       0.000444478862
             autocorr =       1.160595196571
              std dev =       0.583479666403
             le_variance =       0.340448521106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416494027
                                         uncertainty =       0.003611258533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416494027
                                         uncertainty =       0.003611258533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412582329
  error estimate for blocks of size 2^( 2) =       0.000423284433
  error estimate for blocks of size 2^( 3) =       0.000432926067
  error estimate for blocks of size 2^( 4) =       0.000439676539
  error estimate for blocks of size 2^( 5) =       0.000444371898
  error estimate for blocks of size 2^( 6) =       0.000448075872
  error estimate for blocks of size 2^( 7) =       0.000445790770

      target function =                  N/A
              le_mean =     -17.210703630220
             les_mean =     296.548767633856
             stat err =       0.000444478770
             autocorr =       1.160595273491
              std dev =       0.583479525619
             le_variance =       0.340448356816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416360145
                                         uncertainty =       0.003611265605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416360145
                                         uncertainty =       0.003611265605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412582248
  error estimate for blocks of size 2^( 2) =       0.000423284351
  error estimate for blocks of size 2^( 3) =       0.000432925982
  error estimate for blocks of size 2^( 4) =       0.000439676460
  error estimate for blocks of size 2^( 5) =       0.000444371832
  error estimate for blocks of size 2^( 6) =       0.000448075786
  error estimate for blocks of size 2^( 7) =       0.000445790695

      target function =                  N/A
              le_mean =     -17.210703635556
             les_mean =     296.548767683420
             stat err =       0.000444478693
             autocorr =       1.160595331539
              std dev =       0.583479410683
             le_variance =       0.340448222691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210703636320        initial  <--
     5.9605e+01     5.9605e+02             9.9894e-06       -17.210703624169
     2.3842e+02     2.3842e+03             2.4983e-06       -17.210703630220
     9.5367e+02     9.5367e+03             6.2463e-07       -17.210703635556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9926
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.130570e-01 1 1  ON 0
 uu_1                 4.835978e-02 1 1  ON 1
 uu_2                -4.949796e-02 1 1  ON 2
 uu_3                -1.044229e-01 1 1  ON 3
 uu_4                -1.348463e-01 1 1  ON 4
 uu_5                -1.379091e-01 1 1  ON 5
 uu_6                -1.122359e-01 1 1  ON 6
 uu_7                -3.946662e-02 1 1  ON 7
 uu_8                 9.977299e-02 1 1  ON 8
 uu_9                 1.222491e-01 1 1  ON 9
 ud_0                 3.560421e-01 1 1  ON 10
 ud_1                 9.345608e-02 1 1  ON 11
 ud_2                -1.735272e-02 1 1  ON 12
 ud_3                -7.670488e-02 1 1  ON 13
 ud_4                -1.233423e-01 1 1  ON 14
 ud_5                -1.546497e-01 1 1  ON 15
 ud_6                -1.563540e-01 1 1  ON 16
 ud_7                -1.120620e-01 1 1  ON 17
 ud_8                 3.223482e-03 1 1  ON 18
 ud_9                 9.332819e-02 1 1  ON 19
 eO_0                -7.669058e-01 1 1  ON 20
 eO_1                -4.440460e-01 1 1  ON 21
 eO_2                -3.319619e-02 1 1  ON 22
 eO_3                 2.161957e-01 1 1  ON 23
 eO_4                 2.984367e-01 1 1  ON 24
 eO_5                 3.078934e-01 1 1  ON 25
 eO_6                 2.503656e-01 1 1  ON 26
 eO_7                 1.132021e-01 1 1  ON 27
 eO_8                 2.823145e-02 1 1  ON 28
 eO_9                 1.877736e-02 1 1  ON 29
eH1_0                -1.831417e-01 1 1  ON 30
eH1_1                -1.045997e-01 1 1  ON 31
eH1_2                -6.298386e-02 1 1  ON 32
eH1_3                -2.597138e-02 1 1  ON 33
eH1_4                 1.969077e-02 1 1  ON 34
eH1_5                 3.582408e-02 1 1  ON 35
eH1_6                 7.813411e-02 1 1  ON 36
eH1_7                 1.104800e-01 1 1  ON 37
eH1_8                 9.202394e-02 1 1  ON 38
eH1_9                 2.490419e-02 1 1  ON 39
eH2_0                -1.838045e-01 1 1  ON 40
eH2_1                -1.054876e-01 1 1  ON 41
eH2_2                -6.369699e-02 1 1  ON 42
eH2_3                -2.661413e-02 1 1  ON 43
eH2_4                 1.862728e-02 1 1  ON 44
eH2_5                 3.500751e-02 1 1  ON 45
eH2_6                 7.870947e-02 1 1  ON 46
eH2_7                 1.135399e-01 1 1  ON 47
eH2_8                 9.460298e-02 1 1  ON 48
eH2_9                 2.672726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2834
    reference variance = 0.331714
====================================================
  Execution time = 3.1635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344387687741
                                         uncertainty =       0.003641076467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344387687741
                                         uncertainty =       0.003641076467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414963021
  error estimate for blocks of size 2^( 2) =       0.000425343203
  error estimate for blocks of size 2^( 3) =       0.000434623362
  error estimate for blocks of size 2^( 4) =       0.000441260823
  error estimate for blocks of size 2^( 5) =       0.000445997364
  error estimate for blocks of size 2^( 6) =       0.000449660755
  error estimate for blocks of size 2^( 7) =       0.000449535303

      target function =                  N/A
              le_mean =     -17.211439578656
             les_mean =     296.578040815050
             stat err =       0.000446613561
             autocorr =       1.158363911640
              std dev =       0.586846332116
             le_variance =       0.344388617518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721143957866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211439578656       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211439578868       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211439578390       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211439579949       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211439580171       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211439580471       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211439580262       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 9.272956e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211439578656       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211439578709       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211439578589       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211439578979       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211439579035       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211439579110       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211439579056       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 2.318345e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211439578656       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211439578669       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211439578639       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211439578737       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211439578742       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211439578758       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211439578740       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 5.795928e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0535e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.130571e-01 1 1  ON 0
 uu_1                 4.835981e-02 1 1  ON 1
 uu_2                -4.949794e-02 1 1  ON 2
 uu_3                -1.044229e-01 1 1  ON 3
 uu_4                -1.348463e-01 1 1  ON 4
 uu_5                -1.379091e-01 1 1  ON 5
 uu_6                -1.122360e-01 1 1  ON 6
 uu_7                -3.946667e-02 1 1  ON 7
 uu_8                 9.977297e-02 1 1  ON 8
 uu_9                 1.222491e-01 1 1  ON 9
 ud_0                 3.560422e-01 1 1  ON 10
 ud_1                 9.345612e-02 1 1  ON 11
 ud_2                -1.735269e-02 1 1  ON 12
 ud_3                -7.670489e-02 1 1  ON 13
 ud_4                -1.233424e-01 1 1  ON 14
 ud_5                -1.546497e-01 1 1  ON 15
 ud_6                -1.563540e-01 1 1  ON 16
 ud_7                -1.120621e-01 1 1  ON 17
 ud_8                 3.223425e-03 1 1  ON 18
 ud_9                 9.332818e-02 1 1  ON 19
 eO_0                -7.669060e-01 1 1  ON 20
 eO_1                -4.440461e-01 1 1  ON 21
 eO_2                -3.319630e-02 1 1  ON 22
 eO_3                 2.161958e-01 1 1  ON 23
 eO_4                 2.984369e-01 1 1  ON 24
 eO_5                 3.078935e-01 1 1  ON 25
 eO_6                 2.503657e-01 1 1  ON 26
 eO_7                 1.132022e-01 1 1  ON 27
 eO_8                 2.823146e-02 1 1  ON 28
 eO_9                 1.877737e-02 1 1  ON 29
eH1_0                -1.831417e-01 1 1  ON 30
eH1_1                -1.045998e-01 1 1  ON 31
eH1_2                -6.298389e-02 1 1  ON 32
eH1_3                -2.597137e-02 1 1  ON 33
eH1_4                 1.969076e-02 1 1  ON 34
eH1_5                 3.582411e-02 1 1  ON 35
eH1_6                 7.813414e-02 1 1  ON 36
eH1_7                 1.104800e-01 1 1  ON 37
eH1_8                 9.202397e-02 1 1  ON 38
eH1_9                 2.490420e-02 1 1  ON 39
eH2_0                -1.838045e-01 1 1  ON 40
eH2_1                -1.054876e-01 1 1  ON 41
eH2_2                -6.369698e-02 1 1  ON 42
eH2_3                -2.661412e-02 1 1  ON 43
eH2_4                 1.862729e-02 1 1  ON 44
eH2_5                 3.500750e-02 1 1  ON 45
eH2_6                 7.870948e-02 1 1  ON 46
eH2_7                 1.135399e-01 1 1  ON 47
eH2_8                 9.460301e-02 1 1  ON 48
eH2_9                 2.672727e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1835
    reference variance = 0.176558
====================================================
  Execution time = 3.1126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4287e-01
  Total weights = 2.0000e+06
  Execution time = 2.6653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967609613
                                         uncertainty =       0.004205496587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967609613
                                         uncertainty =       0.004205496587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414050020
  error estimate for blocks of size 2^( 2) =       0.000424501248
  error estimate for blocks of size 2^( 3) =       0.000433692123
  error estimate for blocks of size 2^( 4) =       0.000440774407
  error estimate for blocks of size 2^( 5) =       0.000446004437
  error estimate for blocks of size 2^( 6) =       0.000449446617
  error estimate for blocks of size 2^( 7) =       0.000451351741

      target function =                  N/A
              le_mean =     -17.210969627734
             les_mean =     296.560350193000
             stat err =       0.000446894301
             autocorr =       1.164941221117
              std dev =       0.585555153389
             le_variance =       0.342874837660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967811707
                                         uncertainty =       0.004205500643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967811707
                                         uncertainty =       0.004205500643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414050142
  error estimate for blocks of size 2^( 2) =       0.000424501363
  error estimate for blocks of size 2^( 3) =       0.000433692230
  error estimate for blocks of size 2^( 4) =       0.000440774509
  error estimate for blocks of size 2^( 5) =       0.000446004537
  error estimate for blocks of size 2^( 6) =       0.000449446717
  error estimate for blocks of size 2^( 7) =       0.000451351836

      target function =                  N/A
              le_mean =     -17.210969627980
             les_mean =     296.560350403363
             stat err =       0.000446894400
             autocorr =       1.164941052136
              std dev =       0.585555325787
             le_variance =       0.342875039558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967710691
                                         uncertainty =       0.004205498616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967710691
                                         uncertainty =       0.004205498616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414050081
  error estimate for blocks of size 2^( 2) =       0.000424501305
  error estimate for blocks of size 2^( 3) =       0.000433692176
  error estimate for blocks of size 2^( 4) =       0.000440774458
  error estimate for blocks of size 2^( 5) =       0.000446004487
  error estimate for blocks of size 2^( 6) =       0.000449446667
  error estimate for blocks of size 2^( 7) =       0.000451351789

      target function =                  N/A
              le_mean =     -17.210969627857
             les_mean =     296.560350298207
             stat err =       0.000446894350
             autocorr =       1.164941136611
              std dev =       0.585555239614
             le_variance =       0.342874938640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967622249
                                         uncertainty =       0.004205496841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342967622249
                                         uncertainty =       0.004205496841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414050027
  error estimate for blocks of size 2^( 2) =       0.000424501255
  error estimate for blocks of size 2^( 3) =       0.000433692130
  error estimate for blocks of size 2^( 4) =       0.000440774414
  error estimate for blocks of size 2^( 5) =       0.000446004444
  error estimate for blocks of size 2^( 6) =       0.000449446623
  error estimate for blocks of size 2^( 7) =       0.000451351747

      target function =                  N/A
              le_mean =     -17.210969627749
             les_mean =     296.560350206152
             stat err =       0.000446894307
             autocorr =       1.164941210551
              std dev =       0.585555164167
             le_variance =       0.342874850283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210969627734        initial
     5.9605e+02     5.9605e+03             9.2730e-07       -17.210969627980  <--
     2.3842e+03     2.3842e+04             2.3183e-07       -17.210969627857
     9.5367e+03     9.5367e+04             5.7959e-08       -17.210969627749

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 4.4480e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.130573e-01 1 1  ON 0
 uu_1                 4.835991e-02 1 1  ON 1
 uu_2                -4.949787e-02 1 1  ON 2
 uu_3                -1.044228e-01 1 1  ON 3
 uu_4                -1.348465e-01 1 1  ON 4
 uu_5                -1.379093e-01 1 1  ON 5
 uu_6                -1.122362e-01 1 1  ON 6
 uu_7                -3.946682e-02 1 1  ON 7
 uu_8                 9.977289e-02 1 1  ON 8
 uu_9                 1.222492e-01 1 1  ON 9
 ud_0                 3.560424e-01 1 1  ON 10
 ud_1                 9.345625e-02 1 1  ON 11
 ud_2                -1.735260e-02 1 1  ON 12
 ud_3                -7.670489e-02 1 1  ON 13
 ud_4                -1.233426e-01 1 1  ON 14
 ud_5                -1.546497e-01 1 1  ON 15
 ud_6                -1.563541e-01 1 1  ON 16
 ud_7                -1.120622e-01 1 1  ON 17
 ud_8                 3.223255e-03 1 1  ON 18
 ud_9                 9.332817e-02 1 1  ON 19
 eO_0                -7.669067e-01 1 1  ON 20
 eO_1                -4.440466e-01 1 1  ON 21
 eO_2                -3.319661e-02 1 1  ON 22
 eO_3                 2.161962e-01 1 1  ON 23
 eO_4                 2.984375e-01 1 1  ON 24
 eO_5                 3.078937e-01 1 1  ON 25
 eO_6                 2.503658e-01 1 1  ON 26
 eO_7                 1.132024e-01 1 1  ON 27
 eO_8                 2.823148e-02 1 1  ON 28
 eO_9                 1.877738e-02 1 1  ON 29
eH1_0                -1.831418e-01 1 1  ON 30
eH1_1                -1.046000e-01 1 1  ON 31
eH1_2                -6.298398e-02 1 1  ON 32
eH1_3                -2.597134e-02 1 1  ON 33
eH1_4                 1.969072e-02 1 1  ON 34
eH1_5                 3.582422e-02 1 1  ON 35
eH1_6                 7.813423e-02 1 1  ON 36
eH1_7                 1.104800e-01 1 1  ON 37
eH1_8                 9.202406e-02 1 1  ON 38
eH1_9                 2.490423e-02 1 1  ON 39
eH2_0                -1.838046e-01 1 1  ON 40
eH2_1                -1.054877e-01 1 1  ON 41
eH2_2                -6.369695e-02 1 1  ON 42
eH2_3                -2.661410e-02 1 1  ON 43
eH2_4                 1.862731e-02 1 1  ON 44
eH2_5                 3.500746e-02 1 1  ON 45
eH2_6                 7.870951e-02 1 1  ON 46
eH2_7                 1.135399e-01 1 1  ON 47
eH2_8                 9.460310e-02 1 1  ON 48
eH2_9                 2.672729e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2649
    reference variance = 0.387468
====================================================
  Execution time = 3.1663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5123e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351282829796
                                         uncertainty =       0.003907262780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351282829796
                                         uncertainty =       0.003907262780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419061833
  error estimate for blocks of size 2^( 2) =       0.000429480005
  error estimate for blocks of size 2^( 3) =       0.000439047348
  error estimate for blocks of size 2^( 4) =       0.000446544321
  error estimate for blocks of size 2^( 5) =       0.000450665518
  error estimate for blocks of size 2^( 6) =       0.000454247800
  error estimate for blocks of size 2^( 7) =       0.000456660846

      target function =                  N/A
              le_mean =     -17.211999579544
             les_mean =     296.604154989812
             stat err =       0.000452029621
             autocorr =       1.163529968642
              std dev =       0.592642927239
             le_variance =       0.351225639206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721199957954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211999579544       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211999578705       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211999580509       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211999586681       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211999592636       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211999588545       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211999590824       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 4.153397e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211999579544       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211999579334       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211999579785       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211999581326       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211999582815       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211999581794       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211999582364       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 1.038564e-06

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211999579544       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211999579491       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211999579604       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211999579989       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211999580361       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211999580106       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211999580249       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 2.596545e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0751e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.130575e-01 1 1  ON 0
 uu_1                 4.836018e-02 1 1  ON 1
 uu_2                -4.949767e-02 1 1  ON 2
 uu_3                -1.044228e-01 1 1  ON 3
 uu_4                -1.348466e-01 1 1  ON 4
 uu_5                -1.379094e-01 1 1  ON 5
 uu_6                -1.122365e-01 1 1  ON 6
 uu_7                -3.946708e-02 1 1  ON 7
 uu_8                 9.977278e-02 1 1  ON 8
 uu_9                 1.222493e-01 1 1  ON 9
 ud_0                 3.560425e-01 1 1  ON 10
 ud_1                 9.345643e-02 1 1  ON 11
 ud_2                -1.735239e-02 1 1  ON 12
 ud_3                -7.670469e-02 1 1  ON 13
 ud_4                -1.233428e-01 1 1  ON 14
 ud_5                -1.546496e-01 1 1  ON 15
 ud_6                -1.563544e-01 1 1  ON 16
 ud_7                -1.120623e-01 1 1  ON 17
 ud_8                 3.223079e-03 1 1  ON 18
 ud_9                 9.332818e-02 1 1  ON 19
 eO_0                -7.669078e-01 1 1  ON 20
 eO_1                -4.440474e-01 1 1  ON 21
 eO_2                -3.319700e-02 1 1  ON 22
 eO_3                 2.161969e-01 1 1  ON 23
 eO_4                 2.984383e-01 1 1  ON 24
 eO_5                 3.078940e-01 1 1  ON 25
 eO_6                 2.503659e-01 1 1  ON 26
 eO_7                 1.132025e-01 1 1  ON 27
 eO_8                 2.823151e-02 1 1  ON 28
 eO_9                 1.877739e-02 1 1  ON 29
eH1_0                -1.831421e-01 1 1  ON 30
eH1_1                -1.046001e-01 1 1  ON 31
eH1_2                -6.298393e-02 1 1  ON 32
eH1_3                -2.597134e-02 1 1  ON 33
eH1_4                 1.969080e-02 1 1  ON 34
eH1_5                 3.582412e-02 1 1  ON 35
eH1_6                 7.813432e-02 1 1  ON 36
eH1_7                 1.104800e-01 1 1  ON 37
eH1_8                 9.202420e-02 1 1  ON 38
eH1_9                 2.490428e-02 1 1  ON 39
eH2_0                -1.838046e-01 1 1  ON 40
eH2_1                -1.054877e-01 1 1  ON 41
eH2_2                -6.369697e-02 1 1  ON 42
eH2_3                -2.661403e-02 1 1  ON 43
eH2_4                 1.862731e-02 1 1  ON 44
eH2_5                 3.500737e-02 1 1  ON 45
eH2_6                 7.870948e-02 1 1  ON 46
eH2_7                 1.135399e-01 1 1  ON 47
eH2_8                 9.460319e-02 1 1  ON 48
eH2_9                 2.672731e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1837
    reference variance = 0.201611
====================================================
  Execution time = 3.1061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4320e-01
  Total weights = 2.0000e+06
  Execution time = 2.6595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167504125
                                         uncertainty =       0.003778680326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167504125
                                         uncertainty =       0.003778680326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414244084
  error estimate for blocks of size 2^( 2) =       0.000424997139
  error estimate for blocks of size 2^( 3) =       0.000434264754
  error estimate for blocks of size 2^( 4) =       0.000441426725
  error estimate for blocks of size 2^( 5) =       0.000446662964
  error estimate for blocks of size 2^( 6) =       0.000448483740
  error estimate for blocks of size 2^( 7) =       0.000450952901

      target function =                  N/A
              le_mean =     -17.211712004671
             les_mean =     296.586226282923
             stat err =       0.000446881583
             autocorr =       1.163783733244
              std dev =       0.585829602174
             le_variance =       0.343196322784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167364625
                                         uncertainty =       0.003778675855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167364625
                                         uncertainty =       0.003778675855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414244000
  error estimate for blocks of size 2^( 2) =       0.000424997051
  error estimate for blocks of size 2^( 3) =       0.000434264650
  error estimate for blocks of size 2^( 4) =       0.000441426612
  error estimate for blocks of size 2^( 5) =       0.000446662844
  error estimate for blocks of size 2^( 6) =       0.000448483605
  error estimate for blocks of size 2^( 7) =       0.000450952779

      target function =                  N/A
              le_mean =     -17.211712006487
             les_mean =     296.586226205871
             stat err =       0.000446881460
             autocorr =       1.163783567343
              std dev =       0.585829483063
             le_variance =       0.343196183226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167433936
                                         uncertainty =       0.003778678083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167433936
                                         uncertainty =       0.003778678083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414244042
  error estimate for blocks of size 2^( 2) =       0.000424997095
  error estimate for blocks of size 2^( 3) =       0.000434264702
  error estimate for blocks of size 2^( 4) =       0.000441426669
  error estimate for blocks of size 2^( 5) =       0.000446662904
  error estimate for blocks of size 2^( 6) =       0.000448483672
  error estimate for blocks of size 2^( 7) =       0.000450952840

      target function =                  N/A
              le_mean =     -17.211712005572
             les_mean =     296.586226243710
             stat err =       0.000446881521
             autocorr =       1.163783650575
              std dev =       0.585829542244
             le_variance =       0.343196252566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167495337
                                         uncertainty =       0.003778680046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343167495337
                                         uncertainty =       0.003778680046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414244079
  error estimate for blocks of size 2^( 2) =       0.000424997134
  error estimate for blocks of size 2^( 3) =       0.000434264748
  error estimate for blocks of size 2^( 4) =       0.000441426718
  error estimate for blocks of size 2^( 5) =       0.000446662957
  error estimate for blocks of size 2^( 6) =       0.000448483731
  error estimate for blocks of size 2^( 7) =       0.000450952894

      target function =                  N/A
              le_mean =     -17.211712004783
             les_mean =     296.586226277995
             stat err =       0.000446881575
             autocorr =       1.163783722925
              std dev =       0.585829594670
             le_variance =       0.343196313992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211712004671        initial
     1.4901e+02     1.4901e+03             4.1534e-06       -17.211712006487  <--
     5.9605e+02     5.9605e+03             1.0386e-06       -17.211712005572
     2.3842e+03     2.3842e+04             2.5965e-07       -17.211712004783

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 4.4391e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.130581e-01 1 1  ON 0
 uu_1                 4.836097e-02 1 1  ON 1
 uu_2                -4.949709e-02 1 1  ON 2
 uu_3                -1.044230e-01 1 1  ON 3
 uu_4                -1.348469e-01 1 1  ON 4
 uu_5                -1.379096e-01 1 1  ON 5
 uu_6                -1.122373e-01 1 1  ON 6
 uu_7                -3.946788e-02 1 1  ON 7
 uu_8                 9.977246e-02 1 1  ON 8
 uu_9                 1.222496e-01 1 1  ON 9
 ud_0                 3.560428e-01 1 1  ON 10
 ud_1                 9.345698e-02 1 1  ON 11
 ud_2                -1.735176e-02 1 1  ON 12
 ud_3                -7.670410e-02 1 1  ON 13
 ud_4                -1.233434e-01 1 1  ON 14
 ud_5                -1.546494e-01 1 1  ON 15
 ud_6                -1.563555e-01 1 1  ON 16
 ud_7                -1.120628e-01 1 1  ON 17
 ud_8                 3.222552e-03 1 1  ON 18
 ud_9                 9.332822e-02 1 1  ON 19
 eO_0                -7.669109e-01 1 1  ON 20
 eO_1                -4.440497e-01 1 1  ON 21
 eO_2                -3.319817e-02 1 1  ON 22
 eO_3                 2.161990e-01 1 1  ON 23
 eO_4                 2.984408e-01 1 1  ON 24
 eO_5                 3.078950e-01 1 1  ON 25
 eO_6                 2.503662e-01 1 1  ON 26
 eO_7                 1.132030e-01 1 1  ON 27
 eO_8                 2.823161e-02 1 1  ON 28
 eO_9                 1.877744e-02 1 1  ON 29
eH1_0                -1.831429e-01 1 1  ON 30
eH1_1                -1.046003e-01 1 1  ON 31
eH1_2                -6.298376e-02 1 1  ON 32
eH1_3                -2.597134e-02 1 1  ON 33
eH1_4                 1.969103e-02 1 1  ON 34
eH1_5                 3.582383e-02 1 1  ON 35
eH1_6                 7.813459e-02 1 1  ON 36
eH1_7                 1.104801e-01 1 1  ON 37
eH1_8                 9.202461e-02 1 1  ON 38
eH1_9                 2.490443e-02 1 1  ON 39
eH2_0                -1.838046e-01 1 1  ON 40
eH2_1                -1.054878e-01 1 1  ON 41
eH2_2                -6.369703e-02 1 1  ON 42
eH2_3                -2.661382e-02 1 1  ON 43
eH2_4                 1.862728e-02 1 1  ON 44
eH2_5                 3.500711e-02 1 1  ON 45
eH2_6                 7.870941e-02 1 1  ON 46
eH2_7                 1.135398e-01 1 1  ON 47
eH2_8                 9.460346e-02 1 1  ON 48
eH2_9                 2.672737e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2497
    reference variance = 0.487268
====================================================
  Execution time = 3.1797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020858019
                                         uncertainty =       0.003372236129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020858019
                                         uncertainty =       0.003372236129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412324122
  error estimate for blocks of size 2^( 2) =       0.000423022896
  error estimate for blocks of size 2^( 3) =       0.000432808577
  error estimate for blocks of size 2^( 4) =       0.000439947980
  error estimate for blocks of size 2^( 5) =       0.000443736604
  error estimate for blocks of size 2^( 6) =       0.000446462773
  error estimate for blocks of size 2^( 7) =       0.000446445926

      target function =                  N/A
              le_mean =     -17.211073288779
             les_mean =     296.561065945101
             stat err =       0.000444148321
             autocorr =       1.160322097125
              std dev =       0.583114365623
             le_variance =       0.340022363396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721107328878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211073288779       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211073288507       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211073350320       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211073364597       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211073367881       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211073365201       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211073362891       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211073361680       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.589070e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211073288779       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211073288711       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211073304265       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211073307839       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211073308662       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211073307984       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211073307399       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211073307109       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 3.981398e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211073288779       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211073288762       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211073292657       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211073293550       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211073293756       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211073293586       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211073293440       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211073293368       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 9.958987e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0722e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.130594e-01 1 1  ON 0
 uu_1                 4.836162e-02 1 1  ON 1
 uu_2                -4.949644e-02 1 1  ON 2
 uu_3                -1.044232e-01 1 1  ON 3
 uu_4                -1.348471e-01 1 1  ON 4
 uu_5                -1.379109e-01 1 1  ON 5
 uu_6                -1.122379e-01 1 1  ON 6
 uu_7                -3.946849e-02 1 1  ON 7
 uu_8                 9.977197e-02 1 1  ON 8
 uu_9                 1.222501e-01 1 1  ON 9
 ud_0                 3.560448e-01 1 1  ON 10
 ud_1                 9.345776e-02 1 1  ON 11
 ud_2                -1.735176e-02 1 1  ON 12
 ud_3                -7.670405e-02 1 1  ON 13
 ud_4                -1.233444e-01 1 1  ON 14
 ud_5                -1.546504e-01 1 1  ON 15
 ud_6                -1.563563e-01 1 1  ON 16
 ud_7                -1.120629e-01 1 1  ON 17
 ud_8                 3.221940e-03 1 1  ON 18
 ud_9                 9.332841e-02 1 1  ON 19
 eO_0                -7.669141e-01 1 1  ON 20
 eO_1                -4.440536e-01 1 1  ON 21
 eO_2                -3.319946e-02 1 1  ON 22
 eO_3                 2.162011e-01 1 1  ON 23
 eO_4                 2.984445e-01 1 1  ON 24
 eO_5                 3.078959e-01 1 1  ON 25
 eO_6                 2.503668e-01 1 1  ON 26
 eO_7                 1.132040e-01 1 1  ON 27
 eO_8                 2.823179e-02 1 1  ON 28
 eO_9                 1.877751e-02 1 1  ON 29
eH1_0                -1.831427e-01 1 1  ON 30
eH1_1                -1.046014e-01 1 1  ON 31
eH1_2                -6.298389e-02 1 1  ON 32
eH1_3                -2.597119e-02 1 1  ON 33
eH1_4                 1.969060e-02 1 1  ON 34
eH1_5                 3.582379e-02 1 1  ON 35
eH1_6                 7.813511e-02 1 1  ON 36
eH1_7                 1.104801e-01 1 1  ON 37
eH1_8                 9.202513e-02 1 1  ON 38
eH1_9                 2.490460e-02 1 1  ON 39
eH2_0                -1.838051e-01 1 1  ON 40
eH2_1                -1.054888e-01 1 1  ON 41
eH2_2                -6.369625e-02 1 1  ON 42
eH2_3                -2.661332e-02 1 1  ON 43
eH2_4                 1.862668e-02 1 1  ON 44
eH2_5                 3.500703e-02 1 1  ON 45
eH2_6                 7.870951e-02 1 1  ON 46
eH2_7                 1.135398e-01 1 1  ON 47
eH2_8                 9.460402e-02 1 1  ON 48
eH2_9                 2.672753e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1476
    reference variance = 0.861125
====================================================
  Execution time = 3.0831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3838e-01
  Total weights = 2.0000e+06
  Execution time = 2.6522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285468750
                                         uncertainty =       0.002928834434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285468750
                                         uncertainty =       0.002928834434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411323490
  error estimate for blocks of size 2^( 2) =       0.000421627664
  error estimate for blocks of size 2^( 3) =       0.000430462974
  error estimate for blocks of size 2^( 4) =       0.000437443308
  error estimate for blocks of size 2^( 5) =       0.000442517884
  error estimate for blocks of size 2^( 6) =       0.000444924084
  error estimate for blocks of size 2^( 7) =       0.000445852220

      target function =                  N/A
              le_mean =     -17.211077480001
             les_mean =     296.559561880628
             stat err =       0.000442684374
             autocorr =       1.158300809278
              std dev =       0.581699258403
             le_variance =       0.338374027226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291201199
                                         uncertainty =       0.002928863472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338291201199
                                         uncertainty =       0.002928863472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411326977
  error estimate for blocks of size 2^( 2) =       0.000421630941
  error estimate for blocks of size 2^( 3) =       0.000430465987
  error estimate for blocks of size 2^( 4) =       0.000437446152
  error estimate for blocks of size 2^( 5) =       0.000442520609
  error estimate for blocks of size 2^( 6) =       0.000444926945
  error estimate for blocks of size 2^( 7) =       0.000445854998

      target function =                  N/A
              le_mean =     -17.211077504237
             les_mean =     296.559568451591
             stat err =       0.000442687176
             autocorr =       1.158295837725
              std dev =       0.581704189360
             le_variance =       0.338379763919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338288354423
                                         uncertainty =       0.002928849004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338288354423
                                         uncertainty =       0.002928849004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411325245
  error estimate for blocks of size 2^( 2) =       0.000421629314
  error estimate for blocks of size 2^( 3) =       0.000430464491
  error estimate for blocks of size 2^( 4) =       0.000437444740
  error estimate for blocks of size 2^( 5) =       0.000442519256
  error estimate for blocks of size 2^( 6) =       0.000444925524
  error estimate for blocks of size 2^( 7) =       0.000445853618

      target function =                  N/A
              le_mean =     -17.211077492183
             les_mean =     296.559565187781
             stat err =       0.000442685785
             autocorr =       1.158298307501
              std dev =       0.581701740613
             le_variance =       0.338376915032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285830053
                                         uncertainty =       0.002928836257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338285830053
                                         uncertainty =       0.002928836257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411323710
  error estimate for blocks of size 2^( 2) =       0.000421627870
  error estimate for blocks of size 2^( 3) =       0.000430463164
  error estimate for blocks of size 2^( 4) =       0.000437443487
  error estimate for blocks of size 2^( 5) =       0.000442518056
  error estimate for blocks of size 2^( 6) =       0.000444924264
  error estimate for blocks of size 2^( 7) =       0.000445852395

      target function =                  N/A
              le_mean =     -17.211077481522
             les_mean =     296.559562294575
             stat err =       0.000442684550
             autocorr =       1.158300496038
              std dev =       0.581699569190
             le_variance =       0.338374388796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211077480001        initial
     3.7253e+01     3.7253e+02             1.5891e-05       -17.211077504237  <--
     1.4901e+02     1.4901e+03             3.9814e-06       -17.211077492183
     5.9605e+02     5.9605e+03             9.9590e-07       -17.211077481522

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 4.7729e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.130631e-01 1 1  ON 0
 uu_1                 4.836357e-02 1 1  ON 1
 uu_2                -4.949448e-02 1 1  ON 2
 uu_3                -1.044237e-01 1 1  ON 3
 uu_4                -1.348478e-01 1 1  ON 4
 uu_5                -1.379149e-01 1 1  ON 5
 uu_6                -1.122399e-01 1 1  ON 6
 uu_7                -3.947032e-02 1 1  ON 7
 uu_8                 9.977052e-02 1 1  ON 8
 uu_9                 1.222513e-01 1 1  ON 9
 ud_0                 3.560505e-01 1 1  ON 10
 ud_1                 9.346011e-02 1 1  ON 11
 ud_2                -1.735175e-02 1 1  ON 12
 ud_3                -7.670392e-02 1 1  ON 13
 ud_4                -1.233474e-01 1 1  ON 14
 ud_5                -1.546534e-01 1 1  ON 15
 ud_6                -1.563585e-01 1 1  ON 16
 ud_7                -1.120634e-01 1 1  ON 17
 ud_8                 3.220104e-03 1 1  ON 18
 ud_9                 9.332898e-02 1 1  ON 19
 eO_0                -7.669239e-01 1 1  ON 20
 eO_1                -4.440655e-01 1 1  ON 21
 eO_2                -3.320335e-02 1 1  ON 22
 eO_3                 2.162076e-01 1 1  ON 23
 eO_4                 2.984553e-01 1 1  ON 24
 eO_5                 3.078985e-01 1 1  ON 25
 eO_6                 2.503686e-01 1 1  ON 26
 eO_7                 1.132068e-01 1 1  ON 27
 eO_8                 2.823233e-02 1 1  ON 28
 eO_9                 1.877773e-02 1 1  ON 29
eH1_0                -1.831422e-01 1 1  ON 30
eH1_1                -1.046045e-01 1 1  ON 31
eH1_2                -6.298428e-02 1 1  ON 32
eH1_3                -2.597076e-02 1 1  ON 33
eH1_4                 1.968933e-02 1 1  ON 34
eH1_5                 3.582367e-02 1 1  ON 35
eH1_6                 7.813666e-02 1 1  ON 36
eH1_7                 1.104801e-01 1 1  ON 37
eH1_8                 9.202668e-02 1 1  ON 38
eH1_9                 2.490510e-02 1 1  ON 39
eH2_0                -1.838064e-01 1 1  ON 40
eH2_1                -1.054919e-01 1 1  ON 41
eH2_2                -6.369392e-02 1 1  ON 42
eH2_3                -2.661184e-02 1 1  ON 43
eH2_4                 1.862489e-02 1 1  ON 44
eH2_5                 3.500676e-02 1 1  ON 45
eH2_6                 7.870981e-02 1 1  ON 46
eH2_7                 1.135398e-01 1 1  ON 47
eH2_8                 9.460571e-02 1 1  ON 48
eH2_9                 2.672800e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2797
    reference variance = 0.214056
====================================================
  Execution time = 3.1517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343153109373
                                         uncertainty =       0.003605984178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343153109373
                                         uncertainty =       0.003605984178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414142697
  error estimate for blocks of size 2^( 2) =       0.000424737150
  error estimate for blocks of size 2^( 3) =       0.000434276490
  error estimate for blocks of size 2^( 4) =       0.000441553350
  error estimate for blocks of size 2^( 5) =       0.000445230003
  error estimate for blocks of size 2^( 6) =       0.000447569867
  error estimate for blocks of size 2^( 7) =       0.000449593739

      target function =                  N/A
              le_mean =     -17.210832492831
             les_mean =     296.555783271977
             stat err =       0.000445986740
             autocorr =       1.159695247978
              std dev =       0.585686219056
             le_variance =       0.343028347192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721083249283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210832492831       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210832603709       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210832655152       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210832724033       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210832583621       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210832630170       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210832661252       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210832664690       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 5.854053e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210832492831       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210832521009       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210832534063       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210832551806       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210832516473       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210832527603       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210832535379       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210832536230       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.464859e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210832492831       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210832499905       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210832503181       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210832507650       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210832498804       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210832501553       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210832503497       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210832503710       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 3.662972e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0332e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.130683e-01 1 1  ON 0
 uu_1                 4.836536e-02 1 1  ON 1
 uu_2                -4.949237e-02 1 1  ON 2
 uu_3                -1.044232e-01 1 1  ON 3
 uu_4                -1.348498e-01 1 1  ON 4
 uu_5                -1.379178e-01 1 1  ON 5
 uu_6                -1.122421e-01 1 1  ON 6
 uu_7                -3.947388e-02 1 1  ON 7
 uu_8                 9.976879e-02 1 1  ON 8
 uu_9                 1.222529e-01 1 1  ON 9
 ud_0                 3.560563e-01 1 1  ON 10
 ud_1                 9.346256e-02 1 1  ON 11
 ud_2                -1.734926e-02 1 1  ON 12
 ud_3                -7.670300e-02 1 1  ON 13
 ud_4                -1.233505e-01 1 1  ON 14
 ud_5                -1.546553e-01 1 1  ON 15
 ud_6                -1.563601e-01 1 1  ON 16
 ud_7                -1.120651e-01 1 1  ON 17
 ud_8                 3.216273e-03 1 1  ON 18
 ud_9                 9.332866e-02 1 1  ON 19
 eO_0                -7.669381e-01 1 1  ON 20
 eO_1                -4.440783e-01 1 1  ON 21
 eO_2                -3.321088e-02 1 1  ON 22
 eO_3                 2.162158e-01 1 1  ON 23
 eO_4                 2.984699e-01 1 1  ON 24
 eO_5                 3.079044e-01 1 1  ON 25
 eO_6                 2.503707e-01 1 1  ON 26
 eO_7                 1.132098e-01 1 1  ON 27
 eO_8                 2.823289e-02 1 1  ON 28
 eO_9                 1.877782e-02 1 1  ON 29
eH1_0                -1.831426e-01 1 1  ON 30
eH1_1                -1.046053e-01 1 1  ON 31
eH1_2                -6.298333e-02 1 1  ON 32
eH1_3                -2.597076e-02 1 1  ON 33
eH1_4                 1.968935e-02 1 1  ON 34
eH1_5                 3.582333e-02 1 1  ON 35
eH1_6                 7.813660e-02 1 1  ON 36
eH1_7                 1.104788e-01 1 1  ON 37
eH1_8                 9.202818e-02 1 1  ON 38
eH1_9                 2.490557e-02 1 1  ON 39
eH2_0                -1.838090e-01 1 1  ON 40
eH2_1                -1.054894e-01 1 1  ON 41
eH2_2                -6.369609e-02 1 1  ON 42
eH2_3                -2.661335e-02 1 1  ON 43
eH2_4                 1.862509e-02 1 1  ON 44
eH2_5                 3.500687e-02 1 1  ON 45
eH2_6                 7.871126e-02 1 1  ON 46
eH2_7                 1.135393e-01 1 1  ON 47
eH2_8                 9.460750e-02 1 1  ON 48
eH2_9                 2.672867e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.285
    reference variance = 0.430999
====================================================
  Execution time = 3.0914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4336e-01
  Total weights = 2.0000e+06
  Execution time = 2.6789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343330145892
                                         uncertainty =       0.004500875850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343330145892
                                         uncertainty =       0.004500875850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414337781
  error estimate for blocks of size 2^( 2) =       0.000424973270
  error estimate for blocks of size 2^( 3) =       0.000434584013
  error estimate for blocks of size 2^( 4) =       0.000440972439
  error estimate for blocks of size 2^( 5) =       0.000446207709
  error estimate for blocks of size 2^( 6) =       0.000448262682
  error estimate for blocks of size 2^( 7) =       0.000449336337

      target function =                  N/A
              le_mean =     -17.211278871493
             les_mean =     296.571471813887
             stat err =       0.000446194792
             autocorr =       1.159684685811
              std dev =       0.585962109061
             le_variance =       0.343351593255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343344598898
                                         uncertainty =       0.004501097464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343344598898
                                         uncertainty =       0.004501097464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414346503
  error estimate for blocks of size 2^( 2) =       0.000424981575
  error estimate for blocks of size 2^( 3) =       0.000434591768
  error estimate for blocks of size 2^( 4) =       0.000440979731
  error estimate for blocks of size 2^( 5) =       0.000446214729
  error estimate for blocks of size 2^( 6) =       0.000448269479
  error estimate for blocks of size 2^( 7) =       0.000449342514

      target function =                  N/A
              le_mean =     -17.211278892423
             les_mean =     296.571486990245
             stat err =       0.000446201613
             autocorr =       1.159671319623
              std dev =       0.585974444114
             le_variance =       0.343366049155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343337543679
                                         uncertainty =       0.004500989016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343337543679
                                         uncertainty =       0.004500989016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414342245
  error estimate for blocks of size 2^( 2) =       0.000424977522
  error estimate for blocks of size 2^( 3) =       0.000434587987
  error estimate for blocks of size 2^( 4) =       0.000440976178
  error estimate for blocks of size 2^( 5) =       0.000446211309
  error estimate for blocks of size 2^( 6) =       0.000448266168
  error estimate for blocks of size 2^( 7) =       0.000449339503

      target function =                  N/A
              le_mean =     -17.211278882087
             les_mean =     296.571479577882
             stat err =       0.000446198290
             autocorr =       1.159677877850
              std dev =       0.585968422845
             le_variance =       0.343358992571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343331076122
                                         uncertainty =       0.004500890073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343331076122
                                         uncertainty =       0.004500890073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414338342
  error estimate for blocks of size 2^( 2) =       0.000424973804
  error estimate for blocks of size 2^( 3) =       0.000434584513
  error estimate for blocks of size 2^( 4) =       0.000440972910
  error estimate for blocks of size 2^( 5) =       0.000446208162
  error estimate for blocks of size 2^( 6) =       0.000448263121
  error estimate for blocks of size 2^( 7) =       0.000449336735

      target function =                  N/A
              le_mean =     -17.211278872799
             les_mean =     296.571472789243
             stat err =       0.000446195232
             autocorr =       1.159683830608
              std dev =       0.585962902989
             le_variance =       0.343352523679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211278871493        initial
     9.3132e+00     9.3132e+01             5.8541e-05       -17.211278892423  <--
     3.7253e+01     3.7253e+02             1.4649e-05       -17.211278882087
     1.4901e+02     1.4901e+03             3.6630e-06       -17.211278872799

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 4.4353e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.130837e-01 1 1  ON 0
 uu_1                 4.837085e-02 1 1  ON 1
 uu_2                -4.948606e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348558e-01 1 1  ON 4
 uu_5                -1.379266e-01 1 1  ON 5
 uu_6                -1.122488e-01 1 1  ON 6
 uu_7                -3.948454e-02 1 1  ON 7
 uu_8                 9.976361e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560731e-01 1 1  ON 10
 ud_1                 9.347006e-02 1 1  ON 11
 ud_2                -1.734182e-02 1 1  ON 12
 ud_3                -7.670030e-02 1 1  ON 13
 ud_4                -1.233596e-01 1 1  ON 14
 ud_5                -1.546609e-01 1 1  ON 15
 ud_6                -1.563651e-01 1 1  ON 16
 ud_7                -1.120700e-01 1 1  ON 17
 ud_8                 3.204804e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669807e-01 1 1  ON 20
 eO_1                -4.441166e-01 1 1  ON 21
 eO_2                -3.323324e-02 1 1  ON 22
 eO_3                 2.162402e-01 1 1  ON 23
 eO_4                 2.985138e-01 1 1  ON 24
 eO_5                 3.079222e-01 1 1  ON 25
 eO_6                 2.503767e-01 1 1  ON 26
 eO_7                 1.132189e-01 1 1  ON 27
 eO_8                 2.823456e-02 1 1  ON 28
 eO_9                 1.877811e-02 1 1  ON 29
eH1_0                -1.831439e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298060e-02 1 1  ON 32
eH1_3                -2.597063e-02 1 1  ON 33
eH1_4                 1.968936e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813644e-02 1 1  ON 36
eH1_7                 1.104747e-01 1 1  ON 37
eH1_8                 9.203267e-02 1 1  ON 38
eH1_9                 2.490698e-02 1 1  ON 39
eH2_0                -1.838165e-01 1 1  ON 40
eH2_1                -1.054822e-01 1 1  ON 41
eH2_2                -6.370247e-02 1 1  ON 42
eH2_3                -2.661778e-02 1 1  ON 43
eH2_4                 1.862560e-02 1 1  ON 44
eH2_5                 3.500721e-02 1 1  ON 45
eH2_6                 7.871560e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461287e-02 1 1  ON 48
eH2_9                 2.673066e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1146
    reference variance = 0.750523
====================================================
  Execution time = 3.1486e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4668e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346720875075
                                         uncertainty =       0.003992696114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346720875075
                                         uncertainty =       0.003992696114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416339170
  error estimate for blocks of size 2^( 2) =       0.000426853195
  error estimate for blocks of size 2^( 3) =       0.000436362330
  error estimate for blocks of size 2^( 4) =       0.000443606474
  error estimate for blocks of size 2^( 5) =       0.000446807938
  error estimate for blocks of size 2^( 6) =       0.000448675709
  error estimate for blocks of size 2^( 7) =       0.000450874285

      target function =                  N/A
              le_mean =     -17.211179552002
             les_mean =     296.571378006690
             stat err =       0.000447491102
             autocorr =       1.155245442028
              std dev =       0.588792500626
             le_variance =       0.346676608793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721117955200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211179552002       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211179922493       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211180233250       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211180641395       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211180928056       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211180709830       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211180564198       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211180579679       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 2.422655e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211179552002       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211179652611       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211179733829       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211179839278       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211179919388       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211179869684       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211179829390       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211179830424       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 6.088366e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211179552002       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211179577708       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211179598253       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211179624817       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211179645412       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211179633466       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211179623144       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211179623230       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.523997e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0615e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.131184e-01 1 1  ON 0
 uu_1                 4.836897e-02 1 1  ON 1
 uu_2                -4.947535e-02 1 1  ON 2
 uu_3                -1.044204e-01 1 1  ON 3
 uu_4                -1.348644e-01 1 1  ON 4
 uu_5                -1.379368e-01 1 1  ON 5
 uu_6                -1.122647e-01 1 1  ON 6
 uu_7                -3.949925e-02 1 1  ON 7
 uu_8                 9.975402e-02 1 1  ON 8
 uu_9                 1.222639e-01 1 1  ON 9
 ud_0                 3.561009e-01 1 1  ON 10
 ud_1                 9.347714e-02 1 1  ON 11
 ud_2                -1.733208e-02 1 1  ON 12
 ud_3                -7.670387e-02 1 1  ON 13
 ud_4                -1.233710e-01 1 1  ON 14
 ud_5                -1.546688e-01 1 1  ON 15
 ud_6                -1.563700e-01 1 1  ON 16
 ud_7                -1.120786e-01 1 1  ON 17
 ud_8                 3.189161e-03 1 1  ON 18
 ud_9                 9.332725e-02 1 1  ON 19
 eO_0                -7.670297e-01 1 1  ON 20
 eO_1                -4.441676e-01 1 1  ON 21
 eO_2                -3.326362e-02 1 1  ON 22
 eO_3                 2.162615e-01 1 1  ON 23
 eO_4                 2.985747e-01 1 1  ON 24
 eO_5                 3.079468e-01 1 1  ON 25
 eO_6                 2.503857e-01 1 1  ON 26
 eO_7                 1.132294e-01 1 1  ON 27
 eO_8                 2.823644e-02 1 1  ON 28
 eO_9                 1.877906e-02 1 1  ON 29
eH1_0                -1.831556e-01 1 1  ON 30
eH1_1                -1.046191e-01 1 1  ON 31
eH1_2                -6.297153e-02 1 1  ON 32
eH1_3                -2.597323e-02 1 1  ON 33
eH1_4                 1.968972e-02 1 1  ON 34
eH1_5                 3.583017e-02 1 1  ON 35
eH1_6                 7.814106e-02 1 1  ON 36
eH1_7                 1.104703e-01 1 1  ON 37
eH1_8                 9.203889e-02 1 1  ON 38
eH1_9                 2.490883e-02 1 1  ON 39
eH2_0                -1.838246e-01 1 1  ON 40
eH2_1                -1.054916e-01 1 1  ON 41
eH2_2                -6.369991e-02 1 1  ON 42
eH2_3                -2.663223e-02 1 1  ON 43
eH2_4                 1.863530e-02 1 1  ON 44
eH2_5                 3.501159e-02 1 1  ON 45
eH2_6                 7.872074e-02 1 1  ON 46
eH2_7                 1.135365e-01 1 1  ON 47
eH2_8                 9.462028e-02 1 1  ON 48
eH2_9                 2.673293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.275
    reference variance = 0.348587
====================================================
  Execution time = 3.1049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4474e-01
  Total weights = 2.0000e+06
  Execution time = 2.6727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344720597802
                                         uncertainty =       0.003837241387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344720597802
                                         uncertainty =       0.003837241387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415163544
  error estimate for blocks of size 2^( 2) =       0.000425618509
  error estimate for blocks of size 2^( 3) =       0.000435382623
  error estimate for blocks of size 2^( 4) =       0.000443094377
  error estimate for blocks of size 2^( 5) =       0.000446539356
  error estimate for blocks of size 2^( 6) =       0.000447382930
  error estimate for blocks of size 2^( 7) =       0.000449689018

      target function =                  N/A
              le_mean =     -17.211604112572
             les_mean =     296.584037491515
             stat err =       0.000446676420
             autocorr =       1.157570986061
              std dev =       0.587129914063
             le_variance =       0.344721535987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344779773201
                                         uncertainty =       0.003837257635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344779773201
                                         uncertainty =       0.003837257635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415199195
  error estimate for blocks of size 2^( 2) =       0.000425652986
  error estimate for blocks of size 2^( 3) =       0.000435415559
  error estimate for blocks of size 2^( 4) =       0.000443125433
  error estimate for blocks of size 2^( 5) =       0.000446569222
  error estimate for blocks of size 2^( 6) =       0.000447412715
  error estimate for blocks of size 2^( 7) =       0.000449717002

      target function =                  N/A
              le_mean =     -17.211603351774
             les_mean =     296.584070509679
             stat err =       0.000446706093
             autocorr =       1.157525979704
              std dev =       0.587180332835
             le_variance =       0.344780743268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344752686372
                                         uncertainty =       0.003837247826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344752686372
                                         uncertainty =       0.003837247826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415182877
  error estimate for blocks of size 2^( 2) =       0.000425637245
  error estimate for blocks of size 2^( 3) =       0.000435400585
  error estimate for blocks of size 2^( 4) =       0.000443111408
  error estimate for blocks of size 2^( 5) =       0.000446555705
  error estimate for blocks of size 2^( 6) =       0.000447399223
  error estimate for blocks of size 2^( 7) =       0.000449704310

      target function =                  N/A
              le_mean =     -17.211603684648
             les_mean =     296.584054867304
             stat err =       0.000446692661
             autocorr =       1.157547356780
              std dev =       0.587157255152
             le_variance =       0.344753642278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344724696482
                                         uncertainty =       0.003837242195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344724696482
                                         uncertainty =       0.003837242195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415166013
  error estimate for blocks of size 2^( 2) =       0.000425620903
  error estimate for blocks of size 2^( 3) =       0.000435384920
  error estimate for blocks of size 2^( 4) =       0.000443096558
  error estimate for blocks of size 2^( 5) =       0.000446541448
  error estimate for blocks of size 2^( 6) =       0.000447385015
  error estimate for blocks of size 2^( 7) =       0.000449690974

      target function =                  N/A
              le_mean =     -17.211604056619
             les_mean =     296.584039666392
             stat err =       0.000446678499
             autocorr =       1.157567989830
              std dev =       0.587133406427
             le_variance =       0.344725636943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211604112572        initial  <--
     2.3283e+00     2.3283e+01             2.4227e-04       -17.211603351774
     9.3132e+00     9.3132e+01             6.0884e-05       -17.211603684648
     3.7253e+01     3.7253e+02             1.5240e-05       -17.211604056619

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4478
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.130837e-01 1 1  ON 0
 uu_1                 4.837085e-02 1 1  ON 1
 uu_2                -4.948606e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348558e-01 1 1  ON 4
 uu_5                -1.379266e-01 1 1  ON 5
 uu_6                -1.122488e-01 1 1  ON 6
 uu_7                -3.948454e-02 1 1  ON 7
 uu_8                 9.976361e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560731e-01 1 1  ON 10
 ud_1                 9.347006e-02 1 1  ON 11
 ud_2                -1.734182e-02 1 1  ON 12
 ud_3                -7.670030e-02 1 1  ON 13
 ud_4                -1.233596e-01 1 1  ON 14
 ud_5                -1.546609e-01 1 1  ON 15
 ud_6                -1.563651e-01 1 1  ON 16
 ud_7                -1.120700e-01 1 1  ON 17
 ud_8                 3.204804e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669807e-01 1 1  ON 20
 eO_1                -4.441166e-01 1 1  ON 21
 eO_2                -3.323324e-02 1 1  ON 22
 eO_3                 2.162402e-01 1 1  ON 23
 eO_4                 2.985138e-01 1 1  ON 24
 eO_5                 3.079222e-01 1 1  ON 25
 eO_6                 2.503767e-01 1 1  ON 26
 eO_7                 1.132189e-01 1 1  ON 27
 eO_8                 2.823456e-02 1 1  ON 28
 eO_9                 1.877811e-02 1 1  ON 29
eH1_0                -1.831439e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298060e-02 1 1  ON 32
eH1_3                -2.597063e-02 1 1  ON 33
eH1_4                 1.968936e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813644e-02 1 1  ON 36
eH1_7                 1.104747e-01 1 1  ON 37
eH1_8                 9.203267e-02 1 1  ON 38
eH1_9                 2.490698e-02 1 1  ON 39
eH2_0                -1.838165e-01 1 1  ON 40
eH2_1                -1.054822e-01 1 1  ON 41
eH2_2                -6.370247e-02 1 1  ON 42
eH2_3                -2.661778e-02 1 1  ON 43
eH2_4                 1.862560e-02 1 1  ON 44
eH2_5                 3.500721e-02 1 1  ON 45
eH2_6                 7.871560e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461287e-02 1 1  ON 48
eH2_9                 2.673066e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2139
    reference variance = 0.217755
====================================================
  Execution time = 3.1519e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4081e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340917952986
                                         uncertainty =       0.003708530749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340917952986
                                         uncertainty =       0.003708530749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412801687
  error estimate for blocks of size 2^( 2) =       0.000423492643
  error estimate for blocks of size 2^( 3) =       0.000433010540
  error estimate for blocks of size 2^( 4) =       0.000440182201
  error estimate for blocks of size 2^( 5) =       0.000445523596
  error estimate for blocks of size 2^( 6) =       0.000446608963
  error estimate for blocks of size 2^( 7) =       0.000446689107

      target function =                  N/A
              le_mean =     -17.211374979983
             les_mean =     296.572238996588
             stat err =       0.000444750967
             autocorr =       1.160782561119
              std dev =       0.583789744188
             le_variance =       0.340810465420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721137497998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211374979983       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211374970069       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211374939263       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211374977058       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211374997470       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211375006931       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211375010482       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 2.507702e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211374979983       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211374977489       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211374969737       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211374978797       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211374984253       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211374986689       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211374987533       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 6.271415e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211374979983       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211374979358       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211374977417       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211374979657       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211374981044       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211374981657       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211374981865       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 1.567986e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0488e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.130856e-01 1 1  ON 0
 uu_1                 4.837134e-02 1 1  ON 1
 uu_2                -4.948540e-02 1 1  ON 2
 uu_3                -1.044218e-01 1 1  ON 3
 uu_4                -1.348566e-01 1 1  ON 4
 uu_5                -1.379278e-01 1 1  ON 5
 uu_6                -1.122502e-01 1 1  ON 6
 uu_7                -3.948560e-02 1 1  ON 7
 uu_8                 9.976302e-02 1 1  ON 8
 uu_9                 1.222584e-01 1 1  ON 9
 ud_0                 3.560746e-01 1 1  ON 10
 ud_1                 9.347130e-02 1 1  ON 11
 ud_2                -1.734112e-02 1 1  ON 12
 ud_3                -7.670002e-02 1 1  ON 13
 ud_4                -1.233594e-01 1 1  ON 14
 ud_5                -1.546634e-01 1 1  ON 15
 ud_6                -1.563663e-01 1 1  ON 16
 ud_7                -1.120701e-01 1 1  ON 17
 ud_8                 3.203816e-03 1 1  ON 18
 ud_9                 9.332783e-02 1 1  ON 19
 eO_0                -7.669861e-01 1 1  ON 20
 eO_1                -4.441212e-01 1 1  ON 21
 eO_2                -3.323647e-02 1 1  ON 22
 eO_3                 2.162428e-01 1 1  ON 23
 eO_4                 2.985201e-01 1 1  ON 24
 eO_5                 3.079239e-01 1 1  ON 25
 eO_6                 2.503776e-01 1 1  ON 26
 eO_7                 1.132202e-01 1 1  ON 27
 eO_8                 2.823487e-02 1 1  ON 28
 eO_9                 1.877825e-02 1 1  ON 29
eH1_0                -1.831438e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298063e-02 1 1  ON 32
eH1_3                -2.597081e-02 1 1  ON 33
eH1_4                 1.968892e-02 1 1  ON 34
eH1_5                 3.582217e-02 1 1  ON 35
eH1_6                 7.813662e-02 1 1  ON 36
eH1_7                 1.104750e-01 1 1  ON 37
eH1_8                 9.203351e-02 1 1  ON 38
eH1_9                 2.490727e-02 1 1  ON 39
eH2_0                -1.838180e-01 1 1  ON 40
eH2_1                -1.054825e-01 1 1  ON 41
eH2_2                -6.370266e-02 1 1  ON 42
eH2_3                -2.661724e-02 1 1  ON 43
eH2_4                 1.862602e-02 1 1  ON 44
eH2_5                 3.500681e-02 1 1  ON 45
eH2_6                 7.871618e-02 1 1  ON 46
eH2_7                 1.135375e-01 1 1  ON 47
eH2_8                 9.461348e-02 1 1  ON 48
eH2_9                 2.673087e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1745
    reference variance = 0.273947
====================================================
  Execution time = 3.0891e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4301e-01
  Total weights = 2.0000e+06
  Execution time = 2.6434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343133774140
                                         uncertainty =       0.005701068324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343133774140
                                         uncertainty =       0.005701068324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414133878
  error estimate for blocks of size 2^( 2) =       0.000424539876
  error estimate for blocks of size 2^( 3) =       0.000433533795
  error estimate for blocks of size 2^( 4) =       0.000440341479
  error estimate for blocks of size 2^( 5) =       0.000444924556
  error estimate for blocks of size 2^( 6) =       0.000448218271
  error estimate for blocks of size 2^( 7) =       0.000450046205

      target function =                  N/A
              le_mean =     -17.210922252734
             les_mean =     296.558858356651
             stat err =       0.000445882628
             autocorr =       1.159203235938
              std dev =       0.585673747497
             le_variance =       0.343013738507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343136991416
                                         uncertainty =       0.005701114487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343136991416
                                         uncertainty =       0.005701114487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414135818
  error estimate for blocks of size 2^( 2) =       0.000424541682
  error estimate for blocks of size 2^( 3) =       0.000433535405
  error estimate for blocks of size 2^( 4) =       0.000440342974
  error estimate for blocks of size 2^( 5) =       0.000444926055
  error estimate for blocks of size 2^( 6) =       0.000448219706
  error estimate for blocks of size 2^( 7) =       0.000450047646

      target function =                  N/A
              le_mean =     -17.210922236575
             les_mean =     296.558861013358
             stat err =       0.000445884095
             autocorr =       1.159200007754
              std dev =       0.585676490419
             le_variance =       0.343016951430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343135384561
                                         uncertainty =       0.005701091498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343135384561
                                         uncertainty =       0.005701091498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414134849
  error estimate for blocks of size 2^( 2) =       0.000424540780
  error estimate for blocks of size 2^( 3) =       0.000433534601
  error estimate for blocks of size 2^( 4) =       0.000440342227
  error estimate for blocks of size 2^( 5) =       0.000444925307
  error estimate for blocks of size 2^( 6) =       0.000448218989
  error estimate for blocks of size 2^( 7) =       0.000450046926

      target function =                  N/A
              le_mean =     -17.210922244455
             les_mean =     296.558859679914
             stat err =       0.000445883362
             autocorr =       1.159201619881
              std dev =       0.585675120468
             le_variance =       0.343015346735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343133975482
                                         uncertainty =       0.005701071224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343133975482
                                         uncertainty =       0.005701071224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414134000
  error estimate for blocks of size 2^( 2) =       0.000424539989
  error estimate for blocks of size 2^( 3) =       0.000433533896
  error estimate for blocks of size 2^( 4) =       0.000440341573
  error estimate for blocks of size 2^( 5) =       0.000444924650
  error estimate for blocks of size 2^( 6) =       0.000448218361
  error estimate for blocks of size 2^( 7) =       0.000450046295

      target function =                  N/A
              le_mean =     -17.210922251690
             les_mean =     296.558858521774
             stat err =       0.000445882720
             autocorr =       1.159203033851
              std dev =       0.585673919152
             le_variance =       0.343013939574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210922252734        initial  <--
     2.3283e+01     2.3283e+02             2.5077e-05       -17.210922236575
     9.3132e+01     9.3132e+02             6.2714e-06       -17.210922244455
     3.7253e+02     3.7253e+03             1.5680e-06       -17.210922251690

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2294
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.130837e-01 1 1  ON 0
 uu_1                 4.837085e-02 1 1  ON 1
 uu_2                -4.948606e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348558e-01 1 1  ON 4
 uu_5                -1.379266e-01 1 1  ON 5
 uu_6                -1.122488e-01 1 1  ON 6
 uu_7                -3.948454e-02 1 1  ON 7
 uu_8                 9.976361e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560731e-01 1 1  ON 10
 ud_1                 9.347006e-02 1 1  ON 11
 ud_2                -1.734182e-02 1 1  ON 12
 ud_3                -7.670030e-02 1 1  ON 13
 ud_4                -1.233596e-01 1 1  ON 14
 ud_5                -1.546609e-01 1 1  ON 15
 ud_6                -1.563651e-01 1 1  ON 16
 ud_7                -1.120700e-01 1 1  ON 17
 ud_8                 3.204804e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669807e-01 1 1  ON 20
 eO_1                -4.441166e-01 1 1  ON 21
 eO_2                -3.323324e-02 1 1  ON 22
 eO_3                 2.162402e-01 1 1  ON 23
 eO_4                 2.985138e-01 1 1  ON 24
 eO_5                 3.079222e-01 1 1  ON 25
 eO_6                 2.503767e-01 1 1  ON 26
 eO_7                 1.132189e-01 1 1  ON 27
 eO_8                 2.823456e-02 1 1  ON 28
 eO_9                 1.877811e-02 1 1  ON 29
eH1_0                -1.831439e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298060e-02 1 1  ON 32
eH1_3                -2.597063e-02 1 1  ON 33
eH1_4                 1.968936e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813644e-02 1 1  ON 36
eH1_7                 1.104747e-01 1 1  ON 37
eH1_8                 9.203267e-02 1 1  ON 38
eH1_9                 2.490698e-02 1 1  ON 39
eH2_0                -1.838165e-01 1 1  ON 40
eH2_1                -1.054822e-01 1 1  ON 41
eH2_2                -6.370247e-02 1 1  ON 42
eH2_3                -2.661778e-02 1 1  ON 43
eH2_4                 1.862560e-02 1 1  ON 44
eH2_5                 3.500721e-02 1 1  ON 45
eH2_6                 7.871560e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461287e-02 1 1  ON 48
eH2_9                 2.673066e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2148
    reference variance = 0.267775
====================================================
  Execution time = 3.1487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343905277950
                                         uncertainty =       0.004302042141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343905277950
                                         uncertainty =       0.004302042141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414603240
  error estimate for blocks of size 2^( 2) =       0.000424841439
  error estimate for blocks of size 2^( 3) =       0.000434568712
  error estimate for blocks of size 2^( 4) =       0.000441606876
  error estimate for blocks of size 2^( 5) =       0.000446226777
  error estimate for blocks of size 2^( 6) =       0.000448174361
  error estimate for blocks of size 2^( 7) =       0.000449741640

      target function =                  N/A
              le_mean =     -17.210935557349
             les_mean =     296.560094281257
             stat err =       0.000446437413
             autocorr =       1.159460030886
              std dev =       0.586337525614
             le_variance =       0.343791693943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721093555735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210935557349       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210935560034       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210935571016       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210935571017       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210935566855       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210935568292       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210935568113       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210935568479       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 2.250824e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210935557349       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210935558020       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210935560768       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210935560770       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210935559729       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210935560087       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210935560043       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210935560134       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 5.627232e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210935557349       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210935557517       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210935558204       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210935558204       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210935557944       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210935558034       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210935558020       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210935558045       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 1.406819e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3544e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.130841e-01 1 1  ON 0
 uu_1                 4.837095e-02 1 1  ON 1
 uu_2                -4.948606e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348559e-01 1 1  ON 4
 uu_5                -1.379266e-01 1 1  ON 5
 uu_6                -1.122490e-01 1 1  ON 6
 uu_7                -3.948473e-02 1 1  ON 7
 uu_8                 9.976352e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560734e-01 1 1  ON 10
 ud_1                 9.347019e-02 1 1  ON 11
 ud_2                -1.734172e-02 1 1  ON 12
 ud_3                -7.670031e-02 1 1  ON 13
 ud_4                -1.233597e-01 1 1  ON 14
 ud_5                -1.546611e-01 1 1  ON 15
 ud_6                -1.563652e-01 1 1  ON 16
 ud_7                -1.120701e-01 1 1  ON 17
 ud_8                 3.204659e-03 1 1  ON 18
 ud_9                 9.332767e-02 1 1  ON 19
 eO_0                -7.669812e-01 1 1  ON 20
 eO_1                -4.441170e-01 1 1  ON 21
 eO_2                -3.323358e-02 1 1  ON 22
 eO_3                 2.162406e-01 1 1  ON 23
 eO_4                 2.985144e-01 1 1  ON 24
 eO_5                 3.079224e-01 1 1  ON 25
 eO_6                 2.503768e-01 1 1  ON 26
 eO_7                 1.132190e-01 1 1  ON 27
 eO_8                 2.823457e-02 1 1  ON 28
 eO_9                 1.877812e-02 1 1  ON 29
eH1_0                -1.831440e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298055e-02 1 1  ON 32
eH1_3                -2.597058e-02 1 1  ON 33
eH1_4                 1.968928e-02 1 1  ON 34
eH1_5                 3.582226e-02 1 1  ON 35
eH1_6                 7.813650e-02 1 1  ON 36
eH1_7                 1.104746e-01 1 1  ON 37
eH1_8                 9.203272e-02 1 1  ON 38
eH1_9                 2.490700e-02 1 1  ON 39
eH2_0                -1.838165e-01 1 1  ON 40
eH2_1                -1.054823e-01 1 1  ON 41
eH2_2                -6.370246e-02 1 1  ON 42
eH2_3                -2.661768e-02 1 1  ON 43
eH2_4                 1.862572e-02 1 1  ON 44
eH2_5                 3.500701e-02 1 1  ON 45
eH2_6                 7.871556e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461293e-02 1 1  ON 48
eH2_9                 2.673068e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2777
    reference variance = 0.177982
====================================================
  Execution time = 3.1024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5458e-01
  Total weights = 2.0000e+06
  Execution time = 2.6567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354628334014
                                         uncertainty =       0.014897253642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354628334014
                                         uncertainty =       0.014897253642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421059722
  error estimate for blocks of size 2^( 2) =       0.000431041886
  error estimate for blocks of size 2^( 3) =       0.000439743820
  error estimate for blocks of size 2^( 4) =       0.000446475140
  error estimate for blocks of size 2^( 5) =       0.000450521713
  error estimate for blocks of size 2^( 6) =       0.000452665637
  error estimate for blocks of size 2^( 7) =       0.000453509592

      target function =                  N/A
              le_mean =     -17.211236584692
             les_mean =     296.581247175696
             stat err =       0.000450793020
             autocorr =       1.146217323951
              std dev =       0.595468369235
             le_variance =       0.354582578759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354629447097
                                         uncertainty =       0.014897307103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354629447097
                                         uncertainty =       0.014897307103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421060383
  error estimate for blocks of size 2^( 2) =       0.000431042521
  error estimate for blocks of size 2^( 3) =       0.000439744425
  error estimate for blocks of size 2^( 4) =       0.000446475723
  error estimate for blocks of size 2^( 5) =       0.000450522275
  error estimate for blocks of size 2^( 6) =       0.000452666185
  error estimate for blocks of size 2^( 7) =       0.000453510152

      target function =                  N/A
              le_mean =     -17.211236583421
             les_mean =     296.581248244664
             stat err =       0.000450793584
             autocorr =       1.146216591149
              std dev =       0.595469303559
             le_variance =       0.354583691482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354628891157
                                         uncertainty =       0.014897280400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354628891157
                                         uncertainty =       0.014897280400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421060053
  error estimate for blocks of size 2^( 2) =       0.000431042204
  error estimate for blocks of size 2^( 3) =       0.000439744123
  error estimate for blocks of size 2^( 4) =       0.000446475432
  error estimate for blocks of size 2^( 5) =       0.000450521995
  error estimate for blocks of size 2^( 6) =       0.000452665911
  error estimate for blocks of size 2^( 7) =       0.000453509872

      target function =                  N/A
              le_mean =     -17.211236584056
             les_mean =     296.581247710767
             stat err =       0.000450793302
             autocorr =       1.146216957243
              std dev =       0.595468836902
             le_variance =       0.354583135721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354628403676
                                         uncertainty =       0.014897256988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354628403676
                                         uncertainty =       0.014897256988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421059763
  error estimate for blocks of size 2^( 2) =       0.000431041926
  error estimate for blocks of size 2^( 3) =       0.000439743858
  error estimate for blocks of size 2^( 4) =       0.000446475176
  error estimate for blocks of size 2^( 5) =       0.000450521749
  error estimate for blocks of size 2^( 6) =       0.000452665671
  error estimate for blocks of size 2^( 7) =       0.000453509627

      target function =                  N/A
              le_mean =     -17.211236584612
             les_mean =     296.581247242595
             stat err =       0.000450793056
             autocorr =       1.146217278103
              std dev =       0.595468427709
             le_variance =       0.354582648398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211236584692        initial  <--
     2.3283e+02     2.3283e+03             2.2508e-06       -17.211236583421
     9.3132e+02     9.3132e+03             5.6272e-07       -17.211236584056
     3.7253e+03     3.7253e+04             1.4068e-07       -17.211236584612

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3148
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.130837e-01 1 1  ON 0
 uu_1                 4.837085e-02 1 1  ON 1
 uu_2                -4.948606e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348558e-01 1 1  ON 4
 uu_5                -1.379266e-01 1 1  ON 5
 uu_6                -1.122488e-01 1 1  ON 6
 uu_7                -3.948454e-02 1 1  ON 7
 uu_8                 9.976361e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560731e-01 1 1  ON 10
 ud_1                 9.347006e-02 1 1  ON 11
 ud_2                -1.734182e-02 1 1  ON 12
 ud_3                -7.670030e-02 1 1  ON 13
 ud_4                -1.233596e-01 1 1  ON 14
 ud_5                -1.546609e-01 1 1  ON 15
 ud_6                -1.563651e-01 1 1  ON 16
 ud_7                -1.120700e-01 1 1  ON 17
 ud_8                 3.204804e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669807e-01 1 1  ON 20
 eO_1                -4.441166e-01 1 1  ON 21
 eO_2                -3.323324e-02 1 1  ON 22
 eO_3                 2.162402e-01 1 1  ON 23
 eO_4                 2.985138e-01 1 1  ON 24
 eO_5                 3.079222e-01 1 1  ON 25
 eO_6                 2.503767e-01 1 1  ON 26
 eO_7                 1.132189e-01 1 1  ON 27
 eO_8                 2.823456e-02 1 1  ON 28
 eO_9                 1.877811e-02 1 1  ON 29
eH1_0                -1.831439e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298060e-02 1 1  ON 32
eH1_3                -2.597063e-02 1 1  ON 33
eH1_4                 1.968936e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813644e-02 1 1  ON 36
eH1_7                 1.104747e-01 1 1  ON 37
eH1_8                 9.203267e-02 1 1  ON 38
eH1_9                 2.490698e-02 1 1  ON 39
eH2_0                -1.838165e-01 1 1  ON 40
eH2_1                -1.054822e-01 1 1  ON 41
eH2_2                -6.370247e-02 1 1  ON 42
eH2_3                -2.661778e-02 1 1  ON 43
eH2_4                 1.862560e-02 1 1  ON 44
eH2_5                 3.500721e-02 1 1  ON 45
eH2_6                 7.871560e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461287e-02 1 1  ON 48
eH2_9                 2.673066e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2121
    reference variance = 0.249608
====================================================
  Execution time = 3.1466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4026e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340335352706
                                         uncertainty =       0.003151682694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340335352706
                                         uncertainty =       0.003151682694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412467687
  error estimate for blocks of size 2^( 2) =       0.000423090782
  error estimate for blocks of size 2^( 3) =       0.000432361716
  error estimate for blocks of size 2^( 4) =       0.000439644807
  error estimate for blocks of size 2^( 5) =       0.000444207201
  error estimate for blocks of size 2^( 6) =       0.000444424738
  error estimate for blocks of size 2^( 7) =       0.000447066893

      target function =                  N/A
              le_mean =     -17.211440198860
             les_mean =     296.573932735100
             stat err =       0.000443835910
             autocorr =       1.157883888701
              std dev =       0.583317397556
             le_variance =       0.340259186291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721144019886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211440198860       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211440199101       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211440199575       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211440199470       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211440199900       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211440199841       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211440199839       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 2.193680e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211440198860       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211440198920       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211440199039       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211440199007       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211440199124       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211440199109       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211440199139       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 5.484258e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211440198860       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211440198875       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211440198905       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211440198907       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211440198924       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211440198928       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211440198923       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.371068e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0333e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.130838e-01 1 1  ON 0
 uu_1                 4.837086e-02 1 1  ON 1
 uu_2                -4.948606e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348558e-01 1 1  ON 4
 uu_5                -1.379266e-01 1 1  ON 5
 uu_6                -1.122489e-01 1 1  ON 6
 uu_7                -3.948456e-02 1 1  ON 7
 uu_8                 9.976361e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560731e-01 1 1  ON 10
 ud_1                 9.347006e-02 1 1  ON 11
 ud_2                -1.734181e-02 1 1  ON 12
 ud_3                -7.670031e-02 1 1  ON 13
 ud_4                -1.233596e-01 1 1  ON 14
 ud_5                -1.546609e-01 1 1  ON 15
 ud_6                -1.563651e-01 1 1  ON 16
 ud_7                -1.120700e-01 1 1  ON 17
 ud_8                 3.204791e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669808e-01 1 1  ON 20
 eO_1                -4.441166e-01 1 1  ON 21
 eO_2                -3.323325e-02 1 1  ON 22
 eO_3                 2.162402e-01 1 1  ON 23
 eO_4                 2.985139e-01 1 1  ON 24
 eO_5                 3.079222e-01 1 1  ON 25
 eO_6                 2.503768e-01 1 1  ON 26
 eO_7                 1.132189e-01 1 1  ON 27
 eO_8                 2.823456e-02 1 1  ON 28
 eO_9                 1.877811e-02 1 1  ON 29
eH1_0                -1.831439e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298060e-02 1 1  ON 32
eH1_3                -2.597062e-02 1 1  ON 33
eH1_4                 1.968935e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813644e-02 1 1  ON 36
eH1_7                 1.104747e-01 1 1  ON 37
eH1_8                 9.203267e-02 1 1  ON 38
eH1_9                 2.490698e-02 1 1  ON 39
eH2_0                -1.838165e-01 1 1  ON 40
eH2_1                -1.054822e-01 1 1  ON 41
eH2_2                -6.370246e-02 1 1  ON 42
eH2_3                -2.661777e-02 1 1  ON 43
eH2_4                 1.862559e-02 1 1  ON 44
eH2_5                 3.500720e-02 1 1  ON 45
eH2_6                 7.871559e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461288e-02 1 1  ON 48
eH2_9                 2.673066e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1865
    reference variance = 0.277862
====================================================
  Execution time = 3.1033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4657e-01
  Total weights = 2.0000e+06
  Execution time = 2.6453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640133933
                                         uncertainty =       0.004140213242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640133933
                                         uncertainty =       0.004140213242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416275502
  error estimate for blocks of size 2^( 2) =       0.000426907958
  error estimate for blocks of size 2^( 3) =       0.000436568737
  error estimate for blocks of size 2^( 4) =       0.000443204289
  error estimate for blocks of size 2^( 5) =       0.000447429979
  error estimate for blocks of size 2^( 6) =       0.000448289297
  error estimate for blocks of size 2^( 7) =       0.000447170281

      target function =                  N/A
              le_mean =     -17.211404088215
             les_mean =     296.579001102417
             stat err =       0.000446523462
             autocorr =       1.150606594095
              std dev =       0.588702461251
             le_variance =       0.346570587883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640253361
                                         uncertainty =       0.004140214833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640253361
                                         uncertainty =       0.004140214833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416275574
  error estimate for blocks of size 2^( 2) =       0.000426908027
  error estimate for blocks of size 2^( 3) =       0.000436568801
  error estimate for blocks of size 2^( 4) =       0.000443204352
  error estimate for blocks of size 2^( 5) =       0.000447430041
  error estimate for blocks of size 2^( 6) =       0.000448289357
  error estimate for blocks of size 2^( 7) =       0.000447170338

      target function =                  N/A
              le_mean =     -17.211404088577
             les_mean =     296.579001234273
             stat err =       0.000446523522
             autocorr =       1.150606507935
              std dev =       0.588702562652
             le_variance =       0.346570707273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640193654
                                         uncertainty =       0.004140214038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640193654
                                         uncertainty =       0.004140214038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416275538
  error estimate for blocks of size 2^( 2) =       0.000426907993
  error estimate for blocks of size 2^( 3) =       0.000436568769
  error estimate for blocks of size 2^( 4) =       0.000443204321
  error estimate for blocks of size 2^( 5) =       0.000447430010
  error estimate for blocks of size 2^( 6) =       0.000448289327
  error estimate for blocks of size 2^( 7) =       0.000447170310

      target function =                  N/A
              le_mean =     -17.211404088396
             les_mean =     296.579001168354
             stat err =       0.000446523492
             autocorr =       1.150606551003
              std dev =       0.588702511958
             le_variance =       0.346570647585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640141399
                                         uncertainty =       0.004140213341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346640141399
                                         uncertainty =       0.004140213341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416275507
  error estimate for blocks of size 2^( 2) =       0.000426907963
  error estimate for blocks of size 2^( 3) =       0.000436568741
  error estimate for blocks of size 2^( 4) =       0.000443204293
  error estimate for blocks of size 2^( 5) =       0.000447429983
  error estimate for blocks of size 2^( 6) =       0.000448289301
  error estimate for blocks of size 2^( 7) =       0.000447170285

      target function =                  N/A
              le_mean =     -17.211404088238
             les_mean =     296.579001110660
             stat err =       0.000446523465
             autocorr =       1.150606588702
              std dev =       0.588702467589
             le_variance =       0.346570595346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211404088215        initial
     2.3283e+03     2.3283e+04             2.1937e-07       -17.211404088577  <--
     9.3132e+03     9.3132e+04             5.4843e-08       -17.211404088396
     3.7253e+04     3.7253e+05             1.3711e-08       -17.211404088238

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 4.4372e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.130838e-01 1 1  ON 0
 uu_1                 4.837091e-02 1 1  ON 1
 uu_2                -4.948605e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348558e-01 1 1  ON 4
 uu_5                -1.379267e-01 1 1  ON 5
 uu_6                -1.122489e-01 1 1  ON 6
 uu_7                -3.948460e-02 1 1  ON 7
 uu_8                 9.976358e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560732e-01 1 1  ON 10
 ud_1                 9.347005e-02 1 1  ON 11
 ud_2                -1.734178e-02 1 1  ON 12
 ud_3                -7.670034e-02 1 1  ON 13
 ud_4                -1.233596e-01 1 1  ON 14
 ud_5                -1.546609e-01 1 1  ON 15
 ud_6                -1.563651e-01 1 1  ON 16
 ud_7                -1.120700e-01 1 1  ON 17
 ud_8                 3.204754e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669809e-01 1 1  ON 20
 eO_1                -4.441168e-01 1 1  ON 21
 eO_2                -3.323330e-02 1 1  ON 22
 eO_3                 2.162403e-01 1 1  ON 23
 eO_4                 2.985140e-01 1 1  ON 24
 eO_5                 3.079222e-01 1 1  ON 25
 eO_6                 2.503768e-01 1 1  ON 26
 eO_7                 1.132189e-01 1 1  ON 27
 eO_8                 2.823456e-02 1 1  ON 28
 eO_9                 1.877812e-02 1 1  ON 29
eH1_0                -1.831439e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298060e-02 1 1  ON 32
eH1_3                -2.597059e-02 1 1  ON 33
eH1_4                 1.968931e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813645e-02 1 1  ON 36
eH1_7                 1.104747e-01 1 1  ON 37
eH1_8                 9.203270e-02 1 1  ON 38
eH1_9                 2.490699e-02 1 1  ON 39
eH2_0                -1.838165e-01 1 1  ON 40
eH2_1                -1.054822e-01 1 1  ON 41
eH2_2                -6.370244e-02 1 1  ON 42
eH2_3                -2.661776e-02 1 1  ON 43
eH2_4                 1.862556e-02 1 1  ON 44
eH2_5                 3.500720e-02 1 1  ON 45
eH2_6                 7.871559e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461290e-02 1 1  ON 48
eH2_9                 2.673067e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4711e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1849
    reference variance = 0.15971
====================================================
  Execution time = 3.1714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3610e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336101314582
                                         uncertainty =       0.003149370971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336101314582
                                         uncertainty =       0.003149370971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409939760
  error estimate for blocks of size 2^( 2) =       0.000420366061
  error estimate for blocks of size 2^( 3) =       0.000430332547
  error estimate for blocks of size 2^( 4) =       0.000437382764
  error estimate for blocks of size 2^( 5) =       0.000440703224
  error estimate for blocks of size 2^( 6) =       0.000443493726
  error estimate for blocks of size 2^( 7) =       0.000443491793

      target function =                  N/A
              le_mean =     -17.211317716353
             les_mean =     296.565558579263
             stat err =       0.000441267877
             autocorr =       1.158682746202
              std dev =       0.579742368703
             le_variance =       0.336101214070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721131771635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211317716353       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211317718251       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211317717034       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211317717753       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211317719271       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211317719308       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211317719214       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211317719350       residual = 8.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 1.083886e-06

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211317716353       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211317716828       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211317716523       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211317716705       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211317717083       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211317717093       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211317717067       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211317717104       residual = 8.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 2.709770e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211317716353       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211317716472       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211317716395       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211317716439       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211317716531       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211317716531       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211317716535       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211317716545       residual = 8.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 6.774459e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0428e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.130839e-01 1 1  ON 0
 uu_1                 4.837095e-02 1 1  ON 1
 uu_2                -4.948602e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348559e-01 1 1  ON 4
 uu_5                -1.379267e-01 1 1  ON 5
 uu_6                -1.122489e-01 1 1  ON 6
 uu_7                -3.948466e-02 1 1  ON 7
 uu_8                 9.976355e-02 1 1  ON 8
 uu_9                 1.222576e-01 1 1  ON 9
 ud_0                 3.560733e-01 1 1  ON 10
 ud_1                 9.347010e-02 1 1  ON 11
 ud_2                -1.734176e-02 1 1  ON 12
 ud_3                -7.670033e-02 1 1  ON 13
 ud_4                -1.233597e-01 1 1  ON 14
 ud_5                -1.546609e-01 1 1  ON 15
 ud_6                -1.563652e-01 1 1  ON 16
 ud_7                -1.120700e-01 1 1  ON 17
 ud_8                 3.204702e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669811e-01 1 1  ON 20
 eO_1                -4.441170e-01 1 1  ON 21
 eO_2                -3.323342e-02 1 1  ON 22
 eO_3                 2.162404e-01 1 1  ON 23
 eO_4                 2.985143e-01 1 1  ON 24
 eO_5                 3.079223e-01 1 1  ON 25
 eO_6                 2.503768e-01 1 1  ON 26
 eO_7                 1.132190e-01 1 1  ON 27
 eO_8                 2.823457e-02 1 1  ON 28
 eO_9                 1.877812e-02 1 1  ON 29
eH1_0                -1.831439e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298058e-02 1 1  ON 32
eH1_3                -2.597062e-02 1 1  ON 33
eH1_4                 1.968934e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813645e-02 1 1  ON 36
eH1_7                 1.104746e-01 1 1  ON 37
eH1_8                 9.203273e-02 1 1  ON 38
eH1_9                 2.490700e-02 1 1  ON 39
eH2_0                -1.838166e-01 1 1  ON 40
eH2_1                -1.054822e-01 1 1  ON 41
eH2_2                -6.370242e-02 1 1  ON 42
eH2_3                -2.661778e-02 1 1  ON 43
eH2_4                 1.862558e-02 1 1  ON 44
eH2_5                 3.500717e-02 1 1  ON 45
eH2_6                 7.871560e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461293e-02 1 1  ON 48
eH2_9                 2.673068e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1525
    reference variance = 0.214496
====================================================
  Execution time = 3.1063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3774e-01
  Total weights = 2.0000e+06
  Execution time = 2.6777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775036108
                                         uncertainty =       0.002903270821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775036108
                                         uncertainty =       0.002903270821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410938343
  error estimate for blocks of size 2^( 2) =       0.000421856473
  error estimate for blocks of size 2^( 3) =       0.000430980886
  error estimate for blocks of size 2^( 4) =       0.000437383846
  error estimate for blocks of size 2^( 5) =       0.000441610221
  error estimate for blocks of size 2^( 6) =       0.000444872927
  error estimate for blocks of size 2^( 7) =       0.000445848261

      target function =                  N/A
              le_mean =     -17.211416763494
             les_mean =     296.570607481686
             stat err =       0.000442428814
             autocorr =       1.159133547203
              std dev =       0.581154578286
             le_variance =       0.337740643863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775340559
                                         uncertainty =       0.002903274269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775340559
                                         uncertainty =       0.002903274269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410938528
  error estimate for blocks of size 2^( 2) =       0.000421856651
  error estimate for blocks of size 2^( 3) =       0.000430981054
  error estimate for blocks of size 2^( 4) =       0.000437384004
  error estimate for blocks of size 2^( 5) =       0.000441610377
  error estimate for blocks of size 2^( 6) =       0.000444873078
  error estimate for blocks of size 2^( 7) =       0.000445848416

      target function =                  N/A
              le_mean =     -17.211416763975
             les_mean =     296.570607802666
             stat err =       0.000442428969
             autocorr =       1.159133313596
              std dev =       0.581154840208
             le_variance =       0.337740948297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775188397
                                         uncertainty =       0.002903272546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775188397
                                         uncertainty =       0.002903272546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410938436
  error estimate for blocks of size 2^( 2) =       0.000421856562
  error estimate for blocks of size 2^( 3) =       0.000430980970
  error estimate for blocks of size 2^( 4) =       0.000437383925
  error estimate for blocks of size 2^( 5) =       0.000441610299
  error estimate for blocks of size 2^( 6) =       0.000444873002
  error estimate for blocks of size 2^( 7) =       0.000445848339

      target function =                  N/A
              le_mean =     -17.211416763735
             les_mean =     296.570607642241
             stat err =       0.000442428891
             autocorr =       1.159133430366
              std dev =       0.581154709302
             le_variance =       0.337740796143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775055146
                                         uncertainty =       0.002903271037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775055146
                                         uncertainty =       0.002903271037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410938355
  error estimate for blocks of size 2^( 2) =       0.000421856484
  error estimate for blocks of size 2^( 3) =       0.000430980897
  error estimate for blocks of size 2^( 4) =       0.000437383856
  error estimate for blocks of size 2^( 5) =       0.000441610230
  error estimate for blocks of size 2^( 6) =       0.000444872937
  error estimate for blocks of size 2^( 7) =       0.000445848271

      target function =                  N/A
              le_mean =     -17.211416763524
             les_mean =     296.570607501756
             stat err =       0.000442428823
             autocorr =       1.159133532594
              std dev =       0.581154594665
             le_variance =       0.337740662900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211416763494        initial
     5.8208e+02     5.8208e+03             1.0839e-06       -17.211416763975  <--
     2.3283e+03     2.3283e+04             2.7098e-07       -17.211416763735
     9.3132e+03     9.3132e+04             6.7745e-08       -17.211416763524

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 4.4417e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.130843e-01 1 1  ON 0
 uu_1                 4.837107e-02 1 1  ON 1
 uu_2                -4.948593e-02 1 1  ON 2
 uu_3                -1.044218e-01 1 1  ON 3
 uu_4                -1.348561e-01 1 1  ON 4
 uu_5                -1.379269e-01 1 1  ON 5
 uu_6                -1.122491e-01 1 1  ON 6
 uu_7                -3.948484e-02 1 1  ON 7
 uu_8                 9.976345e-02 1 1  ON 8
 uu_9                 1.222577e-01 1 1  ON 9
 ud_0                 3.560736e-01 1 1  ON 10
 ud_1                 9.347024e-02 1 1  ON 11
 ud_2                -1.734170e-02 1 1  ON 12
 ud_3                -7.670032e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546610e-01 1 1  ON 15
 ud_6                -1.563653e-01 1 1  ON 16
 ud_7                -1.120701e-01 1 1  ON 17
 ud_8                 3.204545e-03 1 1  ON 18
 ud_9                 9.332768e-02 1 1  ON 19
 eO_0                -7.669818e-01 1 1  ON 20
 eO_1                -4.441176e-01 1 1  ON 21
 eO_2                -3.323378e-02 1 1  ON 22
 eO_3                 2.162408e-01 1 1  ON 23
 eO_4                 2.985151e-01 1 1  ON 24
 eO_5                 3.079225e-01 1 1  ON 25
 eO_6                 2.503770e-01 1 1  ON 26
 eO_7                 1.132191e-01 1 1  ON 27
 eO_8                 2.823459e-02 1 1  ON 28
 eO_9                 1.877813e-02 1 1  ON 29
eH1_0                -1.831440e-01 1 1  ON 30
eH1_1                -1.046076e-01 1 1  ON 31
eH1_2                -6.298054e-02 1 1  ON 32
eH1_3                -2.597071e-02 1 1  ON 33
eH1_4                 1.968943e-02 1 1  ON 34
eH1_5                 3.582229e-02 1 1  ON 35
eH1_6                 7.813643e-02 1 1  ON 36
eH1_7                 1.104746e-01 1 1  ON 37
eH1_8                 9.203282e-02 1 1  ON 38
eH1_9                 2.490703e-02 1 1  ON 39
eH2_0                -1.838168e-01 1 1  ON 40
eH2_1                -1.054821e-01 1 1  ON 41
eH2_2                -6.370236e-02 1 1  ON 42
eH2_3                -2.661784e-02 1 1  ON 43
eH2_4                 1.862566e-02 1 1  ON 44
eH2_5                 3.500710e-02 1 1  ON 45
eH2_6                 7.871563e-02 1 1  ON 46
eH2_7                 1.135376e-01 1 1  ON 47
eH2_8                 9.461300e-02 1 1  ON 48
eH2_9                 2.673070e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0951
    reference variance = 0.325926
====================================================
  Execution time = 3.1458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347703175624
                                         uncertainty =       0.005450497687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347703175624
                                         uncertainty =       0.005450497687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416928655
  error estimate for blocks of size 2^( 2) =       0.000427376915
  error estimate for blocks of size 2^( 3) =       0.000436783974
  error estimate for blocks of size 2^( 4) =       0.000443662994
  error estimate for blocks of size 2^( 5) =       0.000447032624
  error estimate for blocks of size 2^( 6) =       0.000449529640
  error estimate for blocks of size 2^( 7) =       0.000452124407

      target function =                  N/A
              le_mean =     -17.211323535353
             les_mean =     296.577316671410
             stat err =       0.000448087416
             autocorr =       1.155053248735
              std dev =       0.589626158365
             le_variance =       0.347659006629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721132353535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211323535353       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211323542124       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211323550197       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211323551459       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211323551686       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211323551659       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211323550941       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 3.553124e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211323535353       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211323537047       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211323539067       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211323539383       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211323539439       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211323539433       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211323539253       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 8.883539e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211323535353       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211323535777       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211323536282       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211323536361       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211323536386       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211323536392       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211323536329       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 2.220930e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0227e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.130849e-01 1 1  ON 0
 uu_1                 4.837124e-02 1 1  ON 1
 uu_2                -4.948582e-02 1 1  ON 2
 uu_3                -1.044219e-01 1 1  ON 3
 uu_4                -1.348563e-01 1 1  ON 4
 uu_5                -1.379271e-01 1 1  ON 5
 uu_6                -1.122494e-01 1 1  ON 6
 uu_7                -3.948505e-02 1 1  ON 7
 uu_8                 9.976333e-02 1 1  ON 8
 uu_9                 1.222578e-01 1 1  ON 9
 ud_0                 3.560740e-01 1 1  ON 10
 ud_1                 9.347047e-02 1 1  ON 11
 ud_2                -1.734153e-02 1 1  ON 12
 ud_3                -7.670028e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546612e-01 1 1  ON 15
 ud_6                -1.563656e-01 1 1  ON 16
 ud_7                -1.120703e-01 1 1  ON 17
 ud_8                 3.204309e-03 1 1  ON 18
 ud_9                 9.332769e-02 1 1  ON 19
 eO_0                -7.669826e-01 1 1  ON 20
 eO_1                -4.441184e-01 1 1  ON 21
 eO_2                -3.323397e-02 1 1  ON 22
 eO_3                 2.162413e-01 1 1  ON 23
 eO_4                 2.985158e-01 1 1  ON 24
 eO_5                 3.079227e-01 1 1  ON 25
 eO_6                 2.503771e-01 1 1  ON 26
 eO_7                 1.132193e-01 1 1  ON 27
 eO_8                 2.823461e-02 1 1  ON 28
 eO_9                 1.877814e-02 1 1  ON 29
eH1_0                -1.831442e-01 1 1  ON 30
eH1_1                -1.046079e-01 1 1  ON 31
eH1_2                -6.298053e-02 1 1  ON 32
eH1_3                -2.597047e-02 1 1  ON 33
eH1_4                 1.968962e-02 1 1  ON 34
eH1_5                 3.582219e-02 1 1  ON 35
eH1_6                 7.813642e-02 1 1  ON 36
eH1_7                 1.104746e-01 1 1  ON 37
eH1_8                 9.203295e-02 1 1  ON 38
eH1_9                 2.490707e-02 1 1  ON 39
eH2_0                -1.838171e-01 1 1  ON 40
eH2_1                -1.054820e-01 1 1  ON 41
eH2_2                -6.370236e-02 1 1  ON 42
eH2_3                -2.661785e-02 1 1  ON 43
eH2_4                 1.862569e-02 1 1  ON 44
eH2_5                 3.500727e-02 1 1  ON 45
eH2_6                 7.871556e-02 1 1  ON 46
eH2_7                 1.135375e-01 1 1  ON 47
eH2_8                 9.461310e-02 1 1  ON 48
eH2_9                 2.673072e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.114
    reference variance = 0.246416
====================================================
  Execution time = 3.1664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3984e-01
  Total weights = 2.0000e+06
  Execution time = 2.6731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339858179475
                                         uncertainty =       0.003221248967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339858179475
                                         uncertainty =       0.003221248967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412212184
  error estimate for blocks of size 2^( 2) =       0.000422187048
  error estimate for blocks of size 2^( 3) =       0.000432051176
  error estimate for blocks of size 2^( 4) =       0.000438379761
  error estimate for blocks of size 2^( 5) =       0.000442917005
  error estimate for blocks of size 2^( 6) =       0.000445440944
  error estimate for blocks of size 2^( 7) =       0.000447070233

      target function =                  N/A
              le_mean =     -17.211516119617
             les_mean =     296.576124735736
             stat err =       0.000443451986
             autocorr =       1.157314937354
              std dev =       0.582956061653
             le_variance =       0.339837769818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339859333648
                                         uncertainty =       0.003221261659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339859333648
                                         uncertainty =       0.003221261659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412212884
  error estimate for blocks of size 2^( 2) =       0.000422187702
  error estimate for blocks of size 2^( 3) =       0.000432051788
  error estimate for blocks of size 2^( 4) =       0.000438380351
  error estimate for blocks of size 2^( 5) =       0.000442917574
  error estimate for blocks of size 2^( 6) =       0.000445441510
  error estimate for blocks of size 2^( 7) =       0.000447070809

      target function =                  N/A
              le_mean =     -17.211516121469
             les_mean =     296.576125953532
             stat err =       0.000443452561
             autocorr =       1.157314010279
              std dev =       0.582957051470
             le_variance =       0.339838923859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339858756842
                                         uncertainty =       0.003221255316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339858756842
                                         uncertainty =       0.003221255316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412212534
  error estimate for blocks of size 2^( 2) =       0.000422187375
  error estimate for blocks of size 2^( 3) =       0.000432051482
  error estimate for blocks of size 2^( 4) =       0.000438380056
  error estimate for blocks of size 2^( 5) =       0.000442917290
  error estimate for blocks of size 2^( 6) =       0.000445441227
  error estimate for blocks of size 2^( 7) =       0.000447070521

      target function =                  N/A
              le_mean =     -17.211516120545
             les_mean =     296.576125344969
             stat err =       0.000443452274
             autocorr =       1.157314473652
              std dev =       0.582956556803
             le_variance =       0.339838347120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339858251654
                                         uncertainty =       0.003221249761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339858251654
                                         uncertainty =       0.003221249761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412212228
  error estimate for blocks of size 2^( 2) =       0.000422187089
  error estimate for blocks of size 2^( 3) =       0.000432051215
  error estimate for blocks of size 2^( 4) =       0.000438379798
  error estimate for blocks of size 2^( 5) =       0.000442917041
  error estimate for blocks of size 2^( 6) =       0.000445440979
  error estimate for blocks of size 2^( 7) =       0.000447070269

      target function =                  N/A
              le_mean =     -17.211516119733
             les_mean =     296.576124811895
             stat err =       0.000443452022
             autocorr =       1.157314879385
              std dev =       0.582956123554
             le_variance =       0.339837841989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211516119617        initial
     1.4552e+02     1.4552e+03             3.5531e-06       -17.211516121469  <--
     5.8208e+02     5.8208e+03             8.8835e-07       -17.211516120545
     2.3283e+03     2.3283e+04             2.2209e-07       -17.211516119733

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 4.9281e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560751e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1762
    reference variance = 0.649952
====================================================
  Execution time = 3.1265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349625347776
                                         uncertainty =       0.009059587702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349625347776
                                         uncertainty =       0.009059587702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418067472
  error estimate for blocks of size 2^( 2) =       0.000428660532
  error estimate for blocks of size 2^( 3) =       0.000438178057
  error estimate for blocks of size 2^( 4) =       0.000444630637
  error estimate for blocks of size 2^( 5) =       0.000448722913
  error estimate for blocks of size 2^( 6) =       0.000450762965
  error estimate for blocks of size 2^( 7) =       0.000452380895

      target function =                  N/A
              le_mean =     -17.210928292944
             les_mean =     296.565613352065
             stat err =       0.000449124353
             autocorr =       1.154092057013
              std dev =       0.591236688631
             le_variance =       0.349560821983


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721092829294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210928292944       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210928301674       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210928319880       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210928358164       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210928353510       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210928354824       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210928352905       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 1.740710e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210928292944       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210928295137       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210928299699       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210928309329       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210928308157       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210928308479       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210928308002       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 4.356185e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.210928292944       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210928293493       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210928294634       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210928297045       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210928296752       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210928296832       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210928296713       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 1.089323e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0070e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.130872e-01 1 1  ON 0
 uu_1                 4.837269e-02 1 1  ON 1
 uu_2                -4.948502e-02 1 1  ON 2
 uu_3                -1.044215e-01 1 1  ON 3
 uu_4                -1.348580e-01 1 1  ON 4
 uu_5                -1.379282e-01 1 1  ON 5
 uu_6                -1.122509e-01 1 1  ON 6
 uu_7                -3.948639e-02 1 1  ON 7
 uu_8                 9.976250e-02 1 1  ON 8
 uu_9                 1.222584e-01 1 1  ON 9
 ud_0                 3.560757e-01 1 1  ON 10
 ud_1                 9.347156e-02 1 1  ON 11
 ud_2                -1.734086e-02 1 1  ON 12
 ud_3                -7.669946e-02 1 1  ON 13
 ud_4                -1.233609e-01 1 1  ON 14
 ud_5                -1.546619e-01 1 1  ON 15
 ud_6                -1.563666e-01 1 1  ON 16
 ud_7                -1.120709e-01 1 1  ON 17
 ud_8                 3.202668e-03 1 1  ON 18
 ud_9                 9.332761e-02 1 1  ON 19
 eO_0                -7.669897e-01 1 1  ON 20
 eO_1                -4.441233e-01 1 1  ON 21
 eO_2                -3.323633e-02 1 1  ON 22
 eO_3                 2.162444e-01 1 1  ON 23
 eO_4                 2.985217e-01 1 1  ON 24
 eO_5                 3.079251e-01 1 1  ON 25
 eO_6                 2.503783e-01 1 1  ON 26
 eO_7                 1.132206e-01 1 1  ON 27
 eO_8                 2.823479e-02 1 1  ON 28
 eO_9                 1.877824e-02 1 1  ON 29
eH1_0                -1.831457e-01 1 1  ON 30
eH1_1                -1.046090e-01 1 1  ON 31
eH1_2                -6.297989e-02 1 1  ON 32
eH1_3                -2.597000e-02 1 1  ON 33
eH1_4                 1.968953e-02 1 1  ON 34
eH1_5                 3.582215e-02 1 1  ON 35
eH1_6                 7.813673e-02 1 1  ON 36
eH1_7                 1.104746e-01 1 1  ON 37
eH1_8                 9.203379e-02 1 1  ON 38
eH1_9                 2.490732e-02 1 1  ON 39
eH2_0                -1.838186e-01 1 1  ON 40
eH2_1                -1.054821e-01 1 1  ON 41
eH2_2                -6.370277e-02 1 1  ON 42
eH2_3                -2.661796e-02 1 1  ON 43
eH2_4                 1.862616e-02 1 1  ON 44
eH2_5                 3.500816e-02 1 1  ON 45
eH2_6                 7.871554e-02 1 1  ON 46
eH2_7                 1.135371e-01 1 1  ON 47
eH2_8                 9.461392e-02 1 1  ON 48
eH2_9                 2.673098e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2021
    reference variance = 0.158566
====================================================
  Execution time = 3.1061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4198e-01
  Total weights = 2.0000e+06
  Execution time = 2.6650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341958042244
                                         uncertainty =       0.004096687499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341958042244
                                         uncertainty =       0.004096687499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413509152
  error estimate for blocks of size 2^( 2) =       0.000423645342
  error estimate for blocks of size 2^( 3) =       0.000432656271
  error estimate for blocks of size 2^( 4) =       0.000439951155
  error estimate for blocks of size 2^( 5) =       0.000444177103
  error estimate for blocks of size 2^( 6) =       0.000447075592
  error estimate for blocks of size 2^( 7) =       0.000447410796

      target function =                  N/A
              le_mean =     -17.211559520871
             les_mean =     296.579760606669
             stat err =       0.000444653661
             autocorr =       1.156307902719
              std dev =       0.584790250589
             le_variance =       0.341979637184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341959468133
                                         uncertainty =       0.004096715428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341959468133
                                         uncertainty =       0.004096715428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413510013
  error estimate for blocks of size 2^( 2) =       0.000423646121
  error estimate for blocks of size 2^( 3) =       0.000432656983
  error estimate for blocks of size 2^( 4) =       0.000439951803
  error estimate for blocks of size 2^( 5) =       0.000444177780
  error estimate for blocks of size 2^( 6) =       0.000447076391
  error estimate for blocks of size 2^( 7) =       0.000447411664

      target function =                  N/A
              le_mean =     -17.211559508923
             les_mean =     296.579761620297
             stat err =       0.000444654409
             autocorr =       1.156306974787
              std dev =       0.584791468888
             le_variance =       0.341981062084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341958763271
                                         uncertainty =       0.004096701556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341958763271
                                         uncertainty =       0.004096701556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413509587
  error estimate for blocks of size 2^( 2) =       0.000423645736
  error estimate for blocks of size 2^( 3) =       0.000432656631
  error estimate for blocks of size 2^( 4) =       0.000439951483
  error estimate for blocks of size 2^( 5) =       0.000444177446
  error estimate for blocks of size 2^( 6) =       0.000447075996
  error estimate for blocks of size 2^( 7) =       0.000447411235

      target function =                  N/A
              le_mean =     -17.211559514842
             les_mean =     296.579761119670
             stat err =       0.000444654040
             autocorr =       1.156307435549
              std dev =       0.584790866650
             le_variance =       0.341980357718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341958132611
                                         uncertainty =       0.004096689259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341958132611
                                         uncertainty =       0.004096689259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413509206
  error estimate for blocks of size 2^( 2) =       0.000423645392
  error estimate for blocks of size 2^( 3) =       0.000432656316
  error estimate for blocks of size 2^( 4) =       0.000439951196
  error estimate for blocks of size 2^( 5) =       0.000444177146
  error estimate for blocks of size 2^( 6) =       0.000447075643
  error estimate for blocks of size 2^( 7) =       0.000447410851

      target function =                  N/A
              le_mean =     -17.211559520113
             les_mean =     296.579760670888
             stat err =       0.000444653709
             autocorr =       1.156307844210
              std dev =       0.584790327801
             le_variance =       0.341979727489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211559520871        initial  <--
     3.6380e+01     3.6380e+02             1.7407e-05       -17.211559508923
     1.4552e+02     1.4552e+03             4.3562e-06       -17.211559514842
     5.8208e+02     5.8208e+03             1.0893e-06       -17.211559520113

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4676
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560751e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4543e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1705
    reference variance = 0.601794
====================================================
  Execution time = 3.1077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4027e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340374135167
                                         uncertainty =       0.003746266440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340374135167
                                         uncertainty =       0.003746266440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412474332
  error estimate for blocks of size 2^( 2) =       0.000422732918
  error estimate for blocks of size 2^( 3) =       0.000432427734
  error estimate for blocks of size 2^( 4) =       0.000439236459
  error estimate for blocks of size 2^( 5) =       0.000443528551
  error estimate for blocks of size 2^( 6) =       0.000446579471
  error estimate for blocks of size 2^( 7) =       0.000447620886

      target function =                  N/A
              le_mean =     -17.211757127483
             les_mean =     296.584853394467
             stat err =       0.000444241342
             autocorr =       1.159962871024
              std dev =       0.583326794477
             le_variance =       0.340270149155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721175712748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211757127483       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211757128089       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211757129293       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211757130499       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211757130591       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211757130950       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211757131178       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 1.577150e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211757127483       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211757127634       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211757127935       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211757128238       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211757128260       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211757128349       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211757128408       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 3.943005e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211757127483       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211757127521       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211757127596       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211757127671       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211757127677       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211757127702       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211757127713       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 9.857594e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278509 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9895e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.130869e-01 1 1  ON 0
 uu_1                 4.837182e-02 1 1  ON 1
 uu_2                -4.948550e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379276e-01 1 1  ON 5
 uu_6                -1.122504e-01 1 1  ON 6
 uu_7                -3.948574e-02 1 1  ON 7
 uu_8                 9.976293e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560753e-01 1 1  ON 10
 ud_1                 9.347120e-02 1 1  ON 11
 ud_2                -1.734099e-02 1 1  ON 12
 ud_3                -7.670015e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120709e-01 1 1  ON 17
 ud_8                 3.203513e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669856e-01 1 1  ON 20
 eO_1                -4.441211e-01 1 1  ON 21
 eO_2                -3.323469e-02 1 1  ON 22
 eO_3                 2.162429e-01 1 1  ON 23
 eO_4                 2.985184e-01 1 1  ON 24
 eO_5                 3.079236e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132199e-01 1 1  ON 27
 eO_8                 2.823467e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831450e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298049e-02 1 1  ON 32
eH1_3                -2.596970e-02 1 1  ON 33
eH1_4                 1.969012e-02 1 1  ON 34
eH1_5                 3.582186e-02 1 1  ON 35
eH1_6                 7.813641e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203337e-02 1 1  ON 38
eH1_9                 2.490719e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661786e-02 1 1  ON 43
eH2_4                 1.862572e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871535e-02 1 1  ON 46
eH2_7                 1.135373e-01 1 1  ON 47
eH2_8                 9.461346e-02 1 1  ON 48
eH2_9                 2.673080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1827
    reference variance = 0.378863
====================================================
  Execution time = 3.1075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4248e-01
  Total weights = 2.0000e+06
  Execution time = 2.6578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535310206
                                         uncertainty =       0.003921892435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535310206
                                         uncertainty =       0.003921892435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413813912
  error estimate for blocks of size 2^( 2) =       0.000424335617
  error estimate for blocks of size 2^( 3) =       0.000433533746
  error estimate for blocks of size 2^( 4) =       0.000440311493
  error estimate for blocks of size 2^( 5) =       0.000444967243
  error estimate for blocks of size 2^( 6) =       0.000448019772
  error estimate for blocks of size 2^( 7) =       0.000451256197

      target function =                  N/A
              le_mean =     -17.211042321704
             les_mean =     296.562461535771
             stat err =       0.000446138676
             autocorr =       1.162330341246
              std dev =       0.585221246645
             le_variance =       0.342483907525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535754689
                                         uncertainty =       0.003921897699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535754689
                                         uncertainty =       0.003921897699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413814180
  error estimate for blocks of size 2^( 2) =       0.000424335872
  error estimate for blocks of size 2^( 3) =       0.000433533990
  error estimate for blocks of size 2^( 4) =       0.000440311726
  error estimate for blocks of size 2^( 5) =       0.000444967467
  error estimate for blocks of size 2^( 6) =       0.000448019996
  error estimate for blocks of size 2^( 7) =       0.000451256405

      target function =                  N/A
              le_mean =     -17.211042318860
             les_mean =     296.562461882251
             stat err =       0.000446138898
             autocorr =       1.162329990437
              std dev =       0.585221626319
             le_variance =       0.342484351911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535532581
                                         uncertainty =       0.003921895069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535532581
                                         uncertainty =       0.003921895069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413814046
  error estimate for blocks of size 2^( 2) =       0.000424335744
  error estimate for blocks of size 2^( 3) =       0.000433533868
  error estimate for blocks of size 2^( 4) =       0.000440311610
  error estimate for blocks of size 2^( 5) =       0.000444967355
  error estimate for blocks of size 2^( 6) =       0.000448019884
  error estimate for blocks of size 2^( 7) =       0.000451256301

      target function =                  N/A
              le_mean =     -17.211042320281
             les_mean =     296.562461709115
             stat err =       0.000446138787
             autocorr =       1.162330165759
              std dev =       0.585221436596
             le_variance =       0.342484129852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535338006
                                         uncertainty =       0.003921892764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342535338006
                                         uncertainty =       0.003921892764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413813929
  error estimate for blocks of size 2^( 2) =       0.000424335633
  error estimate for blocks of size 2^( 3) =       0.000433533761
  error estimate for blocks of size 2^( 4) =       0.000440311508
  error estimate for blocks of size 2^( 5) =       0.000444967257
  error estimate for blocks of size 2^( 6) =       0.000448019786
  error estimate for blocks of size 2^( 7) =       0.000451256210

      target function =                  N/A
              le_mean =     -17.211042321526
             les_mean =     296.562461557441
             stat err =       0.000446138690
             autocorr =       1.162330319304
              std dev =       0.585221270392
             le_variance =       0.342483935320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211042321704        initial  <--
     3.6380e+02     3.6380e+03             1.5772e-06       -17.211042318860
     1.4552e+03     1.4552e+04             3.9430e-07       -17.211042320281
     5.8208e+03     5.8208e+04             9.8576e-08       -17.211042321526

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3820
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560751e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2247
    reference variance = 0.187397
====================================================
  Execution time = 3.1401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351219309734
                                         uncertainty =       0.012014459557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351219309734
                                         uncertainty =       0.012014459557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419023348
  error estimate for blocks of size 2^( 2) =       0.000429366857
  error estimate for blocks of size 2^( 3) =       0.000438564344
  error estimate for blocks of size 2^( 4) =       0.000444597058
  error estimate for blocks of size 2^( 5) =       0.000449185352
  error estimate for blocks of size 2^( 6) =       0.000450278811
  error estimate for blocks of size 2^( 7) =       0.000453573882

      target function =                  N/A
              le_mean =     -17.211282376758
             les_mean =     296.579402009001
             stat err =       0.000449408776
             autocorr =       1.150288169724
              std dev =       0.592588501485
             le_variance =       0.351161132093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721128237676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211282376758       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211282376873       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211282377148       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211282377278       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211282377288       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211282377346       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211282377340       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 1.718125e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211282376758       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211282376786       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211282376855       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211282376888       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211282376887       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211282376905       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211282376913       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 4.295320e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211282376758       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211282376765       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211282376782       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211282376790       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211282376790       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211282376810       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211282376762       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 1.073830e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0208e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948567e-02 1 1  ON 7
 uu_8                 9.976296e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560752e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203591e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669854e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323455e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985181e-01 1 1  ON 24
 eO_5                 3.079235e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298051e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969019e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370236e-02 1 1  ON 42
eH2_3                -2.661789e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500777e-02 1 1  ON 45
eH2_6                 7.871535e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461343e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1907
    reference variance = 0.187503
====================================================
  Execution time = 3.1038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4764e-01
  Total weights = 2.0000e+06
  Execution time = 2.6608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711689103
                                         uncertainty =       0.007588087613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711689103
                                         uncertainty =       0.007588087613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416917345
  error estimate for blocks of size 2^( 2) =       0.000427263949
  error estimate for blocks of size 2^( 3) =       0.000436501248
  error estimate for blocks of size 2^( 4) =       0.000443016374
  error estimate for blocks of size 2^( 5) =       0.000446904847
  error estimate for blocks of size 2^( 6) =       0.000449985130
  error estimate for blocks of size 2^( 7) =       0.000451023138

      target function =                  N/A
              le_mean =     -17.210884990335
             les_mean =     296.562202121116
             stat err =       0.000447732372
             autocorr =       1.153286121341
              std dev =       0.589610163078
             le_variance =       0.347640144405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711762821
                                         uncertainty =       0.007588088786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711762821
                                         uncertainty =       0.007588088786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416917389
  error estimate for blocks of size 2^( 2) =       0.000427263991
  error estimate for blocks of size 2^( 3) =       0.000436501288
  error estimate for blocks of size 2^( 4) =       0.000443016412
  error estimate for blocks of size 2^( 5) =       0.000446904885
  error estimate for blocks of size 2^( 6) =       0.000449985169
  error estimate for blocks of size 2^( 7) =       0.000451023175

      target function =                  N/A
              le_mean =     -17.210884990012
             les_mean =     296.562202183688
             stat err =       0.000447732410
             autocorr =       1.153286073626
              std dev =       0.589610225572
             le_variance =       0.347640218099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711725963
                                         uncertainty =       0.007588088200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711725963
                                         uncertainty =       0.007588088200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416917367
  error estimate for blocks of size 2^( 2) =       0.000427263970
  error estimate for blocks of size 2^( 3) =       0.000436501268
  error estimate for blocks of size 2^( 4) =       0.000443016393
  error estimate for blocks of size 2^( 5) =       0.000446904866
  error estimate for blocks of size 2^( 6) =       0.000449985149
  error estimate for blocks of size 2^( 7) =       0.000451023156

      target function =                  N/A
              le_mean =     -17.210884990173
             les_mean =     296.562202152403
             stat err =       0.000447732391
             autocorr =       1.153286097481
              std dev =       0.589610194326
             le_variance =       0.347640181253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711693710
                                         uncertainty =       0.007588087686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347711693710
                                         uncertainty =       0.007588087686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416917347
  error estimate for blocks of size 2^( 2) =       0.000427263952
  error estimate for blocks of size 2^( 3) =       0.000436501251
  error estimate for blocks of size 2^( 4) =       0.000443016376
  error estimate for blocks of size 2^( 5) =       0.000446904849
  error estimate for blocks of size 2^( 6) =       0.000449985132
  error estimate for blocks of size 2^( 7) =       0.000451023140

      target function =                  N/A
              le_mean =     -17.210884990315
             les_mean =     296.562202125027
             stat err =       0.000447732374
             autocorr =       1.153286118361
              std dev =       0.589610166984
             le_variance =       0.347640149011


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210884990335        initial  <--
     3.6380e+03     3.6380e+04             1.7181e-07       -17.210884990012
     1.4552e+04     1.4552e+05             4.2953e-08       -17.210884990173
     5.8208e+04     5.8208e+05             1.0738e-08       -17.210884990315

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4303
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560751e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.261806
====================================================
  Execution time = 3.1425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.7054e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370656664341
                                         uncertainty =       0.024208418209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370656664341
                                         uncertainty =       0.024208418209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430430441
  error estimate for blocks of size 2^( 2) =       0.000440375744
  error estimate for blocks of size 2^( 3) =       0.000449565655
  error estimate for blocks of size 2^( 4) =       0.000455506287
  error estimate for blocks of size 2^( 5) =       0.000459635231
  error estimate for blocks of size 2^( 6) =       0.000462098276
  error estimate for blocks of size 2^( 7) =       0.000464870847

      target function =                  N/A
              le_mean =     -17.211627265133
             les_mean =     296.610653657592
             stat err =       0.000460527660
             autocorr =       1.144736377289
              std dev =       0.608720567263
             le_variance =       0.370540729009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721162726513e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211627265133       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211627265122       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211627265129       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211627265155       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211627265184       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211627265200       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211627265167       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.792059e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211627265133       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211627265130       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211627265132       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211627265219       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211627265116       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211627265192       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211627265026       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 4.480149e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211627265133       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211627265132       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211627265132       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211627265132       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211627267589       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211627265162       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211627264497       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 1.120037e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0852e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560752e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203599e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1562
    reference variance = 0.253332
====================================================
  Execution time = 3.2356e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.5343e-01
  Total weights = 2.0000e+06
  Execution time = 2.6719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458142503
                                         uncertainty =       0.011716385031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458142503
                                         uncertainty =       0.011716385031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420372426
  error estimate for blocks of size 2^( 2) =       0.000430092380
  error estimate for blocks of size 2^( 3) =       0.000439782246
  error estimate for blocks of size 2^( 4) =       0.000446690833
  error estimate for blocks of size 2^( 5) =       0.000450916134
  error estimate for blocks of size 2^( 6) =       0.000453009569
  error estimate for blocks of size 2^( 7) =       0.000455024492

      target function =                  N/A
              le_mean =     -17.211224086924
             les_mean =     296.579660345853
             stat err =       0.000451410257
             autocorr =       1.153119733487
              std dev =       0.594496385399
             le_variance =       0.353425952252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458146191
                                         uncertainty =       0.011716385217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458146191
                                         uncertainty =       0.011716385217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420372428
  error estimate for blocks of size 2^( 2) =       0.000430092382
  error estimate for blocks of size 2^( 3) =       0.000439782248
  error estimate for blocks of size 2^( 4) =       0.000446690835
  error estimate for blocks of size 2^( 5) =       0.000450916136
  error estimate for blocks of size 2^( 6) =       0.000453009570
  error estimate for blocks of size 2^( 7) =       0.000455024493

      target function =                  N/A
              le_mean =     -17.211224086923
             les_mean =     296.579660349511
             stat err =       0.000451410259
             autocorr =       1.153119730874
              std dev =       0.594496388499
             le_variance =       0.353425955938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458144347
                                         uncertainty =       0.011716385124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458144347
                                         uncertainty =       0.011716385124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420372427
  error estimate for blocks of size 2^( 2) =       0.000430092381
  error estimate for blocks of size 2^( 3) =       0.000439782247
  error estimate for blocks of size 2^( 4) =       0.000446690834
  error estimate for blocks of size 2^( 5) =       0.000450916135
  error estimate for blocks of size 2^( 6) =       0.000453009570
  error estimate for blocks of size 2^( 7) =       0.000455024492

      target function =                  N/A
              le_mean =     -17.211224086924
             les_mean =     296.579660347682
             stat err =       0.000451410258
             autocorr =       1.153119732177
              std dev =       0.594496386949
             le_variance =       0.353425954095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458142734
                                         uncertainty =       0.011716385043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353458142734
                                         uncertainty =       0.011716385043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420372426
  error estimate for blocks of size 2^( 2) =       0.000430092380
  error estimate for blocks of size 2^( 3) =       0.000439782247
  error estimate for blocks of size 2^( 4) =       0.000446690833
  error estimate for blocks of size 2^( 5) =       0.000450916134
  error estimate for blocks of size 2^( 6) =       0.000453009569
  error estimate for blocks of size 2^( 7) =       0.000455024492

      target function =                  N/A
              le_mean =     -17.211224086924
             les_mean =     296.579660346082
             stat err =       0.000451410257
             autocorr =       1.153119733325
              std dev =       0.594496385593
             le_variance =       0.353425952483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211224086924        initial  <--
     3.6380e+04     3.6380e+05             1.7921e-08       -17.211224086923
     1.4552e+05     1.4552e+06             4.4801e-09       -17.211224086924
     5.8208e+05     5.8208e+06             1.1200e-09       -17.211224086924

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7159
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560751e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.237
    reference variance = 0.354419
====================================================
  Execution time = 3.1290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342469949548
                                         uncertainty =       0.005459815794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342469949548
                                         uncertainty =       0.005459815794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413786469
  error estimate for blocks of size 2^( 2) =       0.000423862615
  error estimate for blocks of size 2^( 3) =       0.000433168994
  error estimate for blocks of size 2^( 4) =       0.000439287479
  error estimate for blocks of size 2^( 5) =       0.000442817039
  error estimate for blocks of size 2^( 6) =       0.000445776270
  error estimate for blocks of size 2^( 7) =       0.000446925836

      target function =                  N/A
              le_mean =     -17.211542750681
             les_mean =     296.579642171275
             stat err =       0.000443701656
             autocorr =       1.149819128002
              std dev =       0.585182436485
             le_variance =       0.342438483971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721154275068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211542750681       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211542750682       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211542750681       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211542750557       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211542750684       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211542750464       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211542750740       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.603259e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211542750681       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211542750681       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211542750681       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211542750682       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211542750705       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211542750570       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211542750355       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 4.008148e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211542750681       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211542750681       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211542750681       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211542750688       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211542749825       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211542748400       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211542749494       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 1.002040e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0169e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560751e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2574
    reference variance = 0.427729
====================================================
  Execution time = 3.1132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4154e-01
  Total weights = 2.0000e+06
  Execution time = 2.6582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666281
                                         uncertainty =       0.003029594703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666281
                                         uncertainty =       0.003029594703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413243837
  error estimate for blocks of size 2^( 2) =       0.000424002803
  error estimate for blocks of size 2^( 3) =       0.000433391183
  error estimate for blocks of size 2^( 4) =       0.000440672487
  error estimate for blocks of size 2^( 5) =       0.000445031749
  error estimate for blocks of size 2^( 6) =       0.000445429928
  error estimate for blocks of size 2^( 7) =       0.000446221229

      target function =                  N/A
              le_mean =     -17.211848571661
             les_mean =     296.589272019977
             stat err =       0.000444338848
             autocorr =       1.156154302511
              std dev =       0.584415038266
             le_variance =       0.341540936951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666616
                                         uncertainty =       0.003029594707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666616
                                         uncertainty =       0.003029594707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413243837
  error estimate for blocks of size 2^( 2) =       0.000424002803
  error estimate for blocks of size 2^( 3) =       0.000433391183
  error estimate for blocks of size 2^( 4) =       0.000440672488
  error estimate for blocks of size 2^( 5) =       0.000445031749
  error estimate for blocks of size 2^( 6) =       0.000445429928
  error estimate for blocks of size 2^( 7) =       0.000446221229

      target function =                  N/A
              le_mean =     -17.211848571665
             les_mean =     296.589272020429
             stat err =       0.000444338848
             autocorr =       1.156154302189
              std dev =       0.584415038552
             le_variance =       0.341540937286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666448
                                         uncertainty =       0.003029594705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666448
                                         uncertainty =       0.003029594705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413243837
  error estimate for blocks of size 2^( 2) =       0.000424002803
  error estimate for blocks of size 2^( 3) =       0.000433391183
  error estimate for blocks of size 2^( 4) =       0.000440672487
  error estimate for blocks of size 2^( 5) =       0.000445031749
  error estimate for blocks of size 2^( 6) =       0.000445429928
  error estimate for blocks of size 2^( 7) =       0.000446221229

      target function =                  N/A
              le_mean =     -17.211848571663
             les_mean =     296.589272020203
             stat err =       0.000444338848
             autocorr =       1.156154302343
              std dev =       0.584415038409
             le_variance =       0.341540937119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666302
                                         uncertainty =       0.003029594703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341513666302
                                         uncertainty =       0.003029594703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413243837
  error estimate for blocks of size 2^( 2) =       0.000424002803
  error estimate for blocks of size 2^( 3) =       0.000433391183
  error estimate for blocks of size 2^( 4) =       0.000440672487
  error estimate for blocks of size 2^( 5) =       0.000445031749
  error estimate for blocks of size 2^( 6) =       0.000445429928
  error estimate for blocks of size 2^( 7) =       0.000446221229

      target function =                  N/A
              le_mean =     -17.211848571661
             les_mean =     296.589272020005
             stat err =       0.000444338848
             autocorr =       1.156154302483
              std dev =       0.584415038284
             le_variance =       0.341540936972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211848571661        initial
     3.6380e+05     3.6380e+06             1.6033e-09       -17.211848571665  <--
     1.4552e+06     1.4552e+07             4.0081e-10       -17.211848571663
     5.8208e+06     5.8208e+07             1.0020e-10       -17.211848571661

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 4.4564e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560752e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.162947
====================================================
  Execution time = 3.1144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336293777118
                                         uncertainty =       0.002462405155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336293777118
                                         uncertainty =       0.002462405155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410021233
  error estimate for blocks of size 2^( 2) =       0.000420422353
  error estimate for blocks of size 2^( 3) =       0.000430682733
  error estimate for blocks of size 2^( 4) =       0.000437097264
  error estimate for blocks of size 2^( 5) =       0.000441117273
  error estimate for blocks of size 2^( 6) =       0.000442891309
  error estimate for blocks of size 2^( 7) =       0.000442885619

      target function =                  N/A
              le_mean =     -17.211776296686
             les_mean =     296.581477941949
             stat err =       0.000440997866
             autocorr =       1.156805332763
              std dev =       0.579857588458
             le_variance =       0.336234822893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721177629669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211776296686       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211776296697       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211776296699       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211776296708       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211776296695       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211776296693       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211776296744       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211776296773       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 6.712569e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211776296686       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211776296689       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211776296690       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211776296692       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211776296702       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211776296704       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211776296473       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211776296136       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.678143e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211776296686       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211776296687       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211776296687       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211776296688       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211776296783       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211776295819       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211776296781       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211776299832       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 4.195364e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288091 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0064e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560752e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203599e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2057
    reference variance = 0.244383
====================================================
  Execution time = 3.1175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3826e-01
  Total weights = 2.0000e+06
  Execution time = 2.6625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342755437
                                         uncertainty =       0.003265193760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342755437
                                         uncertainty =       0.003265193760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411255872
  error estimate for blocks of size 2^( 2) =       0.000421676687
  error estimate for blocks of size 2^( 3) =       0.000431269008
  error estimate for blocks of size 2^( 4) =       0.000438533687
  error estimate for blocks of size 2^( 5) =       0.000443742612
  error estimate for blocks of size 2^( 6) =       0.000446595917
  error estimate for blocks of size 2^( 7) =       0.000449595668

      target function =                  N/A
              le_mean =     -17.210579100125
             les_mean =     296.542295577331
             stat err =       0.000444616971
             autocorr =       1.168820573435
              std dev =       0.581603632028
             le_variance =       0.338262784788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342754267
                                         uncertainty =       0.003265193751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342754267
                                         uncertainty =       0.003265193751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411255871
  error estimate for blocks of size 2^( 2) =       0.000421676686
  error estimate for blocks of size 2^( 3) =       0.000431269008
  error estimate for blocks of size 2^( 4) =       0.000438533687
  error estimate for blocks of size 2^( 5) =       0.000443742611
  error estimate for blocks of size 2^( 6) =       0.000446595917
  error estimate for blocks of size 2^( 7) =       0.000449595668

      target function =                  N/A
              le_mean =     -17.210579100124
             les_mean =     296.542295576093
             stat err =       0.000444616970
             autocorr =       1.168820573902
              std dev =       0.581603631020
             le_variance =       0.338262783616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342754852
                                         uncertainty =       0.003265193756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342754852
                                         uncertainty =       0.003265193756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411255872
  error estimate for blocks of size 2^( 2) =       0.000421676686
  error estimate for blocks of size 2^( 3) =       0.000431269008
  error estimate for blocks of size 2^( 4) =       0.000438533687
  error estimate for blocks of size 2^( 5) =       0.000443742611
  error estimate for blocks of size 2^( 6) =       0.000446595917
  error estimate for blocks of size 2^( 7) =       0.000449595668

      target function =                  N/A
              le_mean =     -17.210579100124
             les_mean =     296.542295576712
             stat err =       0.000444616971
             autocorr =       1.168820573674
              std dev =       0.581603631524
             le_variance =       0.338262784202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342755364
                                         uncertainty =       0.003265193760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338342755364
                                         uncertainty =       0.003265193760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411255872
  error estimate for blocks of size 2^( 2) =       0.000421676687
  error estimate for blocks of size 2^( 3) =       0.000431269008
  error estimate for blocks of size 2^( 4) =       0.000438533687
  error estimate for blocks of size 2^( 5) =       0.000443742612
  error estimate for blocks of size 2^( 6) =       0.000446595917
  error estimate for blocks of size 2^( 7) =       0.000449595668

      target function =                  N/A
              le_mean =     -17.210579100125
             les_mean =     296.542295577254
             stat err =       0.000444616971
             autocorr =       1.168820573469
              std dev =       0.581603631965
             le_variance =       0.338262784715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210579100125        initial  <--
     9.0949e+04     9.0949e+05             6.7126e-09       -17.210579100124
     3.6380e+05     3.6380e+06             1.6781e-09       -17.210579100124
     1.4552e+06     1.4552e+07             4.1954e-10       -17.210579100125

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6130
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560752e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2855
    reference variance = 0.295289
====================================================
  Execution time = 3.1508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4251e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342568666403
                                         uncertainty =       0.003583672149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342568666403
                                         uncertainty =       0.003583672149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413830502
  error estimate for blocks of size 2^( 2) =       0.000424539302
  error estimate for blocks of size 2^( 3) =       0.000433635784
  error estimate for blocks of size 2^( 4) =       0.000440538416
  error estimate for blocks of size 2^( 5) =       0.000445316096
  error estimate for blocks of size 2^( 6) =       0.000449173336
  error estimate for blocks of size 2^( 7) =       0.000449641028

      target function =                  N/A
              le_mean =     -17.211792772126
             les_mean =     296.588321627830
             stat err =       0.000446167219
             autocorr =       1.162385869637
              std dev =       0.585244708198
             le_variance =       0.342511368474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179277213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211792772126       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211792772127       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211792772128       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211792771981       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211792772130       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211792772131       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211792772069       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211792772079       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 6.269734e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211792772126       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211792772126       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211792772126       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211792771728       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211792772283       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211792772552       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211792771674       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211792772129       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.567433e-10

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211792772126       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211792772126       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211792772126       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211792669923       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211792822526       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.211792772550       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.211792839742       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211792744339       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 3.918989e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0288e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560752e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2176
    reference variance = 0.378591
====================================================
  Execution time = 3.0884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.4693e-01
  Total weights = 2.0000e+06
  Execution time = 2.6641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264460
                                         uncertainty =       0.004511394796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264460
                                         uncertainty =       0.004511394796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416489688
  error estimate for blocks of size 2^( 2) =       0.000426556296
  error estimate for blocks of size 2^( 3) =       0.000436239719
  error estimate for blocks of size 2^( 4) =       0.000443180740
  error estimate for blocks of size 2^( 5) =       0.000446728075
  error estimate for blocks of size 2^( 6) =       0.000450245626
  error estimate for blocks of size 2^( 7) =       0.000450501803

      target function =                  N/A
              le_mean =     -17.210679680484
             les_mean =     296.554422210452
             stat err =       0.000447664061
             autocorr =       1.155303143868
              std dev =       0.589005364733
             le_variance =       0.346927319684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264773
                                         uncertainty =       0.004511394799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264773
                                         uncertainty =       0.004511394799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416489688
  error estimate for blocks of size 2^( 2) =       0.000426556296
  error estimate for blocks of size 2^( 3) =       0.000436239719
  error estimate for blocks of size 2^( 4) =       0.000443180741
  error estimate for blocks of size 2^( 5) =       0.000446728075
  error estimate for blocks of size 2^( 6) =       0.000450245626
  error estimate for blocks of size 2^( 7) =       0.000450501803

      target function =                  N/A
              le_mean =     -17.210679680483
             les_mean =     296.554422210736
             stat err =       0.000447664061
             autocorr =       1.155303143647
              std dev =       0.589005364999
             le_variance =       0.346927319997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264617
                                         uncertainty =       0.004511394797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264617
                                         uncertainty =       0.004511394797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416489688
  error estimate for blocks of size 2^( 2) =       0.000426556296
  error estimate for blocks of size 2^( 3) =       0.000436239719
  error estimate for blocks of size 2^( 4) =       0.000443180741
  error estimate for blocks of size 2^( 5) =       0.000446728075
  error estimate for blocks of size 2^( 6) =       0.000450245626
  error estimate for blocks of size 2^( 7) =       0.000450501803

      target function =                  N/A
              le_mean =     -17.210679680484
             les_mean =     296.554422210594
             stat err =       0.000447664061
             autocorr =       1.155303143748
              std dev =       0.589005364866
             le_variance =       0.346927319841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264480
                                         uncertainty =       0.004511394796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346937264480
                                         uncertainty =       0.004511394796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416489688
  error estimate for blocks of size 2^( 2) =       0.000426556296
  error estimate for blocks of size 2^( 3) =       0.000436239719
  error estimate for blocks of size 2^( 4) =       0.000443180740
  error estimate for blocks of size 2^( 5) =       0.000446728075
  error estimate for blocks of size 2^( 6) =       0.000450245626
  error estimate for blocks of size 2^( 7) =       0.000450501803

      target function =                  N/A
              le_mean =     -17.210679680484
             les_mean =     296.554422210470
             stat err =       0.000447664061
             autocorr =       1.155303143856
              std dev =       0.589005364750
             le_variance =       0.346927319704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.210679680484        initial  <--
     9.0949e+05     9.0949e+06             6.2697e-10       -17.210679680483
     3.6380e+06     3.6380e+07             1.5674e-10       -17.210679680484
     1.4552e+07     1.4552e+08             3.9190e-11       -17.210679680484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.0432
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.130867e-01 1 1  ON 0
 uu_1                 4.837172e-02 1 1  ON 1
 uu_2                -4.948551e-02 1 1  ON 2
 uu_3                -1.044222e-01 1 1  ON 3
 uu_4                -1.348568e-01 1 1  ON 4
 uu_5                -1.379275e-01 1 1  ON 5
 uu_6                -1.122503e-01 1 1  ON 6
 uu_7                -3.948566e-02 1 1  ON 7
 uu_8                 9.976297e-02 1 1  ON 8
 uu_9                 1.222580e-01 1 1  ON 9
 ud_0                 3.560752e-01 1 1  ON 10
 ud_1                 9.347116e-02 1 1  ON 11
 ud_2                -1.734102e-02 1 1  ON 12
 ud_3                -7.670014e-02 1 1  ON 13
 ud_4                -1.233598e-01 1 1  ON 14
 ud_5                -1.546620e-01 1 1  ON 15
 ud_6                -1.563664e-01 1 1  ON 16
 ud_7                -1.120708e-01 1 1  ON 17
 ud_8                 3.203600e-03 1 1  ON 18
 ud_9                 9.332770e-02 1 1  ON 19
 eO_0                -7.669853e-01 1 1  ON 20
 eO_1                -4.441208e-01 1 1  ON 21
 eO_2                -3.323454e-02 1 1  ON 22
 eO_3                 2.162427e-01 1 1  ON 23
 eO_4                 2.985180e-01 1 1  ON 24
 eO_5                 3.079234e-01 1 1  ON 25
 eO_6                 2.503777e-01 1 1  ON 26
 eO_7                 1.132198e-01 1 1  ON 27
 eO_8                 2.823466e-02 1 1  ON 28
 eO_9                 1.877818e-02 1 1  ON 29
eH1_0                -1.831449e-01 1 1  ON 30
eH1_1                -1.046086e-01 1 1  ON 31
eH1_2                -6.298052e-02 1 1  ON 32
eH1_3                -2.596974e-02 1 1  ON 33
eH1_4                 1.969020e-02 1 1  ON 34
eH1_5                 3.582189e-02 1 1  ON 35
eH1_6                 7.813637e-02 1 1  ON 36
eH1_7                 1.104745e-01 1 1  ON 37
eH1_8                 9.203333e-02 1 1  ON 38
eH1_9                 2.490717e-02 1 1  ON 39
eH2_0                -1.838179e-01 1 1  ON 40
eH2_1                -1.054818e-01 1 1  ON 41
eH2_2                -6.370237e-02 1 1  ON 42
eH2_3                -2.661790e-02 1 1  ON 43
eH2_4                 1.862577e-02 1 1  ON 44
eH2_5                 3.500778e-02 1 1  ON 45
eH2_6                 7.871536e-02 1 1  ON 46
eH2_7                 1.135374e-01 1 1  ON 47
eH2_8                 9.461342e-02 1 1  ON 48
eH2_9                 2.673079e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8336e+01 secs
  Total Execution time = 3.4358e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
