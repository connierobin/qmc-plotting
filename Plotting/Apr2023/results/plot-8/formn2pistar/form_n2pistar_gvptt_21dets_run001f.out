Rank =    0  Free Memory = 68793 MB
Rank =    1  Free Memory = 68793 MB
Rank =    2  Free Memory = 68793 MB
Rank =    3  Free Memory = 68793 MB
Rank =    4  Free Memory = 68793 MB
Rank =    5  Free Memory = 68793 MB
Rank =    6  Free Memory = 68792 MB
Rank =    7  Free Memory = 68792 MB
Rank =    8  Free Memory = 68792 MB
Rank =    9  Free Memory = 68792 MB
Rank =   10  Free Memory = 68792 MB
Rank =   11  Free Memory = 68792 MB
Rank =   12  Free Memory = 68792 MB
Rank =   13  Free Memory = 68792 MB
Rank =   14  Free Memory = 68791 MB
Rank =   15  Free Memory = 68777 MB
Rank =   16  Free Memory = 68777 MB
Rank =   17  Free Memory = 68777 MB
Rank =   18  Free Memory = 68777 MB
Rank =   19  Free Memory = 68777 MB
Rank =   20  Free Memory = 68777 MB
Rank =   21  Free Memory = 68777 MB
Rank =   22  Free Memory = 68777 MB
Rank =   23  Free Memory = 68777 MB
Rank =   24  Free Memory = 68777 MB
Rank =   25  Free Memory = 68777 MB
Rank =   26  Free Memory = 68777 MB
Rank =   27  Free Memory = 68777 MB
Rank =   28  Free Memory = 68777 MB
Rank =   29  Free Memory = 68777 MB
Rank =   30  Free Memory = 68777 MB
Rank =   31  Free Memory = 68777 MB
Rank =   32  Free Memory = 75566 MB
Rank =   33  Free Memory = 75566 MB
Rank =   34  Free Memory = 75566 MB
Rank =   35  Free Memory = 75566 MB
Rank =   36  Free Memory = 75566 MB
Rank =   37  Free Memory = 75566 MB
Rank =   38  Free Memory = 75566 MB
Rank =   39  Free Memory = 75566 MB
Rank =   40  Free Memory = 75566 MB
Rank =   41  Free Memory = 75566 MB
Rank =   42  Free Memory = 75566 MB
Rank =   43  Free Memory = 75566 MB
Rank =   44  Free Memory = 75566 MB
Rank =   45  Free Memory = 75566 MB
Rank =   46  Free Memory = 75566 MB
Rank =   47  Free Memory = 75566 MB
Rank =   48  Free Memory = 75566 MB
Rank =   49  Free Memory = 75565 MB
Rank =   50  Free Memory = 75565 MB
Rank =   51  Free Memory = 75565 MB
Rank =   52  Free Memory = 75565 MB
Rank =   53  Free Memory = 75565 MB
Rank =   54  Free Memory = 75565 MB
Rank =   55  Free Memory = 75565 MB
Rank =   56  Free Memory = 75565 MB
Rank =   57  Free Memory = 75565 MB
Rank =   58  Free Memory = 75565 MB
Rank =   59  Free Memory = 75565 MB
Rank =   60  Free Memory = 75565 MB
Rank =   61  Free Memory = 75565 MB
Rank =   62  Free Memory = 75565 MB
Rank =   63  Free Memory = 75565 MB
Rank =   64  Free Memory = 68550 MB
Rank =   65  Free Memory = 68550 MB
Rank =   66  Free Memory = 68550 MB
Rank =   67  Free Memory = 68550 MB
Rank =   68  Free Memory = 68550 MB
Rank =   69  Free Memory = 68550 MB
Rank =   70  Free Memory = 68550 MB
Rank =   71  Free Memory = 68550 MB
Rank =   72  Free Memory = 68550 MB
Rank =   73  Free Memory = 68550 MB
Rank =   74  Free Memory = 68550 MB
Rank =   75  Free Memory = 68550 MB
Rank =   76  Free Memory = 68550 MB
Rank =   77  Free Memory = 68550 MB
Rank =   78  Free Memory = 68550 MB
Rank =   79  Free Memory = 68550 MB
Rank =   80  Free Memory = 68550 MB
Rank =   81  Free Memory = 68550 MB
Rank =   82  Free Memory = 68550 MB
Rank =   83  Free Memory = 68550 MB
Rank =   84  Free Memory = 68550 MB
Rank =   85  Free Memory = 68550 MB
Rank =   86  Free Memory = 68550 MB
Rank =   87  Free Memory = 68550 MB
Rank =   88  Free Memory = 68550 MB
Rank =   89  Free Memory = 68550 MB
Rank =   90  Free Memory = 68550 MB
Rank =   91  Free Memory = 68550 MB
Rank =   92  Free Memory = 68550 MB
Rank =   93  Free Memory = 68550 MB
Rank =   94  Free Memory = 68550 MB
Rank =   95  Free Memory = 68550 MB
Rank =   96  Free Memory = 68942 MB
Rank =   97  Free Memory = 68942 MB
Rank =   98  Free Memory = 68942 MB
Rank =   99  Free Memory = 68942 MB
Rank =  100  Free Memory = 68942 MB
Rank =  101  Free Memory = 68942 MB
Rank =  102  Free Memory = 68942 MB
Rank =  103  Free Memory = 68942 MB
Rank =  104  Free Memory = 68942 MB
Rank =  105  Free Memory = 68942 MB
Rank =  106  Free Memory = 68942 MB
Rank =  107  Free Memory = 68942 MB
Rank =  108  Free Memory = 68942 MB
Rank =  109  Free Memory = 68942 MB
Rank =  110  Free Memory = 68942 MB
Rank =  111  Free Memory = 68942 MB
Rank =  112  Free Memory = 68942 MB
Rank =  113  Free Memory = 68942 MB
Rank =  114  Free Memory = 68942 MB
Rank =  115  Free Memory = 68942 MB
Rank =  116  Free Memory = 68942 MB
Rank =  117  Free Memory = 68942 MB
Rank =  118  Free Memory = 68942 MB
Rank =  119  Free Memory = 68942 MB
Rank =  120  Free Memory = 68942 MB
Rank =  121  Free Memory = 68942 MB
Rank =  122  Free Memory = 68942 MB
Rank =  123  Free Memory = 68942 MB
Rank =  124  Free Memory = 68942 MB
Rank =  125  Free Memory = 68942 MB
Rank =  126  Free Memory = 68942 MB
Rank =  127  Free Memory = 68942 MB
  Input file(s): opt_form_n2pistar_gvptt_21dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_gvptt_21dets_run001f.xml

  Project = FORM
  date    = 2023-05-11 14:11:25 PDT
  host    = n0011.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 509

  Range of prime numbers to use as seeds over processors and threads = 3659-4733


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.948521e-01    1         1  ON     0
     uu_1                 1.194226e-01    1         1  ON     1
     uu_2                 6.107523e-03    1         1  ON     2
     uu_3                -6.108610e-02    1         1  ON     3
     uu_4                -1.015976e-01    1         1  ON     4
     uu_5                -1.273984e-01    1         1  ON     5
     uu_6                -1.427810e-01    1         1  ON     6
     uu_7                -1.471101e-01    1         1  ON     7
     uu_8                -1.393776e-01    1         1  ON     8
     uu_9                -1.168683e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.115921e-01    1         1  ON     0
     ud_1                 1.287132e-01    1         1  ON     1
     ud_2                -1.801498e-02    1         1  ON     2
     ud_3                -9.608355e-02    1         1  ON     3
     ud_4                -1.387399e-01    1         1  ON     4
     ud_5                -1.636968e-01    1         1  ON     5
     ud_6                -1.763109e-01    1         1  ON     6
     ud_7                -1.773849e-01    1         1  ON     7
     ud_8                -1.645168e-01    1         1  ON     8
     ud_9                -1.340615e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.809416e-01    1         1  ON     0
     eC_1                -4.285042e-01    1         1  ON     1
     eC_2                -1.788156e-01    1         1  ON     2
     eC_3                -2.340256e-02    1         1  ON     3
     eC_4                 5.650915e-02    1         1  ON     4
     eC_5                 1.595721e-01    1         1  ON     5
     eC_6                 2.565380e-01    1         1  ON     6
     eC_7                 3.742215e-01    1         1  ON     7
     eC_8                 2.776939e-01    1         1  ON     8
     eC_9                 8.003376e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.189137e+00    1         1  ON     0
     eO_1                -8.124511e-01    1         1  ON     1
     eO_2                -3.418757e-01    1         1  ON     2
     eO_3                -1.922922e-04    1         1  ON     3
     eO_4                 2.248421e-01    1         1  ON     4
     eO_5                 3.898984e-01    1         1  ON     5
     eO_6                 4.344989e-01    1         1  ON     6
     eO_7                 4.332108e-01    1         1  ON     7
     eO_8                 4.145607e-01    1         1  ON     8
     eO_9                 3.091284e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.047165e-01    1         1  ON     0
     eH1_1                -1.139026e-01    1         1  ON     1
     eH1_2                -7.659982e-02    1         1  ON     2
     eH1_3                -5.756470e-02    1         1  ON     3
     eH1_4                 1.110473e-02    1         1  ON     4
     eH1_5                 5.655184e-02    1         1  ON     5
     eH1_6                 8.908740e-02    1         1  ON     6
     eH1_7                 6.181491e-02    1         1  ON     7
     eH1_8                -2.276770e-04    1         1  ON     8
     eH1_9                 6.365952e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.016976e-01    1         1  ON     0
     eH2_1                -1.105326e-01    1         1  ON     1
     eH2_2                -7.278971e-02    1         1  ON     2
     eH2_3                -5.387374e-02    1         1  ON     3
     eH2_4                 1.459145e-02    1         1  ON     4
     eH2_5                 6.036038e-02    1         1  ON     5
     eH2_6                 9.322051e-02    1         1  ON     6
     eH2_7                 6.719039e-02    1         1  ON     7
     eH2_8                 1.091892e-02    1         1  ON     8
     eH2_9                 6.501270e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 21 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.677993e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 11 unique up determinants.
Found 11 unique down determinants.
Number of terms in pairs array: 9
Number of terms in pairs array: 9
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.4139e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.752
    reference variance = 0.600727
====================================================
  Execution time = 4.3372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1965e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4617e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519682851483
                                         uncertainty =       0.004283317560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519682851483
                                         uncertainty =       0.004283317560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509730965
  error estimate for blocks of size 2^( 2) =       0.000527421430
  error estimate for blocks of size 2^( 3) =       0.000543823285
  error estimate for blocks of size 2^( 4) =       0.000553865260
  error estimate for blocks of size 2^( 5) =       0.000559150174
  error estimate for blocks of size 2^( 6) =       0.000559318297
  error estimate for blocks of size 2^( 7) =       0.000557889024

      target function =                  N/A
              le_mean =     -22.668934541392
             les_mean =     514.400244296222
             stat err =       0.000557555689
             autocorr =       1.196449763462
              std dev =       0.720868444410
             le_variance =       0.519651314146


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266893454139e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668934541392       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668936767222       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668939110243       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668939234092       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668939214498       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668940707952       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668940677071       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668940239206       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668940252784       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668940983287       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668941199503       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.668940596715       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.668940479160       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.668940620156       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 6.889718e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668934541392       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668935335944       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668936301390       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668936417488       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668936297550       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668936711610       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668936776072       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668936623115       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668936551749       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668936657374       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668936746084       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.668936656589       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.245655e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668934541392       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668934763823       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668935054928       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668935102389       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668935064547       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668935162224       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668935184280       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668935131071       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668935121167       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668935137585       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 6.360007e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8007e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.948686e-01                 1 1 ON  0
uu_1  1.193787e-01                 1 1 ON  1
uu_2  6.144842e-03                 1 1 ON  2
uu_3  -6.102518e-02                1 1 ON  3
uu_4  -1.015406e-01                1 1 ON  4
uu_5  -1.273413e-01                1 1 ON  5
uu_6  -1.427105e-01                1 1 ON  6
uu_7  -1.471241e-01                1 1 ON  7
uu_8  -1.394700e-01                1 1 ON  8
uu_9  -1.168783e-01                1 1 ON  9
ud_0  4.118167e-01                 1 1 ON  10
ud_1  1.288910e-01                 1 1 ON  11
ud_2  -1.795715e-02                1 1 ON  12
ud_3  -9.602817e-02                1 1 ON  13
ud_4  -1.387033e-01                1 1 ON  14
ud_5  -1.636998e-01                1 1 ON  15
ud_6  -1.762640e-01                1 1 ON  16
ud_7  -1.774691e-01                1 1 ON  17
ud_8  -1.647148e-01                1 1 ON  18
ud_9  -1.341655e-01                1 1 ON  19
eC_0  -5.810525e-01                1 1 ON  20
eC_1  -4.285538e-01                1 1 ON  21
eC_2  -1.788508e-01                1 1 ON  22
eC_3  -2.353090e-02                1 1 ON  23
eC_4  5.652976e-02                 1 1 ON  24
eC_5  1.597411e-01                 1 1 ON  25
eC_6  2.566285e-01                 1 1 ON  26
eC_7  3.741402e-01                 1 1 ON  27
eC_8  2.777721e-01                 1 1 ON  28
eC_9  8.007725e-02                 1 1 ON  29
eO_0  -1.189208e+00                1 1 ON  30
eO_1  -8.125100e-01                1 1 ON  31
eO_2  -3.419117e-01                1 1 ON  32
eO_3  -3.113157e-04                1 1 ON  33
eO_4  2.247987e-01                 1 1 ON  34
eO_5  3.899675e-01                 1 1 ON  35
eO_6  4.345943e-01                 1 1 ON  36
eO_7  4.333404e-01                 1 1 ON  37
eO_8  4.144647e-01                 1 1 ON  38
eO_9  3.091934e-01                 1 1 ON  39
eH1_0 -2.049048e-01                1 1 ON  40
eH1_1 -1.140184e-01                1 1 ON  41
eH1_2 -7.661061e-02                1 1 ON  42
eH1_3 -5.763522e-02                1 1 ON  43
eH1_4 1.108395e-02                 1 1 ON  44
eH1_5 5.663695e-02                 1 1 ON  45
eH1_6 8.916405e-02                 1 1 ON  46
eH1_7 6.187229e-02                 1 1 ON  47
eH1_8 -6.915578e-05                1 1 ON  48
eH1_9 6.362381e-02                 1 1 ON  49
eH2_0 -2.016990e-01                1 1 ON  50
eH2_1 -1.104177e-01                1 1 ON  51
eH2_2 -7.285012e-02                1 1 ON  52
eH2_3 -5.388310e-02                1 1 ON  53
eH2_4 1.467042e-02                 1 1 ON  54
eH2_5 6.025876e-02                 1 1 ON  55
eH2_6 9.327811e-02                 1 1 ON  56
eH2_7 6.710576e-02                 1 1 ON  57
eH2_8 1.093706e-02                 1 1 ON  58
eH2_9 6.494280e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7537
    reference variance = 0.284513
====================================================
  Execution time = 4.1640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1651e-01
  Total weights = 2.0000e+06
  Execution time = 3.1750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516256625381
                                         uncertainty =       0.004236482827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516256625381
                                         uncertainty =       0.004236482827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508101875
  error estimate for blocks of size 2^( 2) =       0.000525990617
  error estimate for blocks of size 2^( 3) =       0.000542388795
  error estimate for blocks of size 2^( 4) =       0.000553719794
  error estimate for blocks of size 2^( 5) =       0.000561978423
  error estimate for blocks of size 2^( 6) =       0.000563064535
  error estimate for blocks of size 2^( 7) =       0.000565792021

      target function =                  N/A
              le_mean =     -22.668952168589
             les_mean =     514.397727193890
             stat err =       0.000561138693
             autocorr =       1.219660161161
              std dev =       0.718564562356
             le_variance =       0.516335030274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516666252417
                                         uncertainty =       0.004239287407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516666252417
                                         uncertainty =       0.004239287407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508303416
  error estimate for blocks of size 2^( 2) =       0.000526178747
  error estimate for blocks of size 2^( 3) =       0.000542561464
  error estimate for blocks of size 2^( 4) =       0.000553878494
  error estimate for blocks of size 2^( 5) =       0.000562136449
  error estimate for blocks of size 2^( 6) =       0.000563211018
  error estimate for blocks of size 2^( 7) =       0.000565932370

      target function =                  N/A
              le_mean =     -22.668946913061
             les_mean =     514.397898614133
             stat err =       0.000561289583
             autocorr =       1.219348667448
              std dev =       0.718849584628
             le_variance =       0.516744725320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516616230688
                                         uncertainty =       0.004239149353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516616230688
                                         uncertainty =       0.004239149353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508278813
  error estimate for blocks of size 2^( 2) =       0.000526155631
  error estimate for blocks of size 2^( 3) =       0.000542540979
  error estimate for blocks of size 2^( 4) =       0.000553861193
  error estimate for blocks of size 2^( 5) =       0.000562119424
  error estimate for blocks of size 2^( 6) =       0.000563197164
  error estimate for blocks of size 2^( 7) =       0.000565921190

      target function =                  N/A
              le_mean =     -22.668947607837
             les_mean =     514.397880091066
             stat err =       0.000561274743
             autocorr =       1.219402231235
              std dev =       0.718814790164
             le_variance =       0.516694702558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516313663488
                                         uncertainty =       0.004236936412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516313663488
                                         uncertainty =       0.004236936412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508129944
  error estimate for blocks of size 2^( 2) =       0.000526016744
  error estimate for blocks of size 2^( 3) =       0.000542412913
  error estimate for blocks of size 2^( 4) =       0.000553742267
  error estimate for blocks of size 2^( 5) =       0.000562000821
  error estimate for blocks of size 2^( 6) =       0.000563085662
  error estimate for blocks of size 2^( 7) =       0.000565812720

      target function =                  N/A
              le_mean =     -22.668951363752
             les_mean =     514.397747753516
             stat err =       0.000561160367
             autocorr =       1.219619627929
              std dev =       0.718604257956
             le_variance =       0.516392079553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668952168589        initial  <--
     2.5000e-01     2.5000e+00             6.8897e-04       -22.668946913061
     1.0000e+00     1.0000e+01             2.2457e-04       -22.668947607837
     4.0000e+00     4.0000e+01             6.3600e-05       -22.668951363752

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.6232
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107523e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115921e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124511e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922922e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655184e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276770e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278971e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091892e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1566e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2753e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6124
    reference variance = 0.353485
====================================================
  Execution time = 4.2050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1368e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4848e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513560185021
                                         uncertainty =       0.003575242121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513560185021
                                         uncertainty =       0.003575242121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506796211
  error estimate for blocks of size 2^( 2) =       0.000524825505
  error estimate for blocks of size 2^( 3) =       0.000540747371
  error estimate for blocks of size 2^( 4) =       0.000551851276
  error estimate for blocks of size 2^( 5) =       0.000559127588
  error estimate for blocks of size 2^( 6) =       0.000564355514
  error estimate for blocks of size 2^( 7) =       0.000566836445

      target function =                  N/A
              le_mean =     -22.669086268319
             les_mean =     514.401156783194
             stat err =       0.000560542706
             autocorr =       1.223349903117
              std dev =       0.716718075366
             le_variance =       0.513684799556


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266908626832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669086268319       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669086847428       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669087156398       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669087216657       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669087319594       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669087498398       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669087672877       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669087551694       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669087519883       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669087544056       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669087521565       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 8.252719e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669086268319       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669086420824       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669086509652       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669086532440       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669086561628       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669086608983       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669086654902       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669086623501       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669086614294       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669086620220       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669086615052       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 2.113770e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669086268319       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669086306961       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669086330001       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669086336291       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669086343885       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669086355924       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669086367573       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669086359685       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669086357282       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669086358733       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669086357460       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 5.317514e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6912e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.948530e-01 1 1  ON 0
 uu_1                 1.194144e-01 1 1  ON 1
 uu_2                 6.103776e-03 1 1  ON 2
 uu_3                -6.107617e-02 1 1  ON 3
 uu_4                -1.016015e-01 1 1  ON 4
 uu_5                -1.274014e-01 1 1  ON 5
 uu_6                -1.427731e-01 1 1  ON 6
 uu_7                -1.471160e-01 1 1  ON 7
 uu_8                -1.393774e-01 1 1  ON 8
 uu_9                -1.168632e-01 1 1  ON 9
 ud_0                 4.116052e-01 1 1  ON 10
 ud_1                 1.287287e-01 1 1  ON 11
 ud_2                -1.801240e-02 1 1  ON 12
 ud_3                -9.607744e-02 1 1  ON 13
 ud_4                -1.387436e-01 1 1  ON 14
 ud_5                -1.636977e-01 1 1  ON 15
 ud_6                -1.763022e-01 1 1  ON 16
 ud_7                -1.773808e-01 1 1  ON 17
 ud_8                -1.645380e-01 1 1  ON 18
 ud_9                -1.340709e-01 1 1  ON 19
 eC_0                -5.809546e-01 1 1  ON 20
 eC_1                -4.285145e-01 1 1  ON 21
 eC_2                -1.788201e-01 1 1  ON 22
 eC_3                -2.341777e-02 1 1  ON 23
 eC_4                 5.651657e-02 1 1  ON 24
 eC_5                 1.595889e-01 1 1  ON 25
 eC_6                 2.565491e-01 1 1  ON 26
 eC_7                 3.742167e-01 1 1  ON 27
 eC_8                 2.777008e-01 1 1  ON 28
 eC_9                 8.003873e-02 1 1  ON 29
 eO_0                -1.189153e+00 1 1  ON 30
 eO_1                -8.124543e-01 1 1  ON 31
 eO_2                -3.418912e-01 1 1  ON 32
 eO_3                -2.034601e-04 1 1  ON 33
 eO_4                 2.248580e-01 1 1  ON 34
 eO_5                 3.899080e-01 1 1  ON 35
 eO_6                 4.345061e-01 1 1  ON 36
 eO_7                 4.332187e-01 1 1  ON 37
 eO_8                 4.145513e-01 1 1  ON 38
 eO_9                 3.091350e-01 1 1  ON 39
eH1_0                -2.047309e-01 1 1  ON 40
eH1_1                -1.139150e-01 1 1  ON 41
eH1_2                -7.659035e-02 1 1  ON 42
eH1_3                -5.757146e-02 1 1  ON 43
eH1_4                 1.110936e-02 1 1  ON 44
eH1_5                 5.654120e-02 1 1  ON 45
eH1_6                 8.909910e-02 1 1  ON 46
eH1_7                 6.181402e-02 1 1  ON 47
eH1_8                -2.089425e-04 1 1  ON 48
eH1_9                 6.365541e-02 1 1  ON 49
eH2_0                -2.017058e-01 1 1  ON 50
eH2_1                -1.105482e-01 1 1  ON 51
eH2_2                -7.278769e-02 1 1  ON 52
eH2_3                -5.387333e-02 1 1  ON 53
eH2_4                 1.459961e-02 1 1  ON 54
eH2_5                 6.036373e-02 1 1  ON 55
eH2_6                 9.322196e-02 1 1  ON 56
eH2_7                 6.718618e-02 1 1  ON 57
eH2_8                 1.093010e-02 1 1  ON 58
eH2_9                 6.500879e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7136
    reference variance = 0.378796
====================================================
  Execution time = 4.3467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1231e-01
  Total weights = 2.0000e+06
  Execution time = 3.1770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512429795298
                                         uncertainty =       0.003305214078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512429795298
                                         uncertainty =       0.003305214078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506112755
  error estimate for blocks of size 2^( 2) =       0.000523690849
  error estimate for blocks of size 2^( 3) =       0.000539372492
  error estimate for blocks of size 2^( 4) =       0.000550717024
  error estimate for blocks of size 2^( 5) =       0.000556291314
  error estimate for blocks of size 2^( 6) =       0.000563823146
  error estimate for blocks of size 2^( 7) =       0.000564733409

      target function =                  N/A
              le_mean =     -22.667465499132
             les_mean =     514.326292140440
             stat err =       0.000558891223
             autocorr =       1.219438812784
              std dev =       0.715751522702
             le_variance =       0.512300242251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512476532650
                                         uncertainty =       0.003305963995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512476532650
                                         uncertainty =       0.003305963995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506135843
  error estimate for blocks of size 2^( 2) =       0.000523712474
  error estimate for blocks of size 2^( 3) =       0.000539391818
  error estimate for blocks of size 2^( 4) =       0.000550735795
  error estimate for blocks of size 2^( 5) =       0.000556309391
  error estimate for blocks of size 2^( 6) =       0.000563842098
  error estimate for blocks of size 2^( 7) =       0.000564749580

      target function =                  N/A
              le_mean =     -22.667465246860
             les_mean =     514.326327445469
             stat err =       0.000558909216
             autocorr =       1.219406072122
              std dev =       0.715784174203
             le_variance =       0.512346984040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512454970071
                                         uncertainty =       0.003305624867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512454970071
                                         uncertainty =       0.003305624867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506125192
  error estimate for blocks of size 2^( 2) =       0.000523702493
  error estimate for blocks of size 2^( 3) =       0.000539382906
  error estimate for blocks of size 2^( 4) =       0.000550727179
  error estimate for blocks of size 2^( 5) =       0.000556301106
  error estimate for blocks of size 2^( 6) =       0.000563833420
  error estimate for blocks of size 2^( 7) =       0.000564742161

      target function =                  N/A
              le_mean =     -22.667465368119
             les_mean =     514.326311378311
             stat err =       0.000558900966
             autocorr =       1.219421400453
              std dev =       0.715769110526
             le_variance =       0.512325419583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512432994646
                                         uncertainty =       0.003305266653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512432994646
                                         uncertainty =       0.003305266653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506114336
  error estimate for blocks of size 2^( 2) =       0.000523692328
  error estimate for blocks of size 2^( 3) =       0.000539373814
  error estimate for blocks of size 2^( 4) =       0.000550718315
  error estimate for blocks of size 2^( 5) =       0.000556292558
  error estimate for blocks of size 2^( 6) =       0.000563824453
  error estimate for blocks of size 2^( 7) =       0.000564734521

      target function =                  N/A
              le_mean =     -22.667465481567
             les_mean =     514.326294543785
             stat err =       0.000558892462
             autocorr =       1.219436600065
              std dev =       0.715753757883
             le_variance =       0.512303441923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667465499132        initial  <--
     2.5000e+00     2.5000e+01             8.2527e-05       -22.667465246860
     1.0000e+01     1.0000e+02             2.1138e-05       -22.667465368119
     4.0000e+01     4.0000e+02             5.3175e-06       -22.667465481567

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.3536
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107523e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115921e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124511e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922922e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655184e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276770e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278971e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091892e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1627e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.5224
    reference variance = 0.466712
====================================================
  Execution time = 4.2167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4896e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518479560675
                                         uncertainty =       0.005451435455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518479560675
                                         uncertainty =       0.005451435455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509162130
  error estimate for blocks of size 2^( 2) =       0.000526589899
  error estimate for blocks of size 2^( 3) =       0.000542694893
  error estimate for blocks of size 2^( 4) =       0.000553828766
  error estimate for blocks of size 2^( 5) =       0.000560362237
  error estimate for blocks of size 2^( 6) =       0.000563809650
  error estimate for blocks of size 2^( 7) =       0.000567470506

      target function =                  N/A
              le_mean =     -22.668955269517
             les_mean =     514.400024901196
             stat err =       0.000561367790
             autocorr =       1.215577886542
              std dev =       0.720063989577
             le_variance =       0.518492149086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266895526952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668955269517       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668955380828       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668955383447       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668955353196       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668955357856       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668955380193       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668955365741       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668955368691       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668955365033       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668955365874       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668955364753       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 8.581004e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668955269517       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668955297588       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668955298305       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668955290727       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668955291848       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668955297517       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668955293869       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668955294584       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668955293641       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668955293858       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668955293592       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 2.153449e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668955269517       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668955276550       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668955276733       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668955274838       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668955275116       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668955276538       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668955275624       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668955275801       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668955275563       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668955275619       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668955275553       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 5.388737e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7079e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.948524e-01 1 1  ON 0
 uu_1                 1.194228e-01 1 1  ON 1
 uu_2                 6.107079e-03 1 1  ON 2
 uu_3                -6.108543e-02 1 1  ON 3
 uu_4                -1.015969e-01 1 1  ON 4
 uu_5                -1.273986e-01 1 1  ON 5
 uu_6                -1.427812e-01 1 1  ON 6
 uu_7                -1.471097e-01 1 1  ON 7
 uu_8                -1.393774e-01 1 1  ON 8
 uu_9                -1.168688e-01 1 1  ON 9
 ud_0                 4.115927e-01 1 1  ON 10
 ud_1                 1.287145e-01 1 1  ON 11
 ud_2                -1.801451e-02 1 1  ON 12
 ud_3                -9.608334e-02 1 1  ON 13
 ud_4                -1.387401e-01 1 1  ON 14
 ud_5                -1.636970e-01 1 1  ON 15
 ud_6                -1.763115e-01 1 1  ON 16
 ud_7                -1.773837e-01 1 1  ON 17
 ud_8                -1.645174e-01 1 1  ON 18
 ud_9                -1.340622e-01 1 1  ON 19
 eC_0                -5.809435e-01 1 1  ON 20
 eC_1                -4.285050e-01 1 1  ON 21
 eC_2                -1.788164e-01 1 1  ON 22
 eC_3                -2.340369e-02 1 1  ON 23
 eC_4                 5.651071e-02 1 1  ON 24
 eC_5                 1.595728e-01 1 1  ON 25
 eC_6                 2.565393e-01 1 1  ON 26
 eC_7                 3.742211e-01 1 1  ON 27
 eC_8                 2.776946e-01 1 1  ON 28
 eC_9                 8.003428e-02 1 1  ON 29
 eO_0                -1.189138e+00 1 1  ON 30
 eO_1                -8.124515e-01 1 1  ON 31
 eO_2                -3.418779e-01 1 1  ON 32
 eO_3                -1.919055e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898990e-01 1 1  ON 35
 eO_6                 4.344998e-01 1 1  ON 36
 eO_7                 4.332117e-01 1 1  ON 37
 eO_8                 4.145596e-01 1 1  ON 38
 eO_9                 3.091290e-01 1 1  ON 39
eH1_0                -2.047168e-01 1 1  ON 40
eH1_1                -1.139036e-01 1 1  ON 41
eH1_2                -7.660154e-02 1 1  ON 42
eH1_3                -5.756425e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655229e-02 1 1  ON 45
eH1_6                 8.908781e-02 1 1  ON 46
eH1_7                 6.181484e-02 1 1  ON 47
eH1_8                -2.260449e-04 1 1  ON 48
eH1_9                 6.365913e-02 1 1  ON 49
eH2_0                -2.016988e-01 1 1  ON 50
eH2_1                -1.105333e-01 1 1  ON 51
eH2_2                -7.279105e-02 1 1  ON 52
eH2_3                -5.387369e-02 1 1  ON 53
eH2_4                 1.459197e-02 1 1  ON 54
eH2_5                 6.036074e-02 1 1  ON 55
eH2_6                 9.322119e-02 1 1  ON 56
eH2_7                 6.719059e-02 1 1  ON 57
eH2_8                 1.092032e-02 1 1  ON 58
eH2_9                 6.501225e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7199
    reference variance = 0.238193
====================================================
  Execution time = 4.2696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2992e-01
  Total weights = 2.0000e+06
  Execution time = 3.1853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529938349978
                                         uncertainty =       0.010702813749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529938349978
                                         uncertainty =       0.010702813749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514742652
  error estimate for blocks of size 2^( 2) =       0.000532132405
  error estimate for blocks of size 2^( 3) =       0.000547615273
  error estimate for blocks of size 2^( 4) =       0.000558867916
  error estimate for blocks of size 2^( 5) =       0.000564627291
  error estimate for blocks of size 2^( 6) =       0.000568280724
  error estimate for blocks of size 2^( 7) =       0.000570321167

      target function =                  N/A
              le_mean =     -22.668074308855
             les_mean =     514.371512601526
             stat err =       0.000565524275
             autocorr =       1.207041471595
              std dev =       0.727956039007
             le_variance =       0.529919994726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529940937134
                                         uncertainty =       0.010702847878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529940937134
                                         uncertainty =       0.010702847878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514743909
  error estimate for blocks of size 2^( 2) =       0.000532133551
  error estimate for blocks of size 2^( 3) =       0.000547616261
  error estimate for blocks of size 2^( 4) =       0.000558868771
  error estimate for blocks of size 2^( 5) =       0.000564628105
  error estimate for blocks of size 2^( 6) =       0.000568281447
  error estimate for blocks of size 2^( 7) =       0.000570322157

      target function =                  N/A
              le_mean =     -22.668074287664
             les_mean =     514.371514229408
             stat err =       0.000565525120
             autocorr =       1.207039184383
              std dev =       0.727957816992
             le_variance =       0.529922583319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529939650746
                                         uncertainty =       0.010702831004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529939650746
                                         uncertainty =       0.010702831004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514743284
  error estimate for blocks of size 2^( 2) =       0.000532132981
  error estimate for blocks of size 2^( 3) =       0.000547615769
  error estimate for blocks of size 2^( 4) =       0.000558868345
  error estimate for blocks of size 2^( 5) =       0.000564627698
  error estimate for blocks of size 2^( 6) =       0.000568281085
  error estimate for blocks of size 2^( 7) =       0.000570321664

      target function =                  N/A
              le_mean =     -22.668074297817
             les_mean =     514.371513402642
             stat err =       0.000565524698
             autocorr =       1.207040314296
              std dev =       0.727956932959
             le_variance =       0.529921296243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529938512756
                                         uncertainty =       0.010702815912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529938512756
                                         uncertainty =       0.010702815912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514742731
  error estimate for blocks of size 2^( 2) =       0.000532132477
  error estimate for blocks of size 2^( 3) =       0.000547615335
  error estimate for blocks of size 2^( 4) =       0.000558867970
  error estimate for blocks of size 2^( 5) =       0.000564627342
  error estimate for blocks of size 2^( 6) =       0.000568280769
  error estimate for blocks of size 2^( 7) =       0.000570321229

      target function =                  N/A
              le_mean =     -22.668074307453
             les_mean =     514.371512700861
             stat err =       0.000565524327
             autocorr =       1.207041326486
              std dev =       0.727956150876
             le_variance =       0.529920157598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668074308855        initial  <--
     2.5000e+01     2.5000e+02             8.5810e-06       -22.668074287664
     1.0000e+02     1.0000e+03             2.1534e-06       -22.668074297817
     4.0000e+02     4.0000e+03             5.3887e-07       -22.668074307453

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.6215
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107523e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115921e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124511e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922922e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655184e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276770e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278971e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091892e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1571e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7261
    reference variance = 0.4379
====================================================
  Execution time = 4.2858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1734e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4949e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517414114859
                                         uncertainty =       0.005721175932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517414114859
                                         uncertainty =       0.005721175932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508597590
  error estimate for blocks of size 2^( 2) =       0.000526484938
  error estimate for blocks of size 2^( 3) =       0.000541719487
  error estimate for blocks of size 2^( 4) =       0.000552346106
  error estimate for blocks of size 2^( 5) =       0.000559118713
  error estimate for blocks of size 2^( 6) =       0.000562976392
  error estimate for blocks of size 2^( 7) =       0.000565783717

      target function =                  N/A
              le_mean =     -22.668973067220
             les_mean =     514.399682680943
             stat err =       0.000560056232
             autocorr =       1.212591925657
              std dev =       0.719265609679
             le_variance =       0.517343017266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266897306722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668973067220       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668973070188       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668973071670       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668973073667       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668973075393       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668973076933       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668973076781       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668973077091       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668973075922       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668973076043       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 1.068826e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668973067220       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668973067962       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668973068333       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668973068833       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668973069265       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668973069651       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668973069613       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668973069690       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668973069396       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668973069432       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 2.673210e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668973067220       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668973067406       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668973067498       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668973067623       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668973067731       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668973067827       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668973067815       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668973067836       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668973067769       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668973067771       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 6.683743e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020845 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7819e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.948522e-01 1 1  ON 0
 uu_1                 1.194225e-01 1 1  ON 1
 uu_2                 6.107505e-03 1 1  ON 2
 uu_3                -6.108606e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427811e-01 1 1  ON 6
 uu_7                -1.471100e-01 1 1  ON 7
 uu_8                -1.393777e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115923e-01 1 1  ON 10
 ud_1                 1.287134e-01 1 1  ON 11
 ud_2                -1.801491e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636969e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773850e-01 1 1  ON 17
 ud_8                -1.645169e-01 1 1  ON 18
 ud_9                -1.340616e-01 1 1  ON 19
 eC_0                -5.809417e-01 1 1  ON 20
 eC_1                -4.285045e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340264e-02 1 1  ON 23
 eC_4                 5.650923e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565381e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776940e-01 1 1  ON 28
 eC_9                 8.003380e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418759e-01 1 1  ON 32
 eO_3                -1.922461e-04 1 1  ON 33
 eO_4                 2.248422e-01 1 1  ON 34
 eO_5                 3.898985e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332109e-01 1 1  ON 37
 eO_8                 4.145606e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047167e-01 1 1  ON 40
eH1_1                -1.139028e-01 1 1  ON 41
eH1_2                -7.659980e-02 1 1  ON 42
eH1_3                -5.756460e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655181e-02 1 1  ON 45
eH1_6                 8.908738e-02 1 1  ON 46
eH1_7                 6.181497e-02 1 1  ON 47
eH1_8                -2.274525e-04 1 1  ON 48
eH1_9                 6.365949e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278975e-02 1 1  ON 52
eH2_3                -5.387385e-02 1 1  ON 53
eH2_4                 1.459134e-02 1 1  ON 54
eH2_5                 6.036031e-02 1 1  ON 55
eH2_6                 9.322062e-02 1 1  ON 56
eH2_7                 6.719041e-02 1 1  ON 57
eH2_8                 1.091904e-02 1 1  ON 58
eH2_9                 6.501271e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7858
    reference variance = 0.403891
====================================================
  Execution time = 4.1498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1415e-01
  Total weights = 2.0000e+06
  Execution time = 3.1852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514229941431
                                         uncertainty =       0.004943626481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514229941431
                                         uncertainty =       0.004943626481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507026387
  error estimate for blocks of size 2^( 2) =       0.000525039703
  error estimate for blocks of size 2^( 3) =       0.000540825106
  error estimate for blocks of size 2^( 4) =       0.000551717771
  error estimate for blocks of size 2^( 5) =       0.000560216661
  error estimate for blocks of size 2^( 6) =       0.000562383393
  error estimate for blocks of size 2^( 7) =       0.000567459750

      target function =                  N/A
              le_mean =     -22.668469510345
             les_mean =     514.373661198369
             stat err =       0.000560444394
             autocorr =       1.221810730304
              std dev =       0.717043592819
             le_variance =       0.514151514003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514230701050
                                         uncertainty =       0.004943627831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514230701050
                                         uncertainty =       0.004943627831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507026761
  error estimate for blocks of size 2^( 2) =       0.000525040058
  error estimate for blocks of size 2^( 3) =       0.000540825434
  error estimate for blocks of size 2^( 4) =       0.000551718067
  error estimate for blocks of size 2^( 5) =       0.000560216932
  error estimate for blocks of size 2^( 6) =       0.000562383641
  error estimate for blocks of size 2^( 7) =       0.000567459982

      target function =                  N/A
              le_mean =     -22.668469503760
             les_mean =     514.373661659343
             stat err =       0.000560444655
             autocorr =       1.221810066651
              std dev =       0.717044122427
             le_variance =       0.514152273507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514230321244
                                         uncertainty =       0.004943627154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514230321244
                                         uncertainty =       0.004943627154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507026574
  error estimate for blocks of size 2^( 2) =       0.000525039880
  error estimate for blocks of size 2^( 3) =       0.000540825270
  error estimate for blocks of size 2^( 4) =       0.000551717919
  error estimate for blocks of size 2^( 5) =       0.000560216796
  error estimate for blocks of size 2^( 6) =       0.000562383517
  error estimate for blocks of size 2^( 7) =       0.000567459866

      target function =                  N/A
              le_mean =     -22.668469507048
             les_mean =     514.373661428633
             stat err =       0.000560444525
             autocorr =       1.221810398344
              std dev =       0.717043857626
             le_variance =       0.514151893759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514229988907
                                         uncertainty =       0.004943626565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514229988907
                                         uncertainty =       0.004943626565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507026410
  error estimate for blocks of size 2^( 2) =       0.000525039725
  error estimate for blocks of size 2^( 3) =       0.000540825126
  error estimate for blocks of size 2^( 4) =       0.000551717789
  error estimate for blocks of size 2^( 5) =       0.000560216678
  error estimate for blocks of size 2^( 6) =       0.000562383409
  error estimate for blocks of size 2^( 7) =       0.000567459764

      target function =                  N/A
              le_mean =     -22.668469509933
             les_mean =     514.373661227140
             stat err =       0.000560444410
             autocorr =       1.221810688802
              std dev =       0.717043625920
             le_variance =       0.514151561472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668469510345        initial  <--
     2.5000e+02     2.5000e+03             1.0688e-06       -22.668469503760
     1.0000e+03     1.0000e+04             2.6732e-07       -22.668469507048
     4.0000e+03     4.0000e+04             6.6837e-08       -22.668469509933

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.4014
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107523e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115921e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124511e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922922e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655184e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276770e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278971e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091892e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1523e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2698e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7223
    reference variance = 0.356157
====================================================
  Execution time = 4.3228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2333e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5260e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523262838723
                                         uncertainty =       0.010062942508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523262838723
                                         uncertainty =       0.010062942508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511532120
  error estimate for blocks of size 2^( 2) =       0.000529324719
  error estimate for blocks of size 2^( 3) =       0.000545042887
  error estimate for blocks of size 2^( 4) =       0.000556123541
  error estimate for blocks of size 2^( 5) =       0.000562713806
  error estimate for blocks of size 2^( 6) =       0.000567812238
  error estimate for blocks of size 2^( 7) =       0.000569059638

      target function =                  N/A
              le_mean =     -22.668383584664
             les_mean =     514.378944299649
             stat err =       0.000563927306
             autocorr =       1.215347380865
              std dev =       0.723415661889
             le_variance =       0.523330219866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266838358466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668383584664       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668383584777       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668383584533       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668383584425       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668383584549       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668383584767       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668383584825       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668383584735       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668383584744       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668383584720       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 8.564846e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668383584664       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668383584692       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668383584631       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668383584600       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668383584640       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668383584697       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668383584707       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668383584690       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668383584707       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668383584699       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 2.141467e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668383584664       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668383584671       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668383584655       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668383584649       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668383584657       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668383584670       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668383584662       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668383584677       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668383584654       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668383584667       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+04 is 5.353825e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8501e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107528e-03 1 1  ON 2
 uu_3                -6.108609e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393777e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115921e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608354e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003377e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922873e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139027e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110472e-02 1 1  ON 44
eH1_5                 5.655185e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181492e-02 1 1  ON 47
eH1_8                -2.276630e-04 1 1  ON 48
eH1_9                 6.365951e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278971e-02 1 1  ON 52
eH2_3                -5.387375e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719040e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6725
    reference variance = 0.32671
====================================================
  Execution time = 4.2521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1609e-01
  Total weights = 2.0000e+06
  Execution time = 3.1976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193455021
                                         uncertainty =       0.005611416377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193455021
                                         uncertainty =       0.005611416377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507979614
  error estimate for blocks of size 2^( 2) =       0.000525743288
  error estimate for blocks of size 2^( 3) =       0.000541454674
  error estimate for blocks of size 2^( 4) =       0.000553166289
  error estimate for blocks of size 2^( 5) =       0.000560903004
  error estimate for blocks of size 2^( 6) =       0.000565004287
  error estimate for blocks of size 2^( 7) =       0.000566629689

      target function =                  N/A
              le_mean =     -22.668710499066
             les_mean =     514.386522008458
             stat err =       0.000561425817
             autocorr =       1.221496403952
              std dev =       0.718391659210
             le_variance =       0.516086576022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193462711
                                         uncertainty =       0.005611414309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193462711
                                         uncertainty =       0.005611414309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507979618
  error estimate for blocks of size 2^( 2) =       0.000525743290
  error estimate for blocks of size 2^( 3) =       0.000541454675
  error estimate for blocks of size 2^( 4) =       0.000553166288
  error estimate for blocks of size 2^( 5) =       0.000560903002
  error estimate for blocks of size 2^( 6) =       0.000565004285
  error estimate for blocks of size 2^( 7) =       0.000566629687

      target function =                  N/A
              le_mean =     -22.668710498444
             les_mean =     514.386521987957
             stat err =       0.000561425816
             autocorr =       1.221496378018
              std dev =       0.718391664584
             le_variance =       0.516086583743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193458862
                                         uncertainty =       0.005611415343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193458862
                                         uncertainty =       0.005611415343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507979616
  error estimate for blocks of size 2^( 2) =       0.000525743289
  error estimate for blocks of size 2^( 3) =       0.000541454674
  error estimate for blocks of size 2^( 4) =       0.000553166288
  error estimate for blocks of size 2^( 5) =       0.000560903003
  error estimate for blocks of size 2^( 6) =       0.000565004286
  error estimate for blocks of size 2^( 7) =       0.000566629688

      target function =                  N/A
              le_mean =     -22.668710498755
             les_mean =     514.386521998201
             stat err =       0.000561425816
             autocorr =       1.221496390984
              std dev =       0.718391661894
             le_variance =       0.516086579879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193455501
                                         uncertainty =       0.005611416248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516193455501
                                         uncertainty =       0.005611416248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507979614
  error estimate for blocks of size 2^( 2) =       0.000525743288
  error estimate for blocks of size 2^( 3) =       0.000541454674
  error estimate for blocks of size 2^( 4) =       0.000553166289
  error estimate for blocks of size 2^( 5) =       0.000560903004
  error estimate for blocks of size 2^( 6) =       0.000565004287
  error estimate for blocks of size 2^( 7) =       0.000566629689

      target function =                  N/A
              le_mean =     -22.668710499027
             les_mean =     514.386522007175
             stat err =       0.000561425817
             autocorr =       1.221496402334
              std dev =       0.718391659545
             le_variance =       0.516086576504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668710499066        initial  <--
     2.5000e+03     2.5000e+04             8.5648e-08       -22.668710498444
     1.0000e+04     1.0000e+05             2.1415e-08       -22.668710498755
     4.0000e+04     4.0000e+05             5.3538e-09       -22.668710499027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.4877
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107523e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115921e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124511e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922922e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655184e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276770e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278971e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091892e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1699e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2698e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7573
    reference variance = 0.590236
====================================================
  Execution time = 4.2597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4865e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518685069122
                                         uncertainty =       0.004509336112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518685069122
                                         uncertainty =       0.004509336112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509244378
  error estimate for blocks of size 2^( 2) =       0.000527098730
  error estimate for blocks of size 2^( 3) =       0.000542798623
  error estimate for blocks of size 2^( 4) =       0.000553849531
  error estimate for blocks of size 2^( 5) =       0.000558834995
  error estimate for blocks of size 2^( 6) =       0.000561288583
  error estimate for blocks of size 2^( 7) =       0.000562915769

      target function =                  N/A
              le_mean =     -22.667402867169
             les_mean =     514.329812155521
             stat err =       0.000559222219
             autocorr =       1.205914041326
              std dev =       0.720180305405
             le_variance =       0.518659672293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266740286717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667402867169       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667402867197       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667402867203       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667402867222       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.667402867215       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.667402867191       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.667402867188       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667402867148       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.667402867141       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.667402867140       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.667402867147       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 1.046018e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667402867169       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667402867176       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667402867178       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667402867229       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.667402867207       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.667402867138       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.667402867273       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667402867333       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.667402867139       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.667402867388       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.667402866809       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 2.615062e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667402867169       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667402867171       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667402867171       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667402867154       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.667402867201       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.667402866958       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.667402867260       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667402867230       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.667402867235       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.667402866753       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.667402866900       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+05 is 6.537660e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028859 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7475e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107524e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115921e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124511e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922915e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655184e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276756e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278971e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091892e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6025
    reference variance = 0.471839
====================================================
  Execution time = 4.1796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2743e-01
  Total weights = 2.0000e+06
  Execution time = 3.1694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305117914
                                         uncertainty =       0.008744774136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305117914
                                         uncertainty =       0.008744774136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513532250
  error estimate for blocks of size 2^( 2) =       0.000531028294
  error estimate for blocks of size 2^( 3) =       0.000546571122
  error estimate for blocks of size 2^( 4) =       0.000557625501
  error estimate for blocks of size 2^( 5) =       0.000563585331
  error estimate for blocks of size 2^( 6) =       0.000565607978
  error estimate for blocks of size 2^( 7) =       0.000565222384

      target function =                  N/A
              le_mean =     -22.668439384850
             les_mean =     514.385574625176
             stat err =       0.000563010298
             autocorr =       1.201979974166
              std dev =       0.726244273135
             le_variance =       0.527430744261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305133184
                                         uncertainty =       0.008744774506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305133184
                                         uncertainty =       0.008744774506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513532258
  error estimate for blocks of size 2^( 2) =       0.000531028301
  error estimate for blocks of size 2^( 3) =       0.000546571129
  error estimate for blocks of size 2^( 4) =       0.000557625507
  error estimate for blocks of size 2^( 5) =       0.000563585336
  error estimate for blocks of size 2^( 6) =       0.000565607984
  error estimate for blocks of size 2^( 7) =       0.000565222389

      target function =                  N/A
              le_mean =     -22.668439384901
             les_mean =     514.385574642755
             stat err =       0.000563010304
             autocorr =       1.201979963206
              std dev =       0.726244283652
             le_variance =       0.527430759538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305125549
                                         uncertainty =       0.008744774321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305125549
                                         uncertainty =       0.008744774321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513532254
  error estimate for blocks of size 2^( 2) =       0.000531028297
  error estimate for blocks of size 2^( 3) =       0.000546571126
  error estimate for blocks of size 2^( 4) =       0.000557625504
  error estimate for blocks of size 2^( 5) =       0.000563585333
  error estimate for blocks of size 2^( 6) =       0.000565607981
  error estimate for blocks of size 2^( 7) =       0.000565222387

      target function =                  N/A
              le_mean =     -22.668439384876
             les_mean =     514.385574633966
             stat err =       0.000563010301
             autocorr =       1.201979968687
              std dev =       0.726244278394
             le_variance =       0.527430751900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305118869
                                         uncertainty =       0.008744774160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527305118869
                                         uncertainty =       0.008744774160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513532251
  error estimate for blocks of size 2^( 2) =       0.000531028294
  error estimate for blocks of size 2^( 3) =       0.000546571123
  error estimate for blocks of size 2^( 4) =       0.000557625501
  error estimate for blocks of size 2^( 5) =       0.000563585331
  error estimate for blocks of size 2^( 6) =       0.000565607979
  error estimate for blocks of size 2^( 7) =       0.000565222384

      target function =                  N/A
              le_mean =     -22.668439384853
             les_mean =     514.385574626275
             stat err =       0.000563010299
             autocorr =       1.201979973473
              std dev =       0.726244273792
             le_variance =       0.527430745216


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668439384850        initial
     2.5000e+04     2.5000e+05             1.0460e-08       -22.668439384901  <--
     1.0000e+05     1.0000e+06             2.6151e-09       -22.668439384876
     4.0000e+05     4.0000e+06             6.5377e-10       -22.668439384853

*****************************************************************************
Applying the update for shift_i =   2.5000e+04     and shift_s =   2.5000e+05
*****************************************************************************

  Execution time = 5.7690e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922893e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276714e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1517e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2695e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7434
    reference variance = 0.586851
====================================================
  Execution time = 4.2845e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1456e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4821e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514597632100
                                         uncertainty =       0.004841538277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514597632100
                                         uncertainty =       0.004841538277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507228161
  error estimate for blocks of size 2^( 2) =       0.000525273369
  error estimate for blocks of size 2^( 3) =       0.000541467996
  error estimate for blocks of size 2^( 4) =       0.000552091260
  error estimate for blocks of size 2^( 5) =       0.000558794633
  error estimate for blocks of size 2^( 6) =       0.000563286313
  error estimate for blocks of size 2^( 7) =       0.000565344278

      target function =                  N/A
              le_mean =     -22.668762969327
             les_mean =     514.387375116183
             stat err =       0.000559879121
             autocorr =       1.218377388299
              std dev =       0.717328944009
             le_variance =       0.514560813913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266876296933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668762969327       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668762969392       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668762969490       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668762969596       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668762969684       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668762969665       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668762969681       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668762969690       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668762969685       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668762969680       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 3.228571e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668762969327       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668762969343       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668762969368       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668762969398       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668762969415       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668762969413       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668762969385       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668762969423       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668762969419       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668762969340       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 8.071659e-09

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668762969327       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668762969331       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668762969338       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668762969353       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668762969320       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668762969267       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668762969324       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668762969286       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668762969209       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668762969385       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 2.017930e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7679e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107524e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809417e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922919e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139027e-01 1 1  ON 41
eH1_2                -7.659981e-02 1 1  ON 42
eH1_3                -5.756471e-02 1 1  ON 43
eH1_4                 1.110474e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181492e-02 1 1  ON 47
eH1_8                -2.276660e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.577
    reference variance = 0.347516
====================================================
  Execution time = 4.2732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1556e-01
  Total weights = 2.0000e+06
  Execution time = 3.1762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440473245
                                         uncertainty =       0.007182242242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440473245
                                         uncertainty =       0.007182242242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507718206
  error estimate for blocks of size 2^( 2) =       0.000525737613
  error estimate for blocks of size 2^( 3) =       0.000541714813
  error estimate for blocks of size 2^( 4) =       0.000551725341
  error estimate for blocks of size 2^( 5) =       0.000556668719
  error estimate for blocks of size 2^( 6) =       0.000561260649
  error estimate for blocks of size 2^( 7) =       0.000563187260

      target function =                  N/A
              le_mean =     -22.667595451056
             les_mean =     514.335438827432
             stat err =       0.000558210492
             autocorr =       1.208789052547
              std dev =       0.718021972132
             le_variance =       0.515555552465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440506397
                                         uncertainty =       0.007182242282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440506397
                                         uncertainty =       0.007182242282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507718222
  error estimate for blocks of size 2^( 2) =       0.000525737628
  error estimate for blocks of size 2^( 3) =       0.000541714827
  error estimate for blocks of size 2^( 4) =       0.000551725354
  error estimate for blocks of size 2^( 5) =       0.000556668731
  error estimate for blocks of size 2^( 6) =       0.000561260661
  error estimate for blocks of size 2^( 7) =       0.000563187271

      target function =                  N/A
              le_mean =     -22.667595450868
             les_mean =     514.335438852061
             stat err =       0.000558210505
             autocorr =       1.208789027068
              std dev =       0.718021995232
             le_variance =       0.515555585637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440489821
                                         uncertainty =       0.007182242262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440489821
                                         uncertainty =       0.007182242262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507718214
  error estimate for blocks of size 2^( 2) =       0.000525737620
  error estimate for blocks of size 2^( 3) =       0.000541714820
  error estimate for blocks of size 2^( 4) =       0.000551725348
  error estimate for blocks of size 2^( 5) =       0.000556668725
  error estimate for blocks of size 2^( 6) =       0.000561260655
  error estimate for blocks of size 2^( 7) =       0.000563187266

      target function =                  N/A
              le_mean =     -22.667595450962
             les_mean =     514.335438839747
             stat err =       0.000558210499
             autocorr =       1.208789039804
              std dev =       0.718021983682
             le_variance =       0.515555569051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440475317
                                         uncertainty =       0.007182242244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515440475317
                                         uncertainty =       0.007182242244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507718207
  error estimate for blocks of size 2^( 2) =       0.000525737614
  error estimate for blocks of size 2^( 3) =       0.000541714814
  error estimate for blocks of size 2^( 4) =       0.000551725342
  error estimate for blocks of size 2^( 5) =       0.000556668720
  error estimate for blocks of size 2^( 6) =       0.000561260650
  error estimate for blocks of size 2^( 7) =       0.000563187261

      target function =                  N/A
              le_mean =     -22.667595451044
             les_mean =     514.335438828972
             stat err =       0.000558210493
             autocorr =       1.208789050950
              std dev =       0.718021973576
             le_variance =       0.515555554538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667595451056        initial  <--
     6.2500e+03     6.2500e+04             3.2286e-08       -22.667595450868
     2.5000e+04     2.5000e+05             8.0717e-09       -22.667595450962
     1.0000e+05     1.0000e+06             2.0179e-09       -22.667595451044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4654
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922893e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276714e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1917e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2690e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6238
    reference variance = 0.454442
====================================================
  Execution time = 4.3168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1217e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4807e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512271457207
                                         uncertainty =       0.008846155220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512271457207
                                         uncertainty =       0.008846155220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506046826
  error estimate for blocks of size 2^( 2) =       0.000524253762
  error estimate for blocks of size 2^( 3) =       0.000540231538
  error estimate for blocks of size 2^( 4) =       0.000551883297
  error estimate for blocks of size 2^( 5) =       0.000557706919
  error estimate for blocks of size 2^( 6) =       0.000560945414
  error estimate for blocks of size 2^( 7) =       0.000563706424

      target function =                  N/A
              le_mean =     -22.668322230791
             les_mean =     514.364999284045
             stat err =       0.000558560514
             autocorr =       1.218313482417
              std dev =       0.715658285171
             le_variance =       0.512166781133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266832223079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668322230791       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668322230791       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668322230794       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668322230804       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668322230801       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668322230814       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668322230843       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668322230945       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668322230844       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668322230636       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+04 is 4.695735e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668322230791       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668322230791       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668322230792       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668322230793       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668322230565       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668322231061       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668322230594       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668322230853       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668322231116       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668322230207       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 1.173937e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668322230791       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668322230791       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668322230792       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668322230801       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668322230667       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668322228117       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668322231587       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668322230731       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668322232210       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668322227591       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+06 is 2.934830e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7988e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922896e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139027e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276705e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7011
    reference variance = 0.401825
====================================================
  Execution time = 4.2136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1700e-01
  Total weights = 2.0000e+06
  Execution time = 3.1799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050276073
                                         uncertainty =       0.004767620316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050276073
                                         uncertainty =       0.004767620316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508430678
  error estimate for blocks of size 2^( 2) =       0.000526785600
  error estimate for blocks of size 2^( 3) =       0.000542684351
  error estimate for blocks of size 2^( 4) =       0.000553135368
  error estimate for blocks of size 2^( 5) =       0.000559183201
  error estimate for blocks of size 2^( 6) =       0.000562127419
  error estimate for blocks of size 2^( 7) =       0.000561558633

      target function =                  N/A
              le_mean =     -22.668475188453
             les_mean =     514.376770618843
             stat err =       0.000559001155
             autocorr =       1.208820778803
              std dev =       0.719029559781
             le_variance =       0.517003507838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050280746
                                         uncertainty =       0.004767620390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050280746
                                         uncertainty =       0.004767620390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508430680
  error estimate for blocks of size 2^( 2) =       0.000526785603
  error estimate for blocks of size 2^( 3) =       0.000542684353
  error estimate for blocks of size 2^( 4) =       0.000553135370
  error estimate for blocks of size 2^( 5) =       0.000559183203
  error estimate for blocks of size 2^( 6) =       0.000562127421
  error estimate for blocks of size 2^( 7) =       0.000561558634

      target function =                  N/A
              le_mean =     -22.668475188434
             les_mean =     514.376770622673
             stat err =       0.000559001157
             autocorr =       1.208820775462
              std dev =       0.719029563030
             le_variance =       0.517003512511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050278410
                                         uncertainty =       0.004767620353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050278410
                                         uncertainty =       0.004767620353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508430679
  error estimate for blocks of size 2^( 2) =       0.000526785601
  error estimate for blocks of size 2^( 3) =       0.000542684352
  error estimate for blocks of size 2^( 4) =       0.000553135369
  error estimate for blocks of size 2^( 5) =       0.000559183202
  error estimate for blocks of size 2^( 6) =       0.000562127420
  error estimate for blocks of size 2^( 7) =       0.000561558634

      target function =                  N/A
              le_mean =     -22.668475188444
             les_mean =     514.376770620758
             stat err =       0.000559001156
             autocorr =       1.208820777130
              std dev =       0.719029561405
             le_variance =       0.517003510175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050276365
                                         uncertainty =       0.004767620320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517050276365
                                         uncertainty =       0.004767620320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508430678
  error estimate for blocks of size 2^( 2) =       0.000526785601
  error estimate for blocks of size 2^( 3) =       0.000542684351
  error estimate for blocks of size 2^( 4) =       0.000553135369
  error estimate for blocks of size 2^( 5) =       0.000559183201
  error estimate for blocks of size 2^( 6) =       0.000562127419
  error estimate for blocks of size 2^( 7) =       0.000561558633

      target function =                  N/A
              le_mean =     -22.668475188452
             les_mean =     514.376770619082
             stat err =       0.000559001155
             autocorr =       1.208820778587
              std dev =       0.719029559984
             le_variance =       0.517003508130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668475188453        initial  <--
     6.2500e+04     6.2500e+05             4.6957e-09       -22.668475188434
     2.5000e+05     2.5000e+06             1.1739e-09       -22.668475188444
     1.0000e+06     1.0000e+07             2.9348e-10       -22.668475188452

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.0409
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922893e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276714e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1604e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7398
    reference variance = 0.781461
====================================================
  Execution time = 4.2998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1605e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4864e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516054838034
                                         uncertainty =       0.003882239716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516054838034
                                         uncertainty =       0.003882239716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507962371
  error estimate for blocks of size 2^( 2) =       0.000526482090
  error estimate for blocks of size 2^( 3) =       0.000542452283
  error estimate for blocks of size 2^( 4) =       0.000553807040
  error estimate for blocks of size 2^( 5) =       0.000559869350
  error estimate for blocks of size 2^( 6) =       0.000563174954
  error estimate for blocks of size 2^( 7) =       0.000565615002

      target function =                  N/A
              le_mean =     -22.668651234461
             les_mean =     514.383800072818
             stat err =       0.000560616587
             autocorr =       1.218060337801
              std dev =       0.718367274590
             le_variance =       0.516051541201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266865123446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668651234461       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668651234462       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668651234462       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668651234462       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668651234329       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668651234553       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668651234319       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668651234463       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668651235051       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668651233358       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668651238707       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+05 is 3.311406e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668651234461       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668651234461       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668651234461       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668651234324       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668651234787       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668651234608       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668651235665       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668651235716       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668651235970       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668651238405       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668651229526       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 8.278593e-11

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668651234461       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668651234461       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668651234461       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668651238098       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668651234464       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668651238209       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668651231714       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668651234253       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668651239412       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668651240278       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668651263409       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+07 is 2.069663e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7875e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276714e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6402
    reference variance = 0.353873
====================================================
  Execution time = 4.2395e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0953e-01
  Total weights = 2.0000e+06
  Execution time = 3.1838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516437
                                         uncertainty =       0.003314734116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516437
                                         uncertainty =       0.003314734116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504740551
  error estimate for blocks of size 2^( 2) =       0.000522720951
  error estimate for blocks of size 2^( 3) =       0.000538305941
  error estimate for blocks of size 2^( 4) =       0.000549628621
  error estimate for blocks of size 2^( 5) =       0.000557125438
  error estimate for blocks of size 2^( 6) =       0.000562038067
  error estimate for blocks of size 2^( 7) =       0.000565847315

      target function =                  N/A
              le_mean =     -22.668892713064
             les_mean =     514.388222629640
             stat err =       0.000558659860
             autocorr =       1.225063334352
              std dev =       0.713810932936
             le_variance =       0.509526047979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516673
                                         uncertainty =       0.003314734117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516673
                                         uncertainty =       0.003314734117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504740551
  error estimate for blocks of size 2^( 2) =       0.000522720951
  error estimate for blocks of size 2^( 3) =       0.000538305941
  error estimate for blocks of size 2^( 4) =       0.000549628621
  error estimate for blocks of size 2^( 5) =       0.000557125438
  error estimate for blocks of size 2^( 6) =       0.000562038067
  error estimate for blocks of size 2^( 7) =       0.000565847315

      target function =                  N/A
              le_mean =     -22.668892713065
             les_mean =     514.388222629883
             stat err =       0.000558659861
             autocorr =       1.225063334209
              std dev =       0.713810933101
             le_variance =       0.509526048215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516555
                                         uncertainty =       0.003314734116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516555
                                         uncertainty =       0.003314734116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504740551
  error estimate for blocks of size 2^( 2) =       0.000522720951
  error estimate for blocks of size 2^( 3) =       0.000538305941
  error estimate for blocks of size 2^( 4) =       0.000549628621
  error estimate for blocks of size 2^( 5) =       0.000557125438
  error estimate for blocks of size 2^( 6) =       0.000562038067
  error estimate for blocks of size 2^( 7) =       0.000565847315

      target function =                  N/A
              le_mean =     -22.668892713064
             les_mean =     514.388222629762
             stat err =       0.000558659860
             autocorr =       1.225063334278
              std dev =       0.713810933018
             le_variance =       0.509526048097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516452
                                         uncertainty =       0.003314734116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509595516452
                                         uncertainty =       0.003314734116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504740551
  error estimate for blocks of size 2^( 2) =       0.000522720951
  error estimate for blocks of size 2^( 3) =       0.000538305941
  error estimate for blocks of size 2^( 4) =       0.000549628621
  error estimate for blocks of size 2^( 5) =       0.000557125438
  error estimate for blocks of size 2^( 6) =       0.000562038067
  error estimate for blocks of size 2^( 7) =       0.000565847315

      target function =                  N/A
              le_mean =     -22.668892713064
             les_mean =     514.388222629656
             stat err =       0.000558659860
             autocorr =       1.225063334345
              std dev =       0.713810932946
             le_variance =       0.509526047994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668892713064        initial
     6.2500e+05     6.2500e+06             3.3114e-10       -22.668892713065  <--
     2.5000e+06     2.5000e+07             8.2786e-11       -22.668892713064
     1.0000e+07     1.0000e+08             2.0697e-11       -22.668892713064

*****************************************************************************
Applying the update for shift_i =   6.2500e+05     and shift_s =   6.2500e+06
*****************************************************************************

  Execution time = 5.8320e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1620e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2687e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6958
    reference variance = 0.369888
====================================================
  Execution time = 4.2683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1082e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4901e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510922287409
                                         uncertainty =       0.004027207699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510922287409
                                         uncertainty =       0.004027207699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505382870
  error estimate for blocks of size 2^( 2) =       0.000523007452
  error estimate for blocks of size 2^( 3) =       0.000539324034
  error estimate for blocks of size 2^( 4) =       0.000550774955
  error estimate for blocks of size 2^( 5) =       0.000557619546
  error estimate for blocks of size 2^( 6) =       0.000560470757
  error estimate for blocks of size 2^( 7) =       0.000564195014

      target function =                  N/A
              le_mean =     -22.668356375682
             les_mean =     514.365204210122
             stat err =       0.000558265068
             autocorr =       1.220224871186
              std dev =       0.714719308972
             le_variance =       0.510823690617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266835637568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668356375682       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668356375680       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668356375680       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668356375685       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668356375686       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668356375668       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668356375603       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668356375617       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668356375453       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668356375672       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+05 is 1.367017e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668356375682       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668356375681       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668356375681       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668356375690       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668356375441       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668356375640       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668356376186       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668356375617       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668356376101       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668356376671       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+05 is 3.417549e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668356375682       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668356375682       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668356375682       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668356375682       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668356376003       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668356375682       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668356377331       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668356377591       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668356376140       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668356373904       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 8.543907e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7597e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139027e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276709e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7314
    reference variance = 0.443051
====================================================
  Execution time = 4.4097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2119e-01
  Total weights = 2.0000e+06
  Execution time = 3.1647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204018548
                                         uncertainty =       0.004531562945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204018548
                                         uncertainty =       0.004531562945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510483761
  error estimate for blocks of size 2^( 2) =       0.000528183489
  error estimate for blocks of size 2^( 3) =       0.000544646163
  error estimate for blocks of size 2^( 4) =       0.000556062930
  error estimate for blocks of size 2^( 5) =       0.000563037682
  error estimate for blocks of size 2^( 6) =       0.000565044635
  error estimate for blocks of size 2^( 7) =       0.000565342922

      target function =                  N/A
              le_mean =     -22.668853525855
             les_mean =     514.398107255712
             stat err =       0.000562372042
             autocorr =       1.213622395199
              std dev =       0.721933057585
             le_variance =       0.521187339634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204019633
                                         uncertainty =       0.004531562946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204019633
                                         uncertainty =       0.004531562946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510483761
  error estimate for blocks of size 2^( 2) =       0.000528183490
  error estimate for blocks of size 2^( 3) =       0.000544646164
  error estimate for blocks of size 2^( 4) =       0.000556062930
  error estimate for blocks of size 2^( 5) =       0.000563037682
  error estimate for blocks of size 2^( 6) =       0.000565044635
  error estimate for blocks of size 2^( 7) =       0.000565342922

      target function =                  N/A
              le_mean =     -22.668853525852
             les_mean =     514.398107256650
             stat err =       0.000562372042
             autocorr =       1.213622394218
              std dev =       0.721933058337
             le_variance =       0.521187340720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204019090
                                         uncertainty =       0.004531562946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204019090
                                         uncertainty =       0.004531562946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510483761
  error estimate for blocks of size 2^( 2) =       0.000528183490
  error estimate for blocks of size 2^( 3) =       0.000544646163
  error estimate for blocks of size 2^( 4) =       0.000556062930
  error estimate for blocks of size 2^( 5) =       0.000563037682
  error estimate for blocks of size 2^( 6) =       0.000565044635
  error estimate for blocks of size 2^( 7) =       0.000565342922

      target function =                  N/A
              le_mean =     -22.668853525853
             les_mean =     514.398107256181
             stat err =       0.000562372042
             autocorr =       1.213622394716
              std dev =       0.721933057961
             le_variance =       0.521187340177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204018616
                                         uncertainty =       0.004531562946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521204018616
                                         uncertainty =       0.004531562946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510483761
  error estimate for blocks of size 2^( 2) =       0.000528183489
  error estimate for blocks of size 2^( 3) =       0.000544646163
  error estimate for blocks of size 2^( 4) =       0.000556062930
  error estimate for blocks of size 2^( 5) =       0.000563037682
  error estimate for blocks of size 2^( 6) =       0.000565044635
  error estimate for blocks of size 2^( 7) =       0.000565342922

      target function =                  N/A
              le_mean =     -22.668853525855
             les_mean =     514.398107255771
             stat err =       0.000562372042
             autocorr =       1.213622395139
              std dev =       0.721933057632
             le_variance =       0.521187339702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668853525855        initial  <--
     1.5625e+05     1.5625e+06             1.3670e-09       -22.668853525852
     6.2500e+05     6.2500e+06             3.4175e-10       -22.668853525853
     2.5000e+06     2.5000e+07             8.5439e-11       -22.668853525855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.9550
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1756e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2690e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6748
    reference variance = 0.486281
====================================================
  Execution time = 4.2472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1518e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4660e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514986885828
                                         uncertainty =       0.004130124408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514986885828
                                         uncertainty =       0.004130124408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507534865
  error estimate for blocks of size 2^( 2) =       0.000525253865
  error estimate for blocks of size 2^( 3) =       0.000540979017
  error estimate for blocks of size 2^( 4) =       0.000552421717
  error estimate for blocks of size 2^( 5) =       0.000559209008
  error estimate for blocks of size 2^( 6) =       0.000561385735
  error estimate for blocks of size 2^( 7) =       0.000561234921

      target function =                  N/A
              le_mean =     -22.668382648654
             les_mean =     514.370754927269
             stat err =       0.000558562845
             autocorr =       1.211190133039
              std dev =       0.717762689944
             le_variance =       0.515183279076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266838264865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668382648654       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668382648654       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668382648655       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668382648656       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668382648656       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668382649798       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668382649467       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668382647505       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668382648675       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668382639623       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+06 is 1.369115e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668382648654       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668382648654       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668382648654       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668382648654       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668382649362       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668382647906       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668382648628       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668382649027       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668382647790       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668382651291       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+06 is 3.422766e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668382648654       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668382648654       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668382648654       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668382655800       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668382648654       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668382647157       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668382660064       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668382632069       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668382630249       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668382636736       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 8.557730e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7145e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6993
    reference variance = 0.70717
====================================================
  Execution time = 4.2071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1193e-01
  Total weights = 2.0000e+06
  Execution time = 3.1676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355771
                                         uncertainty =       0.006232672010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355771
                                         uncertainty =       0.006232672010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505928623
  error estimate for blocks of size 2^( 2) =       0.000524017251
  error estimate for blocks of size 2^( 3) =       0.000539725588
  error estimate for blocks of size 2^( 4) =       0.000551041984
  error estimate for blocks of size 2^( 5) =       0.000558734651
  error estimate for blocks of size 2^( 6) =       0.000562712569
  error estimate for blocks of size 2^( 7) =       0.000564751953

      target function =                  N/A
              le_mean =     -22.668732725646
             les_mean =     514.383370673877
             stat err =       0.000559310289
             autocorr =       1.222157329975
              std dev =       0.715491120172
             le_variance =       0.511927543044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355753
                                         uncertainty =       0.006232672008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355753
                                         uncertainty =       0.006232672008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505928623
  error estimate for blocks of size 2^( 2) =       0.000524017251
  error estimate for blocks of size 2^( 3) =       0.000539725588
  error estimate for blocks of size 2^( 4) =       0.000551041984
  error estimate for blocks of size 2^( 5) =       0.000558734651
  error estimate for blocks of size 2^( 6) =       0.000562712569
  error estimate for blocks of size 2^( 7) =       0.000564751953

      target function =                  N/A
              le_mean =     -22.668732725646
             les_mean =     514.383370673837
             stat err =       0.000559310289
             autocorr =       1.222157329961
              std dev =       0.715491120159
             le_variance =       0.511927543026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355762
                                         uncertainty =       0.006232672009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355762
                                         uncertainty =       0.006232672009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505928623
  error estimate for blocks of size 2^( 2) =       0.000524017251
  error estimate for blocks of size 2^( 3) =       0.000539725588
  error estimate for blocks of size 2^( 4) =       0.000551041984
  error estimate for blocks of size 2^( 5) =       0.000558734651
  error estimate for blocks of size 2^( 6) =       0.000562712569
  error estimate for blocks of size 2^( 7) =       0.000564751953

      target function =                  N/A
              le_mean =     -22.668732725646
             les_mean =     514.383370673857
             stat err =       0.000559310289
             autocorr =       1.222157329972
              std dev =       0.715491120165
             le_variance =       0.511927543035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355770
                                         uncertainty =       0.006232672010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511975355770
                                         uncertainty =       0.006232672010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505928623
  error estimate for blocks of size 2^( 2) =       0.000524017251
  error estimate for blocks of size 2^( 3) =       0.000539725588
  error estimate for blocks of size 2^( 4) =       0.000551041984
  error estimate for blocks of size 2^( 5) =       0.000558734651
  error estimate for blocks of size 2^( 6) =       0.000562712569
  error estimate for blocks of size 2^( 7) =       0.000564751953

      target function =                  N/A
              le_mean =     -22.668732725646
             les_mean =     514.383370673874
             stat err =       0.000559310289
             autocorr =       1.222157329977
              std dev =       0.715491120171
             le_variance =       0.511927543043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668732725646        initial  <--
     1.5625e+06     1.5625e+07             1.3691e-10       -22.668732725646
     6.2500e+06     6.2500e+07             3.4228e-11       -22.668732725646
     2.5000e+07     2.5000e+08             8.5577e-12       -22.668732725646

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.9860
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1514e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2689e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6826
    reference variance = 0.460012
====================================================
  Execution time = 4.2388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4800e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513856111578
                                         uncertainty =       0.004469021794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513856111578
                                         uncertainty =       0.004469021794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506851809
  error estimate for blocks of size 2^( 2) =       0.000524259934
  error estimate for blocks of size 2^( 3) =       0.000539754259
  error estimate for blocks of size 2^( 4) =       0.000550085934
  error estimate for blocks of size 2^( 5) =       0.000555901400
  error estimate for blocks of size 2^( 6) =       0.000560504035
  error estimate for blocks of size 2^( 7) =       0.000561085147

      target function =                  N/A
              le_mean =     -22.668784028188
             les_mean =     514.387566571509
             stat err =       0.000556894129
             autocorr =       1.207211260777
              std dev =       0.716796701830
             le_variance =       0.513797511755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266878402819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668784028188       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668784028189       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668784028189       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668784027094       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668784024862       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668784022710       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668784029652       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668784030536       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668784022984       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668784024259       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+07 is 1.658808e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668784028188       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668784028189       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668784028189       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668784016145       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668784049570       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668784022187       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668784065986       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668784049252       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668784107994       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668784114472       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+07 is 4.148773e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668784028188       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668784028188       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668784028188       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668783977055       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668784031429       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668783832987       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668783894745       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668783949123       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668784112281       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668783981462       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 1.035818e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7204e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6778
    reference variance = 0.66566
====================================================
  Execution time = 4.2711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0723e-01
  Total weights = 2.0000e+06
  Execution time = 3.1587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468024
                                         uncertainty =       0.003559396428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468024
                                         uncertainty =       0.003559396428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503602199
  error estimate for blocks of size 2^( 2) =       0.000521491921
  error estimate for blocks of size 2^( 3) =       0.000537237234
  error estimate for blocks of size 2^( 4) =       0.000547503960
  error estimate for blocks of size 2^( 5) =       0.000554282647
  error estimate for blocks of size 2^( 6) =       0.000556498267
  error estimate for blocks of size 2^( 7) =       0.000561013040

      target function =                  N/A
              le_mean =     -22.668083933778
             les_mean =     514.349259325042
             stat err =       0.000554824478
             autocorr =       1.213768859288
              std dev =       0.712201059998
             le_variance =       0.507230349862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468022
                                         uncertainty =       0.003559396427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468022
                                         uncertainty =       0.003559396427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503602199
  error estimate for blocks of size 2^( 2) =       0.000521491921
  error estimate for blocks of size 2^( 3) =       0.000537237234
  error estimate for blocks of size 2^( 4) =       0.000547503960
  error estimate for blocks of size 2^( 5) =       0.000554282647
  error estimate for blocks of size 2^( 6) =       0.000556498267
  error estimate for blocks of size 2^( 7) =       0.000561013040

      target function =                  N/A
              le_mean =     -22.668083933778
             les_mean =     514.349259325033
             stat err =       0.000554824478
             autocorr =       1.213768859288
              std dev =       0.712201059997
             le_variance =       0.507230349860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468023
                                         uncertainty =       0.003559396427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468023
                                         uncertainty =       0.003559396427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503602199
  error estimate for blocks of size 2^( 2) =       0.000521491921
  error estimate for blocks of size 2^( 3) =       0.000537237234
  error estimate for blocks of size 2^( 4) =       0.000547503960
  error estimate for blocks of size 2^( 5) =       0.000554282647
  error estimate for blocks of size 2^( 6) =       0.000556498267
  error estimate for blocks of size 2^( 7) =       0.000561013040

      target function =                  N/A
              le_mean =     -22.668083933778
             les_mean =     514.349259325037
             stat err =       0.000554824478
             autocorr =       1.213768859285
              std dev =       0.712201059998
             le_variance =       0.507230349862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468024
                                         uncertainty =       0.003559396428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507296468024
                                         uncertainty =       0.003559396428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503602199
  error estimate for blocks of size 2^( 2) =       0.000521491921
  error estimate for blocks of size 2^( 3) =       0.000537237234
  error estimate for blocks of size 2^( 4) =       0.000547503960
  error estimate for blocks of size 2^( 5) =       0.000554282647
  error estimate for blocks of size 2^( 6) =       0.000556498267
  error estimate for blocks of size 2^( 7) =       0.000561013040

      target function =                  N/A
              le_mean =     -22.668083933778
             les_mean =     514.349259325041
             stat err =       0.000554824478
             autocorr =       1.213768859280
              std dev =       0.712201059998
             le_variance =       0.507230349862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668083933778        initial  <--
     1.5625e+07     1.5625e+08             1.6588e-11       -22.668083933778
     6.2500e+07     6.2500e+08             4.1488e-12       -22.668083933778
     2.5000e+08     2.5000e+09             1.0358e-12       -22.668083933778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.5523
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1576e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2689e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6149
    reference variance = 0.573345
====================================================
  Execution time = 4.4594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1809e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4829e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518218019825
                                         uncertainty =       0.004293857737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518218019825
                                         uncertainty =       0.004293857737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508963409
  error estimate for blocks of size 2^( 2) =       0.000527362970
  error estimate for blocks of size 2^( 3) =       0.000542708185
  error estimate for blocks of size 2^( 4) =       0.000553700213
  error estimate for blocks of size 2^( 5) =       0.000560779589
  error estimate for blocks of size 2^( 6) =       0.000563398596
  error estimate for blocks of size 2^( 7) =       0.000563559210

      target function =                  N/A
              le_mean =     -22.668969161854
             les_mean =     514.400250105571
             stat err =       0.000560359402
             autocorr =       1.212160714759
              std dev =       0.719782955860
             le_variance =       0.518087503546


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266896916185e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668969161854       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668969161854       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668969161854       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668969162827       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668969172106       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668969155882       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668969172191       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668969233790       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668969028662       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668969204027       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668969233187       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+08 is 1.526713e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668969161854       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668969161854       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668969161854       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668969150068       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668969441740       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668969057161       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668968745570       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668970027592       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668968588903       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668970773271       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668969130889       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+08 is 3.813239e-13

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668969161854       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668969161854       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668969161854       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668968606460       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668971240468       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668968735319       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668969289361       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668969162940       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668966221215       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668969187953       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 9.384458e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9437e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6341
    reference variance = 0.500362
====================================================
  Execution time = 4.2999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1010e-01
  Total weights = 2.0000e+06
  Execution time = 3.1675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505024641
  error estimate for blocks of size 2^( 2) =       0.000522969193
  error estimate for blocks of size 2^( 3) =       0.000538613537
  error estimate for blocks of size 2^( 4) =       0.000548989463
  error estimate for blocks of size 2^( 5) =       0.000556929722
  error estimate for blocks of size 2^( 6) =       0.000559479177
  error estimate for blocks of size 2^( 7) =       0.000561846200

      target function =                  N/A
              le_mean =     -22.667950113950
             les_mean =     514.346061889474
             stat err =       0.000556811141
             autocorr =       1.215600009630
              std dev =       0.714212696594
             le_variance =       0.510099775976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505024641
  error estimate for blocks of size 2^( 2) =       0.000522969193
  error estimate for blocks of size 2^( 3) =       0.000538613537
  error estimate for blocks of size 2^( 4) =       0.000548989463
  error estimate for blocks of size 2^( 5) =       0.000556929722
  error estimate for blocks of size 2^( 6) =       0.000559479177
  error estimate for blocks of size 2^( 7) =       0.000561846200

      target function =                  N/A
              le_mean =     -22.667950113950
             les_mean =     514.346061889473
             stat err =       0.000556811141
             autocorr =       1.215600009621
              std dev =       0.714212696594
             le_variance =       0.510099775976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505024641
  error estimate for blocks of size 2^( 2) =       0.000522969193
  error estimate for blocks of size 2^( 3) =       0.000538613537
  error estimate for blocks of size 2^( 4) =       0.000548989463
  error estimate for blocks of size 2^( 5) =       0.000556929722
  error estimate for blocks of size 2^( 6) =       0.000559479177
  error estimate for blocks of size 2^( 7) =       0.000561846200

      target function =                  N/A
              le_mean =     -22.667950113950
             les_mean =     514.346061889474
             stat err =       0.000556811141
             autocorr =       1.215600009619
              std dev =       0.714212696594
             le_variance =       0.510099775976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185284175
                                         uncertainty =       0.003469703533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505024641
  error estimate for blocks of size 2^( 2) =       0.000522969193
  error estimate for blocks of size 2^( 3) =       0.000538613537
  error estimate for blocks of size 2^( 4) =       0.000548989463
  error estimate for blocks of size 2^( 5) =       0.000556929722
  error estimate for blocks of size 2^( 6) =       0.000559479177
  error estimate for blocks of size 2^( 7) =       0.000561846200

      target function =                  N/A
              le_mean =     -22.667950113950
             les_mean =     514.346061889474
             stat err =       0.000556811141
             autocorr =       1.215600009630
              std dev =       0.714212696594
             le_variance =       0.510099775976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667950113950        initial  <--
     1.5625e+08     1.5625e+09             1.5267e-12       -22.667950113950
     6.2500e+08     6.2500e+09             3.8132e-13       -22.667950113950
     2.5000e+09     2.5000e+10             9.3845e-14       -22.667950113950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.8906
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1837e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7033
    reference variance = 0.259885
====================================================
  Execution time = 4.2812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0888e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4826e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508915383302
                                         uncertainty =       0.003855840123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508915383302
                                         uncertainty =       0.003855840123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504422518
  error estimate for blocks of size 2^( 2) =       0.000522094895
  error estimate for blocks of size 2^( 3) =       0.000537873211
  error estimate for blocks of size 2^( 4) =       0.000549472758
  error estimate for blocks of size 2^( 5) =       0.000556280578
  error estimate for blocks of size 2^( 6) =       0.000558971999
  error estimate for blocks of size 2^( 7) =       0.000564025278

      target function =                  N/A
              le_mean =     -22.668171518344
             les_mean =     514.354883883788
             stat err =       0.000557187653
             autocorr =       1.220152284081
              std dev =       0.713361166009
             le_variance =       0.508884153170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266817151834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668171518344       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668171518344       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668171518344       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668171454728       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668171318760       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668171427595       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668171500438       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668171592768       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668172092066       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668172865105       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+09 is 1.424234e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668171518344       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668171518344       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668171518344       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668171518344       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668172836329       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668168651822       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668171580498       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668172499217       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668169624404       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668172305328       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+09 is 3.561158e-14

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668171518344       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668171518344       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668171518344       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668171518344       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668170706226       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668150506706       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668157189092       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668155591303       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668192172382       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668148638717       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668181025009       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.668152573353       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.668104820527       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.668223325381       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.668067126448       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.668288500432       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.668520965305       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.667882018266       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.668313001849       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.668837208141       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.669143437289       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.668779990307       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.667126713722       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.666824923652       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.668543559088       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.667719140468       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.666811395011       residual = 9.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.671287595296       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.667028009249       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.667223541049       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.668731309792       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.665031779046       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.666921297597       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.668696499169       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.667986127068       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.667438230755       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.668193297551       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.669202678435       residual = 6.24e-04           smallest_sin_value = 9.97e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+10 is 8.786441e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7701e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6406
    reference variance = 0.37464
====================================================
  Execution time = 4.1745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1383e-01
  Total weights = 2.0000e+06
  Execution time = 3.1561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506866188
  error estimate for blocks of size 2^( 2) =       0.000524791341
  error estimate for blocks of size 2^( 3) =       0.000540898467
  error estimate for blocks of size 2^( 4) =       0.000552840820
  error estimate for blocks of size 2^( 5) =       0.000560103982
  error estimate for blocks of size 2^( 6) =       0.000565902369
  error estimate for blocks of size 2^( 7) =       0.000570730641

      target function =                  N/A
              le_mean =     -22.667824438239
             les_mean =     514.344091171619
             stat err =       0.000562394453
             autocorr =       1.231105904949
              std dev =       0.716817037820
             le_variance =       0.513826665708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506866188
  error estimate for blocks of size 2^( 2) =       0.000524791341
  error estimate for blocks of size 2^( 3) =       0.000540898467
  error estimate for blocks of size 2^( 4) =       0.000552840820
  error estimate for blocks of size 2^( 5) =       0.000560103982
  error estimate for blocks of size 2^( 6) =       0.000565902369
  error estimate for blocks of size 2^( 7) =       0.000570730641

      target function =                  N/A
              le_mean =     -22.667824438239
             les_mean =     514.344091171619
             stat err =       0.000562394453
             autocorr =       1.231105904953
              std dev =       0.716817037820
             le_variance =       0.513826665709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506866188
  error estimate for blocks of size 2^( 2) =       0.000524791341
  error estimate for blocks of size 2^( 3) =       0.000540898467
  error estimate for blocks of size 2^( 4) =       0.000552840820
  error estimate for blocks of size 2^( 5) =       0.000560103982
  error estimate for blocks of size 2^( 6) =       0.000565902369
  error estimate for blocks of size 2^( 7) =       0.000570730641

      target function =                  N/A
              le_mean =     -22.667824438239
             les_mean =     514.344091171619
             stat err =       0.000562394453
             autocorr =       1.231105904952
              std dev =       0.716817037820
             le_variance =       0.513826665708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513944664114
                                         uncertainty =       0.003927265446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506866188
  error estimate for blocks of size 2^( 2) =       0.000524791341
  error estimate for blocks of size 2^( 3) =       0.000540898467
  error estimate for blocks of size 2^( 4) =       0.000552840820
  error estimate for blocks of size 2^( 5) =       0.000560103982
  error estimate for blocks of size 2^( 6) =       0.000565902369
  error estimate for blocks of size 2^( 7) =       0.000570730641

      target function =                  N/A
              le_mean =     -22.667824438239
             les_mean =     514.344091171619
             stat err =       0.000562394453
             autocorr =       1.231105904945
              std dev =       0.716817037820
             le_variance =       0.513826665708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667824438239        initial  <--
     1.5625e+09     1.5625e+10             1.4242e-13       -22.667824438239
     6.2500e+09     6.2500e+10             3.5612e-14       -22.667824438239
     2.5000e+10     2.5000e+11             8.7864e-15       -22.667824438239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5667
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1530e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2683e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.709
    reference variance = 0.55331
====================================================
  Execution time = 4.2953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2218e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5582e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521253531552
                                         uncertainty =       0.006071670976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521253531552
                                         uncertainty =       0.006071670976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510971123
  error estimate for blocks of size 2^( 2) =       0.000528711486
  error estimate for blocks of size 2^( 3) =       0.000544155490
  error estimate for blocks of size 2^( 4) =       0.000555674424
  error estimate for blocks of size 2^( 5) =       0.000562970808
  error estimate for blocks of size 2^( 6) =       0.000565316550
  error estimate for blocks of size 2^( 7) =       0.000567967501

      target function =                  N/A
              le_mean =     -22.669363364190
             les_mean =     514.422218053154
             stat err =       0.000562982321
             autocorr =       1.213938821588
              std dev =       0.722622291768
             le_variance =       0.522182976561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266936336419e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669363364190       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669363364190       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669363364190       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669363364190       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669362534861       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669364133175       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669364979819       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669360917643       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669368940221       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669362752622       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669350769593       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669402553302       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669326386765       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669510599326       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.669313159587       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.669585027220       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.669257733630       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.669055967979       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.669435956000       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.670096466341       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.669691057004       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.668906542842       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.669411115950       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.670534891739       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.670457956812       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.669617971344       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.669291037850       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.669516932963       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.670321458648       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.669173129938       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.669997027305       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.671047863920       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.669893200893       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.669923108538       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.669533184340       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.669511017557       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.669863254862       residual = 1.46e-04           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.671557019502       residual = 2.50e-03           smallest_sin_value = 9.95e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+10 is 1.769211e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669363364190       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669363364190       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669363364190       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669363332567       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669361804711       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669354197337       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669372837239       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669352394941       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669339626574       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669376156741       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669292109769       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669415953665       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669267641816       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669792523377       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.668709941415       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.669381393480       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.669428898241       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.669566683690       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.669403613944       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.670534380671       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.669798990043       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.673822070564       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.663730913559       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.669586851017       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.671175272622       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.671217131531       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.667316406167       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.666534522235       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.675051065342       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.669972610156       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.664843944769       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.669176477215       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.674742806372       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.673604538677       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.669931411711       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.669253998869       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.668695474354       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.682457191090       residual = 9.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.671052756556       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.669772763772       residual = 2.81e-04           smallest_sin_value = 9.98e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.670888167004       residual = 1.29e-03           smallest_sin_value = 9.96e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+10 is 4.130966e-15

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669363364190       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669363364190       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669363364190       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669363364190       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669363364190       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669120969675       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669321025155       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669214758369       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670299856406       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669814833933       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668900850872       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669220240987       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.668844579253       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669655129353       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.671349236870       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.673457411864       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.672325582211       residual = 4.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.670036745050       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.659777106525       residual = 4.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.678407515381       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.676580948822       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.675645267818       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.682342137725       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.672223949110       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.671864833639       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.658761894957       residual = 6.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.659057338167       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.657879151758       residual = 7.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.653149993373       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.668513797138       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.679003218325       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.676381941967       residual = 2.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.666190545956       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.664304015931       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.681997510615       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.674612129466       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.658694378941       residual = 6.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -22.675084159381       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -22.659860911993       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -22.709526509028       residual = 8.94e-01           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   energy =     -22.623577653526       residual = 1.13e+00           smallest_sin_value = 9.96e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+11 is 9.725425e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8626e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7222
    reference variance = 0.403081
====================================================
  Execution time = 4.4151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1867e-01
  Total weights = 2.0000e+06
  Execution time = 3.1587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509247234
  error estimate for blocks of size 2^( 2) =       0.000527300914
  error estimate for blocks of size 2^( 3) =       0.000543319360
  error estimate for blocks of size 2^( 4) =       0.000554038168
  error estimate for blocks of size 2^( 5) =       0.000559731429
  error estimate for blocks of size 2^( 6) =       0.000565046370
  error estimate for blocks of size 2^( 7) =       0.000564260855

      target function =                  N/A
              le_mean =     -22.668388265062
             les_mean =     514.374491767497
             stat err =       0.000560769205
             autocorr =       1.212581546521
              std dev =       0.720184345315
             le_variance =       0.518665491236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509247234
  error estimate for blocks of size 2^( 2) =       0.000527300914
  error estimate for blocks of size 2^( 3) =       0.000543319360
  error estimate for blocks of size 2^( 4) =       0.000554038168
  error estimate for blocks of size 2^( 5) =       0.000559731429
  error estimate for blocks of size 2^( 6) =       0.000565046370
  error estimate for blocks of size 2^( 7) =       0.000564260855

      target function =                  N/A
              le_mean =     -22.668388265062
             les_mean =     514.374491767497
             stat err =       0.000560769205
             autocorr =       1.212581546516
              std dev =       0.720184345315
             le_variance =       0.518665491236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509247234
  error estimate for blocks of size 2^( 2) =       0.000527300914
  error estimate for blocks of size 2^( 3) =       0.000543319360
  error estimate for blocks of size 2^( 4) =       0.000554038168
  error estimate for blocks of size 2^( 5) =       0.000559731429
  error estimate for blocks of size 2^( 6) =       0.000565046370
  error estimate for blocks of size 2^( 7) =       0.000564260855

      target function =                  N/A
              le_mean =     -22.668388265062
             les_mean =     514.374491767497
             stat err =       0.000560769205
             autocorr =       1.212581546517
              std dev =       0.720184345315
             le_variance =       0.518665491236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518677329147
                                         uncertainty =       0.007493491007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509247234
  error estimate for blocks of size 2^( 2) =       0.000527300914
  error estimate for blocks of size 2^( 3) =       0.000543319360
  error estimate for blocks of size 2^( 4) =       0.000554038168
  error estimate for blocks of size 2^( 5) =       0.000559731429
  error estimate for blocks of size 2^( 6) =       0.000565046370
  error estimate for blocks of size 2^( 7) =       0.000564260855

      target function =                  N/A
              le_mean =     -22.668388265062
             les_mean =     514.374491767497
             stat err =       0.000560769205
             autocorr =       1.212581546519
              std dev =       0.720184345315
             le_variance =       0.518665491236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668388265062        initial  <--
     1.5625e+10     1.5625e+11             1.7692e-14       -22.668388265062
     6.2500e+10     6.2500e+11             4.1310e-15       -22.668388265062
     2.5000e+11     2.5000e+12             9.7254e-16       -22.668388265062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.0006
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1863e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6521
    reference variance = 1.19481
====================================================
  Execution time = 4.3376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1749e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5046e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517470973432
                                         uncertainty =       0.004523526939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517470973432
                                         uncertainty =       0.004523526939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508672347
  error estimate for blocks of size 2^( 2) =       0.000526198902
  error estimate for blocks of size 2^( 3) =       0.000541725058
  error estimate for blocks of size 2^( 4) =       0.000552430561
  error estimate for blocks of size 2^( 5) =       0.000559776260
  error estimate for blocks of size 2^( 6) =       0.000562318259
  error estimate for blocks of size 2^( 7) =       0.000562731524

      target function =                  N/A
              le_mean =     -22.668382846359
             les_mean =     514.373075723187
             stat err =       0.000559314151
             autocorr =       1.209025213949
              std dev =       0.719371331685
             le_variance =       0.517495112851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266838284636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668382846359       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668382846359       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668382846359       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668397850469       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668382846359       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668375598565       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.667353242960       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667066520902       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.667962156798       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668390019354       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668146068589       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.668502657547       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.668379393908       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.671992353604       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.666791196490       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.667351744044       residual = 6.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.670595165186       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.672675710709       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.668509928911       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.670243611867       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.679341277404       residual = 6.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.670060602576       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.673950316517       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.668502685825       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.667894303889       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.672790101020       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.662603875288       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.663729727502       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.663908900491       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.660704083878       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.680112572759       residual = 8.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.654846896500       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.674256108103       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.655664808583       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.668642329429       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.661618553501       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.668873448988       residual = 4.12e-04           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.662219225371       residual = 1.71e-02           smallest_sin_value = 9.97e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+11 is 1.294973e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668382846359       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668382846359       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668382846359       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668382846359       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668229516748       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668521114795       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669275136908       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668375260152       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.662239276312       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.672568741894       residual = 9.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668664918065       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.665106264201       residual = 5.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.660824120893       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.652137118449       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.693275230715       residual = 3.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.674470127143       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.674366051545       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.637998659813       residual = 5.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.673623678132       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.650502580940       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.634168827107       residual = 6.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.651169484526       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.628072488077       residual = 8.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.684446800380       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.686981527419       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.622412118340       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.695652942455       residual = 3.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.716657361377       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.707070537774       residual = 7.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.644422392108       residual = 3.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.660859564463       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.645881925095       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.719498145736       residual = 1.39e+00           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -22.713913521401       residual = 1.11e+00           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -22.695416299906       residual = 4.09e-01           smallest_sin_value = 9.97e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 2.526065e-16

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668382846359       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668382846359       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8475e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.5433
    reference variance = 0.413491
====================================================
  Execution time = 4.1796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2265e-01
  Total weights = 2.0000e+06
  Execution time = 3.1674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511201762
  error estimate for blocks of size 2^( 2) =       0.000529058409
  error estimate for blocks of size 2^( 3) =       0.000544640644
  error estimate for blocks of size 2^( 4) =       0.000556750035
  error estimate for blocks of size 2^( 5) =       0.000563670203
  error estimate for blocks of size 2^( 6) =       0.000568580171
  error estimate for blocks of size 2^( 7) =       0.000570071583

      target function =                  N/A
              le_mean =     -22.668245153369
             les_mean =     514.371992554200
             stat err =       0.000564767998
             autocorr =       1.220549721637
              std dev =       0.722948464483
             le_variance =       0.522654482298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511201762
  error estimate for blocks of size 2^( 2) =       0.000529058409
  error estimate for blocks of size 2^( 3) =       0.000544640644
  error estimate for blocks of size 2^( 4) =       0.000556750035
  error estimate for blocks of size 2^( 5) =       0.000563670203
  error estimate for blocks of size 2^( 6) =       0.000568580171
  error estimate for blocks of size 2^( 7) =       0.000570071583

      target function =                  N/A
              le_mean =     -22.668245153369
             les_mean =     514.371992554200
             stat err =       0.000564767998
             autocorr =       1.220549721629
              std dev =       0.722948464483
             le_variance =       0.522654482298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511201762
  error estimate for blocks of size 2^( 2) =       0.000529058409
  error estimate for blocks of size 2^( 3) =       0.000544640644
  error estimate for blocks of size 2^( 4) =       0.000556750035
  error estimate for blocks of size 2^( 5) =       0.000563670203
  error estimate for blocks of size 2^( 6) =       0.000568580171
  error estimate for blocks of size 2^( 7) =       0.000570071583

      target function =                  N/A
              le_mean =     -22.668245153369
             les_mean =     514.371992554200
             stat err =       0.000564767998
             autocorr =       1.220549721630
              std dev =       0.722948464483
             le_variance =       0.522654482298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522675538976
                                         uncertainty =       0.006566865640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511201762
  error estimate for blocks of size 2^( 2) =       0.000529058409
  error estimate for blocks of size 2^( 3) =       0.000544640644
  error estimate for blocks of size 2^( 4) =       0.000556750035
  error estimate for blocks of size 2^( 5) =       0.000563670203
  error estimate for blocks of size 2^( 6) =       0.000568580171
  error estimate for blocks of size 2^( 7) =       0.000570071583

      target function =                  N/A
              le_mean =     -22.668245153369
             les_mean =     514.371992554200
             stat err =       0.000564767998
             autocorr =       1.220549721637
              std dev =       0.722948464483
             le_variance =       0.522654482298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668245153369        initial  <--
     1.5625e+11     1.5625e+12             1.2950e-15       -22.668245153369
     6.2500e+11     6.2500e+12             2.5261e-16       -22.668245153369
     2.5000e+12     2.5000e+13             0.0000e+00       -22.668245153369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.6998
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1618e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.5725
    reference variance = 0.376786
====================================================
  Execution time = 4.2196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2720e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4721e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527271489254
                                         uncertainty =       0.008347873989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527271489254
                                         uncertainty =       0.008347873989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513418578
  error estimate for blocks of size 2^( 2) =       0.000531091105
  error estimate for blocks of size 2^( 3) =       0.000547202415
  error estimate for blocks of size 2^( 4) =       0.000558558750
  error estimate for blocks of size 2^( 5) =       0.000565409444
  error estimate for blocks of size 2^( 6) =       0.000569098331
  error estimate for blocks of size 2^( 7) =       0.000568135756

      target function =                  N/A
              le_mean =     -22.668258366743
             les_mean =     514.377134390600
             stat err =       0.000565300570
             autocorr =       1.212315584470
              std dev =       0.726083516410
             le_variance =       0.527197272802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266825836674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668258366743       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668258366743       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668258366743       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668258366743       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668258366743       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668258366743       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669389499476       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.654775454934       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.639411644960       residual = 4.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.704467198671       residual = 6.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.692796407205       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.704716613871       residual = 7.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.683102033701       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.678254863212       residual = 5.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.651602605900       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.872665570856       residual = 2.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.843213400820       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.747207861256       residual = 3.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.205504580164       residual = 1.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.547828279078       residual = 7.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.642929204107       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.526497158941       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.446598895930       residual = 2.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.747824487933       residual = 3.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.797341736987       residual = 9.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.743767165758       residual = 3.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.761871760190       residual = 4.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.920309879763       residual = 3.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.678184897290       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.763850415762       residual = 4.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.502038876085       residual = 1.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -23.156333899552       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -23.078383946039       residual = 8.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.842603249187       residual = 1.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.721907793859       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.200696704165       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.430519211958       residual = 3.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -23.060500863435       residual = 8.53e+01           smallest_sin_value = 9.99e-01
davidson iteration   36:   krylov dim =  37   energy =     -22.703563665018       residual = 1.44e+00           smallest_sin_value = 9.94e-01
davidson iteration   37 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+12 is 1.212937e-17

solving harmonic davidson linear method for identity shift 2.5000e+13, overlap shift 2.5000e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668258366743       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668258366743       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6949e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7425
    reference variance = 0.644159
====================================================
  Execution time = 4.1583e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0819e-01
  Total weights = 2.0000e+06
  Execution time = 3.1653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504076996
  error estimate for blocks of size 2^( 2) =       0.000522101772
  error estimate for blocks of size 2^( 3) =       0.000538382995
  error estimate for blocks of size 2^( 4) =       0.000548905400
  error estimate for blocks of size 2^( 5) =       0.000555493295
  error estimate for blocks of size 2^( 6) =       0.000559047770
  error estimate for blocks of size 2^( 7) =       0.000557752006

      target function =                  N/A
              le_mean =     -22.668263545614
             les_mean =     514.358359154176
             stat err =       0.000555299618
             autocorr =       1.213559272715
              std dev =       0.712872523576
             le_variance =       0.508187234870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504076996
  error estimate for blocks of size 2^( 2) =       0.000522101772
  error estimate for blocks of size 2^( 3) =       0.000538382995
  error estimate for blocks of size 2^( 4) =       0.000548905400
  error estimate for blocks of size 2^( 5) =       0.000555493295
  error estimate for blocks of size 2^( 6) =       0.000559047770
  error estimate for blocks of size 2^( 7) =       0.000557752006

      target function =                  N/A
              le_mean =     -22.668263545614
             les_mean =     514.358359154176
             stat err =       0.000555299618
             autocorr =       1.213559272715
              std dev =       0.712872523576
             le_variance =       0.508187234870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504076996
  error estimate for blocks of size 2^( 2) =       0.000522101772
  error estimate for blocks of size 2^( 3) =       0.000538382995
  error estimate for blocks of size 2^( 4) =       0.000548905400
  error estimate for blocks of size 2^( 5) =       0.000555493295
  error estimate for blocks of size 2^( 6) =       0.000559047770
  error estimate for blocks of size 2^( 7) =       0.000557752006

      target function =                  N/A
              le_mean =     -22.668263545614
             les_mean =     514.358359154176
             stat err =       0.000555299618
             autocorr =       1.213559272715
              std dev =       0.712872523576
             le_variance =       0.508187234870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508228544796
                                         uncertainty =       0.002950737087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504076996
  error estimate for blocks of size 2^( 2) =       0.000522101772
  error estimate for blocks of size 2^( 3) =       0.000538382995
  error estimate for blocks of size 2^( 4) =       0.000548905400
  error estimate for blocks of size 2^( 5) =       0.000555493295
  error estimate for blocks of size 2^( 6) =       0.000559047770
  error estimate for blocks of size 2^( 7) =       0.000557752006

      target function =                  N/A
              le_mean =     -22.668263545614
             les_mean =     514.358359154176
             stat err =       0.000555299618
             autocorr =       1.213559272715
              std dev =       0.712872523576
             le_variance =       0.508187234870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668263545614        initial  <--
     1.5625e+12     1.5625e+13             0.0000e+00       -22.668263545614
     6.2500e+12     6.2500e+13             1.2129e-17       -22.668263545614
     2.5000e+13     2.5000e+14             0.0000e+00       -22.668263545614

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.4714
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1443e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6708
    reference variance = 0.341052
====================================================
  Execution time = 4.4109e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1171e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4852e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511785260132
                                         uncertainty =       0.004530894886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511785260132
                                         uncertainty =       0.004530894886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505820915
  error estimate for blocks of size 2^( 2) =       0.000523898471
  error estimate for blocks of size 2^( 3) =       0.000539874104
  error estimate for blocks of size 2^( 4) =       0.000551984080
  error estimate for blocks of size 2^( 5) =       0.000559555111
  error estimate for blocks of size 2^( 6) =       0.000562547903
  error estimate for blocks of size 2^( 7) =       0.000563156741

      target function =                  N/A
              le_mean =     -22.668478793224
             les_mean =     514.371640139108
             stat err =       0.000559310959
             autocorr =       1.222680797751
              std dev =       0.715338798125
             le_variance =       0.511709596103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266847879322e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668478793224       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668478793224       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668478793224       residual = 7.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667389833025       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670858684435       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.710762021882       residual = 9.53e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.664701722101       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.672908953843       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.720388143259       residual = 1.42e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.676247047802       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.549088470192       residual = 7.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.633925847330       residual = 6.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.624197120885       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.681948655879       residual = 7.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.490328097160       residual = 1.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.525151550155       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.937410599807       residual = 3.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.533097935880       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.124049955204       residual = 1.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -21.762727638085       residual = 4.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -21.915658960042       residual = 3.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.503423301954       residual = 1.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.471865960245       residual = 2.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.271370576690       residual = 8.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.154117271180       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.369785100823       residual = 7.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.880180483272       residual = 5.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -23.274767826036       residual = 2.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -23.340076260059       residual = 2.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.526652539145       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.351442763114       residual = 4.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.271808790402       residual = 8.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.672263290114       residual = 3.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.608874594674       residual = 4.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.692932066565       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -24.298748662688       residual = 1.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -23.837509965523       residual = 7.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -23.181941868952       residual = 1.45e+02           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   energy =     -25.376006509452       residual = 3.69e+03           smallest_sin_value = 9.97e-01
davidson iteration   39:   krylov dim =  40   energy =     -23.662631731316       residual = 6.11e+02           smallest_sin_value = 9.96e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+13 is 3.637205e-18

solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668478793224       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668478793224       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668478793224       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668478793224       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8998e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.5181
    reference variance = 0.954009
====================================================
  Execution time = 4.2616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0927e-01
  Total weights = 2.0000e+06
  Execution time = 3.1679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504616244
  error estimate for blocks of size 2^( 2) =       0.000522838651
  error estimate for blocks of size 2^( 3) =       0.000538554020
  error estimate for blocks of size 2^( 4) =       0.000549768442
  error estimate for blocks of size 2^( 5) =       0.000557274266
  error estimate for blocks of size 2^( 6) =       0.000562257185
  error estimate for blocks of size 2^( 7) =       0.000563628362

      target function =                  N/A
              le_mean =     -22.668711213257
             les_mean =     514.379742923495
             stat err =       0.000558232064
             autocorr =       1.223790568296
              std dev =       0.713635136518
             le_variance =       0.509275108072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504616244
  error estimate for blocks of size 2^( 2) =       0.000522838651
  error estimate for blocks of size 2^( 3) =       0.000538554020
  error estimate for blocks of size 2^( 4) =       0.000549768442
  error estimate for blocks of size 2^( 5) =       0.000557274266
  error estimate for blocks of size 2^( 6) =       0.000562257185
  error estimate for blocks of size 2^( 7) =       0.000563628362

      target function =                  N/A
              le_mean =     -22.668711213257
             les_mean =     514.379742923495
             stat err =       0.000558232064
             autocorr =       1.223790568303
              std dev =       0.713635136518
             le_variance =       0.509275108072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504616244
  error estimate for blocks of size 2^( 2) =       0.000522838651
  error estimate for blocks of size 2^( 3) =       0.000538554020
  error estimate for blocks of size 2^( 4) =       0.000549768442
  error estimate for blocks of size 2^( 5) =       0.000557274266
  error estimate for blocks of size 2^( 6) =       0.000562257185
  error estimate for blocks of size 2^( 7) =       0.000563628362

      target function =                  N/A
              le_mean =     -22.668711213257
             les_mean =     514.379742923495
             stat err =       0.000558232064
             autocorr =       1.223790568296
              std dev =       0.713635136518
             le_variance =       0.509275108072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509253696634
                                         uncertainty =       0.004146215789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504616244
  error estimate for blocks of size 2^( 2) =       0.000522838651
  error estimate for blocks of size 2^( 3) =       0.000538554020
  error estimate for blocks of size 2^( 4) =       0.000549768442
  error estimate for blocks of size 2^( 5) =       0.000557274266
  error estimate for blocks of size 2^( 6) =       0.000562257185
  error estimate for blocks of size 2^( 7) =       0.000563628362

      target function =                  N/A
              le_mean =     -22.668711213257
             les_mean =     514.379742923495
             stat err =       0.000558232064
             autocorr =       1.223790568296
              std dev =       0.713635136518
             le_variance =       0.509275108072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668711213257        initial  <--
     1.5625e+13     1.5625e+14             3.6372e-18       -22.668711213257
     6.2500e+13     6.2500e+14             0.0000e+00       -22.668711213257
     2.5000e+14     2.5000e+15             0.0000e+00       -22.668711213257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.4915
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1750e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6774
    reference variance = 0.591722
====================================================
  Execution time = 4.2305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2181e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4776e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521803714358
                                         uncertainty =       0.010139077147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521803714358
                                         uncertainty =       0.010139077147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510791112
  error estimate for blocks of size 2^( 2) =       0.000528702082
  error estimate for blocks of size 2^( 3) =       0.000544374722
  error estimate for blocks of size 2^( 4) =       0.000555723881
  error estimate for blocks of size 2^( 5) =       0.000562316102
  error estimate for blocks of size 2^( 6) =       0.000565004273
  error estimate for blocks of size 2^( 7) =       0.000566672794

      target function =                  N/A
              le_mean =     -22.668445575025
             les_mean =     514.380239647137
             stat err =       0.000562429263
             autocorr =       1.212409005177
              std dev =       0.722367718108
             le_variance =       0.521815120165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266844557503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668445575025       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668445575025       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668445575025       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668445575025       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+15, overlap shift 2.5000e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668445575025       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668445575025       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668445575025       residual = 6.75e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -26.550395000214       residual = 8.75e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.510956741407       residual = 1.40e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.191719384771       residual = 2.16e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -20.379616897688       residual = 3.22e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -23.925706174317       residual = 1.38e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -21.834345411156       residual = 8.31e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -26.512489727476       residual = 9.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+15 is 3.067856e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7093e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6653
    reference variance = 0.416533
====================================================
  Execution time = 4.1699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0634e-01
  Total weights = 2.0000e+06
  Execution time = 3.1658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503158312
  error estimate for blocks of size 2^( 2) =       0.000520890602
  error estimate for blocks of size 2^( 3) =       0.000536502349
  error estimate for blocks of size 2^( 4) =       0.000546841773
  error estimate for blocks of size 2^( 5) =       0.000551927576
  error estimate for blocks of size 2^( 6) =       0.000554028096
  error estimate for blocks of size 2^( 7) =       0.000556061873

      target function =                  N/A
              le_mean =     -22.667912277007
             les_mean =     514.340583317817
             stat err =       0.000552214830
             autocorr =       1.204500067212
              std dev =       0.711573308163
             le_variance =       0.506336572889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503158312
  error estimate for blocks of size 2^( 2) =       0.000520890602
  error estimate for blocks of size 2^( 3) =       0.000536502349
  error estimate for blocks of size 2^( 4) =       0.000546841773
  error estimate for blocks of size 2^( 5) =       0.000551927576
  error estimate for blocks of size 2^( 6) =       0.000554028096
  error estimate for blocks of size 2^( 7) =       0.000556061873

      target function =                  N/A
              le_mean =     -22.667912277007
             les_mean =     514.340583317817
             stat err =       0.000552214830
             autocorr =       1.204500067212
              std dev =       0.711573308163
             le_variance =       0.506336572889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503158312
  error estimate for blocks of size 2^( 2) =       0.000520890602
  error estimate for blocks of size 2^( 3) =       0.000536502349
  error estimate for blocks of size 2^( 4) =       0.000546841773
  error estimate for blocks of size 2^( 5) =       0.000551927576
  error estimate for blocks of size 2^( 6) =       0.000554028096
  error estimate for blocks of size 2^( 7) =       0.000556061873

      target function =                  N/A
              le_mean =     -22.667912277007
             les_mean =     514.340583317817
             stat err =       0.000552214830
             autocorr =       1.204500067212
              std dev =       0.711573308163
             le_variance =       0.506336572889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506384374201
                                         uncertainty =       0.003421308268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503158312
  error estimate for blocks of size 2^( 2) =       0.000520890602
  error estimate for blocks of size 2^( 3) =       0.000536502349
  error estimate for blocks of size 2^( 4) =       0.000546841773
  error estimate for blocks of size 2^( 5) =       0.000551927576
  error estimate for blocks of size 2^( 6) =       0.000554028096
  error estimate for blocks of size 2^( 7) =       0.000556061873

      target function =                  N/A
              le_mean =     -22.667912277007
             les_mean =     514.340583317817
             stat err =       0.000552214830
             autocorr =       1.204500067212
              std dev =       0.711573308163
             le_variance =       0.506336572889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667912277007        initial  <--
     1.5625e+14     1.5625e+15             0.0000e+00       -22.667912277007
     6.2500e+14     6.2500e+15             0.0000e+00       -22.667912277007
     2.5000e+15     2.5000e+16             3.0679e-20       -22.667912277007

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5900
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1469e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7473
    reference variance = 1.45609
====================================================
  Execution time = 4.2490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2398e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4679e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523963703811
                                         uncertainty =       0.009534829135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523963703811
                                         uncertainty =       0.009534829135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511852004
  error estimate for blocks of size 2^( 2) =       0.000529911130
  error estimate for blocks of size 2^( 3) =       0.000545537315
  error estimate for blocks of size 2^( 4) =       0.000557532653
  error estimate for blocks of size 2^( 5) =       0.000563841251
  error estimate for blocks of size 2^( 6) =       0.000567163199
  error estimate for blocks of size 2^( 7) =       0.000569667734

      target function =                  N/A
              le_mean =     -22.667588824060
             les_mean =     514.343567782390
             stat err =       0.000564551209
             autocorr =       1.216516121205
              std dev =       0.723868045809
             le_variance =       0.523984947743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266758882406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+15, overlap shift 1.5625e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667588824060       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667588824060       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667588824060       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.347785026134       residual = 5.51e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -23.097774255272       residual = 1.06e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -18.126124227303       residual = 1.05e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.033336108468       residual = 2.21e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -24.982745804584       residual = 3.69e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -19.087706980957       residual = 6.82e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -18.398543271224       residual = 9.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -21.925757034429       residual = 4.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667588824060       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667588824060       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667588824060       residual = 7.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667588824060       residual = 9.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -19.722277538350       residual = 6.68e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+16, overlap shift 2.5000e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667588824060       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667588824060       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667588824060       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667588824060       residual = 9.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+16 is 5.474901e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289004 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7181e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5136
    reference variance = 0.797905
====================================================
  Execution time = 4.3632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1033e-01
  Total weights = 2.0000e+06
  Execution time = 3.2888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505138446
  error estimate for blocks of size 2^( 2) =       0.000523230327
  error estimate for blocks of size 2^( 3) =       0.000539292745
  error estimate for blocks of size 2^( 4) =       0.000550910645
  error estimate for blocks of size 2^( 5) =       0.000557356884
  error estimate for blocks of size 2^( 6) =       0.000561621675
  error estimate for blocks of size 2^( 7) =       0.000563131840

      target function =                  N/A
              le_mean =     -22.667944915038
             les_mean =     514.346056115203
             stat err =       0.000558255261
             autocorr =       1.221363118724
              std dev =       0.714373641158
             le_variance =       0.510329699182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505138446
  error estimate for blocks of size 2^( 2) =       0.000523230327
  error estimate for blocks of size 2^( 3) =       0.000539292745
  error estimate for blocks of size 2^( 4) =       0.000550910645
  error estimate for blocks of size 2^( 5) =       0.000557356884
  error estimate for blocks of size 2^( 6) =       0.000561621675
  error estimate for blocks of size 2^( 7) =       0.000563131840

      target function =                  N/A
              le_mean =     -22.667944915038
             les_mean =     514.346056115203
             stat err =       0.000558255261
             autocorr =       1.221363118724
              std dev =       0.714373641158
             le_variance =       0.510329699182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505138446
  error estimate for blocks of size 2^( 2) =       0.000523230327
  error estimate for blocks of size 2^( 3) =       0.000539292745
  error estimate for blocks of size 2^( 4) =       0.000550910645
  error estimate for blocks of size 2^( 5) =       0.000557356884
  error estimate for blocks of size 2^( 6) =       0.000561621675
  error estimate for blocks of size 2^( 7) =       0.000563131840

      target function =                  N/A
              le_mean =     -22.667944915038
             les_mean =     514.346056115203
             stat err =       0.000558255261
             autocorr =       1.221363118724
              std dev =       0.714373641158
             le_variance =       0.510329699182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510289919960
                                         uncertainty =       0.003053787414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505138446
  error estimate for blocks of size 2^( 2) =       0.000523230327
  error estimate for blocks of size 2^( 3) =       0.000539292745
  error estimate for blocks of size 2^( 4) =       0.000550910645
  error estimate for blocks of size 2^( 5) =       0.000557356884
  error estimate for blocks of size 2^( 6) =       0.000561621675
  error estimate for blocks of size 2^( 7) =       0.000563131840

      target function =                  N/A
              le_mean =     -22.667944915038
             les_mean =     514.346056115203
             stat err =       0.000558255261
             autocorr =       1.221363118724
              std dev =       0.714373641158
             le_variance =       0.510329699182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667944915038        initial  <--
     1.5625e+15     1.5625e+16             0.0000e+00       -22.667944915038
     6.2500e+15     6.2500e+16             0.0000e+00       -22.667944915038
     2.5000e+16     2.5000e+17             5.4749e-21       -22.667944915038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.6267
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1685e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6704
    reference variance = 0.563262
====================================================
  Execution time = 4.2186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1190e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4674e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511873364337
                                         uncertainty =       0.003905051222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511873364337
                                         uncertainty =       0.003905051222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505914776
  error estimate for blocks of size 2^( 2) =       0.000523830178
  error estimate for blocks of size 2^( 3) =       0.000539595240
  error estimate for blocks of size 2^( 4) =       0.000551855160
  error estimate for blocks of size 2^( 5) =       0.000557488254
  error estimate for blocks of size 2^( 6) =       0.000561783175
  error estimate for blocks of size 2^( 7) =       0.000563449169

      target function =                  N/A
              le_mean =     -22.668414861741
             les_mean =     514.368931610209
             stat err =       0.000558643939
             autocorr =       1.219313703222
              std dev =       0.715471538314
             le_variance =       0.511899522138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266841486174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+16, overlap shift 1.5625e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668414861741       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668414861741       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668414861741       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668414861741       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+17, overlap shift 2.5000e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668414861741       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668414861741       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6870e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6393
    reference variance = 0.357346
====================================================
  Execution time = 4.1803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1225e-01
  Total weights = 2.0000e+06
  Execution time = 3.1660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506086660
  error estimate for blocks of size 2^( 2) =       0.000523986783
  error estimate for blocks of size 2^( 3) =       0.000539391038
  error estimate for blocks of size 2^( 4) =       0.000551689837
  error estimate for blocks of size 2^( 5) =       0.000558934233
  error estimate for blocks of size 2^( 6) =       0.000562941741
  error estimate for blocks of size 2^( 7) =       0.000562687576

      target function =                  N/A
              le_mean =     -22.668396579028
             les_mean =     514.368450622835
             stat err =       0.000559063347
             autocorr =       1.220315872293
              std dev =       0.715714618328
             le_variance =       0.512247414889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506086660
  error estimate for blocks of size 2^( 2) =       0.000523986783
  error estimate for blocks of size 2^( 3) =       0.000539391038
  error estimate for blocks of size 2^( 4) =       0.000551689837
  error estimate for blocks of size 2^( 5) =       0.000558934233
  error estimate for blocks of size 2^( 6) =       0.000562941741
  error estimate for blocks of size 2^( 7) =       0.000562687576

      target function =                  N/A
              le_mean =     -22.668396579028
             les_mean =     514.368450622835
             stat err =       0.000559063347
             autocorr =       1.220315872293
              std dev =       0.715714618328
             le_variance =       0.512247414889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506086660
  error estimate for blocks of size 2^( 2) =       0.000523986783
  error estimate for blocks of size 2^( 3) =       0.000539391038
  error estimate for blocks of size 2^( 4) =       0.000551689837
  error estimate for blocks of size 2^( 5) =       0.000558934233
  error estimate for blocks of size 2^( 6) =       0.000562941741
  error estimate for blocks of size 2^( 7) =       0.000562687576

      target function =                  N/A
              le_mean =     -22.668396579028
             les_mean =     514.368450622835
             stat err =       0.000559063347
             autocorr =       1.220315872293
              std dev =       0.715714618328
             le_variance =       0.512247414889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512268174107
                                         uncertainty =       0.003615706726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506086660
  error estimate for blocks of size 2^( 2) =       0.000523986783
  error estimate for blocks of size 2^( 3) =       0.000539391038
  error estimate for blocks of size 2^( 4) =       0.000551689837
  error estimate for blocks of size 2^( 5) =       0.000558934233
  error estimate for blocks of size 2^( 6) =       0.000562941741
  error estimate for blocks of size 2^( 7) =       0.000562687576

      target function =                  N/A
              le_mean =     -22.668396579028
             les_mean =     514.368450622835
             stat err =       0.000559063347
             autocorr =       1.220315872293
              std dev =       0.715714618328
             le_variance =       0.512247414889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668396579028        initial  <--
     1.5625e+16     1.5625e+17             0.0000e+00       -22.668396579028
     6.2500e+16     6.2500e+17             0.0000e+00       -22.668396579028
     2.5000e+17     2.5000e+18             0.0000e+00       -22.668396579028

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.6760
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1455e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7438
    reference variance = 0.442531
====================================================
  Execution time = 4.2533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1638e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4827e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515971038566
                                         uncertainty =       0.004676948027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515971038566
                                         uncertainty =       0.004676948027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508125477
  error estimate for blocks of size 2^( 2) =       0.000526028931
  error estimate for blocks of size 2^( 3) =       0.000542525614
  error estimate for blocks of size 2^( 4) =       0.000553578378
  error estimate for blocks of size 2^( 5) =       0.000560377021
  error estimate for blocks of size 2^( 6) =       0.000563215184
  error estimate for blocks of size 2^( 7) =       0.000564053781

      target function =                  N/A
              le_mean =     -22.668619226542
             les_mean =     514.382680380987
             stat err =       0.000560306091
             autocorr =       1.215930481825
              std dev =       0.718597941292
             le_variance =       0.516383001229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266861922654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+17, overlap shift 1.5625e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668619226542       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668619226542       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668619226542       residual = 2.00e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+17 is 4.737141e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668619226542       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668619226542       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668619226542       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+17 is 1.184285e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+18, overlap shift 2.5000e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668619226542       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668619226542       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668619226542       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+18 is 2.960713e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7371e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6948
    reference variance = 0.493503
====================================================
  Execution time = 4.1816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1280e-01
  Total weights = 2.0000e+06
  Execution time = 3.1674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506360329
  error estimate for blocks of size 2^( 2) =       0.000524229485
  error estimate for blocks of size 2^( 3) =       0.000540011003
  error estimate for blocks of size 2^( 4) =       0.000550999726
  error estimate for blocks of size 2^( 5) =       0.000556886418
  error estimate for blocks of size 2^( 6) =       0.000561039889
  error estimate for blocks of size 2^( 7) =       0.000563861084

      target function =                  N/A
              le_mean =     -22.669011062644
             les_mean =     514.396863868248
             stat err =       0.000558196779
             autocorr =       1.215221110451
              std dev =       0.716101645280
             le_variance =       0.512801566373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506360329
  error estimate for blocks of size 2^( 2) =       0.000524229485
  error estimate for blocks of size 2^( 3) =       0.000540011003
  error estimate for blocks of size 2^( 4) =       0.000550999726
  error estimate for blocks of size 2^( 5) =       0.000556886418
  error estimate for blocks of size 2^( 6) =       0.000561039889
  error estimate for blocks of size 2^( 7) =       0.000563861084

      target function =                  N/A
              le_mean =     -22.669011062644
             les_mean =     514.396863868248
             stat err =       0.000558196779
             autocorr =       1.215221110451
              std dev =       0.716101645280
             le_variance =       0.512801566373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506360329
  error estimate for blocks of size 2^( 2) =       0.000524229485
  error estimate for blocks of size 2^( 3) =       0.000540011003
  error estimate for blocks of size 2^( 4) =       0.000550999726
  error estimate for blocks of size 2^( 5) =       0.000556886418
  error estimate for blocks of size 2^( 6) =       0.000561039889
  error estimate for blocks of size 2^( 7) =       0.000563861084

      target function =                  N/A
              le_mean =     -22.669011062644
             les_mean =     514.396863868248
             stat err =       0.000558196779
             autocorr =       1.215221110451
              std dev =       0.716101645280
             le_variance =       0.512801566373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512686429770
                                         uncertainty =       0.003653289255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506360329
  error estimate for blocks of size 2^( 2) =       0.000524229485
  error estimate for blocks of size 2^( 3) =       0.000540011003
  error estimate for blocks of size 2^( 4) =       0.000550999726
  error estimate for blocks of size 2^( 5) =       0.000556886418
  error estimate for blocks of size 2^( 6) =       0.000561039889
  error estimate for blocks of size 2^( 7) =       0.000563861084

      target function =                  N/A
              le_mean =     -22.669011062644
             les_mean =     514.396863868248
             stat err =       0.000558196779
             autocorr =       1.215221110451
              std dev =       0.716101645280
             le_variance =       0.512801566373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669011062644        initial  <--
     1.5625e+17     1.5625e+18             4.7371e-22       -22.669011062644
     6.2500e+17     6.2500e+18             1.1843e-22       -22.669011062644
     2.5000e+18     2.5000e+19             2.9607e-23       -22.669011062644

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.7263
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1510e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6599
    reference variance = 0.58955
====================================================
  Execution time = 4.2679e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1308e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4940e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513023270021
                                         uncertainty =       0.004679858595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513023270021
                                         uncertainty =       0.004679858595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506499398
  error estimate for blocks of size 2^( 2) =       0.000524158760
  error estimate for blocks of size 2^( 3) =       0.000540622189
  error estimate for blocks of size 2^( 4) =       0.000551598606
  error estimate for blocks of size 2^( 5) =       0.000559104189
  error estimate for blocks of size 2^( 6) =       0.000562466703
  error estimate for blocks of size 2^( 7) =       0.000565204945

      target function =                  N/A
              le_mean =     -22.668910287392
             les_mean =     514.392576641160
             stat err =       0.000559593611
             autocorr =       1.220640085073
              std dev =       0.716298317652
             le_variance =       0.513083279872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266891028739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+18, overlap shift 1.5625e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668910287392       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668910287392       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668910287392       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668910287392       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+19, overlap shift 2.5000e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668910287392       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668910287392       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7630e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6705
    reference variance = 0.347095
====================================================
  Execution time = 4.1833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1695e-01
  Total weights = 2.0000e+06
  Execution time = 3.1600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508406764
  error estimate for blocks of size 2^( 2) =       0.000526701583
  error estimate for blocks of size 2^( 3) =       0.000543195773
  error estimate for blocks of size 2^( 4) =       0.000553717285
  error estimate for blocks of size 2^( 5) =       0.000559820443
  error estimate for blocks of size 2^( 6) =       0.000562630403
  error estimate for blocks of size 2^( 7) =       0.000563221673

      target function =                  N/A
              le_mean =     -22.666884199943
             les_mean =     514.304593951393
             stat err =       0.000559847451
             autocorr =       1.212597783010
              std dev =       0.718995741474
             le_variance =       0.516954876258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508406764
  error estimate for blocks of size 2^( 2) =       0.000526701583
  error estimate for blocks of size 2^( 3) =       0.000543195773
  error estimate for blocks of size 2^( 4) =       0.000553717285
  error estimate for blocks of size 2^( 5) =       0.000559820443
  error estimate for blocks of size 2^( 6) =       0.000562630403
  error estimate for blocks of size 2^( 7) =       0.000563221673

      target function =                  N/A
              le_mean =     -22.666884199943
             les_mean =     514.304593951393
             stat err =       0.000559847451
             autocorr =       1.212597783010
              std dev =       0.718995741474
             le_variance =       0.516954876258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508406764
  error estimate for blocks of size 2^( 2) =       0.000526701583
  error estimate for blocks of size 2^( 3) =       0.000543195773
  error estimate for blocks of size 2^( 4) =       0.000553717285
  error estimate for blocks of size 2^( 5) =       0.000559820443
  error estimate for blocks of size 2^( 6) =       0.000562630403
  error estimate for blocks of size 2^( 7) =       0.000563221673

      target function =                  N/A
              le_mean =     -22.666884199943
             les_mean =     514.304593951393
             stat err =       0.000559847451
             autocorr =       1.212597783010
              std dev =       0.718995741474
             le_variance =       0.516954876258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516897044597
                                         uncertainty =       0.008014867210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508406764
  error estimate for blocks of size 2^( 2) =       0.000526701583
  error estimate for blocks of size 2^( 3) =       0.000543195773
  error estimate for blocks of size 2^( 4) =       0.000553717285
  error estimate for blocks of size 2^( 5) =       0.000559820443
  error estimate for blocks of size 2^( 6) =       0.000562630403
  error estimate for blocks of size 2^( 7) =       0.000563221673

      target function =                  N/A
              le_mean =     -22.666884199943
             les_mean =     514.304593951393
             stat err =       0.000559847451
             autocorr =       1.212597783010
              std dev =       0.718995741474
             le_variance =       0.516954876258


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.666884199943        initial  <--
     1.5625e+18     1.5625e+19             0.0000e+00       -22.666884199943
     6.2500e+18     6.2500e+19             0.0000e+00       -22.666884199943
     2.5000e+19     2.5000e+20             0.0000e+00       -22.666884199943

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.7387
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1538e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7074
    reference variance = 0.426355
====================================================
  Execution time = 4.3072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1336e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4903e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513391480771
                                         uncertainty =       0.004347013735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513391480771
                                         uncertainty =       0.004347013735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506637849
  error estimate for blocks of size 2^( 2) =       0.000524269291
  error estimate for blocks of size 2^( 3) =       0.000540205414
  error estimate for blocks of size 2^( 4) =       0.000551879735
  error estimate for blocks of size 2^( 5) =       0.000559263004
  error estimate for blocks of size 2^( 6) =       0.000561912551
  error estimate for blocks of size 2^( 7) =       0.000564712049

      target function =                  N/A
              le_mean =     -22.667158367420
             les_mean =     514.313432016765
             stat err =       0.000559441835
             autocorr =       1.219311351460
              std dev =       0.716494117022
             le_variance =       0.513363819727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266715836742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+19, overlap shift 1.5625e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667158367420       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667158367420       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667158367421       residual = 1.31e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667158367420       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+19 is 6.620628e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667158367420       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667158367420       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667158367444       residual = 5.25e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667158367420       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+19 is 1.200373e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+20, overlap shift 2.5000e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667158367420       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667158367420       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667158367509       residual = 2.10e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667158367462       residual = 8.97e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+20 is 3.000931e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7986e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7629
    reference variance = 0.350242
====================================================
  Execution time = 4.2229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.3167e-01
  Total weights = 2.0000e+06
  Execution time = 3.1605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515593858
  error estimate for blocks of size 2^( 2) =       0.000533106079
  error estimate for blocks of size 2^( 3) =       0.000548872163
  error estimate for blocks of size 2^( 4) =       0.000558718135
  error estimate for blocks of size 2^( 5) =       0.000565943200
  error estimate for blocks of size 2^( 6) =       0.000568406550
  error estimate for blocks of size 2^( 7) =       0.000574416773

      target function =                  N/A
              le_mean =     -22.667895067183
             les_mean =     514.365140563606
             stat err =       0.000566871164
             autocorr =       1.208796688674
              std dev =       0.729159826538
             le_variance =       0.531674052638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515593858
  error estimate for blocks of size 2^( 2) =       0.000533106079
  error estimate for blocks of size 2^( 3) =       0.000548872163
  error estimate for blocks of size 2^( 4) =       0.000558718135
  error estimate for blocks of size 2^( 5) =       0.000565943200
  error estimate for blocks of size 2^( 6) =       0.000568406550
  error estimate for blocks of size 2^( 7) =       0.000574416773

      target function =                  N/A
              le_mean =     -22.667895067183
             les_mean =     514.365140563606
             stat err =       0.000566871164
             autocorr =       1.208796688674
              std dev =       0.729159826538
             le_variance =       0.531674052638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515593858
  error estimate for blocks of size 2^( 2) =       0.000533106079
  error estimate for blocks of size 2^( 3) =       0.000548872163
  error estimate for blocks of size 2^( 4) =       0.000558718135
  error estimate for blocks of size 2^( 5) =       0.000565943200
  error estimate for blocks of size 2^( 6) =       0.000568406550
  error estimate for blocks of size 2^( 7) =       0.000574416773

      target function =                  N/A
              le_mean =     -22.667895067183
             les_mean =     514.365140563606
             stat err =       0.000566871164
             autocorr =       1.208796688674
              std dev =       0.729159826538
             le_variance =       0.531674052638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531857399492
                                         uncertainty =       0.009416213987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515593858
  error estimate for blocks of size 2^( 2) =       0.000533106079
  error estimate for blocks of size 2^( 3) =       0.000548872163
  error estimate for blocks of size 2^( 4) =       0.000558718135
  error estimate for blocks of size 2^( 5) =       0.000565943200
  error estimate for blocks of size 2^( 6) =       0.000568406550
  error estimate for blocks of size 2^( 7) =       0.000574416773

      target function =                  N/A
              le_mean =     -22.667895067183
             les_mean =     514.365140563606
             stat err =       0.000566871164
             autocorr =       1.208796688674
              std dev =       0.729159826538
             le_variance =       0.531674052638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667895067183        initial  <--
     1.5625e+19     1.5625e+20             6.6206e-24       -22.667895067183
     6.2500e+19     6.2500e+20             1.2004e-24       -22.667895067183
     2.5000e+20     2.5000e+21             3.0009e-25       -22.667895067183

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.0719
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1606e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7035
    reference variance = 0.344583
====================================================
  Execution time = 4.2569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1609e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4626e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516116568978
                                         uncertainty =       0.004393599544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516116568978
                                         uncertainty =       0.004393599544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507981123
  error estimate for blocks of size 2^( 2) =       0.000525574646
  error estimate for blocks of size 2^( 3) =       0.000541294195
  error estimate for blocks of size 2^( 4) =       0.000552475193
  error estimate for blocks of size 2^( 5) =       0.000558256668
  error estimate for blocks of size 2^( 6) =       0.000562093535
  error estimate for blocks of size 2^( 7) =       0.000564676757

      target function =                  N/A
              le_mean =     -22.669228459777
             les_mean =     514.410008347177
             stat err =       0.000559375538
             autocorr =       1.212583886863
              std dev =       0.718393794267
             le_variance =       0.516089643642


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266922845978e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+20, overlap shift 1.5625e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669228459777       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669228459777       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669228459777       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669228459777       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+21, overlap shift 2.5000e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669228459777       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669228459777       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7212e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6545
    reference variance = 0.397919
====================================================
  Execution time = 4.2391e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2041e-01
  Total weights = 2.0000e+06
  Execution time = 3.1688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510102454
  error estimate for blocks of size 2^( 2) =       0.000527872470
  error estimate for blocks of size 2^( 3) =       0.000544019651
  error estimate for blocks of size 2^( 4) =       0.000555271177
  error estimate for blocks of size 2^( 5) =       0.000562339701
  error estimate for blocks of size 2^( 6) =       0.000566646007
  error estimate for blocks of size 2^( 7) =       0.000566727672

      target function =                  N/A
              le_mean =     -22.669961139061
             les_mean =     514.447546812472
             stat err =       0.000562746139
             autocorr =       1.217055051939
              std dev =       0.721393807948
             le_variance =       0.520409026146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510102454
  error estimate for blocks of size 2^( 2) =       0.000527872470
  error estimate for blocks of size 2^( 3) =       0.000544019651
  error estimate for blocks of size 2^( 4) =       0.000555271177
  error estimate for blocks of size 2^( 5) =       0.000562339701
  error estimate for blocks of size 2^( 6) =       0.000566646007
  error estimate for blocks of size 2^( 7) =       0.000566727672

      target function =                  N/A
              le_mean =     -22.669961139061
             les_mean =     514.447546812472
             stat err =       0.000562746139
             autocorr =       1.217055051939
              std dev =       0.721393807948
             le_variance =       0.520409026146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510102454
  error estimate for blocks of size 2^( 2) =       0.000527872470
  error estimate for blocks of size 2^( 3) =       0.000544019651
  error estimate for blocks of size 2^( 4) =       0.000555271177
  error estimate for blocks of size 2^( 5) =       0.000562339701
  error estimate for blocks of size 2^( 6) =       0.000566646007
  error estimate for blocks of size 2^( 7) =       0.000566727672

      target function =                  N/A
              le_mean =     -22.669961139061
             les_mean =     514.447546812472
             stat err =       0.000562746139
             autocorr =       1.217055051939
              std dev =       0.721393807948
             le_variance =       0.520409026146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520537851054
                                         uncertainty =       0.004103572094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510102454
  error estimate for blocks of size 2^( 2) =       0.000527872470
  error estimate for blocks of size 2^( 3) =       0.000544019651
  error estimate for blocks of size 2^( 4) =       0.000555271177
  error estimate for blocks of size 2^( 5) =       0.000562339701
  error estimate for blocks of size 2^( 6) =       0.000566646007
  error estimate for blocks of size 2^( 7) =       0.000566727672

      target function =                  N/A
              le_mean =     -22.669961139061
             les_mean =     514.447546812472
             stat err =       0.000562746139
             autocorr =       1.217055051939
              std dev =       0.721393807948
             le_variance =       0.520409026146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669961139061        initial  <--
     1.5625e+20     1.5625e+21             0.0000e+00       -22.669961139061
     6.2500e+20     6.2500e+21             0.0000e+00       -22.669961139061
     2.5000e+21     2.5000e+22             0.0000e+00       -22.669961139061

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.2546
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1551e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.5055
    reference variance = 0.362777
====================================================
  Execution time = 4.4825e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4700e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512933764705
                                         uncertainty =       0.006525485847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512933764705
                                         uncertainty =       0.006525485847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506378758
  error estimate for blocks of size 2^( 2) =       0.000524333820
  error estimate for blocks of size 2^( 3) =       0.000539764194
  error estimate for blocks of size 2^( 4) =       0.000551668810
  error estimate for blocks of size 2^( 5) =       0.000557741176
  error estimate for blocks of size 2^( 6) =       0.000561699279
  error estimate for blocks of size 2^( 7) =       0.000564700154

      target function =                  N/A
              le_mean =     -22.668846519127
             les_mean =     514.389441144892
             stat err =       0.000558952355
             autocorr =       1.218424495235
              std dev =       0.716127707602
             le_variance =       0.512838893596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266884651913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+21, overlap shift 1.5625e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668846519127       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668846519127       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668846519127       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668846519127       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+22, overlap shift 2.5000e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668846519127       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668846519127       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9535e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.5962
    reference variance = 0.554963
====================================================
  Execution time = 4.1745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1770e-01
  Total weights = 2.0000e+06
  Execution time = 3.1613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508772391
  error estimate for blocks of size 2^( 2) =       0.000526495065
  error estimate for blocks of size 2^( 3) =       0.000542917960
  error estimate for blocks of size 2^( 4) =       0.000554096806
  error estimate for blocks of size 2^( 5) =       0.000560497499
  error estimate for blocks of size 2^( 6) =       0.000563124745
  error estimate for blocks of size 2^( 7) =       0.000567427286

      target function =                  N/A
              le_mean =     -22.668059497320
             les_mean =     514.358619806421
             stat err =       0.000561286584
             autocorr =       1.217088761596
              std dev =       0.719512815183
             le_variance =       0.517698691213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508772391
  error estimate for blocks of size 2^( 2) =       0.000526495065
  error estimate for blocks of size 2^( 3) =       0.000542917960
  error estimate for blocks of size 2^( 4) =       0.000554096806
  error estimate for blocks of size 2^( 5) =       0.000560497499
  error estimate for blocks of size 2^( 6) =       0.000563124745
  error estimate for blocks of size 2^( 7) =       0.000567427286

      target function =                  N/A
              le_mean =     -22.668059497320
             les_mean =     514.358619806421
             stat err =       0.000561286584
             autocorr =       1.217088761596
              std dev =       0.719512815183
             le_variance =       0.517698691213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508772391
  error estimate for blocks of size 2^( 2) =       0.000526495065
  error estimate for blocks of size 2^( 3) =       0.000542917960
  error estimate for blocks of size 2^( 4) =       0.000554096806
  error estimate for blocks of size 2^( 5) =       0.000560497499
  error estimate for blocks of size 2^( 6) =       0.000563124745
  error estimate for blocks of size 2^( 7) =       0.000567427286

      target function =                  N/A
              le_mean =     -22.668059497320
             les_mean =     514.358619806421
             stat err =       0.000561286584
             autocorr =       1.217088761596
              std dev =       0.719512815183
             le_variance =       0.517698691213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517598367536
                                         uncertainty =       0.005830823589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508772391
  error estimate for blocks of size 2^( 2) =       0.000526495065
  error estimate for blocks of size 2^( 3) =       0.000542917960
  error estimate for blocks of size 2^( 4) =       0.000554096806
  error estimate for blocks of size 2^( 5) =       0.000560497499
  error estimate for blocks of size 2^( 6) =       0.000563124745
  error estimate for blocks of size 2^( 7) =       0.000567427286

      target function =                  N/A
              le_mean =     -22.668059497320
             les_mean =     514.358619806421
             stat err =       0.000561286584
             autocorr =       1.217088761596
              std dev =       0.719512815183
             le_variance =       0.517698691213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668059497320        initial  <--
     1.5625e+21     1.5625e+22             0.0000e+00       -22.668059497320
     6.2500e+21     6.2500e+22             0.0000e+00       -22.668059497320
     2.5000e+22     2.5000e+23             0.0000e+00       -22.668059497320

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5725
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1711e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6219
    reference variance = 0.284564
====================================================
  Execution time = 4.2986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1816e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4792e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518201900614
                                         uncertainty =       0.006255306758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518201900614
                                         uncertainty =       0.006255306758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508998005
  error estimate for blocks of size 2^( 2) =       0.000526544425
  error estimate for blocks of size 2^( 3) =       0.000542634087
  error estimate for blocks of size 2^( 4) =       0.000552766098
  error estimate for blocks of size 2^( 5) =       0.000559605715
  error estimate for blocks of size 2^( 6) =       0.000563530335
  error estimate for blocks of size 2^( 7) =       0.000565956821

      target function =                  N/A
              le_mean =     -22.668222624337
             les_mean =     514.366474625972
             stat err =       0.000560464742
             autocorr =       1.212451662775
              std dev =       0.719831882156
             le_variance =       0.518157938569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266822262434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+22, overlap shift 1.5625e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668222624337       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668222624337       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668222624492       residual = 1.50e+05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668222624336       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+22 is 2.378365e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668222624337       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668222624337       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668222624337       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668222624336       residual = 7.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+22 is 2.006379e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+23, overlap shift 2.5000e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668222624337       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668222624337       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668222713073       residual = 1.11e+05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+23 is 1.486478e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7788e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6813
    reference variance = 0.318547
====================================================
  Execution time = 4.2167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0424e-01
  Total weights = 2.0000e+06
  Execution time = 3.1699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502113338
  error estimate for blocks of size 2^( 2) =       0.000519999882
  error estimate for blocks of size 2^( 3) =       0.000535480178
  error estimate for blocks of size 2^( 4) =       0.000546904629
  error estimate for blocks of size 2^( 5) =       0.000554282899
  error estimate for blocks of size 2^( 6) =       0.000557685669
  error estimate for blocks of size 2^( 7) =       0.000556616689

      target function =                  N/A
              le_mean =     -22.668503937180
             les_mean =     514.365306105523
             stat err =       0.000553872472
             autocorr =       1.216791159583
              std dev =       0.710095491943
             le_variance =       0.504235607677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502113338
  error estimate for blocks of size 2^( 2) =       0.000519999882
  error estimate for blocks of size 2^( 3) =       0.000535480178
  error estimate for blocks of size 2^( 4) =       0.000546904629
  error estimate for blocks of size 2^( 5) =       0.000554282899
  error estimate for blocks of size 2^( 6) =       0.000557685669
  error estimate for blocks of size 2^( 7) =       0.000556616689

      target function =                  N/A
              le_mean =     -22.668503937180
             les_mean =     514.365306105523
             stat err =       0.000553872472
             autocorr =       1.216791159583
              std dev =       0.710095491943
             le_variance =       0.504235607677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502113338
  error estimate for blocks of size 2^( 2) =       0.000519999882
  error estimate for blocks of size 2^( 3) =       0.000535480178
  error estimate for blocks of size 2^( 4) =       0.000546904629
  error estimate for blocks of size 2^( 5) =       0.000554282899
  error estimate for blocks of size 2^( 6) =       0.000557685669
  error estimate for blocks of size 2^( 7) =       0.000556616689

      target function =                  N/A
              le_mean =     -22.668503937180
             les_mean =     514.365306105523
             stat err =       0.000553872472
             autocorr =       1.216791159583
              std dev =       0.710095491943
             le_variance =       0.504235607677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503916935554
                                         uncertainty =       0.002767785823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502113338
  error estimate for blocks of size 2^( 2) =       0.000519999882
  error estimate for blocks of size 2^( 3) =       0.000535480178
  error estimate for blocks of size 2^( 4) =       0.000546904629
  error estimate for blocks of size 2^( 5) =       0.000554282899
  error estimate for blocks of size 2^( 6) =       0.000557685669
  error estimate for blocks of size 2^( 7) =       0.000556616689

      target function =                  N/A
              le_mean =     -22.668503937180
             les_mean =     514.365306105523
             stat err =       0.000553872472
             autocorr =       1.216791159583
              std dev =       0.710095491943
             le_variance =       0.504235607677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668503937180        initial  <--
     1.5625e+22     1.5625e+23             2.3784e-27       -22.668503937180
     6.2500e+22     6.2500e+23             2.0064e-27       -22.668503937180
     2.5000e+23     2.5000e+24             1.4865e-28       -22.668503937180

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.0901
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1588e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7437
    reference variance = 0.341863
====================================================
  Execution time = 4.2415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1832e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4831e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518339229544
                                         uncertainty =       0.005377299976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518339229544
                                         uncertainty =       0.005377299976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509078392
  error estimate for blocks of size 2^( 2) =       0.000526611296
  error estimate for blocks of size 2^( 3) =       0.000541763421
  error estimate for blocks of size 2^( 4) =       0.000552315109
  error estimate for blocks of size 2^( 5) =       0.000559613531
  error estimate for blocks of size 2^( 6) =       0.000563882847
  error estimate for blocks of size 2^( 7) =       0.000565845105

      target function =                  N/A
              le_mean =     -22.668414355071
             les_mean =     514.375330731640
             stat err =       0.000560414148
             autocorr =       1.211849965239
              std dev =       0.719945565743
             le_variance =       0.518321617633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266841435507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+23, overlap shift 1.5625e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668414355071       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668414355071       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668414355071       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668414355071       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+23 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+24, overlap shift 2.5000e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668414355071       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668414355071       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+24 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7256e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7495
    reference variance = 0.347744
====================================================
  Execution time = 4.3200e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1395e-01
  Total weights = 2.0000e+06
  Execution time = 3.2595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506928550
  error estimate for blocks of size 2^( 2) =       0.000524925247
  error estimate for blocks of size 2^( 3) =       0.000540879912
  error estimate for blocks of size 2^( 4) =       0.000551623396
  error estimate for blocks of size 2^( 5) =       0.000557922495
  error estimate for blocks of size 2^( 6) =       0.000559531539
  error estimate for blocks of size 2^( 7) =       0.000561445337

      target function =                  N/A
              le_mean =     -22.668099127544
             les_mean =     514.356670908684
             stat err =       0.000557630692
             autocorr =       1.210040302965
              std dev =       0.716905230494
             le_variance =       0.513953109509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506928550
  error estimate for blocks of size 2^( 2) =       0.000524925247
  error estimate for blocks of size 2^( 3) =       0.000540879912
  error estimate for blocks of size 2^( 4) =       0.000551623396
  error estimate for blocks of size 2^( 5) =       0.000557922495
  error estimate for blocks of size 2^( 6) =       0.000559531539
  error estimate for blocks of size 2^( 7) =       0.000561445337

      target function =                  N/A
              le_mean =     -22.668099127544
             les_mean =     514.356670908684
             stat err =       0.000557630692
             autocorr =       1.210040302965
              std dev =       0.716905230494
             le_variance =       0.513953109509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506928550
  error estimate for blocks of size 2^( 2) =       0.000524925247
  error estimate for blocks of size 2^( 3) =       0.000540879912
  error estimate for blocks of size 2^( 4) =       0.000551623396
  error estimate for blocks of size 2^( 5) =       0.000557922495
  error estimate for blocks of size 2^( 6) =       0.000559531539
  error estimate for blocks of size 2^( 7) =       0.000561445337

      target function =                  N/A
              le_mean =     -22.668099127544
             les_mean =     514.356670908684
             stat err =       0.000557630692
             autocorr =       1.210040302965
              std dev =       0.716905230494
             le_variance =       0.513953109509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513839277821
                                         uncertainty =       0.003814926393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506928550
  error estimate for blocks of size 2^( 2) =       0.000524925247
  error estimate for blocks of size 2^( 3) =       0.000540879912
  error estimate for blocks of size 2^( 4) =       0.000551623396
  error estimate for blocks of size 2^( 5) =       0.000557922495
  error estimate for blocks of size 2^( 6) =       0.000559531539
  error estimate for blocks of size 2^( 7) =       0.000561445337

      target function =                  N/A
              le_mean =     -22.668099127544
             les_mean =     514.356670908684
             stat err =       0.000557630692
             autocorr =       1.210040302965
              std dev =       0.716905230494
             le_variance =       0.513953109509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668099127544        initial  <--
     1.5625e+23     1.5625e+24             0.0000e+00       -22.668099127544
     6.2500e+23     6.2500e+24             0.0000e+00       -22.668099127544
     2.5000e+24     2.5000e+25             0.0000e+00       -22.668099127544

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.1633
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1643e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.665
    reference variance = 0.414333
====================================================
  Execution time = 4.3332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2144e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4823e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521532258799
                                         uncertainty =       0.005642766870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521532258799
                                         uncertainty =       0.005642766870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510607482
  error estimate for blocks of size 2^( 2) =       0.000527743805
  error estimate for blocks of size 2^( 3) =       0.000543486325
  error estimate for blocks of size 2^( 4) =       0.000555006009
  error estimate for blocks of size 2^( 5) =       0.000561311767
  error estimate for blocks of size 2^( 6) =       0.000566847537
  error estimate for blocks of size 2^( 7) =       0.000569401733

      target function =                  N/A
              le_mean =     -22.668472684052
             les_mean =     514.381093568758
             stat err =       0.000563141762
             autocorr =       1.216357174613
              std dev =       0.722108026445
             le_variance =       0.521440001856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266847268405e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+24, overlap shift 1.5625e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668472684052       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668472684052       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668472684052       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+24 is 6.132027e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668472684052       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668472684052       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+25, overlap shift 2.5000e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668472684052       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668472684052       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8165e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6246
    reference variance = 0.603346
====================================================
  Execution time = 4.2247e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1731e-01
  Total weights = 2.0000e+06
  Execution time = 3.1684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508581286
  error estimate for blocks of size 2^( 2) =       0.000526030779
  error estimate for blocks of size 2^( 3) =       0.000541692446
  error estimate for blocks of size 2^( 4) =       0.000553850532
  error estimate for blocks of size 2^( 5) =       0.000561159955
  error estimate for blocks of size 2^( 6) =       0.000563915896
  error estimate for blocks of size 2^( 7) =       0.000564068497

      target function =                  N/A
              le_mean =     -22.668568090977
             les_mean =     514.381288886359
             stat err =       0.000560748720
             autocorr =       1.215670364312
              std dev =       0.719242552792
             le_variance =       0.517309849746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508581286
  error estimate for blocks of size 2^( 2) =       0.000526030779
  error estimate for blocks of size 2^( 3) =       0.000541692446
  error estimate for blocks of size 2^( 4) =       0.000553850532
  error estimate for blocks of size 2^( 5) =       0.000561159955
  error estimate for blocks of size 2^( 6) =       0.000563915896
  error estimate for blocks of size 2^( 7) =       0.000564068497

      target function =                  N/A
              le_mean =     -22.668568090977
             les_mean =     514.381288886359
             stat err =       0.000560748720
             autocorr =       1.215670364312
              std dev =       0.719242552792
             le_variance =       0.517309849746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508581286
  error estimate for blocks of size 2^( 2) =       0.000526030779
  error estimate for blocks of size 2^( 3) =       0.000541692446
  error estimate for blocks of size 2^( 4) =       0.000553850532
  error estimate for blocks of size 2^( 5) =       0.000561159955
  error estimate for blocks of size 2^( 6) =       0.000563915896
  error estimate for blocks of size 2^( 7) =       0.000564068497

      target function =                  N/A
              le_mean =     -22.668568090977
             les_mean =     514.381288886359
             stat err =       0.000560748720
             autocorr =       1.215670364312
              std dev =       0.719242552792
             le_variance =       0.517309849746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517340379525
                                         uncertainty =       0.005067084739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508581286
  error estimate for blocks of size 2^( 2) =       0.000526030779
  error estimate for blocks of size 2^( 3) =       0.000541692446
  error estimate for blocks of size 2^( 4) =       0.000553850532
  error estimate for blocks of size 2^( 5) =       0.000561159955
  error estimate for blocks of size 2^( 6) =       0.000563915896
  error estimate for blocks of size 2^( 7) =       0.000564068497

      target function =                  N/A
              le_mean =     -22.668568090977
             les_mean =     514.381288886359
             stat err =       0.000560748720
             autocorr =       1.215670364312
              std dev =       0.719242552792
             le_variance =       0.517309849746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668568090977        initial  <--
     1.5625e+24     1.5625e+25             6.1320e-29       -22.668568090977
     6.2500e+24     6.2500e+25             0.0000e+00       -22.668568090977
     2.5000e+25     2.5000e+26             0.0000e+00       -22.668568090977

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.1152
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1634e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6792
    reference variance = 0.271325
====================================================
  Execution time = 4.2408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1600e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4956e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516109248001
                                         uncertainty =       0.004582393117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516109248001
                                         uncertainty =       0.004582393117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507936890
  error estimate for blocks of size 2^( 2) =       0.000526191217
  error estimate for blocks of size 2^( 3) =       0.000542283500
  error estimate for blocks of size 2^( 4) =       0.000552627160
  error estimate for blocks of size 2^( 5) =       0.000560372671
  error estimate for blocks of size 2^( 6) =       0.000563742104
  error estimate for blocks of size 2^( 7) =       0.000566707367

      target function =                  N/A
              le_mean =     -22.668237260035
             les_mean =     514.364979987896
             stat err =       0.000560862326
             autocorr =       1.219250733377
              std dev =       0.718331238823
             le_variance =       0.515999768669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266823726003e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+25, overlap shift 1.5625e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668237260035       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668237260035       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668237260035       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668237260035       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+26, overlap shift 2.5000e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668237260035       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668237260035       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7374e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.635
    reference variance = 0.434377
====================================================
  Execution time = 4.1733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1353e-01
  Total weights = 2.0000e+06
  Execution time = 3.1640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506718775
  error estimate for blocks of size 2^( 2) =       0.000524069273
  error estimate for blocks of size 2^( 3) =       0.000539629407
  error estimate for blocks of size 2^( 4) =       0.000550489084
  error estimate for blocks of size 2^( 5) =       0.000556956402
  error estimate for blocks of size 2^( 6) =       0.000560459831
  error estimate for blocks of size 2^( 7) =       0.000560940342

      target function =                  N/A
              le_mean =     -22.667975584830
             les_mean =     514.350644691283
             stat err =       0.000557211415
             autocorr =       1.209221937109
              std dev =       0.716608563715
             le_variance =       0.513527833590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506718775
  error estimate for blocks of size 2^( 2) =       0.000524069273
  error estimate for blocks of size 2^( 3) =       0.000539629407
  error estimate for blocks of size 2^( 4) =       0.000550489084
  error estimate for blocks of size 2^( 5) =       0.000556956402
  error estimate for blocks of size 2^( 6) =       0.000560459831
  error estimate for blocks of size 2^( 7) =       0.000560940342

      target function =                  N/A
              le_mean =     -22.667975584830
             les_mean =     514.350644691283
             stat err =       0.000557211415
             autocorr =       1.209221937109
              std dev =       0.716608563715
             le_variance =       0.513527833590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506718775
  error estimate for blocks of size 2^( 2) =       0.000524069273
  error estimate for blocks of size 2^( 3) =       0.000539629407
  error estimate for blocks of size 2^( 4) =       0.000550489084
  error estimate for blocks of size 2^( 5) =       0.000556956402
  error estimate for blocks of size 2^( 6) =       0.000560459831
  error estimate for blocks of size 2^( 7) =       0.000560940342

      target function =                  N/A
              le_mean =     -22.667975584830
             les_mean =     514.350644691283
             stat err =       0.000557211415
             autocorr =       1.209221937109
              std dev =       0.716608563715
             le_variance =       0.513527833590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513447917469
                                         uncertainty =       0.003641132694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506718775
  error estimate for blocks of size 2^( 2) =       0.000524069273
  error estimate for blocks of size 2^( 3) =       0.000539629407
  error estimate for blocks of size 2^( 4) =       0.000550489084
  error estimate for blocks of size 2^( 5) =       0.000556956402
  error estimate for blocks of size 2^( 6) =       0.000560459831
  error estimate for blocks of size 2^( 7) =       0.000560940342

      target function =                  N/A
              le_mean =     -22.667975584830
             les_mean =     514.350644691283
             stat err =       0.000557211415
             autocorr =       1.209221937109
              std dev =       0.716608563715
             le_variance =       0.513527833590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667975584830        initial  <--
     1.5625e+25     1.5625e+26             0.0000e+00       -22.667975584830
     6.2500e+25     6.2500e+26             0.0000e+00       -22.667975584830
     2.5000e+26     2.5000e+27             0.0000e+00       -22.667975584830

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.5679
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1495e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7489
    reference variance = 0.475787
====================================================
  Execution time = 4.4877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0719e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4515e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507052851676
                                         uncertainty =       0.002771289650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507052851676
                                         uncertainty =       0.002771289650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503582399
  error estimate for blocks of size 2^( 2) =       0.000521417985
  error estimate for blocks of size 2^( 3) =       0.000537604568
  error estimate for blocks of size 2^( 4) =       0.000549315568
  error estimate for blocks of size 2^( 5) =       0.000556274370
  error estimate for blocks of size 2^( 6) =       0.000559361506
  error estimate for blocks of size 2^( 7) =       0.000561980514

      target function =                  N/A
              le_mean =     -22.668911604647
             les_mean =     514.386743551426
             stat err =       0.000556732990
             autocorr =       1.222229685977
              std dev =       0.712173058821
             le_variance =       0.507190465710


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266891160465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+26, overlap shift 1.5625e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668911604647       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668911604647       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668911604647       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668911604647       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668911604647       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668911604647       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+27, overlap shift 2.5000e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668911604647       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668911604647       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668911604618       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9405e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.5862
    reference variance = 0.3559
====================================================
  Execution time = 4.1769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1338e-01
  Total weights = 2.0000e+06
  Execution time = 3.1722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506647335
  error estimate for blocks of size 2^( 2) =       0.000524448742
  error estimate for blocks of size 2^( 3) =       0.000539808487
  error estimate for blocks of size 2^( 4) =       0.000551495548
  error estimate for blocks of size 2^( 5) =       0.000558808910
  error estimate for blocks of size 2^( 6) =       0.000560200056
  error estimate for blocks of size 2^( 7) =       0.000564388892

      target function =                  N/A
              le_mean =     -22.668361660817
             les_mean =     514.368003172878
             stat err =       0.000558723351
             autocorr =       1.216135932670
              std dev =       0.716507532401
             le_variance =       0.513383043988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506647335
  error estimate for blocks of size 2^( 2) =       0.000524448742
  error estimate for blocks of size 2^( 3) =       0.000539808487
  error estimate for blocks of size 2^( 4) =       0.000551495548
  error estimate for blocks of size 2^( 5) =       0.000558808910
  error estimate for blocks of size 2^( 6) =       0.000560200056
  error estimate for blocks of size 2^( 7) =       0.000564388892

      target function =                  N/A
              le_mean =     -22.668361660817
             les_mean =     514.368003172878
             stat err =       0.000558723351
             autocorr =       1.216135932670
              std dev =       0.716507532401
             le_variance =       0.513383043988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506647335
  error estimate for blocks of size 2^( 2) =       0.000524448742
  error estimate for blocks of size 2^( 3) =       0.000539808487
  error estimate for blocks of size 2^( 4) =       0.000551495548
  error estimate for blocks of size 2^( 5) =       0.000558808910
  error estimate for blocks of size 2^( 6) =       0.000560200056
  error estimate for blocks of size 2^( 7) =       0.000564388892

      target function =                  N/A
              le_mean =     -22.668361660817
             les_mean =     514.368003172878
             stat err =       0.000558723351
             autocorr =       1.216135932670
              std dev =       0.716507532401
             le_variance =       0.513383043988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513522717877
                                         uncertainty =       0.005217721307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506647335
  error estimate for blocks of size 2^( 2) =       0.000524448742
  error estimate for blocks of size 2^( 3) =       0.000539808487
  error estimate for blocks of size 2^( 4) =       0.000551495548
  error estimate for blocks of size 2^( 5) =       0.000558808910
  error estimate for blocks of size 2^( 6) =       0.000560200056
  error estimate for blocks of size 2^( 7) =       0.000564388892

      target function =                  N/A
              le_mean =     -22.668361660817
             les_mean =     514.368003172878
             stat err =       0.000558723351
             autocorr =       1.216135932670
              std dev =       0.716507532401
             le_variance =       0.513383043988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668361660817        initial  <--
     1.5625e+26     1.5625e+27             0.0000e+00       -22.668361660817
     6.2500e+26     6.2500e+27             0.0000e+00       -22.668361660817
     2.5000e+27     2.5000e+28             0.0000e+00       -22.668361660817

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.7352
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1717e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6623
    reference variance = 0.372071
====================================================
  Execution time = 4.1908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2093e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4851e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520956686821
                                         uncertainty =       0.009413756915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520956686821
                                         uncertainty =       0.009413756915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510355781
  error estimate for blocks of size 2^( 2) =       0.000528103811
  error estimate for blocks of size 2^( 3) =       0.000543433471
  error estimate for blocks of size 2^( 4) =       0.000555306611
  error estimate for blocks of size 2^( 5) =       0.000562533310
  error estimate for blocks of size 2^( 6) =       0.000566091508
  error estimate for blocks of size 2^( 7) =       0.000570470102

      target function =                  N/A
              le_mean =     -22.669190746357
             les_mean =     514.413134881112
             stat err =       0.000563600383
             autocorr =       1.219541213026
              std dev =       0.721752067436
             le_variance =       0.520926046849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266919074636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+27, overlap shift 1.5625e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669190746357       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669190746357       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669472773660       residual = 1.51e+08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669190746354       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+27 is 1.702138e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669190746357       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669190746357       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669190746357       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+28, overlap shift 2.5000e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669190746357       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669190746357       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.672501878557       residual = 2.41e+09           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669190746266       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6769e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7442
    reference variance = 0.509866
====================================================
  Execution time = 4.2496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1362e-01
  Total weights = 2.0000e+06
  Execution time = 3.1554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506764525
  error estimate for blocks of size 2^( 2) =       0.000524176552
  error estimate for blocks of size 2^( 3) =       0.000540118271
  error estimate for blocks of size 2^( 4) =       0.000551845518
  error estimate for blocks of size 2^( 5) =       0.000558522398
  error estimate for blocks of size 2^( 6) =       0.000560579221
  error estimate for blocks of size 2^( 7) =       0.000557978906

      target function =                  N/A
              le_mean =     -22.668742507059
             les_mean =     514.385507162105
             stat err =       0.000557231511
             autocorr =       1.209090820054
              std dev =       0.716673264171
             le_variance =       0.513620567578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506764525
  error estimate for blocks of size 2^( 2) =       0.000524176552
  error estimate for blocks of size 2^( 3) =       0.000540118271
  error estimate for blocks of size 2^( 4) =       0.000551845518
  error estimate for blocks of size 2^( 5) =       0.000558522398
  error estimate for blocks of size 2^( 6) =       0.000560579221
  error estimate for blocks of size 2^( 7) =       0.000557978906

      target function =                  N/A
              le_mean =     -22.668742507059
             les_mean =     514.385507162105
             stat err =       0.000557231511
             autocorr =       1.209090820054
              std dev =       0.716673264171
             le_variance =       0.513620567578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506764525
  error estimate for blocks of size 2^( 2) =       0.000524176552
  error estimate for blocks of size 2^( 3) =       0.000540118271
  error estimate for blocks of size 2^( 4) =       0.000551845518
  error estimate for blocks of size 2^( 5) =       0.000558522398
  error estimate for blocks of size 2^( 6) =       0.000560579221
  error estimate for blocks of size 2^( 7) =       0.000557978906

      target function =                  N/A
              le_mean =     -22.668742507059
             les_mean =     514.385507162105
             stat err =       0.000557231511
             autocorr =       1.209090820054
              std dev =       0.716673264171
             le_variance =       0.513620567578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513718015885
                                         uncertainty =       0.003970171923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506764525
  error estimate for blocks of size 2^( 2) =       0.000524176552
  error estimate for blocks of size 2^( 3) =       0.000540118271
  error estimate for blocks of size 2^( 4) =       0.000551845518
  error estimate for blocks of size 2^( 5) =       0.000558522398
  error estimate for blocks of size 2^( 6) =       0.000560579221
  error estimate for blocks of size 2^( 7) =       0.000557978906

      target function =                  N/A
              le_mean =     -22.668742507059
             les_mean =     514.385507162105
             stat err =       0.000557231511
             autocorr =       1.209090820054
              std dev =       0.716673264171
             le_variance =       0.513620567578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668742507059        initial  <--
     1.5625e+27     1.5625e+28             1.7021e-32       -22.668742507059
     6.2500e+27     6.2500e+28             0.0000e+00       -22.668742507059
     2.5000e+28     2.5000e+29             0.0000e+00       -22.668742507059

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.3810
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1520e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6344
    reference variance = 0.378691
====================================================
  Execution time = 4.2248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.3096e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4745e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.530981725028
                                         uncertainty =       0.014119604062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.530981725028
                                         uncertainty =       0.014119604062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515247799
  error estimate for blocks of size 2^( 2) =       0.000533158974
  error estimate for blocks of size 2^( 3) =       0.000548949142
  error estimate for blocks of size 2^( 4) =       0.000560287173
  error estimate for blocks of size 2^( 5) =       0.000567416399
  error estimate for blocks of size 2^( 6) =       0.000574344342
  error estimate for blocks of size 2^( 7) =       0.000578807200

      target function =                  N/A
              le_mean =     -22.669007638244
             les_mean =     514.414867626877
             stat err =       0.000570213778
             autocorr =       1.224737803368
              std dev =       0.728670425911
             le_variance =       0.530960589597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266900763824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+28, overlap shift 1.5625e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669007638244       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669007638244       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669007638244       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669007638244       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+29, overlap shift 2.5000e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669007638244       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669007638244       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7004e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6763
    reference variance = 0.696171
====================================================
  Execution time = 4.4163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1363e-01
  Total weights = 2.0000e+06
  Execution time = 3.1679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506769920
  error estimate for blocks of size 2^( 2) =       0.000524038182
  error estimate for blocks of size 2^( 3) =       0.000539779935
  error estimate for blocks of size 2^( 4) =       0.000552189600
  error estimate for blocks of size 2^( 5) =       0.000558364382
  error estimate for blocks of size 2^( 6) =       0.000561295512
  error estimate for blocks of size 2^( 7) =       0.000563277604

      target function =                  N/A
              le_mean =     -22.668380329736
             les_mean =     514.369098019651
             stat err =       0.000558781774
             autocorr =       1.215801872238
              std dev =       0.716680893357
             le_variance =       0.513631502903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506769920
  error estimate for blocks of size 2^( 2) =       0.000524038182
  error estimate for blocks of size 2^( 3) =       0.000539779935
  error estimate for blocks of size 2^( 4) =       0.000552189600
  error estimate for blocks of size 2^( 5) =       0.000558364382
  error estimate for blocks of size 2^( 6) =       0.000561295512
  error estimate for blocks of size 2^( 7) =       0.000563277604

      target function =                  N/A
              le_mean =     -22.668380329736
             les_mean =     514.369098019651
             stat err =       0.000558781774
             autocorr =       1.215801872238
              std dev =       0.716680893357
             le_variance =       0.513631502903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506769920
  error estimate for blocks of size 2^( 2) =       0.000524038182
  error estimate for blocks of size 2^( 3) =       0.000539779935
  error estimate for blocks of size 2^( 4) =       0.000552189600
  error estimate for blocks of size 2^( 5) =       0.000558364382
  error estimate for blocks of size 2^( 6) =       0.000561295512
  error estimate for blocks of size 2^( 7) =       0.000563277604

      target function =                  N/A
              le_mean =     -22.668380329736
             les_mean =     514.369098019651
             stat err =       0.000558781774
             autocorr =       1.215801872238
              std dev =       0.716680893357
             le_variance =       0.513631502903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513712452246
                                         uncertainty =       0.004641174713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506769920
  error estimate for blocks of size 2^( 2) =       0.000524038182
  error estimate for blocks of size 2^( 3) =       0.000539779935
  error estimate for blocks of size 2^( 4) =       0.000552189600
  error estimate for blocks of size 2^( 5) =       0.000558364382
  error estimate for blocks of size 2^( 6) =       0.000561295512
  error estimate for blocks of size 2^( 7) =       0.000563277604

      target function =                  N/A
              le_mean =     -22.668380329736
             les_mean =     514.369098019651
             stat err =       0.000558781774
             autocorr =       1.215801872238
              std dev =       0.716680893357
             le_variance =       0.513631502903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668380329736        initial  <--
     1.5625e+28     1.5625e+29             0.0000e+00       -22.668380329736
     6.2500e+28     6.2500e+29             0.0000e+00       -22.668380329736
     2.5000e+29     2.5000e+30             0.0000e+00       -22.668380329736

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.0778
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1709e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.5804
    reference variance = 0.33979
====================================================
  Execution time = 4.2141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4808e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515883912418
                                         uncertainty =       0.004715190907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515883912418
                                         uncertainty =       0.004715190907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507840598
  error estimate for blocks of size 2^( 2) =       0.000525701321
  error estimate for blocks of size 2^( 3) =       0.000541808101
  error estimate for blocks of size 2^( 4) =       0.000552829259
  error estimate for blocks of size 2^( 5) =       0.000559329179
  error estimate for blocks of size 2^( 6) =       0.000562912589
  error estimate for blocks of size 2^( 7) =       0.000563013833

      target function =                  N/A
              le_mean =     -22.669602974475
             les_mean =     514.426702908266
             stat err =       0.000559521215
             autocorr =       1.213887065008
              std dev =       0.718195061141
             le_variance =       0.515804145848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266960297447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+29, overlap shift 1.5625e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669602974475       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602974475       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602974318       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+29 is 1.880573e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669602974475       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602974475       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602975249       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+29 is 4.701433e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+30, overlap shift 2.5000e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669602974475       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602974475       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669602975249       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+30 is 1.175358e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6961e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6036
    reference variance = 0.311404
====================================================
  Execution time = 4.2372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2156e-01
  Total weights = 2.0000e+06
  Execution time = 3.1686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510664766
  error estimate for blocks of size 2^( 2) =       0.000528598284
  error estimate for blocks of size 2^( 3) =       0.000544167531
  error estimate for blocks of size 2^( 4) =       0.000554284266
  error estimate for blocks of size 2^( 5) =       0.000560877456
  error estimate for blocks of size 2^( 6) =       0.000563429295
  error estimate for blocks of size 2^( 7) =       0.000567295170

      target function =                  N/A
              le_mean =     -22.669129739815
             les_mean =     514.410999905563
             stat err =       0.000561471547
             autocorr =       1.208881460914
              std dev =       0.722189037440
             le_variance =       0.521557005798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510664766
  error estimate for blocks of size 2^( 2) =       0.000528598284
  error estimate for blocks of size 2^( 3) =       0.000544167531
  error estimate for blocks of size 2^( 4) =       0.000554284266
  error estimate for blocks of size 2^( 5) =       0.000560877456
  error estimate for blocks of size 2^( 6) =       0.000563429295
  error estimate for blocks of size 2^( 7) =       0.000567295170

      target function =                  N/A
              le_mean =     -22.669129739815
             les_mean =     514.410999905563
             stat err =       0.000561471547
             autocorr =       1.208881460914
              std dev =       0.722189037440
             le_variance =       0.521557005798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510664766
  error estimate for blocks of size 2^( 2) =       0.000528598284
  error estimate for blocks of size 2^( 3) =       0.000544167531
  error estimate for blocks of size 2^( 4) =       0.000554284266
  error estimate for blocks of size 2^( 5) =       0.000560877456
  error estimate for blocks of size 2^( 6) =       0.000563429295
  error estimate for blocks of size 2^( 7) =       0.000567295170

      target function =                  N/A
              le_mean =     -22.669129739815
             les_mean =     514.410999905563
             stat err =       0.000561471547
             autocorr =       1.208881460914
              std dev =       0.722189037440
             le_variance =       0.521557005798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521696341048
                                         uncertainty =       0.008250637129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510664766
  error estimate for blocks of size 2^( 2) =       0.000528598284
  error estimate for blocks of size 2^( 3) =       0.000544167531
  error estimate for blocks of size 2^( 4) =       0.000554284266
  error estimate for blocks of size 2^( 5) =       0.000560877456
  error estimate for blocks of size 2^( 6) =       0.000563429295
  error estimate for blocks of size 2^( 7) =       0.000567295170

      target function =                  N/A
              le_mean =     -22.669129739815
             les_mean =     514.410999905563
             stat err =       0.000561471547
             autocorr =       1.208881460914
              std dev =       0.722189037440
             le_variance =       0.521557005798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669129739815        initial  <--
     1.5625e+29     1.5625e+30             1.8806e-34       -22.669129739815
     6.2500e+29     6.2500e+30             4.7014e-35       -22.669129739815
     2.5000e+30     2.5000e+31             1.1754e-35       -22.669129739815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.3216
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1530e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.5751
    reference variance = 0.449801
====================================================
  Execution time = 4.1951e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1726e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4902e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517175676889
                                         uncertainty =       0.010349799073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517175676889
                                         uncertainty =       0.010349799073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508557733
  error estimate for blocks of size 2^( 2) =       0.000525985116
  error estimate for blocks of size 2^( 3) =       0.000541850874
  error estimate for blocks of size 2^( 4) =       0.000553053909
  error estimate for blocks of size 2^( 5) =       0.000558639554
  error estimate for blocks of size 2^( 6) =       0.000560738007
  error estimate for blocks of size 2^( 7) =       0.000564507244

      target function =                  N/A
              le_mean =     -22.667534864772
             les_mean =     514.334398522397
             stat err =       0.000559234678
             autocorr =       1.209226521304
              std dev =       0.719209243124
             le_variance =       0.517261935395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266753486477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+30, overlap shift 1.5625e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667534864772       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667534864772       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667534864773       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667534864772       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667534864772       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667534864770       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+31, overlap shift 2.5000e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667534864772       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667534864772       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667534864770       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6870e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7557
    reference variance = 0.393775
====================================================
  Execution time = 4.2699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0956e-01
  Total weights = 2.0000e+06
  Execution time = 3.1542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504755486
  error estimate for blocks of size 2^( 2) =       0.000522455660
  error estimate for blocks of size 2^( 3) =       0.000538513093
  error estimate for blocks of size 2^( 4) =       0.000549556440
  error estimate for blocks of size 2^( 5) =       0.000555969263
  error estimate for blocks of size 2^( 6) =       0.000560459945
  error estimate for blocks of size 2^( 7) =       0.000560729176

      target function =                  N/A
              le_mean =     -22.669437662713
             les_mean =     514.412959890531
             stat err =       0.000556678706
             autocorr =       1.216317966676
              std dev =       0.713832054259
             le_variance =       0.509556201688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504755486
  error estimate for blocks of size 2^( 2) =       0.000522455660
  error estimate for blocks of size 2^( 3) =       0.000538513093
  error estimate for blocks of size 2^( 4) =       0.000549556440
  error estimate for blocks of size 2^( 5) =       0.000555969263
  error estimate for blocks of size 2^( 6) =       0.000560459945
  error estimate for blocks of size 2^( 7) =       0.000560729176

      target function =                  N/A
              le_mean =     -22.669437662713
             les_mean =     514.412959890531
             stat err =       0.000556678706
             autocorr =       1.216317966676
              std dev =       0.713832054259
             le_variance =       0.509556201688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504755486
  error estimate for blocks of size 2^( 2) =       0.000522455660
  error estimate for blocks of size 2^( 3) =       0.000538513093
  error estimate for blocks of size 2^( 4) =       0.000549556440
  error estimate for blocks of size 2^( 5) =       0.000555969263
  error estimate for blocks of size 2^( 6) =       0.000560459945
  error estimate for blocks of size 2^( 7) =       0.000560729176

      target function =                  N/A
              le_mean =     -22.669437662713
             les_mean =     514.412959890531
             stat err =       0.000556678706
             autocorr =       1.216317966676
              std dev =       0.713832054259
             le_variance =       0.509556201688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566471052
                                         uncertainty =       0.005153632745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504755486
  error estimate for blocks of size 2^( 2) =       0.000522455660
  error estimate for blocks of size 2^( 3) =       0.000538513093
  error estimate for blocks of size 2^( 4) =       0.000549556440
  error estimate for blocks of size 2^( 5) =       0.000555969263
  error estimate for blocks of size 2^( 6) =       0.000560459945
  error estimate for blocks of size 2^( 7) =       0.000560729176

      target function =                  N/A
              le_mean =     -22.669437662713
             les_mean =     514.412959890531
             stat err =       0.000556678706
             autocorr =       1.216317966676
              std dev =       0.713832054259
             le_variance =       0.509556201688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669437662713        initial  <--
     1.5625e+30     1.5625e+31             0.0000e+00       -22.669437662713
     6.2500e+30     6.2500e+31             0.0000e+00       -22.669437662713
     2.5000e+31     2.5000e+32             0.0000e+00       -22.669437662713

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.6529
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1554e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.635
    reference variance = 0.292826
====================================================
  Execution time = 4.3656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2667e+01
  VMC Evar = 5.1387e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4937e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513870231505
                                         uncertainty =       0.004435241530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513870231505
                                         uncertainty =       0.004435241530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506886595
  error estimate for blocks of size 2^( 2) =       0.000524420018
  error estimate for blocks of size 2^( 3) =       0.000540671246
  error estimate for blocks of size 2^( 4) =       0.000551309580
  error estimate for blocks of size 2^( 5) =       0.000558486017
  error estimate for blocks of size 2^( 6) =       0.000562323401
  error estimate for blocks of size 2^( 7) =       0.000564258745

      target function =                  N/A
              le_mean =     -22.666887327364
             les_mean =     514.301648894498
             stat err =       0.000559094436
             autocorr =       1.216602566748
              std dev =       0.716845896996
             le_variance =       0.513868040039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266688732736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+31, overlap shift 1.5625e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666887327364       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.666887327364       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666887327364       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.666887327364       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+32, overlap shift 2.5000e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.666887327364       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.666887327364       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8603e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6954
    reference variance = 0.336887
====================================================
  Execution time = 4.1942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1946e-01
  Total weights = 2.0000e+06
  Execution time = 3.1659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509637126
  error estimate for blocks of size 2^( 2) =       0.000527271554
  error estimate for blocks of size 2^( 3) =       0.000543169038
  error estimate for blocks of size 2^( 4) =       0.000554789326
  error estimate for blocks of size 2^( 5) =       0.000561124062
  error estimate for blocks of size 2^( 6) =       0.000564661797
  error estimate for blocks of size 2^( 7) =       0.000562251385

      target function =                  N/A
              le_mean =     -22.668777826360
             les_mean =     514.392947882069
             stat err =       0.000560706643
             autocorr =       1.210456777022
              std dev =       0.720735735856
             le_variance =       0.519460000940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509637126
  error estimate for blocks of size 2^( 2) =       0.000527271554
  error estimate for blocks of size 2^( 3) =       0.000543169038
  error estimate for blocks of size 2^( 4) =       0.000554789326
  error estimate for blocks of size 2^( 5) =       0.000561124062
  error estimate for blocks of size 2^( 6) =       0.000564661797
  error estimate for blocks of size 2^( 7) =       0.000562251385

      target function =                  N/A
              le_mean =     -22.668777826360
             les_mean =     514.392947882069
             stat err =       0.000560706643
             autocorr =       1.210456777022
              std dev =       0.720735735856
             le_variance =       0.519460000940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509637126
  error estimate for blocks of size 2^( 2) =       0.000527271554
  error estimate for blocks of size 2^( 3) =       0.000543169038
  error estimate for blocks of size 2^( 4) =       0.000554789326
  error estimate for blocks of size 2^( 5) =       0.000561124062
  error estimate for blocks of size 2^( 6) =       0.000564661797
  error estimate for blocks of size 2^( 7) =       0.000562251385

      target function =                  N/A
              le_mean =     -22.668777826360
             les_mean =     514.392947882069
             stat err =       0.000560706643
             autocorr =       1.210456777022
              std dev =       0.720735735856
             le_variance =       0.519460000940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519511203017
                                         uncertainty =       0.006829975260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509637126
  error estimate for blocks of size 2^( 2) =       0.000527271554
  error estimate for blocks of size 2^( 3) =       0.000543169038
  error estimate for blocks of size 2^( 4) =       0.000554789326
  error estimate for blocks of size 2^( 5) =       0.000561124062
  error estimate for blocks of size 2^( 6) =       0.000564661797
  error estimate for blocks of size 2^( 7) =       0.000562251385

      target function =                  N/A
              le_mean =     -22.668777826360
             les_mean =     514.392947882069
             stat err =       0.000560706643
             autocorr =       1.210456777022
              std dev =       0.720735735856
             le_variance =       0.519460000940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668777826360        initial  <--
     1.5625e+31     1.5625e+32             0.0000e+00       -22.668777826360
     6.2500e+31     6.2500e+32             0.0000e+00       -22.668777826360
     2.5000e+32     2.5000e+33             0.0000e+00       -22.668777826360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.8708
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1648e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7051
    reference variance = 0.464312
====================================================
  Execution time = 4.2050e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0583e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4768e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505760561185
                                         uncertainty =       0.002924549834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505760561185
                                         uncertainty =       0.002924549834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502906529
  error estimate for blocks of size 2^( 2) =       0.000520975629
  error estimate for blocks of size 2^( 3) =       0.000536988565
  error estimate for blocks of size 2^( 4) =       0.000549093156
  error estimate for blocks of size 2^( 5) =       0.000556653297
  error estimate for blocks of size 2^( 6) =       0.000561352392
  error estimate for blocks of size 2^( 7) =       0.000564749608

      target function =                  N/A
              le_mean =     -22.668281947437
             les_mean =     514.356836148984
             stat err =       0.000557962113
             autocorr =       1.230934299963
              std dev =       0.711217233610
             le_variance =       0.505829953385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266828194744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+32, overlap shift 1.5625e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668281947437       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668281947437       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668281947437       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668281947437       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+33, overlap shift 2.5000e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668281947437       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668281947437       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317069 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6828e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6195
    reference variance = 0.391416
====================================================
  Execution time = 4.2384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1562e-01
  Total weights = 2.0000e+06
  Execution time = 3.1670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507748376
  error estimate for blocks of size 2^( 2) =       0.000525434864
  error estimate for blocks of size 2^( 3) =       0.000541240394
  error estimate for blocks of size 2^( 4) =       0.000552886283
  error estimate for blocks of size 2^( 5) =       0.000558806386
  error estimate for blocks of size 2^( 6) =       0.000560897151
  error estimate for blocks of size 2^( 7) =       0.000563225000

      target function =                  N/A
              le_mean =     -22.669040034126
             les_mean =     514.400992637703
             stat err =       0.000558953705
             autocorr =       1.211865975415
              std dev =       0.718064639653
             le_variance =       0.515616826719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507748376
  error estimate for blocks of size 2^( 2) =       0.000525434864
  error estimate for blocks of size 2^( 3) =       0.000541240394
  error estimate for blocks of size 2^( 4) =       0.000552886283
  error estimate for blocks of size 2^( 5) =       0.000558806386
  error estimate for blocks of size 2^( 6) =       0.000560897151
  error estimate for blocks of size 2^( 7) =       0.000563225000

      target function =                  N/A
              le_mean =     -22.669040034126
             les_mean =     514.400992637703
             stat err =       0.000558953705
             autocorr =       1.211865975415
              std dev =       0.718064639653
             le_variance =       0.515616826719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507748376
  error estimate for blocks of size 2^( 2) =       0.000525434864
  error estimate for blocks of size 2^( 3) =       0.000541240394
  error estimate for blocks of size 2^( 4) =       0.000552886283
  error estimate for blocks of size 2^( 5) =       0.000558806386
  error estimate for blocks of size 2^( 6) =       0.000560897151
  error estimate for blocks of size 2^( 7) =       0.000563225000

      target function =                  N/A
              le_mean =     -22.669040034126
             les_mean =     514.400992637703
             stat err =       0.000558953705
             autocorr =       1.211865975415
              std dev =       0.718064639653
             le_variance =       0.515616826719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515228322023
                                         uncertainty =       0.004081089990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507748376
  error estimate for blocks of size 2^( 2) =       0.000525434864
  error estimate for blocks of size 2^( 3) =       0.000541240394
  error estimate for blocks of size 2^( 4) =       0.000552886283
  error estimate for blocks of size 2^( 5) =       0.000558806386
  error estimate for blocks of size 2^( 6) =       0.000560897151
  error estimate for blocks of size 2^( 7) =       0.000563225000

      target function =                  N/A
              le_mean =     -22.669040034126
             les_mean =     514.400992637703
             stat err =       0.000558953705
             autocorr =       1.211865975415
              std dev =       0.718064639653
             le_variance =       0.515616826719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669040034126        initial  <--
     1.5625e+32     1.5625e+33             0.0000e+00       -22.669040034126
     6.2500e+32     6.2500e+33             0.0000e+00       -22.669040034126
     2.5000e+33     2.5000e+34             0.0000e+00       -22.669040034126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.3208
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1516e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.5568
    reference variance = 0.572381
====================================================
  Execution time = 4.2244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1012e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4653e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185118864
                                         uncertainty =       0.002984978280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510185118864
                                         uncertainty =       0.002984978280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505033515
  error estimate for blocks of size 2^( 2) =       0.000523043648
  error estimate for blocks of size 2^( 3) =       0.000539120092
  error estimate for blocks of size 2^( 4) =       0.000550582582
  error estimate for blocks of size 2^( 5) =       0.000558559859
  error estimate for blocks of size 2^( 6) =       0.000561735908
  error estimate for blocks of size 2^( 7) =       0.000566784783

      target function =                  N/A
              le_mean =     -22.668403418682
             les_mean =     514.366630999579
             stat err =       0.000559415783
             autocorr =       1.226956120110
              std dev =       0.714225246336
             le_variance =       0.510117702504


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266840341868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+33, overlap shift 1.5625e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668403418682       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668403418682       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668403418682       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668403418682       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+34, overlap shift 2.5000e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668403418682       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668403418682       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6907e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6104
    reference variance = 0.62698
====================================================
  Execution time = 4.2346e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1547e-01
  Total weights = 2.0000e+06
  Execution time = 3.1676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507677758
  error estimate for blocks of size 2^( 2) =       0.000525699689
  error estimate for blocks of size 2^( 3) =       0.000541926064
  error estimate for blocks of size 2^( 4) =       0.000553315800
  error estimate for blocks of size 2^( 5) =       0.000560186219
  error estimate for blocks of size 2^( 6) =       0.000562255909
  error estimate for blocks of size 2^( 7) =       0.000562536506

      target function =                  N/A
              le_mean =     -22.667549496978
             les_mean =     514.333273352651
             stat err =       0.000559573609
             autocorr =       1.214893400738
              std dev =       0.717964771025
             le_variance =       0.515473412432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507677758
  error estimate for blocks of size 2^( 2) =       0.000525699689
  error estimate for blocks of size 2^( 3) =       0.000541926064
  error estimate for blocks of size 2^( 4) =       0.000553315800
  error estimate for blocks of size 2^( 5) =       0.000560186219
  error estimate for blocks of size 2^( 6) =       0.000562255909
  error estimate for blocks of size 2^( 7) =       0.000562536506

      target function =                  N/A
              le_mean =     -22.667549496978
             les_mean =     514.333273352651
             stat err =       0.000559573609
             autocorr =       1.214893400738
              std dev =       0.717964771025
             le_variance =       0.515473412432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507677758
  error estimate for blocks of size 2^( 2) =       0.000525699689
  error estimate for blocks of size 2^( 3) =       0.000541926064
  error estimate for blocks of size 2^( 4) =       0.000553315800
  error estimate for blocks of size 2^( 5) =       0.000560186219
  error estimate for blocks of size 2^( 6) =       0.000562255909
  error estimate for blocks of size 2^( 7) =       0.000562536506

      target function =                  N/A
              le_mean =     -22.667549496978
             les_mean =     514.333273352651
             stat err =       0.000559573609
             autocorr =       1.214893400738
              std dev =       0.717964771025
             le_variance =       0.515473412432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515457259658
                                         uncertainty =       0.005209617497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507677758
  error estimate for blocks of size 2^( 2) =       0.000525699689
  error estimate for blocks of size 2^( 3) =       0.000541926064
  error estimate for blocks of size 2^( 4) =       0.000553315800
  error estimate for blocks of size 2^( 5) =       0.000560186219
  error estimate for blocks of size 2^( 6) =       0.000562255909
  error estimate for blocks of size 2^( 7) =       0.000562536506

      target function =                  N/A
              le_mean =     -22.667549496978
             les_mean =     514.333273352651
             stat err =       0.000559573609
             autocorr =       1.214893400738
              std dev =       0.717964771025
             le_variance =       0.515473412432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667549496978        initial  <--
     1.5625e+33     1.5625e+34             0.0000e+00       -22.667549496978
     6.2500e+33     6.2500e+34             0.0000e+00       -22.667549496978
     2.5000e+34     2.5000e+35             0.0000e+00       -22.667549496978

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6219
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1853e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6138
    reference variance = 0.258583
====================================================
  Execution time = 4.2246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.1759e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4686e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517742538844
                                         uncertainty =       0.005667793759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517742538844
                                         uncertainty =       0.005667793759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508720106
  error estimate for blocks of size 2^( 2) =       0.000526592079
  error estimate for blocks of size 2^( 3) =       0.000542224917
  error estimate for blocks of size 2^( 4) =       0.000552494578
  error estimate for blocks of size 2^( 5) =       0.000558583703
  error estimate for blocks of size 2^( 6) =       0.000563401633
  error estimate for blocks of size 2^( 7) =       0.000564688159

      target function =                  N/A
              le_mean =     -22.668149621453
             les_mean =     514.362599293460
             stat err =       0.000559792018
             autocorr =       1.210864647267
              std dev =       0.719438872798
             le_variance =       0.517592291693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266814962145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+34, overlap shift 1.5625e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668149621453       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668149621453       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668149620295       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668149621453       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668149621453       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668149621453       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668149471283       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+34 is 1.244300e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+35, overlap shift 2.5000e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668149621453       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668149621453       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668149620295       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6993e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7177
    reference variance = 0.885818
====================================================
  Execution time = 4.2543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.2413e-01
  Total weights = 2.0000e+06
  Execution time = 3.1623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511922054
  error estimate for blocks of size 2^( 2) =       0.000529454736
  error estimate for blocks of size 2^( 3) =       0.000545433792
  error estimate for blocks of size 2^( 4) =       0.000556601501
  error estimate for blocks of size 2^( 5) =       0.000562900703
  error estimate for blocks of size 2^( 6) =       0.000567303832
  error estimate for blocks of size 2^( 7) =       0.000569932972

      target function =                  N/A
              le_mean =     -22.667883880354
             les_mean =     514.357087729716
             stat err =       0.000564184752
             autocorr =       1.214604847370
              std dev =       0.723967111531
             le_variance =       0.524128378578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511922054
  error estimate for blocks of size 2^( 2) =       0.000529454736
  error estimate for blocks of size 2^( 3) =       0.000545433792
  error estimate for blocks of size 2^( 4) =       0.000556601501
  error estimate for blocks of size 2^( 5) =       0.000562900703
  error estimate for blocks of size 2^( 6) =       0.000567303832
  error estimate for blocks of size 2^( 7) =       0.000569932972

      target function =                  N/A
              le_mean =     -22.667883880354
             les_mean =     514.357087729716
             stat err =       0.000564184752
             autocorr =       1.214604847370
              std dev =       0.723967111531
             le_variance =       0.524128378578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511922054
  error estimate for blocks of size 2^( 2) =       0.000529454736
  error estimate for blocks of size 2^( 3) =       0.000545433792
  error estimate for blocks of size 2^( 4) =       0.000556601501
  error estimate for blocks of size 2^( 5) =       0.000562900703
  error estimate for blocks of size 2^( 6) =       0.000567303832
  error estimate for blocks of size 2^( 7) =       0.000569932972

      target function =                  N/A
              le_mean =     -22.667883880354
             les_mean =     514.357087729716
             stat err =       0.000564184752
             autocorr =       1.214604847370
              std dev =       0.723967111531
             le_variance =       0.524128378578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.524226582497
                                         uncertainty =       0.010748075007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511922054
  error estimate for blocks of size 2^( 2) =       0.000529454736
  error estimate for blocks of size 2^( 3) =       0.000545433792
  error estimate for blocks of size 2^( 4) =       0.000556601501
  error estimate for blocks of size 2^( 5) =       0.000562900703
  error estimate for blocks of size 2^( 6) =       0.000567303832
  error estimate for blocks of size 2^( 7) =       0.000569932972

      target function =                  N/A
              le_mean =     -22.667883880354
             les_mean =     514.357087729716
             stat err =       0.000564184752
             autocorr =       1.214604847370
              std dev =       0.723967111531
             le_variance =       0.524128378578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.667883880354        initial  <--
     1.5625e+34     1.5625e+35             0.0000e+00       -22.667883880354
     6.2500e+34     6.2500e+35             1.2443e-39       -22.667883880354
     2.5000e+35     2.5000e+36             0.0000e+00       -22.667883880354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.4179
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1542e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24168 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7258
    reference variance = 0.369852
====================================================
  Execution time = 4.2178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1475e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4771e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514768507812
                                         uncertainty =       0.003474835919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514768507812
                                         uncertainty =       0.003474835919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507319126
  error estimate for blocks of size 2^( 2) =       0.000525054173
  error estimate for blocks of size 2^( 3) =       0.000540942011
  error estimate for blocks of size 2^( 4) =       0.000552011097
  error estimate for blocks of size 2^( 5) =       0.000559401035
  error estimate for blocks of size 2^( 6) =       0.000563533668
  error estimate for blocks of size 2^( 7) =       0.000563648602

      target function =                  N/A
              le_mean =     -22.669558092129
             les_mean =     514.423609226798
             stat err =       0.000559648601
             autocorr =       1.216937776046
              std dev =       0.717457588830
             le_variance =       0.514745391769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266955809213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+35, overlap shift 1.5625e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669558092129       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669558092129       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+35, overlap shift 6.2500e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669558092129       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669558092129       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+36, overlap shift 2.5000e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669558092129       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669558092129       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6959e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6849
    reference variance = 0.301295
====================================================
  Execution time = 4.2412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1390e-01
  Total weights = 2.0000e+06
  Execution time = 3.1668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506901551
  error estimate for blocks of size 2^( 2) =       0.000525042564
  error estimate for blocks of size 2^( 3) =       0.000540679737
  error estimate for blocks of size 2^( 4) =       0.000552159227
  error estimate for blocks of size 2^( 5) =       0.000559571205
  error estimate for blocks of size 2^( 6) =       0.000561623784
  error estimate for blocks of size 2^( 7) =       0.000564411054

      target function =                  N/A
              le_mean =     -22.668646063291
             les_mean =     514.381412449650
             stat err =       0.000559441317
             autocorr =       1.218040801744
              std dev =       0.716867047539
             le_variance =       0.513898363847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506901551
  error estimate for blocks of size 2^( 2) =       0.000525042564
  error estimate for blocks of size 2^( 3) =       0.000540679737
  error estimate for blocks of size 2^( 4) =       0.000552159227
  error estimate for blocks of size 2^( 5) =       0.000559571205
  error estimate for blocks of size 2^( 6) =       0.000561623784
  error estimate for blocks of size 2^( 7) =       0.000564411054

      target function =                  N/A
              le_mean =     -22.668646063291
             les_mean =     514.381412449650
             stat err =       0.000559441317
             autocorr =       1.218040801744
              std dev =       0.716867047539
             le_variance =       0.513898363847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506901551
  error estimate for blocks of size 2^( 2) =       0.000525042564
  error estimate for blocks of size 2^( 3) =       0.000540679737
  error estimate for blocks of size 2^( 4) =       0.000552159227
  error estimate for blocks of size 2^( 5) =       0.000559571205
  error estimate for blocks of size 2^( 6) =       0.000561623784
  error estimate for blocks of size 2^( 7) =       0.000564411054

      target function =                  N/A
              le_mean =     -22.668646063291
             les_mean =     514.381412449650
             stat err =       0.000559441317
             autocorr =       1.218040801744
              std dev =       0.716867047539
             le_variance =       0.513898363847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513843128749
                                         uncertainty =       0.002964093628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506901551
  error estimate for blocks of size 2^( 2) =       0.000525042564
  error estimate for blocks of size 2^( 3) =       0.000540679737
  error estimate for blocks of size 2^( 4) =       0.000552159227
  error estimate for blocks of size 2^( 5) =       0.000559571205
  error estimate for blocks of size 2^( 6) =       0.000561623784
  error estimate for blocks of size 2^( 7) =       0.000564411054

      target function =                  N/A
              le_mean =     -22.668646063291
             les_mean =     514.381412449650
             stat err =       0.000559441317
             autocorr =       1.218040801744
              std dev =       0.716867047539
             le_variance =       0.513898363847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668646063291        initial  <--
     1.5625e+35     1.5625e+36             0.0000e+00       -22.668646063291
     6.2500e+35     6.2500e+36             0.0000e+00       -22.668646063291
     2.5000e+36     2.5000e+37             0.0000e+00       -22.668646063291

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.2839
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.948521e-01 1 1  ON 0
 uu_1                 1.194226e-01 1 1  ON 1
 uu_2                 6.107527e-03 1 1  ON 2
 uu_3                -6.108610e-02 1 1  ON 3
 uu_4                -1.015976e-01 1 1  ON 4
 uu_5                -1.273984e-01 1 1  ON 5
 uu_6                -1.427810e-01 1 1  ON 6
 uu_7                -1.471101e-01 1 1  ON 7
 uu_8                -1.393776e-01 1 1  ON 8
 uu_9                -1.168683e-01 1 1  ON 9
 ud_0                 4.115922e-01 1 1  ON 10
 ud_1                 1.287132e-01 1 1  ON 11
 ud_2                -1.801498e-02 1 1  ON 12
 ud_3                -9.608355e-02 1 1  ON 13
 ud_4                -1.387399e-01 1 1  ON 14
 ud_5                -1.636968e-01 1 1  ON 15
 ud_6                -1.763109e-01 1 1  ON 16
 ud_7                -1.773849e-01 1 1  ON 17
 ud_8                -1.645168e-01 1 1  ON 18
 ud_9                -1.340615e-01 1 1  ON 19
 eC_0                -5.809416e-01 1 1  ON 20
 eC_1                -4.285042e-01 1 1  ON 21
 eC_2                -1.788156e-01 1 1  ON 22
 eC_3                -2.340256e-02 1 1  ON 23
 eC_4                 5.650915e-02 1 1  ON 24
 eC_5                 1.595721e-01 1 1  ON 25
 eC_6                 2.565380e-01 1 1  ON 26
 eC_7                 3.742215e-01 1 1  ON 27
 eC_8                 2.776939e-01 1 1  ON 28
 eC_9                 8.003376e-02 1 1  ON 29
 eO_0                -1.189137e+00 1 1  ON 30
 eO_1                -8.124512e-01 1 1  ON 31
 eO_2                -3.418757e-01 1 1  ON 32
 eO_3                -1.922894e-04 1 1  ON 33
 eO_4                 2.248421e-01 1 1  ON 34
 eO_5                 3.898984e-01 1 1  ON 35
 eO_6                 4.344989e-01 1 1  ON 36
 eO_7                 4.332108e-01 1 1  ON 37
 eO_8                 4.145607e-01 1 1  ON 38
 eO_9                 3.091284e-01 1 1  ON 39
eH1_0                -2.047165e-01 1 1  ON 40
eH1_1                -1.139026e-01 1 1  ON 41
eH1_2                -7.659982e-02 1 1  ON 42
eH1_3                -5.756470e-02 1 1  ON 43
eH1_4                 1.110473e-02 1 1  ON 44
eH1_5                 5.655183e-02 1 1  ON 45
eH1_6                 8.908740e-02 1 1  ON 46
eH1_7                 6.181491e-02 1 1  ON 47
eH1_8                -2.276711e-04 1 1  ON 48
eH1_9                 6.365952e-02 1 1  ON 49
eH2_0                -2.016976e-01 1 1  ON 50
eH2_1                -1.105326e-01 1 1  ON 51
eH2_2                -7.278972e-02 1 1  ON 52
eH2_3                -5.387374e-02 1 1  ON 53
eH2_4                 1.459145e-02 1 1  ON 54
eH2_5                 6.036038e-02 1 1  ON 55
eH2_6                 9.322051e-02 1 1  ON 56
eH2_7                 6.719039e-02 1 1  ON 57
eH2_8                 1.091893e-02 1 1  ON 58
eH2_9                 6.501270e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1525e+02 secs
  Total Execution time = 4.6457e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
