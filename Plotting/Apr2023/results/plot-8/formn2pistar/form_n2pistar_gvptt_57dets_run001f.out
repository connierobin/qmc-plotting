Rank =    0  Free Memory = 69775 MB
Rank =    1  Free Memory = 69775 MB
Rank =    2  Free Memory = 69775 MB
Rank =    3  Free Memory = 69774 MB
Rank =    4  Free Memory = 69774 MB
Rank =    5  Free Memory = 69774 MB
Rank =    6  Free Memory = 69773 MB
Rank =    7  Free Memory = 69773 MB
Rank =    8  Free Memory = 69773 MB
Rank =    9  Free Memory = 69773 MB
Rank =   10  Free Memory = 69773 MB
Rank =   11  Free Memory = 69773 MB
Rank =   12  Free Memory = 69773 MB
Rank =   13  Free Memory = 69773 MB
Rank =   14  Free Memory = 69772 MB
Rank =   15  Free Memory = 69760 MB
Rank =   16  Free Memory = 69759 MB
Rank =   17  Free Memory = 69759 MB
Rank =   18  Free Memory = 69759 MB
Rank =   19  Free Memory = 69759 MB
Rank =   20  Free Memory = 69759 MB
Rank =   21  Free Memory = 69759 MB
Rank =   22  Free Memory = 69759 MB
Rank =   23  Free Memory = 69759 MB
Rank =   24  Free Memory = 69759 MB
Rank =   25  Free Memory = 69759 MB
Rank =   26  Free Memory = 69759 MB
Rank =   27  Free Memory = 69759 MB
Rank =   28  Free Memory = 69759 MB
Rank =   29  Free Memory = 69759 MB
Rank =   30  Free Memory = 69759 MB
Rank =   31  Free Memory = 69759 MB
Rank =   32  Free Memory = 70697 MB
Rank =   33  Free Memory = 70697 MB
Rank =   34  Free Memory = 70697 MB
Rank =   35  Free Memory = 70697 MB
Rank =   36  Free Memory = 70697 MB
Rank =   37  Free Memory = 70697 MB
Rank =   38  Free Memory = 70697 MB
Rank =   39  Free Memory = 70697 MB
Rank =   40  Free Memory = 70697 MB
Rank =   41  Free Memory = 70697 MB
Rank =   42  Free Memory = 70697 MB
Rank =   43  Free Memory = 70697 MB
Rank =   44  Free Memory = 70697 MB
Rank =   45  Free Memory = 70697 MB
Rank =   46  Free Memory = 70697 MB
Rank =   47  Free Memory = 70697 MB
Rank =   48  Free Memory = 70697 MB
Rank =   49  Free Memory = 70697 MB
Rank =   50  Free Memory = 70697 MB
Rank =   51  Free Memory = 70697 MB
Rank =   52  Free Memory = 70697 MB
Rank =   53  Free Memory = 70697 MB
Rank =   54  Free Memory = 70697 MB
Rank =   55  Free Memory = 70697 MB
Rank =   56  Free Memory = 70697 MB
Rank =   57  Free Memory = 70697 MB
Rank =   58  Free Memory = 70697 MB
Rank =   59  Free Memory = 70697 MB
Rank =   60  Free Memory = 70697 MB
Rank =   61  Free Memory = 70696 MB
Rank =   62  Free Memory = 70696 MB
Rank =   63  Free Memory = 70696 MB
Rank =   64  Free Memory = 71661 MB
Rank =   65  Free Memory = 71661 MB
Rank =   66  Free Memory = 71661 MB
Rank =   67  Free Memory = 71661 MB
Rank =   68  Free Memory = 71661 MB
Rank =   69  Free Memory = 71661 MB
Rank =   70  Free Memory = 71661 MB
Rank =   71  Free Memory = 71661 MB
Rank =   72  Free Memory = 71661 MB
Rank =   73  Free Memory = 71661 MB
Rank =   74  Free Memory = 71660 MB
Rank =   75  Free Memory = 71660 MB
Rank =   76  Free Memory = 71660 MB
Rank =   77  Free Memory = 71660 MB
Rank =   78  Free Memory = 71660 MB
Rank =   79  Free Memory = 71660 MB
Rank =   80  Free Memory = 71660 MB
Rank =   81  Free Memory = 71660 MB
Rank =   82  Free Memory = 71660 MB
Rank =   83  Free Memory = 71660 MB
Rank =   84  Free Memory = 71660 MB
Rank =   85  Free Memory = 71660 MB
Rank =   86  Free Memory = 71660 MB
Rank =   87  Free Memory = 71660 MB
Rank =   88  Free Memory = 71660 MB
Rank =   89  Free Memory = 71660 MB
Rank =   90  Free Memory = 71660 MB
Rank =   91  Free Memory = 71660 MB
Rank =   92  Free Memory = 71660 MB
Rank =   93  Free Memory = 71660 MB
Rank =   94  Free Memory = 71660 MB
Rank =   95  Free Memory = 71660 MB
Rank =   96  Free Memory = 63652 MB
Rank =   97  Free Memory = 63652 MB
Rank =   98  Free Memory = 63652 MB
Rank =   99  Free Memory = 63652 MB
Rank =  100  Free Memory = 63652 MB
Rank =  101  Free Memory = 63652 MB
Rank =  102  Free Memory = 63652 MB
Rank =  103  Free Memory = 63652 MB
Rank =  104  Free Memory = 63652 MB
Rank =  105  Free Memory = 63652 MB
Rank =  106  Free Memory = 63652 MB
Rank =  107  Free Memory = 63652 MB
Rank =  108  Free Memory = 63652 MB
Rank =  109  Free Memory = 63652 MB
Rank =  110  Free Memory = 63652 MB
Rank =  111  Free Memory = 63652 MB
Rank =  112  Free Memory = 63652 MB
Rank =  113  Free Memory = 63652 MB
Rank =  114  Free Memory = 63652 MB
Rank =  115  Free Memory = 63652 MB
Rank =  116  Free Memory = 63652 MB
Rank =  117  Free Memory = 63652 MB
Rank =  118  Free Memory = 63652 MB
Rank =  119  Free Memory = 63652 MB
Rank =  120  Free Memory = 63652 MB
Rank =  121  Free Memory = 63652 MB
Rank =  122  Free Memory = 63652 MB
Rank =  123  Free Memory = 63652 MB
Rank =  124  Free Memory = 63652 MB
Rank =  125  Free Memory = 63652 MB
Rank =  126  Free Memory = 63652 MB
Rank =  127  Free Memory = 63652 MB
  Input file(s): opt_form_n2pistar_gvptt_57dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_gvptt_57dets_run001f.xml

  Project = FORM
  date    = 2023-05-12 08:44:08 PDT
  host    = n0118.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 712

  Range of prime numbers to use as seeds over processors and threads = 5413-6491


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.941174e-01    1         1  ON     0
     uu_1                 1.188294e-01    1         1  ON     1
     uu_2                 5.404512e-03    1         1  ON     2
     uu_3                -6.190045e-02    1         1  ON     3
     uu_4                -1.021523e-01    1         1  ON     4
     uu_5                -1.277109e-01    1         1  ON     5
     uu_6                -1.427672e-01    1         1  ON     6
     uu_7                -1.475017e-01    1         1  ON     7
     uu_8                -1.389672e-01    1         1  ON     8
     uu_9                -1.163840e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.093790e-01    1         1  ON     0
     ud_1                 1.274134e-01    1         1  ON     1
     ud_2                -1.875787e-02    1         1  ON     2
     ud_3                -9.642345e-02    1         1  ON     3
     ud_4                -1.387906e-01    1         1  ON     4
     ud_5                -1.633887e-01    1         1  ON     5
     ud_6                -1.759292e-01    1         1  ON     6
     ud_7                -1.766834e-01    1         1  ON     7
     ud_8                -1.630902e-01    1         1  ON     8
     ud_9                -1.342235e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.795008e-01    1         1  ON     0
     eC_1                -4.281015e-01    1         1  ON     1
     eC_2                -1.765949e-01    1         1  ON     2
     eC_3                -2.229937e-02    1         1  ON     3
     eC_4                 5.670639e-02    1         1  ON     4
     eC_5                 1.563217e-01    1         1  ON     5
     eC_6                 2.536774e-01    1         1  ON     6
     eC_7                 3.753792e-01    1         1  ON     7
     eC_8                 2.774217e-01    1         1  ON     8
     eC_9                 7.998506e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.180907e+00    1         1  ON     0
     eO_1                -8.042592e-01    1         1  ON     1
     eO_2                -3.393089e-01    1         1  ON     2
     eO_3                 7.165952e-04    1         1  ON     3
     eO_4                 2.232634e-01    1         1  ON     4
     eO_5                 3.862571e-01    1         1  ON     5
     eO_6                 4.292796e-01    1         1  ON     6
     eO_7                 4.258636e-01    1         1  ON     7
     eO_8                 4.143492e-01    1         1  ON     8
     eO_9                 3.084611e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.058808e-01    1         1  ON     0
     eH1_1                -1.137435e-01    1         1  ON     1
     eH1_2                -7.749966e-02    1         1  ON     2
     eH1_3                -5.909338e-02    1         1  ON     3
     eH1_4                 9.807563e-03    1         1  ON     4
     eH1_5                 5.507806e-02    1         1  ON     5
     eH1_6                 9.037447e-02    1         1  ON     6
     eH1_7                 6.483749e-02    1         1  ON     7
     eH1_8                 5.480779e-04    1         1  ON     8
     eH1_9                 6.611909e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.019987e-01    1         1  ON     0
     eH2_1                -1.103787e-01    1         1  ON     1
     eH2_2                -7.420080e-02    1         1  ON     2
     eH2_3                -5.521868e-02    1         1  ON     3
     eH2_4                 1.388969e-02    1         1  ON     4
     eH2_5                 5.936493e-02    1         1  ON     5
     eH2_6                 9.492529e-02    1         1  ON     6
     eH2_7                 7.079710e-02    1         1  ON     7
     eH2_8                 8.932652e-03    1         1  ON     8
     eH2_9                 6.565761e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 57 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 3.659782e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 21 unique up determinants.
Found 21 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2489e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6206
    reference variance = 0.446088
====================================================
  Execution time = 4.4902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 4.9907e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5375e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498957302267
                                         uncertainty =       0.003045539941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498957302267
                                         uncertainty =       0.003045539941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499535927
  error estimate for blocks of size 2^( 2) =       0.000517479984
  error estimate for blocks of size 2^( 3) =       0.000532834892
  error estimate for blocks of size 2^( 4) =       0.000544567153
  error estimate for blocks of size 2^( 5) =       0.000550886973
  error estimate for blocks of size 2^( 6) =       0.000553398369
  error estimate for blocks of size 2^( 7) =       0.000556803556

      target function =                  N/A
              le_mean =     -22.669682572164
             les_mean =     514.413579958661
             stat err =       0.000551414013
             autocorr =       1.218490476515
              std dev =       0.706450483429
             le_variance =       0.499072285537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266968257216e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669682572164       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669683821548       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669683721956       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669684131928       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669684440237       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669684025413       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669684199142       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669683414214       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669684310743       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669684693277       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669684863107       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669684476114       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669684613218       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669684727790       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 7.107954e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669682572164       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669683067480       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669682967923       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669683135116       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669683145423       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669682964567       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669683013869       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669682816428       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669683040463       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669683000225       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669683030486       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669682982782       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.999440e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669682572164       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669682717239       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669682681814       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669682730318       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669682716617       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669682678872       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669682689203       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669682636173       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669682690614       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669682666082       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669682669818       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 5.841019e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0386e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.942306e-01                 1 1 ON  0
uu_1  1.188809e-01                 1 1 ON  1
uu_2  5.443765e-03                 1 1 ON  2
uu_3  -6.183156e-02                1 1 ON  3
uu_4  -1.021556e-01                1 1 ON  4
uu_5  -1.277020e-01                1 1 ON  5
uu_6  -1.427495e-01                1 1 ON  6
uu_7  -1.474082e-01                1 1 ON  7
uu_8  -1.391056e-01                1 1 ON  8
uu_9  -1.164600e-01                1 1 ON  9
ud_0  4.094808e-01                 1 1 ON  10
ud_1  1.275466e-01                 1 1 ON  11
ud_2  -1.867934e-02                1 1 ON  12
ud_3  -9.640710e-02                1 1 ON  13
ud_4  -1.387535e-01                1 1 ON  14
ud_5  -1.633773e-01                1 1 ON  15
ud_6  -1.759485e-01                1 1 ON  16
ud_7  -1.766462e-01                1 1 ON  17
ud_8  -1.631879e-01                1 1 ON  18
ud_9  -1.342887e-01                1 1 ON  19
eC_0  -5.796585e-01                1 1 ON  20
eC_1  -4.282121e-01                1 1 ON  21
eC_2  -1.766950e-01                1 1 ON  22
eC_3  -2.235323e-02                1 1 ON  23
eC_4  5.688441e-02                 1 1 ON  24
eC_5  1.564188e-01                 1 1 ON  25
eC_6  2.537850e-01                 1 1 ON  26
eC_7  3.753002e-01                 1 1 ON  27
eC_8  2.774975e-01                 1 1 ON  28
eC_9  8.003006e-02                 1 1 ON  29
eO_0  -1.180985e+00                1 1 ON  30
eO_1  -8.043596e-01                1 1 ON  31
eO_2  -3.394809e-01                1 1 ON  32
eO_3  6.925468e-04                 1 1 ON  33
eO_4  2.232877e-01                 1 1 ON  34
eO_5  3.863802e-01                 1 1 ON  35
eO_6  4.294518e-01                 1 1 ON  36
eO_7  4.259117e-01                 1 1 ON  37
eO_8  4.142415e-01                 1 1 ON  38
eO_9  3.085098e-01                 1 1 ON  39
eH1_0 -2.060020e-01                1 1 ON  40
eH1_1 -1.138104e-01                1 1 ON  41
eH1_2 -7.764008e-02                1 1 ON  42
eH1_3 -5.911001e-02                1 1 ON  43
eH1_4 1.000751e-02                 1 1 ON  44
eH1_5 5.506382e-02                 1 1 ON  45
eH1_6 9.032975e-02                 1 1 ON  46
eH1_7 6.488754e-02                 1 1 ON  47
eH1_8 7.291751e-04                 1 1 ON  48
eH1_9 6.606036e-02                 1 1 ON  49
eH2_0 -2.020042e-01                1 1 ON  50
eH2_1 -1.104236e-01                1 1 ON  51
eH2_2 -7.427864e-02                1 1 ON  52
eH2_3 -5.525674e-02                1 1 ON  53
eH2_4 1.397800e-02                 1 1 ON  54
eH2_5 5.928961e-02                 1 1 ON  55
eH2_6 9.499336e-02                 1 1 ON  56
eH2_7 7.075841e-02                 1 1 ON  57
eH2_8 9.025323e-03                 1 1 ON  58
eH2_9 6.562192e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6324
    reference variance = 0.560003
====================================================
  Execution time = 4.3491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0588e-01
  Total weights = 2.0000e+06
  Execution time = 3.5205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505824028574
                                         uncertainty =       0.003619528010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505824028574
                                         uncertainty =       0.003619528010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502888671
  error estimate for blocks of size 2^( 2) =       0.000519957834
  error estimate for blocks of size 2^( 3) =       0.000535914277
  error estimate for blocks of size 2^( 4) =       0.000548479516
  error estimate for blocks of size 2^( 5) =       0.000554374448
  error estimate for blocks of size 2^( 6) =       0.000556557550
  error estimate for blocks of size 2^( 7) =       0.000559401758

      target function =                  N/A
              le_mean =     -22.669763275943
             les_mean =     514.423960764818
             stat err =       0.000554703318
             autocorr =       1.216684074829
              std dev =       0.711191978600
             le_variance =       0.505794030425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506085979217
                                         uncertainty =       0.003624152312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506085979217
                                         uncertainty =       0.003624152312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503018809
  error estimate for blocks of size 2^( 2) =       0.000520082515
  error estimate for blocks of size 2^( 3) =       0.000536029353
  error estimate for blocks of size 2^( 4) =       0.000548586884
  error estimate for blocks of size 2^( 5) =       0.000554482592
  error estimate for blocks of size 2^( 6) =       0.000556655013
  error estimate for blocks of size 2^( 7) =       0.000559490748

      target function =                  N/A
              le_mean =     -22.669763959008
             les_mean =     514.424253549414
             stat err =       0.000554803809
             autocorr =       1.216495253604
              std dev =       0.711376022427
             le_variance =       0.506055845284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505989771489
                                         uncertainty =       0.003622740184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505989771489
                                         uncertainty =       0.003622740184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502971015
  error estimate for blocks of size 2^( 2) =       0.000520036940
  error estimate for blocks of size 2^( 3) =       0.000535987141
  error estimate for blocks of size 2^( 4) =       0.000548547277
  error estimate for blocks of size 2^( 5) =       0.000554444853
  error estimate for blocks of size 2^( 6) =       0.000556619356
  error estimate for blocks of size 2^( 7) =       0.000559456337

      target function =                  N/A
              le_mean =     -22.669764041873
             les_mean =     514.424161145069
             stat err =       0.000554766956
             autocorr =       1.216564817061
              std dev =       0.711308430895
             le_variance =       0.505959683863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505844217604
                                         uncertainty =       0.003620024496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505844217604
                                         uncertainty =       0.003620024496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502898700
  error estimate for blocks of size 2^( 2) =       0.000519967462
  error estimate for blocks of size 2^( 3) =       0.000535923088
  error estimate for blocks of size 2^( 4) =       0.000548487647
  error estimate for blocks of size 2^( 5) =       0.000554383204
  error estimate for blocks of size 2^( 6) =       0.000556565033
  error estimate for blocks of size 2^( 7) =       0.000559408019

      target function =                  N/A
              le_mean =     -22.669763327590
             les_mean =     514.423983281086
             stat err =       0.000554710976
             autocorr =       1.216669138644
              std dev =       0.711206162140
             le_variance =       0.505814205066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669763275943        initial
     2.5000e-01     2.5000e+00             7.1080e-04       -22.669763959008
     1.0000e+00     1.0000e+01             1.9994e-04       -22.669764041873  <--
     4.0000e+00     4.0000e+01             5.8410e-05       -22.669763327590

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 6.1124e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.942306e-01 1 1  ON 0
 uu_1                 1.188809e-01 1 1  ON 1
 uu_2                 5.443765e-03 1 1  ON 2
 uu_3                -6.183156e-02 1 1  ON 3
 uu_4                -1.021556e-01 1 1  ON 4
 uu_5                -1.277020e-01 1 1  ON 5
 uu_6                -1.427495e-01 1 1  ON 6
 uu_7                -1.474082e-01 1 1  ON 7
 uu_8                -1.391056e-01 1 1  ON 8
 uu_9                -1.164600e-01 1 1  ON 9
 ud_0                 4.094808e-01 1 1  ON 10
 ud_1                 1.275466e-01 1 1  ON 11
 ud_2                -1.867934e-02 1 1  ON 12
 ud_3                -9.640710e-02 1 1  ON 13
 ud_4                -1.387535e-01 1 1  ON 14
 ud_5                -1.633773e-01 1 1  ON 15
 ud_6                -1.759485e-01 1 1  ON 16
 ud_7                -1.766462e-01 1 1  ON 17
 ud_8                -1.631879e-01 1 1  ON 18
 ud_9                -1.342887e-01 1 1  ON 19
 eC_0                -5.796585e-01 1 1  ON 20
 eC_1                -4.282121e-01 1 1  ON 21
 eC_2                -1.766950e-01 1 1  ON 22
 eC_3                -2.235323e-02 1 1  ON 23
 eC_4                 5.688441e-02 1 1  ON 24
 eC_5                 1.564188e-01 1 1  ON 25
 eC_6                 2.537850e-01 1 1  ON 26
 eC_7                 3.753002e-01 1 1  ON 27
 eC_8                 2.774975e-01 1 1  ON 28
 eC_9                 8.003006e-02 1 1  ON 29
 eO_0                -1.180985e+00 1 1  ON 30
 eO_1                -8.043596e-01 1 1  ON 31
 eO_2                -3.394809e-01 1 1  ON 32
 eO_3                 6.925468e-04 1 1  ON 33
 eO_4                 2.232877e-01 1 1  ON 34
 eO_5                 3.863802e-01 1 1  ON 35
 eO_6                 4.294518e-01 1 1  ON 36
 eO_7                 4.259117e-01 1 1  ON 37
 eO_8                 4.142415e-01 1 1  ON 38
 eO_9                 3.085098e-01 1 1  ON 39
eH1_0                -2.060020e-01 1 1  ON 40
eH1_1                -1.138104e-01 1 1  ON 41
eH1_2                -7.764008e-02 1 1  ON 42
eH1_3                -5.911001e-02 1 1  ON 43
eH1_4                 1.000751e-02 1 1  ON 44
eH1_5                 5.506382e-02 1 1  ON 45
eH1_6                 9.032975e-02 1 1  ON 46
eH1_7                 6.488754e-02 1 1  ON 47
eH1_8                 7.291751e-04 1 1  ON 48
eH1_9                 6.606036e-02 1 1  ON 49
eH2_0                -2.020042e-01 1 1  ON 50
eH2_1                -1.104236e-01 1 1  ON 51
eH2_2                -7.427864e-02 1 1  ON 52
eH2_3                -5.525674e-02 1 1  ON 53
eH2_4                 1.397800e-02 1 1  ON 54
eH2_5                 5.928961e-02 1 1  ON 55
eH2_6                 9.499336e-02 1 1  ON 56
eH2_7                 7.075841e-02 1 1  ON 57
eH2_8                 9.025323e-03 1 1  ON 58
eH2_9                 6.562192e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2152e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2626e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6906
    reference variance = 0.370305
====================================================
  Execution time = 4.3635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4935e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510762724343
                                         uncertainty =       0.003860505355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510762724343
                                         uncertainty =       0.003860505355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505310758
  error estimate for blocks of size 2^( 2) =       0.000522739956
  error estimate for blocks of size 2^( 3) =       0.000538582402
  error estimate for blocks of size 2^( 4) =       0.000548930185
  error estimate for blocks of size 2^( 5) =       0.000555883855
  error estimate for blocks of size 2^( 6) =       0.000559253876
  error estimate for blocks of size 2^( 7) =       0.000559352696

      target function =                  N/A
              le_mean =     -22.669487766179
             les_mean =     514.416353250123
             stat err =       0.000555855153
             autocorr =       1.210057987577
              std dev =       0.714617327321
             le_variance =       0.510677924507


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266948776618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669487766179       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669489892324       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669491846074       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669492570781       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669493208825       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669493111856       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669491915699       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669492333210       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669492093109       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669492247092       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669492628826       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669492385032       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669492428897       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669492462586       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 8.280058e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669487766179       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669488543095       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669489290898       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669489576838       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669489881197       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669490015482       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669489408598       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669489430033       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669489578119       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669489592972       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669489641603       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.820887e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669487766179       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669487985749       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669488204493       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669488288625       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669488386732       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669488459560       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669488274983       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669488277243       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669488311105       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669488318971       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669488331428       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 7.722203e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8579e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.943952e-01 1 1  ON 0
 uu_1                 1.189355e-01 1 1  ON 1
 uu_2                 5.484597e-03 1 1  ON 2
 uu_3                -6.180718e-02 1 1  ON 3
 uu_4                -1.021137e-01 1 1  ON 4
 uu_5                -1.276443e-01 1 1  ON 5
 uu_6                -1.427307e-01 1 1  ON 6
 uu_7                -1.474683e-01 1 1  ON 7
 uu_8                -1.392659e-01 1 1  ON 8
 uu_9                -1.164892e-01 1 1  ON 9
 ud_0                 4.096094e-01 1 1  ON 10
 ud_1                 1.276758e-01 1 1  ON 11
 ud_2                -1.862131e-02 1 1  ON 12
 ud_3                -9.633443e-02 1 1  ON 13
 ud_4                -1.387124e-01 1 1  ON 14
 ud_5                -1.632886e-01 1 1  ON 15
 ud_6                -1.758675e-01 1 1  ON 16
 ud_7                -1.766464e-01 1 1  ON 17
 ud_8                -1.632832e-01 1 1  ON 18
 ud_9                -1.344883e-01 1 1  ON 19
 eC_0                -5.797937e-01 1 1  ON 20
 eC_1                -4.283331e-01 1 1  ON 21
 eC_2                -1.767572e-01 1 1  ON 22
 eC_3                -2.238972e-02 1 1  ON 23
 eC_4                 5.698926e-02 1 1  ON 24
 eC_5                 1.565629e-01 1 1  ON 25
 eC_6                 2.538641e-01 1 1  ON 26
 eC_7                 3.752246e-01 1 1  ON 27
 eC_8                 2.775617e-01 1 1  ON 28
 eC_9                 8.006606e-02 1 1  ON 29
 eO_0                -1.181135e+00 1 1  ON 30
 eO_1                -8.043926e-01 1 1  ON 31
 eO_2                -3.396202e-01 1 1  ON 32
 eO_3                 6.933118e-04 1 1  ON 33
 eO_4                 2.232982e-01 1 1  ON 34
 eO_5                 3.864149e-01 1 1  ON 35
 eO_6                 4.295843e-01 1 1  ON 36
 eO_7                 4.260340e-01 1 1  ON 37
 eO_8                 4.141322e-01 1 1  ON 38
 eO_9                 3.085764e-01 1 1  ON 39
eH1_0                -2.060398e-01 1 1  ON 40
eH1_1                -1.138210e-01 1 1  ON 41
eH1_2                -7.771978e-02 1 1  ON 42
eH1_3                -5.900792e-02 1 1  ON 43
eH1_4                 1.008490e-02 1 1  ON 44
eH1_5                 5.506629e-02 1 1  ON 45
eH1_6                 9.027803e-02 1 1  ON 46
eH1_7                 6.478820e-02 1 1  ON 47
eH1_8                 8.392776e-04 1 1  ON 48
eH1_9                 6.599887e-02 1 1  ON 49
eH2_0                -2.021770e-01 1 1  ON 50
eH2_1                -1.107057e-01 1 1  ON 51
eH2_2                -7.421566e-02 1 1  ON 52
eH2_3                -5.521360e-02 1 1  ON 53
eH2_4                 1.403808e-02 1 1  ON 54
eH2_5                 5.935977e-02 1 1  ON 55
eH2_6                 9.504143e-02 1 1  ON 56
eH2_7                 7.086590e-02 1 1  ON 57
eH2_8                 9.126318e-03 1 1  ON 58
eH2_9                 6.554437e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7522
    reference variance = 0.807203
====================================================
  Execution time = 4.3130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0944e-01
  Total weights = 2.0000e+06
  Execution time = 3.5191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509271848399
                                         uncertainty =       0.003429327525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509271848399
                                         uncertainty =       0.003429327525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504624960
  error estimate for blocks of size 2^( 2) =       0.000522751260
  error estimate for blocks of size 2^( 3) =       0.000538126722
  error estimate for blocks of size 2^( 4) =       0.000548905939
  error estimate for blocks of size 2^( 5) =       0.000555639559
  error estimate for blocks of size 2^( 6) =       0.000560195680
  error estimate for blocks of size 2^( 7) =       0.000561118846

      target function =                  N/A
              le_mean =     -22.668723749893
             les_mean =     514.380328894045
             stat err =       0.000556465006
             autocorr =       1.216013121074
              std dev =       0.713647461807
             le_variance =       0.509292699743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509643323570
                                         uncertainty =       0.003430454749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509643323570
                                         uncertainty =       0.003430454749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504809008
  error estimate for blocks of size 2^( 2) =       0.000522921866
  error estimate for blocks of size 2^( 3) =       0.000538285682
  error estimate for blocks of size 2^( 4) =       0.000549054581
  error estimate for blocks of size 2^( 5) =       0.000555785308
  error estimate for blocks of size 2^( 6) =       0.000560338737
  error estimate for blocks of size 2^( 7) =       0.000561264579

      target function =                  N/A
              le_mean =     -22.668721956263
             les_mean =     514.380619144645
             stat err =       0.000556610801
             autocorr =       1.215763406492
              std dev =       0.713907745516
             le_variance =       0.509664269108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566440677
                                         uncertainty =       0.003430108403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509566440677
                                         uncertainty =       0.003430108403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504770918
  error estimate for blocks of size 2^( 2) =       0.000522886473
  error estimate for blocks of size 2^( 3) =       0.000538252702
  error estimate for blocks of size 2^( 4) =       0.000549024098
  error estimate for blocks of size 2^( 5) =       0.000555755742
  error estimate for blocks of size 2^( 6) =       0.000560309010
  error estimate for blocks of size 2^( 7) =       0.000561229977

      target function =                  N/A
              le_mean =     -22.668722622801
             les_mean =     514.380572454068
             stat err =       0.000556579707
             autocorr =       1.215811044908
              std dev =       0.713853878176
             le_variance =       0.509587359387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509314637715
                                         uncertainty =       0.003429417163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509314637715
                                         uncertainty =       0.003429417163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504646162
  error estimate for blocks of size 2^( 2) =       0.000522770829
  error estimate for blocks of size 2^( 3) =       0.000538144889
  error estimate for blocks of size 2^( 4) =       0.000548922949
  error estimate for blocks of size 2^( 5) =       0.000555656311
  error estimate for blocks of size 2^( 6) =       0.000560211942
  error estimate for blocks of size 2^( 7) =       0.000561134413

      target function =                  N/A
              le_mean =     -22.668723553835
             les_mean =     514.380362803361
             stat err =       0.000556481404
             autocorr =       1.215982605884
              std dev =       0.713677446632
             le_variance =       0.509335497832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668723749893        initial  <--
     2.5000e-01     2.5000e+00             8.2801e-04       -22.668721956263
     1.0000e+00     1.0000e+01             2.8209e-04       -22.668722622801
     4.0000e+00     4.0000e+01             7.7222e-05       -22.668723553835

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7466
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.942306e-01 1 1  ON 0
 uu_1                 1.188809e-01 1 1  ON 1
 uu_2                 5.443765e-03 1 1  ON 2
 uu_3                -6.183156e-02 1 1  ON 3
 uu_4                -1.021556e-01 1 1  ON 4
 uu_5                -1.277020e-01 1 1  ON 5
 uu_6                -1.427495e-01 1 1  ON 6
 uu_7                -1.474082e-01 1 1  ON 7
 uu_8                -1.391056e-01 1 1  ON 8
 uu_9                -1.164600e-01 1 1  ON 9
 ud_0                 4.094808e-01 1 1  ON 10
 ud_1                 1.275466e-01 1 1  ON 11
 ud_2                -1.867934e-02 1 1  ON 12
 ud_3                -9.640710e-02 1 1  ON 13
 ud_4                -1.387535e-01 1 1  ON 14
 ud_5                -1.633773e-01 1 1  ON 15
 ud_6                -1.759485e-01 1 1  ON 16
 ud_7                -1.766462e-01 1 1  ON 17
 ud_8                -1.631879e-01 1 1  ON 18
 ud_9                -1.342887e-01 1 1  ON 19
 eC_0                -5.796585e-01 1 1  ON 20
 eC_1                -4.282121e-01 1 1  ON 21
 eC_2                -1.766950e-01 1 1  ON 22
 eC_3                -2.235323e-02 1 1  ON 23
 eC_4                 5.688441e-02 1 1  ON 24
 eC_5                 1.564188e-01 1 1  ON 25
 eC_6                 2.537850e-01 1 1  ON 26
 eC_7                 3.753002e-01 1 1  ON 27
 eC_8                 2.774975e-01 1 1  ON 28
 eC_9                 8.003006e-02 1 1  ON 29
 eO_0                -1.180985e+00 1 1  ON 30
 eO_1                -8.043596e-01 1 1  ON 31
 eO_2                -3.394809e-01 1 1  ON 32
 eO_3                 6.925468e-04 1 1  ON 33
 eO_4                 2.232877e-01 1 1  ON 34
 eO_5                 3.863802e-01 1 1  ON 35
 eO_6                 4.294518e-01 1 1  ON 36
 eO_7                 4.259117e-01 1 1  ON 37
 eO_8                 4.142415e-01 1 1  ON 38
 eO_9                 3.085098e-01 1 1  ON 39
eH1_0                -2.060020e-01 1 1  ON 40
eH1_1                -1.138104e-01 1 1  ON 41
eH1_2                -7.764008e-02 1 1  ON 42
eH1_3                -5.911001e-02 1 1  ON 43
eH1_4                 1.000751e-02 1 1  ON 44
eH1_5                 5.506382e-02 1 1  ON 45
eH1_6                 9.032975e-02 1 1  ON 46
eH1_7                 6.488754e-02 1 1  ON 47
eH1_8                 7.291751e-04 1 1  ON 48
eH1_9                 6.606036e-02 1 1  ON 49
eH2_0                -2.020042e-01 1 1  ON 50
eH2_1                -1.104236e-01 1 1  ON 51
eH2_2                -7.427864e-02 1 1  ON 52
eH2_3                -5.525674e-02 1 1  ON 53
eH2_4                 1.397800e-02 1 1  ON 54
eH2_5                 5.928961e-02 1 1  ON 55
eH2_6                 9.499336e-02 1 1  ON 56
eH2_7                 7.075841e-02 1 1  ON 57
eH2_8                 9.025323e-03 1 1  ON 58
eH2_9                 6.562192e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1933e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6356
    reference variance = 0.296791
====================================================
  Execution time = 4.4403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1518e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4933e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515335551479
                                         uncertainty =       0.004238741004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515335551479
                                         uncertainty =       0.004238741004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507533662
  error estimate for blocks of size 2^( 2) =       0.000525600222
  error estimate for blocks of size 2^( 3) =       0.000541730742
  error estimate for blocks of size 2^( 4) =       0.000551761474
  error estimate for blocks of size 2^( 5) =       0.000558538175
  error estimate for blocks of size 2^( 6) =       0.000561490421
  error estimate for blocks of size 2^( 7) =       0.000562601469

      target function =                  N/A
              le_mean =     -22.669883298649
             les_mean =     514.438789353882
             stat err =       0.000558597885
             autocorr =       1.211347839364
              std dev =       0.717760988855
             le_variance =       0.515180837122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266988329865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669883298649       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669883791892       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669883954757       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669884367121       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669884778862       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669885065088       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669885003573       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669884897598       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669884903998       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669884891028       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669884908794       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 8.907420e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669883298649       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669883430622       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669883473727       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669883583934       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669883694987       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669883782090       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669883769055       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669883742829       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669883741460       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669883736086       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 2.343484e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669883298649       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669883332232       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669883343184       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669883371246       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669883399593       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669883422535       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669883419550       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669883413028       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669883412552       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669883411036       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 5.958458e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9343e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.942310e-01 1 1  ON 0
 uu_1                 1.188776e-01 1 1  ON 1
 uu_2                 5.441929e-03 1 1  ON 2
 uu_3                -6.182650e-02 1 1  ON 3
 uu_4                -1.021565e-01 1 1  ON 4
 uu_5                -1.277046e-01 1 1  ON 5
 uu_6                -1.427473e-01 1 1  ON 6
 uu_7                -1.473864e-01 1 1  ON 7
 uu_8                -1.391151e-01 1 1  ON 8
 uu_9                -1.164629e-01 1 1  ON 9
 ud_0                 4.094999e-01 1 1  ON 10
 ud_1                 1.275490e-01 1 1  ON 11
 ud_2                -1.866285e-02 1 1  ON 12
 ud_3                -9.640886e-02 1 1  ON 13
 ud_4                -1.387444e-01 1 1  ON 14
 ud_5                -1.633884e-01 1 1  ON 15
 ud_6                -1.759440e-01 1 1  ON 16
 ud_7                -1.766501e-01 1 1  ON 17
 ud_8                -1.632007e-01 1 1  ON 18
 ud_9                -1.342996e-01 1 1  ON 19
 eC_0                -5.796779e-01 1 1  ON 20
 eC_1                -4.282235e-01 1 1  ON 21
 eC_2                -1.767004e-01 1 1  ON 22
 eC_3                -2.236128e-02 1 1  ON 23
 eC_4                 5.689712e-02 1 1  ON 24
 eC_5                 1.564256e-01 1 1  ON 25
 eC_6                 2.538018e-01 1 1  ON 26
 eC_7                 3.752973e-01 1 1  ON 27
 eC_8                 2.775038e-01 1 1  ON 28
 eC_9                 8.003402e-02 1 1  ON 29
 eO_0                -1.180976e+00 1 1  ON 30
 eO_1                -8.043655e-01 1 1  ON 31
 eO_2                -3.395043e-01 1 1  ON 32
 eO_3                 6.845728e-04 1 1  ON 33
 eO_4                 2.232972e-01 1 1  ON 34
 eO_5                 3.863751e-01 1 1  ON 35
 eO_6                 4.294636e-01 1 1  ON 36
 eO_7                 4.259216e-01 1 1  ON 37
 eO_8                 4.142311e-01 1 1  ON 38
 eO_9                 3.085142e-01 1 1  ON 39
eH1_0                -2.060145e-01 1 1  ON 40
eH1_1                -1.138299e-01 1 1  ON 41
eH1_2                -7.764485e-02 1 1  ON 42
eH1_3                -5.910838e-02 1 1  ON 43
eH1_4                 1.001322e-02 1 1  ON 44
eH1_5                 5.507195e-02 1 1  ON 45
eH1_6                 9.032966e-02 1 1  ON 46
eH1_7                 6.489214e-02 1 1  ON 47
eH1_8                 7.479574e-04 1 1  ON 48
eH1_9                 6.605513e-02 1 1  ON 49
eH2_0                -2.020254e-01 1 1  ON 50
eH2_1                -1.104280e-01 1 1  ON 51
eH2_2                -7.427397e-02 1 1  ON 52
eH2_3                -5.527380e-02 1 1  ON 53
eH2_4                 1.399740e-02 1 1  ON 54
eH2_5                 5.928837e-02 1 1  ON 55
eH2_6                 9.499280e-02 1 1  ON 56
eH2_7                 7.075943e-02 1 1  ON 57
eH2_8                 9.042259e-03 1 1  ON 58
eH2_9                 6.561978e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.5986
    reference variance = 0.448148
====================================================
  Execution time = 4.2970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1104e-01
  Total weights = 2.0000e+06
  Execution time = 3.5274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057129577
                                         uncertainty =       0.003169371150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057129577
                                         uncertainty =       0.003169371150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505488152
  error estimate for blocks of size 2^( 2) =       0.000523389765
  error estimate for blocks of size 2^( 3) =       0.000539364837
  error estimate for blocks of size 2^( 4) =       0.000549893451
  error estimate for blocks of size 2^( 5) =       0.000557188717
  error estimate for blocks of size 2^( 6) =       0.000560352870
  error estimate for blocks of size 2^( 7) =       0.000562722706

      target function =                  N/A
              le_mean =     -22.668947173356
             les_mean =     514.392202237443
             stat err =       0.000557539436
             autocorr =       1.216547919653
              std dev =       0.714868200834
             le_variance =       0.511036544564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511056135052
                                         uncertainty =       0.003169190882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511056135052
                                         uncertainty =       0.003169190882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505487671
  error estimate for blocks of size 2^( 2) =       0.000523389314
  error estimate for blocks of size 2^( 3) =       0.000539364448
  error estimate for blocks of size 2^( 4) =       0.000549893840
  error estimate for blocks of size 2^( 5) =       0.000557189580
  error estimate for blocks of size 2^( 6) =       0.000560355496
  error estimate for blocks of size 2^( 7) =       0.000562725381

      target function =                  N/A
              le_mean =     -22.668947618592
             les_mean =     514.392221449802
             stat err =       0.000557541074
             autocorr =       1.216557387239
              std dev =       0.714867519777
             le_variance =       0.511035570832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511059212972
                                         uncertainty =       0.003169274963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511059212972
                                         uncertainty =       0.003169274963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505489188
  error estimate for blocks of size 2^( 2) =       0.000523390755
  error estimate for blocks of size 2^( 3) =       0.000539365825
  error estimate for blocks of size 2^( 4) =       0.000549894876
  error estimate for blocks of size 2^( 5) =       0.000557190481
  error estimate for blocks of size 2^( 6) =       0.000560355544
  error estimate for blocks of size 2^( 7) =       0.000562725660

      target function =                  N/A
              le_mean =     -22.668947378057
             les_mean =     514.392213611796
             stat err =       0.000557541640
             autocorr =       1.216552555320
              std dev =       0.714869665182
             le_variance =       0.511038638197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057428119
                                         uncertainty =       0.003169358871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511057428119
                                         uncertainty =       0.003169358871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505488301
  error estimate for blocks of size 2^( 2) =       0.000523389907
  error estimate for blocks of size 2^( 3) =       0.000539364979
  error estimate for blocks of size 2^( 4) =       0.000549893650
  error estimate for blocks of size 2^( 5) =       0.000557188961
  error estimate for blocks of size 2^( 6) =       0.000560353230
  error estimate for blocks of size 2^( 7) =       0.000562723108

      target function =                  N/A
              le_mean =     -22.668947197066
             les_mean =     514.392203612203
             stat err =       0.000557539738
             autocorr =       1.216548522580
              std dev =       0.714868410528
             le_variance =       0.511036844371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668947173356        initial
     2.5000e+00     2.5000e+01             8.9074e-05       -22.668947618592  <--
     1.0000e+01     1.0000e+02             2.3435e-05       -22.668947378057
     4.0000e+01     4.0000e+02             5.9585e-06       -22.668947197066

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 6.2305e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.942297e-01 1 1  ON 0
 uu_1                 1.188677e-01 1 1  ON 1
 uu_2                 5.438958e-03 1 1  ON 2
 uu_3                -6.181348e-02 1 1  ON 3
 uu_4                -1.021568e-01 1 1  ON 4
 uu_5                -1.277096e-01 1 1  ON 5
 uu_6                -1.427419e-01 1 1  ON 6
 uu_7                -1.473262e-01 1 1  ON 7
 uu_8                -1.391414e-01 1 1  ON 8
 uu_9                -1.164703e-01 1 1  ON 9
 ud_0                 4.095488e-01 1 1  ON 10
 ud_1                 1.275630e-01 1 1  ON 11
 ud_2                -1.861866e-02 1 1  ON 12
 ud_3                -9.640758e-02 1 1  ON 13
 ud_4                -1.387249e-01 1 1  ON 14
 ud_5                -1.634138e-01 1 1  ON 15
 ud_6                -1.759337e-01 1 1  ON 16
 ud_7                -1.766590e-01 1 1  ON 17
 ud_8                -1.632373e-01 1 1  ON 18
 ud_9                -1.343323e-01 1 1  ON 19
 eC_0                -5.797363e-01 1 1  ON 20
 eC_1                -4.282577e-01 1 1  ON 21
 eC_2                -1.767174e-01 1 1  ON 22
 eC_3                -2.238436e-02 1 1  ON 23
 eC_4                 5.693155e-02 1 1  ON 24
 eC_5                 1.564466e-01 1 1  ON 25
 eC_6                 2.538538e-01 1 1  ON 26
 eC_7                 3.752888e-01 1 1  ON 27
 eC_8                 2.775232e-01 1 1  ON 28
 eC_9                 8.004631e-02 1 1  ON 29
 eO_0                -1.180958e+00 1 1  ON 30
 eO_1                -8.043837e-01 1 1  ON 31
 eO_2                -3.395700e-01 1 1  ON 32
 eO_3                 6.611512e-04 1 1  ON 33
 eO_4                 2.233242e-01 1 1  ON 34
 eO_5                 3.863617e-01 1 1  ON 35
 eO_6                 4.294986e-01 1 1  ON 36
 eO_7                 4.259530e-01 1 1  ON 37
 eO_8                 4.141997e-01 1 1  ON 38
 eO_9                 3.085281e-01 1 1  ON 39
eH1_0                -2.060524e-01 1 1  ON 40
eH1_1                -1.138845e-01 1 1  ON 41
eH1_2                -7.765964e-02 1 1  ON 42
eH1_3                -5.910414e-02 1 1  ON 43
eH1_4                 1.002900e-02 1 1  ON 44
eH1_5                 5.509376e-02 1 1  ON 45
eH1_6                 9.032945e-02 1 1  ON 46
eH1_7                 6.490585e-02 1 1  ON 47
eH1_8                 8.058804e-04 1 1  ON 48
eH1_9                 6.603905e-02 1 1  ON 49
eH2_0                -2.020879e-01 1 1  ON 50
eH2_1                -1.104394e-01 1 1  ON 51
eH2_2                -7.426474e-02 1 1  ON 52
eH2_3                -5.532069e-02 1 1  ON 53
eH2_4                 1.404971e-02 1 1  ON 54
eH2_5                 5.928738e-02 1 1  ON 55
eH2_6                 9.499012e-02 1 1  ON 56
eH2_7                 7.076223e-02 1 1  ON 57
eH2_8                 9.094644e-03 1 1  ON 58
eH2_9                 6.561329e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2169e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6976
    reference variance = 2.61766
====================================================
  Execution time = 4.5044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0770e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5261e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507663067221
                                         uncertainty =       0.004449631281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507663067221
                                         uncertainty =       0.004449631281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503836947
  error estimate for blocks of size 2^( 2) =       0.000521580448
  error estimate for blocks of size 2^( 3) =       0.000536635814
  error estimate for blocks of size 2^( 4) =       0.000547644308
  error estimate for blocks of size 2^( 5) =       0.000554383885
  error estimate for blocks of size 2^( 6) =       0.000555606423
  error estimate for blocks of size 2^( 7) =       0.000557742453

      target function =                  N/A
              le_mean =     -22.669783830031
             les_mean =     514.426801984252
             stat err =       0.000553844267
             autocorr =       1.208357123960
              std dev =       0.712533043279
             le_variance =       0.507703337765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266978383003e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669783830031       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669784524748       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669784500541       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669784929823       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669785182600       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669785891385       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669785777358       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669785127171       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669785388506       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669785481369       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669785521564       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669785570254       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.045629e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669783830031       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669784036984       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669784044641       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669784181227       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669784187949       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669784437793       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669784411830       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669784234057       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669784278085       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669784328191       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669784328478       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 1.048788e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669783830031       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669783884372       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669783887758       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669783924946       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669783921168       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669783988790       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669783983659       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669783938908       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669783946490       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669783961892       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669783962455       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 2.917067e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0313e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.942543e-01 1 1  ON 0
 uu_1                 1.188859e-01 1 1  ON 1
 uu_2                 5.424010e-03 1 1  ON 2
 uu_3                -6.181809e-02 1 1  ON 3
 uu_4                -1.021298e-01 1 1  ON 4
 uu_5                -1.277404e-01 1 1  ON 5
 uu_6                -1.427691e-01 1 1  ON 6
 uu_7                -1.472881e-01 1 1  ON 7
 uu_8                -1.391487e-01 1 1  ON 8
 uu_9                -1.164581e-01 1 1  ON 9
 ud_0                 4.096537e-01 1 1  ON 10
 ud_1                 1.275759e-01 1 1  ON 11
 ud_2                -1.860018e-02 1 1  ON 12
 ud_3                -9.642456e-02 1 1  ON 13
 ud_4                -1.387378e-01 1 1  ON 14
 ud_5                -1.634320e-01 1 1  ON 15
 ud_6                -1.759472e-01 1 1  ON 16
 ud_7                -1.766219e-01 1 1  ON 17
 ud_8                -1.632730e-01 1 1  ON 18
 ud_9                -1.343328e-01 1 1  ON 19
 eC_0                -5.797939e-01 1 1  ON 20
 eC_1                -4.283360e-01 1 1  ON 21
 eC_2                -1.767390e-01 1 1  ON 22
 eC_3                -2.239628e-02 1 1  ON 23
 eC_4                 5.695418e-02 1 1  ON 24
 eC_5                 1.564786e-01 1 1  ON 25
 eC_6                 2.539079e-01 1 1  ON 26
 eC_7                 3.752886e-01 1 1  ON 27
 eC_8                 2.775663e-01 1 1  ON 28
 eC_9                 8.006508e-02 1 1  ON 29
 eO_0                -1.180988e+00 1 1  ON 30
 eO_1                -8.044445e-01 1 1  ON 31
 eO_2                -3.395869e-01 1 1  ON 32
 eO_3                 6.276420e-04 1 1  ON 33
 eO_4                 2.233497e-01 1 1  ON 34
 eO_5                 3.863982e-01 1 1  ON 35
 eO_6                 4.295311e-01 1 1  ON 36
 eO_7                 4.259840e-01 1 1  ON 37
 eO_8                 4.141515e-01 1 1  ON 38
 eO_9                 3.085603e-01 1 1  ON 39
eH1_0                -2.061032e-01 1 1  ON 40
eH1_1                -1.139569e-01 1 1  ON 41
eH1_2                -7.770215e-02 1 1  ON 42
eH1_3                -5.910663e-02 1 1  ON 43
eH1_4                 1.004423e-02 1 1  ON 44
eH1_5                 5.512899e-02 1 1  ON 45
eH1_6                 9.033592e-02 1 1  ON 46
eH1_7                 6.495085e-02 1 1  ON 47
eH1_8                 8.764859e-04 1 1  ON 48
eH1_9                 6.601700e-02 1 1  ON 49
eH2_0                -2.021082e-01 1 1  ON 50
eH2_1                -1.104865e-01 1 1  ON 51
eH2_2                -7.426983e-02 1 1  ON 52
eH2_3                -5.534989e-02 1 1  ON 53
eH2_4                 1.406450e-02 1 1  ON 54
eH2_5                 5.928044e-02 1 1  ON 55
eH2_6                 9.500710e-02 1 1  ON 56
eH2_7                 7.074302e-02 1 1  ON 57
eH2_8                 9.162355e-03 1 1  ON 58
eH2_9                 6.561196e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6804
    reference variance = 0.232219
====================================================
  Execution time = 4.2789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0590e-01
  Total weights = 2.0000e+06
  Execution time = 3.5239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505893298552
                                         uncertainty =       0.002941689750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505893298552
                                         uncertainty =       0.002941689750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502879712
  error estimate for blocks of size 2^( 2) =       0.000520315521
  error estimate for blocks of size 2^( 3) =       0.000536382304
  error estimate for blocks of size 2^( 4) =       0.000548290289
  error estimate for blocks of size 2^( 5) =       0.000554887800
  error estimate for blocks of size 2^( 6) =       0.000558186356
  error estimate for blocks of size 2^( 7) =       0.000562051743

      target function =                  N/A
              le_mean =     -22.669648103132
             les_mean =     514.418720876249
             stat err =       0.000555854047
             autocorr =       1.221780850939
              std dev =       0.711179308827
             le_variance =       0.505776009304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506233969625
                                         uncertainty =       0.002942588519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506233969625
                                         uncertainty =       0.002942588519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503048916
  error estimate for blocks of size 2^( 2) =       0.000520475110
  error estimate for blocks of size 2^( 3) =       0.000536530133
  error estimate for blocks of size 2^( 4) =       0.000548431390
  error estimate for blocks of size 2^( 5) =       0.000555018972
  error estimate for blocks of size 2^( 6) =       0.000558315359
  error estimate for blocks of size 2^( 7) =       0.000562184324

      target function =                  N/A
              le_mean =     -22.669648706346
             les_mean =     514.419088640170
             stat err =       0.000555987511
             autocorr =       1.221545470615
              std dev =       0.711418599751
             le_variance =       0.506116424071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506137544245
                                         uncertainty =       0.002942468152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506137544245
                                         uncertainty =       0.002942468152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503001035
  error estimate for blocks of size 2^( 2) =       0.000520429879
  error estimate for blocks of size 2^( 3) =       0.000536488570
  error estimate for blocks of size 2^( 4) =       0.000548391970
  error estimate for blocks of size 2^( 5) =       0.000554982470
  error estimate for blocks of size 2^( 6) =       0.000558279899
  error estimate for blocks of size 2^( 7) =       0.000562147866

      target function =                  N/A
              le_mean =     -22.669648431402
             les_mean =     514.418979831893
             stat err =       0.000555950551
             autocorr =       1.221615610580
              std dev =       0.711350884977
             le_variance =       0.506020081557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505927531926
                                         uncertainty =       0.002941805980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505927531926
                                         uncertainty =       0.002941805980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502896718
  error estimate for blocks of size 2^( 2) =       0.000520331542
  error estimate for blocks of size 2^( 3) =       0.000536397200
  error estimate for blocks of size 2^( 4) =       0.000548304547
  error estimate for blocks of size 2^( 5) =       0.000554901077
  error estimate for blocks of size 2^( 6) =       0.000558199499
  error estimate for blocks of size 2^( 7) =       0.000562065250

      target function =                  N/A
              le_mean =     -22.669648130201
             les_mean =     514.418756313070
             stat err =       0.000555867593
             autocorr =       1.221757765128
              std dev =       0.711203359694
             le_variance =       0.505810218840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669648103132        initial
     6.2500e-01     6.2500e+00             3.0456e-04       -22.669648706346  <--
     2.5000e+00     2.5000e+01             1.0488e-04       -22.669648431402
     1.0000e+01     1.0000e+02             2.9171e-05       -22.669648130201

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 6.0446e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.943092e-01 1 1  ON 0
 uu_1                 1.189211e-01 1 1  ON 1
 uu_2                 5.402673e-03 1 1  ON 2
 uu_3                -6.181794e-02 1 1  ON 3
 uu_4                -1.020925e-01 1 1  ON 4
 uu_5                -1.277897e-01 1 1  ON 5
 uu_6                -1.428409e-01 1 1  ON 6
 uu_7                -1.472099e-01 1 1  ON 7
 uu_8                -1.391550e-01 1 1  ON 8
 uu_9                -1.164128e-01 1 1  ON 9
 ud_0                 4.098533e-01 1 1  ON 10
 ud_1                 1.276442e-01 1 1  ON 11
 ud_2                -1.854995e-02 1 1  ON 12
 ud_3                -9.643654e-02 1 1  ON 13
 ud_4                -1.387673e-01 1 1  ON 14
 ud_5                -1.634630e-01 1 1  ON 15
 ud_6                -1.759759e-01 1 1  ON 16
 ud_7                -1.765377e-01 1 1  ON 17
 ud_8                -1.633561e-01 1 1  ON 18
 ud_9                -1.343260e-01 1 1  ON 19
 eC_0                -5.799728e-01 1 1  ON 20
 eC_1                -4.285387e-01 1 1  ON 21
 eC_2                -1.768205e-01 1 1  ON 22
 eC_3                -2.243698e-02 1 1  ON 23
 eC_4                 5.701424e-02 1 1  ON 24
 eC_5                 1.565729e-01 1 1  ON 25
 eC_6                 2.540708e-01 1 1  ON 26
 eC_7                 3.752904e-01 1 1  ON 27
 eC_8                 2.776970e-01 1 1  ON 28
 eC_9                 8.012185e-02 1 1  ON 29
 eO_0                -1.181111e+00 1 1  ON 30
 eO_1                -8.045906e-01 1 1  ON 31
 eO_2                -3.396658e-01 1 1  ON 32
 eO_3                 5.466409e-04 1 1  ON 33
 eO_4                 2.234196e-01 1 1  ON 34
 eO_5                 3.865082e-01 1 1  ON 35
 eO_6                 4.296277e-01 1 1  ON 36
 eO_7                 4.260830e-01 1 1  ON 37
 eO_8                 4.140117e-01 1 1  ON 38
 eO_9                 3.086586e-01 1 1  ON 39
eH1_0                -2.062606e-01 1 1  ON 40
eH1_1                -1.141501e-01 1 1  ON 41
eH1_2                -7.782886e-02 1 1  ON 42
eH1_3                -5.911779e-02 1 1  ON 43
eH1_4                 1.008887e-02 1 1  ON 44
eH1_5                 5.522169e-02 1 1  ON 45
eH1_6                 9.036000e-02 1 1  ON 46
eH1_7                 6.507842e-02 1 1  ON 47
eH1_8                 1.087536e-03 1 1  ON 48
eH1_9                 6.595148e-02 1 1  ON 49
eH2_0                -2.021731e-01 1 1  ON 50
eH2_1                -1.106093e-01 1 1  ON 51
eH2_2                -7.430424e-02 1 1  ON 52
eH2_3                -5.541804e-02 1 1  ON 53
eH2_4                 1.409356e-02 1 1  ON 54
eH2_5                 5.927204e-02 1 1  ON 55
eH2_6                 9.504415e-02 1 1  ON 56
eH2_7                 7.068587e-02 1 1  ON 57
eH2_8                 9.365477e-03 1 1  ON 58
eH2_9                 6.560884e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2079e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7511
    reference variance = 0.402209
====================================================
  Execution time = 4.3427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0906e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5103e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509061918301
                                         uncertainty =       0.003818200377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509061918301
                                         uncertainty =       0.003818200377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504510471
  error estimate for blocks of size 2^( 2) =       0.000522015611
  error estimate for blocks of size 2^( 3) =       0.000537580260
  error estimate for blocks of size 2^( 4) =       0.000548085842
  error estimate for blocks of size 2^( 5) =       0.000556066972
  error estimate for blocks of size 2^( 6) =       0.000559685769
  error estimate for blocks of size 2^( 7) =       0.000561420528

      target function =                  N/A
              le_mean =     -22.669527438085
             les_mean =     514.416535641448
             stat err =       0.000556314778
             autocorr =       1.215908305860
              std dev =       0.713485549881
             le_variance =       0.509061629890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266952743809e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669527438085       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669528183782       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669529233782       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669530938284       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669533212803       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669531510632       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669531404993       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669531851962       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669530318392       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669529987433       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669531459539       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669531333789       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669531838025       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669531603294       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.277314e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669527438085       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669527752546       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669528052499       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669528796733       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669530052080       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669529804228       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669529049358       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669529250463       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669529189914       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669529075700       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669529239261       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669529306101       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.599296e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669527438085       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669527532997       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669527609407       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669527828560       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669528217484       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669528280556       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669528030965       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669528067652       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669528042712       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669528043122       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669528075227       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 9.306290e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8540e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.943858e-01 1 1  ON 0
 uu_1                 1.188529e-01 1 1  ON 1
 uu_2                 5.354632e-03 1 1  ON 2
 uu_3                -6.185281e-02 1 1  ON 3
 uu_4                -1.020936e-01 1 1  ON 4
 uu_5                -1.277211e-01 1 1  ON 5
 uu_6                -1.427528e-01 1 1  ON 6
 uu_7                -1.471385e-01 1 1  ON 7
 uu_8                -1.392422e-01 1 1  ON 8
 uu_9                -1.163923e-01 1 1  ON 9
 ud_0                 4.100691e-01 1 1  ON 10
 ud_1                 1.278715e-01 1 1  ON 11
 ud_2                -1.844763e-02 1 1  ON 12
 ud_3                -9.629869e-02 1 1  ON 13
 ud_4                -1.387315e-01 1 1  ON 14
 ud_5                -1.634272e-01 1 1  ON 15
 ud_6                -1.760324e-01 1 1  ON 16
 ud_7                -1.767625e-01 1 1  ON 17
 ud_8                -1.636381e-01 1 1  ON 18
 ud_9                -1.343777e-01 1 1  ON 19
 eC_0                -5.801281e-01 1 1  ON 20
 eC_1                -4.287079e-01 1 1  ON 21
 eC_2                -1.769406e-01 1 1  ON 22
 eC_3                -2.260788e-02 1 1  ON 23
 eC_4                 5.709266e-02 1 1  ON 24
 eC_5                 1.566696e-01 1 1  ON 25
 eC_6                 2.542877e-01 1 1  ON 26
 eC_7                 3.752524e-01 1 1  ON 27
 eC_8                 2.778531e-01 1 1  ON 28
 eC_9                 8.021493e-02 1 1  ON 29
 eO_0                -1.181378e+00 1 1  ON 30
 eO_1                -8.046672e-01 1 1  ON 31
 eO_2                -3.397674e-01 1 1  ON 32
 eO_3                 4.284501e-04 1 1  ON 33
 eO_4                 2.234416e-01 1 1  ON 34
 eO_5                 3.865464e-01 1 1  ON 35
 eO_6                 4.299877e-01 1 1  ON 36
 eO_7                 4.262356e-01 1 1  ON 37
 eO_8                 4.137536e-01 1 1  ON 38
 eO_9                 3.087568e-01 1 1  ON 39
eH1_0                -2.063337e-01 1 1  ON 40
eH1_1                -1.144395e-01 1 1  ON 41
eH1_2                -7.797672e-02 1 1  ON 42
eH1_3                -5.912369e-02 1 1  ON 43
eH1_4                 1.013207e-02 1 1  ON 44
eH1_5                 5.528995e-02 1 1  ON 45
eH1_6                 9.026165e-02 1 1  ON 46
eH1_7                 6.515440e-02 1 1  ON 47
eH1_8                 1.404826e-03 1 1  ON 48
eH1_9                 6.592474e-02 1 1  ON 49
eH2_0                -2.022636e-01 1 1  ON 50
eH2_1                -1.107190e-01 1 1  ON 51
eH2_2                -7.439845e-02 1 1  ON 52
eH2_3                -5.543023e-02 1 1  ON 53
eH2_4                 1.420342e-02 1 1  ON 54
eH2_5                 5.931765e-02 1 1  ON 55
eH2_6                 9.500732e-02 1 1  ON 56
eH2_7                 7.059937e-02 1 1  ON 57
eH2_8                 9.610803e-03 1 1  ON 58
eH2_9                 6.555664e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7382
    reference variance = 0.711528
====================================================
  Execution time = 4.3100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1096e-01
  Total weights = 2.0000e+06
  Execution time = 3.5295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510892003868
                                         uncertainty =       0.003395387135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510892003868
                                         uncertainty =       0.003395387135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505360451
  error estimate for blocks of size 2^( 2) =       0.000523106392
  error estimate for blocks of size 2^( 3) =       0.000538433057
  error estimate for blocks of size 2^( 4) =       0.000549926630
  error estimate for blocks of size 2^( 5) =       0.000556254109
  error estimate for blocks of size 2^( 6) =       0.000559360603
  error estimate for blocks of size 2^( 7) =       0.000559164425

      target function =                  N/A
              le_mean =     -22.669678361319
             les_mean =     514.425095121988
             stat err =       0.000556176442
             autocorr =       1.211219000025
              std dev =       0.714687604279
             le_variance =       0.510778371710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511293838087
                                         uncertainty =       0.003399060560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511293838087
                                         uncertainty =       0.003399060560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505559155
  error estimate for blocks of size 2^( 2) =       0.000523293049
  error estimate for blocks of size 2^( 3) =       0.000538604126
  error estimate for blocks of size 2^( 4) =       0.000550084852
  error estimate for blocks of size 2^( 5) =       0.000556402088
  error estimate for blocks of size 2^( 6) =       0.000559511697
  error estimate for blocks of size 2^( 7) =       0.000559330015

      target function =                  N/A
              le_mean =     -22.669675648513
             les_mean =     514.425373872429
             stat err =       0.000556332163
             autocorr =       1.210944885950
              std dev =       0.714968614172
             le_variance =       0.511180119251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511257525213
                                         uncertainty =       0.003398167408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511257525213
                                         uncertainty =       0.003398167408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505541223
  error estimate for blocks of size 2^( 2) =       0.000523275961
  error estimate for blocks of size 2^( 3) =       0.000538588929
  error estimate for blocks of size 2^( 4) =       0.000550070437
  error estimate for blocks of size 2^( 5) =       0.000556388407
  error estimate for blocks of size 2^( 6) =       0.000559497964
  error estimate for blocks of size 2^( 7) =       0.000559311009

      target function =                  N/A
              le_mean =     -22.669674973519
             les_mean =     514.425307005203
             stat err =       0.000556316954
             autocorr =       1.210964585664
              std dev =       0.714943253538
             le_variance =       0.511143855780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510949286741
                                         uncertainty =       0.003395786834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510949286741
                                         uncertainty =       0.003395786834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505388788
  error estimate for blocks of size 2^( 2) =       0.000523132834
  error estimate for blocks of size 2^( 3) =       0.000538457255
  error estimate for blocks of size 2^( 4) =       0.000549948806
  error estimate for blocks of size 2^( 5) =       0.000556274788
  error estimate for blocks of size 2^( 6) =       0.000559381982
  error estimate for blocks of size 2^( 7) =       0.000559186829

      target function =                  N/A
              le_mean =     -22.669677628800
             les_mean =     514.425119191892
             stat err =       0.000556198101
             autocorr =       1.211177510519
              std dev =       0.714727677940
             le_variance =       0.510835653613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669678361319        initial  <--
     1.5625e-01     1.5625e+00             1.2773e-03       -22.669675648513
     6.2500e-01     6.2500e+00             3.5993e-04       -22.669674973519
     2.5000e+00     2.5000e+01             9.3063e-05       -22.669677628800

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7759
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.943092e-01 1 1  ON 0
 uu_1                 1.189211e-01 1 1  ON 1
 uu_2                 5.402673e-03 1 1  ON 2
 uu_3                -6.181794e-02 1 1  ON 3
 uu_4                -1.020925e-01 1 1  ON 4
 uu_5                -1.277897e-01 1 1  ON 5
 uu_6                -1.428409e-01 1 1  ON 6
 uu_7                -1.472099e-01 1 1  ON 7
 uu_8                -1.391550e-01 1 1  ON 8
 uu_9                -1.164128e-01 1 1  ON 9
 ud_0                 4.098533e-01 1 1  ON 10
 ud_1                 1.276442e-01 1 1  ON 11
 ud_2                -1.854995e-02 1 1  ON 12
 ud_3                -9.643654e-02 1 1  ON 13
 ud_4                -1.387673e-01 1 1  ON 14
 ud_5                -1.634630e-01 1 1  ON 15
 ud_6                -1.759759e-01 1 1  ON 16
 ud_7                -1.765377e-01 1 1  ON 17
 ud_8                -1.633561e-01 1 1  ON 18
 ud_9                -1.343260e-01 1 1  ON 19
 eC_0                -5.799728e-01 1 1  ON 20
 eC_1                -4.285387e-01 1 1  ON 21
 eC_2                -1.768205e-01 1 1  ON 22
 eC_3                -2.243698e-02 1 1  ON 23
 eC_4                 5.701424e-02 1 1  ON 24
 eC_5                 1.565729e-01 1 1  ON 25
 eC_6                 2.540708e-01 1 1  ON 26
 eC_7                 3.752904e-01 1 1  ON 27
 eC_8                 2.776970e-01 1 1  ON 28
 eC_9                 8.012185e-02 1 1  ON 29
 eO_0                -1.181111e+00 1 1  ON 30
 eO_1                -8.045906e-01 1 1  ON 31
 eO_2                -3.396658e-01 1 1  ON 32
 eO_3                 5.466409e-04 1 1  ON 33
 eO_4                 2.234196e-01 1 1  ON 34
 eO_5                 3.865082e-01 1 1  ON 35
 eO_6                 4.296277e-01 1 1  ON 36
 eO_7                 4.260830e-01 1 1  ON 37
 eO_8                 4.140117e-01 1 1  ON 38
 eO_9                 3.086586e-01 1 1  ON 39
eH1_0                -2.062606e-01 1 1  ON 40
eH1_1                -1.141501e-01 1 1  ON 41
eH1_2                -7.782886e-02 1 1  ON 42
eH1_3                -5.911779e-02 1 1  ON 43
eH1_4                 1.008887e-02 1 1  ON 44
eH1_5                 5.522169e-02 1 1  ON 45
eH1_6                 9.036000e-02 1 1  ON 46
eH1_7                 6.507842e-02 1 1  ON 47
eH1_8                 1.087536e-03 1 1  ON 48
eH1_9                 6.595148e-02 1 1  ON 49
eH2_0                -2.021731e-01 1 1  ON 50
eH2_1                -1.106093e-01 1 1  ON 51
eH2_2                -7.430424e-02 1 1  ON 52
eH2_3                -5.541804e-02 1 1  ON 53
eH2_4                 1.409356e-02 1 1  ON 54
eH2_5                 5.927204e-02 1 1  ON 55
eH2_6                 9.504415e-02 1 1  ON 56
eH2_7                 7.068587e-02 1 1  ON 57
eH2_8                 9.365477e-03 1 1  ON 58
eH2_9                 6.560884e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1932e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6375
    reference variance = 0.332301
====================================================
  Execution time = 4.3677e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0366e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5578e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503674342245
                                         uncertainty =       0.003183574413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503674342245
                                         uncertainty =       0.003183574413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501826824
  error estimate for blocks of size 2^( 2) =       0.000519526158
  error estimate for blocks of size 2^( 3) =       0.000535793795
  error estimate for blocks of size 2^( 4) =       0.000546895851
  error estimate for blocks of size 2^( 5) =       0.000554725077
  error estimate for blocks of size 2^( 6) =       0.000560213540
  error estimate for blocks of size 2^( 7) =       0.000563385712

      target function =                  N/A
              le_mean =     -22.668447728969
             les_mean =     514.362182511837
             stat err =       0.000556305045
             autocorr =       1.228904835680
              std dev =       0.709690300547
             le_variance =       0.503660322690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266844772897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668447728968       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668448163818       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668448712207       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668448852769       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668448720844       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668449037159       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668449218526       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668449170942       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668449111970       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668449060908       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668449057173       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.322587e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668447728968       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668447847851       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668448012494       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668448045931       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668448000212       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668448045345       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668448114750       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668448113510       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668448097095       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668448087208       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.668448088475       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 3.436017e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668447728968       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668447759401       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668447802763       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668447811025       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668447798794       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668447807333       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668447825973       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668447826278       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668447822179       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668447820025       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 8.616976e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9262e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.943395e-01 1 1  ON 0
 uu_1                 1.189286e-01 1 1  ON 1
 uu_2                 5.395707e-03 1 1  ON 2
 uu_3                -6.181608e-02 1 1  ON 3
 uu_4                -1.020939e-01 1 1  ON 4
 uu_5                -1.277907e-01 1 1  ON 5
 uu_6                -1.428492e-01 1 1  ON 6
 uu_7                -1.471990e-01 1 1  ON 7
 uu_8                -1.391697e-01 1 1  ON 8
 uu_9                -1.164170e-01 1 1  ON 9
 ud_0                 4.098714e-01 1 1  ON 10
 ud_1                 1.276557e-01 1 1  ON 11
 ud_2                -1.854989e-02 1 1  ON 12
 ud_3                -9.642624e-02 1 1  ON 13
 ud_4                -1.387744e-01 1 1  ON 14
 ud_5                -1.634584e-01 1 1  ON 15
 ud_6                -1.759739e-01 1 1  ON 16
 ud_7                -1.765378e-01 1 1  ON 17
 ud_8                -1.633692e-01 1 1  ON 18
 ud_9                -1.343323e-01 1 1  ON 19
 eC_0                -5.800072e-01 1 1  ON 20
 eC_1                -4.285379e-01 1 1  ON 21
 eC_2                -1.768280e-01 1 1  ON 22
 eC_3                -2.245129e-02 1 1  ON 23
 eC_4                 5.702138e-02 1 1  ON 24
 eC_5                 1.565863e-01 1 1  ON 25
 eC_6                 2.540876e-01 1 1  ON 26
 eC_7                 3.752861e-01 1 1  ON 27
 eC_8                 2.777113e-01 1 1  ON 28
 eC_9                 8.012914e-02 1 1  ON 29
 eO_0                -1.181130e+00 1 1  ON 30
 eO_1                -8.045968e-01 1 1  ON 31
 eO_2                -3.396615e-01 1 1  ON 32
 eO_3                 5.268564e-04 1 1  ON 33
 eO_4                 2.234073e-01 1 1  ON 34
 eO_5                 3.865203e-01 1 1  ON 35
 eO_6                 4.296381e-01 1 1  ON 36
 eO_7                 4.261026e-01 1 1  ON 37
 eO_8                 4.139984e-01 1 1  ON 38
 eO_9                 3.086693e-01 1 1  ON 39
eH1_0                -2.062880e-01 1 1  ON 40
eH1_1                -1.141476e-01 1 1  ON 41
eH1_2                -7.783963e-02 1 1  ON 42
eH1_3                -5.912080e-02 1 1  ON 43
eH1_4                 1.011367e-02 1 1  ON 44
eH1_5                 5.522167e-02 1 1  ON 45
eH1_6                 9.035491e-02 1 1  ON 46
eH1_7                 6.508296e-02 1 1  ON 47
eH1_8                 1.103360e-03 1 1  ON 48
eH1_9                 6.594263e-02 1 1  ON 49
eH2_0                -2.021914e-01 1 1  ON 50
eH2_1                -1.106241e-01 1 1  ON 51
eH2_2                -7.429681e-02 1 1  ON 52
eH2_3                -5.543611e-02 1 1  ON 53
eH2_4                 1.409452e-02 1 1  ON 54
eH2_5                 5.928395e-02 1 1  ON 55
eH2_6                 9.504633e-02 1 1  ON 56
eH2_7                 7.067672e-02 1 1  ON 57
eH2_8                 9.391369e-03 1 1  ON 58
eH2_9                 6.561056e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.5527
    reference variance = 0.512776
====================================================
  Execution time = 4.4536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0967e-01
  Total weights = 2.0000e+06
  Execution time = 3.5289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509678955261
                                         uncertainty =       0.003203025809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509678955261
                                         uncertainty =       0.003203025809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504792774
  error estimate for blocks of size 2^( 2) =       0.000521744728
  error estimate for blocks of size 2^( 3) =       0.000537235520
  error estimate for blocks of size 2^( 4) =       0.000549614881
  error estimate for blocks of size 2^( 5) =       0.000556748659
  error estimate for blocks of size 2^( 6) =       0.000560506112
  error estimate for blocks of size 2^( 7) =       0.000561348428

      target function =                  N/A
              le_mean =     -22.669775117368
             les_mean =     514.428335105875
             stat err =       0.000557054520
             autocorr =       1.217780867154
              std dev =       0.713884786672
             le_variance =       0.509631488641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509801844384
                                         uncertainty =       0.003203905504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509801844384
                                         uncertainty =       0.003203905504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504853654
  error estimate for blocks of size 2^( 2) =       0.000521802307
  error estimate for blocks of size 2^( 3) =       0.000537290649
  error estimate for blocks of size 2^( 4) =       0.000549668044
  error estimate for blocks of size 2^( 5) =       0.000556801210
  error estimate for blocks of size 2^( 6) =       0.000560558021
  error estimate for blocks of size 2^( 7) =       0.000561400388

      target function =                  N/A
              le_mean =     -22.669775665343
             les_mean =     514.428482885230
             stat err =       0.000557106916
             autocorr =       1.217716223456
              std dev =       0.713970883943
             le_variance =       0.509754423119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509749970908
                                         uncertainty =       0.003203528713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509749970908
                                         uncertainty =       0.003203528713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504827956
  error estimate for blocks of size 2^( 2) =       0.000521777951
  error estimate for blocks of size 2^( 3) =       0.000537267376
  error estimate for blocks of size 2^( 4) =       0.000549645591
  error estimate for blocks of size 2^( 5) =       0.000556778960
  error estimate for blocks of size 2^( 6) =       0.000560536027
  error estimate for blocks of size 2^( 7) =       0.000561378457

      target function =                  N/A
              le_mean =     -22.669775405209
             les_mean =     514.428419198481
             stat err =       0.000557084759
             autocorr =       1.217743329570
              std dev =       0.713934542310
             le_variance =       0.509702530704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509688038851
                                         uncertainty =       0.003203089643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509688038851
                                         uncertainty =       0.003203089643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504797274
  error estimate for blocks of size 2^( 2) =       0.000521748977
  error estimate for blocks of size 2^( 3) =       0.000537239599
  error estimate for blocks of size 2^( 4) =       0.000549618810
  error estimate for blocks of size 2^( 5) =       0.000556752533
  error estimate for blocks of size 2^( 6) =       0.000560509941
  error estimate for blocks of size 2^( 7) =       0.000561352268

      target function =                  N/A
              le_mean =     -22.669775151614
             les_mean =     514.428345745468
             stat err =       0.000557058388
             autocorr =       1.217776066720
              std dev =       0.713891151060
             le_variance =       0.509640575562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669775117368        initial
     1.5625e+00     1.5625e+01             1.3226e-04       -22.669775665343  <--
     6.2500e+00     6.2500e+01             3.4360e-05       -22.669775405209
     2.5000e+01     2.5000e+02             8.6170e-06       -22.669775151614

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 6.2228e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.944209e-01 1 1  ON 0
 uu_1                 1.189461e-01 1 1  ON 1
 uu_2                 5.383515e-03 1 1  ON 2
 uu_3                -6.181278e-02 1 1  ON 3
 uu_4                -1.020951e-01 1 1  ON 4
 uu_5                -1.277938e-01 1 1  ON 5
 uu_6                -1.428684e-01 1 1  ON 6
 uu_7                -1.471702e-01 1 1  ON 7
 uu_8                -1.392107e-01 1 1  ON 8
 uu_9                -1.164292e-01 1 1  ON 9
 ud_0                 4.099200e-01 1 1  ON 10
 ud_1                 1.276855e-01 1 1  ON 11
 ud_2                -1.854342e-02 1 1  ON 12
 ud_3                -9.640223e-02 1 1  ON 13
 ud_4                -1.387865e-01 1 1  ON 14
 ud_5                -1.634492e-01 1 1  ON 15
 ud_6                -1.759674e-01 1 1  ON 16
 ud_7                -1.765371e-01 1 1  ON 17
 ud_8                -1.634062e-01 1 1  ON 18
 ud_9                -1.343506e-01 1 1  ON 19
 eC_0                -5.801051e-01 1 1  ON 20
 eC_1                -4.285381e-01 1 1  ON 21
 eC_2                -1.768518e-01 1 1  ON 22
 eC_3                -2.249151e-02 1 1  ON 23
 eC_4                 5.703933e-02 1 1  ON 24
 eC_5                 1.566277e-01 1 1  ON 25
 eC_6                 2.541373e-01 1 1  ON 26
 eC_7                 3.752734e-01 1 1  ON 27
 eC_8                 2.777533e-01 1 1  ON 28
 eC_9                 8.015058e-02 1 1  ON 29
 eO_0                -1.181184e+00 1 1  ON 30
 eO_1                -8.046136e-01 1 1  ON 31
 eO_2                -3.396554e-01 1 1  ON 32
 eO_3                 4.726984e-04 1 1  ON 33
 eO_4                 2.233725e-01 1 1  ON 34
 eO_5                 3.865543e-01 1 1  ON 35
 eO_6                 4.296692e-01 1 1  ON 36
 eO_7                 4.261609e-01 1 1  ON 37
 eO_8                 4.139595e-01 1 1  ON 38
 eO_9                 3.087007e-01 1 1  ON 39
eH1_0                -2.063668e-01 1 1  ON 40
eH1_1                -1.141422e-01 1 1  ON 41
eH1_2                -7.786979e-02 1 1  ON 42
eH1_3                -5.912742e-02 1 1  ON 43
eH1_4                 1.017902e-02 1 1  ON 44
eH1_5                 5.522623e-02 1 1  ON 45
eH1_6                 9.033892e-02 1 1  ON 46
eH1_7                 6.509675e-02 1 1  ON 47
eH1_8                 1.149869e-03 1 1  ON 48
eH1_9                 6.591655e-02 1 1  ON 49
eH2_0                -2.022445e-01 1 1  ON 50
eH2_1                -1.106653e-01 1 1  ON 51
eH2_2                -7.427959e-02 1 1  ON 52
eH2_3                -5.548633e-02 1 1  ON 53
eH2_4                 1.409727e-02 1 1  ON 54
eH2_5                 5.931614e-02 1 1  ON 55
eH2_6                 9.505344e-02 1 1  ON 56
eH2_7                 7.065093e-02 1 1  ON 57
eH2_8                 9.467378e-03 1 1  ON 58
eH2_9                 6.561562e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2150e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6021
    reference variance = 0.498557
====================================================
  Execution time = 4.4067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0417e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4960e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504062007389
                                         uncertainty =       0.002721574193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504062007389
                                         uncertainty =       0.002721574193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502079229
  error estimate for blocks of size 2^( 2) =       0.000519631672
  error estimate for blocks of size 2^( 3) =       0.000535965764
  error estimate for blocks of size 2^( 4) =       0.000547415923
  error estimate for blocks of size 2^( 5) =       0.000554497562
  error estimate for blocks of size 2^( 6) =       0.000559632872
  error estimate for blocks of size 2^( 7) =       0.000563036145

      target function =                  N/A
              le_mean =     -22.670720812795
             les_mean =     514.465749024606
             stat err =       0.000556145625
             autocorr =       1.226966033859
              std dev =       0.710047255466
             le_variance =       0.504167104995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267072081279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670720812795       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670722184397       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670721506947       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670723324556       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670722816379       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670723472068       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670723709351       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670723460331       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670722837330       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670723033900       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670723315878       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670723310723       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.670723358642       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.312361e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670720812795       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670721265526       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670721046778       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670721648590       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670721466187       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670721586915       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670721686138       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670721609952       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670721492139       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670721499528       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670721574780       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.344493e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670720812795       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670720935830       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670720877181       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670721042818       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670720992284       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670721014603       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670721038779       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670721020142       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670720999387       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670720997222       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670721011065       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 3.616216e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9036e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.945195e-01 1 1  ON 0
 uu_1                 1.189607e-01 1 1  ON 1
 uu_2                 5.407633e-03 1 1  ON 2
 uu_3                -6.181249e-02 1 1  ON 3
 uu_4                -1.020867e-01 1 1  ON 4
 uu_5                -1.277914e-01 1 1  ON 5
 uu_6                -1.429030e-01 1 1  ON 6
 uu_7                -1.472095e-01 1 1  ON 7
 uu_8                -1.392350e-01 1 1  ON 8
 uu_9                -1.164346e-01 1 1  ON 9
 ud_0                 4.099113e-01 1 1  ON 10
 ud_1                 1.277301e-01 1 1  ON 11
 ud_2                -1.851712e-02 1 1  ON 12
 ud_3                -9.636128e-02 1 1  ON 13
 ud_4                -1.387845e-01 1 1  ON 14
 ud_5                -1.634281e-01 1 1  ON 15
 ud_6                -1.759196e-01 1 1  ON 16
 ud_7                -1.765586e-01 1 1  ON 17
 ud_8                -1.634474e-01 1 1  ON 18
 ud_9                -1.343758e-01 1 1  ON 19
 eC_0                -5.802230e-01 1 1  ON 20
 eC_1                -4.286374e-01 1 1  ON 21
 eC_2                -1.769554e-01 1 1  ON 22
 eC_3                -2.242821e-02 1 1  ON 23
 eC_4                 5.712260e-02 1 1  ON 24
 eC_5                 1.566945e-01 1 1  ON 25
 eC_6                 2.541743e-01 1 1  ON 26
 eC_7                 3.752387e-01 1 1  ON 27
 eC_8                 2.778182e-01 1 1  ON 28
 eC_9                 8.018824e-02 1 1  ON 29
 eO_0                -1.181319e+00 1 1  ON 30
 eO_1                -8.045927e-01 1 1  ON 31
 eO_2                -3.397626e-01 1 1  ON 32
 eO_3                 5.122839e-04 1 1  ON 33
 eO_4                 2.233896e-01 1 1  ON 34
 eO_5                 3.865438e-01 1 1  ON 35
 eO_6                 4.297780e-01 1 1  ON 36
 eO_7                 4.262039e-01 1 1  ON 37
 eO_8                 4.138765e-01 1 1  ON 38
 eO_9                 3.087457e-01 1 1  ON 39
eH1_0                -2.064310e-01 1 1  ON 40
eH1_1                -1.142178e-01 1 1  ON 41
eH1_2                -7.800089e-02 1 1  ON 42
eH1_3                -5.906555e-02 1 1  ON 43
eH1_4                 1.020852e-02 1 1  ON 44
eH1_5                 5.521488e-02 1 1  ON 45
eH1_6                 9.036300e-02 1 1  ON 46
eH1_7                 6.510383e-02 1 1  ON 47
eH1_8                 1.283652e-03 1 1  ON 48
eH1_9                 6.590195e-02 1 1  ON 49
eH2_0                -2.023162e-01 1 1  ON 50
eH2_1                -1.107908e-01 1 1  ON 51
eH2_2                -7.427744e-02 1 1  ON 52
eH2_3                -5.539067e-02 1 1  ON 53
eH2_4                 1.417175e-02 1 1  ON 54
eH2_5                 5.926220e-02 1 1  ON 55
eH2_6                 9.506081e-02 1 1  ON 56
eH2_7                 7.065175e-02 1 1  ON 57
eH2_8                 9.523576e-03 1 1  ON 58
eH2_9                 6.559065e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6365
    reference variance = 0.436978
====================================================
  Execution time = 4.3323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.2580e-01
  Total weights = 2.0000e+06
  Execution time = 3.5204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525970827010
                                         uncertainty =       0.009707078364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525970827010
                                         uncertainty =       0.009707078364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512738483
  error estimate for blocks of size 2^( 2) =       0.000530564891
  error estimate for blocks of size 2^( 3) =       0.000546304653
  error estimate for blocks of size 2^( 4) =       0.000557177679
  error estimate for blocks of size 2^( 5) =       0.000563562450
  error estimate for blocks of size 2^( 6) =       0.000564750359
  error estimate for blocks of size 2^( 7) =       0.000565718279

      target function =                  N/A
              le_mean =     -22.670818912419
             les_mean =     514.491831400249
             stat err =       0.000562802192
             autocorr =       1.204813242246
              std dev =       0.725121716308
             le_variance =       0.525801503461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526021006636
                                         uncertainty =       0.009705654806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526021006636
                                         uncertainty =       0.009705654806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512762954
  error estimate for blocks of size 2^( 2) =       0.000530589426
  error estimate for blocks of size 2^( 3) =       0.000546326652
  error estimate for blocks of size 2^( 4) =       0.000557197155
  error estimate for blocks of size 2^( 5) =       0.000563579503
  error estimate for blocks of size 2^( 6) =       0.000564770040
  error estimate for blocks of size 2^( 7) =       0.000565740426

      target function =                  N/A
              le_mean =     -22.670817361484
             les_mean =     514.491811268888
             stat err =       0.000562821781
             autocorr =       1.204782112365
              std dev =       0.725156323869
             le_variance =       0.525851694047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525962159714
                                         uncertainty =       0.009705043088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525962159714
                                         uncertainty =       0.009705043088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512734267
  error estimate for blocks of size 2^( 2) =       0.000530562123
  error estimate for blocks of size 2^( 3) =       0.000546301363
  error estimate for blocks of size 2^( 4) =       0.000557173375
  error estimate for blocks of size 2^( 5) =       0.000563556617
  error estimate for blocks of size 2^( 6) =       0.000564746852
  error estimate for blocks of size 2^( 7) =       0.000565717012

      target function =                  N/A
              le_mean =     -22.670817659117
             les_mean =     514.491765927503
             stat err =       0.000562798464
             autocorr =       1.204817092546
              std dev =       0.725115754518
             le_variance =       0.525792857451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525966852114
                                         uncertainty =       0.009706708955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525966852114
                                         uncertainty =       0.009706708955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512736547
  error estimate for blocks of size 2^( 2) =       0.000530563228
  error estimate for blocks of size 2^( 3) =       0.000546302975
  error estimate for blocks of size 2^( 4) =       0.000557175894
  error estimate for blocks of size 2^( 5) =       0.000563560452
  error estimate for blocks of size 2^( 6) =       0.000564748694
  error estimate for blocks of size 2^( 7) =       0.000565716942

      target function =                  N/A
              le_mean =     -22.670818701663
             les_mean =     514.491817873708
             stat err =       0.000562800496
             autocorr =       1.204815078228
              std dev =       0.725118978452
             le_variance =       0.525797532911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670818912419        initial  <--
     3.9062e-01     3.9062e+00             5.3124e-04       -22.670817361484
     1.5625e+00     1.5625e+01             1.3445e-04       -22.670817659117
     6.2500e+00     6.2500e+01             3.6162e-05       -22.670818701663

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9699
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.944209e-01 1 1  ON 0
 uu_1                 1.189461e-01 1 1  ON 1
 uu_2                 5.383515e-03 1 1  ON 2
 uu_3                -6.181278e-02 1 1  ON 3
 uu_4                -1.020951e-01 1 1  ON 4
 uu_5                -1.277938e-01 1 1  ON 5
 uu_6                -1.428684e-01 1 1  ON 6
 uu_7                -1.471702e-01 1 1  ON 7
 uu_8                -1.392107e-01 1 1  ON 8
 uu_9                -1.164292e-01 1 1  ON 9
 ud_0                 4.099200e-01 1 1  ON 10
 ud_1                 1.276855e-01 1 1  ON 11
 ud_2                -1.854342e-02 1 1  ON 12
 ud_3                -9.640223e-02 1 1  ON 13
 ud_4                -1.387865e-01 1 1  ON 14
 ud_5                -1.634492e-01 1 1  ON 15
 ud_6                -1.759674e-01 1 1  ON 16
 ud_7                -1.765371e-01 1 1  ON 17
 ud_8                -1.634062e-01 1 1  ON 18
 ud_9                -1.343506e-01 1 1  ON 19
 eC_0                -5.801051e-01 1 1  ON 20
 eC_1                -4.285381e-01 1 1  ON 21
 eC_2                -1.768518e-01 1 1  ON 22
 eC_3                -2.249151e-02 1 1  ON 23
 eC_4                 5.703933e-02 1 1  ON 24
 eC_5                 1.566277e-01 1 1  ON 25
 eC_6                 2.541373e-01 1 1  ON 26
 eC_7                 3.752734e-01 1 1  ON 27
 eC_8                 2.777533e-01 1 1  ON 28
 eC_9                 8.015058e-02 1 1  ON 29
 eO_0                -1.181184e+00 1 1  ON 30
 eO_1                -8.046136e-01 1 1  ON 31
 eO_2                -3.396554e-01 1 1  ON 32
 eO_3                 4.726984e-04 1 1  ON 33
 eO_4                 2.233725e-01 1 1  ON 34
 eO_5                 3.865543e-01 1 1  ON 35
 eO_6                 4.296692e-01 1 1  ON 36
 eO_7                 4.261609e-01 1 1  ON 37
 eO_8                 4.139595e-01 1 1  ON 38
 eO_9                 3.087007e-01 1 1  ON 39
eH1_0                -2.063668e-01 1 1  ON 40
eH1_1                -1.141422e-01 1 1  ON 41
eH1_2                -7.786979e-02 1 1  ON 42
eH1_3                -5.912742e-02 1 1  ON 43
eH1_4                 1.017902e-02 1 1  ON 44
eH1_5                 5.522623e-02 1 1  ON 45
eH1_6                 9.033892e-02 1 1  ON 46
eH1_7                 6.509675e-02 1 1  ON 47
eH1_8                 1.149869e-03 1 1  ON 48
eH1_9                 6.591655e-02 1 1  ON 49
eH2_0                -2.022445e-01 1 1  ON 50
eH2_1                -1.106653e-01 1 1  ON 51
eH2_2                -7.427959e-02 1 1  ON 52
eH2_3                -5.548633e-02 1 1  ON 53
eH2_4                 1.409727e-02 1 1  ON 54
eH2_5                 5.931614e-02 1 1  ON 55
eH2_6                 9.505344e-02 1 1  ON 56
eH2_7                 7.065093e-02 1 1  ON 57
eH2_8                 9.467378e-03 1 1  ON 58
eH2_9                 6.561562e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2001e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7066
    reference variance = 0.260087
====================================================
  Execution time = 4.4362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0789e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5167e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508027270791
                                         uncertainty =       0.003956177318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508027270791
                                         uncertainty =       0.003956177318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503927593
  error estimate for blocks of size 2^( 2) =       0.000521923431
  error estimate for blocks of size 2^( 3) =       0.000537964961
  error estimate for blocks of size 2^( 4) =       0.000548898564
  error estimate for blocks of size 2^( 5) =       0.000554505524
  error estimate for blocks of size 2^( 6) =       0.000560437462
  error estimate for blocks of size 2^( 7) =       0.000559588548

      target function =                  N/A
              le_mean =     -22.669275625077
             les_mean =     514.403943148716
             stat err =       0.000555857525
             autocorr =       1.216720150651
              std dev =       0.712661235768
             le_variance =       0.507886036966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266927562508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669275625077       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669275782345       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669275906622       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669276006576       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669276033003       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669276017838       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669276065449       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669276100217       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669276068057       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669276047619       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 6.048578e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669275625077       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669275665533       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669275699366       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669275726338       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669275734624       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669275731178       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669275742199       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669275751073       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669275744190       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669275739136       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 1.567193e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669275625077       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669275635264       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669275643912       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669275650794       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669275652985       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669275652157       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669275654852       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669275657078       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669275655450       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669275654193       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 3.954790e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9537e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.944232e-01 1 1  ON 0
 uu_1                 1.189469e-01 1 1  ON 1
 uu_2                 5.378285e-03 1 1  ON 2
 uu_3                -6.181186e-02 1 1  ON 3
 uu_4                -1.020983e-01 1 1  ON 4
 uu_5                -1.277974e-01 1 1  ON 5
 uu_6                -1.428694e-01 1 1  ON 6
 uu_7                -1.471714e-01 1 1  ON 7
 uu_8                -1.392021e-01 1 1  ON 8
 uu_9                -1.164229e-01 1 1  ON 9
 ud_0                 4.099244e-01 1 1  ON 10
 ud_1                 1.276983e-01 1 1  ON 11
 ud_2                -1.854046e-02 1 1  ON 12
 ud_3                -9.639860e-02 1 1  ON 13
 ud_4                -1.387853e-01 1 1  ON 14
 ud_5                -1.634504e-01 1 1  ON 15
 ud_6                -1.759615e-01 1 1  ON 16
 ud_7                -1.765527e-01 1 1  ON 17
 ud_8                -1.634104e-01 1 1  ON 18
 ud_9                -1.343498e-01 1 1  ON 19
 eC_0                -5.801120e-01 1 1  ON 20
 eC_1                -4.285491e-01 1 1  ON 21
 eC_2                -1.768560e-01 1 1  ON 22
 eC_3                -2.249798e-02 1 1  ON 23
 eC_4                 5.704880e-02 1 1  ON 24
 eC_5                 1.566302e-01 1 1  ON 25
 eC_6                 2.541444e-01 1 1  ON 26
 eC_7                 3.752728e-01 1 1  ON 27
 eC_8                 2.777592e-01 1 1  ON 28
 eC_9                 8.015461e-02 1 1  ON 29
 eO_0                -1.181198e+00 1 1  ON 30
 eO_1                -8.046164e-01 1 1  ON 31
 eO_2                -3.396668e-01 1 1  ON 32
 eO_3                 4.751065e-04 1 1  ON 33
 eO_4                 2.233841e-01 1 1  ON 34
 eO_5                 3.865572e-01 1 1  ON 35
 eO_6                 4.296743e-01 1 1  ON 36
 eO_7                 4.261651e-01 1 1  ON 37
 eO_8                 4.139522e-01 1 1  ON 38
 eO_9                 3.087046e-01 1 1  ON 39
eH1_0                -2.063713e-01 1 1  ON 40
eH1_1                -1.141544e-01 1 1  ON 41
eH1_2                -7.787138e-02 1 1  ON 42
eH1_3                -5.912718e-02 1 1  ON 43
eH1_4                 1.017624e-02 1 1  ON 44
eH1_5                 5.522439e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510317e-02 1 1  ON 47
eH1_8                 1.164887e-03 1 1  ON 48
eH1_9                 6.591420e-02 1 1  ON 49
eH2_0                -2.022549e-01 1 1  ON 50
eH2_1                -1.106669e-01 1 1  ON 51
eH2_2                -7.428194e-02 1 1  ON 52
eH2_3                -5.547943e-02 1 1  ON 53
eH2_4                 1.409567e-02 1 1  ON 54
eH2_5                 5.931711e-02 1 1  ON 55
eH2_6                 9.504986e-02 1 1  ON 56
eH2_7                 7.064973e-02 1 1  ON 57
eH2_8                 9.475656e-03 1 1  ON 58
eH2_9                 6.561514e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7547
    reference variance = 0.436486
====================================================
  Execution time = 4.3224e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1143e-01
  Total weights = 2.0000e+06
  Execution time = 3.5268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511175085652
                                         uncertainty =       0.009679000112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511175085652
                                         uncertainty =       0.009679000112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505680365
  error estimate for blocks of size 2^( 2) =       0.000523119612
  error estimate for blocks of size 2^( 3) =       0.000538357720
  error estimate for blocks of size 2^( 4) =       0.000549384916
  error estimate for blocks of size 2^( 5) =       0.000556451849
  error estimate for blocks of size 2^( 6) =       0.000560050789
  error estimate for blocks of size 2^( 7) =       0.000564326965

      target function =                  N/A
              le_mean =     -22.670096305544
             les_mean =     514.444691510644
             stat err =       0.000557553630
             autocorr =       1.215685153191
              std dev =       0.715140030846
             le_variance =       0.511425263719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511205330421
                                         uncertainty =       0.009677953467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511205330421
                                         uncertainty =       0.009677953467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505695333
  error estimate for blocks of size 2^( 2) =       0.000523133605
  error estimate for blocks of size 2^( 3) =       0.000538370099
  error estimate for blocks of size 2^( 4) =       0.000549396318
  error estimate for blocks of size 2^( 5) =       0.000556462552
  error estimate for blocks of size 2^( 6) =       0.000560060585
  error estimate for blocks of size 2^( 7) =       0.000564336922

      target function =                  N/A
              le_mean =     -22.670096135532
             les_mean =     514.444714077494
             stat err =       0.000557564095
             autocorr =       1.215658824392
              std dev =       0.715161197870
             le_variance =       0.511455538938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511190214336
                                         uncertainty =       0.009678358483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511190214336
                                         uncertainty =       0.009678358483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505687852
  error estimate for blocks of size 2^( 2) =       0.000523126592
  error estimate for blocks of size 2^( 3) =       0.000538363860
  error estimate for blocks of size 2^( 4) =       0.000549390556
  error estimate for blocks of size 2^( 5) =       0.000556457128
  error estimate for blocks of size 2^( 6) =       0.000560055582
  error estimate for blocks of size 2^( 7) =       0.000564331871

      target function =                  N/A
              le_mean =     -22.670096208879
             les_mean =     514.444702272054
             stat err =       0.000557558784
             autocorr =       1.215671631825
              std dev =       0.715150619063
             le_variance =       0.511440407946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511176972027
                                         uncertainty =       0.009678915508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511176972027
                                         uncertainty =       0.009678915508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505681299
  error estimate for blocks of size 2^( 2) =       0.000523120481
  error estimate for blocks of size 2^( 3) =       0.000538358484
  error estimate for blocks of size 2^( 4) =       0.000549385616
  error estimate for blocks of size 2^( 5) =       0.000556452504
  error estimate for blocks of size 2^( 6) =       0.000560051382
  error estimate for blocks of size 2^( 7) =       0.000564327573

      target function =                  N/A
              le_mean =     -22.670096292736
             les_mean =     514.444692818275
             stat err =       0.000557554269
             autocorr =       1.215683451771
              std dev =       0.715141351095
             le_variance =       0.511427152045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670096305544        initial  <--
     3.9062e+00     3.9062e+01             6.0486e-05       -22.670096135532
     1.5625e+01     1.5625e+02             1.5672e-05       -22.670096208879
     6.2500e+01     6.2500e+02             3.9548e-06       -22.670096292736

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0571
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.944209e-01 1 1  ON 0
 uu_1                 1.189461e-01 1 1  ON 1
 uu_2                 5.383515e-03 1 1  ON 2
 uu_3                -6.181278e-02 1 1  ON 3
 uu_4                -1.020951e-01 1 1  ON 4
 uu_5                -1.277938e-01 1 1  ON 5
 uu_6                -1.428684e-01 1 1  ON 6
 uu_7                -1.471702e-01 1 1  ON 7
 uu_8                -1.392107e-01 1 1  ON 8
 uu_9                -1.164292e-01 1 1  ON 9
 ud_0                 4.099200e-01 1 1  ON 10
 ud_1                 1.276855e-01 1 1  ON 11
 ud_2                -1.854342e-02 1 1  ON 12
 ud_3                -9.640223e-02 1 1  ON 13
 ud_4                -1.387865e-01 1 1  ON 14
 ud_5                -1.634492e-01 1 1  ON 15
 ud_6                -1.759674e-01 1 1  ON 16
 ud_7                -1.765371e-01 1 1  ON 17
 ud_8                -1.634062e-01 1 1  ON 18
 ud_9                -1.343506e-01 1 1  ON 19
 eC_0                -5.801051e-01 1 1  ON 20
 eC_1                -4.285381e-01 1 1  ON 21
 eC_2                -1.768518e-01 1 1  ON 22
 eC_3                -2.249151e-02 1 1  ON 23
 eC_4                 5.703933e-02 1 1  ON 24
 eC_5                 1.566277e-01 1 1  ON 25
 eC_6                 2.541373e-01 1 1  ON 26
 eC_7                 3.752734e-01 1 1  ON 27
 eC_8                 2.777533e-01 1 1  ON 28
 eC_9                 8.015058e-02 1 1  ON 29
 eO_0                -1.181184e+00 1 1  ON 30
 eO_1                -8.046136e-01 1 1  ON 31
 eO_2                -3.396554e-01 1 1  ON 32
 eO_3                 4.726984e-04 1 1  ON 33
 eO_4                 2.233725e-01 1 1  ON 34
 eO_5                 3.865543e-01 1 1  ON 35
 eO_6                 4.296692e-01 1 1  ON 36
 eO_7                 4.261609e-01 1 1  ON 37
 eO_8                 4.139595e-01 1 1  ON 38
 eO_9                 3.087007e-01 1 1  ON 39
eH1_0                -2.063668e-01 1 1  ON 40
eH1_1                -1.141422e-01 1 1  ON 41
eH1_2                -7.786979e-02 1 1  ON 42
eH1_3                -5.912742e-02 1 1  ON 43
eH1_4                 1.017902e-02 1 1  ON 44
eH1_5                 5.522623e-02 1 1  ON 45
eH1_6                 9.033892e-02 1 1  ON 46
eH1_7                 6.509675e-02 1 1  ON 47
eH1_8                 1.149869e-03 1 1  ON 48
eH1_9                 6.591655e-02 1 1  ON 49
eH2_0                -2.022445e-01 1 1  ON 50
eH2_1                -1.106653e-01 1 1  ON 51
eH2_2                -7.427959e-02 1 1  ON 52
eH2_3                -5.548633e-02 1 1  ON 53
eH2_4                 1.409727e-02 1 1  ON 54
eH2_5                 5.931614e-02 1 1  ON 55
eH2_6                 9.505344e-02 1 1  ON 56
eH2_7                 7.065093e-02 1 1  ON 57
eH2_8                 9.467378e-03 1 1  ON 58
eH2_9                 6.561562e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2160e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6437
    reference variance = 0.461963
====================================================
  Execution time = 4.4303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4924e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525372959305
                                         uncertainty =       0.020335165136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525372959305
                                         uncertainty =       0.020335165136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512506891
  error estimate for blocks of size 2^( 2) =       0.000529883327
  error estimate for blocks of size 2^( 3) =       0.000545308022
  error estimate for blocks of size 2^( 4) =       0.000555259306
  error estimate for blocks of size 2^( 5) =       0.000560251867
  error estimate for blocks of size 2^( 6) =       0.000562180932
  error estimate for blocks of size 2^( 7) =       0.000563514677

      target function =                  N/A
              le_mean =     -22.669865924588
             les_mean =     514.448147403086
             stat err =       0.000560301696
             autocorr =       1.195210651435
              std dev =       0.724794196275
             le_variance =       0.525326626953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266986592459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669865924588       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669865919810       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669865902942       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669865917450       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669865925759       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669865931009       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669865922959       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669865929461       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669865931139       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669865931459       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669865932158       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 6.471597e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669865924588       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669865923390       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669865919148       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669865922784       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669865924878       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669865926219       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669865924196       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669865925798       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669865926207       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669865926283       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669865926466       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.621613e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669865924588       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669865924288       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669865923226       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669865924136       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669865924660       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669865924998       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669865924488       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669865924891       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669865924991       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669865925011       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669865925057       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 4.056365e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9235e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.944205e-01 1 1  ON 0
 uu_1                 1.189469e-01 1 1  ON 1
 uu_2                 5.383988e-03 1 1  ON 2
 uu_3                -6.181261e-02 1 1  ON 3
 uu_4                -1.020955e-01 1 1  ON 4
 uu_5                -1.277934e-01 1 1  ON 5
 uu_6                -1.428686e-01 1 1  ON 6
 uu_7                -1.471694e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164297e-01 1 1  ON 9
 ud_0                 4.099210e-01 1 1  ON 10
 ud_1                 1.276868e-01 1 1  ON 11
 ud_2                -1.854315e-02 1 1  ON 12
 ud_3                -9.640137e-02 1 1  ON 13
 ud_4                -1.387864e-01 1 1  ON 14
 ud_5                -1.634492e-01 1 1  ON 15
 ud_6                -1.759669e-01 1 1  ON 16
 ud_7                -1.765373e-01 1 1  ON 17
 ud_8                -1.634070e-01 1 1  ON 18
 ud_9                -1.343517e-01 1 1  ON 19
 eC_0                -5.801066e-01 1 1  ON 20
 eC_1                -4.285398e-01 1 1  ON 21
 eC_2                -1.768516e-01 1 1  ON 22
 eC_3                -2.249159e-02 1 1  ON 23
 eC_4                 5.704001e-02 1 1  ON 24
 eC_5                 1.566283e-01 1 1  ON 25
 eC_6                 2.541385e-01 1 1  ON 26
 eC_7                 3.752733e-01 1 1  ON 27
 eC_8                 2.777537e-01 1 1  ON 28
 eC_9                 8.015076e-02 1 1  ON 29
 eO_0                -1.181186e+00 1 1  ON 30
 eO_1                -8.046137e-01 1 1  ON 31
 eO_2                -3.396557e-01 1 1  ON 32
 eO_3                 4.726310e-04 1 1  ON 33
 eO_4                 2.233737e-01 1 1  ON 34
 eO_5                 3.865541e-01 1 1  ON 35
 eO_6                 4.296697e-01 1 1  ON 36
 eO_7                 4.261613e-01 1 1  ON 37
 eO_8                 4.139586e-01 1 1  ON 38
 eO_9                 3.087010e-01 1 1  ON 39
eH1_0                -2.063679e-01 1 1  ON 40
eH1_1                -1.141431e-01 1 1  ON 41
eH1_2                -7.787054e-02 1 1  ON 42
eH1_3                -5.912755e-02 1 1  ON 43
eH1_4                 1.017932e-02 1 1  ON 44
eH1_5                 5.522662e-02 1 1  ON 45
eH1_6                 9.033877e-02 1 1  ON 46
eH1_7                 6.509798e-02 1 1  ON 47
eH1_8                 1.150949e-03 1 1  ON 48
eH1_9                 6.591632e-02 1 1  ON 49
eH2_0                -2.022452e-01 1 1  ON 50
eH2_1                -1.106656e-01 1 1  ON 51
eH2_2                -7.428087e-02 1 1  ON 52
eH2_3                -5.548567e-02 1 1  ON 53
eH2_4                 1.409702e-02 1 1  ON 54
eH2_5                 5.931567e-02 1 1  ON 55
eH2_6                 9.505428e-02 1 1  ON 56
eH2_7                 7.065134e-02 1 1  ON 57
eH2_8                 9.468467e-03 1 1  ON 58
eH2_9                 6.561539e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5806
    reference variance = 0.364354
====================================================
  Execution time = 4.3035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2019e-01
  Total weights = 2.0000e+06
  Execution time = 3.5427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520254951747
                                         uncertainty =       0.007475528180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520254951747
                                         uncertainty =       0.007475528180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509995466
  error estimate for blocks of size 2^( 2) =       0.000527797463
  error estimate for blocks of size 2^( 3) =       0.000543095281
  error estimate for blocks of size 2^( 4) =       0.000555136233
  error estimate for blocks of size 2^( 5) =       0.000561257935
  error estimate for blocks of size 2^( 6) =       0.000562366168
  error estimate for blocks of size 2^( 7) =       0.000563735104

      target function =                  N/A
              le_mean =     -22.670019312224
             les_mean =     514.449966106374
             stat err =       0.000560623860
             autocorr =       1.208399467310
              std dev =       0.721242504186
             le_variance =       0.520190749844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520258645891
                                         uncertainty =       0.007475618258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520258645891
                                         uncertainty =       0.007475618258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509997275
  error estimate for blocks of size 2^( 2) =       0.000527799084
  error estimate for blocks of size 2^( 3) =       0.000543096712
  error estimate for blocks of size 2^( 4) =       0.000555137554
  error estimate for blocks of size 2^( 5) =       0.000561259123
  error estimate for blocks of size 2^( 6) =       0.000562367199
  error estimate for blocks of size 2^( 7) =       0.000563736003

      target function =                  N/A
              le_mean =     -22.670019321321
             les_mean =     514.449970210913
             stat err =       0.000560624970
             autocorr =       1.208395673812
              std dev =       0.721245063737
             le_variance =       0.520194441965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520256804552
                                         uncertainty =       0.007475573841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520256804552
                                         uncertainty =       0.007475573841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509996373
  error estimate for blocks of size 2^( 2) =       0.000527798275
  error estimate for blocks of size 2^( 3) =       0.000543095998
  error estimate for blocks of size 2^( 4) =       0.000555136895
  error estimate for blocks of size 2^( 5) =       0.000561258530
  error estimate for blocks of size 2^( 6) =       0.000562366684
  error estimate for blocks of size 2^( 7) =       0.000563735553

      target function =                  N/A
              le_mean =     -22.670019316854
             les_mean =     514.449968168037
             stat err =       0.000560624416
             autocorr =       1.208397560378
              std dev =       0.721243787922
             le_variance =       0.520192601616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520255183495
                                         uncertainty =       0.007475533907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520255183495
                                         uncertainty =       0.007475533907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509995579
  error estimate for blocks of size 2^( 2) =       0.000527797564
  error estimate for blocks of size 2^( 3) =       0.000543095371
  error estimate for blocks of size 2^( 4) =       0.000555136316
  error estimate for blocks of size 2^( 5) =       0.000561258009
  error estimate for blocks of size 2^( 6) =       0.000562366233
  error estimate for blocks of size 2^( 7) =       0.000563735160

      target function =                  N/A
              le_mean =     -22.670019312801
             les_mean =     514.449966364138
             stat err =       0.000560623930
             autocorr =       1.208399228615
              std dev =       0.721242664755
             le_variance =       0.520190981462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670019312224        initial
     3.9062e+01     3.9062e+02             6.4716e-06       -22.670019321321  <--
     1.5625e+02     1.5625e+03             1.6216e-06       -22.670019316854
     6.2500e+02     6.2500e+03             4.0564e-07       -22.670019312801

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 6.0730e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.944195e-01 1 1  ON 0
 uu_1                 1.189492e-01 1 1  ON 1
 uu_2                 5.385397e-03 1 1  ON 2
 uu_3                -6.181209e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277921e-01 1 1  ON 5
 uu_6                -1.428693e-01 1 1  ON 6
 uu_7                -1.471671e-01 1 1  ON 7
 uu_8                -1.392111e-01 1 1  ON 8
 uu_9                -1.164313e-01 1 1  ON 9
 ud_0                 4.099238e-01 1 1  ON 10
 ud_1                 1.276904e-01 1 1  ON 11
 ud_2                -1.854229e-02 1 1  ON 12
 ud_3                -9.639882e-02 1 1  ON 13
 ud_4                -1.387860e-01 1 1  ON 14
 ud_5                -1.634491e-01 1 1  ON 15
 ud_6                -1.759652e-01 1 1  ON 16
 ud_7                -1.765382e-01 1 1  ON 17
 ud_8                -1.634094e-01 1 1  ON 18
 ud_9                -1.343548e-01 1 1  ON 19
 eC_0                -5.801110e-01 1 1  ON 20
 eC_1                -4.285446e-01 1 1  ON 21
 eC_2                -1.768510e-01 1 1  ON 22
 eC_3                -2.249182e-02 1 1  ON 23
 eC_4                 5.704204e-02 1 1  ON 24
 eC_5                 1.566300e-01 1 1  ON 25
 eC_6                 2.541422e-01 1 1  ON 26
 eC_7                 3.752728e-01 1 1  ON 27
 eC_8                 2.777552e-01 1 1  ON 28
 eC_9                 8.015129e-02 1 1  ON 29
 eO_0                -1.181189e+00 1 1  ON 30
 eO_1                -8.046142e-01 1 1  ON 31
 eO_2                -3.396567e-01 1 1  ON 32
 eO_3                 4.724335e-04 1 1  ON 33
 eO_4                 2.233772e-01 1 1  ON 34
 eO_5                 3.865535e-01 1 1  ON 35
 eO_6                 4.296715e-01 1 1  ON 36
 eO_7                 4.261627e-01 1 1  ON 37
 eO_8                 4.139560e-01 1 1  ON 38
 eO_9                 3.087018e-01 1 1  ON 39
eH1_0                -2.063712e-01 1 1  ON 40
eH1_1                -1.141459e-01 1 1  ON 41
eH1_2                -7.787278e-02 1 1  ON 42
eH1_3                -5.912794e-02 1 1  ON 43
eH1_4                 1.018021e-02 1 1  ON 44
eH1_5                 5.522781e-02 1 1  ON 45
eH1_6                 9.033830e-02 1 1  ON 46
eH1_7                 6.510167e-02 1 1  ON 47
eH1_8                 1.154185e-03 1 1  ON 48
eH1_9                 6.591563e-02 1 1  ON 49
eH2_0                -2.022474e-01 1 1  ON 50
eH2_1                -1.106663e-01 1 1  ON 51
eH2_2                -7.428470e-02 1 1  ON 52
eH2_3                -5.548369e-02 1 1  ON 53
eH2_4                 1.409625e-02 1 1  ON 54
eH2_5                 5.931427e-02 1 1  ON 55
eH2_6                 9.505679e-02 1 1  ON 56
eH2_7                 7.065257e-02 1 1  ON 57
eH2_8                 9.471731e-03 1 1  ON 58
eH2_9                 6.561471e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1997e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7443
    reference variance = 0.643014
====================================================
  Execution time = 4.3731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0862e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4905e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508607543805
                                         uncertainty =       0.003488839044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508607543805
                                         uncertainty =       0.003488839044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504291076
  error estimate for blocks of size 2^( 2) =       0.000521407959
  error estimate for blocks of size 2^( 3) =       0.000537491045
  error estimate for blocks of size 2^( 4) =       0.000548063897
  error estimate for blocks of size 2^( 5) =       0.000554898229
  error estimate for blocks of size 2^( 6) =       0.000557026751
  error estimate for blocks of size 2^( 7) =       0.000559062533

      target function =                  N/A
              le_mean =     -22.670001705028
             les_mean =     514.437596030225
             stat err =       0.000554762852
             autocorr =       1.210186152182
              std dev =       0.713175278983
             le_variance =       0.508618978552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267000170503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670001705028       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670001755191       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670001737029       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670001821478       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670001842405       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670001824705       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670001842631       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670001857400       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670001856250       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670001847880       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 2.951755e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670001705028       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670001717716       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670001713067       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670001734650       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670001740245       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670001735684       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670001739784       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670001743336       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670001743327       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670001741348       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 7.445092e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670001705028       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670001708210       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670001707040       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670001712467       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670001713889       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670001712740       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670001713739       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670001714618       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670001714634       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670001714147       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.865466e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8643e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.944219e-01 1 1  ON 0
 uu_1                 1.189486e-01 1 1  ON 1
 uu_2                 5.387396e-03 1 1  ON 2
 uu_3                -6.181326e-02 1 1  ON 3
 uu_4                -1.020964e-01 1 1  ON 4
 uu_5                -1.277916e-01 1 1  ON 5
 uu_6                -1.428682e-01 1 1  ON 6
 uu_7                -1.471660e-01 1 1  ON 7
 uu_8                -1.392126e-01 1 1  ON 8
 uu_9                -1.164317e-01 1 1  ON 9
 ud_0                 4.099300e-01 1 1  ON 10
 ud_1                 1.276928e-01 1 1  ON 11
 ud_2                -1.854285e-02 1 1  ON 12
 ud_3                -9.639787e-02 1 1  ON 13
 ud_4                -1.387843e-01 1 1  ON 14
 ud_5                -1.634480e-01 1 1  ON 15
 ud_6                -1.759645e-01 1 1  ON 16
 ud_7                -1.765351e-01 1 1  ON 17
 ud_8                -1.634153e-01 1 1  ON 18
 ud_9                -1.343582e-01 1 1  ON 19
 eC_0                -5.801184e-01 1 1  ON 20
 eC_1                -4.285458e-01 1 1  ON 21
 eC_2                -1.768492e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704364e-02 1 1  ON 24
 eC_5                 1.566318e-01 1 1  ON 25
 eC_6                 2.541459e-01 1 1  ON 26
 eC_7                 3.752715e-01 1 1  ON 27
 eC_8                 2.777570e-01 1 1  ON 28
 eC_9                 8.015245e-02 1 1  ON 29
 eO_0                -1.181194e+00 1 1  ON 30
 eO_1                -8.046138e-01 1 1  ON 31
 eO_2                -3.396586e-01 1 1  ON 32
 eO_3                 4.710703e-04 1 1  ON 33
 eO_4                 2.233778e-01 1 1  ON 34
 eO_5                 3.865546e-01 1 1  ON 35
 eO_6                 4.296738e-01 1 1  ON 36
 eO_7                 4.261661e-01 1 1  ON 37
 eO_8                 4.139529e-01 1 1  ON 38
 eO_9                 3.087029e-01 1 1  ON 39
eH1_0                -2.063735e-01 1 1  ON 40
eH1_1                -1.141478e-01 1 1  ON 41
eH1_2                -7.787286e-02 1 1  ON 42
eH1_3                -5.912802e-02 1 1  ON 43
eH1_4                 1.018138e-02 1 1  ON 44
eH1_5                 5.522897e-02 1 1  ON 45
eH1_6                 9.033760e-02 1 1  ON 46
eH1_7                 6.509865e-02 1 1  ON 47
eH1_8                 1.158840e-03 1 1  ON 48
eH1_9                 6.591520e-02 1 1  ON 49
eH2_0                -2.022510e-01 1 1  ON 50
eH2_1                -1.106711e-01 1 1  ON 51
eH2_2                -7.428509e-02 1 1  ON 52
eH2_3                -5.548257e-02 1 1  ON 53
eH2_4                 1.409759e-02 1 1  ON 54
eH2_5                 5.931580e-02 1 1  ON 55
eH2_6                 9.505641e-02 1 1  ON 56
eH2_7                 7.065419e-02 1 1  ON 57
eH2_8                 9.475469e-03 1 1  ON 58
eH2_9                 6.561353e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6187
    reference variance = 0.42325
====================================================
  Execution time = 4.3471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0843e-01
  Total weights = 2.0000e+06
  Execution time = 3.5410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508484811150
                                         uncertainty =       0.003897904101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508484811150
                                         uncertainty =       0.003897904101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504192960
  error estimate for blocks of size 2^( 2) =       0.000521786765
  error estimate for blocks of size 2^( 3) =       0.000537196439
  error estimate for blocks of size 2^( 4) =       0.000548396344
  error estimate for blocks of size 2^( 5) =       0.000555060593
  error estimate for blocks of size 2^( 6) =       0.000558811784
  error estimate for blocks of size 2^( 7) =       0.000562486851

      target function =                  N/A
              le_mean =     -22.668295501485
             les_mean =     514.360041770254
             stat err =       0.000556188893
             autocorr =       1.216889289920
              std dev =       0.713036522090
             le_variance =       0.508421081834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508518619451
                                         uncertainty =       0.003898113146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508518619451
                                         uncertainty =       0.003898113146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504209719
  error estimate for blocks of size 2^( 2) =       0.000521802338
  error estimate for blocks of size 2^( 3) =       0.000537211080
  error estimate for blocks of size 2^( 4) =       0.000548410504
  error estimate for blocks of size 2^( 5) =       0.000555074650
  error estimate for blocks of size 2^( 6) =       0.000558826191
  error estimate for blocks of size 2^( 7) =       0.000562501004

      target function =                  N/A
              le_mean =     -22.668295284964
             les_mean =     514.360065752800
             stat err =       0.000556203087
             autocorr =       1.216870506752
              std dev =       0.713060222345
             le_variance =       0.508454880691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508502125896
                                         uncertainty =       0.003898010652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508502125896
                                         uncertainty =       0.003898010652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504201543
  error estimate for blocks of size 2^( 2) =       0.000521794739
  error estimate for blocks of size 2^( 3) =       0.000537203936
  error estimate for blocks of size 2^( 4) =       0.000548403593
  error estimate for blocks of size 2^( 5) =       0.000555067785
  error estimate for blocks of size 2^( 6) =       0.000558819156
  error estimate for blocks of size 2^( 7) =       0.000562494090

      target function =                  N/A
              le_mean =     -22.668295389333
             les_mean =     514.360053995539
             stat err =       0.000556196156
             autocorr =       1.216879641542
              std dev =       0.713048660124
             le_variance =       0.508438391705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508486988141
                                         uncertainty =       0.003897917484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508486988141
                                         uncertainty =       0.003897917484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504194039
  error estimate for blocks of size 2^( 2) =       0.000521787767
  error estimate for blocks of size 2^( 3) =       0.000537197382
  error estimate for blocks of size 2^( 4) =       0.000548397255
  error estimate for blocks of size 2^( 5) =       0.000555061497
  error estimate for blocks of size 2^( 6) =       0.000558812711
  error estimate for blocks of size 2^( 7) =       0.000562487760

      target function =                  N/A
              le_mean =     -22.668295487274
             les_mean =     514.360043302365
             stat err =       0.000556189806
             autocorr =       1.216888075478
              std dev =       0.713038048220
             le_variance =       0.508423258210


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668295501485        initial  <--
     9.7656e+00     9.7656e+01             2.9518e-05       -22.668295284964
     3.9062e+01     3.9062e+02             7.4451e-06       -22.668295389333
     1.5625e+02     1.5625e+03             1.8655e-06       -22.668295487274

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1362
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.944195e-01 1 1  ON 0
 uu_1                 1.189492e-01 1 1  ON 1
 uu_2                 5.385397e-03 1 1  ON 2
 uu_3                -6.181209e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277921e-01 1 1  ON 5
 uu_6                -1.428693e-01 1 1  ON 6
 uu_7                -1.471671e-01 1 1  ON 7
 uu_8                -1.392111e-01 1 1  ON 8
 uu_9                -1.164313e-01 1 1  ON 9
 ud_0                 4.099238e-01 1 1  ON 10
 ud_1                 1.276904e-01 1 1  ON 11
 ud_2                -1.854229e-02 1 1  ON 12
 ud_3                -9.639882e-02 1 1  ON 13
 ud_4                -1.387860e-01 1 1  ON 14
 ud_5                -1.634491e-01 1 1  ON 15
 ud_6                -1.759652e-01 1 1  ON 16
 ud_7                -1.765382e-01 1 1  ON 17
 ud_8                -1.634094e-01 1 1  ON 18
 ud_9                -1.343548e-01 1 1  ON 19
 eC_0                -5.801110e-01 1 1  ON 20
 eC_1                -4.285446e-01 1 1  ON 21
 eC_2                -1.768510e-01 1 1  ON 22
 eC_3                -2.249182e-02 1 1  ON 23
 eC_4                 5.704204e-02 1 1  ON 24
 eC_5                 1.566300e-01 1 1  ON 25
 eC_6                 2.541422e-01 1 1  ON 26
 eC_7                 3.752728e-01 1 1  ON 27
 eC_8                 2.777552e-01 1 1  ON 28
 eC_9                 8.015129e-02 1 1  ON 29
 eO_0                -1.181189e+00 1 1  ON 30
 eO_1                -8.046142e-01 1 1  ON 31
 eO_2                -3.396567e-01 1 1  ON 32
 eO_3                 4.724335e-04 1 1  ON 33
 eO_4                 2.233772e-01 1 1  ON 34
 eO_5                 3.865535e-01 1 1  ON 35
 eO_6                 4.296715e-01 1 1  ON 36
 eO_7                 4.261627e-01 1 1  ON 37
 eO_8                 4.139560e-01 1 1  ON 38
 eO_9                 3.087018e-01 1 1  ON 39
eH1_0                -2.063712e-01 1 1  ON 40
eH1_1                -1.141459e-01 1 1  ON 41
eH1_2                -7.787278e-02 1 1  ON 42
eH1_3                -5.912794e-02 1 1  ON 43
eH1_4                 1.018021e-02 1 1  ON 44
eH1_5                 5.522781e-02 1 1  ON 45
eH1_6                 9.033830e-02 1 1  ON 46
eH1_7                 6.510167e-02 1 1  ON 47
eH1_8                 1.154185e-03 1 1  ON 48
eH1_9                 6.591563e-02 1 1  ON 49
eH2_0                -2.022474e-01 1 1  ON 50
eH2_1                -1.106663e-01 1 1  ON 51
eH2_2                -7.428470e-02 1 1  ON 52
eH2_3                -5.548369e-02 1 1  ON 53
eH2_4                 1.409625e-02 1 1  ON 54
eH2_5                 5.931427e-02 1 1  ON 55
eH2_6                 9.505679e-02 1 1  ON 56
eH2_7                 7.065257e-02 1 1  ON 57
eH2_8                 9.471731e-03 1 1  ON 58
eH2_9                 6.561471e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1979e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.734
    reference variance = 0.37876
====================================================
  Execution time = 4.4555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5163e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514650220810
                                         uncertainty =       0.006192253373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514650220810
                                         uncertainty =       0.006192253373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507296331
  error estimate for blocks of size 2^( 2) =       0.000524914009
  error estimate for blocks of size 2^( 3) =       0.000540925598
  error estimate for blocks of size 2^( 4) =       0.000552329579
  error estimate for blocks of size 2^( 5) =       0.000558938159
  error estimate for blocks of size 2^( 6) =       0.000560653952
  error estimate for blocks of size 2^( 7) =       0.000563636198

      target function =                  N/A
              le_mean =     -22.669959590073
             les_mean =     514.441766693239
             stat err =       0.000558889472
             autocorr =       1.213747684152
              std dev =       0.717425351548
             le_variance =       0.514699135044


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266995959007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669959590073       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669959594029       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669959596565       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669959595461       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669959599185       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669959597438       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669959601961       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669959599812       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669959600416       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669959599945       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 1.982141e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669959590073       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669959591063       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669959591700       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669959591424       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669959592350       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669959591913       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669959593045       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669959592507       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669959592654       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669959592536       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 4.956355e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669959590073       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669959590321       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669959590480       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669959590411       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669959590642       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669959590534       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669959590816       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669959590682       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669959590722       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669959590684       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.239151e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9726e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.944193e-01 1 1  ON 0
 uu_1                 1.189490e-01 1 1  ON 1
 uu_2                 5.385692e-03 1 1  ON 2
 uu_3                -6.181212e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277919e-01 1 1  ON 5
 uu_6                -1.428692e-01 1 1  ON 6
 uu_7                -1.471668e-01 1 1  ON 7
 uu_8                -1.392110e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099239e-01 1 1  ON 10
 ud_1                 1.276909e-01 1 1  ON 11
 ud_2                -1.854225e-02 1 1  ON 12
 ud_3                -9.639875e-02 1 1  ON 13
 ud_4                -1.387859e-01 1 1  ON 14
 ud_5                -1.634491e-01 1 1  ON 15
 ud_6                -1.759650e-01 1 1  ON 16
 ud_7                -1.765383e-01 1 1  ON 17
 ud_8                -1.634098e-01 1 1  ON 18
 ud_9                -1.343548e-01 1 1  ON 19
 eC_0                -5.801114e-01 1 1  ON 20
 eC_1                -4.285449e-01 1 1  ON 21
 eC_2                -1.768510e-01 1 1  ON 22
 eC_3                -2.249209e-02 1 1  ON 23
 eC_4                 5.704219e-02 1 1  ON 24
 eC_5                 1.566302e-01 1 1  ON 25
 eC_6                 2.541426e-01 1 1  ON 26
 eC_7                 3.752727e-01 1 1  ON 27
 eC_8                 2.777554e-01 1 1  ON 28
 eC_9                 8.015139e-02 1 1  ON 29
 eO_0                -1.181190e+00 1 1  ON 30
 eO_1                -8.046143e-01 1 1  ON 31
 eO_2                -3.396567e-01 1 1  ON 32
 eO_3                 4.722987e-04 1 1  ON 33
 eO_4                 2.233773e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296718e-01 1 1  ON 36
 eO_7                 4.261631e-01 1 1  ON 37
 eO_8                 4.139557e-01 1 1  ON 38
 eO_9                 3.087019e-01 1 1  ON 39
eH1_0                -2.063714e-01 1 1  ON 40
eH1_1                -1.141459e-01 1 1  ON 41
eH1_2                -7.787294e-02 1 1  ON 42
eH1_3                -5.912804e-02 1 1  ON 43
eH1_4                 1.018029e-02 1 1  ON 44
eH1_5                 5.522753e-02 1 1  ON 45
eH1_6                 9.033836e-02 1 1  ON 46
eH1_7                 6.510169e-02 1 1  ON 47
eH1_8                 1.154610e-03 1 1  ON 48
eH1_9                 6.591553e-02 1 1  ON 49
eH2_0                -2.022475e-01 1 1  ON 50
eH2_1                -1.106667e-01 1 1  ON 51
eH2_2                -7.428460e-02 1 1  ON 52
eH2_3                -5.548378e-02 1 1  ON 53
eH2_4                 1.409641e-02 1 1  ON 54
eH2_5                 5.931433e-02 1 1  ON 55
eH2_6                 9.505670e-02 1 1  ON 56
eH2_7                 7.065245e-02 1 1  ON 57
eH2_8                 9.472208e-03 1 1  ON 58
eH2_9                 6.561463e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6257
    reference variance = 1.07901
====================================================
  Execution time = 4.3268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0514e-01
  Total weights = 2.0000e+06
  Execution time = 3.5343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198340709
                                         uncertainty =       0.004495150522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198340709
                                         uncertainty =       0.004495150522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502562264
  error estimate for blocks of size 2^( 2) =       0.000519930944
  error estimate for blocks of size 2^( 3) =       0.000535557859
  error estimate for blocks of size 2^( 4) =       0.000546084378
  error estimate for blocks of size 2^( 5) =       0.000551770294
  error estimate for blocks of size 2^( 6) =       0.000553819890
  error estimate for blocks of size 2^( 7) =       0.000555517117

      target function =                  N/A
              le_mean =     -22.669881733436
             les_mean =     514.428675213719
             stat err =       0.000551797920
             autocorr =       1.205536507872
              std dev =       0.710730369623
             le_variance =       0.505137658304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198238640
                                         uncertainty =       0.004495144534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198238640
                                         uncertainty =       0.004495144534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502562213
  error estimate for blocks of size 2^( 2) =       0.000519930873
  error estimate for blocks of size 2^( 3) =       0.000535557760
  error estimate for blocks of size 2^( 4) =       0.000546084250
  error estimate for blocks of size 2^( 5) =       0.000551770137
  error estimate for blocks of size 2^( 6) =       0.000553819654
  error estimate for blocks of size 2^( 7) =       0.000555516859

      target function =                  N/A
              le_mean =     -22.669881736092
             les_mean =     514.428675231880
             stat err =       0.000551797725
             autocorr =       1.205535901118
              std dev =       0.710730297674
             le_variance =       0.505137556032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198286483
                                         uncertainty =       0.004495147481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198286483
                                         uncertainty =       0.004495147481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502562237
  error estimate for blocks of size 2^( 2) =       0.000519930907
  error estimate for blocks of size 2^( 3) =       0.000535557808
  error estimate for blocks of size 2^( 4) =       0.000546084313
  error estimate for blocks of size 2^( 5) =       0.000551770214
  error estimate for blocks of size 2^( 6) =       0.000553819770
  error estimate for blocks of size 2^( 7) =       0.000555516987

      target function =                  N/A
              le_mean =     -22.669881734757
             les_mean =     514.428675219255
             stat err =       0.000551797821
             autocorr =       1.205536205178
              std dev =       0.710730331403
             le_variance =       0.505137603977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198333825
                                         uncertainty =       0.004495150140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505198333825
                                         uncertainty =       0.004495150140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502562261
  error estimate for blocks of size 2^( 2) =       0.000519930940
  error estimate for blocks of size 2^( 3) =       0.000535557853
  error estimate for blocks of size 2^( 4) =       0.000546084370
  error estimate for blocks of size 2^( 5) =       0.000551770284
  error estimate for blocks of size 2^( 6) =       0.000553819875
  error estimate for blocks of size 2^( 7) =       0.000555517101

      target function =                  N/A
              le_mean =     -22.669881733600
             les_mean =     514.428675214266
             stat err =       0.000551797907
             autocorr =       1.205536470068
              std dev =       0.710730364771
             le_variance =       0.505137651408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669881733436        initial
     9.7656e+01     9.7656e+02             1.9821e-06       -22.669881736092  <--
     3.9062e+02     3.9062e+03             4.9564e-07       -22.669881734757
     1.5625e+03     1.5625e+04             1.2392e-07       -22.669881733600

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 6.0915e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.944190e-01 1 1  ON 0
 uu_1                 1.189484e-01 1 1  ON 1
 uu_2                 5.386571e-03 1 1  ON 2
 uu_3                -6.181223e-02 1 1  ON 3
 uu_4                -1.020964e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428691e-01 1 1  ON 6
 uu_7                -1.471659e-01 1 1  ON 7
 uu_8                -1.392106e-01 1 1  ON 8
 uu_9                -1.164324e-01 1 1  ON 9
 ud_0                 4.099243e-01 1 1  ON 10
 ud_1                 1.276923e-01 1 1  ON 11
 ud_2                -1.854210e-02 1 1  ON 12
 ud_3                -9.639852e-02 1 1  ON 13
 ud_4                -1.387855e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759644e-01 1 1  ON 16
 ud_7                -1.765387e-01 1 1  ON 17
 ud_8                -1.634110e-01 1 1  ON 18
 ud_9                -1.343550e-01 1 1  ON 19
 eC_0                -5.801124e-01 1 1  ON 20
 eC_1                -4.285459e-01 1 1  ON 21
 eC_2                -1.768509e-01 1 1  ON 22
 eC_3                -2.249290e-02 1 1  ON 23
 eC_4                 5.704265e-02 1 1  ON 24
 eC_5                 1.566307e-01 1 1  ON 25
 eC_6                 2.541438e-01 1 1  ON 26
 eC_7                 3.752724e-01 1 1  ON 27
 eC_8                 2.777560e-01 1 1  ON 28
 eC_9                 8.015171e-02 1 1  ON 29
 eO_0                -1.181191e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396567e-01 1 1  ON 32
 eO_3                 4.718940e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865527e-01 1 1  ON 35
 eO_6                 4.296727e-01 1 1  ON 36
 eO_7                 4.261646e-01 1 1  ON 37
 eO_8                 4.139549e-01 1 1  ON 38
 eO_9                 3.087023e-01 1 1  ON 39
eH1_0                -2.063718e-01 1 1  ON 40
eH1_1                -1.141459e-01 1 1  ON 41
eH1_2                -7.787342e-02 1 1  ON 42
eH1_3                -5.912834e-02 1 1  ON 43
eH1_4                 1.018053e-02 1 1  ON 44
eH1_5                 5.522671e-02 1 1  ON 45
eH1_6                 9.033853e-02 1 1  ON 46
eH1_7                 6.510178e-02 1 1  ON 47
eH1_8                 1.155883e-03 1 1  ON 48
eH1_9                 6.591524e-02 1 1  ON 49
eH2_0                -2.022479e-01 1 1  ON 50
eH2_1                -1.106680e-01 1 1  ON 51
eH2_2                -7.428430e-02 1 1  ON 52
eH2_3                -5.548406e-02 1 1  ON 53
eH2_4                 1.409690e-02 1 1  ON 54
eH2_5                 5.931449e-02 1 1  ON 55
eH2_6                 9.505646e-02 1 1  ON 56
eH2_7                 7.065208e-02 1 1  ON 57
eH2_8                 9.473639e-03 1 1  ON 58
eH2_9                 6.561440e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2074e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7628
    reference variance = 0.364122
====================================================
  Execution time = 4.4067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4943e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507884649931
                                         uncertainty =       0.004021297230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507884649931
                                         uncertainty =       0.004021297230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504395898
  error estimate for blocks of size 2^( 2) =       0.000522190218
  error estimate for blocks of size 2^( 3) =       0.000537924728
  error estimate for blocks of size 2^( 4) =       0.000549593672
  error estimate for blocks of size 2^( 5) =       0.000556162078
  error estimate for blocks of size 2^( 6) =       0.000560336624
  error estimate for blocks of size 2^( 7) =       0.000561914831

      target function =                  N/A
              le_mean =     -22.669797277386
             les_mean =     514.428538786625
             stat err =       0.000557001801
             autocorr =       1.219467155123
              std dev =       0.713323519352
             le_variance =       0.508830443261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266979727739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669797277386       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669797277529       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669797271357       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669797272400       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669797300953       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669797302616       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669797314389       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669797322039       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669797313692       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669797313753       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 9.658238e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669797277386       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669797277422       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669797275856       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669797276080       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669797283226       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669797283639       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669797286580       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669797288506       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669797286437       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669797286436       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 2.416820e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669797277386       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669797277395       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669797277002       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669797277056       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669797278843       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669797278946       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669797279681       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669797280163       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669797279648       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669797279645       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 6.043459e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9018e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.944207e-01 1 1  ON 0
 uu_1                 1.189486e-01 1 1  ON 1
 uu_2                 5.386117e-03 1 1  ON 2
 uu_3                -6.181204e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277904e-01 1 1  ON 5
 uu_6                -1.428694e-01 1 1  ON 6
 uu_7                -1.471664e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164322e-01 1 1  ON 9
 ud_0                 4.099257e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854189e-02 1 1  ON 12
 ud_3                -9.639747e-02 1 1  ON 13
 ud_4                -1.387853e-01 1 1  ON 14
 ud_5                -1.634494e-01 1 1  ON 15
 ud_6                -1.759633e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634125e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801141e-01 1 1  ON 20
 eC_1                -4.285465e-01 1 1  ON 21
 eC_2                -1.768527e-01 1 1  ON 22
 eC_3                -2.249287e-02 1 1  ON 23
 eC_4                 5.704378e-02 1 1  ON 24
 eC_5                 1.566311e-01 1 1  ON 25
 eC_6                 2.541449e-01 1 1  ON 26
 eC_7                 3.752723e-01 1 1  ON 27
 eC_8                 2.777568e-01 1 1  ON 28
 eC_9                 8.015220e-02 1 1  ON 29
 eO_0                -1.181193e+00 1 1  ON 30
 eO_1                -8.046146e-01 1 1  ON 31
 eO_2                -3.396578e-01 1 1  ON 32
 eO_3                 4.718245e-04 1 1  ON 33
 eO_4                 2.233784e-01 1 1  ON 34
 eO_5                 3.865531e-01 1 1  ON 35
 eO_6                 4.296738e-01 1 1  ON 36
 eO_7                 4.261657e-01 1 1  ON 37
 eO_8                 4.139534e-01 1 1  ON 38
 eO_9                 3.087030e-01 1 1  ON 39
eH1_0                -2.063732e-01 1 1  ON 40
eH1_1                -1.141473e-01 1 1  ON 41
eH1_2                -7.787377e-02 1 1  ON 42
eH1_3                -5.912805e-02 1 1  ON 43
eH1_4                 1.018102e-02 1 1  ON 44
eH1_5                 5.522642e-02 1 1  ON 45
eH1_6                 9.033951e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.157485e-03 1 1  ON 48
eH1_9                 6.591491e-02 1 1  ON 49
eH2_0                -2.022487e-01 1 1  ON 50
eH2_1                -1.106680e-01 1 1  ON 51
eH2_2                -7.428490e-02 1 1  ON 52
eH2_3                -5.548453e-02 1 1  ON 53
eH2_4                 1.409778e-02 1 1  ON 54
eH2_5                 5.931348e-02 1 1  ON 55
eH2_6                 9.505539e-02 1 1  ON 56
eH2_7                 7.065230e-02 1 1  ON 57
eH2_8                 9.476055e-03 1 1  ON 58
eH2_9                 6.561423e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6401
    reference variance = 0.448939
====================================================
  Execution time = 4.4913e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0271e-01
  Total weights = 2.0000e+06
  Execution time = 3.5363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502698999621
                                         uncertainty =       0.002939257589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502698999621
                                         uncertainty =       0.002939257589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501349990
  error estimate for blocks of size 2^( 2) =       0.000519227703
  error estimate for blocks of size 2^( 3) =       0.000534874849
  error estimate for blocks of size 2^( 4) =       0.000546383906
  error estimate for blocks of size 2^( 5) =       0.000554486140
  error estimate for blocks of size 2^( 6) =       0.000559111943
  error estimate for blocks of size 2^( 7) =       0.000563519077

      target function =                  N/A
              le_mean =     -22.669536610926
             les_mean =     514.410593527531
             stat err =       0.000555875266
             autocorr =       1.229341888710
              std dev =       0.709015955226
             le_variance =       0.502703624765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502707612221
                                         uncertainty =       0.002939339010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502707612221
                                         uncertainty =       0.002939339010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501354286
  error estimate for blocks of size 2^( 2) =       0.000519231721
  error estimate for blocks of size 2^( 3) =       0.000534878571
  error estimate for blocks of size 2^( 4) =       0.000546387492
  error estimate for blocks of size 2^( 5) =       0.000554489815
  error estimate for blocks of size 2^( 6) =       0.000559115599
  error estimate for blocks of size 2^( 7) =       0.000563522544

      target function =                  N/A
              le_mean =     -22.669536597329
             les_mean =     514.410601525696
             stat err =       0.000555878863
             autocorr =       1.229336729144
              std dev =       0.709022030269
             le_variance =       0.502712239407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502703344463
                                         uncertainty =       0.002939298776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502703344463
                                         uncertainty =       0.002939298776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501352157
  error estimate for blocks of size 2^( 2) =       0.000519229729
  error estimate for blocks of size 2^( 3) =       0.000534876726
  error estimate for blocks of size 2^( 4) =       0.000546385715
  error estimate for blocks of size 2^( 5) =       0.000554487994
  error estimate for blocks of size 2^( 6) =       0.000559113787
  error estimate for blocks of size 2^( 7) =       0.000563520823

      target function =                  N/A
              le_mean =     -22.669536604143
             les_mean =     514.410597565860
             stat err =       0.000555877080
             autocorr =       1.229339281371
              std dev =       0.709019019939
             le_variance =       0.502707970635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502699543891
                                         uncertainty =       0.002939262753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502699543891
                                         uncertainty =       0.002939262753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501350261
  error estimate for blocks of size 2^( 2) =       0.000519227957
  error estimate for blocks of size 2^( 3) =       0.000534875084
  error estimate for blocks of size 2^( 4) =       0.000546384133
  error estimate for blocks of size 2^( 5) =       0.000554486372
  error estimate for blocks of size 2^( 6) =       0.000559112174
  error estimate for blocks of size 2^( 7) =       0.000563519295

      target function =                  N/A
              le_mean =     -22.669536610072
             les_mean =     514.410594033195
             stat err =       0.000555875493
             autocorr =       1.229341561913
              std dev =       0.709016339137
             le_variance =       0.502704169164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669536610926        initial  <--
     2.4414e+01     2.4414e+02             9.6582e-06       -22.669536597329
     9.7656e+01     9.7656e+02             2.4168e-06       -22.669536604143
     3.9062e+02     3.9062e+03             6.0435e-07       -22.669536610072

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6137
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.944190e-01 1 1  ON 0
 uu_1                 1.189484e-01 1 1  ON 1
 uu_2                 5.386571e-03 1 1  ON 2
 uu_3                -6.181223e-02 1 1  ON 3
 uu_4                -1.020964e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428691e-01 1 1  ON 6
 uu_7                -1.471659e-01 1 1  ON 7
 uu_8                -1.392106e-01 1 1  ON 8
 uu_9                -1.164324e-01 1 1  ON 9
 ud_0                 4.099243e-01 1 1  ON 10
 ud_1                 1.276923e-01 1 1  ON 11
 ud_2                -1.854210e-02 1 1  ON 12
 ud_3                -9.639852e-02 1 1  ON 13
 ud_4                -1.387855e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759644e-01 1 1  ON 16
 ud_7                -1.765387e-01 1 1  ON 17
 ud_8                -1.634110e-01 1 1  ON 18
 ud_9                -1.343550e-01 1 1  ON 19
 eC_0                -5.801124e-01 1 1  ON 20
 eC_1                -4.285459e-01 1 1  ON 21
 eC_2                -1.768509e-01 1 1  ON 22
 eC_3                -2.249290e-02 1 1  ON 23
 eC_4                 5.704265e-02 1 1  ON 24
 eC_5                 1.566307e-01 1 1  ON 25
 eC_6                 2.541438e-01 1 1  ON 26
 eC_7                 3.752724e-01 1 1  ON 27
 eC_8                 2.777560e-01 1 1  ON 28
 eC_9                 8.015171e-02 1 1  ON 29
 eO_0                -1.181191e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396567e-01 1 1  ON 32
 eO_3                 4.718940e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865527e-01 1 1  ON 35
 eO_6                 4.296727e-01 1 1  ON 36
 eO_7                 4.261646e-01 1 1  ON 37
 eO_8                 4.139549e-01 1 1  ON 38
 eO_9                 3.087023e-01 1 1  ON 39
eH1_0                -2.063718e-01 1 1  ON 40
eH1_1                -1.141459e-01 1 1  ON 41
eH1_2                -7.787342e-02 1 1  ON 42
eH1_3                -5.912834e-02 1 1  ON 43
eH1_4                 1.018053e-02 1 1  ON 44
eH1_5                 5.522671e-02 1 1  ON 45
eH1_6                 9.033853e-02 1 1  ON 46
eH1_7                 6.510178e-02 1 1  ON 47
eH1_8                 1.155883e-03 1 1  ON 48
eH1_9                 6.591524e-02 1 1  ON 49
eH2_0                -2.022479e-01 1 1  ON 50
eH2_1                -1.106680e-01 1 1  ON 51
eH2_2                -7.428430e-02 1 1  ON 52
eH2_3                -5.548406e-02 1 1  ON 53
eH2_4                 1.409690e-02 1 1  ON 54
eH2_5                 5.931449e-02 1 1  ON 55
eH2_6                 9.505646e-02 1 1  ON 56
eH2_7                 7.065208e-02 1 1  ON 57
eH2_8                 9.473639e-03 1 1  ON 58
eH2_9                 6.561440e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2164e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6856
    reference variance = 0.335811
====================================================
  Execution time = 4.4061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4921e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526200774469
                                         uncertainty =       0.013541039900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526200774469
                                         uncertainty =       0.013541039900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512908084
  error estimate for blocks of size 2^( 2) =       0.000530376774
  error estimate for blocks of size 2^( 3) =       0.000545299566
  error estimate for blocks of size 2^( 4) =       0.000556460062
  error estimate for blocks of size 2^( 5) =       0.000562514037
  error estimate for blocks of size 2^( 6) =       0.000564804754
  error estimate for blocks of size 2^( 7) =       0.000566989240

      target function =                  N/A
              le_mean =     -22.670362159763
             les_mean =     514.471469596084
             stat err =       0.000562692023
             autocorr =       1.203545269315
              std dev =       0.725361568011
             le_variance =       0.526149404348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267036215976e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670362159763       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670362160071       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670362160023       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670362163456       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670362164898       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670362164228       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670362163297       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670362164130       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670362165010       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670362165308       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 1.068182e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670362159763       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670362159840       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670362159828       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670362160687       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670362161048       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670362160881       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670362160647       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670362160855       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670362161073       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670362161150       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.671562e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670362159763       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670362159782       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670362159779       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670362159994       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670362160084       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670362160044       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670362159986       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670362160042       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670362160082       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670362160110       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 6.679597e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8989e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.944189e-01 1 1  ON 0
 uu_1                 1.189483e-01 1 1  ON 1
 uu_2                 5.386528e-03 1 1  ON 2
 uu_3                -6.181224e-02 1 1  ON 3
 uu_4                -1.020964e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428691e-01 1 1  ON 6
 uu_7                -1.471658e-01 1 1  ON 7
 uu_8                -1.392105e-01 1 1  ON 8
 uu_9                -1.164322e-01 1 1  ON 9
 ud_0                 4.099242e-01 1 1  ON 10
 ud_1                 1.276925e-01 1 1  ON 11
 ud_2                -1.854208e-02 1 1  ON 12
 ud_3                -9.639844e-02 1 1  ON 13
 ud_4                -1.387854e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759644e-01 1 1  ON 16
 ud_7                -1.765388e-01 1 1  ON 17
 ud_8                -1.634111e-01 1 1  ON 18
 ud_9                -1.343550e-01 1 1  ON 19
 eC_0                -5.801125e-01 1 1  ON 20
 eC_1                -4.285461e-01 1 1  ON 21
 eC_2                -1.768510e-01 1 1  ON 22
 eC_3                -2.249296e-02 1 1  ON 23
 eC_4                 5.704272e-02 1 1  ON 24
 eC_5                 1.566309e-01 1 1  ON 25
 eC_6                 2.541438e-01 1 1  ON 26
 eC_7                 3.752723e-01 1 1  ON 27
 eC_8                 2.777561e-01 1 1  ON 28
 eC_9                 8.015177e-02 1 1  ON 29
 eO_0                -1.181191e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396567e-01 1 1  ON 32
 eO_3                 4.717367e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865527e-01 1 1  ON 35
 eO_6                 4.296728e-01 1 1  ON 36
 eO_7                 4.261648e-01 1 1  ON 37
 eO_8                 4.139548e-01 1 1  ON 38
 eO_9                 3.087024e-01 1 1  ON 39
eH1_0                -2.063719e-01 1 1  ON 40
eH1_1                -1.141459e-01 1 1  ON 41
eH1_2                -7.787341e-02 1 1  ON 42
eH1_3                -5.912830e-02 1 1  ON 43
eH1_4                 1.018054e-02 1 1  ON 44
eH1_5                 5.522677e-02 1 1  ON 45
eH1_6                 9.033847e-02 1 1  ON 46
eH1_7                 6.510172e-02 1 1  ON 47
eH1_8                 1.156031e-03 1 1  ON 48
eH1_9                 6.591518e-02 1 1  ON 49
eH2_0                -2.022481e-01 1 1  ON 50
eH2_1                -1.106682e-01 1 1  ON 51
eH2_2                -7.428420e-02 1 1  ON 52
eH2_3                -5.548404e-02 1 1  ON 53
eH2_4                 1.409705e-02 1 1  ON 54
eH2_5                 5.931444e-02 1 1  ON 55
eH2_6                 9.505650e-02 1 1  ON 56
eH2_7                 7.065207e-02 1 1  ON 57
eH2_8                 9.473733e-03 1 1  ON 58
eH2_9                 6.561436e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6885
    reference variance = 0.531732
====================================================
  Execution time = 4.3322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.1345e-01
  Total weights = 2.0000e+06
  Execution time = 3.9953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362636823
                                         uncertainty =       0.003950519633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362636823
                                         uncertainty =       0.003950519633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506678092
  error estimate for blocks of size 2^( 2) =       0.000524193341
  error estimate for blocks of size 2^( 3) =       0.000539299108
  error estimate for blocks of size 2^( 4) =       0.000550840923
  error estimate for blocks of size 2^( 5) =       0.000557668024
  error estimate for blocks of size 2^( 6) =       0.000561864899
  error estimate for blocks of size 2^( 7) =       0.000562030607

      target function =                  N/A
              le_mean =     -22.670653112719
             les_mean =     514.471957678054
             stat err =       0.000558101113
             autocorr =       1.213281359423
              std dev =       0.716551029260
             le_variance =       0.513445377534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362163239
                                         uncertainty =       0.003950514317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362163239
                                         uncertainty =       0.003950514317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506677858
  error estimate for blocks of size 2^( 2) =       0.000524193111
  error estimate for blocks of size 2^( 3) =       0.000539298877
  error estimate for blocks of size 2^( 4) =       0.000550840688
  error estimate for blocks of size 2^( 5) =       0.000557667774
  error estimate for blocks of size 2^( 6) =       0.000561864647
  error estimate for blocks of size 2^( 7) =       0.000562030356

      target function =                  N/A
              le_mean =     -22.670653116121
             les_mean =     514.471957358860
             stat err =       0.000558100866
             autocorr =       1.213281403824
              std dev =       0.716550698886
             le_variance =       0.513444904073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362399370
                                         uncertainty =       0.003950516970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362399370
                                         uncertainty =       0.003950516970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506677975
  error estimate for blocks of size 2^( 2) =       0.000524193226
  error estimate for blocks of size 2^( 3) =       0.000539298992
  error estimate for blocks of size 2^( 4) =       0.000550840805
  error estimate for blocks of size 2^( 5) =       0.000557667899
  error estimate for blocks of size 2^( 6) =       0.000561864773
  error estimate for blocks of size 2^( 7) =       0.000562030481

      target function =                  N/A
              le_mean =     -22.670653114422
             les_mean =     514.471957517859
             stat err =       0.000558100990
             autocorr =       1.213281381855
              std dev =       0.716550863612
             le_variance =       0.513445140143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362607120
                                         uncertainty =       0.003950519300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513362607120
                                         uncertainty =       0.003950519300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506678077
  error estimate for blocks of size 2^( 2) =       0.000524193326
  error estimate for blocks of size 2^( 3) =       0.000539299093
  error estimate for blocks of size 2^( 4) =       0.000550840908
  error estimate for blocks of size 2^( 5) =       0.000557668009
  error estimate for blocks of size 2^( 6) =       0.000561864883
  error estimate for blocks of size 2^( 7) =       0.000562030592

      target function =                  N/A
              le_mean =     -22.670653112932
             les_mean =     514.471957658007
             stat err =       0.000558101098
             autocorr =       1.213281362237
              std dev =       0.716551008539
             le_variance =       0.513445347839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670653112719        initial
     2.4414e+02     2.4414e+03             1.0682e-06       -22.670653116121  <--
     9.7656e+02     9.7656e+03             2.6716e-07       -22.670653114422
     3.9062e+03     3.9062e+04             6.6796e-08       -22.670653112932

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 6.1737e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.944189e-01 1 1  ON 0
 uu_1                 1.189482e-01 1 1  ON 1
 uu_2                 5.386398e-03 1 1  ON 2
 uu_3                -6.181227e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277911e-01 1 1  ON 5
 uu_6                -1.428693e-01 1 1  ON 6
 uu_7                -1.471657e-01 1 1  ON 7
 uu_8                -1.392105e-01 1 1  ON 8
 uu_9                -1.164319e-01 1 1  ON 9
 ud_0                 4.099239e-01 1 1  ON 10
 ud_1                 1.276932e-01 1 1  ON 11
 ud_2                -1.854201e-02 1 1  ON 12
 ud_3                -9.639819e-02 1 1  ON 13
 ud_4                -1.387853e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759645e-01 1 1  ON 16
 ud_7                -1.765389e-01 1 1  ON 17
 ud_8                -1.634113e-01 1 1  ON 18
 ud_9                -1.343551e-01 1 1  ON 19
 eC_0                -5.801129e-01 1 1  ON 20
 eC_1                -4.285466e-01 1 1  ON 21
 eC_2                -1.768510e-01 1 1  ON 22
 eC_3                -2.249315e-02 1 1  ON 23
 eC_4                 5.704293e-02 1 1  ON 24
 eC_5                 1.566314e-01 1 1  ON 25
 eC_6                 2.541438e-01 1 1  ON 26
 eC_7                 3.752721e-01 1 1  ON 27
 eC_8                 2.777564e-01 1 1  ON 28
 eC_9                 8.015193e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396565e-01 1 1  ON 32
 eO_3                 4.712651e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865527e-01 1 1  ON 35
 eO_6                 4.296732e-01 1 1  ON 36
 eO_7                 4.261651e-01 1 1  ON 37
 eO_8                 4.139546e-01 1 1  ON 38
 eO_9                 3.087027e-01 1 1  ON 39
eH1_0                -2.063724e-01 1 1  ON 40
eH1_1                -1.141458e-01 1 1  ON 41
eH1_2                -7.787339e-02 1 1  ON 42
eH1_3                -5.912816e-02 1 1  ON 43
eH1_4                 1.018058e-02 1 1  ON 44
eH1_5                 5.522696e-02 1 1  ON 45
eH1_6                 9.033828e-02 1 1  ON 46
eH1_7                 6.510156e-02 1 1  ON 47
eH1_8                 1.156474e-03 1 1  ON 48
eH1_9                 6.591498e-02 1 1  ON 49
eH2_0                -2.022485e-01 1 1  ON 50
eH2_1                -1.106690e-01 1 1  ON 51
eH2_2                -7.428389e-02 1 1  ON 52
eH2_3                -5.548396e-02 1 1  ON 53
eH2_4                 1.409752e-02 1 1  ON 54
eH2_5                 5.931428e-02 1 1  ON 55
eH2_6                 9.505664e-02 1 1  ON 56
eH2_7                 7.065206e-02 1 1  ON 57
eH2_8                 9.474014e-03 1 1  ON 58
eH2_9                 6.561426e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2073e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6832
    reference variance = 0.34367
====================================================
  Execution time = 4.3694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.4201e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5030e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.542237243485
                                         uncertainty =       0.022779919109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.542237243485
                                         uncertainty =       0.022779919109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000520582464
  error estimate for blocks of size 2^( 2) =       0.000537470731
  error estimate for blocks of size 2^( 3) =       0.000552380952
  error estimate for blocks of size 2^( 4) =       0.000563003587
  error estimate for blocks of size 2^( 5) =       0.000569197046
  error estimate for blocks of size 2^( 6) =       0.000573772879
  error estimate for blocks of size 2^( 7) =       0.000574293235

      target function =                  N/A
              le_mean =     -22.669958932519
             les_mean =     514.469049935566
             stat err =       0.000570066687
             autocorr =       1.199146531552
              std dev =       0.736214781476
             le_variance =       0.542012204464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266995893252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669958932519       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669958937758       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669958942940       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669958947653       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669958957623       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669958957798       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669958960704       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669958964105       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669958964463       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669958962959       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 5.153165e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669958932519       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669958933832       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669958935129       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669958936309       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669958938805       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669958938857       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669958939601       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669958940451       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669958940540       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669958940161       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+02 is 1.291293e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669958932519       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669958932848       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669958933172       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669958933467       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669958934091       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669958934104       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669958934291       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669958934505       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669958934526       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669958934432       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 3.230115e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8731e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.944202e-01 1 1  ON 0
 uu_1                 1.189483e-01 1 1  ON 1
 uu_2                 5.386386e-03 1 1  ON 2
 uu_3                -6.181230e-02 1 1  ON 3
 uu_4                -1.020964e-01 1 1  ON 4
 uu_5                -1.277908e-01 1 1  ON 5
 uu_6                -1.428697e-01 1 1  ON 6
 uu_7                -1.471660e-01 1 1  ON 7
 uu_8                -1.392106e-01 1 1  ON 8
 uu_9                -1.164321e-01 1 1  ON 9
 ud_0                 4.099241e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854160e-02 1 1  ON 12
 ud_3                -9.639784e-02 1 1  ON 13
 ud_4                -1.387851e-01 1 1  ON 14
 ud_5                -1.634486e-01 1 1  ON 15
 ud_6                -1.759637e-01 1 1  ON 16
 ud_7                -1.765393e-01 1 1  ON 17
 ud_8                -1.634124e-01 1 1  ON 18
 ud_9                -1.343556e-01 1 1  ON 19
 eC_0                -5.801134e-01 1 1  ON 20
 eC_1                -4.285470e-01 1 1  ON 21
 eC_2                -1.768511e-01 1 1  ON 22
 eC_3                -2.249372e-02 1 1  ON 23
 eC_4                 5.704339e-02 1 1  ON 24
 eC_5                 1.566318e-01 1 1  ON 25
 eC_6                 2.541444e-01 1 1  ON 26
 eC_7                 3.752720e-01 1 1  ON 27
 eC_8                 2.777566e-01 1 1  ON 28
 eC_9                 8.015205e-02 1 1  ON 29
 eO_0                -1.181193e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396564e-01 1 1  ON 32
 eO_3                 4.707872e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865524e-01 1 1  ON 35
 eO_6                 4.296738e-01 1 1  ON 36
 eO_7                 4.261657e-01 1 1  ON 37
 eO_8                 4.139541e-01 1 1  ON 38
 eO_9                 3.087029e-01 1 1  ON 39
eH1_0                -2.063729e-01 1 1  ON 40
eH1_1                -1.141467e-01 1 1  ON 41
eH1_2                -7.787335e-02 1 1  ON 42
eH1_3                -5.912804e-02 1 1  ON 43
eH1_4                 1.018054e-02 1 1  ON 44
eH1_5                 5.522691e-02 1 1  ON 45
eH1_6                 9.033825e-02 1 1  ON 46
eH1_7                 6.510215e-02 1 1  ON 47
eH1_8                 1.157202e-03 1 1  ON 48
eH1_9                 6.591481e-02 1 1  ON 49
eH2_0                -2.022483e-01 1 1  ON 50
eH2_1                -1.106694e-01 1 1  ON 51
eH2_2                -7.428415e-02 1 1  ON 52
eH2_3                -5.548378e-02 1 1  ON 53
eH2_4                 1.409799e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505620e-02 1 1  ON 56
eH2_7                 7.065163e-02 1 1  ON 57
eH2_8                 9.474704e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6573
    reference variance = 0.354021
====================================================
  Execution time = 4.2745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1315e-01
  Total weights = 2.0000e+06
  Execution time = 3.5265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513202723782
                                         uncertainty =       0.006356301446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513202723782
                                         uncertainty =       0.006356301446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506529849
  error estimate for blocks of size 2^( 2) =       0.000524060572
  error estimate for blocks of size 2^( 3) =       0.000539563647
  error estimate for blocks of size 2^( 4) =       0.000550694725
  error estimate for blocks of size 2^( 5) =       0.000558147315
  error estimate for blocks of size 2^( 6) =       0.000561418451
  error estimate for blocks of size 2^( 7) =       0.000561487908

      target function =                  N/A
              le_mean =     -22.668661766443
             les_mean =     514.381371001410
             stat err =       0.000557937100
             autocorr =       1.213278202440
              std dev =       0.716341382723
             le_variance =       0.513144976602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513204140670
                                         uncertainty =       0.006356443020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513204140670
                                         uncertainty =       0.006356443020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506530547
  error estimate for blocks of size 2^( 2) =       0.000524061228
  error estimate for blocks of size 2^( 3) =       0.000539564290
  error estimate for blocks of size 2^( 4) =       0.000550695355
  error estimate for blocks of size 2^( 5) =       0.000558147870
  error estimate for blocks of size 2^( 6) =       0.000561418986
  error estimate for blocks of size 2^( 7) =       0.000561488398

      target function =                  N/A
              le_mean =     -22.668661754166
             les_mean =     514.381371858011
             stat err =       0.000557937652
             autocorr =       1.213277264255
              std dev =       0.716342369133
             le_variance =       0.513146389815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513203430370
                                         uncertainty =       0.006356372400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513203430370
                                         uncertainty =       0.006356372400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506530197
  error estimate for blocks of size 2^( 2) =       0.000524060899
  error estimate for blocks of size 2^( 3) =       0.000539563968
  error estimate for blocks of size 2^( 4) =       0.000550695040
  error estimate for blocks of size 2^( 5) =       0.000558147591
  error estimate for blocks of size 2^( 6) =       0.000561418718
  error estimate for blocks of size 2^( 7) =       0.000561488152

      target function =                  N/A
              le_mean =     -22.668661760258
             les_mean =     514.381371425758
             stat err =       0.000557937375
             autocorr =       1.213277734052
              std dev =       0.716341874628
             le_variance =       0.513145681346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513202812038
                                         uncertainty =       0.006356310320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513202812038
                                         uncertainty =       0.006356310320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506529893
  error estimate for blocks of size 2^( 2) =       0.000524060613
  error estimate for blocks of size 2^( 3) =       0.000539563687
  error estimate for blocks of size 2^( 4) =       0.000550694765
  error estimate for blocks of size 2^( 5) =       0.000558147349
  error estimate for blocks of size 2^( 6) =       0.000561418485
  error estimate for blocks of size 2^( 7) =       0.000561487939

      target function =                  N/A
              le_mean =     -22.668661765667
             les_mean =     514.381371054260
             stat err =       0.000557937134
             autocorr =       1.213278143915
              std dev =       0.716341444164
             le_variance =       0.513145064627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668661766443        initial  <--
     6.1035e+01     6.1035e+02             5.1532e-06       -22.668661754166
     2.4414e+02     2.4414e+03             1.2913e-06       -22.668661760258
     9.7656e+02     9.7656e+03             3.2301e-07       -22.668661765667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4111
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.944189e-01 1 1  ON 0
 uu_1                 1.189482e-01 1 1  ON 1
 uu_2                 5.386398e-03 1 1  ON 2
 uu_3                -6.181227e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277911e-01 1 1  ON 5
 uu_6                -1.428693e-01 1 1  ON 6
 uu_7                -1.471657e-01 1 1  ON 7
 uu_8                -1.392105e-01 1 1  ON 8
 uu_9                -1.164319e-01 1 1  ON 9
 ud_0                 4.099239e-01 1 1  ON 10
 ud_1                 1.276932e-01 1 1  ON 11
 ud_2                -1.854201e-02 1 1  ON 12
 ud_3                -9.639819e-02 1 1  ON 13
 ud_4                -1.387853e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759645e-01 1 1  ON 16
 ud_7                -1.765389e-01 1 1  ON 17
 ud_8                -1.634113e-01 1 1  ON 18
 ud_9                -1.343551e-01 1 1  ON 19
 eC_0                -5.801129e-01 1 1  ON 20
 eC_1                -4.285466e-01 1 1  ON 21
 eC_2                -1.768510e-01 1 1  ON 22
 eC_3                -2.249315e-02 1 1  ON 23
 eC_4                 5.704293e-02 1 1  ON 24
 eC_5                 1.566314e-01 1 1  ON 25
 eC_6                 2.541438e-01 1 1  ON 26
 eC_7                 3.752721e-01 1 1  ON 27
 eC_8                 2.777564e-01 1 1  ON 28
 eC_9                 8.015193e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396565e-01 1 1  ON 32
 eO_3                 4.712651e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865527e-01 1 1  ON 35
 eO_6                 4.296732e-01 1 1  ON 36
 eO_7                 4.261651e-01 1 1  ON 37
 eO_8                 4.139546e-01 1 1  ON 38
 eO_9                 3.087027e-01 1 1  ON 39
eH1_0                -2.063724e-01 1 1  ON 40
eH1_1                -1.141458e-01 1 1  ON 41
eH1_2                -7.787339e-02 1 1  ON 42
eH1_3                -5.912816e-02 1 1  ON 43
eH1_4                 1.018058e-02 1 1  ON 44
eH1_5                 5.522696e-02 1 1  ON 45
eH1_6                 9.033828e-02 1 1  ON 46
eH1_7                 6.510156e-02 1 1  ON 47
eH1_8                 1.156474e-03 1 1  ON 48
eH1_9                 6.591498e-02 1 1  ON 49
eH2_0                -2.022485e-01 1 1  ON 50
eH2_1                -1.106690e-01 1 1  ON 51
eH2_2                -7.428389e-02 1 1  ON 52
eH2_3                -5.548396e-02 1 1  ON 53
eH2_4                 1.409752e-02 1 1  ON 54
eH2_5                 5.931428e-02 1 1  ON 55
eH2_6                 9.505664e-02 1 1  ON 56
eH2_7                 7.065206e-02 1 1  ON 57
eH2_8                 9.474014e-03 1 1  ON 58
eH2_9                 6.561426e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1915e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.661
    reference variance = 0.297739
====================================================
  Execution time = 4.3566e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.1764e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5086e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517746683045
                                         uncertainty =       0.006018114484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517746683045
                                         uncertainty =       0.006018114484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508745426
  error estimate for blocks of size 2^( 2) =       0.000526477866
  error estimate for blocks of size 2^( 3) =       0.000542082133
  error estimate for blocks of size 2^( 4) =       0.000553940771
  error estimate for blocks of size 2^( 5) =       0.000560795931
  error estimate for blocks of size 2^( 6) =       0.000561687396
  error estimate for blocks of size 2^( 7) =       0.000562587157

      target function =                  N/A
              le_mean =     -22.670868796136
             les_mean =     514.485935529930
             stat err =       0.000559752814
             autocorr =       1.210574538560
              std dev =       0.719474681373
             le_variance =       0.517643817137


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267086879614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670868796136       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670868796840       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670868796175       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670868795957       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670868795546       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670868795926       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670868796862       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670868796733       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670868796891       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670868796785       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.577308e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670868796136       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670868796312       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670868796146       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670868796091       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670868795988       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670868796095       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670868796319       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670868796283       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670868796323       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670868796308       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 8.943629e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670868796136       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670868796180       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670868796138       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670868796125       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670868796098       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670868796120       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670868796184       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670868796153       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670868796180       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670868796166       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.235930e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8660e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.944189e-01 1 1  ON 0
 uu_1                 1.189482e-01 1 1  ON 1
 uu_2                 5.386416e-03 1 1  ON 2
 uu_3                -6.181224e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277911e-01 1 1  ON 5
 uu_6                -1.428693e-01 1 1  ON 6
 uu_7                -1.471657e-01 1 1  ON 7
 uu_8                -1.392105e-01 1 1  ON 8
 uu_9                -1.164319e-01 1 1  ON 9
 ud_0                 4.099239e-01 1 1  ON 10
 ud_1                 1.276932e-01 1 1  ON 11
 ud_2                -1.854202e-02 1 1  ON 12
 ud_3                -9.639817e-02 1 1  ON 13
 ud_4                -1.387854e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759644e-01 1 1  ON 16
 ud_7                -1.765390e-01 1 1  ON 17
 ud_8                -1.634113e-01 1 1  ON 18
 ud_9                -1.343551e-01 1 1  ON 19
 eC_0                -5.801129e-01 1 1  ON 20
 eC_1                -4.285466e-01 1 1  ON 21
 eC_2                -1.768511e-01 1 1  ON 22
 eC_3                -2.249317e-02 1 1  ON 23
 eC_4                 5.704294e-02 1 1  ON 24
 eC_5                 1.566315e-01 1 1  ON 25
 eC_6                 2.541439e-01 1 1  ON 26
 eC_7                 3.752721e-01 1 1  ON 27
 eC_8                 2.777565e-01 1 1  ON 28
 eC_9                 8.015195e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396566e-01 1 1  ON 32
 eO_3                 4.712225e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865527e-01 1 1  ON 35
 eO_6                 4.296732e-01 1 1  ON 36
 eO_7                 4.261652e-01 1 1  ON 37
 eO_8                 4.139545e-01 1 1  ON 38
 eO_9                 3.087027e-01 1 1  ON 39
eH1_0                -2.063724e-01 1 1  ON 40
eH1_1                -1.141459e-01 1 1  ON 41
eH1_2                -7.787341e-02 1 1  ON 42
eH1_3                -5.912819e-02 1 1  ON 43
eH1_4                 1.018060e-02 1 1  ON 44
eH1_5                 5.522694e-02 1 1  ON 45
eH1_6                 9.033829e-02 1 1  ON 46
eH1_7                 6.510158e-02 1 1  ON 47
eH1_8                 1.156564e-03 1 1  ON 48
eH1_9                 6.591497e-02 1 1  ON 49
eH2_0                -2.022485e-01 1 1  ON 50
eH2_1                -1.106691e-01 1 1  ON 51
eH2_2                -7.428391e-02 1 1  ON 52
eH2_3                -5.548393e-02 1 1  ON 53
eH2_4                 1.409758e-02 1 1  ON 54
eH2_5                 5.931424e-02 1 1  ON 55
eH2_6                 9.505662e-02 1 1  ON 56
eH2_7                 7.065208e-02 1 1  ON 57
eH2_8                 9.474073e-03 1 1  ON 58
eH2_9                 6.561425e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6375
    reference variance = 0.319313
====================================================
  Execution time = 4.3409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2084e-01
  Total weights = 2.0000e+06
  Execution time = 3.5356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983701662
                                         uncertainty =       0.011425936551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983701662
                                         uncertainty =       0.011425936551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510314456
  error estimate for blocks of size 2^( 2) =       0.000528028843
  error estimate for blocks of size 2^( 3) =       0.000543137219
  error estimate for blocks of size 2^( 4) =       0.000554282547
  error estimate for blocks of size 2^( 5) =       0.000561419253
  error estimate for blocks of size 2^( 6) =       0.000565590593
  error estimate for blocks of size 2^( 7) =       0.000566969662

      target function =                  N/A
              le_mean =     -22.669269605065
             les_mean =     514.416625853919
             stat err =       0.000562065514
             autocorr =       1.213104286275
              std dev =       0.721693624190
             le_variance =       0.520841687196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983664897
                                         uncertainty =       0.011425968158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983664897
                                         uncertainty =       0.011425968158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510314438
  error estimate for blocks of size 2^( 2) =       0.000528028824
  error estimate for blocks of size 2^( 3) =       0.000543137203
  error estimate for blocks of size 2^( 4) =       0.000554282533
  error estimate for blocks of size 2^( 5) =       0.000561419240
  error estimate for blocks of size 2^( 6) =       0.000565590579
  error estimate for blocks of size 2^( 7) =       0.000566969652

      target function =                  N/A
              le_mean =     -22.669269606111
             les_mean =     514.416625864504
             stat err =       0.000562065501
             autocorr =       1.213104317887
              std dev =       0.721693598689
             le_variance =       0.520841650389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983683241
                                         uncertainty =       0.011425952350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983683241
                                         uncertainty =       0.011425952350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510314447
  error estimate for blocks of size 2^( 2) =       0.000528028833
  error estimate for blocks of size 2^( 3) =       0.000543137211
  error estimate for blocks of size 2^( 4) =       0.000554282540
  error estimate for blocks of size 2^( 5) =       0.000561419246
  error estimate for blocks of size 2^( 6) =       0.000565590586
  error estimate for blocks of size 2^( 7) =       0.000566969657

      target function =                  N/A
              le_mean =     -22.669269605589
             les_mean =     514.416625859206
             stat err =       0.000562065507
             autocorr =       1.213104302102
              std dev =       0.721693611413
             le_variance =       0.520841668754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983699358
                                         uncertainty =       0.011425938526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520983699358
                                         uncertainty =       0.011425938526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510314454
  error estimate for blocks of size 2^( 2) =       0.000528028842
  error estimate for blocks of size 2^( 3) =       0.000543137218
  error estimate for blocks of size 2^( 4) =       0.000554282546
  error estimate for blocks of size 2^( 5) =       0.000561419252
  error estimate for blocks of size 2^( 6) =       0.000565590592
  error estimate for blocks of size 2^( 7) =       0.000566969661

      target function =                  N/A
              le_mean =     -22.669269605131
             les_mean =     514.416625854580
             stat err =       0.000562065513
             autocorr =       1.213104288241
              std dev =       0.721693622592
             le_variance =       0.520841684890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669269605065        initial
     6.1035e+02     6.1035e+03             3.5773e-07       -22.669269606111  <--
     2.4414e+03     2.4414e+04             8.9436e-08       -22.669269605589
     9.7656e+03     9.7656e+04             2.2359e-08       -22.669269605131

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 6.1072e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.944188e-01 1 1  ON 0
 uu_1                 1.189481e-01 1 1  ON 1
 uu_2                 5.386468e-03 1 1  ON 2
 uu_3                -6.181214e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277911e-01 1 1  ON 5
 uu_6                -1.428694e-01 1 1  ON 6
 uu_7                -1.471657e-01 1 1  ON 7
 uu_8                -1.392106e-01 1 1  ON 8
 uu_9                -1.164318e-01 1 1  ON 9
 ud_0                 4.099239e-01 1 1  ON 10
 ud_1                 1.276933e-01 1 1  ON 11
 ud_2                -1.854204e-02 1 1  ON 12
 ud_3                -9.639811e-02 1 1  ON 13
 ud_4                -1.387854e-01 1 1  ON 14
 ud_5                -1.634489e-01 1 1  ON 15
 ud_6                -1.759643e-01 1 1  ON 16
 ud_7                -1.765391e-01 1 1  ON 17
 ud_8                -1.634114e-01 1 1  ON 18
 ud_9                -1.343551e-01 1 1  ON 19
 eC_0                -5.801131e-01 1 1  ON 20
 eC_1                -4.285467e-01 1 1  ON 21
 eC_2                -1.768513e-01 1 1  ON 22
 eC_3                -2.249326e-02 1 1  ON 23
 eC_4                 5.704296e-02 1 1  ON 24
 eC_5                 1.566316e-01 1 1  ON 25
 eC_6                 2.541441e-01 1 1  ON 26
 eC_7                 3.752721e-01 1 1  ON 27
 eC_8                 2.777566e-01 1 1  ON 28
 eC_9                 8.015203e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046146e-01 1 1  ON 31
 eO_2                -3.396568e-01 1 1  ON 32
 eO_3                 4.710948e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865527e-01 1 1  ON 35
 eO_6                 4.296734e-01 1 1  ON 36
 eO_7                 4.261653e-01 1 1  ON 37
 eO_8                 4.139544e-01 1 1  ON 38
 eO_9                 3.087028e-01 1 1  ON 39
eH1_0                -2.063724e-01 1 1  ON 40
eH1_1                -1.141461e-01 1 1  ON 41
eH1_2                -7.787347e-02 1 1  ON 42
eH1_3                -5.912828e-02 1 1  ON 43
eH1_4                 1.018065e-02 1 1  ON 44
eH1_5                 5.522690e-02 1 1  ON 45
eH1_6                 9.033832e-02 1 1  ON 46
eH1_7                 6.510163e-02 1 1  ON 47
eH1_8                 1.156832e-03 1 1  ON 48
eH1_9                 6.591491e-02 1 1  ON 49
eH2_0                -2.022488e-01 1 1  ON 50
eH2_1                -1.106692e-01 1 1  ON 51
eH2_2                -7.428397e-02 1 1  ON 52
eH2_3                -5.548385e-02 1 1  ON 53
eH2_4                 1.409778e-02 1 1  ON 54
eH2_5                 5.931411e-02 1 1  ON 55
eH2_6                 9.505656e-02 1 1  ON 56
eH2_7                 7.065215e-02 1 1  ON 57
eH2_8                 9.474248e-03 1 1  ON 58
eH2_9                 6.561424e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1974e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6314
    reference variance = 0.606257
====================================================
  Execution time = 4.4637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1251e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5033e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512560042960
                                         uncertainty =       0.004921185881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512560042960
                                         uncertainty =       0.004921185881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506218917
  error estimate for blocks of size 2^( 2) =       0.000523838316
  error estimate for blocks of size 2^( 3) =       0.000539108722
  error estimate for blocks of size 2^( 4) =       0.000550625185
  error estimate for blocks of size 2^( 5) =       0.000558048939
  error estimate for blocks of size 2^( 6) =       0.000562396922
  error estimate for blocks of size 2^( 7) =       0.000565903846

      target function =                  N/A
              le_mean =     -22.670266752180
             les_mean =     514.453509541778
             stat err =       0.000559243723
             autocorr =       1.220465469141
              std dev =       0.715901657382
             le_variance =       0.512515183042


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267026675218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670266752180       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670266754062       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670266758455       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670266765202       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670266763633       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670266765145       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670266765751       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670266767089       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670266767705       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670266767346       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.847874e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670266752180       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670266752651       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670266753751       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670266755440       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670266755047       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670266755426       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670266755577       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670266755915       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670266756067       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670266755978       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 4.622434e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670266752180       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670266752298       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670266752573       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670266752995       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670266752896       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670266752992       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670266753028       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670266753121       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670266753148       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670266753132       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 1.155781e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9678e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.944191e-01 1 1  ON 0
 uu_1                 1.189480e-01 1 1  ON 1
 uu_2                 5.386554e-03 1 1  ON 2
 uu_3                -6.181208e-02 1 1  ON 3
 uu_4                -1.020965e-01 1 1  ON 4
 uu_5                -1.277911e-01 1 1  ON 5
 uu_6                -1.428695e-01 1 1  ON 6
 uu_7                -1.471657e-01 1 1  ON 7
 uu_8                -1.392106e-01 1 1  ON 8
 uu_9                -1.164318e-01 1 1  ON 9
 ud_0                 4.099243e-01 1 1  ON 10
 ud_1                 1.276934e-01 1 1  ON 11
 ud_2                -1.854198e-02 1 1  ON 12
 ud_3                -9.639805e-02 1 1  ON 13
 ud_4                -1.387852e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759644e-01 1 1  ON 16
 ud_7                -1.765392e-01 1 1  ON 17
 ud_8                -1.634115e-01 1 1  ON 18
 ud_9                -1.343552e-01 1 1  ON 19
 eC_0                -5.801136e-01 1 1  ON 20
 eC_1                -4.285467e-01 1 1  ON 21
 eC_2                -1.768513e-01 1 1  ON 22
 eC_3                -2.249340e-02 1 1  ON 23
 eC_4                 5.704306e-02 1 1  ON 24
 eC_5                 1.566317e-01 1 1  ON 25
 eC_6                 2.541444e-01 1 1  ON 26
 eC_7                 3.752720e-01 1 1  ON 27
 eC_8                 2.777568e-01 1 1  ON 28
 eC_9                 8.015209e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046147e-01 1 1  ON 31
 eO_2                -3.396569e-01 1 1  ON 32
 eO_3                 4.708796e-04 1 1  ON 33
 eO_4                 2.233775e-01 1 1  ON 34
 eO_5                 3.865529e-01 1 1  ON 35
 eO_6                 4.296735e-01 1 1  ON 36
 eO_7                 4.261654e-01 1 1  ON 37
 eO_8                 4.139542e-01 1 1  ON 38
 eO_9                 3.087030e-01 1 1  ON 39
eH1_0                -2.063727e-01 1 1  ON 40
eH1_1                -1.141462e-01 1 1  ON 41
eH1_2                -7.787369e-02 1 1  ON 42
eH1_3                -5.912830e-02 1 1  ON 43
eH1_4                 1.018082e-02 1 1  ON 44
eH1_5                 5.522696e-02 1 1  ON 45
eH1_6                 9.033834e-02 1 1  ON 46
eH1_7                 6.510163e-02 1 1  ON 47
eH1_8                 1.157139e-03 1 1  ON 48
eH1_9                 6.591484e-02 1 1  ON 49
eH2_0                -2.022490e-01 1 1  ON 50
eH2_1                -1.106694e-01 1 1  ON 51
eH2_2                -7.428419e-02 1 1  ON 52
eH2_3                -5.548381e-02 1 1  ON 53
eH2_4                 1.409781e-02 1 1  ON 54
eH2_5                 5.931420e-02 1 1  ON 55
eH2_6                 9.505677e-02 1 1  ON 56
eH2_7                 7.065211e-02 1 1  ON 57
eH2_8                 9.474499e-03 1 1  ON 58
eH2_9                 6.561419e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.673
    reference variance = 0.324806
====================================================
  Execution time = 4.3537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0262e-01
  Total weights = 2.0000e+06
  Execution time = 3.5195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502618563697
                                         uncertainty =       0.002884683839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502618563697
                                         uncertainty =       0.002884683839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501308978
  error estimate for blocks of size 2^( 2) =       0.000519116953
  error estimate for blocks of size 2^( 3) =       0.000535439887
  error estimate for blocks of size 2^( 4) =       0.000546341405
  error estimate for blocks of size 2^( 5) =       0.000553870950
  error estimate for blocks of size 2^( 6) =       0.000556731843
  error estimate for blocks of size 2^( 7) =       0.000558360405

      target function =                  N/A
              le_mean =     -22.669481969999
             les_mean =     514.408033920062
             stat err =       0.000553826151
             autocorr =       1.220494851821
              std dev =       0.708957955932
             le_variance =       0.502621383279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502619817570
                                         uncertainty =       0.002884694447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502619817570
                                         uncertainty =       0.002884694447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501309604
  error estimate for blocks of size 2^( 2) =       0.000519117534
  error estimate for blocks of size 2^( 3) =       0.000535440422
  error estimate for blocks of size 2^( 4) =       0.000546341919
  error estimate for blocks of size 2^( 5) =       0.000553871432
  error estimate for blocks of size 2^( 6) =       0.000556732313
  error estimate for blocks of size 2^( 7) =       0.000558360847

      target function =                  N/A
              le_mean =     -22.669481983543
             les_mean =     514.408035788744
             stat err =       0.000553826628
             autocorr =       1.220493906804
              std dev =       0.708958840761
             le_variance =       0.502622637893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502619191837
                                         uncertainty =       0.002884689154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502619191837
                                         uncertainty =       0.002884689154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501309292
  error estimate for blocks of size 2^( 2) =       0.000519117244
  error estimate for blocks of size 2^( 3) =       0.000535440155
  error estimate for blocks of size 2^( 4) =       0.000546341662
  error estimate for blocks of size 2^( 5) =       0.000553871191
  error estimate for blocks of size 2^( 6) =       0.000556732078
  error estimate for blocks of size 2^( 7) =       0.000558360627

      target function =                  N/A
              le_mean =     -22.669481976779
             les_mean =     514.408034855996
             stat err =       0.000553826390
             autocorr =       1.220494378420
              std dev =       0.708958399195
             le_variance =       0.502622011790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502618642251
                                         uncertainty =       0.002884684503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502618642251
                                         uncertainty =       0.002884684503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501309017
  error estimate for blocks of size 2^( 2) =       0.000519116990
  error estimate for blocks of size 2^( 3) =       0.000535439921
  error estimate for blocks of size 2^( 4) =       0.000546341437
  error estimate for blocks of size 2^( 5) =       0.000553870980
  error estimate for blocks of size 2^( 6) =       0.000556731873
  error estimate for blocks of size 2^( 7) =       0.000558360433

      target function =                  N/A
              le_mean =     -22.669481970846
             les_mean =     514.408034037093
             stat err =       0.000553826181
             autocorr =       1.220494792622
              std dev =       0.708958011365
             le_variance =       0.502621461879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669481969999        initial
     1.5259e+02     1.5259e+03             1.8479e-06       -22.669481983543  <--
     6.1035e+02     6.1035e+03             4.6224e-07       -22.669481976779
     2.4414e+03     2.4414e+04             1.1558e-07       -22.669481970846

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 6.1162e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386813e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702352e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2085e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6933
    reference variance = 0.41498
====================================================
  Execution time = 4.3601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.3427e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4941e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534389834762
                                         uncertainty =       0.020787046146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534389834762
                                         uncertainty =       0.020787046146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516850871
  error estimate for blocks of size 2^( 2) =       0.000534369366
  error estimate for blocks of size 2^( 3) =       0.000548573186
  error estimate for blocks of size 2^( 4) =       0.000558773688
  error estimate for blocks of size 2^( 5) =       0.000566178733
  error estimate for blocks of size 2^( 6) =       0.000568219665
  error estimate for blocks of size 2^( 7) =       0.000568926527

      target function =                  N/A
              le_mean =     -22.669843925501
             les_mean =     514.456092986119
             stat err =       0.000565524653
             autocorr =       1.197216182983
              std dev =       0.730937512155
             le_variance =       0.534269646675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266984392550e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669843925501       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669843951817       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669843981887       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669844001712       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669844026667       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669844038485       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669844035646       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669844029675       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669844020668       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669844023419       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+01 is 6.276536e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669843925501       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669843932108       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669843939675       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669843944689       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669843951023       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669843954019       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669843953348       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669843951871       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669843949584       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669843950246       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+02 is 1.571037e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669843925501       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669843927155       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669843929049       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669843930306       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669843931896       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669843932648       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669843932482       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669843932115       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669843931541       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669843931703       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.928785e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8549e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.944193e-01 1 1  ON 0
 uu_1                 1.189471e-01 1 1  ON 1
 uu_2                 5.386927e-03 1 1  ON 2
 uu_3                -6.181209e-02 1 1  ON 3
 uu_4                -1.020967e-01 1 1  ON 4
 uu_5                -1.277914e-01 1 1  ON 5
 uu_6                -1.428695e-01 1 1  ON 6
 uu_7                -1.471647e-01 1 1  ON 7
 uu_8                -1.392107e-01 1 1  ON 8
 uu_9                -1.164310e-01 1 1  ON 9
 ud_0                 4.099259e-01 1 1  ON 10
 ud_1                 1.276941e-01 1 1  ON 11
 ud_2                -1.854097e-02 1 1  ON 12
 ud_3                -9.639752e-02 1 1  ON 13
 ud_4                -1.387848e-01 1 1  ON 14
 ud_5                -1.634480e-01 1 1  ON 15
 ud_6                -1.759655e-01 1 1  ON 16
 ud_7                -1.765406e-01 1 1  ON 17
 ud_8                -1.634125e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801158e-01 1 1  ON 20
 eC_1                -4.285478e-01 1 1  ON 21
 eC_2                -1.768516e-01 1 1  ON 22
 eC_3                -2.249409e-02 1 1  ON 23
 eC_4                 5.704383e-02 1 1  ON 24
 eC_5                 1.566329e-01 1 1  ON 25
 eC_6                 2.541455e-01 1 1  ON 26
 eC_7                 3.752716e-01 1 1  ON 27
 eC_8                 2.777577e-01 1 1  ON 28
 eC_9                 8.015269e-02 1 1  ON 29
 eO_0                -1.181194e+00 1 1  ON 30
 eO_1                -8.046146e-01 1 1  ON 31
 eO_2                -3.396582e-01 1 1  ON 32
 eO_3                 4.698288e-04 1 1  ON 33
 eO_4                 2.233774e-01 1 1  ON 34
 eO_5                 3.865532e-01 1 1  ON 35
 eO_6                 4.296755e-01 1 1  ON 36
 eO_7                 4.261667e-01 1 1  ON 37
 eO_8                 4.139529e-01 1 1  ON 38
 eO_9                 3.087038e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141471e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912832e-02 1 1  ON 43
eH1_4                 1.018147e-02 1 1  ON 44
eH1_5                 5.522663e-02 1 1  ON 45
eH1_6                 9.033826e-02 1 1  ON 46
eH1_7                 6.510153e-02 1 1  ON 47
eH1_8                 1.159088e-03 1 1  ON 48
eH1_9                 6.591445e-02 1 1  ON 49
eH2_0                -2.022507e-01 1 1  ON 50
eH2_1                -1.106703e-01 1 1  ON 51
eH2_2                -7.428486e-02 1 1  ON 52
eH2_3                -5.548290e-02 1 1  ON 53
eH2_4                 1.409822e-02 1 1  ON 54
eH2_5                 5.931452e-02 1 1  ON 55
eH2_6                 9.505704e-02 1 1  ON 56
eH2_7                 7.065152e-02 1 1  ON 57
eH2_8                 9.476076e-03 1 1  ON 58
eH2_9                 6.561389e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7684
    reference variance = 0.497772
====================================================
  Execution time = 4.2590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0892e-01
  Total weights = 2.0000e+06
  Execution time = 3.5294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508952218889
                                         uncertainty =       0.004005343253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508952218889
                                         uncertainty =       0.004005343253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504438433
  error estimate for blocks of size 2^( 2) =       0.000522248966
  error estimate for blocks of size 2^( 3) =       0.000537942969
  error estimate for blocks of size 2^( 4) =       0.000548871646
  error estimate for blocks of size 2^( 5) =       0.000554181802
  error estimate for blocks of size 2^( 6) =       0.000556347526
  error estimate for blocks of size 2^( 7) =       0.000557547007

      target function =                  N/A
              le_mean =     -22.670315360230
             les_mean =     514.452114543884
             stat err =       0.000554236995
             autocorr =       1.207187379985
              std dev =       0.713383673806
             le_variance =       0.508916266053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508951233967
                                         uncertainty =       0.004005361081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508951233967
                                         uncertainty =       0.004005361081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504437947
  error estimate for blocks of size 2^( 2) =       0.000522248514
  error estimate for blocks of size 2^( 3) =       0.000537942520
  error estimate for blocks of size 2^( 4) =       0.000548871178
  error estimate for blocks of size 2^( 5) =       0.000554181258
  error estimate for blocks of size 2^( 6) =       0.000556346983
  error estimate for blocks of size 2^( 7) =       0.000557546507

      target function =                  N/A
              le_mean =     -22.670315329123
             les_mean =     514.452112151557
             stat err =       0.000554236481
             autocorr =       1.207187470501
              std dev =       0.713382985593
             le_variance =       0.508915284134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508951714655
                                         uncertainty =       0.004005352151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508951714655
                                         uncertainty =       0.004005352151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504438184
  error estimate for blocks of size 2^( 2) =       0.000522248735
  error estimate for blocks of size 2^( 3) =       0.000537942740
  error estimate for blocks of size 2^( 4) =       0.000548871407
  error estimate for blocks of size 2^( 5) =       0.000554181525
  error estimate for blocks of size 2^( 6) =       0.000556347249
  error estimate for blocks of size 2^( 7) =       0.000557546752

      target function =                  N/A
              le_mean =     -22.670315344462
             les_mean =     514.452113326227
             stat err =       0.000554236733
             autocorr =       1.207187431516
              std dev =       0.713383321457
             le_variance =       0.508915763332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508952155455
                                         uncertainty =       0.004005344365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508952155455
                                         uncertainty =       0.004005344365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504438402
  error estimate for blocks of size 2^( 2) =       0.000522248937
  error estimate for blocks of size 2^( 3) =       0.000537942940
  error estimate for blocks of size 2^( 4) =       0.000548871616
  error estimate for blocks of size 2^( 5) =       0.000554181768
  error estimate for blocks of size 2^( 6) =       0.000556347491
  error estimate for blocks of size 2^( 7) =       0.000557546975

      target function =                  N/A
              le_mean =     -22.670315358248
             les_mean =     514.452114390777
             stat err =       0.000554236962
             autocorr =       1.207187386617
              std dev =       0.713383629479
             le_variance =       0.508916202808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670315360230        initial  <--
     3.8147e+01     3.8147e+02             6.2765e-06       -22.670315329123
     1.5259e+02     1.5259e+03             1.5710e-06       -22.670315344462
     6.1035e+02     6.1035e+03             3.9288e-07       -22.670315358248

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.2682
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386813e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702352e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1882e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.5631
    reference variance = 0.242432
====================================================
  Execution time = 4.3691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5008e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516133048608
                                         uncertainty =       0.006251555542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516133048608
                                         uncertainty =       0.006251555542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507956955
  error estimate for blocks of size 2^( 2) =       0.000525244304
  error estimate for blocks of size 2^( 3) =       0.000540250268
  error estimate for blocks of size 2^( 4) =       0.000552195718
  error estimate for blocks of size 2^( 5) =       0.000559546137
  error estimate for blocks of size 2^( 6) =       0.000564756169
  error estimate for blocks of size 2^( 7) =       0.000564400935

      target function =                  N/A
              le_mean =     -22.668917794184
             les_mean =     514.395874236937
             stat err =       0.000560224740
             autocorr =       1.216384129931
              std dev =       0.718359614321
             le_variance =       0.516040535487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266891779418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668917794184       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668917795133       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668917795359       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668917797873       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668917800536       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668917800469       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668917801748       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668917802234       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668917802228       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668917802116       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+02 is 7.546327e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668917794184       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668917794421       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668917794478       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668917795106       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668917795773       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668917795756       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668917796074       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668917796195       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668917796193       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668917796165       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+03 is 1.887182e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668917794184       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668917794243       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668917794257       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668917794418       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668917794582       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668917794576       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668917794655       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668917794696       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668917794700       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668917794689       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+03 is 4.718329e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8706e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.944199e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386766e-03 1 1  ON 2
 uu_3                -6.181196e-02 1 1  ON 3
 uu_4                -1.020967e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471654e-01 1 1  ON 7
 uu_8                -1.392107e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099253e-01 1 1  ON 10
 ud_1                 1.276938e-01 1 1  ON 11
 ud_2                -1.854175e-02 1 1  ON 12
 ud_3                -9.639787e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759647e-01 1 1  ON 16
 ud_7                -1.765397e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285470e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249387e-02 1 1  ON 23
 eC_4                 5.704346e-02 1 1  ON 24
 eC_5                 1.566323e-01 1 1  ON 25
 eC_6                 2.541453e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015232e-02 1 1  ON 29
 eO_0                -1.181193e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702007e-04 1 1  ON 33
 eO_4                 2.233777e-01 1 1  ON 34
 eO_5                 3.865534e-01 1 1  ON 35
 eO_6                 4.296740e-01 1 1  ON 36
 eO_7                 4.261657e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063735e-01 1 1  ON 40
eH1_1                -1.141466e-01 1 1  ON 41
eH1_2                -7.787429e-02 1 1  ON 42
eH1_3                -5.912840e-02 1 1  ON 43
eH1_4                 1.018141e-02 1 1  ON 44
eH1_5                 5.522709e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510168e-02 1 1  ON 47
eH1_8                 1.158172e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022498e-01 1 1  ON 50
eH2_1                -1.106701e-01 1 1  ON 51
eH2_2                -7.428487e-02 1 1  ON 52
eH2_3                -5.548361e-02 1 1  ON 53
eH2_4                 1.409798e-02 1 1  ON 54
eH2_5                 5.931451e-02 1 1  ON 55
eH2_6                 9.505740e-02 1 1  ON 56
eH2_7                 7.065202e-02 1 1  ON 57
eH2_8                 9.475345e-03 1 1  ON 58
eH2_9                 6.561404e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6758
    reference variance = 0.343265
====================================================
  Execution time = 4.3052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2868e-01
  Total weights = 2.0000e+06
  Execution time = 4.0146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528809714400
                                         uncertainty =       0.009540288345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528809714400
                                         uncertainty =       0.009540288345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514140289
  error estimate for blocks of size 2^( 2) =       0.000531621235
  error estimate for blocks of size 2^( 3) =       0.000546563005
  error estimate for blocks of size 2^( 4) =       0.000557067151
  error estimate for blocks of size 2^( 5) =       0.000564896904
  error estimate for blocks of size 2^( 6) =       0.000569716004
  error estimate for blocks of size 2^( 7) =       0.000571088305

      target function =                  N/A
              le_mean =     -22.669285250091
             les_mean =     514.425173960006
             stat err =       0.000565692091
             autocorr =       1.210589598486
              std dev =       0.727104170219
             le_variance =       0.528680474350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528810241042
                                         uncertainty =       0.009540313180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528810241042
                                         uncertainty =       0.009540313180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514140545
  error estimate for blocks of size 2^( 2) =       0.000531621478
  error estimate for blocks of size 2^( 3) =       0.000546563225
  error estimate for blocks of size 2^( 4) =       0.000557067360
  error estimate for blocks of size 2^( 5) =       0.000564897105
  error estimate for blocks of size 2^( 6) =       0.000569716206
  error estimate for blocks of size 2^( 7) =       0.000571088480

      target function =                  N/A
              le_mean =     -22.669285248758
             les_mean =     514.425174426216
             stat err =       0.000565692287
             autocorr =       1.210589233621
              std dev =       0.727104532374
             le_variance =       0.528681000999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528809977718
                                         uncertainty =       0.009540300766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528809977718
                                         uncertainty =       0.009540300766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514140417
  error estimate for blocks of size 2^( 2) =       0.000531621356
  error estimate for blocks of size 2^( 3) =       0.000546563115
  error estimate for blocks of size 2^( 4) =       0.000557067255
  error estimate for blocks of size 2^( 5) =       0.000564897004
  error estimate for blocks of size 2^( 6) =       0.000569716105
  error estimate for blocks of size 2^( 7) =       0.000571088392

      target function =                  N/A
              le_mean =     -22.669285249424
             les_mean =     514.425174193071
             stat err =       0.000565692189
             autocorr =       1.210589416021
              std dev =       0.727104351295
             le_variance =       0.528680737672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528809747314
                                         uncertainty =       0.009540289897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528809747314
                                         uncertainty =       0.009540289897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514140305
  error estimate for blocks of size 2^( 2) =       0.000531621250
  error estimate for blocks of size 2^( 3) =       0.000546563019
  error estimate for blocks of size 2^( 4) =       0.000557067164
  error estimate for blocks of size 2^( 5) =       0.000564896916
  error estimate for blocks of size 2^( 6) =       0.000569716016
  error estimate for blocks of size 2^( 7) =       0.000571088316

      target function =                  N/A
              le_mean =     -22.669285250008
             les_mean =     514.425173989135
             stat err =       0.000565692103
             autocorr =       1.210589575682
              std dev =       0.727104192853
             le_variance =       0.528680507265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669285250091        initial  <--
     3.8147e+02     3.8147e+03             7.5463e-07       -22.669285248758
     1.5259e+03     1.5259e+04             1.8872e-07       -22.669285249424
     6.1035e+03     6.1035e+04             4.7183e-08       -22.669285250008

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7647
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386813e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702352e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2048e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7387
    reference variance = 0.473946
====================================================
  Execution time = 4.3735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1287e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4921e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512840141581
                                         uncertainty =       0.004323139591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512840141581
                                         uncertainty =       0.004323139591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506393558
  error estimate for blocks of size 2^( 2) =       0.000523521227
  error estimate for blocks of size 2^( 3) =       0.000539417925
  error estimate for blocks of size 2^( 4) =       0.000551926966
  error estimate for blocks of size 2^( 5) =       0.000558679876
  error estimate for blocks of size 2^( 6) =       0.000562634952
  error estimate for blocks of size 2^( 7) =       0.000562611712

      target function =                  N/A
              le_mean =     -22.669886107259
             les_mean =     514.436604730843
             stat err =       0.000558963377
             autocorr =       1.218401325773
              std dev =       0.716148637633
             le_variance =       0.512868871184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266988610726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669886107259       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669886107530       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669886107540       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669886107578       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669886107416       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669886107456       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669886107513       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669886107537       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669886107551       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669886107532       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+03 is 6.730599e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669886107259       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669886107327       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669886107329       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669886107339       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669886107297       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669886107304       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669886107320       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669886107309       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669886107368       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669886107345       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 1.682681e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669886107259       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669886107276       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669886107277       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669886107279       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669886107276       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669886107234       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669886107282       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669886107300       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669886107276       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669886107275       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 4.206721e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8663e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386815e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181193e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702308e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865534e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018137e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158072e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065200e-02 1 1  ON 57
eH2_8                 9.475262e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.5361
    reference variance = 0.392136
====================================================
  Execution time = 4.3516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0988e-01
  Total weights = 2.0000e+06
  Execution time = 3.5319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983965715
                                         uncertainty =       0.003425297728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983965715
                                         uncertainty =       0.003425297728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504914692
  error estimate for blocks of size 2^( 2) =       0.000522139787
  error estimate for blocks of size 2^( 3) =       0.000537687440
  error estimate for blocks of size 2^( 4) =       0.000549472569
  error estimate for blocks of size 2^( 5) =       0.000555449553
  error estimate for blocks of size 2^( 6) =       0.000560634519
  error estimate for blocks of size 2^( 7) =       0.000564913861

      target function =                  N/A
              le_mean =     -22.670007208403
             les_mean =     514.439104266492
             stat err =       0.000557617626
             autocorr =       1.219654913049
              std dev =       0.714057205268
             le_variance =       0.509877692396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983937385
                                         uncertainty =       0.003425297487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983937385
                                         uncertainty =       0.003425297487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504914678
  error estimate for blocks of size 2^( 2) =       0.000522139774
  error estimate for blocks of size 2^( 3) =       0.000537687427
  error estimate for blocks of size 2^( 4) =       0.000549472556
  error estimate for blocks of size 2^( 5) =       0.000555449540
  error estimate for blocks of size 2^( 6) =       0.000560634505
  error estimate for blocks of size 2^( 7) =       0.000564913848

      target function =                  N/A
              le_mean =     -22.670007208089
             les_mean =     514.439104223962
             stat err =       0.000557617612
             autocorr =       1.219654922239
              std dev =       0.714057185441
             le_variance =       0.509877664079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983951547
                                         uncertainty =       0.003425297607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983951547
                                         uncertainty =       0.003425297607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504914685
  error estimate for blocks of size 2^( 2) =       0.000522139781
  error estimate for blocks of size 2^( 3) =       0.000537687434
  error estimate for blocks of size 2^( 4) =       0.000549472562
  error estimate for blocks of size 2^( 5) =       0.000555449546
  error estimate for blocks of size 2^( 6) =       0.000560634512
  error estimate for blocks of size 2^( 7) =       0.000564913855

      target function =                  N/A
              le_mean =     -22.670007208246
             les_mean =     514.439104245223
             stat err =       0.000557617619
             autocorr =       1.219654917640
              std dev =       0.714057195353
             le_variance =       0.509877678235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983963944
                                         uncertainty =       0.003425297712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509983963944
                                         uncertainty =       0.003425297712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504914691
  error estimate for blocks of size 2^( 2) =       0.000522139786
  error estimate for blocks of size 2^( 3) =       0.000537687439
  error estimate for blocks of size 2^( 4) =       0.000549472568
  error estimate for blocks of size 2^( 5) =       0.000555449552
  error estimate for blocks of size 2^( 6) =       0.000560634518
  error estimate for blocks of size 2^( 7) =       0.000564913861

      target function =                  N/A
              le_mean =     -22.670007208383
             les_mean =     514.439104263833
             stat err =       0.000557617625
             autocorr =       1.219654913621
              std dev =       0.714057204029
             le_variance =       0.509877690625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670007208403        initial  <--
     3.8147e+03     3.8147e+04             6.7306e-08       -22.670007208089
     1.5259e+04     1.5259e+05             1.6827e-08       -22.670007208246
     6.1035e+04     6.1035e+05             4.2067e-09       -22.670007208383

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2608
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386813e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702352e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1993e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6993
    reference variance = 0.345069
====================================================
  Execution time = 4.3974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1407e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4936e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514095870693
                                         uncertainty =       0.005058431110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514095870693
                                         uncertainty =       0.005058431110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506985072
  error estimate for blocks of size 2^( 2) =       0.000524811340
  error estimate for blocks of size 2^( 3) =       0.000540744016
  error estimate for blocks of size 2^( 4) =       0.000552335206
  error estimate for blocks of size 2^( 5) =       0.000558655543
  error estimate for blocks of size 2^( 6) =       0.000560137998
  error estimate for blocks of size 2^( 7) =       0.000560975686

      target function =                  N/A
              le_mean =     -22.669978911682
             les_mean =     514.442011326251
             stat err =       0.000558026108
             autocorr =       1.211486817220
              std dev =       0.716985165241
             le_variance =       0.514067727175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266997891168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669978911682       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669978911691       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669978911694       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669978911689       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669978911718       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669978911741       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669978911732       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669978911771       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669978911529       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669978911637       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 5.914037e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669978911682       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669978911684       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669978911685       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669978911686       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669978911615       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669978911573       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669978911677       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669978911478       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669978911662       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669978911683       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 1.478510e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669978911682       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669978911683       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669978911683       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669978911681       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669978911905       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669978911696       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669978911201       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669978909144       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669978912037       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669978910145       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 3.696281e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8917e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702346e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158061e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5901
    reference variance = 0.489446
====================================================
  Execution time = 4.2789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1055e-01
  Total weights = 2.0000e+06
  Execution time = 3.5237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704218286
                                         uncertainty =       0.004605718686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704218286
                                         uncertainty =       0.004605718686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505249858
  error estimate for blocks of size 2^( 2) =       0.000523018082
  error estimate for blocks of size 2^( 3) =       0.000538838781
  error estimate for blocks of size 2^( 4) =       0.000549654093
  error estimate for blocks of size 2^( 5) =       0.000555885916
  error estimate for blocks of size 2^( 6) =       0.000560533984
  error estimate for blocks of size 2^( 7) =       0.000562941685

      target function =                  N/A
              le_mean =     -22.669644291847
             les_mean =     514.423326900985
             stat err =       0.000557253920
             autocorr =       1.216448883379
              std dev =       0.714531201119
             le_variance =       0.510554837373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704217261
                                         uncertainty =       0.004605718650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704217261
                                         uncertainty =       0.004605718650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505249857
  error estimate for blocks of size 2^( 2) =       0.000523018081
  error estimate for blocks of size 2^( 3) =       0.000538838780
  error estimate for blocks of size 2^( 4) =       0.000549654092
  error estimate for blocks of size 2^( 5) =       0.000555885915
  error estimate for blocks of size 2^( 6) =       0.000560533983
  error estimate for blocks of size 2^( 7) =       0.000562941685

      target function =                  N/A
              le_mean =     -22.669644291835
             les_mean =     514.423326899409
             stat err =       0.000557253919
             autocorr =       1.216448882544
              std dev =       0.714531200402
             le_variance =       0.510554836348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704217773
                                         uncertainty =       0.004605718668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704217773
                                         uncertainty =       0.004605718668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505249857
  error estimate for blocks of size 2^( 2) =       0.000523018082
  error estimate for blocks of size 2^( 3) =       0.000538838780
  error estimate for blocks of size 2^( 4) =       0.000549654093
  error estimate for blocks of size 2^( 5) =       0.000555885916
  error estimate for blocks of size 2^( 6) =       0.000560533984
  error estimate for blocks of size 2^( 7) =       0.000562941685

      target function =                  N/A
              le_mean =     -22.669644291841
             les_mean =     514.423326900197
             stat err =       0.000557253919
             autocorr =       1.216448882957
              std dev =       0.714531200761
             le_variance =       0.510554836860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704218222
                                         uncertainty =       0.004605718683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510704218222
                                         uncertainty =       0.004605718683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505249858
  error estimate for blocks of size 2^( 2) =       0.000523018082
  error estimate for blocks of size 2^( 3) =       0.000538838781
  error estimate for blocks of size 2^( 4) =       0.000549654093
  error estimate for blocks of size 2^( 5) =       0.000555885916
  error estimate for blocks of size 2^( 6) =       0.000560533984
  error estimate for blocks of size 2^( 7) =       0.000562941685

      target function =                  N/A
              le_mean =     -22.669644291847
             les_mean =     514.423326900886
             stat err =       0.000557253920
             autocorr =       1.216448883327
              std dev =       0.714531201075
             le_variance =       0.510554837309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669644291847        initial  <--
     3.8147e+04     3.8147e+05             5.9140e-09       -22.669644291835
     1.5259e+05     1.5259e+06             1.4785e-09       -22.669644291841
     6.1035e+05     6.1035e+06             3.6963e-10       -22.669644291847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4357
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386813e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702352e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1936e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6238
    reference variance = 0.469024
====================================================
  Execution time = 4.4131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1356e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5131e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513576308446
                                         uncertainty =       0.004233267542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513576308446
                                         uncertainty =       0.004233267542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506733503
  error estimate for blocks of size 2^( 2) =       0.000524035673
  error estimate for blocks of size 2^( 3) =       0.000539358461
  error estimate for blocks of size 2^( 4) =       0.000550004767
  error estimate for blocks of size 2^( 5) =       0.000557804175
  error estimate for blocks of size 2^( 6) =       0.000561385531
  error estimate for blocks of size 2^( 7) =       0.000564907864

      target function =                  N/A
              le_mean =     -22.669945808012
             les_mean =     514.440000367506
             stat err =       0.000558525584
             autocorr =       1.214861880425
              std dev =       0.716629392425
             le_variance =       0.513557686087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266994580801e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669945808012       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669945808012       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669945808010       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669945807937       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669945807989       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669945808004       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669945807993       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669945807602       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669945807780       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669945808377       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 7.283674e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669945808012       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669945808012       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669945808012       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669945808011       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669945808179       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669945808114       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669945808533       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669945808349       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669945807936       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669945811487       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+06 is 1.820918e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669945808012       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669945808012       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669945808012       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669945804943       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669945809890       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669945808594       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669945814343       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669945810303       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669945806881       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669945811181       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+06 is 4.552250e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9269e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702351e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7705
    reference variance = 0.814906
====================================================
  Execution time = 4.3677e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1319e-01
  Total weights = 2.0000e+06
  Execution time = 3.5306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581901
                                         uncertainty =       0.004767233437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581901
                                         uncertainty =       0.004767233437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506550831
  error estimate for blocks of size 2^( 2) =       0.000524111232
  error estimate for blocks of size 2^( 3) =       0.000539629524
  error estimate for blocks of size 2^( 4) =       0.000550180719
  error estimate for blocks of size 2^( 5) =       0.000558237068
  error estimate for blocks of size 2^( 6) =       0.000560058354
  error estimate for blocks of size 2^( 7) =       0.000564697927

      target function =                  N/A
              le_mean =     -22.669626834622
             les_mean =     514.425168053503
             stat err =       0.000558293517
             autocorr =       1.214728176055
              std dev =       0.716371055455
             le_variance =       0.513187489094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581299
                                         uncertainty =       0.004767233434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581299
                                         uncertainty =       0.004767233434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506550831
  error estimate for blocks of size 2^( 2) =       0.000524111232
  error estimate for blocks of size 2^( 3) =       0.000539629524
  error estimate for blocks of size 2^( 4) =       0.000550180719
  error estimate for blocks of size 2^( 5) =       0.000558237068
  error estimate for blocks of size 2^( 6) =       0.000560058354
  error estimate for blocks of size 2^( 7) =       0.000564697927

      target function =                  N/A
              le_mean =     -22.669626834622
             les_mean =     514.425168052909
             stat err =       0.000558293517
             autocorr =       1.214728176346
              std dev =       0.716371055034
             le_variance =       0.513187488491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581600
                                         uncertainty =       0.004767233435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581600
                                         uncertainty =       0.004767233435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506550831
  error estimate for blocks of size 2^( 2) =       0.000524111232
  error estimate for blocks of size 2^( 3) =       0.000539629524
  error estimate for blocks of size 2^( 4) =       0.000550180719
  error estimate for blocks of size 2^( 5) =       0.000558237068
  error estimate for blocks of size 2^( 6) =       0.000560058354
  error estimate for blocks of size 2^( 7) =       0.000564697927

      target function =                  N/A
              le_mean =     -22.669626834622
             les_mean =     514.425168053206
             stat err =       0.000558293517
             autocorr =       1.214728176199
              std dev =       0.716371055245
             le_variance =       0.513187488792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581864
                                         uncertainty =       0.004767233437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513249581864
                                         uncertainty =       0.004767233437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506550831
  error estimate for blocks of size 2^( 2) =       0.000524111232
  error estimate for blocks of size 2^( 3) =       0.000539629524
  error estimate for blocks of size 2^( 4) =       0.000550180719
  error estimate for blocks of size 2^( 5) =       0.000558237068
  error estimate for blocks of size 2^( 6) =       0.000560058354
  error estimate for blocks of size 2^( 7) =       0.000564697927

      target function =                  N/A
              le_mean =     -22.669626834622
             les_mean =     514.425168053466
             stat err =       0.000558293517
             autocorr =       1.214728176072
              std dev =       0.716371055428
             le_variance =       0.513187489056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669626834622        initial
     3.8147e+05     3.8147e+06             7.2837e-10       -22.669626834622  <--
     1.5259e+06     1.5259e+07             1.8209e-10       -22.669626834622
     6.1035e+06     6.1035e+07             4.5522e-11       -22.669626834622

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 6.1366e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2064e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6267
    reference variance = 0.336791
====================================================
  Execution time = 4.3958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1651e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5008e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516626406727
                                         uncertainty =       0.005853100809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516626406727
                                         uncertainty =       0.005853100809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508190383
  error estimate for blocks of size 2^( 2) =       0.000526238568
  error estimate for blocks of size 2^( 3) =       0.000542064170
  error estimate for blocks of size 2^( 4) =       0.000553270128
  error estimate for blocks of size 2^( 5) =       0.000558908488
  error estimate for blocks of size 2^( 6) =       0.000561859997
  error estimate for blocks of size 2^( 7) =       0.000560814431

      target function =                  N/A
              le_mean =     -22.670167053306
             les_mean =     514.452988896959
             stat err =       0.000558713261
             autocorr =       1.208718236714
              std dev =       0.718689731683
             le_variance =       0.516514930427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267016705331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670167053306       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670167053295       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670167053286       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670167053276       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670167053316       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670167053286       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670167053237       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670167053351       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670167053070       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670167053283       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670167053825       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 2.887988e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670167053306       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670167053303       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670167053301       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670167053298       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670167053296       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670167053292       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670167053365       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670167053129       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670167053801       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670167054402       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670167054675       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 7.219964e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670167053306       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670167053305       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670167053305       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670167053304       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670167053688       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670167052707       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670167053115       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670167052975       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670167053867       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670167052653       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670167056304       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+06 is 1.804990e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189414 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8975e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6546
    reference variance = 0.706749
====================================================
  Execution time = 4.3208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0661e-01
  Total weights = 2.0000e+06
  Execution time = 3.5338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436583128
                                         uncertainty =       0.002857242732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436583128
                                         uncertainty =       0.002857242732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503294279
  error estimate for blocks of size 2^( 2) =       0.000520667041
  error estimate for blocks of size 2^( 3) =       0.000536030811
  error estimate for blocks of size 2^( 4) =       0.000548130438
  error estimate for blocks of size 2^( 5) =       0.000555321730
  error estimate for blocks of size 2^( 6) =       0.000557842363
  error estimate for blocks of size 2^( 7) =       0.000558967576

      target function =                  N/A
              le_mean =     -22.668994828323
             les_mean =     514.389936536213
             stat err =       0.000555065526
             autocorr =       1.216310686876
              std dev =       0.711765595548
             le_variance =       0.506610263005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436582716
                                         uncertainty =       0.002857242726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436582716
                                         uncertainty =       0.002857242726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503294279
  error estimate for blocks of size 2^( 2) =       0.000520667041
  error estimate for blocks of size 2^( 3) =       0.000536030811
  error estimate for blocks of size 2^( 4) =       0.000548130437
  error estimate for blocks of size 2^( 5) =       0.000555321729
  error estimate for blocks of size 2^( 6) =       0.000557842362
  error estimate for blocks of size 2^( 7) =       0.000558967575

      target function =                  N/A
              le_mean =     -22.668994828293
             les_mean =     514.389936534470
             stat err =       0.000555065526
             autocorr =       1.216310686575
              std dev =       0.711765595259
             le_variance =       0.506610262595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436582922
                                         uncertainty =       0.002857242729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436582922
                                         uncertainty =       0.002857242729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503294279
  error estimate for blocks of size 2^( 2) =       0.000520667041
  error estimate for blocks of size 2^( 3) =       0.000536030811
  error estimate for blocks of size 2^( 4) =       0.000548130437
  error estimate for blocks of size 2^( 5) =       0.000555321729
  error estimate for blocks of size 2^( 6) =       0.000557842362
  error estimate for blocks of size 2^( 7) =       0.000558967575

      target function =                  N/A
              le_mean =     -22.668994828308
             les_mean =     514.389936535341
             stat err =       0.000555065526
             autocorr =       1.216310686723
              std dev =       0.711765595404
             le_variance =       0.506610262800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436583102
                                         uncertainty =       0.002857242731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506436583102
                                         uncertainty =       0.002857242731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503294279
  error estimate for blocks of size 2^( 2) =       0.000520667041
  error estimate for blocks of size 2^( 3) =       0.000536030811
  error estimate for blocks of size 2^( 4) =       0.000548130438
  error estimate for blocks of size 2^( 5) =       0.000555321730
  error estimate for blocks of size 2^( 6) =       0.000557842363
  error estimate for blocks of size 2^( 7) =       0.000558967576

      target function =                  N/A
              le_mean =     -22.668994828321
             les_mean =     514.389936536104
             stat err =       0.000555065526
             autocorr =       1.216310686856
              std dev =       0.711765595530
             le_variance =       0.506610262980


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668994828323        initial  <--
     9.5367e+04     9.5367e+05             2.8880e-09       -22.668994828293
     3.8147e+05     3.8147e+06             7.2200e-10       -22.668994828308
     1.5259e+06     1.5259e+07             1.8050e-10       -22.668994828321

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9099
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1992e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6945
    reference variance = 0.37846
====================================================
  Execution time = 4.3825e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0659e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5056e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506507558455
                                         uncertainty =       0.003285624614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506507558455
                                         uncertainty =       0.003285624614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503282443
  error estimate for blocks of size 2^( 2) =       0.000521080202
  error estimate for blocks of size 2^( 3) =       0.000536932680
  error estimate for blocks of size 2^( 4) =       0.000548423667
  error estimate for blocks of size 2^( 5) =       0.000554721585
  error estimate for blocks of size 2^( 6) =       0.000559398092
  error estimate for blocks of size 2^( 7) =       0.000560936325

      target function =                  N/A
              le_mean =     -22.668797940625
             les_mean =     514.380986255293
             stat err =       0.000555869918
             autocorr =       1.219895929029
              std dev =       0.711748857198
             le_variance =       0.506586435722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266879794062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668797940625       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668797940626       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668797940626       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668797941123       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668797940760       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668797940627       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668797940682       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668797940696       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668797940911       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668797939586       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 3.235838e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668797940625       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668797940625       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668797940625       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668797940708       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668797944014       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668797940622       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668797940625       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668797940565       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668797940614       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668797934679       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+06 is 8.089616e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668797940625       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668797940625       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668797940625       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668797947234       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668797948211       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668797936132       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668797947145       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668797935583       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668797939334       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668797937976       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+07 is 2.022410e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8889e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7003
    reference variance = 0.426536
====================================================
  Execution time = 4.3214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0735e-01
  Total weights = 2.0000e+06
  Execution time = 4.0612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370497
                                         uncertainty =       0.003167881032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370497
                                         uncertainty =       0.003167881032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503660018
  error estimate for blocks of size 2^( 2) =       0.000520708195
  error estimate for blocks of size 2^( 3) =       0.000536454613
  error estimate for blocks of size 2^( 4) =       0.000548167352
  error estimate for blocks of size 2^( 5) =       0.000554969685
  error estimate for blocks of size 2^( 6) =       0.000558037346
  error estimate for blocks of size 2^( 7) =       0.000562649744

      target function =                  N/A
              le_mean =     -22.670995309902
             les_mean =     514.481374914697
             stat err =       0.000555956032
             autocorr =       1.218445027900
              std dev =       0.712282827794
             le_variance =       0.507346826770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370811
                                         uncertainty =       0.003167881034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370811
                                         uncertainty =       0.003167881034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503660018
  error estimate for blocks of size 2^( 2) =       0.000520708195
  error estimate for blocks of size 2^( 3) =       0.000536454613
  error estimate for blocks of size 2^( 4) =       0.000548167352
  error estimate for blocks of size 2^( 5) =       0.000554969685
  error estimate for blocks of size 2^( 6) =       0.000558037346
  error estimate for blocks of size 2^( 7) =       0.000562649744

      target function =                  N/A
              le_mean =     -22.670995309902
             les_mean =     514.481374915017
             stat err =       0.000555956032
             autocorr =       1.218445027724
              std dev =       0.712282828014
             le_variance =       0.507346827084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370654
                                         uncertainty =       0.003167881033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370654
                                         uncertainty =       0.003167881033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503660018
  error estimate for blocks of size 2^( 2) =       0.000520708195
  error estimate for blocks of size 2^( 3) =       0.000536454613
  error estimate for blocks of size 2^( 4) =       0.000548167352
  error estimate for blocks of size 2^( 5) =       0.000554969685
  error estimate for blocks of size 2^( 6) =       0.000558037346
  error estimate for blocks of size 2^( 7) =       0.000562649744

      target function =                  N/A
              le_mean =     -22.670995309902
             les_mean =     514.481374914857
             stat err =       0.000555956032
             autocorr =       1.218445027811
              std dev =       0.712282827904
             le_variance =       0.507346826927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370517
                                         uncertainty =       0.003167881032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507406370517
                                         uncertainty =       0.003167881032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503660018
  error estimate for blocks of size 2^( 2) =       0.000520708195
  error estimate for blocks of size 2^( 3) =       0.000536454613
  error estimate for blocks of size 2^( 4) =       0.000548167352
  error estimate for blocks of size 2^( 5) =       0.000554969685
  error estimate for blocks of size 2^( 6) =       0.000558037346
  error estimate for blocks of size 2^( 7) =       0.000562649744

      target function =                  N/A
              le_mean =     -22.670995309902
             les_mean =     514.481374914717
             stat err =       0.000555956032
             autocorr =       1.218445027891
              std dev =       0.712282827808
             le_variance =       0.507346826790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670995309902        initial
     9.5367e+05     9.5367e+06             3.2358e-10       -22.670995309902  <--
     3.8147e+06     3.8147e+07             8.0896e-11       -22.670995309902
     1.5259e+07     1.5259e+08             2.0224e-11       -22.670995309902

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 6.1592e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2049e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6557
    reference variance = 0.437344
====================================================
  Execution time = 4.3826e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1361e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5848e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513746158222
                                         uncertainty =       0.005104271405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513746158222
                                         uncertainty =       0.005104271405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506757125
  error estimate for blocks of size 2^( 2) =       0.000524186866
  error estimate for blocks of size 2^( 3) =       0.000540282666
  error estimate for blocks of size 2^( 4) =       0.000551710613
  error estimate for blocks of size 2^( 5) =       0.000559110124
  error estimate for blocks of size 2^( 6) =       0.000560185142
  error estimate for blocks of size 2^( 7) =       0.000562591440

      target function =                  N/A
              le_mean =     -22.670413898443
             les_mean =     514.461271636459
             stat err =       0.000558399330
             autocorr =       1.214199500761
              std dev =       0.716662798353
             le_variance =       0.513605566543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267041389844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670413898443       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670413898445       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670413898443       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670413898445       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670413898390       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670413898222       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670413898597       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670413898618       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670413898493       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670413897722       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+05 is 1.253319e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670413898443       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670413898443       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670413898443       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670413898014       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670413898444       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670413898957       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670413899337       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670413899110       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670413898261       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670413895655       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+05 is 3.133290e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670413898443       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670413898443       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670413898443       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670413898443       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670413898434       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670413898081       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670413897098       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670413898715       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670413898382       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670413899211       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+06 is 7.833273e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9682e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8199
    reference variance = 0.633799
====================================================
  Execution time = 4.3218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1412e-01
  Total weights = 2.0000e+06
  Execution time = 3.5206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498323423
                                         uncertainty =       0.003542568687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498323423
                                         uncertainty =       0.003542568687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507009805
  error estimate for blocks of size 2^( 2) =       0.000524530294
  error estimate for blocks of size 2^( 3) =       0.000540186578
  error estimate for blocks of size 2^( 4) =       0.000551606737
  error estimate for blocks of size 2^( 5) =       0.000557022766
  error estimate for blocks of size 2^( 6) =       0.000562910415
  error estimate for blocks of size 2^( 7) =       0.000563977142

      target function =                  N/A
              le_mean =     -22.669559212175
             les_mean =     514.423032501927
             stat err =       0.000558879265
             autocorr =       1.215075538913
              std dev =       0.717020142452
             le_variance =       0.514117884682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498322407
                                         uncertainty =       0.003542568673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498322407
                                         uncertainty =       0.003542568673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507009804
  error estimate for blocks of size 2^( 2) =       0.000524530293
  error estimate for blocks of size 2^( 3) =       0.000540186577
  error estimate for blocks of size 2^( 4) =       0.000551606737
  error estimate for blocks of size 2^( 5) =       0.000557022765
  error estimate for blocks of size 2^( 6) =       0.000562910415
  error estimate for blocks of size 2^( 7) =       0.000563977142

      target function =                  N/A
              le_mean =     -22.669559212170
             les_mean =     514.423032500706
             stat err =       0.000558879265
             autocorr =       1.215075539450
              std dev =       0.717020141745
             le_variance =       0.514117883667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498322915
                                         uncertainty =       0.003542568680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498322915
                                         uncertainty =       0.003542568680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507009805
  error estimate for blocks of size 2^( 2) =       0.000524530293
  error estimate for blocks of size 2^( 3) =       0.000540186578
  error estimate for blocks of size 2^( 4) =       0.000551606737
  error estimate for blocks of size 2^( 5) =       0.000557022766
  error estimate for blocks of size 2^( 6) =       0.000562910415
  error estimate for blocks of size 2^( 7) =       0.000563977142

      target function =                  N/A
              le_mean =     -22.669559212173
             les_mean =     514.423032501316
             stat err =       0.000558879265
             autocorr =       1.215075539189
              std dev =       0.717020142098
             le_variance =       0.514117884175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498323359
                                         uncertainty =       0.003542568687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512498323359
                                         uncertainty =       0.003542568687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507009805
  error estimate for blocks of size 2^( 2) =       0.000524530294
  error estimate for blocks of size 2^( 3) =       0.000540186578
  error estimate for blocks of size 2^( 4) =       0.000551606737
  error estimate for blocks of size 2^( 5) =       0.000557022766
  error estimate for blocks of size 2^( 6) =       0.000562910415
  error estimate for blocks of size 2^( 7) =       0.000563977142

      target function =                  N/A
              le_mean =     -22.669559212175
             les_mean =     514.423032501851
             stat err =       0.000558879265
             autocorr =       1.215075538945
              std dev =       0.717020142408
             le_variance =       0.514117884619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669559212175        initial  <--
     2.3842e+05     2.3842e+06             1.2533e-09       -22.669559212170
     9.5367e+05     9.5367e+06             3.1333e-10       -22.669559212173
     3.8147e+06     3.8147e+07             7.8333e-11       -22.669559212175

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8833
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2057e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6698
    reference variance = 0.406757
====================================================
  Execution time = 4.4509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0324e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4914e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503356976929
                                         uncertainty =       0.002854440536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503356976929
                                         uncertainty =       0.002854440536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501616766
  error estimate for blocks of size 2^( 2) =       0.000519422123
  error estimate for blocks of size 2^( 3) =       0.000535619819
  error estimate for blocks of size 2^( 4) =       0.000546568733
  error estimate for blocks of size 2^( 5) =       0.000554041993
  error estimate for blocks of size 2^( 6) =       0.000558631162
  error estimate for blocks of size 2^( 7) =       0.000561449720

      target function =                  N/A
              le_mean =     -22.669624812534
             les_mean =     514.415127648472
             stat err =       0.000555172902
             autocorr =       1.224933276632
              std dev =       0.709393233001
             le_variance =       0.503238759027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266962481253e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669624812534       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669624812534       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669624812535       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669624812535       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669624812609       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669624814625       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669624813906       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669624811310       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669624812794       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669624811858       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669624815189       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+06 is 1.054969e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669624812534       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669624812534       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669624812534       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669624813987       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669624817199       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669624793059       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669624815273       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669624818640       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669624803891       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669624804942       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669624847264       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+06 is 2.637329e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669624812534       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669624812534       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669624812534       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669624812419       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669624815289       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669624804921       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669624819574       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669624812684       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669624801141       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669624842856       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669624733973       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+07 is 6.593640e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9431e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7353
    reference variance = 0.754714
====================================================
  Execution time = 4.3035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1747e-01
  Total weights = 2.0000e+06
  Execution time = 3.5419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050005
                                         uncertainty =       0.005382233166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050005
                                         uncertainty =       0.005382233166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508658549
  error estimate for blocks of size 2^( 2) =       0.000526268263
  error estimate for blocks of size 2^( 3) =       0.000541489290
  error estimate for blocks of size 2^( 4) =       0.000553131045
  error estimate for blocks of size 2^( 5) =       0.000559691010
  error estimate for blocks of size 2^( 6) =       0.000565224012
  error estimate for blocks of size 2^( 7) =       0.000567210654

      target function =                  N/A
              le_mean =     -22.670412604958
             les_mean =     514.465074458583
             stat err =       0.000561314180
             autocorr =       1.217753347028
              std dev =       0.719351818148
             le_variance =       0.517467038272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050068
                                         uncertainty =       0.005382233169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050068
                                         uncertainty =       0.005382233169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508658549
  error estimate for blocks of size 2^( 2) =       0.000526268263
  error estimate for blocks of size 2^( 3) =       0.000541489290
  error estimate for blocks of size 2^( 4) =       0.000553131045
  error estimate for blocks of size 2^( 5) =       0.000559691010
  error estimate for blocks of size 2^( 6) =       0.000565224012
  error estimate for blocks of size 2^( 7) =       0.000567210654

      target function =                  N/A
              le_mean =     -22.670412604958
             les_mean =     514.465074458637
             stat err =       0.000561314180
             autocorr =       1.217753346996
              std dev =       0.719351818191
             le_variance =       0.517467038335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050037
                                         uncertainty =       0.005382233167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050037
                                         uncertainty =       0.005382233167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508658549
  error estimate for blocks of size 2^( 2) =       0.000526268263
  error estimate for blocks of size 2^( 3) =       0.000541489290
  error estimate for blocks of size 2^( 4) =       0.000553131045
  error estimate for blocks of size 2^( 5) =       0.000559691010
  error estimate for blocks of size 2^( 6) =       0.000565224012
  error estimate for blocks of size 2^( 7) =       0.000567210654

      target function =                  N/A
              le_mean =     -22.670412604958
             les_mean =     514.465074458610
             stat err =       0.000561314180
             autocorr =       1.217753347022
              std dev =       0.719351818169
             le_variance =       0.517467038304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050009
                                         uncertainty =       0.005382233166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517491050009
                                         uncertainty =       0.005382233166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508658549
  error estimate for blocks of size 2^( 2) =       0.000526268263
  error estimate for blocks of size 2^( 3) =       0.000541489290
  error estimate for blocks of size 2^( 4) =       0.000553131045
  error estimate for blocks of size 2^( 5) =       0.000559691010
  error estimate for blocks of size 2^( 6) =       0.000565224012
  error estimate for blocks of size 2^( 7) =       0.000567210654

      target function =                  N/A
              le_mean =     -22.670412604958
             les_mean =     514.465074458586
             stat err =       0.000561314180
             autocorr =       1.217753347036
              std dev =       0.719351818150
             le_variance =       0.517467038276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670412604958        initial  <--
     2.3842e+06     2.3842e+07             1.0550e-10       -22.670412604958
     9.5367e+06     9.5367e+07             2.6373e-11       -22.670412604958
     3.8147e+07     3.8147e+08             6.5936e-12       -22.670412604958

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7611
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2020e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.5305
    reference variance = 0.565587
====================================================
  Execution time = 4.4530e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0995e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4907e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509948843474
                                         uncertainty =       0.003153903860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509948843474
                                         uncertainty =       0.003153903860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504952995
  error estimate for blocks of size 2^( 2) =       0.000523016708
  error estimate for blocks of size 2^( 3) =       0.000538612954
  error estimate for blocks of size 2^( 4) =       0.000550163505
  error estimate for blocks of size 2^( 5) =       0.000557577850
  error estimate for blocks of size 2^( 6) =       0.000561917257
  error estimate for blocks of size 2^( 7) =       0.000566056587

      target function =                  N/A
              le_mean =     -22.670358053175
             les_mean =     514.455089057758
             stat err =       0.000558928800
             autocorr =       1.225211520950
              std dev =       0.714111373369
             le_variance =       0.509955053575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267035805318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670358053175       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670358053175       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670358053175       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670358053175       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670358053175       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670358053175       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670358046561       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670358043124       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670358033821       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670358004660       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+07 is 8.548775e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670358053175       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670358053175       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670358053175       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670358136490       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670358053175       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670358030931       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670358057874       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670358051269       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670358179485       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670358000028       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+07 is 2.137042e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670358053175       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670358053175       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670358053175       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670357775088       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670358068648       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670357974667       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670358056402       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670357562784       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670358078357       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670358366592       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+08 is 5.345427e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9444e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7198
    reference variance = 0.358684
====================================================
  Execution time = 4.3788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1024e-01
  Total weights = 2.0000e+06
  Execution time = 3.5263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955343
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955343
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505094015
  error estimate for blocks of size 2^( 2) =       0.000522815301
  error estimate for blocks of size 2^( 3) =       0.000538508828
  error estimate for blocks of size 2^( 4) =       0.000548896674
  error estimate for blocks of size 2^( 5) =       0.000555327512
  error estimate for blocks of size 2^( 6) =       0.000560674539
  error estimate for blocks of size 2^( 7) =       0.000563547678

      target function =                  N/A
              le_mean =     -22.670138498714
             les_mean =     514.445419223957
             stat err =       0.000557111601
             autocorr =       1.216578000538
              std dev =       0.714310806459
             le_variance =       0.510239928225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955342
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955342
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505094015
  error estimate for blocks of size 2^( 2) =       0.000522815301
  error estimate for blocks of size 2^( 3) =       0.000538508828
  error estimate for blocks of size 2^( 4) =       0.000548896674
  error estimate for blocks of size 2^( 5) =       0.000555327512
  error estimate for blocks of size 2^( 6) =       0.000560674539
  error estimate for blocks of size 2^( 7) =       0.000563547678

      target function =                  N/A
              le_mean =     -22.670138498714
             les_mean =     514.445419223958
             stat err =       0.000557111601
             autocorr =       1.216578000538
              std dev =       0.714310806458
             le_variance =       0.510239928223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955343
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955343
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505094015
  error estimate for blocks of size 2^( 2) =       0.000522815301
  error estimate for blocks of size 2^( 3) =       0.000538508828
  error estimate for blocks of size 2^( 4) =       0.000548896674
  error estimate for blocks of size 2^( 5) =       0.000555327512
  error estimate for blocks of size 2^( 6) =       0.000560674539
  error estimate for blocks of size 2^( 7) =       0.000563547678

      target function =                  N/A
              le_mean =     -22.670138498714
             les_mean =     514.445419223957
             stat err =       0.000557111601
             autocorr =       1.216578000537
              std dev =       0.714310806459
             le_variance =       0.510239928224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955343
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510178955343
                                         uncertainty =       0.003570434328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505094015
  error estimate for blocks of size 2^( 2) =       0.000522815301
  error estimate for blocks of size 2^( 3) =       0.000538508828
  error estimate for blocks of size 2^( 4) =       0.000548896674
  error estimate for blocks of size 2^( 5) =       0.000555327512
  error estimate for blocks of size 2^( 6) =       0.000560674539
  error estimate for blocks of size 2^( 7) =       0.000563547678

      target function =                  N/A
              le_mean =     -22.670138498714
             les_mean =     514.445419223957
             stat err =       0.000557111601
             autocorr =       1.216578000537
              std dev =       0.714310806459
             le_variance =       0.510239928224


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670138498714        initial
     2.3842e+07     2.3842e+08             8.5488e-12       -22.670138498714  <--
     9.5367e+07     9.5367e+08             2.1370e-12       -22.670138498714
     3.8147e+08     3.8147e+09             5.3454e-13       -22.670138498714

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 6.1494e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2094e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6508
    reference variance = 0.716337
====================================================
  Execution time = 4.3752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1014e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4811e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510219065565
                                         uncertainty =       0.003453431869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510219065565
                                         uncertainty =       0.003453431869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505045716
  error estimate for blocks of size 2^( 2) =       0.000522471058
  error estimate for blocks of size 2^( 3) =       0.000538127097
  error estimate for blocks of size 2^( 4) =       0.000548810270
  error estimate for blocks of size 2^( 5) =       0.000555089037
  error estimate for blocks of size 2^( 6) =       0.000557861503
  error estimate for blocks of size 2^( 7) =       0.000557257156

      target function =                  N/A
              le_mean =     -22.669901599721
             les_mean =     514.434580636244
             stat err =       0.000554754492
             autocorr =       1.206535963342
              std dev =       0.714242501042
             le_variance =       0.510142350295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266990159972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669901599721       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669901599721       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669901599721       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669901599760       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669901599865       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669901594915       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669901595830       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669901597568       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669901607577       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669901592243       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669901589423       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 3.253823e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669901599721       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669901599721       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669901599721       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669901603426       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669901596416       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669901596516       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669901592693       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669901611060       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669901573885       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669901595963       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669901598309       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+07 is 8.134251e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669901599721       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669901599721       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669901599721       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669901595658       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669901529782       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669901552628       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669901670251       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669901538185       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669901486283       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669901907496       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669901963559       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+07 is 2.033114e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209352 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8571e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7069
    reference variance = 3.47091
====================================================
  Execution time = 4.2959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2269e-01
  Total weights = 2.0000e+06
  Execution time = 3.5323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595350
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595350
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511219135
  error estimate for blocks of size 2^( 2) =       0.000528329269
  error estimate for blocks of size 2^( 3) =       0.000544138006
  error estimate for blocks of size 2^( 4) =       0.000554437378
  error estimate for blocks of size 2^( 5) =       0.000561781099
  error estimate for blocks of size 2^( 6) =       0.000565325516
  error estimate for blocks of size 2^( 7) =       0.000568139039

      target function =                  N/A
              le_mean =     -22.668824976637
             les_mean =     514.398315567808
             stat err =       0.000562420758
             autocorr =       1.210343049514
              std dev =       0.722973033916
             le_variance =       0.522690007769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595357
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595357
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511219135
  error estimate for blocks of size 2^( 2) =       0.000528329269
  error estimate for blocks of size 2^( 3) =       0.000544138006
  error estimate for blocks of size 2^( 4) =       0.000554437378
  error estimate for blocks of size 2^( 5) =       0.000561781099
  error estimate for blocks of size 2^( 6) =       0.000565325516
  error estimate for blocks of size 2^( 7) =       0.000568139039

      target function =                  N/A
              le_mean =     -22.668824976637
             les_mean =     514.398315567820
             stat err =       0.000562420758
             autocorr =       1.210343049502
              std dev =       0.722973033920
             le_variance =       0.522690007776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595353
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595353
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511219135
  error estimate for blocks of size 2^( 2) =       0.000528329269
  error estimate for blocks of size 2^( 3) =       0.000544138006
  error estimate for blocks of size 2^( 4) =       0.000554437378
  error estimate for blocks of size 2^( 5) =       0.000561781099
  error estimate for blocks of size 2^( 6) =       0.000565325516
  error estimate for blocks of size 2^( 7) =       0.000568139039

      target function =                  N/A
              le_mean =     -22.668824976637
             les_mean =     514.398315567814
             stat err =       0.000562420758
             autocorr =       1.210343049518
              std dev =       0.722973033918
             le_variance =       0.522690007773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595350
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522531595350
                                         uncertainty =       0.008330551814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511219135
  error estimate for blocks of size 2^( 2) =       0.000528329269
  error estimate for blocks of size 2^( 3) =       0.000544138006
  error estimate for blocks of size 2^( 4) =       0.000554437378
  error estimate for blocks of size 2^( 5) =       0.000561781099
  error estimate for blocks of size 2^( 6) =       0.000565325516
  error estimate for blocks of size 2^( 7) =       0.000568139039

      target function =                  N/A
              le_mean =     -22.668824976637
             les_mean =     514.398315567808
             stat err =       0.000562420758
             autocorr =       1.210343049522
              std dev =       0.722973033916
             le_variance =       0.522690007769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668824976637        initial
     5.9605e+06     5.9605e+07             3.2538e-11       -22.668824976637  <--
     2.3842e+07     2.3842e+08             8.1343e-12       -22.668824976637
     9.5367e+07     9.5367e+08             2.0331e-12       -22.668824976637

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 6.0651e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475252e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1923e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6949
    reference variance = 0.406069
====================================================
  Execution time = 4.3537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0980e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4934e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509870901919
                                         uncertainty =       0.004379092713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509870901919
                                         uncertainty =       0.004379092713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504878310
  error estimate for blocks of size 2^( 2) =       0.000522600996
  error estimate for blocks of size 2^( 3) =       0.000538668420
  error estimate for blocks of size 2^( 4) =       0.000549673951
  error estimate for blocks of size 2^( 5) =       0.000555571151
  error estimate for blocks of size 2^( 6) =       0.000559733594
  error estimate for blocks of size 2^( 7) =       0.000563636517

      target function =                  N/A
              le_mean =     -22.669098165487
             les_mean =     514.397815598078
             stat err =       0.000557153803
             autocorr =       1.217802248832
              std dev =       0.714005753831
             le_variance =       0.509804216503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266909816549e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669098165487       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669098165487       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669098165487       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669098165562       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669098164670       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669098165362       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669098165132       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669098165738       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669098162707       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669098166223       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+06 is 1.491577e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669098165487       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669098165487       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669098165487       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669098165487       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669098165496       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669098165055       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669098165420       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669098165255       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669098165471       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669098169094       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 3.728918e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669098165487       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669098165487       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669098165487       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669098163424       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669098155229       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669098161059       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669098165098       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669098151867       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669098172230       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669098184829       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+07 is 9.322660e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8479e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.5953
    reference variance = 0.315318
====================================================
  Execution time = 4.3266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1892e-01
  Total weights = 2.0000e+06
  Execution time = 4.0616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531367
                                         uncertainty =       0.006460740277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531367
                                         uncertainty =       0.006460740277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509372861
  error estimate for blocks of size 2^( 2) =       0.000527250702
  error estimate for blocks of size 2^( 3) =       0.000543090902
  error estimate for blocks of size 2^( 4) =       0.000553997601
  error estimate for blocks of size 2^( 5) =       0.000560201597
  error estimate for blocks of size 2^( 6) =       0.000565337483
  error estimate for blocks of size 2^( 7) =       0.000564599431

      target function =                  N/A
              le_mean =     -22.669197071951
             les_mean =     514.411417051066
             stat err =       0.000561034028
             autocorr =       1.213128487165
              std dev =       0.720362008712
             le_variance =       0.518921423595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531425
                                         uncertainty =       0.006460740280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531425
                                         uncertainty =       0.006460740280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509372861
  error estimate for blocks of size 2^( 2) =       0.000527250702
  error estimate for blocks of size 2^( 3) =       0.000543090902
  error estimate for blocks of size 2^( 4) =       0.000553997601
  error estimate for blocks of size 2^( 5) =       0.000560201597
  error estimate for blocks of size 2^( 6) =       0.000565337483
  error estimate for blocks of size 2^( 7) =       0.000564599431

      target function =                  N/A
              le_mean =     -22.669197071951
             les_mean =     514.411417051150
             stat err =       0.000561034028
             autocorr =       1.213128487105
              std dev =       0.720362008752
             le_variance =       0.518921423653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531396
                                         uncertainty =       0.006460740278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531396
                                         uncertainty =       0.006460740278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509372861
  error estimate for blocks of size 2^( 2) =       0.000527250702
  error estimate for blocks of size 2^( 3) =       0.000543090902
  error estimate for blocks of size 2^( 4) =       0.000553997601
  error estimate for blocks of size 2^( 5) =       0.000560201597
  error estimate for blocks of size 2^( 6) =       0.000565337483
  error estimate for blocks of size 2^( 7) =       0.000564599431

      target function =                  N/A
              le_mean =     -22.669197071951
             les_mean =     514.411417051108
             stat err =       0.000561034028
             autocorr =       1.213128487137
              std dev =       0.720362008732
             le_variance =       0.518921423624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531371
                                         uncertainty =       0.006460740277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519034531371
                                         uncertainty =       0.006460740277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509372861
  error estimate for blocks of size 2^( 2) =       0.000527250702
  error estimate for blocks of size 2^( 3) =       0.000543090902
  error estimate for blocks of size 2^( 4) =       0.000553997601
  error estimate for blocks of size 2^( 5) =       0.000560201597
  error estimate for blocks of size 2^( 6) =       0.000565337483
  error estimate for blocks of size 2^( 7) =       0.000564599431

      target function =                  N/A
              le_mean =     -22.669197071951
             les_mean =     514.411417051071
             stat err =       0.000561034028
             autocorr =       1.213128487161
              std dev =       0.720362008714
             le_variance =       0.518921423598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669197071951        initial
     1.4901e+06     1.4901e+07             1.4916e-10       -22.669197071951  <--
     5.9605e+06     5.9605e+07             3.7289e-11       -22.669197071951
     2.3842e+07     2.3842e+08             9.3227e-12       -22.669197071951

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 6.1522e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2001e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.5247
    reference variance = 0.521059
====================================================
  Execution time = 4.3435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0984e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5197e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509833681667
                                         uncertainty =       0.003346688398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509833681667
                                         uncertainty =       0.003346688398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504897676
  error estimate for blocks of size 2^( 2) =       0.000522901488
  error estimate for blocks of size 2^( 3) =       0.000538494926
  error estimate for blocks of size 2^( 4) =       0.000549860195
  error estimate for blocks of size 2^( 5) =       0.000557003309
  error estimate for blocks of size 2^( 6) =       0.000561358433
  error estimate for blocks of size 2^( 7) =       0.000565085006

      target function =                  N/A
              le_mean =     -22.669664034066
             les_mean =     514.423510489172
             stat err =       0.000558326736
             autocorr =       1.222841322318
              std dev =       0.714033141158
             le_variance =       0.509843326671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266966403407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669664034066       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669664034066       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669664034066       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669664033991       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669664035882       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669664030104       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669664034322       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669664033645       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669664033465       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669664034233       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+05 is 6.343433e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669664034066       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669664034066       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669664034066       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669664034591       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669664034040       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669664034805       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669664033827       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669664034232       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669664034876       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669664035695       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+06 is 1.585846e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669664034066       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669664034066       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669664034066       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669664034066       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669664034781       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669664034259       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669664029226       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669664039740       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669664038916       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669664037063       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+06 is 3.964572e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8640e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158060e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409790e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6862
    reference variance = 0.253192
====================================================
  Execution time = 4.3174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.7431e-01
  Total weights = 2.0000e+06
  Execution time = 3.5252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366858119
                                         uncertainty =       0.062245690018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366858119
                                         uncertainty =       0.062245690018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535866370
  error estimate for blocks of size 2^( 2) =       0.000552624676
  error estimate for blocks of size 2^( 3) =       0.000568350385
  error estimate for blocks of size 2^( 4) =       0.000578772580
  error estimate for blocks of size 2^( 5) =       0.000585822642
  error estimate for blocks of size 2^( 6) =       0.000587899138
  error estimate for blocks of size 2^( 7) =       0.000589087302

      target function =                  N/A
              le_mean =     -22.670372875465
             les_mean =     514.520111557561
             stat err =       0.000585395416
             autocorr =       1.193398891349
              std dev =       0.757829487481
             le_variance =       0.574305532095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366857806
                                         uncertainty =       0.062245690026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366857806
                                         uncertainty =       0.062245690026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535866369
  error estimate for blocks of size 2^( 2) =       0.000552624676
  error estimate for blocks of size 2^( 3) =       0.000568350384
  error estimate for blocks of size 2^( 4) =       0.000578772580
  error estimate for blocks of size 2^( 5) =       0.000585822642
  error estimate for blocks of size 2^( 6) =       0.000587899138
  error estimate for blocks of size 2^( 7) =       0.000589087302

      target function =                  N/A
              le_mean =     -22.670372875466
             les_mean =     514.520111557288
             stat err =       0.000585395416
             autocorr =       1.193398891507
              std dev =       0.757829487274
             le_variance =       0.574305531782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366857963
                                         uncertainty =       0.062245690022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366857963
                                         uncertainty =       0.062245690022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535866370
  error estimate for blocks of size 2^( 2) =       0.000552624676
  error estimate for blocks of size 2^( 3) =       0.000568350384
  error estimate for blocks of size 2^( 4) =       0.000578772580
  error estimate for blocks of size 2^( 5) =       0.000585822642
  error estimate for blocks of size 2^( 6) =       0.000587899138
  error estimate for blocks of size 2^( 7) =       0.000589087302

      target function =                  N/A
              le_mean =     -22.670372875465
             les_mean =     514.520111557425
             stat err =       0.000585395416
             autocorr =       1.193398891417
              std dev =       0.757829487378
             le_variance =       0.574305531939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366858100
                                         uncertainty =       0.062245690019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.574366858100
                                         uncertainty =       0.062245690019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535866370
  error estimate for blocks of size 2^( 2) =       0.000552624676
  error estimate for blocks of size 2^( 3) =       0.000568350385
  error estimate for blocks of size 2^( 4) =       0.000578772580
  error estimate for blocks of size 2^( 5) =       0.000585822642
  error estimate for blocks of size 2^( 6) =       0.000587899138
  error estimate for blocks of size 2^( 7) =       0.000589087302

      target function =                  N/A
              le_mean =     -22.670372875465
             les_mean =     514.520111557545
             stat err =       0.000585395416
             autocorr =       1.193398891358
              std dev =       0.757829487468
             le_variance =       0.574305532076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670372875465        initial
     3.7253e+05     3.7253e+06             6.3434e-10       -22.670372875466  <--
     1.4901e+06     1.4901e+07             1.5858e-10       -22.670372875465
     5.9605e+06     5.9605e+07             3.9646e-11       -22.670372875465

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 6.0872e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158061e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1952e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6412
    reference variance = 0.295115
====================================================
  Execution time = 4.3778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.4916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4948e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549105381868
                                         uncertainty =       0.032240613769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.549105381868
                                         uncertainty =       0.032240613769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000524002327
  error estimate for blocks of size 2^( 2) =       0.000540496535
  error estimate for blocks of size 2^( 3) =       0.000555688463
  error estimate for blocks of size 2^( 4) =       0.000566490873
  error estimate for blocks of size 2^( 5) =       0.000572398579
  error estimate for blocks of size 2^( 6) =       0.000575899653
  error estimate for blocks of size 2^( 7) =       0.000577886824

      target function =                  N/A
              le_mean =     -22.669831786080
             les_mean =     514.470429812521
             stat err =       0.000573168982
             autocorr =       1.196462051469
              std dev =       0.741051197917
             le_variance =       0.549156877934


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266983178608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669831786080       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669831786090       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669831786093       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669831786089       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669831786102       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669831786094       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669831786068       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669831786035       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669831786093       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669831786114       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+04 is 3.436198e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669831786080       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669831786083       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669831786083       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669831786061       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669831785936       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669831786148       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669831786402       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669831785566       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669831786062       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669831785390       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+05 is 8.590509e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669831786080       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669831786081       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669831786081       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669831786040       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669831786216       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669831786296       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669831785995       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669831786041       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669831785821       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669831786898       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+06 is 2.147629e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8734e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787434e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158061e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475253e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7493
    reference variance = 1.01412
====================================================
  Execution time = 4.2824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1061e-01
  Total weights = 2.0000e+06
  Execution time = 3.5276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384553
                                         uncertainty =       0.003457207026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384553
                                         uncertainty =       0.003457207026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505275480
  error estimate for blocks of size 2^( 2) =       0.000523059827
  error estimate for blocks of size 2^( 3) =       0.000538933778
  error estimate for blocks of size 2^( 4) =       0.000549211638
  error estimate for blocks of size 2^( 5) =       0.000555987629
  error estimate for blocks of size 2^( 6) =       0.000558929851
  error estimate for blocks of size 2^( 7) =       0.000560301257

      target function =                  N/A
              le_mean =     -22.669996713539
             les_mean =     514.439357357733
             stat err =       0.000556107594
             autocorr =       1.211326460687
              std dev =       0.714567436397
             le_variance =       0.510606621159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384499
                                         uncertainty =       0.003457207022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384499
                                         uncertainty =       0.003457207022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505275480
  error estimate for blocks of size 2^( 2) =       0.000523059827
  error estimate for blocks of size 2^( 3) =       0.000538933778
  error estimate for blocks of size 2^( 4) =       0.000549211638
  error estimate for blocks of size 2^( 5) =       0.000555987629
  error estimate for blocks of size 2^( 6) =       0.000558929851
  error estimate for blocks of size 2^( 7) =       0.000560301257

      target function =                  N/A
              le_mean =     -22.669996713556
             les_mean =     514.439357358436
             stat err =       0.000556107593
             autocorr =       1.211326460489
              std dev =       0.714567436359
             le_variance =       0.510606621105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384526
                                         uncertainty =       0.003457207024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384526
                                         uncertainty =       0.003457207024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505275480
  error estimate for blocks of size 2^( 2) =       0.000523059827
  error estimate for blocks of size 2^( 3) =       0.000538933778
  error estimate for blocks of size 2^( 4) =       0.000549211638
  error estimate for blocks of size 2^( 5) =       0.000555987629
  error estimate for blocks of size 2^( 6) =       0.000558929851
  error estimate for blocks of size 2^( 7) =       0.000560301257

      target function =                  N/A
              le_mean =     -22.669996713548
             les_mean =     514.439357358085
             stat err =       0.000556107594
             autocorr =       1.211326460590
              std dev =       0.714567436378
             le_variance =       0.510606621132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384550
                                         uncertainty =       0.003457207026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510657384550
                                         uncertainty =       0.003457207026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505275480
  error estimate for blocks of size 2^( 2) =       0.000523059827
  error estimate for blocks of size 2^( 3) =       0.000538933778
  error estimate for blocks of size 2^( 4) =       0.000549211638
  error estimate for blocks of size 2^( 5) =       0.000555987629
  error estimate for blocks of size 2^( 6) =       0.000558929851
  error estimate for blocks of size 2^( 7) =       0.000560301257

      target function =                  N/A
              le_mean =     -22.669996713540
             les_mean =     514.439357357777
             stat err =       0.000556107594
             autocorr =       1.211326460676
              std dev =       0.714567436395
             le_variance =       0.510606621156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669996713539        initial
     9.3132e+04     9.3132e+05             3.4362e-09       -22.669996713556  <--
     3.7253e+05     3.7253e+06             8.5905e-10       -22.669996713548
     1.4901e+06     1.4901e+07             2.1476e-10       -22.669996713540

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 6.0495e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1924e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6747
    reference variance = 0.729133
====================================================
  Execution time = 4.4356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1800e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4973e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518009108340
                                         uncertainty =       0.005376958097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518009108340
                                         uncertainty =       0.005376958097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508921237
  error estimate for blocks of size 2^( 2) =       0.000526369104
  error estimate for blocks of size 2^( 3) =       0.000542114206
  error estimate for blocks of size 2^( 4) =       0.000553632333
  error estimate for blocks of size 2^( 5) =       0.000561484255
  error estimate for blocks of size 2^( 6) =       0.000565270276
  error estimate for blocks of size 2^( 7) =       0.000568217013

      target function =                  N/A
              le_mean =     -22.670401478099
             les_mean =     514.465104569701
             stat err =       0.000562150969
             autocorr =       1.220126275452
              std dev =       0.719723315238
             le_variance =       0.518001650497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267040147810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670401478099       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670401478105       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670401478136       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670401478165       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670401478178       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670401478164       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670401478170       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670401478148       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670401478143       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670401478180       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+04 is 8.956061e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670401478099       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670401478101       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670401478109       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670401478141       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670401478127       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670401478129       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670401478139       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670401478319       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670401478292       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670401477925       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+04 is 2.239023e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670401478099       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670401478100       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670401478102       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670401478103       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670401477970       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670401478175       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670401478155       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670401477982       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670401477854       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670401478455       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+05 is 5.597565e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9337e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386815e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702344e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522714e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158064e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475256e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.601
    reference variance = 0.398431
====================================================
  Execution time = 4.2971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1235e-01
  Total weights = 2.0000e+06
  Execution time = 3.5246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240912335
                                         uncertainty =       0.005230198091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240912335
                                         uncertainty =       0.005230198091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506136379
  error estimate for blocks of size 2^( 2) =       0.000523898889
  error estimate for blocks of size 2^( 3) =       0.000540024262
  error estimate for blocks of size 2^( 4) =       0.000550993000
  error estimate for blocks of size 2^( 5) =       0.000556774340
  error estimate for blocks of size 2^( 6) =       0.000558895137
  error estimate for blocks of size 2^( 7) =       0.000562323593

      target function =                  N/A
              le_mean =     -22.668805453392
             les_mean =     514.387088495193
             stat err =       0.000557246517
             autocorr =       1.212159079711
              std dev =       0.715784931125
             le_variance =       0.512348067626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240909154
                                         uncertainty =       0.005230197960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240909154
                                         uncertainty =       0.005230197960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506136377
  error estimate for blocks of size 2^( 2) =       0.000523898887
  error estimate for blocks of size 2^( 3) =       0.000540024260
  error estimate for blocks of size 2^( 4) =       0.000550992999
  error estimate for blocks of size 2^( 5) =       0.000556774338
  error estimate for blocks of size 2^( 6) =       0.000558895135
  error estimate for blocks of size 2^( 7) =       0.000562323591

      target function =                  N/A
              le_mean =     -22.668805453365
             les_mean =     514.387088490796
             stat err =       0.000557246516
             autocorr =       1.212159080557
              std dev =       0.715784928905
             le_variance =       0.512348064447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240910744
                                         uncertainty =       0.005230198025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240910744
                                         uncertainty =       0.005230198025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506136378
  error estimate for blocks of size 2^( 2) =       0.000523898888
  error estimate for blocks of size 2^( 3) =       0.000540024261
  error estimate for blocks of size 2^( 4) =       0.000550992999
  error estimate for blocks of size 2^( 5) =       0.000556774339
  error estimate for blocks of size 2^( 6) =       0.000558895136
  error estimate for blocks of size 2^( 7) =       0.000562323592

      target function =                  N/A
              le_mean =     -22.668805453379
             les_mean =     514.387088492995
             stat err =       0.000557246517
             autocorr =       1.212159080128
              std dev =       0.715784930015
             le_variance =       0.512348066036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240912136
                                         uncertainty =       0.005230198083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512240912136
                                         uncertainty =       0.005230198083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506136379
  error estimate for blocks of size 2^( 2) =       0.000523898889
  error estimate for blocks of size 2^( 3) =       0.000540024262
  error estimate for blocks of size 2^( 4) =       0.000550993000
  error estimate for blocks of size 2^( 5) =       0.000556774340
  error estimate for blocks of size 2^( 6) =       0.000558895137
  error estimate for blocks of size 2^( 7) =       0.000562323593

      target function =                  N/A
              le_mean =     -22.668805453390
             les_mean =     514.387088494918
             stat err =       0.000557246517
             autocorr =       1.212159079753
              std dev =       0.715784930986
             le_variance =       0.512348067427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668805453392        initial  <--
     2.3283e+04     2.3283e+05             8.9561e-09       -22.668805453365
     9.3132e+04     9.3132e+05             2.2390e-09       -22.668805453379
     3.7253e+05     3.7253e+06             5.5976e-10       -22.668805453390

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6419
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1999e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8234
    reference variance = 3.51541
====================================================
  Execution time = 4.3185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0954e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5004e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509410567842
                                         uncertainty =       0.004245956290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509410567842
                                         uncertainty =       0.004245956290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504745434
  error estimate for blocks of size 2^( 2) =       0.000522578825
  error estimate for blocks of size 2^( 3) =       0.000537917908
  error estimate for blocks of size 2^( 4) =       0.000549572082
  error estimate for blocks of size 2^( 5) =       0.000557242904
  error estimate for blocks of size 2^( 6) =       0.000560176324
  error estimate for blocks of size 2^( 7) =       0.000561309990

      target function =                  N/A
              le_mean =     -22.669376348237
             les_mean =     514.410159668538
             stat err =       0.000557075325
             autocorr =       1.218100292269
              std dev =       0.713817837617
             le_variance =       0.509535905300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266937634824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669376348237       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669376348239       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669376348237       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669376348273       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669376348129       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669376347988       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669376348186       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669376348386       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669376348328       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669376348474       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+05 is 1.175870e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669376348237       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669376348237       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669376348237       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669376348135       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669376348096       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669376348459       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669376348611       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669376347601       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669376348983       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669376347385       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+05 is 2.939679e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669376348237       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669376348237       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669376348237       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669376348237       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669376350233       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669376347321       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669376350570       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669376347204       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669376347862       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669376343661       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+06 is 7.349236e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8197e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033841e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6765
    reference variance = 0.441499
====================================================
  Execution time = 4.2874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1196e-01
  Total weights = 2.0000e+06
  Execution time = 3.5340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737545
                                         uncertainty =       0.003666530097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737545
                                         uncertainty =       0.003666530097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505944145
  error estimate for blocks of size 2^( 2) =       0.000524002614
  error estimate for blocks of size 2^( 3) =       0.000540081524
  error estimate for blocks of size 2^( 4) =       0.000551926938
  error estimate for blocks of size 2^( 5) =       0.000559226321
  error estimate for blocks of size 2^( 6) =       0.000561524155
  error estimate for blocks of size 2^( 7) =       0.000562528628

      target function =                  N/A
              le_mean =     -22.669911498164
             les_mean =     514.436846034140
             stat err =       0.000558801510
             autocorr =       1.219860008170
              std dev =       0.715513071535
             le_variance =       0.511958955538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737325
                                         uncertainty =       0.003666530096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737325
                                         uncertainty =       0.003666530096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505944145
  error estimate for blocks of size 2^( 2) =       0.000524002614
  error estimate for blocks of size 2^( 3) =       0.000540081524
  error estimate for blocks of size 2^( 4) =       0.000551926938
  error estimate for blocks of size 2^( 5) =       0.000559226321
  error estimate for blocks of size 2^( 6) =       0.000561524155
  error estimate for blocks of size 2^( 7) =       0.000562528628

      target function =                  N/A
              le_mean =     -22.669911498160
             les_mean =     514.436846033734
             stat err =       0.000558801510
             autocorr =       1.219860008136
              std dev =       0.715513071381
             le_variance =       0.511958955316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737435
                                         uncertainty =       0.003666530097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737435
                                         uncertainty =       0.003666530097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505944145
  error estimate for blocks of size 2^( 2) =       0.000524002614
  error estimate for blocks of size 2^( 3) =       0.000540081524
  error estimate for blocks of size 2^( 4) =       0.000551926938
  error estimate for blocks of size 2^( 5) =       0.000559226321
  error estimate for blocks of size 2^( 6) =       0.000561524155
  error estimate for blocks of size 2^( 7) =       0.000562528628

      target function =                  N/A
              le_mean =     -22.669911498162
             les_mean =     514.436846033937
             stat err =       0.000558801510
             autocorr =       1.219860008157
              std dev =       0.715513071458
             le_variance =       0.511958955427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737532
                                         uncertainty =       0.003666530097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512013737532
                                         uncertainty =       0.003666530097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505944145
  error estimate for blocks of size 2^( 2) =       0.000524002614
  error estimate for blocks of size 2^( 3) =       0.000540081524
  error estimate for blocks of size 2^( 4) =       0.000551926938
  error estimate for blocks of size 2^( 5) =       0.000559226321
  error estimate for blocks of size 2^( 6) =       0.000561524155
  error estimate for blocks of size 2^( 7) =       0.000562528628

      target function =                  N/A
              le_mean =     -22.669911498164
             les_mean =     514.436846034115
             stat err =       0.000558801510
             autocorr =       1.219860008170
              std dev =       0.715513071526
             le_variance =       0.511958955524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669911498164        initial  <--
     2.3283e+05     2.3283e+06             1.1759e-09       -22.669911498160
     9.3132e+05     9.3132e+06             2.9397e-10       -22.669911498162
     3.7253e+06     3.7253e+07             7.3492e-11       -22.669911498164

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5470
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1879e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6619
    reference variance = 0.416642
====================================================
  Execution time = 4.4204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4771e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512076896689
                                         uncertainty =       0.003193190056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512076896689
                                         uncertainty =       0.003193190056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506042660
  error estimate for blocks of size 2^( 2) =       0.000523598067
  error estimate for blocks of size 2^( 3) =       0.000539483442
  error estimate for blocks of size 2^( 4) =       0.000550996547
  error estimate for blocks of size 2^( 5) =       0.000556322700
  error estimate for blocks of size 2^( 6) =       0.000558911796
  error estimate for blocks of size 2^( 7) =       0.000560162140

      target function =                  N/A
              le_mean =     -22.670188354625
             les_mean =     514.449598124681
             stat err =       0.000556598296
             autocorr =       1.209788594134
              std dev =       0.715652392290
             le_variance =       0.512158346591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267018835462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670188354625       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670188354625       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670188354625       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670188354625       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670188354626       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670188354501       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670188354355       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670188353398       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670188354772       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670188354043       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670188347137       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+06 is 1.075835e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670188354625       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670188354625       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670188354625       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670188354952       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670188353183       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670188356650       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670188364786       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670188354514       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670188350727       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670188314778       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670188346219       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+06 is 2.689687e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670188354625       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670188354625       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670188354625       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670188354625       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670188352162       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670188366702       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670188349412       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670188345316       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670188397801       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670188353145       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670188323310       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+07 is 6.723680e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8984e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6833
    reference variance = 0.937466
====================================================
  Execution time = 4.2673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1876e-01
  Total weights = 2.0000e+06
  Execution time = 3.9453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559703
                                         uncertainty =       0.006322836603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559703
                                         uncertainty =       0.006322836603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509292353
  error estimate for blocks of size 2^( 2) =       0.000526830842
  error estimate for blocks of size 2^( 3) =       0.000542445085
  error estimate for blocks of size 2^( 4) =       0.000552983915
  error estimate for blocks of size 2^( 5) =       0.000560757719
  error estimate for blocks of size 2^( 6) =       0.000564500201
  error estimate for blocks of size 2^( 7) =       0.000565957599

      target function =                  N/A
              le_mean =     -22.669953579712
             les_mean =     514.445552448222
             stat err =       0.000561049859
             autocorr =       1.213580541547
              std dev =       0.720248152585
             le_variance =       0.518757401302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559694
                                         uncertainty =       0.006322836602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559694
                                         uncertainty =       0.006322836602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509292353
  error estimate for blocks of size 2^( 2) =       0.000526830842
  error estimate for blocks of size 2^( 3) =       0.000542445085
  error estimate for blocks of size 2^( 4) =       0.000552983915
  error estimate for blocks of size 2^( 5) =       0.000560757719
  error estimate for blocks of size 2^( 6) =       0.000564500201
  error estimate for blocks of size 2^( 7) =       0.000565957599

      target function =                  N/A
              le_mean =     -22.669953579712
             les_mean =     514.445552448233
             stat err =       0.000561049859
             autocorr =       1.213580541543
              std dev =       0.720248152579
             le_variance =       0.518757401293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559699
                                         uncertainty =       0.006322836602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559699
                                         uncertainty =       0.006322836602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509292353
  error estimate for blocks of size 2^( 2) =       0.000526830842
  error estimate for blocks of size 2^( 3) =       0.000542445085
  error estimate for blocks of size 2^( 4) =       0.000552983915
  error estimate for blocks of size 2^( 5) =       0.000560757719
  error estimate for blocks of size 2^( 6) =       0.000564500201
  error estimate for blocks of size 2^( 7) =       0.000565957599

      target function =                  N/A
              le_mean =     -22.669953579712
             les_mean =     514.445552448227
             stat err =       0.000561049859
             autocorr =       1.213580541539
              std dev =       0.720248152582
             le_variance =       0.518757401298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559703
                                         uncertainty =       0.006322836603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518814559703
                                         uncertainty =       0.006322836603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509292353
  error estimate for blocks of size 2^( 2) =       0.000526830842
  error estimate for blocks of size 2^( 3) =       0.000542445085
  error estimate for blocks of size 2^( 4) =       0.000552983915
  error estimate for blocks of size 2^( 5) =       0.000560757719
  error estimate for blocks of size 2^( 6) =       0.000564500201
  error estimate for blocks of size 2^( 7) =       0.000565957599

      target function =                  N/A
              le_mean =     -22.669953579712
             les_mean =     514.445552448223
             stat err =       0.000561049859
             autocorr =       1.213580541553
              std dev =       0.720248152585
             le_variance =       0.518757401301


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669953579712        initial
     2.3283e+06     2.3283e+07             1.0758e-10       -22.669953579712  <--
     9.3132e+06     9.3132e+07             2.6897e-11       -22.669953579712
     3.7253e+07     3.7253e+08             6.7237e-12       -22.669953579712

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 6.1234e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2022e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6717
    reference variance = 0.336378
====================================================
  Execution time = 4.3658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1089e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4898e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510897309611
                                         uncertainty =       0.006641936110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510897309611
                                         uncertainty =       0.006641936110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505417104
  error estimate for blocks of size 2^( 2) =       0.000522574675
  error estimate for blocks of size 2^( 3) =       0.000537968823
  error estimate for blocks of size 2^( 4) =       0.000549154251
  error estimate for blocks of size 2^( 5) =       0.000554208680
  error estimate for blocks of size 2^( 6) =       0.000558411063
  error estimate for blocks of size 2^( 7) =       0.000560564892

      target function =                  N/A
              le_mean =     -22.669534173516
             les_mean =     514.418672286756
             stat err =       0.000555584722
             autocorr =       1.208372181480
              std dev =       0.714767723091
             le_variance =       0.510892897973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266953417352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669534173516       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669534173517       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669534173516       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669534173184       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669534173141       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669534173862       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669534173518       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669534173839       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669534173760       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669534174039       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669534173069       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+05 is 5.209745e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669534173516       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669534173517       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669534173516       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669534174018       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669534172783       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669534172868       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669534173525       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669534174881       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669534171955       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669534164935       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669534177586       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+06 is 1.302453e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669534173516       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669534173516       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669534173516       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669534173774       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669534176682       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669534172236       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669534173510       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669534165507       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669534168775       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669534168521       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669534148763       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+06 is 3.256186e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8565e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.678
    reference variance = 0.316286
====================================================
  Execution time = 4.2994e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1093e-01
  Total weights = 2.0000e+06
  Execution time = 3.5188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602334
                                         uncertainty =       0.003303613155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602334
                                         uncertainty =       0.003303613155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505437534
  error estimate for blocks of size 2^( 2) =       0.000522914772
  error estimate for blocks of size 2^( 3) =       0.000539095419
  error estimate for blocks of size 2^( 4) =       0.000550372845
  error estimate for blocks of size 2^( 5) =       0.000556462367
  error estimate for blocks of size 2^( 6) =       0.000560782318
  error estimate for blocks of size 2^( 7) =       0.000561385518

      target function =                  N/A
              le_mean =     -22.669707303620
             les_mean =     514.426563178340
             stat err =       0.000557250762
             autocorr =       1.215531903694
              std dev =       0.714796615818
             le_variance =       0.510934201986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602837
                                         uncertainty =       0.003303613158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602837
                                         uncertainty =       0.003303613158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505437534
  error estimate for blocks of size 2^( 2) =       0.000522914773
  error estimate for blocks of size 2^( 3) =       0.000539095420
  error estimate for blocks of size 2^( 4) =       0.000550372845
  error estimate for blocks of size 2^( 5) =       0.000556462367
  error estimate for blocks of size 2^( 6) =       0.000560782318
  error estimate for blocks of size 2^( 7) =       0.000561385518

      target function =                  N/A
              le_mean =     -22.669707303622
             les_mean =     514.426563178909
             stat err =       0.000557250762
             autocorr =       1.215531903367
              std dev =       0.714796616170
             le_variance =       0.510934202488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602586
                                         uncertainty =       0.003303613156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602586
                                         uncertainty =       0.003303613156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505437534
  error estimate for blocks of size 2^( 2) =       0.000522914772
  error estimate for blocks of size 2^( 3) =       0.000539095420
  error estimate for blocks of size 2^( 4) =       0.000550372845
  error estimate for blocks of size 2^( 5) =       0.000556462367
  error estimate for blocks of size 2^( 6) =       0.000560782318
  error estimate for blocks of size 2^( 7) =       0.000561385518

      target function =                  N/A
              le_mean =     -22.669707303621
             les_mean =     514.426563178624
             stat err =       0.000557250762
             autocorr =       1.215531903536
              std dev =       0.714796615994
             le_variance =       0.510934202237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602366
                                         uncertainty =       0.003303613155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511029602366
                                         uncertainty =       0.003303613155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505437534
  error estimate for blocks of size 2^( 2) =       0.000522914772
  error estimate for blocks of size 2^( 3) =       0.000539095419
  error estimate for blocks of size 2^( 4) =       0.000550372845
  error estimate for blocks of size 2^( 5) =       0.000556462367
  error estimate for blocks of size 2^( 6) =       0.000560782318
  error estimate for blocks of size 2^( 7) =       0.000561385518

      target function =                  N/A
              le_mean =     -22.669707303621
             les_mean =     514.426563178375
             stat err =       0.000557250762
             autocorr =       1.215531903674
              std dev =       0.714796615840
             le_variance =       0.510934202017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669707303620        initial
     5.8208e+05     5.8208e+06             5.2097e-10       -22.669707303622  <--
     2.3283e+06     2.3283e+07             1.3025e-10       -22.669707303621
     9.3132e+06     9.3132e+07             3.2562e-11       -22.669707303621

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 6.0632e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1923e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7354
    reference variance = 0.802574
====================================================
  Execution time = 4.3200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1136e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5198e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511360606359
                                         uncertainty =       0.005223644833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511360606359
                                         uncertainty =       0.005223644833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505645967
  error estimate for blocks of size 2^( 2) =       0.000523497332
  error estimate for blocks of size 2^( 3) =       0.000539425949
  error estimate for blocks of size 2^( 4) =       0.000550436107
  error estimate for blocks of size 2^( 5) =       0.000556857821
  error estimate for blocks of size 2^( 6) =       0.000563014185
  error estimate for blocks of size 2^( 7) =       0.000566233405

      target function =                  N/A
              le_mean =     -22.669927503303
             les_mean =     514.436968436445
             stat err =       0.000559135380
             autocorr =       1.222758954471
              std dev =       0.715091383762
             le_variance =       0.511355687130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266992750330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669927503303       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669927503308       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669927503311       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669927503319       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669927503358       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669927503353       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669927503397       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669927503275       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669927503370       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669927503928       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669927503574       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+05 is 1.703406e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669927503303       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669927503304       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669927503305       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669927503307       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669927503310       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669927503126       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669927503294       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669927503010       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669927503566       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669927503432       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669927501288       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+05 is 4.258516e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669927503303       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669927503303       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669927503303       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669927503304       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669927503056       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669927502431       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669927502436       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669927501592       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669927507084       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669927499676       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669927505883       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+06 is 1.064630e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8407e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702347e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475255e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6702
    reference variance = 0.479043
====================================================
  Execution time = 4.2950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1422e-01
  Total weights = 2.0000e+06
  Execution time = 3.5304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851033
                                         uncertainty =       0.007476256050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851033
                                         uncertainty =       0.007476256050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507062168
  error estimate for blocks of size 2^( 2) =       0.000524958408
  error estimate for blocks of size 2^( 3) =       0.000540860225
  error estimate for blocks of size 2^( 4) =       0.000552363505
  error estimate for blocks of size 2^( 5) =       0.000558601766
  error estimate for blocks of size 2^( 6) =       0.000564158388
  error estimate for blocks of size 2^( 7) =       0.000565763492

      target function =                  N/A
              le_mean =     -22.669961794550
             les_mean =     514.441391594232
             stat err =       0.000560221788
             autocorr =       1.220668034251
              std dev =       0.717094195342
             le_variance =       0.514224084993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851121
                                         uncertainty =       0.007476256122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851121
                                         uncertainty =       0.007476256122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507062168
  error estimate for blocks of size 2^( 2) =       0.000524958408
  error estimate for blocks of size 2^( 3) =       0.000540860225
  error estimate for blocks of size 2^( 4) =       0.000552363505
  error estimate for blocks of size 2^( 5) =       0.000558601766
  error estimate for blocks of size 2^( 6) =       0.000564158388
  error estimate for blocks of size 2^( 7) =       0.000565763492

      target function =                  N/A
              le_mean =     -22.669961794544
             les_mean =     514.441391594063
             stat err =       0.000560221788
             autocorr =       1.220668033858
              std dev =       0.717094195403
             le_variance =       0.514224085081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851077
                                         uncertainty =       0.007476256086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851077
                                         uncertainty =       0.007476256086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507062168
  error estimate for blocks of size 2^( 2) =       0.000524958408
  error estimate for blocks of size 2^( 3) =       0.000540860225
  error estimate for blocks of size 2^( 4) =       0.000552363505
  error estimate for blocks of size 2^( 5) =       0.000558601766
  error estimate for blocks of size 2^( 6) =       0.000564158388
  error estimate for blocks of size 2^( 7) =       0.000565763492

      target function =                  N/A
              le_mean =     -22.669961794547
             les_mean =     514.441391594147
             stat err =       0.000560221788
             autocorr =       1.220668034053
              std dev =       0.717094195372
             le_variance =       0.514224085037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851038
                                         uncertainty =       0.007476256054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514261851038
                                         uncertainty =       0.007476256054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507062168
  error estimate for blocks of size 2^( 2) =       0.000524958408
  error estimate for blocks of size 2^( 3) =       0.000540860225
  error estimate for blocks of size 2^( 4) =       0.000552363505
  error estimate for blocks of size 2^( 5) =       0.000558601766
  error estimate for blocks of size 2^( 6) =       0.000564158388
  error estimate for blocks of size 2^( 7) =       0.000565763492

      target function =                  N/A
              le_mean =     -22.669961794550
             les_mean =     514.441391594222
             stat err =       0.000560221788
             autocorr =       1.220668034224
              std dev =       0.717094195345
             le_variance =       0.514224084998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669961794550        initial  <--
     1.4552e+05     1.4552e+06             1.7034e-09       -22.669961794544
     5.8208e+05     5.8208e+06             4.2585e-10       -22.669961794547
     2.3283e+06     2.3283e+07             1.0646e-10       -22.669961794550

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.6242
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1904e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7481
    reference variance = 0.44551
====================================================
  Execution time = 4.3189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2094e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5704e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521055176888
                                         uncertainty =       0.006792356572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521055176888
                                         uncertainty =       0.006792356572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510364173
  error estimate for blocks of size 2^( 2) =       0.000527973551
  error estimate for blocks of size 2^( 3) =       0.000543390896
  error estimate for blocks of size 2^( 4) =       0.000554563767
  error estimate for blocks of size 2^( 5) =       0.000560640747
  error estimate for blocks of size 2^( 6) =       0.000565454012
  error estimate for blocks of size 2^( 7) =       0.000566518381

      target function =                  N/A
              le_mean =     -22.669876918685
             les_mean =     514.444262425858
             stat err =       0.000561794227
             autocorr =       1.211697423744
              std dev =       0.721763935090
             le_variance =       0.520943177996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266987691869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669876918685       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669876918684       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669876918684       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669876918684       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669876917898       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669876918418       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669876920030       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669876912674       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669876913594       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669876918591       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+06 is 1.651542e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669876918685       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669876918685       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669876918685       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669876918425       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669876918834       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669876910607       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669876922927       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669876918409       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669876919241       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669876915725       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+06 is 4.128886e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669876918685       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669876918685       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669876918685       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669876918685       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669876922626       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669876916086       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669876916560       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669876898381       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669876927795       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669876928636       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+07 is 1.032172e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8901e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7168
    reference variance = 0.456019
====================================================
  Execution time = 4.3146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1204e-01
  Total weights = 2.0000e+06
  Execution time = 3.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347069
                                         uncertainty =       0.003913843743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347069
                                         uncertainty =       0.003913843743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505986085
  error estimate for blocks of size 2^( 2) =       0.000524143311
  error estimate for blocks of size 2^( 3) =       0.000540213693
  error estimate for blocks of size 2^( 4) =       0.000551816131
  error estimate for blocks of size 2^( 5) =       0.000558831468
  error estimate for blocks of size 2^( 6) =       0.000562068373
  error estimate for blocks of size 2^( 7) =       0.000562245851

      target function =                  N/A
              le_mean =     -22.669770697507
             les_mean =     514.430547057025
             stat err =       0.000558740456
             autocorr =       1.219391291205
              std dev =       0.715572383125
             le_variance =       0.512043835492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347134
                                         uncertainty =       0.003913843745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347134
                                         uncertainty =       0.003913843745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505986085
  error estimate for blocks of size 2^( 2) =       0.000524143311
  error estimate for blocks of size 2^( 3) =       0.000540213693
  error estimate for blocks of size 2^( 4) =       0.000551816131
  error estimate for blocks of size 2^( 5) =       0.000558831468
  error estimate for blocks of size 2^( 6) =       0.000562068373
  error estimate for blocks of size 2^( 7) =       0.000562245851

      target function =                  N/A
              le_mean =     -22.669770697507
             les_mean =     514.430547057099
             stat err =       0.000558740456
             autocorr =       1.219391291144
              std dev =       0.715572383171
             le_variance =       0.512043835557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347101
                                         uncertainty =       0.003913843744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347101
                                         uncertainty =       0.003913843744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505986085
  error estimate for blocks of size 2^( 2) =       0.000524143311
  error estimate for blocks of size 2^( 3) =       0.000540213693
  error estimate for blocks of size 2^( 4) =       0.000551816131
  error estimate for blocks of size 2^( 5) =       0.000558831468
  error estimate for blocks of size 2^( 6) =       0.000562068373
  error estimate for blocks of size 2^( 7) =       0.000562245851

      target function =                  N/A
              le_mean =     -22.669770697507
             les_mean =     514.430547057062
             stat err =       0.000558740456
             autocorr =       1.219391291165
              std dev =       0.715572383148
             le_variance =       0.512043835524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347073
                                         uncertainty =       0.003913843743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512029347073
                                         uncertainty =       0.003913843743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505986085
  error estimate for blocks of size 2^( 2) =       0.000524143311
  error estimate for blocks of size 2^( 3) =       0.000540213693
  error estimate for blocks of size 2^( 4) =       0.000551816131
  error estimate for blocks of size 2^( 5) =       0.000558831468
  error estimate for blocks of size 2^( 6) =       0.000562068373
  error estimate for blocks of size 2^( 7) =       0.000562245851

      target function =                  N/A
              le_mean =     -22.669770697507
             les_mean =     514.430547057030
             stat err =       0.000558740456
             autocorr =       1.219391291195
              std dev =       0.715572383128
             le_variance =       0.512043835496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669770697507        initial
     1.4552e+06     1.4552e+07             1.6515e-10       -22.669770697507  <--
     5.8208e+06     5.8208e+07             4.1289e-11       -22.669770697507
     2.3283e+07     2.3283e+08             1.0322e-11       -22.669770697507

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 6.0849e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1976e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6777
    reference variance = 0.647924
====================================================
  Execution time = 4.3192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1355e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5045e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513631585332
                                         uncertainty =       0.008124404411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513631585332
                                         uncertainty =       0.008124404411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506731787
  error estimate for blocks of size 2^( 2) =       0.000524381807
  error estimate for blocks of size 2^( 3) =       0.000540176189
  error estimate for blocks of size 2^( 4) =       0.000551259773
  error estimate for blocks of size 2^( 5) =       0.000558598126
  error estimate for blocks of size 2^( 6) =       0.000563671289
  error estimate for blocks of size 2^( 7) =       0.000564879543

      target function =                  N/A
              le_mean =     -22.668504457939
             les_mean =     514.374648310758
             stat err =       0.000559602183
             autocorr =       1.219558123132
              std dev =       0.716626965689
             le_variance =       0.513554207953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266850445794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668504457939       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668504457938       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668504457939       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668504457861       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668504457948       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668504457881       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668504457921       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668504457754       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668504458194       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668504455210       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+05 is 7.490142e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668504457939       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668504457939       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668504457939       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668504457939       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668504457858       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668504458064       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668504457373       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668504458352       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668504460063       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668504456814       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+06 is 1.872536e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.668504457939       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.668504457939       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.668504457939       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.668504458472       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.668504457704       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.668504457778       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.668504457443       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.668504454213       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.668504462341       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.668504456380       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+06 is 4.681366e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8248e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702349e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033841e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475255e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6571
    reference variance = 0.516772
====================================================
  Execution time = 4.2745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0813e-01
  Total weights = 2.0000e+06
  Execution time = 3.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520336
                                         uncertainty =       0.004418228706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520336
                                         uncertainty =       0.004418228706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504047262
  error estimate for blocks of size 2^( 2) =       0.000521945139
  error estimate for blocks of size 2^( 3) =       0.000538922469
  error estimate for blocks of size 2^( 4) =       0.000551676574
  error estimate for blocks of size 2^( 5) =       0.000557360996
  error estimate for blocks of size 2^( 6) =       0.000561145715
  error estimate for blocks of size 2^( 7) =       0.000562304637

      target function =                  N/A
              le_mean =     -22.670968074282
             les_mean =     514.480920455883
             stat err =       0.000558121981
             autocorr =       1.226071319898
              std dev =       0.712830474109
             le_variance =       0.508127284818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520521
                                         uncertainty =       0.004418228707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520521
                                         uncertainty =       0.004418228707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504047262
  error estimate for blocks of size 2^( 2) =       0.000521945139
  error estimate for blocks of size 2^( 3) =       0.000538922469
  error estimate for blocks of size 2^( 4) =       0.000551676575
  error estimate for blocks of size 2^( 5) =       0.000557360996
  error estimate for blocks of size 2^( 6) =       0.000561145715
  error estimate for blocks of size 2^( 7) =       0.000562304637

      target function =                  N/A
              le_mean =     -22.670968074281
             les_mean =     514.480920456029
             stat err =       0.000558121981
             autocorr =       1.226071319791
              std dev =       0.712830474238
             le_variance =       0.508127285003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520429
                                         uncertainty =       0.004418228707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520429
                                         uncertainty =       0.004418228707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504047262
  error estimate for blocks of size 2^( 2) =       0.000521945139
  error estimate for blocks of size 2^( 3) =       0.000538922469
  error estimate for blocks of size 2^( 4) =       0.000551676575
  error estimate for blocks of size 2^( 5) =       0.000557360996
  error estimate for blocks of size 2^( 6) =       0.000561145715
  error estimate for blocks of size 2^( 7) =       0.000562304637

      target function =                  N/A
              le_mean =     -22.670968074282
             les_mean =     514.480920455956
             stat err =       0.000558121981
             autocorr =       1.226071319844
              std dev =       0.712830474174
             le_variance =       0.508127284911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520348
                                         uncertainty =       0.004418228706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508152520348
                                         uncertainty =       0.004418228706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504047262
  error estimate for blocks of size 2^( 2) =       0.000521945139
  error estimate for blocks of size 2^( 3) =       0.000538922469
  error estimate for blocks of size 2^( 4) =       0.000551676575
  error estimate for blocks of size 2^( 5) =       0.000557360996
  error estimate for blocks of size 2^( 6) =       0.000561145715
  error estimate for blocks of size 2^( 7) =       0.000562304637

      target function =                  N/A
              le_mean =     -22.670968074282
             les_mean =     514.480920455892
             stat err =       0.000558121981
             autocorr =       1.226071319893
              std dev =       0.712830474117
             le_variance =       0.508127284830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670968074282        initial  <--
     3.6380e+05     3.6380e+06             7.4901e-10       -22.670968074281
     1.4552e+06     1.4552e+07             1.8725e-10       -22.670968074282
     5.8208e+06     5.8208e+07             4.6814e-11       -22.670968074282

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4005
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1866e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6632
    reference variance = 1.28815
====================================================
  Execution time = 4.3537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4837e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509186412490
                                         uncertainty =       0.004157508579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509186412490
                                         uncertainty =       0.004157508579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504592654
  error estimate for blocks of size 2^( 2) =       0.000522182335
  error estimate for blocks of size 2^( 3) =       0.000538427272
  error estimate for blocks of size 2^( 4) =       0.000549843696
  error estimate for blocks of size 2^( 5) =       0.000556173757
  error estimate for blocks of size 2^( 6) =       0.000558572018
  error estimate for blocks of size 2^( 7) =       0.000563914122

      target function =                  N/A
              le_mean =     -22.670047087064
             les_mean =     514.440262167237
             stat err =       0.000557125898
             autocorr =       1.219059343966
              std dev =       0.713601774219
             le_variance =       0.509227492168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267004708706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670047087064       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670047087064       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670047087064       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670047087253       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670047086942       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670047086822       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670047091255       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670047087666       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670047085909       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670047104427       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+06 is 5.995774e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670047087064       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670047087064       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670047087064       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670047087853       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670047063832       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670047072218       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670047091307       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670047088834       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670047110924       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670047106383       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+07 is 1.498963e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670047087064       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670047087064       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670047087064       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670047087064       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670047087064       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670047053327       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670047083955       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670047079689       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670047111790       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670047173955       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+07 is 3.747481e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8382e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6772
    reference variance = 0.437266
====================================================
  Execution time = 4.2823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1410e-01
  Total weights = 2.0000e+06
  Execution time = 3.5220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191882
                                         uncertainty =       0.009866585361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191882
                                         uncertainty =       0.009866585361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507002715
  error estimate for blocks of size 2^( 2) =       0.000524372983
  error estimate for blocks of size 2^( 3) =       0.000540021998
  error estimate for blocks of size 2^( 4) =       0.000551119416
  error estimate for blocks of size 2^( 5) =       0.000557645401
  error estimate for blocks of size 2^( 6) =       0.000560252919
  error estimate for blocks of size 2^( 7) =       0.000560877442

      target function =                  N/A
              le_mean =     -22.669294827555
             les_mean =     514.411031226692
             stat err =       0.000557473795
             autocorr =       1.209005690509
              std dev =       0.717010115093
             le_variance =       0.514103505145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191870
                                         uncertainty =       0.009866585362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191870
                                         uncertainty =       0.009866585362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507002715
  error estimate for blocks of size 2^( 2) =       0.000524372983
  error estimate for blocks of size 2^( 3) =       0.000540021998
  error estimate for blocks of size 2^( 4) =       0.000551119416
  error estimate for blocks of size 2^( 5) =       0.000557645401
  error estimate for blocks of size 2^( 6) =       0.000560252919
  error estimate for blocks of size 2^( 7) =       0.000560877442

      target function =                  N/A
              le_mean =     -22.669294827554
             les_mean =     514.411031226669
             stat err =       0.000557473795
             autocorr =       1.209005690506
              std dev =       0.717010115084
             le_variance =       0.514103505133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191876
                                         uncertainty =       0.009866585361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191876
                                         uncertainty =       0.009866585361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507002715
  error estimate for blocks of size 2^( 2) =       0.000524372983
  error estimate for blocks of size 2^( 3) =       0.000540021998
  error estimate for blocks of size 2^( 4) =       0.000551119416
  error estimate for blocks of size 2^( 5) =       0.000557645401
  error estimate for blocks of size 2^( 6) =       0.000560252919
  error estimate for blocks of size 2^( 7) =       0.000560877442

      target function =                  N/A
              le_mean =     -22.669294827555
             les_mean =     514.411031226681
             stat err =       0.000557473795
             autocorr =       1.209005690513
              std dev =       0.717010115088
             le_variance =       0.514103505139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191882
                                         uncertainty =       0.009866585361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514200191882
                                         uncertainty =       0.009866585361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507002715
  error estimate for blocks of size 2^( 2) =       0.000524372983
  error estimate for blocks of size 2^( 3) =       0.000540021998
  error estimate for blocks of size 2^( 4) =       0.000551119416
  error estimate for blocks of size 2^( 5) =       0.000557645401
  error estimate for blocks of size 2^( 6) =       0.000560252919
  error estimate for blocks of size 2^( 7) =       0.000560877442

      target function =                  N/A
              le_mean =     -22.669294827555
             les_mean =     514.411031226691
             stat err =       0.000557473795
             autocorr =       1.209005690507
              std dev =       0.717010115092
             le_variance =       0.514103505144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669294827555        initial  <--
     3.6380e+06     3.6380e+07             5.9958e-11       -22.669294827554
     1.4552e+07     1.4552e+08             1.4990e-11       -22.669294827555
     5.8208e+07     5.8208e+08             3.7475e-12       -22.669294827555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2673
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2166e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6733
    reference variance = 0.541934
====================================================
  Execution time = 4.3659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1310e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4983e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513083694452
                                         uncertainty =       0.005701452425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513083694452
                                         uncertainty =       0.005701452425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506509048
  error estimate for blocks of size 2^( 2) =       0.000524322710
  error estimate for blocks of size 2^( 3) =       0.000540393152
  error estimate for blocks of size 2^( 4) =       0.000551780206
  error estimate for blocks of size 2^( 5) =       0.000558053442
  error estimate for blocks of size 2^( 6) =       0.000560384816
  error estimate for blocks of size 2^( 7) =       0.000564400538

      target function =                  N/A
              le_mean =     -22.670156872717
             les_mean =     514.449115209271
             stat err =       0.000558654751
             autocorr =       1.216501297509
              std dev =       0.716311965717
             le_variance =       0.513102832230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267015687272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670156872717       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670156872717       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670156872717       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670156872254       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670156898558       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670156874878       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670156854413       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670156872603       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670156892970       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670156864629       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+07 is 6.733200e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670156872717       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670156872717       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670156872717       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670156880796       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670156856349       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670156937325       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670156808200       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670156862360       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670156927767       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670157036899       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+08 is 1.683297e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670156872717       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670156872717       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670156872717       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670156872717       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670156873564       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670156854781       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670156698516       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670157020816       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670156578891       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670157557834       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+08 is 4.207501e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8651e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.672
    reference variance = 0.343507
====================================================
  Execution time = 4.2843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1060e-01
  Total weights = 2.0000e+06
  Execution time = 3.5223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988733
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988733
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505271702
  error estimate for blocks of size 2^( 2) =       0.000523364004
  error estimate for blocks of size 2^( 3) =       0.000539662544
  error estimate for blocks of size 2^( 4) =       0.000550753504
  error estimate for blocks of size 2^( 5) =       0.000556943029
  error estimate for blocks of size 2^( 6) =       0.000559093692
  error estimate for blocks of size 2^( 7) =       0.000561118218

      target function =                  N/A
              le_mean =     -22.669795981536
             les_mean =     514.430248575684
             stat err =       0.000556977111
             autocorr =       1.215135596736
              std dev =       0.714562094239
             le_variance =       0.510598986524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988731
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988731
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505271702
  error estimate for blocks of size 2^( 2) =       0.000523364004
  error estimate for blocks of size 2^( 3) =       0.000539662544
  error estimate for blocks of size 2^( 4) =       0.000550753504
  error estimate for blocks of size 2^( 5) =       0.000556943029
  error estimate for blocks of size 2^( 6) =       0.000559093693
  error estimate for blocks of size 2^( 7) =       0.000561118218

      target function =                  N/A
              le_mean =     -22.669795981536
             les_mean =     514.430248575682
             stat err =       0.000556977111
             autocorr =       1.215135596742
              std dev =       0.714562094238
             le_variance =       0.510598986522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988732
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988732
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505271702
  error estimate for blocks of size 2^( 2) =       0.000523364004
  error estimate for blocks of size 2^( 3) =       0.000539662544
  error estimate for blocks of size 2^( 4) =       0.000550753504
  error estimate for blocks of size 2^( 5) =       0.000556943029
  error estimate for blocks of size 2^( 6) =       0.000559093693
  error estimate for blocks of size 2^( 7) =       0.000561118218

      target function =                  N/A
              le_mean =     -22.669795981536
             les_mean =     514.430248575683
             stat err =       0.000556977111
             autocorr =       1.215135596743
              std dev =       0.714562094238
             le_variance =       0.510598986523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988733
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510721988733
                                         uncertainty =       0.004220666442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505271702
  error estimate for blocks of size 2^( 2) =       0.000523364004
  error estimate for blocks of size 2^( 3) =       0.000539662544
  error estimate for blocks of size 2^( 4) =       0.000550753504
  error estimate for blocks of size 2^( 5) =       0.000556943029
  error estimate for blocks of size 2^( 6) =       0.000559093692
  error estimate for blocks of size 2^( 7) =       0.000561118218

      target function =                  N/A
              le_mean =     -22.669795981536
             les_mean =     514.430248575684
             stat err =       0.000556977111
             autocorr =       1.215135596735
              std dev =       0.714562094239
             le_variance =       0.510598986524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669795981536        initial  <--
     3.6380e+07     3.6380e+08             6.7332e-12       -22.669795981536
     1.4552e+08     1.4552e+09             1.6833e-12       -22.669795981536
     5.8208e+08     5.8208e+09             4.2075e-13       -22.669795981536

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5030
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1916e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28200 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7242
    reference variance = 0.456718
====================================================
  Execution time = 4.3564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5204e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513227816575
                                         uncertainty =       0.006137110239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513227816575
                                         uncertainty =       0.006137110239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506546992
  error estimate for blocks of size 2^( 2) =       0.000523767635
  error estimate for blocks of size 2^( 3) =       0.000539453154
  error estimate for blocks of size 2^( 4) =       0.000550244248
  error estimate for blocks of size 2^( 5) =       0.000557865655
  error estimate for blocks of size 2^( 6) =       0.000562820799
  error estimate for blocks of size 2^( 7) =       0.000566065003

      target function =                  N/A
              le_mean =     -22.669592559092
             les_mean =     514.423606249737
             stat err =       0.000559248926
             autocorr =       1.218907742278
              std dev =       0.716365626688
             le_variance =       0.513179711101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266959255909e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669592559092       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669592559092       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669592559092       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669592559092       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669593176232       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669592479163       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669592572603       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669592536737       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669592933889       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669592558468       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669592817594       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+08 is 5.770995e-13

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669592559092       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669592559092       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669592559092       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669592559092       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669592554594       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669592470159       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669593006275       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669592676174       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669592925524       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669592624606       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669591419210       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+09 is 1.441693e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669592559092       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669592559092       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669592559092       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669593536405       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669595953471       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669594245456       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669591703903       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669591728698       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669590788694       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669578486384       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669577194320       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669618588591       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669597463414       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669620175168       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.669608863153       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.669664806402       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.669582037789       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.669786625080       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.669615832286       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.669588856373       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.669395605105       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.669655951916       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.669526292411       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.669518087461       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.669311986235       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.669416990072       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -22.669657263665       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -22.669453088308       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -22.668953490282       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -22.668833834993       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -22.669615698794       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -22.669033324491       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -22.669074741864       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -22.669385852699       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -22.669222497064       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -22.668678315396       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -22.669775439782       residual = 1.63e-05           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   energy =     -22.668899552511       residual = 2.70e-04           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   energy =     -22.669642976359       residual = 5.06e-06           smallest_sin_value = 9.96e-01
davidson iteration   39:   krylov dim =  40   energy =     -22.670062088520       residual = 1.14e-04           smallest_sin_value = 9.94e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+09 is 3.634267e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8808e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6807
    reference variance = 0.524778
====================================================
  Execution time = 4.2957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2168e-01
  Total weights = 2.0000e+06
  Execution time = 3.5298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510724404
  error estimate for blocks of size 2^( 2) =       0.000528064952
  error estimate for blocks of size 2^( 3) =       0.000544242312
  error estimate for blocks of size 2^( 4) =       0.000555271828
  error estimate for blocks of size 2^( 5) =       0.000562229633
  error estimate for blocks of size 2^( 6) =       0.000564815873
  error estimate for blocks of size 2^( 7) =       0.000565734794

      target function =                  N/A
              le_mean =     -22.670258555344
             les_mean =     514.462301538310
             stat err =       0.000562013032
             autocorr =       1.210931432233
              std dev =       0.722273378307
             le_variance =       0.521678833012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510724404
  error estimate for blocks of size 2^( 2) =       0.000528064952
  error estimate for blocks of size 2^( 3) =       0.000544242312
  error estimate for blocks of size 2^( 4) =       0.000555271828
  error estimate for blocks of size 2^( 5) =       0.000562229633
  error estimate for blocks of size 2^( 6) =       0.000564815873
  error estimate for blocks of size 2^( 7) =       0.000565734794

      target function =                  N/A
              le_mean =     -22.670258555344
             les_mean =     514.462301538309
             stat err =       0.000562013032
             autocorr =       1.210931432238
              std dev =       0.722273378307
             le_variance =       0.521678833011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510724404
  error estimate for blocks of size 2^( 2) =       0.000528064952
  error estimate for blocks of size 2^( 3) =       0.000544242312
  error estimate for blocks of size 2^( 4) =       0.000555271828
  error estimate for blocks of size 2^( 5) =       0.000562229633
  error estimate for blocks of size 2^( 6) =       0.000564815873
  error estimate for blocks of size 2^( 7) =       0.000565734794

      target function =                  N/A
              le_mean =     -22.670258555344
             les_mean =     514.462301538310
             stat err =       0.000562013032
             autocorr =       1.210931432236
              std dev =       0.722273378307
             le_variance =       0.521678833012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521396019238
                                         uncertainty =       0.009674310270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510724404
  error estimate for blocks of size 2^( 2) =       0.000528064952
  error estimate for blocks of size 2^( 3) =       0.000544242312
  error estimate for blocks of size 2^( 4) =       0.000555271828
  error estimate for blocks of size 2^( 5) =       0.000562229633
  error estimate for blocks of size 2^( 6) =       0.000564815873
  error estimate for blocks of size 2^( 7) =       0.000565734794

      target function =                  N/A
              le_mean =     -22.670258555344
             les_mean =     514.462301538309
             stat err =       0.000562013032
             autocorr =       1.210931432235
              std dev =       0.722273378307
             le_variance =       0.521678833012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670258555344        initial
     3.6380e+08     3.6380e+09             5.7710e-13       -22.670258555344  <--
     1.4552e+09     1.4552e+10             1.4417e-13       -22.670258555344
     5.8208e+09     5.8208e+10             3.6343e-14       -22.670258555344

*****************************************************************************
Applying the update for shift_i =   3.6380e+08     and shift_s =   3.6380e+09
*****************************************************************************

  Execution time = 6.0658e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.944198e-01 1 1  ON 0
 uu_1                 1.189477e-01 1 1  ON 1
 uu_2                 5.386814e-03 1 1  ON 2
 uu_3                -6.181192e-02 1 1  ON 3
 uu_4                -1.020966e-01 1 1  ON 4
 uu_5                -1.277912e-01 1 1  ON 5
 uu_6                -1.428698e-01 1 1  ON 6
 uu_7                -1.471655e-01 1 1  ON 7
 uu_8                -1.392108e-01 1 1  ON 8
 uu_9                -1.164316e-01 1 1  ON 9
 ud_0                 4.099252e-01 1 1  ON 10
 ud_1                 1.276937e-01 1 1  ON 11
 ud_2                -1.854180e-02 1 1  ON 12
 ud_3                -9.639789e-02 1 1  ON 13
 ud_4                -1.387846e-01 1 1  ON 14
 ud_5                -1.634490e-01 1 1  ON 15
 ud_6                -1.759646e-01 1 1  ON 16
 ud_7                -1.765396e-01 1 1  ON 17
 ud_8                -1.634118e-01 1 1  ON 18
 ud_9                -1.343554e-01 1 1  ON 19
 eC_0                -5.801150e-01 1 1  ON 20
 eC_1                -4.285468e-01 1 1  ON 21
 eC_2                -1.768515e-01 1 1  ON 22
 eC_3                -2.249384e-02 1 1  ON 23
 eC_4                 5.704338e-02 1 1  ON 24
 eC_5                 1.566322e-01 1 1  ON 25
 eC_6                 2.541452e-01 1 1  ON 26
 eC_7                 3.752718e-01 1 1  ON 27
 eC_8                 2.777572e-01 1 1  ON 28
 eC_9                 8.015229e-02 1 1  ON 29
 eO_0                -1.181192e+00 1 1  ON 30
 eO_1                -8.046150e-01 1 1  ON 31
 eO_2                -3.396571e-01 1 1  ON 32
 eO_3                 4.702350e-04 1 1  ON 33
 eO_4                 2.233776e-01 1 1  ON 34
 eO_5                 3.865533e-01 1 1  ON 35
 eO_6                 4.296739e-01 1 1  ON 36
 eO_7                 4.261656e-01 1 1  ON 37
 eO_8                 4.139536e-01 1 1  ON 38
 eO_9                 3.087033e-01 1 1  ON 39
eH1_0                -2.063734e-01 1 1  ON 40
eH1_1                -1.141465e-01 1 1  ON 41
eH1_2                -7.787435e-02 1 1  ON 42
eH1_3                -5.912836e-02 1 1  ON 43
eH1_4                 1.018136e-02 1 1  ON 44
eH1_5                 5.522715e-02 1 1  ON 45
eH1_6                 9.033842e-02 1 1  ON 46
eH1_7                 6.510162e-02 1 1  ON 47
eH1_8                 1.158063e-03 1 1  ON 48
eH1_9                 6.591464e-02 1 1  ON 49
eH2_0                -2.022497e-01 1 1  ON 50
eH2_1                -1.106700e-01 1 1  ON 51
eH2_2                -7.428482e-02 1 1  ON 52
eH2_3                -5.548368e-02 1 1  ON 53
eH2_4                 1.409791e-02 1 1  ON 54
eH2_5                 5.931447e-02 1 1  ON 55
eH2_6                 9.505741e-02 1 1  ON 56
eH2_7                 7.065201e-02 1 1  ON 57
eH2_8                 9.475254e-03 1 1  ON 58
eH2_9                 6.561405e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1947e+02 secs
  Total Execution time = 4.8041e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
