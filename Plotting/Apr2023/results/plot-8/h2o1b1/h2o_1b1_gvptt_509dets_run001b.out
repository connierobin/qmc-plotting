Rank =    0  Free Memory = 80093 MB
Rank =    1  Free Memory = 80093 MB
Rank =    2  Free Memory = 80093 MB
Rank =    3  Free Memory = 80093 MB
Rank =    4  Free Memory = 80092 MB
Rank =    5  Free Memory = 80092 MB
Rank =    6  Free Memory = 80092 MB
Rank =    7  Free Memory = 80092 MB
Rank =    8  Free Memory = 80092 MB
Rank =    9  Free Memory = 80092 MB
Rank =   10  Free Memory = 80092 MB
Rank =   11  Free Memory = 80092 MB
Rank =   12  Free Memory = 80092 MB
Rank =   13  Free Memory = 80092 MB
Rank =   14  Free Memory = 80091 MB
Rank =   15  Free Memory = 80076 MB
Rank =   16  Free Memory = 80076 MB
Rank =   17  Free Memory = 80076 MB
Rank =   18  Free Memory = 80076 MB
Rank =   19  Free Memory = 80076 MB
Rank =   20  Free Memory = 80076 MB
Rank =   21  Free Memory = 80076 MB
Rank =   22  Free Memory = 80076 MB
Rank =   23  Free Memory = 80076 MB
Rank =   24  Free Memory = 80076 MB
Rank =   25  Free Memory = 80076 MB
Rank =   26  Free Memory = 80076 MB
Rank =   27  Free Memory = 80076 MB
Rank =   28  Free Memory = 80076 MB
Rank =   29  Free Memory = 80076 MB
Rank =   30  Free Memory = 80076 MB
Rank =   31  Free Memory = 80076 MB
Rank =   32  Free Memory = 74475 MB
Rank =   33  Free Memory = 74475 MB
Rank =   34  Free Memory = 74475 MB
Rank =   35  Free Memory = 74475 MB
Rank =   36  Free Memory = 74475 MB
Rank =   37  Free Memory = 74475 MB
Rank =   38  Free Memory = 74475 MB
Rank =   39  Free Memory = 74475 MB
Rank =   40  Free Memory = 74475 MB
Rank =   41  Free Memory = 74475 MB
Rank =   42  Free Memory = 74475 MB
Rank =   43  Free Memory = 74475 MB
Rank =   44  Free Memory = 74475 MB
Rank =   45  Free Memory = 74475 MB
Rank =   46  Free Memory = 74475 MB
Rank =   47  Free Memory = 74475 MB
Rank =   48  Free Memory = 74475 MB
Rank =   49  Free Memory = 74475 MB
Rank =   50  Free Memory = 74475 MB
Rank =   51  Free Memory = 74475 MB
Rank =   52  Free Memory = 74475 MB
Rank =   53  Free Memory = 74475 MB
Rank =   54  Free Memory = 74475 MB
Rank =   55  Free Memory = 74475 MB
Rank =   56  Free Memory = 74475 MB
Rank =   57  Free Memory = 74475 MB
Rank =   58  Free Memory = 74475 MB
Rank =   59  Free Memory = 74475 MB
Rank =   60  Free Memory = 74475 MB
Rank =   61  Free Memory = 74475 MB
Rank =   62  Free Memory = 74475 MB
Rank =   63  Free Memory = 74475 MB
Rank =   64  Free Memory = 75036 MB
Rank =   65  Free Memory = 75035 MB
Rank =   66  Free Memory = 75035 MB
Rank =   67  Free Memory = 75035 MB
Rank =   68  Free Memory = 75035 MB
Rank =   69  Free Memory = 75035 MB
Rank =   70  Free Memory = 75035 MB
Rank =   71  Free Memory = 75035 MB
Rank =   72  Free Memory = 75035 MB
Rank =   73  Free Memory = 75035 MB
Rank =   74  Free Memory = 75035 MB
Rank =   75  Free Memory = 75035 MB
Rank =   76  Free Memory = 75035 MB
Rank =   77  Free Memory = 75035 MB
Rank =   78  Free Memory = 75035 MB
Rank =   79  Free Memory = 75035 MB
Rank =   80  Free Memory = 75035 MB
Rank =   81  Free Memory = 75035 MB
Rank =   82  Free Memory = 75035 MB
Rank =   83  Free Memory = 75035 MB
Rank =   84  Free Memory = 75035 MB
Rank =   85  Free Memory = 75035 MB
Rank =   86  Free Memory = 75035 MB
Rank =   87  Free Memory = 75035 MB
Rank =   88  Free Memory = 75035 MB
Rank =   89  Free Memory = 75035 MB
Rank =   90  Free Memory = 75035 MB
Rank =   91  Free Memory = 75035 MB
Rank =   92  Free Memory = 75035 MB
Rank =   93  Free Memory = 75035 MB
Rank =   94  Free Memory = 75035 MB
Rank =   95  Free Memory = 75035 MB
Rank =   96  Free Memory = 69703 MB
Rank =   97  Free Memory = 69703 MB
Rank =   98  Free Memory = 69703 MB
Rank =   99  Free Memory = 69703 MB
Rank =  100  Free Memory = 69703 MB
Rank =  101  Free Memory = 69703 MB
Rank =  102  Free Memory = 69703 MB
Rank =  103  Free Memory = 69703 MB
Rank =  104  Free Memory = 69702 MB
Rank =  105  Free Memory = 69702 MB
Rank =  106  Free Memory = 69702 MB
Rank =  107  Free Memory = 69702 MB
Rank =  108  Free Memory = 69702 MB
Rank =  109  Free Memory = 69702 MB
Rank =  110  Free Memory = 69702 MB
Rank =  111  Free Memory = 69702 MB
Rank =  112  Free Memory = 69702 MB
Rank =  113  Free Memory = 69702 MB
Rank =  114  Free Memory = 69702 MB
Rank =  115  Free Memory = 69702 MB
Rank =  116  Free Memory = 69702 MB
Rank =  117  Free Memory = 69702 MB
Rank =  118  Free Memory = 69702 MB
Rank =  119  Free Memory = 69702 MB
Rank =  120  Free Memory = 69702 MB
Rank =  121  Free Memory = 69702 MB
Rank =  122  Free Memory = 69702 MB
Rank =  123  Free Memory = 69702 MB
Rank =  124  Free Memory = 69702 MB
Rank =  125  Free Memory = 69702 MB
Rank =  126  Free Memory = 69702 MB
Rank =  127  Free Memory = 69702 MB
  Input file(s): opt_h2o_1b1_gvptt_509dets_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_509dets_run001b.xml

  Project = H2O
  date    = 2023-05-11 02:23:35 PDT
  host    = n0016.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 23

  Range of prime numbers to use as seeds over processors and threads = 97-883


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 509 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.834447e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 94 unique up determinants.
Found 94 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.4492e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.514591
====================================================
  Execution time = 2.8222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 1.2352e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.236789436947
                                         uncertainty =       0.896535306443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.236789436947
                                         uncertainty =       0.896535306443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000785886621
  error estimate for blocks of size 2^( 2) =       0.000792415353
  error estimate for blocks of size 2^( 3) =       0.000798646109
  error estimate for blocks of size 2^( 4) =       0.000804871050
  error estimate for blocks of size 2^( 5) =       0.000810696555
  error estimate for blocks of size 2^( 6) =       0.000815797892
  error estimate for blocks of size 2^( 7) =       0.000819788148

      target function =                  N/A
              le_mean =     -16.908591058435
             les_mean =     287.135686525012
             stat err =       0.000812788412
             autocorr =       1.069634040050
              std dev =       1.111411517510
             le_variance =       1.235235561254


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690859105843e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908591058435       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908793838732       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908913543032       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909007893842       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909030610154       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909038258088       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909055631822       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909063071866       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909066021963       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909066922251       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909066423238       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909066023499       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909065960406       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.084061e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908591058435       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908668880286       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908727116765       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908760321424       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908764867397       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908767319282       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908771630513       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908773508245       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908773363023       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908773482069       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908773394250       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.856567e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908591058435       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908613518246       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908632390204       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908640110614       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908642288240       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908643117433       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908644549152       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908644513143       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908644712777       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908644698222       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908644702300       residual = 7.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.102138e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5440e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.023149e-01                 1 1 ON  0
uu_1  1.389089e-01                 1 1 ON  1
uu_2  4.193925e-02                 1 1 ON  2
uu_3  -1.885712e-02                1 1 ON  3
uu_4  -6.309699e-02                1 1 ON  4
uu_5  -9.592557e-02                1 1 ON  5
uu_6  -1.204966e-01                1 1 ON  6
uu_7  -1.306301e-01                1 1 ON  7
uu_8  -1.205590e-01                1 1 ON  8
uu_9  -9.282772e-02                1 1 ON  9
ud_0  4.123667e-01                 1 1 ON  10
ud_1  1.602562e-01                 1 1 ON  11
ud_2  5.998387e-02                 1 1 ON  12
ud_3  1.005990e-03                 1 1 ON  13
ud_4  -5.674523e-02                1 1 ON  14
ud_5  -1.012621e-01                1 1 ON  15
ud_6  -1.290358e-01                1 1 ON  16
ud_7  -1.438440e-01                1 1 ON  17
ud_8  -1.426056e-01                1 1 ON  18
ud_9  -1.344115e-01                1 1 ON  19
eO_0  -7.081666e-01                1 1 ON  20
eO_1  -4.142300e-01                1 1 ON  21
eO_2  -2.900627e-02                1 1 ON  22
eO_3  2.711744e-01                 1 1 ON  23
eO_4  4.920224e-01                 1 1 ON  24
eO_5  4.593022e-01                 1 1 ON  25
eO_6  2.356774e-01                 1 1 ON  26
eO_7  -5.585087e-02                1 1 ON  27
eO_8  -1.960345e-01                1 1 ON  28
eO_9  -5.779909e-02                1 1 ON  29
eH1_0 -2.119484e-01                1 1 ON  30
eH1_1 -1.272147e-01                1 1 ON  31
eH1_2 -8.809600e-02                1 1 ON  32
eH1_3 -3.760546e-02                1 1 ON  33
eH1_4 1.264479e-02                 1 1 ON  34
eH1_5 4.514488e-02                 1 1 ON  35
eH1_6 9.480112e-02                 1 1 ON  36
eH1_7 1.379035e-01                 1 1 ON  37
eH1_8 1.458958e-01                 1 1 ON  38
eH1_9 3.304072e-02                 1 1 ON  39
eH2_0 -2.106899e-01                1 1 ON  40
eH2_1 -1.264739e-01                1 1 ON  41
eH2_2 -8.725787e-02                1 1 ON  42
eH2_3 -3.647854e-02                1 1 ON  43
eH2_4 1.388615e-02                 1 1 ON  44
eH2_5 4.838263e-02                 1 1 ON  45
eH2_6 1.009474e-01                 1 1 ON  46
eH2_7 1.496240e-01                 1 1 ON  47
eH2_8 1.535652e-01                 1 1 ON  48
eH2_9 1.302574e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9347
    reference variance = 0.238852
====================================================
  Execution time = 2.7801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4046e-01
  Total weights = 2.0000e+06
  Execution time = 3.5214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824094903
                                         uncertainty =       0.004937182297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824094903
                                         uncertainty =       0.004937182297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413361852
  error estimate for blocks of size 2^( 2) =       0.000426421379
  error estimate for blocks of size 2^( 3) =       0.000439816910
  error estimate for blocks of size 2^( 4) =       0.000452457968
  error estimate for blocks of size 2^( 5) =       0.000464138511
  error estimate for blocks of size 2^( 6) =       0.000472571884
  error estimate for blocks of size 2^( 7) =       0.000478033396

      target function =                  N/A
              le_mean =     -16.908551589745
             les_mean =     286.240852733763
             stat err =       0.000466800440
             autocorr =       1.275268768924
              std dev =       0.584581937429
             le_variance =       0.341736041569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403838686
                                         uncertainty =       0.004970655972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340403838686
                                         uncertainty =       0.004970655972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412501089
  error estimate for blocks of size 2^( 2) =       0.000425183269
  error estimate for blocks of size 2^( 3) =       0.000438263751
  error estimate for blocks of size 2^( 4) =       0.000450753930
  error estimate for blocks of size 2^( 5) =       0.000462398092
  error estimate for blocks of size 2^( 6) =       0.000470756541
  error estimate for blocks of size 2^( 7) =       0.000476284941

      target function =                  N/A
              le_mean =     -16.908580124279
             les_mean =     286.240395945483
             stat err =       0.000465048376
             autocorr =       1.271001508111
              std dev =       0.583364634229
             le_variance =       0.340314296469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709027658
                                         uncertainty =       0.004949251285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709027658
                                         uncertainty =       0.004949251285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412080173
  error estimate for blocks of size 2^( 2) =       0.000424848389
  error estimate for blocks of size 2^( 3) =       0.000438013307
  error estimate for blocks of size 2^( 4) =       0.000450562605
  error estimate for blocks of size 2^( 5) =       0.000462232212
  error estimate for blocks of size 2^( 6) =       0.000470595940
  error estimate for blocks of size 2^( 7) =       0.000476113325

      target function =                  N/A
              le_mean =     -16.908550747290
             les_mean =     286.238708341253
             stat err =       0.000464876020
             autocorr =       1.272655478874
              std dev =       0.582769368943
             le_variance =       0.339620137379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341308185401
                                         uncertainty =       0.004937457688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341308185401
                                         uncertainty =       0.004937457688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413049650
  error estimate for blocks of size 2^( 2) =       0.000426060511
  error estimate for blocks of size 2^( 3) =       0.000439418899
  error estimate for blocks of size 2^( 4) =       0.000452046699
  error estimate for blocks of size 2^( 5) =       0.000463727513
  error estimate for blocks of size 2^( 6) =       0.000472149596
  error estimate for blocks of size 2^( 7) =       0.000477619754

      target function =                  N/A
              le_mean =     -16.908533331040
             les_mean =     286.239719262327
             stat err =       0.000466385890
             autocorr =       1.274929851765
              std dev =       0.584140416389
             le_variance =       0.341220026059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908551589745        initial
     2.5000e-01     2.5000e+00             1.0841e-02       -16.908580124279  <--
     1.0000e+00     1.0000e+01             3.8566e-03       -16.908550747290
     4.0000e+00     4.0000e+01             1.1021e-03       -16.908533331040

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.8041e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.020517e-01 1 1  ON 0
 uu_1                 1.386640e-01 1 1  ON 1
 uu_2                 4.235996e-02 1 1  ON 2
 uu_3                -1.806065e-02 1 1  ON 3
 uu_4                -6.267575e-02 1 1  ON 4
 uu_5                -9.589553e-02 1 1  ON 5
 uu_6                -1.204261e-01 1 1  ON 6
 uu_7                -1.298890e-01 1 1  ON 7
 uu_8                -1.213016e-01 1 1  ON 8
 uu_9                -9.305198e-02 1 1  ON 9
 ud_0                 4.152061e-01 1 1  ON 10
 ud_1                 1.628852e-01 1 1  ON 11
 ud_2                 5.908945e-02 1 1  ON 12
 ud_3                -1.555282e-03 1 1  ON 13
 ud_4                -5.709834e-02 1 1  ON 14
 ud_5                -1.009912e-01 1 1  ON 15
 ud_6                -1.296029e-01 1 1  ON 16
 ud_7                -1.446829e-01 1 1  ON 17
 ud_8                -1.432010e-01 1 1  ON 18
 ud_9                -1.343405e-01 1 1  ON 19
 eO_0                -7.151506e-01 1 1  ON 20
 eO_1                -4.160544e-01 1 1  ON 21
 eO_2                -2.445473e-02 1 1  ON 22
 eO_3                 2.756894e-01 1 1  ON 23
 eO_4                 4.938164e-01 1 1  ON 24
 eO_5                 4.589393e-01 1 1  ON 25
 eO_6                 2.345850e-01 1 1  ON 26
 eO_7                -5.575083e-02 1 1  ON 27
 eO_8                -1.963714e-01 1 1  ON 28
 eO_9                -5.812355e-02 1 1  ON 29
eH1_0                -2.161502e-01 1 1  ON 30
eH1_1                -1.270709e-01 1 1  ON 31
eH1_2                -8.759469e-02 1 1  ON 32
eH1_3                -3.779975e-02 1 1  ON 33
eH1_4                 1.441412e-02 1 1  ON 34
eH1_5                 4.644656e-02 1 1  ON 35
eH1_6                 9.507080e-02 1 1  ON 36
eH1_7                 1.371130e-01 1 1  ON 37
eH1_8                 1.464288e-01 1 1  ON 38
eH1_9                 3.361013e-02 1 1  ON 39
eH2_0                -2.146789e-01 1 1  ON 40
eH2_1                -1.266786e-01 1 1  ON 41
eH2_2                -8.698244e-02 1 1  ON 42
eH2_3                -3.651098e-02 1 1  ON 43
eH2_4                 1.562350e-02 1 1  ON 44
eH2_5                 4.974832e-02 1 1  ON 45
eH2_6                 1.019982e-01 1 1  ON 46
eH2_7                 1.496854e-01 1 1  ON 47
eH2_8                 1.530035e-01 1 1  ON 48
eH2_9                 1.329664e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.217735
====================================================
  Execution time = 2.8174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3242e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332461188477
                                         uncertainty =       0.003754228481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332461188477
                                         uncertainty =       0.003754228481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407686497
  error estimate for blocks of size 2^( 2) =       0.000420115772
  error estimate for blocks of size 2^( 3) =       0.000433158005
  error estimate for blocks of size 2^( 4) =       0.000446016979
  error estimate for blocks of size 2^( 5) =       0.000456723664
  error estimate for blocks of size 2^( 6) =       0.000463803819
  error estimate for blocks of size 2^( 7) =       0.000467548133

      target function =                  N/A
              le_mean =     -16.908614341102
             les_mean =     286.233655329302
             stat err =       0.000458523149
             autocorr =       1.264939859454
              std dev =       0.576555773021
             le_variance =       0.332416559404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690861434110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908614341102       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908686578185       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908743173436       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908772023607       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908826484240       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908830055310       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908837859033       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908855386517       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908855889173       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908860600126       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908859821033       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908860931335       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908859873173       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908860138408       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908861031700       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908861455216       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908861369885       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.570693e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908614341102       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908655741553       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908695131208       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908710874888       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908737902282       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908735311713       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908738704893       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908738199091       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908740400777       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908741793586       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908741538445       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908741558368       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908741334419       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.855209e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908614341102       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908629631873       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908647525110       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908652998547       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908661784646       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908660609503       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908660881967       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908660694979       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908660691804       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908660894576       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908661037301       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.280470e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5241e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.023791e-01 1 1  ON 0
 uu_1                 1.388488e-01 1 1  ON 1
 uu_2                 4.242001e-02 1 1  ON 2
 uu_3                -1.774184e-02 1 1  ON 3
 uu_4                -6.278118e-02 1 1  ON 4
 uu_5                -9.620094e-02 1 1  ON 5
 uu_6                -1.207996e-01 1 1  ON 6
 uu_7                -1.306118e-01 1 1  ON 7
 uu_8                -1.217068e-01 1 1  ON 8
 uu_9                -9.312255e-02 1 1  ON 9
 ud_0                 4.178641e-01 1 1  ON 10
 ud_1                 1.649330e-01 1 1  ON 11
 ud_2                 5.841777e-02 1 1  ON 12
 ud_3                -3.902656e-03 1 1  ON 13
 ud_4                -5.761869e-02 1 1  ON 14
 ud_5                -1.005310e-01 1 1  ON 15
 ud_6                -1.292294e-01 1 1  ON 16
 ud_7                -1.455026e-01 1 1  ON 17
 ud_8                -1.444861e-01 1 1  ON 18
 ud_9                -1.345421e-01 1 1  ON 19
 eO_0                -7.220058e-01 1 1  ON 20
 eO_1                -4.183849e-01 1 1  ON 21
 eO_2                -2.085525e-02 1 1  ON 22
 eO_3                 2.808900e-01 1 1  ON 23
 eO_4                 4.958877e-01 1 1  ON 24
 eO_5                 4.584129e-01 1 1  ON 25
 eO_6                 2.343416e-01 1 1  ON 26
 eO_7                -5.555193e-02 1 1  ON 27
 eO_8                -1.969892e-01 1 1  ON 28
 eO_9                -5.857403e-02 1 1  ON 29
eH1_0                -2.207395e-01 1 1  ON 30
eH1_1                -1.274776e-01 1 1  ON 31
eH1_2                -8.770588e-02 1 1  ON 32
eH1_3                -3.810606e-02 1 1  ON 33
eH1_4                 1.541891e-02 1 1  ON 34
eH1_5                 4.751111e-02 1 1  ON 35
eH1_6                 9.633811e-02 1 1  ON 36
eH1_7                 1.378221e-01 1 1  ON 37
eH1_8                 1.470988e-01 1 1  ON 38
eH1_9                 3.428359e-02 1 1  ON 39
eH2_0                -2.195393e-01 1 1  ON 40
eH2_1                -1.266330e-01 1 1  ON 41
eH2_2                -8.662015e-02 1 1  ON 42
eH2_3                -3.651995e-02 1 1  ON 43
eH2_4                 1.696746e-02 1 1  ON 44
eH2_5                 5.063009e-02 1 1  ON 45
eH2_6                 1.023988e-01 1 1  ON 46
eH2_7                 1.497071e-01 1 1  ON 47
eH2_8                 1.537829e-01 1 1  ON 48
eH2_9                 1.425919e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8349
    reference variance = 0.33483
====================================================
  Execution time = 2.7751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3827e-01
  Total weights = 2.0000e+06
  Execution time = 3.5341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337528033843
                                         uncertainty =       0.005805939506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337528033843
                                         uncertainty =       0.005805939506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829627
  error estimate for blocks of size 2^( 2) =       0.000423117190
  error estimate for blocks of size 2^( 3) =       0.000435649211
  error estimate for blocks of size 2^( 4) =       0.000447670946
  error estimate for blocks of size 2^( 5) =       0.000458108909
  error estimate for blocks of size 2^( 6) =       0.000465061513
  error estimate for blocks of size 2^( 7) =       0.000469980291

      target function =                  N/A
              le_mean =     -16.908256032245
             les_mean =     286.226683847547
             stat err =       0.000460205415
             autocorr =       1.254815683689
              std dev =       0.581000829916
             le_variance =       0.337561964363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339961545591
                                         uncertainty =       0.005808920111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339961545591
                                         uncertainty =       0.005808920111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412308724
  error estimate for blocks of size 2^( 2) =       0.000424351844
  error estimate for blocks of size 2^( 3) =       0.000436656415
  error estimate for blocks of size 2^( 4) =       0.000448488495
  error estimate for blocks of size 2^( 5) =       0.000458843083
  error estimate for blocks of size 2^( 6) =       0.000465574157
  error estimate for blocks of size 2^( 7) =       0.000470459037

      target function =                  N/A
              le_mean =     -16.908173766076
             les_mean =     286.226336901550
             stat err =       0.000460841193
             autocorr =       1.249273523692
              std dev =       0.583092589334
             le_variance =       0.339996967737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339413711238
                                         uncertainty =       0.005810959921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339413711238
                                         uncertainty =       0.005810959921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411976818
  error estimate for blocks of size 2^( 2) =       0.000424035316
  error estimate for blocks of size 2^( 3) =       0.000436364272
  error estimate for blocks of size 2^( 4) =       0.000448208417
  error estimate for blocks of size 2^( 5) =       0.000458586103
  error estimate for blocks of size 2^( 6) =       0.000465341456
  error estimate for blocks of size 2^( 7) =       0.000470235677

      target function =                  N/A
              le_mean =     -16.908181516541
             les_mean =     286.226051823740
             stat err =       0.000460592913
             autocorr =       1.249939362422
              std dev =       0.582623203419
             le_variance =       0.339449797162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337611619179
                                         uncertainty =       0.005806243556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337611619179
                                         uncertainty =       0.005806243556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410880776
  error estimate for blocks of size 2^( 2) =       0.000423115929
  error estimate for blocks of size 2^( 3) =       0.000435603254
  error estimate for blocks of size 2^( 4) =       0.000447585669
  error estimate for blocks of size 2^( 5) =       0.000458011066
  error estimate for blocks of size 2^( 6) =       0.000464932194
  error estimate for blocks of size 2^( 7) =       0.000469847718

      target function =                  N/A
              le_mean =     -16.908213760559
             les_mean =     286.225338428627
             stat err =       0.000460094162
             autocorr =       1.253896816443
              std dev =       0.581073166393
             le_variance =       0.337646024702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908256032245        initial  <--
     6.2500e-02     6.2500e-01             1.5707e-02       -16.908173766076
     2.5000e-01     2.5000e+00             6.8552e-03       -16.908181516541
     1.0000e+00     1.0000e+01             2.2805e-03       -16.908213760559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3061
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.020517e-01 1 1  ON 0
 uu_1                 1.386640e-01 1 1  ON 1
 uu_2                 4.235996e-02 1 1  ON 2
 uu_3                -1.806065e-02 1 1  ON 3
 uu_4                -6.267575e-02 1 1  ON 4
 uu_5                -9.589553e-02 1 1  ON 5
 uu_6                -1.204261e-01 1 1  ON 6
 uu_7                -1.298890e-01 1 1  ON 7
 uu_8                -1.213016e-01 1 1  ON 8
 uu_9                -9.305198e-02 1 1  ON 9
 ud_0                 4.152061e-01 1 1  ON 10
 ud_1                 1.628852e-01 1 1  ON 11
 ud_2                 5.908945e-02 1 1  ON 12
 ud_3                -1.555282e-03 1 1  ON 13
 ud_4                -5.709834e-02 1 1  ON 14
 ud_5                -1.009912e-01 1 1  ON 15
 ud_6                -1.296029e-01 1 1  ON 16
 ud_7                -1.446829e-01 1 1  ON 17
 ud_8                -1.432010e-01 1 1  ON 18
 ud_9                -1.343405e-01 1 1  ON 19
 eO_0                -7.151506e-01 1 1  ON 20
 eO_1                -4.160544e-01 1 1  ON 21
 eO_2                -2.445473e-02 1 1  ON 22
 eO_3                 2.756894e-01 1 1  ON 23
 eO_4                 4.938164e-01 1 1  ON 24
 eO_5                 4.589393e-01 1 1  ON 25
 eO_6                 2.345850e-01 1 1  ON 26
 eO_7                -5.575083e-02 1 1  ON 27
 eO_8                -1.963714e-01 1 1  ON 28
 eO_9                -5.812355e-02 1 1  ON 29
eH1_0                -2.161502e-01 1 1  ON 30
eH1_1                -1.270709e-01 1 1  ON 31
eH1_2                -8.759469e-02 1 1  ON 32
eH1_3                -3.779975e-02 1 1  ON 33
eH1_4                 1.441412e-02 1 1  ON 34
eH1_5                 4.644656e-02 1 1  ON 35
eH1_6                 9.507080e-02 1 1  ON 36
eH1_7                 1.371130e-01 1 1  ON 37
eH1_8                 1.464288e-01 1 1  ON 38
eH1_9                 3.361013e-02 1 1  ON 39
eH2_0                -2.146789e-01 1 1  ON 40
eH2_1                -1.266786e-01 1 1  ON 41
eH2_2                -8.698244e-02 1 1  ON 42
eH2_3                -3.651098e-02 1 1  ON 43
eH2_4                 1.562350e-02 1 1  ON 44
eH2_5                 4.974832e-02 1 1  ON 45
eH2_6                 1.019982e-01 1 1  ON 46
eH2_7                 1.496854e-01 1 1  ON 47
eH2_8                 1.530035e-01 1 1  ON 48
eH2_9                 1.329664e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8825
    reference variance = 0.250704
====================================================
  Execution time = 2.8091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5286e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352964353068
                                         uncertainty =       0.015604568646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352964353068
                                         uncertainty =       0.015604568646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420035401
  error estimate for blocks of size 2^( 2) =       0.000432041998
  error estimate for blocks of size 2^( 3) =       0.000445066571
  error estimate for blocks of size 2^( 4) =       0.000457551739
  error estimate for blocks of size 2^( 5) =       0.000468437604
  error estimate for blocks of size 2^( 6) =       0.000475908062
  error estimate for blocks of size 2^( 7) =       0.000482197608

      target function =                  N/A
              le_mean =     -16.908591834451
             les_mean =     286.253337124085
             stat err =       0.000471023753
             autocorr =       1.257516890427
              std dev =       0.594019760981
             le_variance =       0.352859476436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690859183445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908591834451       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908612367020       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908633908066       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908647568399       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908667533561       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908668082999       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908669979748       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908670158688       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908669391951       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908669650203       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908669779906       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.434065e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908591834451       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908598040366       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908605441988       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908610006685       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908615124828       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908615110637       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908615369653       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908615368560       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908615230003       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908615250536       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.003248e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908591834451       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908593471459       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908595510890       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908596804940       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908598022226       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908598016725       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908598067142       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908598057362       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908598030014       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.635719e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5219e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.020750e-01 1 1  ON 0
 uu_1                 1.386668e-01 1 1  ON 1
 uu_2                 4.234878e-02 1 1  ON 2
 uu_3                -1.794274e-02 1 1  ON 3
 uu_4                -6.268045e-02 1 1  ON 4
 uu_5                -9.590550e-02 1 1  ON 5
 uu_6                -1.204359e-01 1 1  ON 6
 uu_7                -1.300006e-01 1 1  ON 7
 uu_8                -1.213732e-01 1 1  ON 8
 uu_9                -9.308134e-02 1 1  ON 9
 ud_0                 4.154821e-01 1 1  ON 10
 ud_1                 1.632242e-01 1 1  ON 11
 ud_2                 5.890896e-02 1 1  ON 12
 ud_3                -1.951386e-03 1 1  ON 13
 ud_4                -5.705767e-02 1 1  ON 14
 ud_5                -1.009098e-01 1 1  ON 15
 ud_6                -1.295537e-01 1 1  ON 16
 ud_7                -1.447936e-01 1 1  ON 17
 ud_8                -1.432986e-01 1 1  ON 18
 ud_9                -1.343242e-01 1 1  ON 19
 eO_0                -7.161539e-01 1 1  ON 20
 eO_1                -4.162881e-01 1 1  ON 21
 eO_2                -2.382478e-02 1 1  ON 22
 eO_3                 2.763513e-01 1 1  ON 23
 eO_4                 4.939871e-01 1 1  ON 24
 eO_5                 4.588257e-01 1 1  ON 25
 eO_6                 2.345670e-01 1 1  ON 26
 eO_7                -5.573215e-02 1 1  ON 27
 eO_8                -1.964266e-01 1 1  ON 28
 eO_9                -5.817558e-02 1 1  ON 29
eH1_0                -2.167555e-01 1 1  ON 30
eH1_1                -1.270570e-01 1 1  ON 31
eH1_2                -8.754532e-02 1 1  ON 32
eH1_3                -3.780012e-02 1 1  ON 33
eH1_4                 1.464367e-02 1 1  ON 34
eH1_5                 4.650553e-02 1 1  ON 35
eH1_6                 9.515824e-02 1 1  ON 36
eH1_7                 1.371798e-01 1 1  ON 37
eH1_8                 1.464748e-01 1 1  ON 38
eH1_9                 3.366255e-02 1 1  ON 39
eH2_0                -2.153311e-01 1 1  ON 40
eH2_1                -1.266300e-01 1 1  ON 41
eH2_2                -8.689906e-02 1 1  ON 42
eH2_3                -3.653614e-02 1 1  ON 43
eH2_4                 1.584288e-02 1 1  ON 44
eH2_5                 4.980006e-02 1 1  ON 45
eH2_6                 1.020189e-01 1 1  ON 46
eH2_7                 1.497196e-01 1 1  ON 47
eH2_8                 1.531205e-01 1 1  ON 48
eH2_9                 1.339945e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9467
    reference variance = 0.197045
====================================================
  Execution time = 2.7764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4760e-01
  Total weights = 2.0000e+06
  Execution time = 3.5487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347663564091
                                         uncertainty =       0.011837622349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347663564091
                                         uncertainty =       0.011837622349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416903507
  error estimate for blocks of size 2^( 2) =       0.000428861548
  error estimate for blocks of size 2^( 3) =       0.000441372062
  error estimate for blocks of size 2^( 4) =       0.000452900810
  error estimate for blocks of size 2^( 5) =       0.000463782710
  error estimate for blocks of size 2^( 6) =       0.000469482850
  error estimate for blocks of size 2^( 7) =       0.000476481665

      target function =                  N/A
              le_mean =     -16.908796687228
             les_mean =     286.255022304837
             stat err =       0.000465662009
             autocorr =       1.247586071744
              std dev =       0.589590594094
             le_variance =       0.347617068644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347820884642
                                         uncertainty =       0.011825746619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347820884642
                                         uncertainty =       0.011825746619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416998043
  error estimate for blocks of size 2^( 2) =       0.000428886967
  error estimate for blocks of size 2^( 3) =       0.000441330103
  error estimate for blocks of size 2^( 4) =       0.000452822755
  error estimate for blocks of size 2^( 5) =       0.000463666902
  error estimate for blocks of size 2^( 6) =       0.000469330858
  error estimate for blocks of size 2^( 7) =       0.000476329463

      target function =                  N/A
              le_mean =     -16.908803160817
             les_mean =     286.255398893738
             stat err =       0.000465537495
             autocorr =       1.246353667424
              std dev =       0.589724288438
             le_variance =       0.347774736373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347650499634
                                         uncertainty =       0.011824694437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347650499634
                                         uncertainty =       0.011824694437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416895828
  error estimate for blocks of size 2^( 2) =       0.000428812322
  error estimate for blocks of size 2^( 3) =       0.000441282110
  error estimate for blocks of size 2^( 4) =       0.000452790583
  error estimate for blocks of size 2^( 5) =       0.000463648826
  error estimate for blocks of size 2^( 6) =       0.000469325363
  error estimate for blocks of size 2^( 7) =       0.000476323043

      target function =                  N/A
              le_mean =     -16.908797016185
             les_mean =     286.255020624006
             stat err =       0.000465521954
             autocorr =       1.246881654506
              std dev =       0.589579734448
             le_variance =       0.347604263272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347652212164
                                         uncertainty =       0.011835423213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347652212164
                                         uncertainty =       0.011835423213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416896722
  error estimate for blocks of size 2^( 2) =       0.000428849081
  error estimate for blocks of size 2^( 3) =       0.000441354072
  error estimate for blocks of size 2^( 4) =       0.000452880154
  error estimate for blocks of size 2^( 5) =       0.000463758842
  error estimate for blocks of size 2^( 6) =       0.000469455743
  error estimate for blocks of size 2^( 7) =       0.000476454365

      target function =                  N/A
              le_mean =     -16.908796054594
             les_mean =     286.254989596116
             stat err =       0.000465637276
             autocorr =       1.247494152340
              std dev =       0.589580998735
             le_variance =       0.347605754069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908796687228        initial
     6.2500e-01     6.2500e+00             3.4341e-03       -16.908803160817  <--
     2.5000e+00     2.5000e+01             1.0032e-03       -16.908797016185
     1.0000e+01     1.0000e+02             2.6357e-04       -16.908796054594

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.5351e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.022352e-01 1 1  ON 0
 uu_1                 1.387650e-01 1 1  ON 1
 uu_2                 4.236361e-02 1 1  ON 2
 uu_3                -1.776186e-02 1 1  ON 3
 uu_4                -6.269175e-02 1 1  ON 4
 uu_5                -9.594320e-02 1 1  ON 5
 uu_6                -1.204859e-01 1 1  ON 6
 uu_7                -1.303237e-01 1 1  ON 7
 uu_8                -1.216077e-01 1 1  ON 8
 uu_9                -9.318428e-02 1 1  ON 9
 ud_0                 4.162905e-01 1 1  ON 10
 ud_1                 1.639214e-01 1 1  ON 11
 ud_2                 5.858512e-02 1 1  ON 12
 ud_3                -2.809517e-03 1 1  ON 13
 ud_4                -5.712896e-02 1 1  ON 14
 ud_5                -1.007058e-01 1 1  ON 15
 ud_6                -1.294183e-01 1 1  ON 16
 ud_7                -1.450721e-01 1 1  ON 17
 ud_8                -1.435903e-01 1 1  ON 18
 ud_9                -1.342896e-01 1 1  ON 19
 eO_0                -7.185847e-01 1 1  ON 20
 eO_1                -4.170249e-01 1 1  ON 21
 eO_2                -2.242756e-02 1 1  ON 22
 eO_3                 2.781017e-01 1 1  ON 23
 eO_4                 4.946128e-01 1 1  ON 24
 eO_5                 4.585787e-01 1 1  ON 25
 eO_6                 2.345044e-01 1 1  ON 26
 eO_7                -5.568509e-02 1 1  ON 27
 eO_8                -1.965964e-01 1 1  ON 28
 eO_9                -5.833253e-02 1 1  ON 29
eH1_0                -2.183287e-01 1 1  ON 30
eH1_1                -1.270969e-01 1 1  ON 31
eH1_2                -8.744706e-02 1 1  ON 32
eH1_3                -3.777464e-02 1 1  ON 33
eH1_4                 1.516392e-02 1 1  ON 34
eH1_5                 4.671519e-02 1 1  ON 35
eH1_6                 9.543197e-02 1 1  ON 36
eH1_7                 1.373754e-01 1 1  ON 37
eH1_8                 1.466086e-01 1 1  ON 38
eH1_9                 3.381647e-02 1 1  ON 39
eH2_0                -2.170144e-01 1 1  ON 40
eH2_1                -1.265777e-01 1 1  ON 41
eH2_2                -8.672734e-02 1 1  ON 42
eH2_3                -3.657330e-02 1 1  ON 43
eH2_4                 1.631927e-02 1 1  ON 44
eH2_5                 4.998599e-02 1 1  ON 45
eH2_6                 1.021069e-01 1 1  ON 46
eH2_7                 1.498207e-01 1 1  ON 47
eH2_8                 1.534636e-01 1 1  ON 48
eH2_9                 1.370324e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9441
    reference variance = 0.194236
====================================================
  Execution time = 2.8140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356157062902
                                         uncertainty =       0.020148823462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356157062902
                                         uncertainty =       0.020148823462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422140852
  error estimate for blocks of size 2^( 2) =       0.000434109297
  error estimate for blocks of size 2^( 3) =       0.000446513521
  error estimate for blocks of size 2^( 4) =       0.000458426332
  error estimate for blocks of size 2^( 5) =       0.000467823022
  error estimate for blocks of size 2^( 6) =       0.000474570659
  error estimate for blocks of size 2^( 7) =       0.000479213211

      target function =                  N/A
              le_mean =     -16.909046687397
             les_mean =     286.272265496381
             stat err =       0.000470008306
             autocorr =       1.239642052890
              std dev =       0.596997318250
             le_variance =       0.356405797997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690904668740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909046687397       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909066172662       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909103083724       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909134202489       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909164362584       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909172433135       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909170314486       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909172117775       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909175110283       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909175438611       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909175167368       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909174679837       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909175125649       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909175109438       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 8.094873e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909046687397       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909054949672       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909072606037       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909084085778       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909094903376       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909095698619       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909095787323       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909094692333       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909095712012       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909095860401       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909095699037       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.844757e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909046687397       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909049188164       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909054903364       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909058560291       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909061121373       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909061119455       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909061149535       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909060921281       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909061115033       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909061111075       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.150979e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5277e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.026266e-01 1 1  ON 0
 uu_1                 1.388990e-01 1 1  ON 1
 uu_2                 4.239324e-02 1 1  ON 2
 uu_3                -1.764276e-02 1 1  ON 3
 uu_4                -6.272533e-02 1 1  ON 4
 uu_5                -9.605435e-02 1 1  ON 5
 uu_6                -1.206869e-01 1 1  ON 6
 uu_7                -1.308477e-01 1 1  ON 7
 uu_8                -1.218304e-01 1 1  ON 8
 uu_9                -9.312373e-02 1 1  ON 9
 ud_0                 4.175650e-01 1 1  ON 10
 ud_1                 1.647114e-01 1 1  ON 11
 ud_2                 5.829204e-02 1 1  ON 12
 ud_3                -3.761053e-03 1 1  ON 13
 ud_4                -5.750870e-02 1 1  ON 14
 ud_5                -1.005842e-01 1 1  ON 15
 ud_6                -1.291779e-01 1 1  ON 16
 ud_7                -1.454459e-01 1 1  ON 17
 ud_8                -1.440060e-01 1 1  ON 18
 ud_9                -1.342536e-01 1 1  ON 19
 eO_0                -7.214294e-01 1 1  ON 20
 eO_1                -4.179606e-01 1 1  ON 21
 eO_2                -2.085708e-02 1 1  ON 22
 eO_3                 2.802395e-01 1 1  ON 23
 eO_4                 4.954311e-01 1 1  ON 24
 eO_5                 4.583951e-01 1 1  ON 25
 eO_6                 2.344285e-01 1 1  ON 26
 eO_7                -5.561682e-02 1 1  ON 27
 eO_8                -1.969530e-01 1 1  ON 28
 eO_9                -5.850789e-02 1 1  ON 29
eH1_0                -2.203316e-01 1 1  ON 30
eH1_1                -1.274919e-01 1 1  ON 31
eH1_2                -8.741454e-02 1 1  ON 32
eH1_3                -3.779090e-02 1 1  ON 33
eH1_4                 1.582941e-02 1 1  ON 34
eH1_5                 4.723073e-02 1 1  ON 35
eH1_6                 9.573571e-02 1 1  ON 36
eH1_7                 1.377605e-01 1 1  ON 37
eH1_8                 1.468906e-01 1 1  ON 38
eH1_9                 3.401628e-02 1 1  ON 39
eH2_0                -2.190002e-01 1 1  ON 40
eH2_1                -1.266628e-01 1 1  ON 41
eH2_2                -8.646260e-02 1 1  ON 42
eH2_3                -3.666415e-02 1 1  ON 43
eH2_4                 1.701815e-02 1 1  ON 44
eH2_5                 5.026671e-02 1 1  ON 45
eH2_6                 1.024036e-01 1 1  ON 46
eH2_7                 1.497692e-01 1 1  ON 47
eH2_8                 1.537590e-01 1 1  ON 48
eH2_9                 1.409246e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.99
    reference variance = 1.0577
====================================================
  Execution time = 2.7436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4025e-01
  Total weights = 2.0000e+06
  Execution time = 3.5251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339510658653
                                         uncertainty =       0.006654086869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339510658653
                                         uncertainty =       0.006654086869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412122743
  error estimate for blocks of size 2^( 2) =       0.000424552276
  error estimate for blocks of size 2^( 3) =       0.000437852361
  error estimate for blocks of size 2^( 4) =       0.000450602266
  error estimate for blocks of size 2^( 5) =       0.000463068818
  error estimate for blocks of size 2^( 6) =       0.000470107022
  error estimate for blocks of size 2^( 7) =       0.000478486573

      target function =                  N/A
              le_mean =     -16.909130854717
             les_mean =     286.258396402004
             stat err =       0.000465566170
             autocorr =       1.276173338637
              std dev =       0.582829571936
             le_variance =       0.339690309923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341219353259
                                         uncertainty =       0.006700417354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341219353259
                                         uncertainty =       0.006700417354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413159543
  error estimate for blocks of size 2^( 2) =       0.000425442260
  error estimate for blocks of size 2^( 3) =       0.000438601882
  error estimate for blocks of size 2^( 4) =       0.000451236558
  error estimate for blocks of size 2^( 5) =       0.000463604010
  error estimate for blocks of size 2^( 6) =       0.000470611826
  error estimate for blocks of size 2^( 7) =       0.000479035238

      target function =                  N/A
              le_mean =     -16.909105824078
             les_mean =     286.259261214317
             stat err =       0.000466121908
             autocorr =       1.272809637239
              std dev =       0.584295828452
             le_variance =       0.341401615146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340707269277
                                         uncertainty =       0.006686292666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340707269277
                                         uncertainty =       0.006686292666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412849155
  error estimate for blocks of size 2^( 2) =       0.000425161894
  error estimate for blocks of size 2^( 3) =       0.000438358108
  error estimate for blocks of size 2^( 4) =       0.000451022711
  error estimate for blocks of size 2^( 5) =       0.000463418199
  error estimate for blocks of size 2^( 6) =       0.000470435069
  error estimate for blocks of size 2^( 7) =       0.000478854210

      target function =                  N/A
              le_mean =     -16.909103130926
             les_mean =     286.258657371554
             stat err =       0.000465932547
             autocorr =       1.273688704319
              std dev =       0.583856874320
             le_variance =       0.340888849690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339657200152
                                         uncertainty =       0.006658325466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339657200152
                                         uncertainty =       0.006658325466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412211791
  error estimate for blocks of size 2^( 2) =       0.000424622182
  error estimate for blocks of size 2^( 3) =       0.000437905849
  error estimate for blocks of size 2^( 4) =       0.000450642468
  error estimate for blocks of size 2^( 5) =       0.000463098563
  error estimate for blocks of size 2^( 6) =       0.000470133350
  error estimate for blocks of size 2^( 7) =       0.000478519499

      target function =                  N/A
              le_mean =     -16.909122673579
             les_mean =     286.258266541436
             stat err =       0.000465598470
             autocorr =       1.275799033331
              std dev =       0.582955505348
             le_variance =       0.339837121216


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909130854717        initial  <--
     1.5625e-01     1.5625e+00             8.0949e-03       -16.909105824078
     6.2500e-01     6.2500e+00             2.8448e-03       -16.909103130926
     2.5000e+00     2.5000e+01             8.1510e-04       -16.909122673579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0027
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.022352e-01 1 1  ON 0
 uu_1                 1.387650e-01 1 1  ON 1
 uu_2                 4.236361e-02 1 1  ON 2
 uu_3                -1.776186e-02 1 1  ON 3
 uu_4                -6.269175e-02 1 1  ON 4
 uu_5                -9.594320e-02 1 1  ON 5
 uu_6                -1.204859e-01 1 1  ON 6
 uu_7                -1.303237e-01 1 1  ON 7
 uu_8                -1.216077e-01 1 1  ON 8
 uu_9                -9.318428e-02 1 1  ON 9
 ud_0                 4.162905e-01 1 1  ON 10
 ud_1                 1.639214e-01 1 1  ON 11
 ud_2                 5.858512e-02 1 1  ON 12
 ud_3                -2.809517e-03 1 1  ON 13
 ud_4                -5.712896e-02 1 1  ON 14
 ud_5                -1.007058e-01 1 1  ON 15
 ud_6                -1.294183e-01 1 1  ON 16
 ud_7                -1.450721e-01 1 1  ON 17
 ud_8                -1.435903e-01 1 1  ON 18
 ud_9                -1.342896e-01 1 1  ON 19
 eO_0                -7.185847e-01 1 1  ON 20
 eO_1                -4.170249e-01 1 1  ON 21
 eO_2                -2.242756e-02 1 1  ON 22
 eO_3                 2.781017e-01 1 1  ON 23
 eO_4                 4.946128e-01 1 1  ON 24
 eO_5                 4.585787e-01 1 1  ON 25
 eO_6                 2.345044e-01 1 1  ON 26
 eO_7                -5.568509e-02 1 1  ON 27
 eO_8                -1.965964e-01 1 1  ON 28
 eO_9                -5.833253e-02 1 1  ON 29
eH1_0                -2.183287e-01 1 1  ON 30
eH1_1                -1.270969e-01 1 1  ON 31
eH1_2                -8.744706e-02 1 1  ON 32
eH1_3                -3.777464e-02 1 1  ON 33
eH1_4                 1.516392e-02 1 1  ON 34
eH1_5                 4.671519e-02 1 1  ON 35
eH1_6                 9.543197e-02 1 1  ON 36
eH1_7                 1.373754e-01 1 1  ON 37
eH1_8                 1.466086e-01 1 1  ON 38
eH1_9                 3.381647e-02 1 1  ON 39
eH2_0                -2.170144e-01 1 1  ON 40
eH2_1                -1.265777e-01 1 1  ON 41
eH2_2                -8.672734e-02 1 1  ON 42
eH2_3                -3.657330e-02 1 1  ON 43
eH2_4                 1.631927e-02 1 1  ON 44
eH2_5                 4.998599e-02 1 1  ON 45
eH2_6                 1.021069e-01 1 1  ON 46
eH2_7                 1.498207e-01 1 1  ON 47
eH2_8                 1.534636e-01 1 1  ON 48
eH2_9                 1.370324e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9363
    reference variance = 0.177027
====================================================
  Execution time = 2.8088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2739e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327454868334
                                         uncertainty =       0.002474793017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327454868334
                                         uncertainty =       0.002474793017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404594165
  error estimate for blocks of size 2^( 2) =       0.000416944963
  error estimate for blocks of size 2^( 3) =       0.000430500023
  error estimate for blocks of size 2^( 4) =       0.000443591207
  error estimate for blocks of size 2^( 5) =       0.000455006057
  error estimate for blocks of size 2^( 6) =       0.000462949776
  error estimate for blocks of size 2^( 7) =       0.000469715566

      target function =                  N/A
              le_mean =     -16.909254545810
             les_mean =     286.250282008816
             stat err =       0.000457815652
             autocorr =       1.280389313702
              std dev =       0.572182556097
             le_variance =       0.327392877502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690925454581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909254545810       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909260631233       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909266497552       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909271051028       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909274063254       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909274576243       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909275196925       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909275109245       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909275219858       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909275152418       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.203944e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909254545810       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909256198335       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909257906247       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909259204984       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909259925764       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909260020237       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909260140503       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909260139054       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909260145546       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.213015e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909254545810       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909254968042       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909255413086       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909255751789       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909255926849       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909255948641       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909255975659       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909255977677       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909255977299       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.170517e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205131 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5294e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.022462e-01 1 1  ON 0
 uu_1                 1.387732e-01 1 1  ON 1
 uu_2                 4.236593e-02 1 1  ON 2
 uu_3                -1.773136e-02 1 1  ON 3
 uu_4                -6.269146e-02 1 1  ON 4
 uu_5                -9.594052e-02 1 1  ON 5
 uu_6                -1.205362e-01 1 1  ON 6
 uu_7                -1.303631e-01 1 1  ON 7
 uu_8                -1.216191e-01 1 1  ON 8
 uu_9                -9.319110e-02 1 1  ON 9
 ud_0                 4.164170e-01 1 1  ON 10
 ud_1                 1.640156e-01 1 1  ON 11
 ud_2                 5.852656e-02 1 1  ON 12
 ud_3                -2.938439e-03 1 1  ON 13
 ud_4                -5.715269e-02 1 1  ON 14
 ud_5                -1.006612e-01 1 1  ON 15
 ud_6                -1.294126e-01 1 1  ON 16
 ud_7                -1.450960e-01 1 1  ON 17
 ud_8                -1.436252e-01 1 1  ON 18
 ud_9                -1.342977e-01 1 1  ON 19
 eO_0                -7.189060e-01 1 1  ON 20
 eO_1                -4.171211e-01 1 1  ON 21
 eO_2                -2.221672e-02 1 1  ON 22
 eO_3                 2.783307e-01 1 1  ON 23
 eO_4                 4.946710e-01 1 1  ON 24
 eO_5                 4.585537e-01 1 1  ON 25
 eO_6                 2.344881e-01 1 1  ON 26
 eO_7                -5.568117e-02 1 1  ON 27
 eO_8                -1.966200e-01 1 1  ON 28
 eO_9                -5.835178e-02 1 1  ON 29
eH1_0                -2.185515e-01 1 1  ON 30
eH1_1                -1.270982e-01 1 1  ON 31
eH1_2                -8.742629e-02 1 1  ON 32
eH1_3                -3.776526e-02 1 1  ON 33
eH1_4                 1.523124e-02 1 1  ON 34
eH1_5                 4.674557e-02 1 1  ON 35
eH1_6                 9.546075e-02 1 1  ON 36
eH1_7                 1.373832e-01 1 1  ON 37
eH1_8                 1.466352e-01 1 1  ON 38
eH1_9                 3.384795e-02 1 1  ON 39
eH2_0                -2.172435e-01 1 1  ON 40
eH2_1                -1.265730e-01 1 1  ON 41
eH2_2                -8.669970e-02 1 1  ON 42
eH2_3                -3.659317e-02 1 1  ON 43
eH2_4                 1.639318e-02 1 1  ON 44
eH2_5                 5.002600e-02 1 1  ON 45
eH2_6                 1.021278e-01 1 1  ON 46
eH2_7                 1.498226e-01 1 1  ON 47
eH2_8                 1.534948e-01 1 1  ON 48
eH2_9                 1.374316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9084
    reference variance = 0.305294
====================================================
  Execution time = 2.9649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3547e-01
  Total weights = 2.0000e+06
  Execution time = 3.5304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335518219258
                                         uncertainty =       0.004438074845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335518219258
                                         uncertainty =       0.004438074845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409527622
  error estimate for blocks of size 2^( 2) =       0.000421692783
  error estimate for blocks of size 2^( 3) =       0.000434583189
  error estimate for blocks of size 2^( 4) =       0.000448046229
  error estimate for blocks of size 2^( 5) =       0.000458656601
  error estimate for blocks of size 2^( 6) =       0.000468321362
  error estimate for blocks of size 2^( 7) =       0.000472609668

      target function =                  N/A
              le_mean =     -16.909041198314
             les_mean =     286.251099825138
             stat err =       0.000461908465
             autocorr =       1.272170859802
              std dev =       0.579159517370
             le_variance =       0.335425746560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335698204588
                                         uncertainty =       0.004444028188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335698204588
                                         uncertainty =       0.004444028188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409637455
  error estimate for blocks of size 2^( 2) =       0.000421776417
  error estimate for blocks of size 2^( 3) =       0.000434641922
  error estimate for blocks of size 2^( 4) =       0.000448091748
  error estimate for blocks of size 2^( 5) =       0.000458694046
  error estimate for blocks of size 2^( 6) =       0.000468340371
  error estimate for blocks of size 2^( 7) =       0.000472605598

      target function =                  N/A
              le_mean =     -16.909042875258
             les_mean =     286.251336478141
             stat err =       0.000461932941
             autocorr =       1.271623508662
              std dev =       0.579314844130
             le_variance =       0.335605688629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335606459862
                                         uncertainty =       0.004441105396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335606459862
                                         uncertainty =       0.004441105396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409581475
  error estimate for blocks of size 2^( 2) =       0.000421732293
  error estimate for blocks of size 2^( 3) =       0.000434609187
  error estimate for blocks of size 2^( 4) =       0.000448065340
  error estimate for blocks of size 2^( 5) =       0.000458671537
  error estimate for blocks of size 2^( 6) =       0.000468326544
  error estimate for blocks of size 2^( 7) =       0.000472602140

      target function =                  N/A
              le_mean =     -16.909041654644
             les_mean =     286.251203479600
             stat err =       0.000461916390
             autocorr =       1.271879990065
              std dev =       0.579235676449
             le_variance =       0.335513968872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335528793945
                                         uncertainty =       0.004438451683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335528793945
                                         uncertainty =       0.004438451683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409534076
  error estimate for blocks of size 2^( 2) =       0.000421697383
  error estimate for blocks of size 2^( 3) =       0.000434586046
  error estimate for blocks of size 2^( 4) =       0.000448048207
  error estimate for blocks of size 2^( 5) =       0.000458658051
  error estimate for blocks of size 2^( 6) =       0.000468321578
  error estimate for blocks of size 2^( 7) =       0.000472608249

      target function =                  N/A
              le_mean =     -16.909041195178
             les_mean =     286.251110291734
             stat err =       0.000461909021
             autocorr =       1.272133825400
              std dev =       0.579168644900
             le_variance =       0.335436319235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909041198314        initial
     1.5625e+00     1.5625e+01             1.2039e-03       -16.909042875258  <--
     6.2500e+00     6.2500e+01             3.2130e-04       -16.909041654644
     2.5000e+01     2.5000e+02             8.1705e-05       -16.909041195178

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.7246e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.022958e-01 1 1  ON 0
 uu_1                 1.388087e-01 1 1  ON 1
 uu_2                 4.237538e-02 1 1  ON 2
 uu_3                -1.766536e-02 1 1  ON 3
 uu_4                -6.268731e-02 1 1  ON 4
 uu_5                -9.594028e-02 1 1  ON 5
 uu_6                -1.206775e-01 1 1  ON 6
 uu_7                -1.304831e-01 1 1  ON 7
 uu_8                -1.216595e-01 1 1  ON 8
 uu_9                -9.321397e-02 1 1  ON 9
 ud_0                 4.167769e-01 1 1  ON 10
 ud_1                 1.642593e-01 1 1  ON 11
 ud_2                 5.839014e-02 1 1  ON 12
 ud_3                -3.277659e-03 1 1  ON 13
 ud_4                -5.724214e-02 1 1  ON 14
 ud_5                -1.005463e-01 1 1  ON 15
 ud_6                -1.293883e-01 1 1  ON 16
 ud_7                -1.451625e-01 1 1  ON 17
 ud_8                -1.437310e-01 1 1  ON 18
 ud_9                -1.343237e-01 1 1  ON 19
 eO_0                -7.197886e-01 1 1  ON 20
 eO_1                -4.174114e-01 1 1  ON 21
 eO_2                -2.166425e-02 1 1  ON 22
 eO_3                 2.789844e-01 1 1  ON 23
 eO_4                 4.948658e-01 1 1  ON 24
 eO_5                 4.584952e-01 1 1  ON 25
 eO_6                 2.344402e-01 1 1  ON 26
 eO_7                -5.567119e-02 1 1  ON 27
 eO_8                -1.966925e-01 1 1  ON 28
 eO_9                -5.841026e-02 1 1  ON 29
eH1_0                -2.191815e-01 1 1  ON 30
eH1_1                -1.271098e-01 1 1  ON 31
eH1_2                -8.737664e-02 1 1  ON 32
eH1_3                -3.774014e-02 1 1  ON 33
eH1_4                 1.541056e-02 1 1  ON 34
eH1_5                 4.684070e-02 1 1  ON 35
eH1_6                 9.554959e-02 1 1  ON 36
eH1_7                 1.374073e-01 1 1  ON 37
eH1_8                 1.467154e-01 1 1  ON 38
eH1_9                 3.394289e-02 1 1  ON 39
eH2_0                -2.178931e-01 1 1  ON 40
eH2_1                -1.265759e-01 1 1  ON 41
eH2_2                -8.663393e-02 1 1  ON 42
eH2_3                -3.663600e-02 1 1  ON 43
eH2_4                 1.658743e-02 1 1  ON 44
eH2_5                 5.014853e-02 1 1  ON 45
eH2_6                 1.021936e-01 1 1  ON 46
eH2_7                 1.498288e-01 1 1  ON 47
eH2_8                 1.535884e-01 1 1  ON 48
eH2_9                 1.386358e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8923
    reference variance = 0.348354
====================================================
  Execution time = 2.8145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2943e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329526341791
                                         uncertainty =       0.004441245272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329526341791
                                         uncertainty =       0.004441245272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405848051
  error estimate for blocks of size 2^( 2) =       0.000418093674
  error estimate for blocks of size 2^( 3) =       0.000431549904
  error estimate for blocks of size 2^( 4) =       0.000444447888
  error estimate for blocks of size 2^( 5) =       0.000456103590
  error estimate for blocks of size 2^( 6) =       0.000464341641
  error estimate for blocks of size 2^( 7) =       0.000471575585

      target function =                  N/A
              le_mean =     -16.909908524566
             les_mean =     286.274431425678
             stat err =       0.000459117176
             autocorr =       1.279735303480
              std dev =       0.573955818159
             le_variance =       0.329425281199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690990852457e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909908524566       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909920409078       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909932785522       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909945002324       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909955433984       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909959422867       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909959600846       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909958939265       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909960364979       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909960475312       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909960553068       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.973864e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909908524566       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909912427584       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909917185281       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909920546586       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909924080811       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909924852767       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909924842789       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909924549833       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909924834210       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909924818331       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.201482e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909908524566       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909909583341       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909910956042       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909911826442       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909912774828       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909912962006       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909912936064       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909912875729       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909912921380       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.198699e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5371e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.023247e-01 1 1  ON 0
 uu_1                 1.388312e-01 1 1  ON 1
 uu_2                 4.243479e-02 1 1  ON 2
 uu_3                -1.761539e-02 1 1  ON 3
 uu_4                -6.269052e-02 1 1  ON 4
 uu_5                -9.597709e-02 1 1  ON 5
 uu_6                -1.207374e-01 1 1  ON 6
 uu_7                -1.306385e-01 1 1  ON 7
 uu_8                -1.217093e-01 1 1  ON 8
 uu_9                -9.322669e-02 1 1  ON 9
 ud_0                 4.172200e-01 1 1  ON 10
 ud_1                 1.645681e-01 1 1  ON 11
 ud_2                 5.821268e-02 1 1  ON 12
 ud_3                -3.697421e-03 1 1  ON 13
 ud_4                -5.738309e-02 1 1  ON 14
 ud_5                -1.004940e-01 1 1  ON 15
 ud_6                -1.292981e-01 1 1  ON 16
 ud_7                -1.452504e-01 1 1  ON 17
 ud_8                -1.438532e-01 1 1  ON 18
 ud_9                -1.343153e-01 1 1  ON 19
 eO_0                -7.209901e-01 1 1  ON 20
 eO_1                -4.178062e-01 1 1  ON 21
 eO_2                -2.105040e-02 1 1  ON 22
 eO_3                 2.798610e-01 1 1  ON 23
 eO_4                 4.952172e-01 1 1  ON 24
 eO_5                 4.584307e-01 1 1  ON 25
 eO_6                 2.343785e-01 1 1  ON 26
 eO_7                -5.561109e-02 1 1  ON 27
 eO_8                -1.967813e-01 1 1  ON 28
 eO_9                -5.849096e-02 1 1  ON 29
eH1_0                -2.200021e-01 1 1  ON 30
eH1_1                -1.272162e-01 1 1  ON 31
eH1_2                -8.735147e-02 1 1  ON 32
eH1_3                -3.772553e-02 1 1  ON 33
eH1_4                 1.561800e-02 1 1  ON 34
eH1_5                 4.699779e-02 1 1  ON 35
eH1_6                 9.567799e-02 1 1  ON 36
eH1_7                 1.375100e-01 1 1  ON 37
eH1_8                 1.468902e-01 1 1  ON 38
eH1_9                 3.405863e-02 1 1  ON 39
eH2_0                -2.187186e-01 1 1  ON 40
eH2_1                -1.266543e-01 1 1  ON 41
eH2_2                -8.651508e-02 1 1  ON 42
eH2_3                -3.667253e-02 1 1  ON 43
eH2_4                 1.683783e-02 1 1  ON 44
eH2_5                 5.028727e-02 1 1  ON 45
eH2_6                 1.023291e-01 1 1  ON 46
eH2_7                 1.498278e-01 1 1  ON 47
eH2_8                 1.537041e-01 1 1  ON 48
eH2_9                 1.402435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9195
    reference variance = 0.13495
====================================================
  Execution time = 2.7611e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4550e-01
  Total weights = 2.0000e+06
  Execution time = 3.5457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345193140583
                                         uncertainty =       0.006617875529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345193140583
                                         uncertainty =       0.006617875529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415534610
  error estimate for blocks of size 2^( 2) =       0.000427590882
  error estimate for blocks of size 2^( 3) =       0.000440356747
  error estimate for blocks of size 2^( 4) =       0.000453240976
  error estimate for blocks of size 2^( 5) =       0.000464109789
  error estimate for blocks of size 2^( 6) =       0.000472745573
  error estimate for blocks of size 2^( 7) =       0.000478863851

      target function =                  N/A
              le_mean =     -16.909529131031
             les_mean =     286.277513284334
             stat err =       0.000467240047
             autocorr =       1.264345346384
              std dev =       0.587654680744
             le_variance =       0.345338023800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345846327758
                                         uncertainty =       0.006638345459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345846327758
                                         uncertainty =       0.006638345459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415926942
  error estimate for blocks of size 2^( 2) =       0.000427914892
  error estimate for blocks of size 2^( 3) =       0.000440628529
  error estimate for blocks of size 2^( 4) =       0.000453467539
  error estimate for blocks of size 2^( 5) =       0.000464294929
  error estimate for blocks of size 2^( 6) =       0.000472919390
  error estimate for blocks of size 2^( 7) =       0.000479068587

      target function =                  N/A
              le_mean =     -16.909529839695
             les_mean =     286.278189668588
             stat err =       0.000467437611
             autocorr =       1.263028649851
              std dev =       0.588209522232
             le_variance =       0.345990442044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345529753440
                                         uncertainty =       0.006629745504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345529753440
                                         uncertainty =       0.006629745504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415736776
  error estimate for blocks of size 2^( 2) =       0.000427748562
  error estimate for blocks of size 2^( 3) =       0.000440481648
  error estimate for blocks of size 2^( 4) =       0.000453336665
  error estimate for blocks of size 2^( 5) =       0.000464178927
  error estimate for blocks of size 2^( 6) =       0.000472808214
  error estimate for blocks of size 2^( 7) =       0.000478949727

      target function =                  N/A
              le_mean =     -16.909526553413
             les_mean =     286.277762222141
             stat err =       0.000467318383
             autocorr =       1.263539557645
              std dev =       0.587940587486
             le_variance =       0.345674134413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345231388191
                                         uncertainty =       0.006619433378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345231388191
                                         uncertainty =       0.006619433378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415557578
  error estimate for blocks of size 2^( 2) =       0.000427607520
  error estimate for blocks of size 2^( 3) =       0.000440368745
  error estimate for blocks of size 2^( 4) =       0.000453248852
  error estimate for blocks of size 2^( 5) =       0.000464114041
  error estimate for blocks of size 2^( 6) =       0.000472748978
  error estimate for blocks of size 2^( 7) =       0.000478870629

      target function =                  N/A
              le_mean =     -16.909528102993
             les_mean =     286.277516694953
             stat err =       0.000467245625
             autocorr =       1.264235769607
              std dev =       0.587687163140
             le_variance =       0.345376201719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909529131031        initial
     3.9062e-01     3.9062e+00             3.9739e-03       -16.909529839695  <--
     1.5625e+00     1.5625e+01             1.2015e-03       -16.909526553413
     6.2500e+00     6.2500e+01             3.1987e-04       -16.909528102993

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.5229e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.025881e-01 1 1  ON 0
 uu_1                 1.390444e-01 1 1  ON 1
 uu_2                 4.256252e-02 1 1  ON 2
 uu_3                -1.758522e-02 1 1  ON 3
 uu_4                -6.278616e-02 1 1  ON 4
 uu_5                -9.612625e-02 1 1  ON 5
 uu_6                -1.209140e-01 1 1  ON 6
 uu_7                -1.310659e-01 1 1  ON 7
 uu_8                -1.218982e-01 1 1  ON 8
 uu_9                -9.328615e-02 1 1  ON 9
 ud_0                 4.182693e-01 1 1  ON 10
 ud_1                 1.652027e-01 1 1  ON 11
 ud_2                 5.795846e-02 1 1  ON 12
 ud_3                -4.535648e-03 1 1  ON 13
 ud_4                -5.784327e-02 1 1  ON 14
 ud_5                -1.004484e-01 1 1  ON 15
 ud_6                -1.290851e-01 1 1  ON 16
 ud_7                -1.454303e-01 1 1  ON 17
 ud_8                -1.442008e-01 1 1  ON 18
 ud_9                -1.343075e-01 1 1  ON 19
 eO_0                -7.237625e-01 1 1  ON 20
 eO_1                -4.189664e-01 1 1  ON 21
 eO_2                -1.984741e-02 1 1  ON 22
 eO_3                 2.820014e-01 1 1  ON 23
 eO_4                 4.963668e-01 1 1  ON 24
 eO_5                 4.584090e-01 1 1  ON 25
 eO_6                 2.342178e-01 1 1  ON 26
 eO_7                -5.544715e-02 1 1  ON 27
 eO_8                -1.970513e-01 1 1  ON 28
 eO_9                -5.873283e-02 1 1  ON 29
eH1_0                -2.220388e-01 1 1  ON 30
eH1_1                -1.275856e-01 1 1  ON 31
eH1_2                -8.739395e-02 1 1  ON 32
eH1_3                -3.770346e-02 1 1  ON 33
eH1_4                 1.600822e-02 1 1  ON 34
eH1_5                 4.744931e-02 1 1  ON 35
eH1_6                 9.609144e-02 1 1  ON 36
eH1_7                 1.378254e-01 1 1  ON 37
eH1_8                 1.474030e-01 1 1  ON 38
eH1_9                 3.439969e-02 1 1  ON 39
eH2_0                -2.207454e-01 1 1  ON 40
eH2_1                -1.269242e-01 1 1  ON 41
eH2_2                -8.637192e-02 1 1  ON 42
eH2_3                -3.672945e-02 1 1  ON 43
eH2_4                 1.730958e-02 1 1  ON 44
eH2_5                 5.070219e-02 1 1  ON 45
eH2_6                 1.027625e-01 1 1  ON 46
eH2_7                 1.498431e-01 1 1  ON 47
eH2_8                 1.540411e-01 1 1  ON 48
eH2_9                 1.449881e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.495529
====================================================
  Execution time = 2.8438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3394e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333951943831
                                         uncertainty =       0.005362795674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333951943831
                                         uncertainty =       0.005362795674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408621182
  error estimate for blocks of size 2^( 2) =       0.000420739812
  error estimate for blocks of size 2^( 3) =       0.000433329824
  error estimate for blocks of size 2^( 4) =       0.000445123012
  error estimate for blocks of size 2^( 5) =       0.000455181599
  error estimate for blocks of size 2^( 6) =       0.000461697576
  error estimate for blocks of size 2^( 7) =       0.000466691160

      target function =                  N/A
              le_mean =     -16.908913161361
             les_mean =     286.245286672587
             stat err =       0.000457173337
             autocorr =       1.251757018561
              std dev =       0.577877617749
             le_variance =       0.333942541096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690891316136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908913161361       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908921156251       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908944695073       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908978073048       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908994227986       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909006302322       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909012760470       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909016742524       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909015870645       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909015696131       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909014591276       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909014715154       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909015030039       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909015499527       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 7.968999e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908913161361       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908917146995       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908928646243       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908945636447       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908949542226       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908950091282       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908952915599       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908953329718       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908952943461       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908952823314       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908952731779       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.895565e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908913161361       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908914487293       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908918236019       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908924069197       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908924330679       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908924751062       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908924993934       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908925111420       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908925017750       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908924992260       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 8.471235e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5542e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.033372e-01 1 1  ON 0
 uu_1                 1.394659e-01 1 1  ON 1
 uu_2                 4.278772e-02 1 1  ON 2
 uu_3                -1.747061e-02 1 1  ON 3
 uu_4                -6.308282e-02 1 1  ON 4
 uu_5                -9.644461e-02 1 1  ON 5
 uu_6                -1.213082e-01 1 1  ON 6
 uu_7                -1.315959e-01 1 1  ON 7
 uu_8                -1.224447e-01 1 1  ON 8
 uu_9                -9.343068e-02 1 1  ON 9
 ud_0                 4.196173e-01 1 1  ON 10
 ud_1                 1.659406e-01 1 1  ON 11
 ud_2                 5.801304e-02 1 1  ON 12
 ud_3                -5.304156e-03 1 1  ON 13
 ud_4                -5.847290e-02 1 1  ON 14
 ud_5                -1.001496e-01 1 1  ON 15
 ud_6                -1.286915e-01 1 1  ON 16
 ud_7                -1.456828e-01 1 1  ON 17
 ud_8                -1.450330e-01 1 1  ON 18
 ud_9                -1.345471e-01 1 1  ON 19
 eO_0                -7.266580e-01 1 1  ON 20
 eO_1                -4.203472e-01 1 1  ON 21
 eO_2                -1.873160e-02 1 1  ON 22
 eO_3                 2.846203e-01 1 1  ON 23
 eO_4                 4.978955e-01 1 1  ON 24
 eO_5                 4.585562e-01 1 1  ON 25
 eO_6                 2.340319e-01 1 1  ON 26
 eO_7                -5.553412e-02 1 1  ON 27
 eO_8                -1.975620e-01 1 1  ON 28
 eO_9                -5.903590e-02 1 1  ON 29
eH1_0                -2.243715e-01 1 1  ON 30
eH1_1                -1.280913e-01 1 1  ON 31
eH1_2                -8.753776e-02 1 1  ON 32
eH1_3                -3.782110e-02 1 1  ON 33
eH1_4                 1.655649e-02 1 1  ON 34
eH1_5                 4.803779e-02 1 1  ON 35
eH1_6                 9.684220e-02 1 1  ON 36
eH1_7                 1.381964e-01 1 1  ON 37
eH1_8                 1.478908e-01 1 1  ON 38
eH1_9                 3.475967e-02 1 1  ON 39
eH2_0                -2.232074e-01 1 1  ON 40
eH2_1                -1.272085e-01 1 1  ON 41
eH2_2                -8.639399e-02 1 1  ON 42
eH2_3                -3.664416e-02 1 1  ON 43
eH2_4                 1.782204e-02 1 1  ON 44
eH2_5                 5.135403e-02 1 1  ON 45
eH2_6                 1.030391e-01 1 1  ON 46
eH2_7                 1.500284e-01 1 1  ON 47
eH2_8                 1.545680e-01 1 1  ON 48
eH2_9                 1.500931e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8452
    reference variance = 0.271805
====================================================
  Execution time = 2.7423e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3962e-01
  Total weights = 2.0000e+06
  Execution time = 3.5262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991915515
                                         uncertainty =       0.005119300600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338991915515
                                         uncertainty =       0.005119300600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411680798
  error estimate for blocks of size 2^( 2) =       0.000423986223
  error estimate for blocks of size 2^( 3) =       0.000437146381
  error estimate for blocks of size 2^( 4) =       0.000450596825
  error estimate for blocks of size 2^( 5) =       0.000463102149
  error estimate for blocks of size 2^( 6) =       0.000471888960
  error estimate for blocks of size 2^( 7) =       0.000479960795

      target function =                  N/A
              le_mean =     -16.908337490311
             les_mean =     286.230838676490
             stat err =       0.000466387182
             autocorr =       1.283429417187
              std dev =       0.582204568603
             le_variance =       0.338962159702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340787300469
                                         uncertainty =       0.005154547759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340787300469
                                         uncertainty =       0.005154547759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412769837
  error estimate for blocks of size 2^( 2) =       0.000424972499
  error estimate for blocks of size 2^( 3) =       0.000438029315
  error estimate for blocks of size 2^( 4) =       0.000451401318
  error estimate for blocks of size 2^( 5) =       0.000463820053
  error estimate for blocks of size 2^( 6) =       0.000472604123
  error estimate for blocks of size 2^( 7) =       0.000480700087

      target function =                  N/A
              le_mean =     -16.908347376408
             les_mean =     286.232968707893
             stat err =       0.000467131396
             autocorr =       1.280743633907
              std dev =       0.583744701888
             le_variance =       0.340757876982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340362329344
                                         uncertainty =       0.005149318979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340362329344
                                         uncertainty =       0.005149318979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412512407
  error estimate for blocks of size 2^( 2) =       0.000424733121
  error estimate for blocks of size 2^( 3) =       0.000437815039
  error estimate for blocks of size 2^( 4) =       0.000451210790
  error estimate for blocks of size 2^( 5) =       0.000463654132
  error estimate for blocks of size 2^( 6) =       0.000472439695
  error estimate for blocks of size 2^( 7) =       0.000480539221

      target function =                  N/A
              le_mean =     -16.908342769342
             les_mean =     286.232388006537
             stat err =       0.000466960960
             autocorr =       1.281407070807
              std dev =       0.583380640025
             le_variance =       0.340332971156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339181653351
                                         uncertainty =       0.005123985054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339181653351
                                         uncertainty =       0.005123985054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411796047
  error estimate for blocks of size 2^( 2) =       0.000424086945
  error estimate for blocks of size 2^( 3) =       0.000437234275
  error estimate for blocks of size 2^( 4) =       0.000450676042
  error estimate for blocks of size 2^( 5) =       0.000463172139
  error estimate for blocks of size 2^( 6) =       0.000471958937
  error estimate for blocks of size 2^( 7) =       0.000480035204

      target function =                  N/A
              le_mean =     -16.908335123841
             les_mean =     286.230948458757
             stat err =       0.000466460581
             autocorr =       1.283114907978
              std dev =       0.582367554225
             le_variance =       0.339151968214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908337490311        initial
     9.7656e-02     9.7656e-01             7.9690e-03       -16.908347376408  <--
     3.9062e-01     3.9062e+00             2.8956e-03       -16.908342769342
     1.5625e+00     1.5625e+01             8.4712e-04       -16.908335123841

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.5103e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.050152e-01 1 1  ON 0
 uu_1                 1.406298e-01 1 1  ON 1
 uu_2                 4.343610e-02 1 1  ON 2
 uu_3                -1.742822e-02 1 1  ON 3
 uu_4                -6.372096e-02 1 1  ON 4
 uu_5                -9.723745e-02 1 1  ON 5
 uu_6                -1.222670e-01 1 1  ON 6
 uu_7                -1.328146e-01 1 1  ON 7
 uu_8                -1.239110e-01 1 1  ON 8
 uu_9                -9.396870e-02 1 1  ON 9
 ud_0                 4.218141e-01 1 1  ON 10
 ud_1                 1.674313e-01 1 1  ON 11
 ud_2                 5.856019e-02 1 1  ON 12
 ud_3                -5.883739e-03 1 1  ON 13
 ud_4                -5.935751e-02 1 1  ON 14
 ud_5                -1.001819e-01 1 1  ON 15
 ud_6                -1.283754e-01 1 1  ON 16
 ud_7                -1.459187e-01 1 1  ON 17
 ud_8                -1.466996e-01 1 1  ON 18
 ud_9                -1.352951e-01 1 1  ON 19
 eO_0                -7.317315e-01 1 1  ON 20
 eO_1                -4.231311e-01 1 1  ON 21
 eO_2                -1.777140e-02 1 1  ON 22
 eO_3                 2.889127e-01 1 1  ON 23
 eO_4                 5.018393e-01 1 1  ON 24
 eO_5                 4.600915e-01 1 1  ON 25
 eO_6                 2.339451e-01 1 1  ON 26
 eO_7                -5.576693e-02 1 1  ON 27
 eO_8                -1.990523e-01 1 1  ON 28
 eO_9                -5.995384e-02 1 1  ON 29
eH1_0                -2.286824e-01 1 1  ON 30
eH1_1                -1.297070e-01 1 1  ON 31
eH1_2                -8.858163e-02 1 1  ON 32
eH1_3                -3.839060e-02 1 1  ON 33
eH1_4                 1.681898e-02 1 1  ON 34
eH1_5                 4.922265e-02 1 1  ON 35
eH1_6                 9.902229e-02 1 1  ON 36
eH1_7                 1.395568e-01 1 1  ON 37
eH1_8                 1.493866e-01 1 1  ON 38
eH1_9                 3.583770e-02 1 1  ON 39
eH2_0                -2.275311e-01 1 1  ON 40
eH2_1                -1.284279e-01 1 1  ON 41
eH2_2                -8.713793e-02 1 1  ON 42
eH2_3                -3.688438e-02 1 1  ON 43
eH2_4                 1.814144e-02 1 1  ON 44
eH2_5                 5.257610e-02 1 1  ON 45
eH2_6                 1.041270e-01 1 1  ON 46
eH2_7                 1.508288e-01 1 1  ON 47
eH2_8                 1.561062e-01 1 1  ON 48
eH2_9                 1.651416e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8723
    reference variance = 0.27754
====================================================
  Execution time = 2.8144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3676e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336633696662
                                         uncertainty =       0.005178020812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336633696662
                                         uncertainty =       0.005178020812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410341010
  error estimate for blocks of size 2^( 2) =       0.000422310083
  error estimate for blocks of size 2^( 3) =       0.000435125320
  error estimate for blocks of size 2^( 4) =       0.000447281373
  error estimate for blocks of size 2^( 5) =       0.000458482674
  error estimate for blocks of size 2^( 6) =       0.000466766779
  error estimate for blocks of size 2^( 7) =       0.000471952403

      target function =                  N/A
              le_mean =     -16.909031875696
             les_mean =     286.252118294717
             stat err =       0.000461120807
             autocorr =       1.262814593528
              std dev =       0.580309822242
             le_variance =       0.336759489791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690903187570e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909031875696       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909040416636       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909043210350       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909076395135       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909091559574       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909098320743       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909108795441       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909109977747       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909112438179       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909115520395       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909122076351       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909121725977       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909122927181       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909124554070       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909124464398       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909124800449       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909124943017       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909124639288       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909124686482       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.131092e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909031875696       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909038106630       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909039411445       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909054870019       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909064085719       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909066752800       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909071782905       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909072126372       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909070905738       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909071769598       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909071544001       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909071571847       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909071729044       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909072012030       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 5.292351e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909031875696       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909034868671       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909035328368       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909039610354       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909043300735       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909043958559       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909045408406       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909045587718       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909045328365       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909045313744       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909045251122       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.860585e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5232e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.062898e-01 1 1  ON 0
 uu_1                 1.418662e-01 1 1  ON 1
 uu_2                 4.394671e-02 1 1  ON 2
 uu_3                -1.779055e-02 1 1  ON 3
 uu_4                -6.450862e-02 1 1  ON 4
 uu_5                -9.796210e-02 1 1  ON 5
 uu_6                -1.228958e-01 1 1  ON 6
 uu_7                -1.331111e-01 1 1  ON 7
 uu_8                -1.247964e-01 1 1  ON 8
 uu_9                -9.508000e-02 1 1  ON 9
 ud_0                 4.239177e-01 1 1  ON 10
 ud_1                 1.693632e-01 1 1  ON 11
 ud_2                 5.955983e-02 1 1  ON 12
 ud_3                -5.937296e-03 1 1  ON 13
 ud_4                -5.977529e-02 1 1  ON 14
 ud_5                -1.009117e-01 1 1  ON 15
 ud_6                -1.289427e-01 1 1  ON 16
 ud_7                -1.465879e-01 1 1  ON 17
 ud_8                -1.486931e-01 1 1  ON 18
 ud_9                -1.363371e-01 1 1  ON 19
 eO_0                -7.370238e-01 1 1  ON 20
 eO_1                -4.261986e-01 1 1  ON 21
 eO_2                -1.696954e-02 1 1  ON 22
 eO_3                 2.930707e-01 1 1  ON 23
 eO_4                 5.062763e-01 1 1  ON 24
 eO_5                 4.618822e-01 1 1  ON 25
 eO_6                 2.342952e-01 1 1  ON 26
 eO_7                -5.496502e-02 1 1  ON 27
 eO_8                -2.011904e-01 1 1  ON 28
 eO_9                -6.152931e-02 1 1  ON 29
eH1_0                -2.332552e-01 1 1  ON 30
eH1_1                -1.314568e-01 1 1  ON 31
eH1_2                -8.995425e-02 1 1  ON 32
eH1_3                -3.908265e-02 1 1  ON 33
eH1_4                 1.646444e-02 1 1  ON 34
eH1_5                 5.036112e-02 1 1  ON 35
eH1_6                 1.015308e-01 1 1  ON 36
eH1_7                 1.418690e-01 1 1  ON 37
eH1_8                 1.511160e-01 1 1  ON 38
eH1_9                 3.718968e-02 1 1  ON 39
eH2_0                -2.314827e-01 1 1  ON 40
eH2_1                -1.303528e-01 1 1  ON 41
eH2_2                -8.868059e-02 1 1  ON 42
eH2_3                -3.801703e-02 1 1  ON 43
eH2_4                 1.754916e-02 1 1  ON 44
eH2_5                 5.361179e-02 1 1  ON 45
eH2_6                 1.057838e-01 1 1  ON 46
eH2_7                 1.518619e-01 1 1  ON 47
eH2_8                 1.588514e-01 1 1  ON 48
eH2_9                 1.902938e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8569
    reference variance = 0.177283
====================================================
  Execution time = 2.7576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3791e-01
  Total weights = 2.0000e+06
  Execution time = 3.5400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336957286014
                                         uncertainty =       0.006251624486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336957286014
                                         uncertainty =       0.006251624486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410468035
  error estimate for blocks of size 2^( 2) =       0.000422485621
  error estimate for blocks of size 2^( 3) =       0.000435395406
  error estimate for blocks of size 2^( 4) =       0.000447431191
  error estimate for blocks of size 2^( 5) =       0.000457316949
  error estimate for blocks of size 2^( 6) =       0.000464132265
  error estimate for blocks of size 2^( 7) =       0.000470723106

      target function =                  N/A
              le_mean =     -16.909627692836
             les_mean =     286.272476556637
             stat err =       0.000459900878
             autocorr =       1.255364356560
              std dev =       0.580489461396
             le_variance =       0.336968014792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339277841462
                                         uncertainty =       0.006270820234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339277841462
                                         uncertainty =       0.006270820234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411879332
  error estimate for blocks of size 2^( 2) =       0.000423832716
  error estimate for blocks of size 2^( 3) =       0.000436626062
  error estimate for blocks of size 2^( 4) =       0.000448508531
  error estimate for blocks of size 2^( 5) =       0.000458261029
  error estimate for blocks of size 2^( 6) =       0.000464987332
  error estimate for blocks of size 2^( 7) =       0.000471486444

      target function =                  N/A
              le_mean =     -16.909632203416
             les_mean =     286.274950253309
             stat err =       0.000460810834
             autocorr =       1.251714730572
              std dev =       0.582485337270
             le_variance =       0.339289168134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338922450424
                                         uncertainty =       0.006262312793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338922450424
                                         uncertainty =       0.006262312793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411663493
  error estimate for blocks of size 2^( 2) =       0.000423625233
  error estimate for blocks of size 2^( 3) =       0.000436443555
  error estimate for blocks of size 2^( 4) =       0.000448366245
  error estimate for blocks of size 2^( 5) =       0.000458149217
  error estimate for blocks of size 2^( 6) =       0.000464899053
  error estimate for blocks of size 2^( 7) =       0.000471431626

      target function =                  N/A
              le_mean =     -16.909636399504
             les_mean =     286.274736656542
             stat err =       0.000460711535
             autocorr =       1.252487683169
              std dev =       0.582180094625
             le_variance =       0.338933662577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337182991540
                                         uncertainty =       0.006250336922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337182991540
                                         uncertainty =       0.006250336922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410605519
  error estimate for blocks of size 2^( 2) =       0.000422611574
  error estimate for blocks of size 2^( 3) =       0.000435505818
  error estimate for blocks of size 2^( 4) =       0.000447525000
  error estimate for blocks of size 2^( 5) =       0.000457394428
  error estimate for blocks of size 2^( 6) =       0.000464201375
  error estimate for blocks of size 2^( 7) =       0.000470787127

      target function =                  N/A
              le_mean =     -16.909624024298
             les_mean =     286.272578258930
             stat err =       0.000459976982
             autocorr =       1.254939053890
              std dev =       0.580683893713
             le_variance =       0.337193784418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909627692836        initial
     2.4414e-02     2.4414e-01             1.1311e-02       -16.909632203416
     9.7656e-02     9.7656e-01             5.2924e-03       -16.909636399504  <--
     3.9062e-01     3.9062e+00             1.8606e-03       -16.909624024298

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.5215e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.062898e-01 1 1  ON 0
 uu_1                 1.418662e-01 1 1  ON 1
 uu_2                 4.394671e-02 1 1  ON 2
 uu_3                -1.779055e-02 1 1  ON 3
 uu_4                -6.450862e-02 1 1  ON 4
 uu_5                -9.796210e-02 1 1  ON 5
 uu_6                -1.228958e-01 1 1  ON 6
 uu_7                -1.331111e-01 1 1  ON 7
 uu_8                -1.247964e-01 1 1  ON 8
 uu_9                -9.508000e-02 1 1  ON 9
 ud_0                 4.239177e-01 1 1  ON 10
 ud_1                 1.693632e-01 1 1  ON 11
 ud_2                 5.955983e-02 1 1  ON 12
 ud_3                -5.937296e-03 1 1  ON 13
 ud_4                -5.977529e-02 1 1  ON 14
 ud_5                -1.009117e-01 1 1  ON 15
 ud_6                -1.289427e-01 1 1  ON 16
 ud_7                -1.465879e-01 1 1  ON 17
 ud_8                -1.486931e-01 1 1  ON 18
 ud_9                -1.363371e-01 1 1  ON 19
 eO_0                -7.370238e-01 1 1  ON 20
 eO_1                -4.261986e-01 1 1  ON 21
 eO_2                -1.696954e-02 1 1  ON 22
 eO_3                 2.930707e-01 1 1  ON 23
 eO_4                 5.062763e-01 1 1  ON 24
 eO_5                 4.618822e-01 1 1  ON 25
 eO_6                 2.342952e-01 1 1  ON 26
 eO_7                -5.496502e-02 1 1  ON 27
 eO_8                -2.011904e-01 1 1  ON 28
 eO_9                -6.152931e-02 1 1  ON 29
eH1_0                -2.332552e-01 1 1  ON 30
eH1_1                -1.314568e-01 1 1  ON 31
eH1_2                -8.995425e-02 1 1  ON 32
eH1_3                -3.908265e-02 1 1  ON 33
eH1_4                 1.646444e-02 1 1  ON 34
eH1_5                 5.036112e-02 1 1  ON 35
eH1_6                 1.015308e-01 1 1  ON 36
eH1_7                 1.418690e-01 1 1  ON 37
eH1_8                 1.511160e-01 1 1  ON 38
eH1_9                 3.718968e-02 1 1  ON 39
eH2_0                -2.314827e-01 1 1  ON 40
eH2_1                -1.303528e-01 1 1  ON 41
eH2_2                -8.868059e-02 1 1  ON 42
eH2_3                -3.801703e-02 1 1  ON 43
eH2_4                 1.754916e-02 1 1  ON 44
eH2_5                 5.361179e-02 1 1  ON 45
eH2_6                 1.057838e-01 1 1  ON 46
eH2_7                 1.518619e-01 1 1  ON 47
eH2_8                 1.588514e-01 1 1  ON 48
eH2_9                 1.902938e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9286
    reference variance = 0.319736
====================================================
  Execution time = 2.9761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4224e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342268541235
                                         uncertainty =       0.004657388966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342268541235
                                         uncertainty =       0.004657388966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413667074
  error estimate for blocks of size 2^( 2) =       0.000425964732
  error estimate for blocks of size 2^( 3) =       0.000438469509
  error estimate for blocks of size 2^( 4) =       0.000450563371
  error estimate for blocks of size 2^( 5) =       0.000461142116
  error estimate for blocks of size 2^( 6) =       0.000470963426
  error estimate for blocks of size 2^( 7) =       0.000477056257

      target function =                  N/A
              le_mean =     -16.909614073094
             les_mean =     286.277288826876
             stat err =       0.000464931293
             autocorr =       1.263210263640
              std dev =       0.585013587037
             le_variance =       0.342240897018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690961407309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909614073094       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909617783177       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909622374373       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909628354864       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909646717277       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909650292614       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909655576226       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909663536106       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909665464544       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909664355464       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909668538669       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909667289776       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909670762476       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909670287392       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909670760447       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909670430234       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909670157628       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909670050035       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.056671e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909614073094       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909616733685       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909620238515       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909624500401       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909633150823       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909633829151       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909636087309       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909636618393       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909635972696       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909637204894       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909636454675       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909636374171       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909636670688       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.715657e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909614073094       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909615321316       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909617319176       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909618913604       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909621729466       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909621373048       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909621479357       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909621612320       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909621532763       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909621680332       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.141019e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7010e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.076179e-01 1 1  ON 0
 uu_1                 1.428006e-01 1 1  ON 1
 uu_2                 4.479715e-02 1 1  ON 2
 uu_3                -1.739664e-02 1 1  ON 3
 uu_4                -6.461591e-02 1 1  ON 4
 uu_5                -9.808578e-02 1 1  ON 5
 uu_6                -1.234191e-01 1 1  ON 6
 uu_7                -1.343030e-01 1 1  ON 7
 uu_8                -1.263959e-01 1 1  ON 8
 uu_9                -9.634673e-02 1 1  ON 9
 ud_0                 4.252668e-01 1 1  ON 10
 ud_1                 1.701131e-01 1 1  ON 11
 ud_2                 5.976141e-02 1 1  ON 12
 ud_3                -6.185983e-03 1 1  ON 13
 ud_4                -6.050097e-02 1 1  ON 14
 ud_5                -1.015964e-01 1 1  ON 15
 ud_6                -1.292035e-01 1 1  ON 16
 ud_7                -1.471535e-01 1 1  ON 17
 ud_8                -1.489699e-01 1 1  ON 18
 ud_9                -1.361748e-01 1 1  ON 19
 eO_0                -7.403607e-01 1 1  ON 20
 eO_1                -4.285175e-01 1 1  ON 21
 eO_2                -1.710903e-02 1 1  ON 22
 eO_3                 2.951503e-01 1 1  ON 23
 eO_4                 5.099920e-01 1 1  ON 24
 eO_5                 4.640348e-01 1 1  ON 25
 eO_6                 2.354611e-01 1 1  ON 26
 eO_7                -5.507023e-02 1 1  ON 27
 eO_8                -2.029493e-01 1 1  ON 28
 eO_9                -6.272665e-02 1 1  ON 29
eH1_0                -2.357255e-01 1 1  ON 30
eH1_1                -1.331169e-01 1 1  ON 31
eH1_2                -9.143821e-02 1 1  ON 32
eH1_3                -4.074293e-02 1 1  ON 33
eH1_4                 1.544921e-02 1 1  ON 34
eH1_5                 5.092983e-02 1 1  ON 35
eH1_6                 1.036761e-01 1 1  ON 36
eH1_7                 1.446388e-01 1 1  ON 37
eH1_8                 1.525832e-01 1 1  ON 38
eH1_9                 3.838768e-02 1 1  ON 39
eH2_0                -2.341673e-01 1 1  ON 40
eH2_1                -1.317504e-01 1 1  ON 41
eH2_2                -9.029271e-02 1 1  ON 42
eH2_3                -3.925973e-02 1 1  ON 43
eH2_4                 1.686743e-02 1 1  ON 44
eH2_5                 5.425907e-02 1 1  ON 45
eH2_6                 1.072017e-01 1 1  ON 46
eH2_7                 1.526092e-01 1 1  ON 47
eH2_8                 1.608093e-01 1 1  ON 48
eH2_9                 2.165200e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.238842
====================================================
  Execution time = 2.7430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3396e-01
  Total weights = 2.0000e+06
  Execution time = 3.4386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332999829261
                                         uncertainty =       0.004013981076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332999829261
                                         uncertainty =       0.004013981076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408017545
  error estimate for blocks of size 2^( 2) =       0.000419884791
  error estimate for blocks of size 2^( 3) =       0.000432133726
  error estimate for blocks of size 2^( 4) =       0.000443313902
  error estimate for blocks of size 2^( 5) =       0.000454157832
  error estimate for blocks of size 2^( 6) =       0.000460695614
  error estimate for blocks of size 2^( 7) =       0.000464931877

      target function =                  N/A
              le_mean =     -16.909076393866
             les_mean =     286.249820961524
             stat err =       0.000455774806
             autocorr =       1.247794172587
              std dev =       0.577023946136
             le_variance =       0.332956634414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095475820
                                         uncertainty =       0.004034879686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095475820
                                         uncertainty =       0.004034879686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409299370
  error estimate for blocks of size 2^( 2) =       0.000421119759
  error estimate for blocks of size 2^( 3) =       0.000433281498
  error estimate for blocks of size 2^( 4) =       0.000444355622
  error estimate for blocks of size 2^( 5) =       0.000455086519
  error estimate for blocks of size 2^( 6) =       0.000461576799
  error estimate for blocks of size 2^( 7) =       0.000465769892

      target function =                  N/A
              le_mean =     -16.909074243487
             les_mean =     286.251843552098
             stat err =       0.000456697208
             autocorr =       1.245014935989
              std dev =       0.578836719534
             le_variance =       0.335051947881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335031632293
                                         uncertainty =       0.004028334022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335031632293
                                         uncertainty =       0.004028334022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409260364
  error estimate for blocks of size 2^( 2) =       0.000421078909
  error estimate for blocks of size 2^( 3) =       0.000433254620
  error estimate for blocks of size 2^( 4) =       0.000444350398
  error estimate for blocks of size 2^( 5) =       0.000455100321
  error estimate for blocks of size 2^( 6) =       0.000461602561
  error estimate for blocks of size 2^( 7) =       0.000465785772

      target function =                  N/A
              le_mean =     -16.909073108485
             les_mean =     286.251741312405
             stat err =       0.000456709763
             autocorr =       1.245320730359
              std dev =       0.578781557949
             le_variance =       0.334988091822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333391847900
                                         uncertainty =       0.004015703793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333391847900
                                         uncertainty =       0.004015703793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408257623
  error estimate for blocks of size 2^( 2) =       0.000420113242
  error estimate for blocks of size 2^( 3) =       0.000432347704
  error estimate for blocks of size 2^( 4) =       0.000443512881
  error estimate for blocks of size 2^( 5) =       0.000454339453
  error estimate for blocks of size 2^( 6) =       0.000460871570
  error estimate for blocks of size 2^( 7) =       0.000465092498

      target function =                  N/A
              le_mean =     -16.909073317485
             les_mean =     286.250108862888
             stat err =       0.000455954101
             autocorr =       1.247307823618
              std dev =       0.577363467383
             le_variance =       0.333348573469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909076393866        initial  <--
     2.4414e-02     2.4414e-01             1.0567e-02       -16.909074243487
     9.7656e-02     9.7656e-01             3.7157e-03       -16.909073108485
     3.9062e-01     3.9062e+00             1.1410e-03       -16.909073317485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8997
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.062898e-01 1 1  ON 0
 uu_1                 1.418662e-01 1 1  ON 1
 uu_2                 4.394671e-02 1 1  ON 2
 uu_3                -1.779055e-02 1 1  ON 3
 uu_4                -6.450862e-02 1 1  ON 4
 uu_5                -9.796210e-02 1 1  ON 5
 uu_6                -1.228958e-01 1 1  ON 6
 uu_7                -1.331111e-01 1 1  ON 7
 uu_8                -1.247964e-01 1 1  ON 8
 uu_9                -9.508000e-02 1 1  ON 9
 ud_0                 4.239177e-01 1 1  ON 10
 ud_1                 1.693632e-01 1 1  ON 11
 ud_2                 5.955983e-02 1 1  ON 12
 ud_3                -5.937296e-03 1 1  ON 13
 ud_4                -5.977529e-02 1 1  ON 14
 ud_5                -1.009117e-01 1 1  ON 15
 ud_6                -1.289427e-01 1 1  ON 16
 ud_7                -1.465879e-01 1 1  ON 17
 ud_8                -1.486931e-01 1 1  ON 18
 ud_9                -1.363371e-01 1 1  ON 19
 eO_0                -7.370238e-01 1 1  ON 20
 eO_1                -4.261986e-01 1 1  ON 21
 eO_2                -1.696954e-02 1 1  ON 22
 eO_3                 2.930707e-01 1 1  ON 23
 eO_4                 5.062763e-01 1 1  ON 24
 eO_5                 4.618822e-01 1 1  ON 25
 eO_6                 2.342952e-01 1 1  ON 26
 eO_7                -5.496502e-02 1 1  ON 27
 eO_8                -2.011904e-01 1 1  ON 28
 eO_9                -6.152931e-02 1 1  ON 29
eH1_0                -2.332552e-01 1 1  ON 30
eH1_1                -1.314568e-01 1 1  ON 31
eH1_2                -8.995425e-02 1 1  ON 32
eH1_3                -3.908265e-02 1 1  ON 33
eH1_4                 1.646444e-02 1 1  ON 34
eH1_5                 5.036112e-02 1 1  ON 35
eH1_6                 1.015308e-01 1 1  ON 36
eH1_7                 1.418690e-01 1 1  ON 37
eH1_8                 1.511160e-01 1 1  ON 38
eH1_9                 3.718968e-02 1 1  ON 39
eH2_0                -2.314827e-01 1 1  ON 40
eH2_1                -1.303528e-01 1 1  ON 41
eH2_2                -8.868059e-02 1 1  ON 42
eH2_3                -3.801703e-02 1 1  ON 43
eH2_4                 1.754916e-02 1 1  ON 44
eH2_5                 5.361179e-02 1 1  ON 45
eH2_6                 1.057838e-01 1 1  ON 46
eH2_7                 1.518619e-01 1 1  ON 47
eH2_8                 1.588514e-01 1 1  ON 48
eH2_9                 1.902938e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1916e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.301223
====================================================
  Execution time = 2.8458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339800608430
                                         uncertainty =       0.004674454354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339800608430
                                         uncertainty =       0.004674454354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412193609
  error estimate for blocks of size 2^( 2) =       0.000424133535
  error estimate for blocks of size 2^( 3) =       0.000437088193
  error estimate for blocks of size 2^( 4) =       0.000449188844
  error estimate for blocks of size 2^( 5) =       0.000459666608
  error estimate for blocks of size 2^( 6) =       0.000467668916
  error estimate for blocks of size 2^( 7) =       0.000473057593

      target function =                  N/A
              le_mean =     -16.908644376509
             les_mean =     286.242061624482
             stat err =       0.000462395490
             autocorr =       1.258417275402
              std dev =       0.582929792627
             le_variance =       0.339807143132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690864437651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908644376509       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908644888819       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908648512893       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908650864575       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908651511455       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908653160605       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908653038584       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908652894997       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908652589641       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908652425491       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908652342001       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.293044e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908644376509       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908644566352       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908645890943       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908646532652       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908646744792       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908646888907       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908646912753       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908646884244       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.455032e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908644376509       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908644430476       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908644806021       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908644979205       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908645044147       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908645044427       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908645047580       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908645048619       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 8.616515e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5611e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.065166e-01 1 1  ON 0
 uu_1                 1.419480e-01 1 1  ON 1
 uu_2                 4.403326e-02 1 1  ON 2
 uu_3                -1.777375e-02 1 1  ON 3
 uu_4                -6.450388e-02 1 1  ON 4
 uu_5                -9.801723e-02 1 1  ON 5
 uu_6                -1.231103e-01 1 1  ON 6
 uu_7                -1.333302e-01 1 1  ON 7
 uu_8                -1.248787e-01 1 1  ON 8
 uu_9                -9.511995e-02 1 1  ON 9
 ud_0                 4.240092e-01 1 1  ON 10
 ud_1                 1.694479e-01 1 1  ON 11
 ud_2                 5.965143e-02 1 1  ON 12
 ud_3                -5.997687e-03 1 1  ON 13
 ud_4                -5.982704e-02 1 1  ON 14
 ud_5                -1.009794e-01 1 1  ON 15
 ud_6                -1.289989e-01 1 1  ON 16
 ud_7                -1.465292e-01 1 1  ON 17
 ud_8                -1.487179e-01 1 1  ON 18
 ud_9                -1.364183e-01 1 1  ON 19
 eO_0                -7.373693e-01 1 1  ON 20
 eO_1                -4.265125e-01 1 1  ON 21
 eO_2                -1.696929e-02 1 1  ON 22
 eO_3                 2.933054e-01 1 1  ON 23
 eO_4                 5.066191e-01 1 1  ON 24
 eO_5                 4.621573e-01 1 1  ON 25
 eO_6                 2.344228e-01 1 1  ON 26
 eO_7                -5.494976e-02 1 1  ON 27
 eO_8                -2.013529e-01 1 1  ON 28
 eO_9                -6.168010e-02 1 1  ON 29
eH1_0                -2.335898e-01 1 1  ON 30
eH1_1                -1.316305e-01 1 1  ON 31
eH1_2                -9.005933e-02 1 1  ON 32
eH1_3                -3.921761e-02 1 1  ON 33
eH1_4                 1.638139e-02 1 1  ON 34
eH1_5                 5.042972e-02 1 1  ON 35
eH1_6                 1.017345e-01 1 1  ON 36
eH1_7                 1.420365e-01 1 1  ON 37
eH1_8                 1.513212e-01 1 1  ON 38
eH1_9                 3.736800e-02 1 1  ON 39
eH2_0                -2.317806e-01 1 1  ON 40
eH2_1                -1.304995e-01 1 1  ON 41
eH2_2                -8.892151e-02 1 1  ON 42
eH2_3                -3.814997e-02 1 1  ON 43
eH2_4                 1.747826e-02 1 1  ON 44
eH2_5                 5.366251e-02 1 1  ON 45
eH2_6                 1.060156e-01 1 1  ON 46
eH2_7                 1.520098e-01 1 1  ON 47
eH2_8                 1.590949e-01 1 1  ON 48
eH2_9                 1.924264e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.314552
====================================================
  Execution time = 2.7570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4474e-01
  Total weights = 2.0000e+06
  Execution time = 3.4526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344839089616
                                         uncertainty =       0.009088181326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344839089616
                                         uncertainty =       0.009088181326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415146059
  error estimate for blocks of size 2^( 2) =       0.000427357510
  error estimate for blocks of size 2^( 3) =       0.000439805081
  error estimate for blocks of size 2^( 4) =       0.000451845293
  error estimate for blocks of size 2^( 5) =       0.000462036608
  error estimate for blocks of size 2^( 6) =       0.000469354448
  error estimate for blocks of size 2^( 7) =       0.000473252735

      target function =                  N/A
              le_mean =     -16.909438069699
             les_mean =     286.273788162005
             stat err =       0.000464122271
             autocorr =       1.249864627377
              std dev =       0.587105187653
             le_variance =       0.344692501369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345073093666
                                         uncertainty =       0.009090026804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345073093666
                                         uncertainty =       0.009090026804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415286822
  error estimate for blocks of size 2^( 2) =       0.000427493705
  error estimate for blocks of size 2^( 3) =       0.000439930315
  error estimate for blocks of size 2^( 4) =       0.000451952900
  error estimate for blocks of size 2^( 5) =       0.000462128794
  error estimate for blocks of size 2^( 6) =       0.000469429368
  error estimate for blocks of size 2^( 7) =       0.000473321592

      target function =                  N/A
              le_mean =     -16.909438882643
             les_mean =     286.274049442661
             stat err =       0.000464208164
             autocorr =       1.249479822184
              std dev =       0.587304256157
             le_variance =       0.344926289300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344939188768
                                         uncertainty =       0.009088774397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344939188768
                                         uncertainty =       0.009088774397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415206281
  error estimate for blocks of size 2^( 2) =       0.000427415679
  error estimate for blocks of size 2^( 3) =       0.000439858829
  error estimate for blocks of size 2^( 4) =       0.000451890114
  error estimate for blocks of size 2^( 5) =       0.000462072928
  error estimate for blocks of size 2^( 6) =       0.000469380494
  error estimate for blocks of size 2^( 7) =       0.000473279222

      target function =                  N/A
              le_mean =     -16.909438069586
             les_mean =     286.273888168269
             stat err =       0.000464155690
             autocorr =       1.249682037700
              std dev =       0.587190353724
             le_variance =       0.344792511507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344848588764
                                         uncertainty =       0.009088212623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344848588764
                                         uncertainty =       0.009088212623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415151774
  error estimate for blocks of size 2^( 2) =       0.000427363012
  error estimate for blocks of size 2^( 3) =       0.000439810153
  error estimate for blocks of size 2^( 4) =       0.000451849263
  error estimate for blocks of size 2^( 5) =       0.000462039519
  error estimate for blocks of size 2^( 6) =       0.000469355984
  error estimate for blocks of size 2^( 7) =       0.000473254526

      target function =                  N/A
              le_mean =     -16.909437999114
             les_mean =     286.273795265019
             stat err =       0.000464124823
             autocorr =       1.249843961437
              std dev =       0.587113269736
             le_variance =       0.344701991500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909438069699        initial
     2.4414e-01     2.4414e+00             1.2930e-03       -16.909438882643  <--
     9.7656e-01     9.7656e+00             3.4550e-04       -16.909438069586
     3.9062e+00     3.9062e+01             8.6165e-05       -16.909437999114

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.5117e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.070273e-01 1 1  ON 0
 uu_1                 1.422153e-01 1 1  ON 1
 uu_2                 4.427215e-02 1 1  ON 2
 uu_3                -1.769863e-02 1 1  ON 3
 uu_4                -6.450542e-02 1 1  ON 4
 uu_5                -9.821460e-02 1 1  ON 5
 uu_6                -1.235762e-01 1 1  ON 6
 uu_7                -1.338997e-01 1 1  ON 7
 uu_8                -1.251829e-01 1 1  ON 8
 uu_9                -9.527002e-02 1 1  ON 9
 ud_0                 4.243027e-01 1 1  ON 10
 ud_1                 1.697194e-01 1 1  ON 11
 ud_2                 5.983715e-02 1 1  ON 12
 ud_3                -6.040870e-03 1 1  ON 13
 ud_4                -5.997031e-02 1 1  ON 14
 ud_5                -1.011807e-01 1 1  ON 15
 ud_6                -1.291599e-01 1 1  ON 16
 ud_7                -1.464748e-01 1 1  ON 17
 ud_8                -1.487890e-01 1 1  ON 18
 ud_9                -1.366512e-01 1 1  ON 19
 eO_0                -7.383169e-01 1 1  ON 20
 eO_1                -4.272858e-01 1 1  ON 21
 eO_2                -1.706338e-02 1 1  ON 22
 eO_3                 2.938617e-01 1 1  ON 23
 eO_4                 5.075623e-01 1 1  ON 24
 eO_5                 4.630177e-01 1 1  ON 25
 eO_6                 2.348690e-01 1 1  ON 26
 eO_7                -5.490111e-02 1 1  ON 27
 eO_8                -2.018544e-01 1 1  ON 28
 eO_9                -6.214694e-02 1 1  ON 29
eH1_0                -2.344466e-01 1 1  ON 30
eH1_1                -1.321232e-01 1 1  ON 31
eH1_2                -9.048425e-02 1 1  ON 32
eH1_3                -3.961467e-02 1 1  ON 33
eH1_4                 1.612833e-02 1 1  ON 34
eH1_5                 5.054328e-02 1 1  ON 35
eH1_6                 1.022921e-01 1 1  ON 36
eH1_7                 1.425684e-01 1 1  ON 37
eH1_8                 1.519619e-01 1 1  ON 38
eH1_9                 3.792224e-02 1 1  ON 39
eH2_0                -2.325851e-01 1 1  ON 40
eH2_1                -1.310150e-01 1 1  ON 41
eH2_2                -8.952682e-02 1 1  ON 42
eH2_3                -3.857046e-02 1 1  ON 43
eH2_4                 1.722246e-02 1 1  ON 44
eH2_5                 5.373259e-02 1 1  ON 45
eH2_6                 1.066460e-01 1 1  ON 46
eH2_7                 1.524842e-01 1 1  ON 47
eH2_8                 1.598518e-01 1 1  ON 48
eH2_9                 1.990430e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8984
    reference variance = 0.215011
====================================================
  Execution time = 2.8587e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 4.1587e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416038467049
                                         uncertainty =       0.076973205673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416038467049
                                         uncertainty =       0.076973205673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456001269
  error estimate for blocks of size 2^( 2) =       0.000467028872
  error estimate for blocks of size 2^( 3) =       0.000478554901
  error estimate for blocks of size 2^( 4) =       0.000489270876
  error estimate for blocks of size 2^( 5) =       0.000498955551
  error estimate for blocks of size 2^( 6) =       0.000506605004
  error estimate for blocks of size 2^( 7) =       0.000509576083

      target function =                  N/A
              le_mean =     -16.909846000049
             les_mean =     286.358765851816
             stat err =       0.000501101879
             autocorr =       1.207591255445
              std dev =       0.644883178869
             le_variance =       0.415874314389


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690984600005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909846000049       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909845645932       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909844462087       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909851735566       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909858104032       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909858190442       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909867262949       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909863163851       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909865245063       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909864407113       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909864218413       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909864144693       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909864559964       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909864912352       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.715370e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909846000049       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909845799376       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909845044884       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909850525185       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909849315369       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909850765252       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909852860943       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909851853783       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909851714197       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909851835491       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909851598072       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.546246e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909846000049       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909845926630       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909845615475       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909845969055       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909846941399       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909847098824       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909847585085       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909847403787       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909847335017       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.236281e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5729e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.076166e-01 1 1  ON 0
 uu_1                 1.425073e-01 1 1  ON 1
 uu_2                 4.436268e-02 1 1  ON 2
 uu_3                -1.767918e-02 1 1  ON 3
 uu_4                -6.467085e-02 1 1  ON 4
 uu_5                -9.837036e-02 1 1  ON 5
 uu_6                -1.238891e-01 1 1  ON 6
 uu_7                -1.346178e-01 1 1  ON 7
 uu_8                -1.257610e-01 1 1  ON 8
 uu_9                -9.547274e-02 1 1  ON 9
 ud_0                 4.248166e-01 1 1  ON 10
 ud_1                 1.700008e-01 1 1  ON 11
 ud_2                 5.999336e-02 1 1  ON 12
 ud_3                -5.889231e-03 1 1  ON 13
 ud_4                -6.009177e-02 1 1  ON 14
 ud_5                -1.012786e-01 1 1  ON 15
 ud_6                -1.292813e-01 1 1  ON 16
 ud_7                -1.467241e-01 1 1  ON 17
 ud_8                -1.491713e-01 1 1  ON 18
 ud_9                -1.369445e-01 1 1  ON 19
 eO_0                -7.397721e-01 1 1  ON 20
 eO_1                -4.281504e-01 1 1  ON 21
 eO_2                -1.707047e-02 1 1  ON 22
 eO_3                 2.946368e-01 1 1  ON 23
 eO_4                 5.091085e-01 1 1  ON 24
 eO_5                 4.635420e-01 1 1  ON 25
 eO_6                 2.354876e-01 1 1  ON 26
 eO_7                -5.484055e-02 1 1  ON 27
 eO_8                -2.025428e-01 1 1  ON 28
 eO_9                -6.259210e-02 1 1  ON 29
eH1_0                -2.353642e-01 1 1  ON 30
eH1_1                -1.325966e-01 1 1  ON 31
eH1_2                -9.084290e-02 1 1  ON 32
eH1_3                -3.999995e-02 1 1  ON 33
eH1_4                 1.571026e-02 1 1  ON 34
eH1_5                 5.037002e-02 1 1  ON 35
eH1_6                 1.030009e-01 1 1  ON 36
eH1_7                 1.433800e-01 1 1  ON 37
eH1_8                 1.525183e-01 1 1  ON 38
eH1_9                 3.851763e-02 1 1  ON 39
eH2_0                -2.335516e-01 1 1  ON 40
eH2_1                -1.314185e-01 1 1  ON 41
eH2_2                -9.000482e-02 1 1  ON 42
eH2_3                -3.884386e-02 1 1  ON 43
eH2_4                 1.666295e-02 1 1  ON 44
eH2_5                 5.363805e-02 1 1  ON 45
eH2_6                 1.068774e-01 1 1  ON 46
eH2_7                 1.528826e-01 1 1  ON 47
eH2_8                 1.607581e-01 1 1  ON 48
eH2_9                 2.100778e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9457
    reference variance = 0.346733
====================================================
  Execution time = 2.7864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3298e-01
  Total weights = 2.0000e+06
  Execution time = 3.4434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332605750808
                                         uncertainty =       0.003930966822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332605750808
                                         uncertainty =       0.003930966822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407768588
  error estimate for blocks of size 2^( 2) =       0.000420230643
  error estimate for blocks of size 2^( 3) =       0.000432196238
  error estimate for blocks of size 2^( 4) =       0.000443956367
  error estimate for blocks of size 2^( 5) =       0.000454133875
  error estimate for blocks of size 2^( 6) =       0.000460927997
  error estimate for blocks of size 2^( 7) =       0.000465591824

      target function =                  N/A
              le_mean =     -16.909632194883
             les_mean =     286.268211242676
             stat err =       0.000456152516
             autocorr =       1.251389809259
              std dev =       0.576671867476
             le_variance =       0.332550442738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333616276183
                                         uncertainty =       0.003944238423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333616276183
                                         uncertainty =       0.003944238423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408387390
  error estimate for blocks of size 2^( 2) =       0.000420829069
  error estimate for blocks of size 2^( 3) =       0.000432761381
  error estimate for blocks of size 2^( 4) =       0.000444472971
  error estimate for blocks of size 2^( 5) =       0.000454610785
  error estimate for blocks of size 2^( 6) =       0.000461363352
  error estimate for blocks of size 2^( 7) =       0.000466002444

      target function =                  N/A
              le_mean =     -16.909635082079
             les_mean =     286.269318963311
             stat err =       0.000456612388
             autocorr =       1.250117202542
              std dev =       0.577546985976
             le_variance =       0.333560521010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333472955967
                                         uncertainty =       0.003941986528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333472955967
                                         uncertainty =       0.003941986528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408299678
  error estimate for blocks of size 2^( 2) =       0.000420744392
  error estimate for blocks of size 2^( 3) =       0.000432687683
  error estimate for blocks of size 2^( 4) =       0.000444415521
  error estimate for blocks of size 2^( 5) =       0.000454565070
  error estimate for blocks of size 2^( 6) =       0.000461331917
  error estimate for blocks of size 2^( 7) =       0.000465983444

      target function =                  N/A
              le_mean =     -16.909633723447
             les_mean =     286.269129748347
             stat err =       0.000456573988
             autocorr =       1.250444024973
              std dev =       0.577422941972
             le_variance =       0.333417253916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332765286380
                                         uncertainty =       0.003932897778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332765286380
                                         uncertainty =       0.003932897778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407866343
  error estimate for blocks of size 2^( 2) =       0.000420324872
  error estimate for blocks of size 2^( 3) =       0.000432286675
  error estimate for blocks of size 2^( 4) =       0.000444041872
  error estimate for blocks of size 2^( 5) =       0.000454215122
  error estimate for blocks of size 2^( 6) =       0.000461005484
  error estimate for blocks of size 2^( 7) =       0.000465667948

      target function =                  N/A
              le_mean =     -16.909632124544
             les_mean =     286.268368329143
             stat err =       0.000456232606
             autocorr =       1.251229291022
              std dev =       0.576810114412
             le_variance =       0.332709908088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909632194883        initial
     6.1035e-02     6.1035e-01             4.7154e-03       -16.909635082079  <--
     2.4414e-01     2.4414e+00             1.5462e-03       -16.909633723447
     9.7656e-01     9.7656e+00             4.2363e-04       -16.909632124544

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 4.5339e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.085950e-01 1 1  ON 0
 uu_1                 1.431932e-01 1 1  ON 1
 uu_2                 4.477533e-02 1 1  ON 2
 uu_3                -1.758471e-02 1 1  ON 3
 uu_4                -6.497277e-02 1 1  ON 4
 uu_5                -9.899445e-02 1 1  ON 5
 uu_6                -1.247288e-01 1 1  ON 6
 uu_7                -1.360453e-01 1 1  ON 7
 uu_8                -1.272912e-01 1 1  ON 8
 uu_9                -9.623323e-02 1 1  ON 9
 ud_0                 4.258275e-01 1 1  ON 10
 ud_1                 1.708379e-01 1 1  ON 11
 ud_2                 6.059689e-02 1 1  ON 12
 ud_3                -5.559104e-03 1 1  ON 13
 ud_4                -6.014194e-02 1 1  ON 14
 ud_5                -1.015591e-01 1 1  ON 15
 ud_6                -1.296756e-01 1 1  ON 16
 ud_7                -1.474011e-01 1 1  ON 17
 ud_8                -1.500458e-01 1 1  ON 18
 ud_9                -1.378482e-01 1 1  ON 19
 eO_0                -7.425198e-01 1 1  ON 20
 eO_1                -4.301444e-01 1 1  ON 21
 eO_2                -1.755439e-02 1 1  ON 22
 eO_3                 2.960336e-01 1 1  ON 23
 eO_4                 5.122777e-01 1 1  ON 24
 eO_5                 4.657146e-01 1 1  ON 25
 eO_6                 2.373522e-01 1 1  ON 26
 eO_7                -5.465104e-02 1 1  ON 27
 eO_8                -2.045696e-01 1 1  ON 28
 eO_9                -6.393439e-02 1 1  ON 29
eH1_0                -2.373516e-01 1 1  ON 30
eH1_1                -1.340943e-01 1 1  ON 31
eH1_2                -9.218144e-02 1 1  ON 32
eH1_3                -4.118666e-02 1 1  ON 33
eH1_4                 1.459572e-02 1 1  ON 34
eH1_5                 4.979734e-02 1 1  ON 35
eH1_6                 1.045758e-01 1 1  ON 36
eH1_7                 1.457872e-01 1 1  ON 37
eH1_8                 1.542812e-01 1 1  ON 38
eH1_9                 4.031443e-02 1 1  ON 39
eH2_0                -2.356278e-01 1 1  ON 40
eH2_1                -1.329647e-01 1 1  ON 41
eH2_2                -9.144081e-02 1 1  ON 42
eH2_3                -4.000351e-02 1 1  ON 43
eH2_4                 1.533871e-02 1 1  ON 44
eH2_5                 5.296851e-02 1 1  ON 45
eH2_6                 1.074972e-01 1 1  ON 46
eH2_7                 1.541802e-01 1 1  ON 47
eH2_8                 1.633979e-01 1 1  ON 48
eH2_9                 2.425721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9489
    reference variance = 0.456715
====================================================
  Execution time = 2.8276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346114404240
                                         uncertainty =       0.005753663254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346114404240
                                         uncertainty =       0.005753663254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415957003
  error estimate for blocks of size 2^( 2) =       0.000427753355
  error estimate for blocks of size 2^( 3) =       0.000440482131
  error estimate for blocks of size 2^( 4) =       0.000451859394
  error estimate for blocks of size 2^( 5) =       0.000461942105
  error estimate for blocks of size 2^( 6) =       0.000470670889
  error estimate for blocks of size 2^( 7) =       0.000475068126

      target function =                  N/A
              le_mean =     -16.908872321941
             les_mean =     286.256003483607
             stat err =       0.000464885128
             autocorr =       1.249091996293
              std dev =       0.588252035213
             le_variance =       0.346040456932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690887232194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908872321941       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908875671882       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908880191330       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908881069525       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908883015325       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908897237447       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908898429695       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908907429646       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908907190308       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908909282256       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908908246614       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908913305040       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908913592687       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908913227571       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908915062496       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908916328699       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908915457111       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908915015614       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908915153301       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908915315944       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908914726620       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.964990e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908872321941       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908875175547       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908878191661       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908878797811       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908878830709       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908885614234       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908884339118       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908886933373       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908887567519       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908886762330       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908886702355       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908887444031       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908887356738       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.637549e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908872321941       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908874113677       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908875574828       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908875962401       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908875576303       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908876840254       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908877097031       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908877387870       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908877657847       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.140819e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5551e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.096581e-01 1 1  ON 0
 uu_1                 1.440756e-01 1 1  ON 1
 uu_2                 4.522219e-02 1 1  ON 2
 uu_3                -1.746513e-02 1 1  ON 3
 uu_4                -6.532055e-02 1 1  ON 4
 uu_5                -9.975825e-02 1 1  ON 5
 uu_6                -1.256748e-01 1 1  ON 6
 uu_7                -1.377526e-01 1 1  ON 7
 uu_8                -1.289752e-01 1 1  ON 8
 uu_9                -9.699956e-02 1 1  ON 9
 ud_0                 4.273419e-01 1 1  ON 10
 ud_1                 1.719976e-01 1 1  ON 11
 ud_2                 6.132190e-02 1 1  ON 12
 ud_3                -5.212997e-03 1 1  ON 13
 ud_4                -6.002880e-02 1 1  ON 14
 ud_5                -1.015604e-01 1 1  ON 15
 ud_6                -1.300745e-01 1 1  ON 16
 ud_7                -1.476950e-01 1 1  ON 17
 ud_8                -1.510793e-01 1 1  ON 18
 ud_9                -1.395296e-01 1 1  ON 19
 eO_0                -7.449976e-01 1 1  ON 20
 eO_1                -4.316832e-01 1 1  ON 21
 eO_2                -1.829605e-02 1 1  ON 22
 eO_3                 2.973117e-01 1 1  ON 23
 eO_4                 5.148476e-01 1 1  ON 24
 eO_5                 4.691152e-01 1 1  ON 25
 eO_6                 2.394362e-01 1 1  ON 26
 eO_7                -5.432864e-02 1 1  ON 27
 eO_8                -2.072223e-01 1 1  ON 28
 eO_9                -6.578646e-02 1 1  ON 29
eH1_0                -2.400734e-01 1 1  ON 30
eH1_1                -1.361376e-01 1 1  ON 31
eH1_2                -9.430658e-02 1 1  ON 32
eH1_3                -4.281264e-02 1 1  ON 33
eH1_4                 1.297137e-02 1 1  ON 34
eH1_5                 4.919061e-02 1 1  ON 35
eH1_6                 1.054837e-01 1 1  ON 36
eH1_7                 1.489229e-01 1 1  ON 37
eH1_8                 1.573015e-01 1 1  ON 38
eH1_9                 4.324487e-02 1 1  ON 39
eH2_0                -2.381292e-01 1 1  ON 40
eH2_1                -1.351037e-01 1 1  ON 41
eH2_2                -9.322283e-02 1 1  ON 42
eH2_3                -4.179821e-02 1 1  ON 43
eH2_4                 1.421181e-02 1 1  ON 44
eH2_5                 5.175458e-02 1 1  ON 45
eH2_6                 1.074354e-01 1 1  ON 46
eH2_7                 1.552285e-01 1 1  ON 47
eH2_8                 1.678570e-01 1 1  ON 48
eH2_9                 2.889476e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9288
    reference variance = 0.33039
====================================================
  Execution time = 2.7562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3973e-01
  Total weights = 2.0000e+06
  Execution time = 3.4516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338927977732
                                         uncertainty =       0.002963417723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338927977732
                                         uncertainty =       0.002963417723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411612668
  error estimate for blocks of size 2^( 2) =       0.000423706752
  error estimate for blocks of size 2^( 3) =       0.000435940528
  error estimate for blocks of size 2^( 4) =       0.000447772803
  error estimate for blocks of size 2^( 5) =       0.000458180396
  error estimate for blocks of size 2^( 6) =       0.000467953604
  error estimate for blocks of size 2^( 7) =       0.000472301998

      target function =                  N/A
              le_mean =     -16.909189993670
             les_mean =     286.259556049378
             stat err =       0.000461552200
             autocorr =       1.257373163695
              std dev =       0.582108217414
             le_variance =       0.338849976781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340600761690
                                         uncertainty =       0.002973702123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340600761690
                                         uncertainty =       0.002973702123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412627697
  error estimate for blocks of size 2^( 2) =       0.000424680367
  error estimate for blocks of size 2^( 3) =       0.000436841328
  error estimate for blocks of size 2^( 4) =       0.000448568529
  error estimate for blocks of size 2^( 5) =       0.000458902190
  error estimate for blocks of size 2^( 6) =       0.000468599671
  error estimate for blocks of size 2^( 7) =       0.000472919332

      target function =                  N/A
              le_mean =     -16.909194765340
             les_mean =     286.261390675127
             stat err =       0.000462247430
             autocorr =       1.254966863476
              std dev =       0.583543685753
             le_variance =       0.340523233183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340700935690
                                         uncertainty =       0.002975015453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340700935690
                                         uncertainty =       0.002975015453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412688422
  error estimate for blocks of size 2^( 2) =       0.000424738044
  error estimate for blocks of size 2^( 3) =       0.000436903122
  error estimate for blocks of size 2^( 4) =       0.000448643287
  error estimate for blocks of size 2^( 5) =       0.000458997739
  error estimate for blocks of size 2^( 6) =       0.000468705237
  error estimate for blocks of size 2^( 7) =       0.000473025086

      target function =                  N/A
              le_mean =     -16.909197465655
             les_mean =     286.261582229333
             stat err =       0.000462342837
             autocorr =       1.255115515433
              std dev =       0.583629563287
             le_variance =       0.340623467143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339353346648
                                         uncertainty =       0.002966360070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339353346648
                                         uncertainty =       0.002966360070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411871016
  error estimate for blocks of size 2^( 2) =       0.000423952758
  error estimate for blocks of size 2^( 3) =       0.000436170927
  error estimate for blocks of size 2^( 4) =       0.000447983936
  error estimate for blocks of size 2^( 5) =       0.000458383404
  error estimate for blocks of size 2^( 6) =       0.000468143236
  error estimate for blocks of size 2^( 7) =       0.000472481693

      target function =                  N/A
              le_mean =     -16.909190886943
             les_mean =     286.260011749307
             stat err =       0.000461748067
             autocorr =       1.256862330078
              std dev =       0.582473576968
             le_variance =       0.339275467866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909189993670        initial
     1.5259e-02     1.5259e-01             1.9650e-02       -16.909194765340
     6.1035e-02     6.1035e-01             4.6375e-03       -16.909197465655  <--
     2.4414e-01     2.4414e+00             1.1408e-03       -16.909190886943

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 4.5027e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.096581e-01 1 1  ON 0
 uu_1                 1.440756e-01 1 1  ON 1
 uu_2                 4.522219e-02 1 1  ON 2
 uu_3                -1.746513e-02 1 1  ON 3
 uu_4                -6.532055e-02 1 1  ON 4
 uu_5                -9.975825e-02 1 1  ON 5
 uu_6                -1.256748e-01 1 1  ON 6
 uu_7                -1.377526e-01 1 1  ON 7
 uu_8                -1.289752e-01 1 1  ON 8
 uu_9                -9.699956e-02 1 1  ON 9
 ud_0                 4.273419e-01 1 1  ON 10
 ud_1                 1.719976e-01 1 1  ON 11
 ud_2                 6.132190e-02 1 1  ON 12
 ud_3                -5.212997e-03 1 1  ON 13
 ud_4                -6.002880e-02 1 1  ON 14
 ud_5                -1.015604e-01 1 1  ON 15
 ud_6                -1.300745e-01 1 1  ON 16
 ud_7                -1.476950e-01 1 1  ON 17
 ud_8                -1.510793e-01 1 1  ON 18
 ud_9                -1.395296e-01 1 1  ON 19
 eO_0                -7.449976e-01 1 1  ON 20
 eO_1                -4.316832e-01 1 1  ON 21
 eO_2                -1.829605e-02 1 1  ON 22
 eO_3                 2.973117e-01 1 1  ON 23
 eO_4                 5.148476e-01 1 1  ON 24
 eO_5                 4.691152e-01 1 1  ON 25
 eO_6                 2.394362e-01 1 1  ON 26
 eO_7                -5.432864e-02 1 1  ON 27
 eO_8                -2.072223e-01 1 1  ON 28
 eO_9                -6.578646e-02 1 1  ON 29
eH1_0                -2.400734e-01 1 1  ON 30
eH1_1                -1.361376e-01 1 1  ON 31
eH1_2                -9.430658e-02 1 1  ON 32
eH1_3                -4.281264e-02 1 1  ON 33
eH1_4                 1.297137e-02 1 1  ON 34
eH1_5                 4.919061e-02 1 1  ON 35
eH1_6                 1.054837e-01 1 1  ON 36
eH1_7                 1.489229e-01 1 1  ON 37
eH1_8                 1.573015e-01 1 1  ON 38
eH1_9                 4.324487e-02 1 1  ON 39
eH2_0                -2.381292e-01 1 1  ON 40
eH2_1                -1.351037e-01 1 1  ON 41
eH2_2                -9.322283e-02 1 1  ON 42
eH2_3                -4.179821e-02 1 1  ON 43
eH2_4                 1.421181e-02 1 1  ON 44
eH2_5                 5.175458e-02 1 1  ON 45
eH2_6                 1.074354e-01 1 1  ON 46
eH2_7                 1.552285e-01 1 1  ON 47
eH2_8                 1.678570e-01 1 1  ON 48
eH2_9                 2.889476e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9416
    reference variance = 0.310058
====================================================
  Execution time = 3.0455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4022e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340199061187
                                         uncertainty =       0.004415613452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340199061187
                                         uncertainty =       0.004415613452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412446749
  error estimate for blocks of size 2^( 2) =       0.000424654451
  error estimate for blocks of size 2^( 3) =       0.000437814089
  error estimate for blocks of size 2^( 4) =       0.000450316692
  error estimate for blocks of size 2^( 5) =       0.000462112278
  error estimate for blocks of size 2^( 6) =       0.000471845461
  error estimate for blocks of size 2^( 7) =       0.000475799158

      target function =                  N/A
              le_mean =     -16.909293475393
             les_mean =     286.264430307552
             stat err =       0.000465018397
             autocorr =       1.271172536432
              std dev =       0.583287785489
             le_variance =       0.340224640700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690929347539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909293475393       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909299663941       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909300320480       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909301574980       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909306236099       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909311492993       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909315011302       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909315545429       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909322669649       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909326499468       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909330926007       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909334015288       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909334365599       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909334645313       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909336505054       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909335103626       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909335898921       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909336037572       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909335136701       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909335791569       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909335579323       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.554282e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909293475393       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909298688966       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909298972001       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909299515491       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909301612472       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909303614862       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909304062436       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909303869497       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909305024049       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909306157881       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909306803000       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909307130638       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909307024937       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909307154241       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.985385e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909293475393       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909296673550       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909296643776       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909296583376       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909296947869       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909297480546       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909297514824       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909297344012       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909297401405       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909297611159       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.097777e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7497e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.102319e-01 1 1  ON 0
 uu_1                 1.445423e-01 1 1  ON 1
 uu_2                 4.578686e-02 1 1  ON 2
 uu_3                -1.722538e-02 1 1  ON 3
 uu_4                -6.526189e-02 1 1  ON 4
 uu_5                -1.000158e-01 1 1  ON 5
 uu_6                -1.261436e-01 1 1  ON 6
 uu_7                -1.384128e-01 1 1  ON 7
 uu_8                -1.299778e-01 1 1  ON 8
 uu_9                -9.919381e-02 1 1  ON 9
 ud_0                 4.290642e-01 1 1  ON 10
 ud_1                 1.735044e-01 1 1  ON 11
 ud_2                 6.265555e-02 1 1  ON 12
 ud_3                -4.432680e-03 1 1  ON 13
 ud_4                -5.965643e-02 1 1  ON 14
 ud_5                -1.020310e-01 1 1  ON 15
 ud_6                -1.298540e-01 1 1  ON 16
 ud_7                -1.481802e-01 1 1  ON 17
 ud_8                -1.523676e-01 1 1  ON 18
 ud_9                -1.415810e-01 1 1  ON 19
 eO_0                -7.465175e-01 1 1  ON 20
 eO_1                -4.329890e-01 1 1  ON 21
 eO_2                -1.891168e-02 1 1  ON 22
 eO_3                 2.984352e-01 1 1  ON 23
 eO_4                 5.170180e-01 1 1  ON 24
 eO_5                 4.717610e-01 1 1  ON 25
 eO_6                 2.416844e-01 1 1  ON 26
 eO_7                -5.330230e-02 1 1  ON 27
 eO_8                -2.101334e-01 1 1  ON 28
 eO_9                -6.834216e-02 1 1  ON 29
eH1_0                -2.422516e-01 1 1  ON 30
eH1_1                -1.388069e-01 1 1  ON 31
eH1_2                -9.662231e-02 1 1  ON 32
eH1_3                -4.461900e-02 1 1  ON 33
eH1_4                 1.154797e-02 1 1  ON 34
eH1_5                 4.891447e-02 1 1  ON 35
eH1_6                 1.058053e-01 1 1  ON 36
eH1_7                 1.521152e-01 1 1  ON 37
eH1_8                 1.612869e-01 1 1  ON 38
eH1_9                 4.608695e-02 1 1  ON 39
eH2_0                -2.414020e-01 1 1  ON 40
eH2_1                -1.375022e-01 1 1  ON 41
eH2_2                -9.518958e-02 1 1  ON 42
eH2_3                -4.317846e-02 1 1  ON 43
eH2_4                 1.343747e-02 1 1  ON 44
eH2_5                 5.149845e-02 1 1  ON 45
eH2_6                 1.092928e-01 1 1  ON 46
eH2_7                 1.575255e-01 1 1  ON 47
eH2_8                 1.703592e-01 1 1  ON 48
eH2_9                 3.215393e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.593022
====================================================
  Execution time = 2.7709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4402e-01
  Total weights = 2.0000e+06
  Execution time = 3.4441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343755233677
                                         uncertainty =       0.007062805206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343755233677
                                         uncertainty =       0.007062805206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414549084
  error estimate for blocks of size 2^( 2) =       0.000426498660
  error estimate for blocks of size 2^( 3) =       0.000439334786
  error estimate for blocks of size 2^( 4) =       0.000451987919
  error estimate for blocks of size 2^( 5) =       0.000464001226
  error estimate for blocks of size 2^( 6) =       0.000471817189
  error estimate for blocks of size 2^( 7) =       0.000476347975

      target function =                  N/A
              le_mean =     -16.909536818873
             les_mean =     286.276137143193
             stat err =       0.000466038577
             autocorr =       1.263839183921
              std dev =       0.586260936978
             le_variance =       0.343701886227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344621804893
                                         uncertainty =       0.007052203916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344621804893
                                         uncertainty =       0.007052203916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415071304
  error estimate for blocks of size 2^( 2) =       0.000427003783
  error estimate for blocks of size 2^( 3) =       0.000439784197
  error estimate for blocks of size 2^( 4) =       0.000452366297
  error estimate for blocks of size 2^( 5) =       0.000464321291
  error estimate for blocks of size 2^( 6) =       0.000472107454
  error estimate for blocks of size 2^( 7) =       0.000476599653

      target function =                  N/A
              le_mean =     -16.909529187034
             les_mean =     286.276745529986
             stat err =       0.000466348674
             autocorr =       1.262339211713
              std dev =       0.586999467736
             le_variance =       0.344568375123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344406287559
                                         uncertainty =       0.007049586309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344406287559
                                         uncertainty =       0.007049586309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414941468
  error estimate for blocks of size 2^( 2) =       0.000426878154
  error estimate for blocks of size 2^( 3) =       0.000439673598
  error estimate for blocks of size 2^( 4) =       0.000452278498
  error estimate for blocks of size 2^( 5) =       0.000464253718
  error estimate for blocks of size 2^( 6) =       0.000472044911
  error estimate for blocks of size 2^( 7) =       0.000476550319

      target function =                  N/A
              le_mean =     -16.909530362825
             les_mean =     286.276569762773
             stat err =       0.000466281862
             autocorr =       1.262767411330
              std dev =       0.586815851566
             le_variance =       0.344352843649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343826751109
                                         uncertainty =       0.007059553914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343826751109
                                         uncertainty =       0.007059553914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414592204
  error estimate for blocks of size 2^( 2) =       0.000426539684
  error estimate for blocks of size 2^( 3) =       0.000439369668
  error estimate for blocks of size 2^( 4) =       0.000452016288
  error estimate for blocks of size 2^( 5) =       0.000464025724
  error estimate for blocks of size 2^( 6) =       0.000471837069
  error estimate for blocks of size 2^( 7) =       0.000476366093

      target function =                  N/A
              le_mean =     -16.909534277257
             les_mean =     286.276122692354
             stat err =       0.000466061294
             autocorr =       1.263699491720
              std dev =       0.586321917140
             le_variance =       0.343773390519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909536818873        initial  <--
     1.5259e-02     1.5259e-01             1.5543e-02       -16.909529187034
     6.1035e-02     6.1035e-01             3.9854e-03       -16.909530362825
     2.4414e-01     2.4414e+00             1.0978e-03       -16.909534277257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2722
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.096581e-01 1 1  ON 0
 uu_1                 1.440756e-01 1 1  ON 1
 uu_2                 4.522219e-02 1 1  ON 2
 uu_3                -1.746513e-02 1 1  ON 3
 uu_4                -6.532055e-02 1 1  ON 4
 uu_5                -9.975825e-02 1 1  ON 5
 uu_6                -1.256748e-01 1 1  ON 6
 uu_7                -1.377526e-01 1 1  ON 7
 uu_8                -1.289752e-01 1 1  ON 8
 uu_9                -9.699956e-02 1 1  ON 9
 ud_0                 4.273419e-01 1 1  ON 10
 ud_1                 1.719976e-01 1 1  ON 11
 ud_2                 6.132190e-02 1 1  ON 12
 ud_3                -5.212997e-03 1 1  ON 13
 ud_4                -6.002880e-02 1 1  ON 14
 ud_5                -1.015604e-01 1 1  ON 15
 ud_6                -1.300745e-01 1 1  ON 16
 ud_7                -1.476950e-01 1 1  ON 17
 ud_8                -1.510793e-01 1 1  ON 18
 ud_9                -1.395296e-01 1 1  ON 19
 eO_0                -7.449976e-01 1 1  ON 20
 eO_1                -4.316832e-01 1 1  ON 21
 eO_2                -1.829605e-02 1 1  ON 22
 eO_3                 2.973117e-01 1 1  ON 23
 eO_4                 5.148476e-01 1 1  ON 24
 eO_5                 4.691152e-01 1 1  ON 25
 eO_6                 2.394362e-01 1 1  ON 26
 eO_7                -5.432864e-02 1 1  ON 27
 eO_8                -2.072223e-01 1 1  ON 28
 eO_9                -6.578646e-02 1 1  ON 29
eH1_0                -2.400734e-01 1 1  ON 30
eH1_1                -1.361376e-01 1 1  ON 31
eH1_2                -9.430658e-02 1 1  ON 32
eH1_3                -4.281264e-02 1 1  ON 33
eH1_4                 1.297137e-02 1 1  ON 34
eH1_5                 4.919061e-02 1 1  ON 35
eH1_6                 1.054837e-01 1 1  ON 36
eH1_7                 1.489229e-01 1 1  ON 37
eH1_8                 1.573015e-01 1 1  ON 38
eH1_9                 4.324487e-02 1 1  ON 39
eH2_0                -2.381292e-01 1 1  ON 40
eH2_1                -1.351037e-01 1 1  ON 41
eH2_2                -9.322283e-02 1 1  ON 42
eH2_3                -4.179821e-02 1 1  ON 43
eH2_4                 1.421181e-02 1 1  ON 44
eH2_5                 5.175458e-02 1 1  ON 45
eH2_6                 1.074354e-01 1 1  ON 46
eH2_7                 1.552285e-01 1 1  ON 47
eH2_8                 1.678570e-01 1 1  ON 48
eH2_9                 2.889476e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.961
    reference variance = 0.267343
====================================================
  Execution time = 2.8467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5150e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351556712563
                                         uncertainty =       0.013405418605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351556712563
                                         uncertainty =       0.013405418605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419227709
  error estimate for blocks of size 2^( 2) =       0.000431179068
  error estimate for blocks of size 2^( 3) =       0.000443665221
  error estimate for blocks of size 2^( 4) =       0.000455505411
  error estimate for blocks of size 2^( 5) =       0.000465442489
  error estimate for blocks of size 2^( 6) =       0.000473141257
  error estimate for blocks of size 2^( 7) =       0.000476842105

      target function =                  N/A
              le_mean =     -16.909017707086
             les_mean =     286.266383386919
             stat err =       0.000467732816
             autocorr =       1.244788941894
              std dev =       0.592877511908
             le_variance =       0.351503744126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690901770709e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909017707086       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909016807850       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909016849923       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909019775383       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909023695639       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909024299849       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909023814402       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909023883478       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909023688184       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909023519903       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909023420916       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.700348e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909017707086       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909017323506       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909017214023       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909018137480       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909019268366       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909019638901       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909019249037       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909019290031       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909019200626       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.261097e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909017707086       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909017590629       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909017528290       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909017765730       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909018003601       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909018139684       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909018058575       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909018058442       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.055437e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5620e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.095861e-01 1 1  ON 0
 uu_1                 1.440311e-01 1 1  ON 1
 uu_2                 4.532154e-02 1 1  ON 2
 uu_3                -1.746082e-02 1 1  ON 3
 uu_4                -6.528442e-02 1 1  ON 4
 uu_5                -9.990952e-02 1 1  ON 5
 uu_6                -1.256886e-01 1 1  ON 6
 uu_7                -1.377027e-01 1 1  ON 7
 uu_8                -1.291671e-01 1 1  ON 8
 uu_9                -9.716474e-02 1 1  ON 9
 ud_0                 4.274171e-01 1 1  ON 10
 ud_1                 1.721508e-01 1 1  ON 11
 ud_2                 6.137281e-02 1 1  ON 12
 ud_3                -5.162129e-03 1 1  ON 13
 ud_4                -6.000552e-02 1 1  ON 14
 ud_5                -1.016132e-01 1 1  ON 15
 ud_6                -1.301362e-01 1 1  ON 16
 ud_7                -1.477569e-01 1 1  ON 17
 ud_8                -1.511626e-01 1 1  ON 18
 ud_9                -1.396317e-01 1 1  ON 19
 eO_0                -7.451859e-01 1 1  ON 20
 eO_1                -4.318768e-01 1 1  ON 21
 eO_2                -1.838024e-02 1 1  ON 22
 eO_3                 2.974189e-01 1 1  ON 23
 eO_4                 5.152276e-01 1 1  ON 24
 eO_5                 4.693246e-01 1 1  ON 25
 eO_6                 2.396798e-01 1 1  ON 26
 eO_7                -5.425192e-02 1 1  ON 27
 eO_8                -2.075386e-01 1 1  ON 28
 eO_9                -6.600434e-02 1 1  ON 29
eH1_0                -2.402570e-01 1 1  ON 30
eH1_1                -1.364645e-01 1 1  ON 31
eH1_2                -9.461745e-02 1 1  ON 32
eH1_3                -4.310134e-02 1 1  ON 33
eH1_4                 1.298601e-02 1 1  ON 34
eH1_5                 4.914249e-02 1 1  ON 35
eH1_6                 1.054934e-01 1 1  ON 36
eH1_7                 1.492786e-01 1 1  ON 37
eH1_8                 1.577276e-01 1 1  ON 38
eH1_9                 4.357586e-02 1 1  ON 39
eH2_0                -2.384306e-01 1 1  ON 40
eH2_1                -1.354328e-01 1 1  ON 41
eH2_2                -9.344600e-02 1 1  ON 42
eH2_3                -4.189428e-02 1 1  ON 43
eH2_4                 1.417086e-02 1 1  ON 44
eH2_5                 5.167395e-02 1 1  ON 45
eH2_6                 1.075723e-01 1 1  ON 46
eH2_7                 1.553403e-01 1 1  ON 47
eH2_8                 1.682223e-01 1 1  ON 48
eH2_9                 2.927921e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8846
    reference variance = 0.491385
====================================================
  Execution time = 2.7700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4216e-01
  Total weights = 2.0000e+06
  Execution time = 3.4422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235491839
                                         uncertainty =       0.005349922105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342235491839
                                         uncertainty =       0.005349922105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413647948
  error estimate for blocks of size 2^( 2) =       0.000425906398
  error estimate for blocks of size 2^( 3) =       0.000439383652
  error estimate for blocks of size 2^( 4) =       0.000452000457
  error estimate for blocks of size 2^( 5) =       0.000463481545
  error estimate for blocks of size 2^( 6) =       0.000472011492
  error estimate for blocks of size 2^( 7) =       0.000477772516

      target function =                  N/A
              le_mean =     -16.909087701557
             les_mean =     286.259455977916
             stat err =       0.000466316503
             autocorr =       1.270866176640
              std dev =       0.584986538377
             le_variance =       0.342209250082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342224816856
                                         uncertainty =       0.005350974639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342224816856
                                         uncertainty =       0.005350974639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413641464
  error estimate for blocks of size 2^( 2) =       0.000425902777
  error estimate for blocks of size 2^( 3) =       0.000439375487
  error estimate for blocks of size 2^( 4) =       0.000451987969
  error estimate for blocks of size 2^( 5) =       0.000463461876
  error estimate for blocks of size 2^( 6) =       0.000471981574
  error estimate for blocks of size 2^( 7) =       0.000477750279

      target function =                  N/A
              le_mean =     -16.909090193078
             les_mean =     286.259529508433
             stat err =       0.000466295425
             autocorr =       1.270791129632
              std dev =       0.584977368696
             le_variance =       0.342198521886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342136153009
                                         uncertainty =       0.005349877385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342136153009
                                         uncertainty =       0.005349877385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413587832
  error estimate for blocks of size 2^( 2) =       0.000425850197
  error estimate for blocks of size 2^( 3) =       0.000439326499
  error estimate for blocks of size 2^( 4) =       0.000451943962
  error estimate for blocks of size 2^( 5) =       0.000463423256
  error estimate for blocks of size 2^( 6) =       0.000471949685
  error estimate for blocks of size 2^( 7) =       0.000477718550

      target function =                  N/A
              le_mean =     -16.909089473988
             les_mean =     286.259416457326
             stat err =       0.000466258863
             autocorr =       1.270921409556
              std dev =       0.584901520801
             le_variance =       0.342109789036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208510300
                                         uncertainty =       0.005349731644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208510300
                                         uncertainty =       0.005349731644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413631625
  error estimate for blocks of size 2^( 2) =       0.000425890862
  error estimate for blocks of size 2^( 3) =       0.000439368197
  error estimate for blocks of size 2^( 4) =       0.000451985471
  error estimate for blocks of size 2^( 5) =       0.000463466786
  error estimate for blocks of size 2^( 6) =       0.000471996648
  error estimate for blocks of size 2^( 7) =       0.000477758970

      target function =                  N/A
              le_mean =     -16.909087872051
             les_mean =     286.259434736025
             stat err =       0.000466301969
             autocorr =       1.270887259609
              std dev =       0.584963453871
             le_variance =       0.342182242364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909087701557        initial
     1.5259e-01     1.5259e+00             1.7003e-03       -16.909090193078  <--
     6.1035e-01     6.1035e+00             4.2611e-04       -16.909089473988
     2.4414e+00     2.4414e+01             1.0554e-04       -16.909087872051

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 4.5148e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.095772e-01 1 1  ON 0
 uu_1                 1.440720e-01 1 1  ON 1
 uu_2                 4.544017e-02 1 1  ON 2
 uu_3                -1.744600e-02 1 1  ON 3
 uu_4                -6.533433e-02 1 1  ON 4
 uu_5                -1.001914e-01 1 1  ON 5
 uu_6                -1.258709e-01 1 1  ON 6
 uu_7                -1.377378e-01 1 1  ON 7
 uu_8                -1.296548e-01 1 1  ON 8
 uu_9                -9.763447e-02 1 1  ON 9
 ud_0                 4.277088e-01 1 1  ON 10
 ud_1                 1.724707e-01 1 1  ON 11
 ud_2                 6.158336e-02 1 1  ON 12
 ud_3                -5.021787e-03 1 1  ON 13
 ud_4                -5.996174e-02 1 1  ON 14
 ud_5                -1.017206e-01 1 1  ON 15
 ud_6                -1.303071e-01 1 1  ON 16
 ud_7                -1.479769e-01 1 1  ON 17
 ud_8                -1.513977e-01 1 1  ON 18
 ud_9                -1.399259e-01 1 1  ON 19
 eO_0                -7.457005e-01 1 1  ON 20
 eO_1                -4.323691e-01 1 1  ON 21
 eO_2                -1.859881e-02 1 1  ON 22
 eO_3                 2.977204e-01 1 1  ON 23
 eO_4                 5.161837e-01 1 1  ON 24
 eO_5                 4.700067e-01 1 1  ON 25
 eO_6                 2.403753e-01 1 1  ON 26
 eO_7                -5.402438e-02 1 1  ON 27
 eO_8                -2.084703e-01 1 1  ON 28
 eO_9                -6.665899e-02 1 1  ON 29
eH1_0                -2.409087e-01 1 1  ON 30
eH1_1                -1.373344e-01 1 1  ON 31
eH1_2                -9.540263e-02 1 1  ON 32
eH1_3                -4.382103e-02 1 1  ON 33
eH1_4                 1.272776e-02 1 1  ON 34
eH1_5                 4.898548e-02 1 1  ON 35
eH1_6                 1.055617e-01 1 1  ON 36
eH1_7                 1.503080e-01 1 1  ON 37
eH1_8                 1.590018e-01 1 1  ON 38
eH1_9                 4.457981e-02 1 1  ON 39
eH2_0                -2.392325e-01 1 1  ON 40
eH2_1                -1.362125e-01 1 1  ON 41
eH2_2                -9.408061e-02 1 1  ON 42
eH2_3                -4.231732e-02 1 1  ON 43
eH2_4                 1.392696e-02 1 1  ON 44
eH2_5                 5.139819e-02 1 1  ON 45
eH2_6                 1.079163e-01 1 1  ON 46
eH2_7                 1.556799e-01 1 1  ON 47
eH2_8                 1.693181e-01 1 1  ON 48
eH2_9                 3.043817e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0775e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.02
    reference variance = 0.325442
====================================================
  Execution time = 2.8268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4011e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340105719807
                                         uncertainty =       0.004032347242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340105719807
                                         uncertainty =       0.004032347242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412379949
  error estimate for blocks of size 2^( 2) =       0.000424022254
  error estimate for blocks of size 2^( 3) =       0.000436349241
  error estimate for blocks of size 2^( 4) =       0.000447944168
  error estimate for blocks of size 2^( 5) =       0.000458958764
  error estimate for blocks of size 2^( 6) =       0.000468187671
  error estimate for blocks of size 2^( 7) =       0.000472919427

      target function =                  N/A
              le_mean =     -16.909599916320
             les_mean =     286.274683604977
             stat err =       0.000462002508
             autocorr =       1.255144085385
              std dev =       0.583193317023
             le_variance =       0.340114445021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690959991632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909599916320       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909600017767       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909606503427       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909608548631       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909608259559       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909613909952       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909616557228       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909620082638       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909619805138       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909620332589       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909619251351       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909619733046       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909619735300       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909620307419       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909620360445       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909620117686       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 5.624672e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909599916320       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909599984628       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909603638607       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909605101475       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909604825769       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909607082241       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909606824274       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909607288630       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909607626631       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909607223587       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909607259798       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909607130946       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.414495e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909599916320       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909599945933       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909601293294       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909601896421       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909602153561       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909602630682       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909602337299       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909602526016       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909602497345       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.553837e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5434e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.098762e-01 1 1  ON 0
 uu_1                 1.447239e-01 1 1  ON 1
 uu_2                 4.595283e-02 1 1  ON 2
 uu_3                -1.686221e-02 1 1  ON 3
 uu_4                -6.501706e-02 1 1  ON 4
 uu_5                -1.001220e-01 1 1  ON 5
 uu_6                -1.265080e-01 1 1  ON 6
 uu_7                -1.384425e-01 1 1  ON 7
 uu_8                -1.304583e-01 1 1  ON 8
 uu_9                -9.883494e-02 1 1  ON 9
 ud_0                 4.277977e-01 1 1  ON 10
 ud_1                 1.726940e-01 1 1  ON 11
 ud_2                 6.182213e-02 1 1  ON 12
 ud_3                -4.794582e-03 1 1  ON 13
 ud_4                -5.999593e-02 1 1  ON 14
 ud_5                -1.015816e-01 1 1  ON 15
 ud_6                -1.298845e-01 1 1  ON 16
 ud_7                -1.481501e-01 1 1  ON 17
 ud_8                -1.514098e-01 1 1  ON 18
 ud_9                -1.405990e-01 1 1  ON 19
 eO_0                -7.460873e-01 1 1  ON 20
 eO_1                -4.324163e-01 1 1  ON 21
 eO_2                -1.885062e-02 1 1  ON 22
 eO_3                 2.981495e-01 1 1  ON 23
 eO_4                 5.167520e-01 1 1  ON 24
 eO_5                 4.712881e-01 1 1  ON 25
 eO_6                 2.407916e-01 1 1  ON 26
 eO_7                -5.391662e-02 1 1  ON 27
 eO_8                -2.095989e-01 1 1  ON 28
 eO_9                -6.754702e-02 1 1  ON 29
eH1_0                -2.419565e-01 1 1  ON 30
eH1_1                -1.383317e-01 1 1  ON 31
eH1_2                -9.630540e-02 1 1  ON 32
eH1_3                -4.421089e-02 1 1  ON 33
eH1_4                 1.209308e-02 1 1  ON 34
eH1_5                 4.955916e-02 1 1  ON 35
eH1_6                 1.059260e-01 1 1  ON 36
eH1_7                 1.512974e-01 1 1  ON 37
eH1_8                 1.604163e-01 1 1  ON 38
eH1_9                 4.534984e-02 1 1  ON 39
eH2_0                -2.399435e-01 1 1  ON 40
eH2_1                -1.368199e-01 1 1  ON 41
eH2_2                -9.462725e-02 1 1  ON 42
eH2_3                -4.289169e-02 1 1  ON 43
eH2_4                 1.331969e-02 1 1  ON 44
eH2_5                 5.097292e-02 1 1  ON 45
eH2_6                 1.083463e-01 1 1  ON 46
eH2_7                 1.561797e-01 1 1  ON 47
eH2_8                 1.704497e-01 1 1  ON 48
eH2_9                 3.175889e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8783
    reference variance = 0.225192
====================================================
  Execution time = 2.7702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.6275e-01
  Total weights = 2.0000e+06
  Execution time = 3.4339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363036245232
                                         uncertainty =       0.027802612166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363036245232
                                         uncertainty =       0.027802612166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425997336
  error estimate for blocks of size 2^( 2) =       0.000437586359
  error estimate for blocks of size 2^( 3) =       0.000450017943
  error estimate for blocks of size 2^( 4) =       0.000462072274
  error estimate for blocks of size 2^( 5) =       0.000471105171
  error estimate for blocks of size 2^( 6) =       0.000479608947
  error estimate for blocks of size 2^( 7) =       0.000482792693

      target function =                  N/A
              le_mean =     -16.909935131004
             les_mean =     286.308853414463
             stat err =       0.000473894771
             autocorr =       1.237513845726
              std dev =       0.602451210614
             le_variance =       0.362947461170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362942254352
                                         uncertainty =       0.027682306288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362942254352
                                         uncertainty =       0.027682306288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425942006
  error estimate for blocks of size 2^( 2) =       0.000437527175
  error estimate for blocks of size 2^( 3) =       0.000449944825
  error estimate for blocks of size 2^( 4) =       0.000461978070
  error estimate for blocks of size 2^( 5) =       0.000470988432
  error estimate for blocks of size 2^( 6) =       0.000479478831
  error estimate for blocks of size 2^( 7) =       0.000482662914

      target function =                  N/A
              le_mean =     -16.909933365268
             les_mean =     286.308699420948
             stat err =       0.000473777062
             autocorr =       1.237220527236
              std dev =       0.602372961355
             le_variance =       0.362853184572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362653797288
                                         uncertainty =       0.027635125579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362653797288
                                         uncertainty =       0.027635125579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425772817
  error estimate for blocks of size 2^( 2) =       0.000437365481
  error estimate for blocks of size 2^( 3) =       0.000449794360
  error estimate for blocks of size 2^( 4) =       0.000461839730
  error estimate for blocks of size 2^( 5) =       0.000470864126
  error estimate for blocks of size 2^( 6) =       0.000479363403
  error estimate for blocks of size 2^( 7) =       0.000482557189

      target function =                  N/A
              le_mean =     -16.909933706799
             les_mean =     286.308422770619
             stat err =       0.000473656112
             autocorr =       1.237571869703
              std dev =       0.602133692446
             le_variance =       0.362564983579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362913530361
                                         uncertainty =       0.027758633012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362913530361
                                         uncertainty =       0.027758633012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425925329
  error estimate for blocks of size 2^( 2) =       0.000437515975
  error estimate for blocks of size 2^( 3) =       0.000449948329
  error estimate for blocks of size 2^( 4) =       0.000462002039
  error estimate for blocks of size 2^( 5) =       0.000471034781
  error estimate for blocks of size 2^( 6) =       0.000479538088
  error estimate for blocks of size 2^( 7) =       0.000482725510

      target function =                  N/A
              le_mean =     -16.909934427604
             les_mean =     286.308706935933
             stat err =       0.000473825105
             autocorr =       1.237568365328
              std dev =       0.602349376592
             le_variance =       0.362824771480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909935131004        initial  <--
     3.8147e-02     3.8147e-01             5.6247e-03       -16.909933365268
     1.5259e-01     1.5259e+00             1.4145e-03       -16.909933706799
     6.1035e-01     6.1035e+00             3.5538e-04       -16.909934427604

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1304
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.095772e-01 1 1  ON 0
 uu_1                 1.440720e-01 1 1  ON 1
 uu_2                 4.544017e-02 1 1  ON 2
 uu_3                -1.744600e-02 1 1  ON 3
 uu_4                -6.533433e-02 1 1  ON 4
 uu_5                -1.001914e-01 1 1  ON 5
 uu_6                -1.258709e-01 1 1  ON 6
 uu_7                -1.377378e-01 1 1  ON 7
 uu_8                -1.296548e-01 1 1  ON 8
 uu_9                -9.763447e-02 1 1  ON 9
 ud_0                 4.277088e-01 1 1  ON 10
 ud_1                 1.724707e-01 1 1  ON 11
 ud_2                 6.158336e-02 1 1  ON 12
 ud_3                -5.021787e-03 1 1  ON 13
 ud_4                -5.996174e-02 1 1  ON 14
 ud_5                -1.017206e-01 1 1  ON 15
 ud_6                -1.303071e-01 1 1  ON 16
 ud_7                -1.479769e-01 1 1  ON 17
 ud_8                -1.513977e-01 1 1  ON 18
 ud_9                -1.399259e-01 1 1  ON 19
 eO_0                -7.457005e-01 1 1  ON 20
 eO_1                -4.323691e-01 1 1  ON 21
 eO_2                -1.859881e-02 1 1  ON 22
 eO_3                 2.977204e-01 1 1  ON 23
 eO_4                 5.161837e-01 1 1  ON 24
 eO_5                 4.700067e-01 1 1  ON 25
 eO_6                 2.403753e-01 1 1  ON 26
 eO_7                -5.402438e-02 1 1  ON 27
 eO_8                -2.084703e-01 1 1  ON 28
 eO_9                -6.665899e-02 1 1  ON 29
eH1_0                -2.409087e-01 1 1  ON 30
eH1_1                -1.373344e-01 1 1  ON 31
eH1_2                -9.540263e-02 1 1  ON 32
eH1_3                -4.382103e-02 1 1  ON 33
eH1_4                 1.272776e-02 1 1  ON 34
eH1_5                 4.898548e-02 1 1  ON 35
eH1_6                 1.055617e-01 1 1  ON 36
eH1_7                 1.503080e-01 1 1  ON 37
eH1_8                 1.590018e-01 1 1  ON 38
eH1_9                 4.457981e-02 1 1  ON 39
eH2_0                -2.392325e-01 1 1  ON 40
eH2_1                -1.362125e-01 1 1  ON 41
eH2_2                -9.408061e-02 1 1  ON 42
eH2_3                -4.231732e-02 1 1  ON 43
eH2_4                 1.392696e-02 1 1  ON 44
eH2_5                 5.139819e-02 1 1  ON 45
eH2_6                 1.079163e-01 1 1  ON 46
eH2_7                 1.556799e-01 1 1  ON 47
eH2_8                 1.693181e-01 1 1  ON 48
eH2_9                 3.043817e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0571e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8569
    reference variance = 0.200735
====================================================
  Execution time = 2.8533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3875e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338818563270
                                         uncertainty =       0.003973634728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338818563270
                                         uncertainty =       0.003973634728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411551298
  error estimate for blocks of size 2^( 2) =       0.000423549293
  error estimate for blocks of size 2^( 3) =       0.000436004560
  error estimate for blocks of size 2^( 4) =       0.000448007584
  error estimate for blocks of size 2^( 5) =       0.000458830133
  error estimate for blocks of size 2^( 6) =       0.000467387923
  error estimate for blocks of size 2^( 7) =       0.000473397561

      target function =                  N/A
              le_mean =     -16.909473186803
             les_mean =     286.269032228230
             stat err =       0.000461905801
             autocorr =       1.259676072043
              std dev =       0.582021427787
             le_variance =       0.338748942403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690947318680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909473186803       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909473714877       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909473483369       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909474900848       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909477740870       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909477993636       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909477498526       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909477102367       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909477090819       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909477151296       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 7.663589e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909473186803       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909473379987       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909473241762       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909473486602       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909474183917       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909474509871       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909474361176       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909474265583       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909474265374       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.922767e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909473186803       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909473241426       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909473197329       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909473243235       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909473394724       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909473495675       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909473470835       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909473451762       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.769904e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5679e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.095667e-01 1 1  ON 0
 uu_1                 1.440916e-01 1 1  ON 1
 uu_2                 4.546711e-02 1 1  ON 2
 uu_3                -1.741025e-02 1 1  ON 3
 uu_4                -6.538081e-02 1 1  ON 4
 uu_5                -1.001433e-01 1 1  ON 5
 uu_6                -1.259338e-01 1 1  ON 6
 uu_7                -1.378042e-01 1 1  ON 7
 uu_8                -1.296693e-01 1 1  ON 8
 uu_9                -9.765744e-02 1 1  ON 9
 ud_0                 4.276302e-01 1 1  ON 10
 ud_1                 1.724665e-01 1 1  ON 11
 ud_2                 6.168399e-02 1 1  ON 12
 ud_3                -4.991017e-03 1 1  ON 13
 ud_4                -5.997296e-02 1 1  ON 14
 ud_5                -1.017269e-01 1 1  ON 15
 ud_6                -1.302977e-01 1 1  ON 16
 ud_7                -1.479815e-01 1 1  ON 17
 ud_8                -1.513625e-01 1 1  ON 18
 ud_9                -1.399707e-01 1 1  ON 19
 eO_0                -7.457322e-01 1 1  ON 20
 eO_1                -4.324631e-01 1 1  ON 21
 eO_2                -1.865761e-02 1 1  ON 22
 eO_3                 2.977917e-01 1 1  ON 23
 eO_4                 5.162860e-01 1 1  ON 24
 eO_5                 4.701201e-01 1 1  ON 25
 eO_6                 2.404281e-01 1 1  ON 26
 eO_7                -5.398394e-02 1 1  ON 27
 eO_8                -2.085675e-01 1 1  ON 28
 eO_9                -6.674067e-02 1 1  ON 29
eH1_0                -2.410736e-01 1 1  ON 30
eH1_1                -1.374478e-01 1 1  ON 31
eH1_2                -9.544163e-02 1 1  ON 32
eH1_3                -4.392146e-02 1 1  ON 33
eH1_4                 1.256153e-02 1 1  ON 34
eH1_5                 4.900252e-02 1 1  ON 35
eH1_6                 1.056454e-01 1 1  ON 36
eH1_7                 1.505003e-01 1 1  ON 37
eH1_8                 1.591864e-01 1 1  ON 38
eH1_9                 4.469481e-02 1 1  ON 39
eH2_0                -2.393393e-01 1 1  ON 40
eH2_1                -1.362879e-01 1 1  ON 41
eH2_2                -9.413984e-02 1 1  ON 42
eH2_3                -4.233985e-02 1 1  ON 43
eH2_4                 1.386598e-02 1 1  ON 44
eH2_5                 5.137768e-02 1 1  ON 45
eH2_6                 1.079812e-01 1 1  ON 46
eH2_7                 1.557111e-01 1 1  ON 47
eH2_8                 1.694327e-01 1 1  ON 48
eH2_9                 3.056299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9641
    reference variance = 0.325614
====================================================
  Execution time = 2.9851e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4278e-01
  Total weights = 2.0000e+06
  Execution time = 3.4628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342577062697
                                         uncertainty =       0.004353027613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342577062697
                                         uncertainty =       0.004353027613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414070859
  error estimate for blocks of size 2^( 2) =       0.000426471632
  error estimate for blocks of size 2^( 3) =       0.000439086387
  error estimate for blocks of size 2^( 4) =       0.000450723629
  error estimate for blocks of size 2^( 5) =       0.000461536630
  error estimate for blocks of size 2^( 6) =       0.000470666861
  error estimate for blocks of size 2^( 7) =       0.000476542289

      target function =                  N/A
              le_mean =     -16.908411363226
             les_mean =     286.237284008439
             stat err =       0.000464867352
             autocorr =       1.260401060759
              std dev =       0.585584623978
             le_variance =       0.342909351839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342273140567
                                         uncertainty =       0.004348865760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342273140567
                                         uncertainty =       0.004348865760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413887136
  error estimate for blocks of size 2^( 2) =       0.000426300383
  error estimate for blocks of size 2^( 3) =       0.000438924218
  error estimate for blocks of size 2^( 4) =       0.000450565699
  error estimate for blocks of size 2^( 5) =       0.000461383446
  error estimate for blocks of size 2^( 6) =       0.000470517328
  error estimate for blocks of size 2^( 7) =       0.000476395378

      target function =                  N/A
              le_mean =     -16.908409623508
             les_mean =     286.236920947504
             stat err =       0.000464715463
             autocorr =       1.260696044297
              std dev =       0.585324800821
             le_variance =       0.342605122456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342322737734
                                         uncertainty =       0.004349584282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342322737734
                                         uncertainty =       0.004349584282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413917134
  error estimate for blocks of size 2^( 2) =       0.000426327928
  error estimate for blocks of size 2^( 3) =       0.000438950215
  error estimate for blocks of size 2^( 4) =       0.000450591626
  error estimate for blocks of size 2^( 5) =       0.000461409334
  error estimate for blocks of size 2^( 6) =       0.000470543302
  error estimate for blocks of size 2^( 7) =       0.000476421435

      target function =                  N/A
              le_mean =     -16.908409948845
             les_mean =     286.236981614530
             stat err =       0.000464741424
             autocorr =       1.260654157481
              std dev =       0.585367224630
             le_variance =       0.342654787671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342537763479
                                         uncertainty =       0.004352492263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342537763479
                                         uncertainty =       0.004352492263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414047108
  error estimate for blocks of size 2^( 2) =       0.000426449393
  error estimate for blocks of size 2^( 3) =       0.000439065275
  error estimate for blocks of size 2^( 4) =       0.000450703148
  error estimate for blocks of size 2^( 5) =       0.000461516902
  error estimate for blocks of size 2^( 6) =       0.000470647736
  error estimate for blocks of size 2^( 7) =       0.000476523586

      target function =                  N/A
              le_mean =     -16.908411113104
             les_mean =     286.237236214069
             stat err =       0.000464847843
             autocorr =       1.260439859057
              std dev =       0.585551036000
             le_variance =       0.342870015760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908411363226        initial  <--
     3.8147e-01     3.8147e+00             7.6636e-04       -16.908409623508
     1.5259e+00     1.5259e+01             1.9228e-04       -16.908409948845
     6.1035e+00     6.1035e+01             4.7699e-05       -16.908411113104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.3575
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.095772e-01 1 1  ON 0
 uu_1                 1.440720e-01 1 1  ON 1
 uu_2                 4.544017e-02 1 1  ON 2
 uu_3                -1.744600e-02 1 1  ON 3
 uu_4                -6.533433e-02 1 1  ON 4
 uu_5                -1.001914e-01 1 1  ON 5
 uu_6                -1.258709e-01 1 1  ON 6
 uu_7                -1.377378e-01 1 1  ON 7
 uu_8                -1.296548e-01 1 1  ON 8
 uu_9                -9.763447e-02 1 1  ON 9
 ud_0                 4.277088e-01 1 1  ON 10
 ud_1                 1.724707e-01 1 1  ON 11
 ud_2                 6.158336e-02 1 1  ON 12
 ud_3                -5.021787e-03 1 1  ON 13
 ud_4                -5.996174e-02 1 1  ON 14
 ud_5                -1.017206e-01 1 1  ON 15
 ud_6                -1.303071e-01 1 1  ON 16
 ud_7                -1.479769e-01 1 1  ON 17
 ud_8                -1.513977e-01 1 1  ON 18
 ud_9                -1.399259e-01 1 1  ON 19
 eO_0                -7.457005e-01 1 1  ON 20
 eO_1                -4.323691e-01 1 1  ON 21
 eO_2                -1.859881e-02 1 1  ON 22
 eO_3                 2.977204e-01 1 1  ON 23
 eO_4                 5.161837e-01 1 1  ON 24
 eO_5                 4.700067e-01 1 1  ON 25
 eO_6                 2.403753e-01 1 1  ON 26
 eO_7                -5.402438e-02 1 1  ON 27
 eO_8                -2.084703e-01 1 1  ON 28
 eO_9                -6.665899e-02 1 1  ON 29
eH1_0                -2.409087e-01 1 1  ON 30
eH1_1                -1.373344e-01 1 1  ON 31
eH1_2                -9.540263e-02 1 1  ON 32
eH1_3                -4.382103e-02 1 1  ON 33
eH1_4                 1.272776e-02 1 1  ON 34
eH1_5                 4.898548e-02 1 1  ON 35
eH1_6                 1.055617e-01 1 1  ON 36
eH1_7                 1.503080e-01 1 1  ON 37
eH1_8                 1.590018e-01 1 1  ON 38
eH1_9                 4.457981e-02 1 1  ON 39
eH2_0                -2.392325e-01 1 1  ON 40
eH2_1                -1.362125e-01 1 1  ON 41
eH2_2                -9.408061e-02 1 1  ON 42
eH2_3                -4.231732e-02 1 1  ON 43
eH2_4                 1.392696e-02 1 1  ON 44
eH2_5                 5.139819e-02 1 1  ON 45
eH2_6                 1.079163e-01 1 1  ON 46
eH2_7                 1.556799e-01 1 1  ON 47
eH2_8                 1.693181e-01 1 1  ON 48
eH2_9                 3.043817e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9841
    reference variance = 0.352629
====================================================
  Execution time = 2.8423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4863e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348643312952
                                         uncertainty =       0.007495944418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348643312952
                                         uncertainty =       0.007495944418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417511383
  error estimate for blocks of size 2^( 2) =       0.000429204789
  error estimate for blocks of size 2^( 3) =       0.000442046339
  error estimate for blocks of size 2^( 4) =       0.000452910959
  error estimate for blocks of size 2^( 5) =       0.000463096527
  error estimate for blocks of size 2^( 6) =       0.000471252489
  error estimate for blocks of size 2^( 7) =       0.000474791290

      target function =                  N/A
              le_mean =     -16.909438584385
             les_mean =     286.277744575470
             stat err =       0.000465512816
             autocorr =       1.243158896679
              std dev =       0.590450260978
             le_variance =       0.348631510689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690943858439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909438584385       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909438677340       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909438696931       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909438657700       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909438820185       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909438855876       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909438814309       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909438811019       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.878019e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909438584385       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909438608279       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909438613756       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909438602985       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909438649042       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909438657185       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909438644151       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909438645410       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.483038e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909438584385       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909438590401       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909438591811       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909438589072       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909438600936       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909438602940       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909438599492       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909438599928       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.734168e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5567e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.095809e-01 1 1  ON 0
 uu_1                 1.440764e-01 1 1  ON 1
 uu_2                 4.544526e-02 1 1  ON 2
 uu_3                -1.744132e-02 1 1  ON 3
 uu_4                -6.533698e-02 1 1  ON 4
 uu_5                -1.001913e-01 1 1  ON 5
 uu_6                -1.258687e-01 1 1  ON 6
 uu_7                -1.377457e-01 1 1  ON 7
 uu_8                -1.296624e-01 1 1  ON 8
 uu_9                -9.764431e-02 1 1  ON 9
 ud_0                 4.277146e-01 1 1  ON 10
 ud_1                 1.724739e-01 1 1  ON 11
 ud_2                 6.159782e-02 1 1  ON 12
 ud_3                -5.014102e-03 1 1  ON 13
 ud_4                -5.996034e-02 1 1  ON 14
 ud_5                -1.017121e-01 1 1  ON 15
 ud_6                -1.303030e-01 1 1  ON 16
 ud_7                -1.479900e-01 1 1  ON 17
 ud_8                -1.514124e-01 1 1  ON 18
 ud_9                -1.399380e-01 1 1  ON 19
 eO_0                -7.456917e-01 1 1  ON 20
 eO_1                -4.323747e-01 1 1  ON 21
 eO_2                -1.860042e-02 1 1  ON 22
 eO_3                 2.977195e-01 1 1  ON 23
 eO_4                 5.161897e-01 1 1  ON 24
 eO_5                 4.700194e-01 1 1  ON 25
 eO_6                 2.403806e-01 1 1  ON 26
 eO_7                -5.402421e-02 1 1  ON 27
 eO_8                -2.084833e-01 1 1  ON 28
 eO_9                -6.666937e-02 1 1  ON 29
eH1_0                -2.409124e-01 1 1  ON 30
eH1_1                -1.373492e-01 1 1  ON 31
eH1_2                -9.540561e-02 1 1  ON 32
eH1_3                -4.382679e-02 1 1  ON 33
eH1_4                 1.272007e-02 1 1  ON 34
eH1_5                 4.898744e-02 1 1  ON 35
eH1_6                 1.055653e-01 1 1  ON 36
eH1_7                 1.503165e-01 1 1  ON 37
eH1_8                 1.590144e-01 1 1  ON 38
eH1_9                 4.458902e-02 1 1  ON 39
eH2_0                -2.392440e-01 1 1  ON 40
eH2_1                -1.362235e-01 1 1  ON 41
eH2_2                -9.409087e-02 1 1  ON 42
eH2_3                -4.232312e-02 1 1  ON 43
eH2_4                 1.392805e-02 1 1  ON 44
eH2_5                 5.140240e-02 1 1  ON 45
eH2_6                 1.079249e-01 1 1  ON 46
eH2_7                 1.556817e-01 1 1  ON 47
eH2_8                 1.693268e-01 1 1  ON 48
eH2_9                 3.045232e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8859
    reference variance = 0.333754
====================================================
  Execution time = 2.8003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4638e-01
  Total weights = 2.0000e+06
  Execution time = 3.4559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346518956881
                                         uncertainty =       0.005884680643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346518956881
                                         uncertainty =       0.005884680643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416166368
  error estimate for blocks of size 2^( 2) =       0.000428640158
  error estimate for blocks of size 2^( 3) =       0.000440612129
  error estimate for blocks of size 2^( 4) =       0.000453717826
  error estimate for blocks of size 2^( 5) =       0.000465161562
  error estimate for blocks of size 2^( 6) =       0.000474642753
  error estimate for blocks of size 2^( 7) =       0.000482907997

      target function =                  N/A
              le_mean =     -16.909053428807
             les_mean =     286.262476576457
             stat err =       0.000469107534
             autocorr =       1.270605867001
              std dev =       0.588548121558
             le_variance =       0.346388891389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346498451427
                                         uncertainty =       0.005884396943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346498451427
                                         uncertainty =       0.005884396943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416154058
  error estimate for blocks of size 2^( 2) =       0.000428627904
  error estimate for blocks of size 2^( 3) =       0.000440599945
  error estimate for blocks of size 2^( 4) =       0.000453705359
  error estimate for blocks of size 2^( 5) =       0.000465149128
  error estimate for blocks of size 2^( 6) =       0.000474629698
  error estimate for blocks of size 2^( 7) =       0.000482895437

      target function =                  N/A
              le_mean =     -16.909053690999
             les_mean =     286.262464951592
             stat err =       0.000469094906
             autocorr =       1.270612623265
              std dev =       0.588530712626
             le_variance =       0.346368399705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346508286230
                                         uncertainty =       0.005884531791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346508286230
                                         uncertainty =       0.005884531791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416159962
  error estimate for blocks of size 2^( 2) =       0.000428633790
  error estimate for blocks of size 2^( 3) =       0.000440605818
  error estimate for blocks of size 2^( 4) =       0.000453711386
  error estimate for blocks of size 2^( 5) =       0.000465155150
  error estimate for blocks of size 2^( 6) =       0.000474636026
  error estimate for blocks of size 2^( 7) =       0.000482901552

      target function =                  N/A
              le_mean =     -16.909053573676
             les_mean =     286.262470812520
             stat err =       0.000469101029
             autocorr =       1.270609739423
              std dev =       0.588539062656
             le_variance =       0.346378228272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346517608001
                                         uncertainty =       0.005884661799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346517608001
                                         uncertainty =       0.005884661799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416165558
  error estimate for blocks of size 2^( 2) =       0.000428639354
  error estimate for blocks of size 2^( 3) =       0.000440611332
  error estimate for blocks of size 2^( 4) =       0.000453717013
  error estimate for blocks of size 2^( 5) =       0.000465160753
  error estimate for blocks of size 2^( 6) =       0.000474641905
  error estimate for blocks of size 2^( 7) =       0.000482907185

      target function =                  N/A
              le_mean =     -16.909053447157
             les_mean =     286.262475849075
             stat err =       0.000469106714
             autocorr =       1.270606367239
              std dev =       0.588546976437
             le_variance =       0.346387543474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909053428807        initial
     3.8147e+00     3.8147e+01             5.8780e-05       -16.909053690999  <--
     1.5259e+01     1.5259e+02             1.4830e-05       -16.909053573676
     6.1035e+01     6.1035e+02             3.7342e-06       -16.909053447157

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.5519e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.095915e-01 1 1  ON 0
 uu_1                 1.440890e-01 1 1  ON 1
 uu_2                 4.546102e-02 1 1  ON 2
 uu_3                -1.742792e-02 1 1  ON 3
 uu_4                -6.534358e-02 1 1  ON 4
 uu_5                -1.001918e-01 1 1  ON 5
 uu_6                -1.258621e-01 1 1  ON 6
 uu_7                -1.377684e-01 1 1  ON 7
 uu_8                -1.296854e-01 1 1  ON 8
 uu_9                -9.767387e-02 1 1  ON 9
 ud_0                 4.277318e-01 1 1  ON 10
 ud_1                 1.724858e-01 1 1  ON 11
 ud_2                 6.163819e-02 1 1  ON 12
 ud_3                -4.990981e-03 1 1  ON 13
 ud_4                -5.995442e-02 1 1  ON 14
 ud_5                -1.016886e-01 1 1  ON 15
 ud_6                -1.302907e-01 1 1  ON 16
 ud_7                -1.480278e-01 1 1  ON 17
 ud_8                -1.514565e-01 1 1  ON 18
 ud_9                -1.399745e-01 1 1  ON 19
 eO_0                -7.456672e-01 1 1  ON 20
 eO_1                -4.323899e-01 1 1  ON 21
 eO_2                -1.860444e-02 1 1  ON 22
 eO_3                 2.977167e-01 1 1  ON 23
 eO_4                 5.162072e-01 1 1  ON 24
 eO_5                 4.700573e-01 1 1  ON 25
 eO_6                 2.403966e-01 1 1  ON 26
 eO_7                -5.402377e-02 1 1  ON 27
 eO_8                -2.085223e-01 1 1  ON 28
 eO_9                -6.670034e-02 1 1  ON 29
eH1_0                -2.409238e-01 1 1  ON 30
eH1_1                -1.373921e-01 1 1  ON 31
eH1_2                -9.541586e-02 1 1  ON 32
eH1_3                -4.384377e-02 1 1  ON 33
eH1_4                 1.269750e-02 1 1  ON 34
eH1_5                 4.899315e-02 1 1  ON 35
eH1_6                 1.055758e-01 1 1  ON 36
eH1_7                 1.503417e-01 1 1  ON 37
eH1_8                 1.590517e-01 1 1  ON 38
eH1_9                 4.461639e-02 1 1  ON 39
eH2_0                -2.392782e-01 1 1  ON 40
eH2_1                -1.362560e-01 1 1  ON 41
eH2_2                -9.412137e-02 1 1  ON 42
eH2_3                -4.234029e-02 1 1  ON 43
eH2_4                 1.393098e-02 1 1  ON 44
eH2_5                 5.141518e-02 1 1  ON 45
eH2_6                 1.079505e-01 1 1  ON 46
eH2_7                 1.556869e-01 1 1  ON 47
eH2_8                 1.693526e-01 1 1  ON 48
eH2_9                 3.049439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9496
    reference variance = 0.198997
====================================================
  Execution time = 2.8369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341051446986
                                         uncertainty =       0.004684700338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341051446986
                                         uncertainty =       0.004684700338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413071393
  error estimate for blocks of size 2^( 2) =       0.000425571977
  error estimate for blocks of size 2^( 3) =       0.000438507612
  error estimate for blocks of size 2^( 4) =       0.000450729173
  error estimate for blocks of size 2^( 5) =       0.000462087730
  error estimate for blocks of size 2^( 6) =       0.000472725546
  error estimate for blocks of size 2^( 7) =       0.000478568427

      target function =                  N/A
              le_mean =     -16.908583111139
             les_mean =     286.241438607472
             stat err =       0.000466027719
             autocorr =       1.272838371358
              std dev =       0.584171166519
             le_variance =       0.341255951792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690858311114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908583111139       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908583246790       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908583327123       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908583735368       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908583464703       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908583540732       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908583638011       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908583711188       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.035634e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908583111139       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908583150652       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908583177752       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908583298184       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908583265543       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908583241439       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908583260808       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908583288190       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.887784e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908583111139       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908583121443       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908583128840       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908583160374       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908583156064       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908583149099       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908583151015       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908583158420       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.991684e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5511e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.096030e-01 1 1  ON 0
 uu_1                 1.441219e-01 1 1  ON 1
 uu_2                 4.544898e-02 1 1  ON 2
 uu_3                -1.742621e-02 1 1  ON 3
 uu_4                -6.535379e-02 1 1  ON 4
 uu_5                -1.001800e-01 1 1  ON 5
 uu_6                -1.258974e-01 1 1  ON 6
 uu_7                -1.378081e-01 1 1  ON 7
 uu_8                -1.296857e-01 1 1  ON 8
 uu_9                -9.768228e-02 1 1  ON 9
 ud_0                 4.277509e-01 1 1  ON 10
 ud_1                 1.724858e-01 1 1  ON 11
 ud_2                 6.165692e-02 1 1  ON 12
 ud_3                -5.001714e-03 1 1  ON 13
 ud_4                -5.997702e-02 1 1  ON 14
 ud_5                -1.017012e-01 1 1  ON 15
 ud_6                -1.302908e-01 1 1  ON 16
 ud_7                -1.480566e-01 1 1  ON 17
 ud_8                -1.514462e-01 1 1  ON 18
 ud_9                -1.399550e-01 1 1  ON 19
 eO_0                -7.456896e-01 1 1  ON 20
 eO_1                -4.324144e-01 1 1  ON 21
 eO_2                -1.862083e-02 1 1  ON 22
 eO_3                 2.977297e-01 1 1  ON 23
 eO_4                 5.162581e-01 1 1  ON 24
 eO_5                 4.700911e-01 1 1  ON 25
 eO_6                 2.404173e-01 1 1  ON 26
 eO_7                -5.401892e-02 1 1  ON 27
 eO_8                -2.085493e-01 1 1  ON 28
 eO_9                -6.672799e-02 1 1  ON 29
eH1_0                -2.409775e-01 1 1  ON 30
eH1_1                -1.374602e-01 1 1  ON 31
eH1_2                -9.545855e-02 1 1  ON 32
eH1_3                -4.387603e-02 1 1  ON 33
eH1_4                 1.267043e-02 1 1  ON 34
eH1_5                 4.901102e-02 1 1  ON 35
eH1_6                 1.055995e-01 1 1  ON 36
eH1_7                 1.503962e-01 1 1  ON 37
eH1_8                 1.591158e-01 1 1  ON 38
eH1_9                 4.467316e-02 1 1  ON 39
eH2_0                -2.393570e-01 1 1  ON 40
eH2_1                -1.362746e-01 1 1  ON 41
eH2_2                -9.415188e-02 1 1  ON 42
eH2_3                -4.236986e-02 1 1  ON 43
eH2_4                 1.393210e-02 1 1  ON 44
eH2_5                 5.139729e-02 1 1  ON 45
eH2_6                 1.079731e-01 1 1  ON 46
eH2_7                 1.557074e-01 1 1  ON 47
eH2_8                 1.694019e-01 1 1  ON 48
eH2_9                 3.056369e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9285
    reference variance = 0.200652
====================================================
  Execution time = 2.7770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4993e-01
  Total weights = 2.0000e+06
  Execution time = 3.4394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349997085945
                                         uncertainty =       0.007684870283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349997085945
                                         uncertainty =       0.007684870283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418275303
  error estimate for blocks of size 2^( 2) =       0.000430387133
  error estimate for blocks of size 2^( 3) =       0.000442943801
  error estimate for blocks of size 2^( 4) =       0.000455592703
  error estimate for blocks of size 2^( 5) =       0.000465676519
  error estimate for blocks of size 2^( 6) =       0.000475013237
  error estimate for blocks of size 2^( 7) =       0.000479542056

      target function =                  N/A
              le_mean =     -16.910381936584
             les_mean =     286.310925524895
             stat err =       0.000468956129
             autocorr =       1.257013628743
              std dev =       0.591530606727
             le_variance =       0.349908458695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350054592061
                                         uncertainty =       0.007684818328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350054592061
                                         uncertainty =       0.007684818328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418309658
  error estimate for blocks of size 2^( 2) =       0.000430421258
  error estimate for blocks of size 2^( 3) =       0.000442976598
  error estimate for blocks of size 2^( 4) =       0.000455623136
  error estimate for blocks of size 2^( 5) =       0.000465704706
  error estimate for blocks of size 2^( 6) =       0.000475041549
  error estimate for blocks of size 2^( 7) =       0.000479567478

      target function =                  N/A
              le_mean =     -16.910382698350
             les_mean =     286.311008769319
             stat err =       0.000468984217
             autocorr =       1.256957727735
              std dev =       0.591579191363
             le_variance =       0.349965939653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350033332222
                                         uncertainty =       0.007684892368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350033332222
                                         uncertainty =       0.007684892368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418296958
  error estimate for blocks of size 2^( 2) =       0.000430408593
  error estimate for blocks of size 2^( 3) =       0.000442964437
  error estimate for blocks of size 2^( 4) =       0.000455612050
  error estimate for blocks of size 2^( 5) =       0.000465694875
  error estimate for blocks of size 2^( 6) =       0.000475031829
  error estimate for blocks of size 2^( 7) =       0.000479558819

      target function =                  N/A
              le_mean =     -16.910382369185
             les_mean =     286.310976387147
             stat err =       0.000468974393
             autocorr =       1.256981389653
              std dev =       0.591561231036
             le_variance =       0.349944690064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350001954106
                                         uncertainty =       0.007684875827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350001954106
                                         uncertainty =       0.007684875827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418278212
  error estimate for blocks of size 2^( 2) =       0.000430390012
  error estimate for blocks of size 2^( 3) =       0.000442946569
  error estimate for blocks of size 2^( 4) =       0.000455595305
  error estimate for blocks of size 2^( 5) =       0.000465679004
  error estimate for blocks of size 2^( 6) =       0.000475015761
  error estimate for blocks of size 2^( 7) =       0.000479544332

      target function =                  N/A
              le_mean =     -16.910381989671
             les_mean =     286.310932186500
             stat err =       0.000468958600
             autocorr =       1.257009398208
              std dev =       0.591534719927
             le_variance =       0.349913324879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910381936584        initial
     9.5367e-01     9.5367e+00             3.0356e-04       -16.910382698350  <--
     3.8147e+00     3.8147e+01             7.8878e-05       -16.910382369185
     1.5259e+01     1.5259e+02             1.9917e-05       -16.910381989671

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.5287e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.096403e-01 1 1  ON 0
 uu_1                 1.441975e-01 1 1  ON 1
 uu_2                 4.543411e-02 1 1  ON 2
 uu_3                -1.742463e-02 1 1  ON 3
 uu_4                -6.537853e-02 1 1  ON 4
 uu_5                -1.001650e-01 1 1  ON 5
 uu_6                -1.259880e-01 1 1  ON 6
 uu_7                -1.379209e-01 1 1  ON 7
 uu_8                -1.296892e-01 1 1  ON 8
 uu_9                -9.770688e-02 1 1  ON 9
 ud_0                 4.277928e-01 1 1  ON 10
 ud_1                 1.724975e-01 1 1  ON 11
 ud_2                 6.169762e-02 1 1  ON 12
 ud_3                -5.027341e-03 1 1  ON 13
 ud_4                -6.003368e-02 1 1  ON 14
 ud_5                -1.017394e-01 1 1  ON 15
 ud_6                -1.302942e-01 1 1  ON 16
 ud_7                -1.481357e-01 1 1  ON 17
 ud_8                -1.514173e-01 1 1  ON 18
 ud_9                -1.398975e-01 1 1  ON 19
 eO_0                -7.457624e-01 1 1  ON 20
 eO_1                -4.324807e-01 1 1  ON 21
 eO_2                -1.866296e-02 1 1  ON 22
 eO_3                 2.977610e-01 1 1  ON 23
 eO_4                 5.164046e-01 1 1  ON 24
 eO_5                 4.701942e-01 1 1  ON 25
 eO_6                 2.404804e-01 1 1  ON 26
 eO_7                -5.400481e-02 1 1  ON 27
 eO_8                -2.086294e-01 1 1  ON 28
 eO_9                -6.680964e-02 1 1  ON 29
eH1_0                -2.411417e-01 1 1  ON 30
eH1_1                -1.376535e-01 1 1  ON 31
eH1_2                -9.559155e-02 1 1  ON 32
eH1_3                -4.397244e-02 1 1  ON 33
eH1_4                 1.259108e-02 1 1  ON 34
eH1_5                 4.906102e-02 1 1  ON 35
eH1_6                 1.056732e-01 1 1  ON 36
eH1_7                 1.505598e-01 1 1  ON 37
eH1_8                 1.593063e-01 1 1  ON 38
eH1_9                 4.484121e-02 1 1  ON 39
eH2_0                -2.395817e-01 1 1  ON 40
eH2_1                -1.363372e-01 1 1  ON 41
eH2_2                -9.424291e-02 1 1  ON 42
eH2_3                -4.245458e-02 1 1  ON 43
eH2_4                 1.392971e-02 1 1  ON 44
eH2_5                 5.134756e-02 1 1  ON 45
eH2_6                 1.080392e-01 1 1  ON 46
eH2_7                 1.557682e-01 1 1  ON 47
eH2_8                 1.695475e-01 1 1  ON 48
eH2_9                 3.076877e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0805e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9658
    reference variance = 0.185028
====================================================
  Execution time = 2.8278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3922e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339330977325
                                         uncertainty =       0.003591854073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339330977325
                                         uncertainty =       0.003591854073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411834934
  error estimate for blocks of size 2^( 2) =       0.000423396268
  error estimate for blocks of size 2^( 3) =       0.000435979116
  error estimate for blocks of size 2^( 4) =       0.000448109872
  error estimate for blocks of size 2^( 5) =       0.000457798742
  error estimate for blocks of size 2^( 6) =       0.000464924521
  error estimate for blocks of size 2^( 7) =       0.000467463066

      target function =                  N/A
              le_mean =     -16.910180591612
             les_mean =     286.293423497270
             stat err =       0.000459574050
             autocorr =       1.245273168726
              std dev =       0.582422549317
             le_variance =       0.339216025953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691018059161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910180591612       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910180757962       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910184517294       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910186414264       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910186419222       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910186677014       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910186868273       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910187525135       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910187690278       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910187487523       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910187450325       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 9.353221e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910180591612       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910180657586       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910182047773       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910182560179       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910182596255       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910182445768       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910182529061       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910182608853       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910182647454       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.613449e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910180591612       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910180610939       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910181014629       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910181130059       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910181161065       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910181102969       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910181118518       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910181134440       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 6.733827e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5409e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.096613e-01 1 1  ON 0
 uu_1                 1.442718e-01 1 1  ON 1
 uu_2                 4.551798e-02 1 1  ON 2
 uu_3                -1.735483e-02 1 1  ON 3
 uu_4                -6.531298e-02 1 1  ON 4
 uu_5                -1.001043e-01 1 1  ON 5
 uu_6                -1.259700e-01 1 1  ON 6
 uu_7                -1.380539e-01 1 1  ON 7
 uu_8                -1.298962e-01 1 1  ON 8
 uu_9                -9.789655e-02 1 1  ON 9
 ud_0                 4.277865e-01 1 1  ON 10
 ud_1                 1.725840e-01 1 1  ON 11
 ud_2                 6.181419e-02 1 1  ON 12
 ud_3                -4.974679e-03 1 1  ON 13
 ud_4                -6.003417e-02 1 1  ON 14
 ud_5                -1.016706e-01 1 1  ON 15
 ud_6                -1.302198e-01 1 1  ON 16
 ud_7                -1.481679e-01 1 1  ON 17
 ud_8                -1.515127e-01 1 1  ON 18
 ud_9                -1.400587e-01 1 1  ON 19
 eO_0                -7.459017e-01 1 1  ON 20
 eO_1                -4.325508e-01 1 1  ON 21
 eO_2                -1.858772e-02 1 1  ON 22
 eO_3                 2.978689e-01 1 1  ON 23
 eO_4                 5.164971e-01 1 1  ON 24
 eO_5                 4.703637e-01 1 1  ON 25
 eO_6                 2.405794e-01 1 1  ON 26
 eO_7                -5.395649e-02 1 1  ON 27
 eO_8                -2.088261e-01 1 1  ON 28
 eO_9                -6.697552e-02 1 1  ON 29
eH1_0                -2.413716e-01 1 1  ON 30
eH1_1                -1.376795e-01 1 1  ON 31
eH1_2                -9.565215e-02 1 1  ON 32
eH1_3                -4.404388e-02 1 1  ON 33
eH1_4                 1.247449e-02 1 1  ON 34
eH1_5                 4.907856e-02 1 1  ON 35
eH1_6                 1.056731e-01 1 1  ON 36
eH1_7                 1.507259e-01 1 1  ON 37
eH1_8                 1.595169e-01 1 1  ON 38
eH1_9                 4.498203e-02 1 1  ON 39
eH2_0                -2.398431e-01 1 1  ON 40
eH2_1                -1.364784e-01 1 1  ON 41
eH2_2                -9.424552e-02 1 1  ON 42
eH2_3                -4.258385e-02 1 1  ON 43
eH2_4                 1.380557e-02 1 1  ON 44
eH2_5                 5.134641e-02 1 1  ON 45
eH2_6                 1.081052e-01 1 1  ON 46
eH2_7                 1.559400e-01 1 1  ON 47
eH2_8                 1.697759e-01 1 1  ON 48
eH2_9                 3.098280e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.209179
====================================================
  Execution time = 2.7723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4450e-01
  Total weights = 2.0000e+06
  Execution time = 3.4458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344680326795
                                         uncertainty =       0.008640559085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344680326795
                                         uncertainty =       0.008640559085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415102707
  error estimate for blocks of size 2^( 2) =       0.000427266683
  error estimate for blocks of size 2^( 3) =       0.000439122454
  error estimate for blocks of size 2^( 4) =       0.000451167061
  error estimate for blocks of size 2^( 5) =       0.000461016237
  error estimate for blocks of size 2^( 6) =       0.000470176448
  error estimate for blocks of size 2^( 7) =       0.000474730317

      target function =                  N/A
              le_mean =     -16.909053198908
             les_mean =     286.260700425445
             stat err =       0.000464272516
             autocorr =       1.250935218108
              std dev =       0.587043877636
             le_variance =       0.344620514270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344457598125
                                         uncertainty =       0.008639740227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344457598125
                                         uncertainty =       0.008639740227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414968567
  error estimate for blocks of size 2^( 2) =       0.000427136590
  error estimate for blocks of size 2^( 3) =       0.000438995111
  error estimate for blocks of size 2^( 4) =       0.000451039573
  error estimate for blocks of size 2^( 5) =       0.000460890755
  error estimate for blocks of size 2^( 6) =       0.000470053399
  error estimate for blocks of size 2^( 7) =       0.000474614519

      target function =                  N/A
              le_mean =     -16.909054816756
             les_mean =     286.260532446368
             stat err =       0.000464149562
             autocorr =       1.251081171451
              std dev =       0.586854174818
             le_variance =       0.344397822502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344440733626
                                         uncertainty =       0.008637610981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344440733626
                                         uncertainty =       0.008637610981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414958402
  error estimate for blocks of size 2^( 2) =       0.000427127744
  error estimate for blocks of size 2^( 3) =       0.000438988240
  error estimate for blocks of size 2^( 4) =       0.000451035862
  error estimate for blocks of size 2^( 5) =       0.000460888442
  error estimate for blocks of size 2^( 6) =       0.000470051359
  error estimate for blocks of size 2^( 7) =       0.000474612386

      target function =                  N/A
              le_mean =     -16.909053839781
             les_mean =     286.260482534541
             stat err =       0.000464147012
             autocorr =       1.251128720321
              std dev =       0.586839799379
             le_variance =       0.344380950135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344637911424
                                         uncertainty =       0.008640345727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344637911424
                                         uncertainty =       0.008640345727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415077164
  error estimate for blocks of size 2^( 2) =       0.000427242101
  error estimate for blocks of size 2^( 3) =       0.000439098755
  error estimate for blocks of size 2^( 4) =       0.000451144034
  error estimate for blocks of size 2^( 5) =       0.000460993845
  error estimate for blocks of size 2^( 6) =       0.000470154518
  error estimate for blocks of size 2^( 7) =       0.000474709622

      target function =                  N/A
              le_mean =     -16.909053208577
             les_mean =     286.260658341600
             stat err =       0.000464250505
             autocorr =       1.250970558273
              std dev =       0.587007754135
             le_variance =       0.344578103414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909053198908        initial
     2.3842e-01     2.3842e+00             9.3532e-04       -16.909054816756  <--
     9.5367e-01     9.5367e+00             2.6134e-04       -16.909053839781
     3.8147e+00     3.8147e+01             6.7338e-05       -16.909053208577

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.5195e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.098385e-01 1 1  ON 0
 uu_1                 1.444967e-01 1 1  ON 1
 uu_2                 4.572572e-02 1 1  ON 2
 uu_3                -1.717632e-02 1 1  ON 3
 uu_4                -6.516718e-02 1 1  ON 4
 uu_5                -9.997511e-02 1 1  ON 5
 uu_6                -1.259775e-01 1 1  ON 6
 uu_7                -1.383721e-01 1 1  ON 7
 uu_8                -1.304619e-01 1 1  ON 8
 uu_9                -9.846194e-02 1 1  ON 9
 ud_0                 4.279272e-01 1 1  ON 10
 ud_1                 1.728308e-01 1 1  ON 11
 ud_2                 6.204854e-02 1 1  ON 12
 ud_3                -4.812162e-03 1 1  ON 13
 ud_4                -5.997446e-02 1 1  ON 14
 ud_5                -1.015455e-01 1 1  ON 15
 ud_6                -1.301071e-01 1 1  ON 16
 ud_7                -1.482258e-01 1 1  ON 17
 ud_8                -1.517498e-01 1 1  ON 18
 ud_9                -1.405286e-01 1 1  ON 19
 eO_0                -7.462078e-01 1 1  ON 20
 eO_1                -4.327339e-01 1 1  ON 21
 eO_2                -1.843269e-02 1 1  ON 22
 eO_3                 2.981337e-01 1 1  ON 23
 eO_4                 5.167748e-01 1 1  ON 24
 eO_5                 4.708515e-01 1 1  ON 25
 eO_6                 2.408713e-01 1 1  ON 26
 eO_7                -5.380819e-02 1 1  ON 27
 eO_8                -2.094053e-01 1 1  ON 28
 eO_9                -6.747127e-02 1 1  ON 29
eH1_0                -2.419328e-01 1 1  ON 30
eH1_1                -1.378575e-01 1 1  ON 31
eH1_2                -9.586320e-02 1 1  ON 32
eH1_3                -4.424354e-02 1 1  ON 33
eH1_4                 1.216027e-02 1 1  ON 34
eH1_5                 4.909000e-02 1 1  ON 35
eH1_6                 1.056849e-01 1 1  ON 36
eH1_7                 1.512132e-01 1 1  ON 37
eH1_8                 1.601403e-01 1 1  ON 38
eH1_9                 4.540328e-02 1 1  ON 39
eH2_0                -2.405171e-01 1 1  ON 40
eH2_1                -1.368428e-01 1 1  ON 41
eH2_2                -9.445065e-02 1 1  ON 42
eH2_3                -4.290667e-02 1 1  ON 43
eH2_4                 1.346262e-02 1 1  ON 44
eH2_5                 5.131039e-02 1 1  ON 45
eH2_6                 1.082888e-01 1 1  ON 46
eH2_7                 1.564461e-01 1 1  ON 47
eH2_8                 1.704541e-01 1 1  ON 48
eH2_9                 3.162158e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9122
    reference variance = 0.160372
====================================================
  Execution time = 2.8299e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4371e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343756943097
                                         uncertainty =       0.003700455191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343756943097
                                         uncertainty =       0.003700455191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414553031
  error estimate for blocks of size 2^( 2) =       0.000426568515
  error estimate for blocks of size 2^( 3) =       0.000439303368
  error estimate for blocks of size 2^( 4) =       0.000451453015
  error estimate for blocks of size 2^( 5) =       0.000461728760
  error estimate for blocks of size 2^( 6) =       0.000468749890
  error estimate for blocks of size 2^( 7) =       0.000471750817

      target function =                  N/A
              le_mean =     -16.909168862742
             les_mean =     286.263699887207
             stat err =       0.000463420620
             autocorr =       1.249656118594
              std dev =       0.586266518177
             le_variance =       0.343708430336


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690916886274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909168862742       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909173347461       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909176636439       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909177063942       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909180283285       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909183448311       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909182850602       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909184281648       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909183613963       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909183413011       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909183438765       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909183509130       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909183834924       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 3.607827e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909168862742       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909171743800       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909173674418       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909173885785       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909175090955       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909175338165       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909175148025       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909174937371       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909174925199       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909174759750       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 9.572118e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909168862742       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909170048200       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909170819166       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909171060550       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909171310902       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909171292351       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909171175667       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909171131990       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909171105269       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.572840e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7455e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.102890e-01 1 1  ON 0
 uu_1                 1.447071e-01 1 1  ON 1
 uu_2                 4.581922e-02 1 1  ON 2
 uu_3                -1.710635e-02 1 1  ON 3
 uu_4                -6.517484e-02 1 1  ON 4
 uu_5                -1.000781e-01 1 1  ON 5
 uu_6                -1.261751e-01 1 1  ON 6
 uu_7                -1.384351e-01 1 1  ON 7
 uu_8                -1.305990e-01 1 1  ON 8
 uu_9                -9.905538e-02 1 1  ON 9
 ud_0                 4.281441e-01 1 1  ON 10
 ud_1                 1.729050e-01 1 1  ON 11
 ud_2                 6.219971e-02 1 1  ON 12
 ud_3                -4.603419e-03 1 1  ON 13
 ud_4                -5.989607e-02 1 1  ON 14
 ud_5                -1.018894e-01 1 1  ON 15
 ud_6                -1.302411e-01 1 1  ON 16
 ud_7                -1.482161e-01 1 1  ON 17
 ud_8                -1.521792e-01 1 1  ON 18
 ud_9                -1.406919e-01 1 1  ON 19
 eO_0                -7.464346e-01 1 1  ON 20
 eO_1                -4.328192e-01 1 1  ON 21
 eO_2                -1.860688e-02 1 1  ON 22
 eO_3                 2.980714e-01 1 1  ON 23
 eO_4                 5.171554e-01 1 1  ON 24
 eO_5                 4.718087e-01 1 1  ON 25
 eO_6                 2.414582e-01 1 1  ON 26
 eO_7                -5.374322e-02 1 1  ON 27
 eO_8                -2.101489e-01 1 1  ON 28
 eO_9                -6.808780e-02 1 1  ON 29
eH1_0                -2.424972e-01 1 1  ON 30
eH1_1                -1.384789e-01 1 1  ON 31
eH1_2                -9.639489e-02 1 1  ON 32
eH1_3                -4.478760e-02 1 1  ON 33
eH1_4                 1.185584e-02 1 1  ON 34
eH1_5                 4.891545e-02 1 1  ON 35
eH1_6                 1.059442e-01 1 1  ON 36
eH1_7                 1.520821e-01 1 1  ON 37
eH1_8                 1.610323e-01 1 1  ON 38
eH1_9                 4.611979e-02 1 1  ON 39
eH2_0                -2.411234e-01 1 1  ON 40
eH2_1                -1.373415e-01 1 1  ON 41
eH2_2                -9.514946e-02 1 1  ON 42
eH2_3                -4.315549e-02 1 1  ON 43
eH2_4                 1.317311e-02 1 1  ON 44
eH2_5                 5.134309e-02 1 1  ON 45
eH2_6                 1.086778e-01 1 1  ON 46
eH2_7                 1.567215e-01 1 1  ON 47
eH2_8                 1.710770e-01 1 1  ON 48
eH2_9                 3.250765e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9685
    reference variance = 0.368227
====================================================
  Execution time = 2.7820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4886e-01
  Total weights = 2.0000e+06
  Execution time = 3.4439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348692866623
                                         uncertainty =       0.005860644608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348692866623
                                         uncertainty =       0.005860644608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417509945
  error estimate for blocks of size 2^( 2) =       0.000429981263
  error estimate for blocks of size 2^( 3) =       0.000443042107
  error estimate for blocks of size 2^( 4) =       0.000455115847
  error estimate for blocks of size 2^( 5) =       0.000467451872
  error estimate for blocks of size 2^( 6) =       0.000475682242
  error estimate for blocks of size 2^( 7) =       0.000480688471

      target function =                  N/A
              le_mean =     -16.909275686305
             les_mean =     286.272233169410
             stat err =       0.000469734608
             autocorr =       1.265818584006
              std dev =       0.590448226580
             le_variance =       0.348629108272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349196859407
                                         uncertainty =       0.005866789455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349196859407
                                         uncertainty =       0.005866789455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417811532
  error estimate for blocks of size 2^( 2) =       0.000430274031
  error estimate for blocks of size 2^( 3) =       0.000443314034
  error estimate for blocks of size 2^( 4) =       0.000455357968
  error estimate for blocks of size 2^( 5) =       0.000467678169
  error estimate for blocks of size 2^( 6) =       0.000475884470
  error estimate for blocks of size 2^( 7) =       0.000480873171

      target function =                  N/A
              le_mean =     -16.909275534533
             les_mean =     286.272731880375
             stat err =       0.000469948444
             autocorr =       1.265142915036
              std dev =       0.590874734766
             le_variance =       0.349132952185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349161855411
                                         uncertainty =       0.005867369714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349161855411
                                         uncertainty =       0.005867369714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417790652
  error estimate for blocks of size 2^( 2) =       0.000430253140
  error estimate for blocks of size 2^( 3) =       0.000443295891
  error estimate for blocks of size 2^( 4) =       0.000455350297
  error estimate for blocks of size 2^( 5) =       0.000467679484
  error estimate for blocks of size 2^( 6) =       0.000475893773
  error estimate for blocks of size 2^( 7) =       0.000480890524

      target function =                  N/A
              le_mean =     -16.909275215969
             les_mean =     286.272686212835
             stat err =       0.000469953519
             autocorr =       1.265296700576
              std dev =       0.590845206470
             le_variance =       0.349098058009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348797460481
                                         uncertainty =       0.005862485881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348797460481
                                         uncertainty =       0.005862485881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417572573
  error estimate for blocks of size 2^( 2) =       0.000430041859
  error estimate for blocks of size 2^( 3) =       0.000443099075
  error estimate for blocks of size 2^( 4) =       0.000455169729
  error estimate for blocks of size 2^( 5) =       0.000467504761
  error estimate for blocks of size 2^( 6) =       0.000475732115
  error estimate for blocks of size 2^( 7) =       0.000480736648

      target function =                  N/A
              le_mean =     -16.909275446083
             les_mean =     286.272329643912
             stat err =       0.000469785813
             autocorr =       1.265714818764
              std dev =       0.590536795442
             le_variance =       0.348733706771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909275686305        initial  <--
     5.9605e-02     5.9605e-01             3.6078e-03       -16.909275534533
     2.3842e-01     2.3842e+00             9.5721e-04       -16.909275215969
     9.5367e-01     9.5367e+00             2.5728e-04       -16.909275446083

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2965
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.098385e-01 1 1  ON 0
 uu_1                 1.444967e-01 1 1  ON 1
 uu_2                 4.572572e-02 1 1  ON 2
 uu_3                -1.717632e-02 1 1  ON 3
 uu_4                -6.516718e-02 1 1  ON 4
 uu_5                -9.997511e-02 1 1  ON 5
 uu_6                -1.259775e-01 1 1  ON 6
 uu_7                -1.383721e-01 1 1  ON 7
 uu_8                -1.304619e-01 1 1  ON 8
 uu_9                -9.846194e-02 1 1  ON 9
 ud_0                 4.279272e-01 1 1  ON 10
 ud_1                 1.728308e-01 1 1  ON 11
 ud_2                 6.204854e-02 1 1  ON 12
 ud_3                -4.812162e-03 1 1  ON 13
 ud_4                -5.997446e-02 1 1  ON 14
 ud_5                -1.015455e-01 1 1  ON 15
 ud_6                -1.301071e-01 1 1  ON 16
 ud_7                -1.482258e-01 1 1  ON 17
 ud_8                -1.517498e-01 1 1  ON 18
 ud_9                -1.405286e-01 1 1  ON 19
 eO_0                -7.462078e-01 1 1  ON 20
 eO_1                -4.327339e-01 1 1  ON 21
 eO_2                -1.843269e-02 1 1  ON 22
 eO_3                 2.981337e-01 1 1  ON 23
 eO_4                 5.167748e-01 1 1  ON 24
 eO_5                 4.708515e-01 1 1  ON 25
 eO_6                 2.408713e-01 1 1  ON 26
 eO_7                -5.380819e-02 1 1  ON 27
 eO_8                -2.094053e-01 1 1  ON 28
 eO_9                -6.747127e-02 1 1  ON 29
eH1_0                -2.419328e-01 1 1  ON 30
eH1_1                -1.378575e-01 1 1  ON 31
eH1_2                -9.586320e-02 1 1  ON 32
eH1_3                -4.424354e-02 1 1  ON 33
eH1_4                 1.216027e-02 1 1  ON 34
eH1_5                 4.909000e-02 1 1  ON 35
eH1_6                 1.056849e-01 1 1  ON 36
eH1_7                 1.512132e-01 1 1  ON 37
eH1_8                 1.601403e-01 1 1  ON 38
eH1_9                 4.540328e-02 1 1  ON 39
eH2_0                -2.405171e-01 1 1  ON 40
eH2_1                -1.368428e-01 1 1  ON 41
eH2_2                -9.445065e-02 1 1  ON 42
eH2_3                -4.290667e-02 1 1  ON 43
eH2_4                 1.346262e-02 1 1  ON 44
eH2_5                 5.131039e-02 1 1  ON 45
eH2_6                 1.082888e-01 1 1  ON 46
eH2_7                 1.564461e-01 1 1  ON 47
eH2_8                 1.704541e-01 1 1  ON 48
eH2_9                 3.162158e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2759e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9045
    reference variance = 0.244202
====================================================
  Execution time = 2.8365e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342540802677
                                         uncertainty =       0.006124287252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342540802677
                                         uncertainty =       0.006124287252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413805994
  error estimate for blocks of size 2^( 2) =       0.000426052526
  error estimate for blocks of size 2^( 3) =       0.000438320988
  error estimate for blocks of size 2^( 4) =       0.000450711250
  error estimate for blocks of size 2^( 5) =       0.000461355112
  error estimate for blocks of size 2^( 6) =       0.000469348934
  error estimate for blocks of size 2^( 7) =       0.000473862720

      target function =                  N/A
              le_mean =     -16.909882967870
             les_mean =     286.286612616953
             stat err =       0.000463819504
             autocorr =       1.256332112266
              std dev =       0.585210048722
             le_variance =       0.342470801125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690988296787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909882967870       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909883006144       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909882877524       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909883371790       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909882869916       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909883464355       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909883712100       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909883534711       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909883511999       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.575245e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909882967870       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909882979941       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909882922310       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909883048566       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909882864480       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909883019103       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909883057945       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909883049761       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.016796e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909882967870       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909882971099       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909882954198       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909882985482       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909882933168       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909882971414       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909882978032       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909882978645       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.650159e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293632 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5451e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260067e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849637e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765111e-03 1 1  ON 13
 ud_4                -5.994840e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167900e-01 1 1  ON 24
 eO_5                 4.709095e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094876e-01 1 1  ON 28
 eO_9                -6.753611e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379306e-01 1 1  ON 31
eH1_2                -9.593159e-02 1 1  ON 32
eH1_3                -4.424773e-02 1 1  ON 33
eH1_4                 1.212434e-02 1 1  ON 34
eH1_5                 4.908194e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512598e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548724e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455233e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347357e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8647
    reference variance = 0.347549
====================================================
  Execution time = 2.7825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.5542e-01
  Total weights = 2.0000e+06
  Execution time = 3.4698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355086925258
                                         uncertainty =       0.017167285832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355086925258
                                         uncertainty =       0.017167285832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421541835
  error estimate for blocks of size 2^( 2) =       0.000433126719
  error estimate for blocks of size 2^( 3) =       0.000445435098
  error estimate for blocks of size 2^( 4) =       0.000457525949
  error estimate for blocks of size 2^( 5) =       0.000467586805
  error estimate for blocks of size 2^( 6) =       0.000475225936
  error estimate for blocks of size 2^( 7) =       0.000479381034

      target function =                  N/A
              le_mean =     -16.908176149198
             les_mean =     286.241815551271
             stat err =       0.000469929931
             autocorr =       1.242753090592
              std dev =       0.596150179621
             le_variance =       0.355395036662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355159611575
                                         uncertainty =       0.017166835277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355159611575
                                         uncertainty =       0.017166835277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421585082
  error estimate for blocks of size 2^( 2) =       0.000433166195
  error estimate for blocks of size 2^( 3) =       0.000445469847
  error estimate for blocks of size 2^( 4) =       0.000457556785
  error estimate for blocks of size 2^( 5) =       0.000467617545
  error estimate for blocks of size 2^( 6) =       0.000475254930
  error estimate for blocks of size 2^( 7) =       0.000479404909

      target function =                  N/A
              le_mean =     -16.908176082430
             les_mean =     286.241886219118
             stat err =       0.000469958542
             autocorr =       1.242649435490
              std dev =       0.596211340382
             le_variance =       0.355467962400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355138949077
                                         uncertainty =       0.017167246564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355138949077
                                         uncertainty =       0.017167246564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421572777
  error estimate for blocks of size 2^( 2) =       0.000433154933
  error estimate for blocks of size 2^( 3) =       0.000445460277
  error estimate for blocks of size 2^( 4) =       0.000457548760
  error estimate for blocks of size 2^( 5) =       0.000467609841
  error estimate for blocks of size 2^( 6) =       0.000475248135
  error estimate for blocks of size 2^( 7) =       0.000479399937

      target function =                  N/A
              le_mean =     -16.908176154895
             les_mean =     286.241867919051
             stat err =       0.000469951668
             autocorr =       1.242685625933
              std dev =       0.596193938084
             le_variance =       0.355447211808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355094561949
                                         uncertainty =       0.017167294747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355094561949
                                         uncertainty =       0.017167294747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421546377
  error estimate for blocks of size 2^( 2) =       0.000433130867
  error estimate for blocks of size 2^( 3) =       0.000445438822
  error estimate for blocks of size 2^( 4) =       0.000457529348
  error estimate for blocks of size 2^( 5) =       0.000467590253
  error estimate for blocks of size 2^( 6) =       0.000475229286
  error estimate for blocks of size 2^( 7) =       0.000479383970

      target function =                  N/A
              le_mean =     -16.908176141674
             les_mean =     286.241822955499
             stat err =       0.000469933214
             autocorr =       1.242743674320
              std dev =       0.596156603029
             le_variance =       0.355402695335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908176149198        initial
     5.9605e-01     5.9605e+00             3.5752e-04       -16.908176082430
     2.3842e+00     2.3842e+01             1.0168e-04       -16.908176154895  <--
     9.5367e+00     9.5367e+01             2.6502e-05       -16.908176141674

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.5345e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260067e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849637e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765111e-03 1 1  ON 13
 ud_4                -5.994840e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167900e-01 1 1  ON 24
 eO_5                 4.709095e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094876e-01 1 1  ON 28
 eO_9                -6.753611e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379306e-01 1 1  ON 31
eH1_2                -9.593159e-02 1 1  ON 32
eH1_3                -4.424773e-02 1 1  ON 33
eH1_4                 1.212434e-02 1 1  ON 34
eH1_5                 4.908194e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512598e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548724e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455233e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347357e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0803e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9798
    reference variance = 0.292004
====================================================
  Execution time = 2.8476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4391e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344013185599
                                         uncertainty =       0.007720137058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344013185599
                                         uncertainty =       0.007720137058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414676574
  error estimate for blocks of size 2^( 2) =       0.000427002597
  error estimate for blocks of size 2^( 3) =       0.000440426947
  error estimate for blocks of size 2^( 4) =       0.000453217270
  error estimate for blocks of size 2^( 5) =       0.000465358237
  error estimate for blocks of size 2^( 6) =       0.000474289012
  error estimate for blocks of size 2^( 7) =       0.000482523549

      target function =                  N/A
              le_mean =     -16.909110419362
             les_mean =     286.261928323581
             stat err =       0.000468847017
             autocorr =       1.278330972310
              std dev =       0.586441234362
             le_variance =       0.343913321359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690911041936e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909110419362       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909111202614       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909112348343       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909112535274       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909113176130       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909113134076       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909113303064       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909113098224       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909113121468       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 5.041743e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909110419362       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909110673297       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909111020572       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909111038120       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909111221439       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909111286623       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909111264077       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909111221045       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.248097e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909110419362       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909110487934       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909110580383       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909110582084       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909110628153       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909110653631       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909110642847       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909110632627       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.127872e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5574e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.099114e-01 1 1  ON 0
 uu_1                 1.445707e-01 1 1  ON 1
 uu_2                 4.577363e-02 1 1  ON 2
 uu_3                -1.720668e-02 1 1  ON 3
 uu_4                -6.521056e-02 1 1  ON 4
 uu_5                -1.000315e-01 1 1  ON 5
 uu_6                -1.260517e-01 1 1  ON 6
 uu_7                -1.384366e-01 1 1  ON 7
 uu_8                -1.305459e-01 1 1  ON 8
 uu_9                -9.851750e-02 1 1  ON 9
 ud_0                 4.279857e-01 1 1  ON 10
 ud_1                 1.728104e-01 1 1  ON 11
 ud_2                 6.202384e-02 1 1  ON 12
 ud_3                -4.775856e-03 1 1  ON 13
 ud_4                -5.994987e-02 1 1  ON 14
 ud_5                -1.015913e-01 1 1  ON 15
 ud_6                -1.301341e-01 1 1  ON 16
 ud_7                -1.482951e-01 1 1  ON 17
 ud_8                -1.517289e-01 1 1  ON 18
 ud_9                -1.404935e-01 1 1  ON 19
 eO_0                -7.461976e-01 1 1  ON 20
 eO_1                -4.328028e-01 1 1  ON 21
 eO_2                -1.849215e-02 1 1  ON 22
 eO_3                 2.981470e-01 1 1  ON 23
 eO_4                 5.168422e-01 1 1  ON 24
 eO_5                 4.710003e-01 1 1  ON 25
 eO_6                 2.409696e-01 1 1  ON 26
 eO_7                -5.377692e-02 1 1  ON 27
 eO_8                -2.095379e-01 1 1  ON 28
 eO_9                -6.757016e-02 1 1  ON 29
eH1_0                -2.420532e-01 1 1  ON 30
eH1_1                -1.380122e-01 1 1  ON 31
eH1_2                -9.598319e-02 1 1  ON 32
eH1_3                -4.431807e-02 1 1  ON 33
eH1_4                 1.204145e-02 1 1  ON 34
eH1_5                 4.910261e-02 1 1  ON 35
eH1_6                 1.057422e-01 1 1  ON 36
eH1_7                 1.513287e-01 1 1  ON 37
eH1_8                 1.603520e-01 1 1  ON 38
eH1_9                 4.558228e-02 1 1  ON 39
eH2_0                -2.406756e-01 1 1  ON 40
eH2_1                -1.369442e-01 1 1  ON 41
eH2_2                -9.460278e-02 1 1  ON 42
eH2_3                -4.290254e-02 1 1  ON 43
eH2_4                 1.343420e-02 1 1  ON 44
eH2_5                 5.129705e-02 1 1  ON 45
eH2_6                 1.083240e-01 1 1  ON 46
eH2_7                 1.565078e-01 1 1  ON 47
eH2_8                 1.706014e-01 1 1  ON 48
eH2_9                 3.181642e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.0071
    reference variance = 0.534466
====================================================
  Execution time = 2.7774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4960e-01
  Total weights = 2.0000e+06
  Execution time = 3.4547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349667163048
                                         uncertainty =       0.007026079718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349667163048
                                         uncertainty =       0.007026079718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418056317
  error estimate for blocks of size 2^( 2) =       0.000429949417
  error estimate for blocks of size 2^( 3) =       0.000442639825
  error estimate for blocks of size 2^( 4) =       0.000454311963
  error estimate for blocks of size 2^( 5) =       0.000464142625
  error estimate for blocks of size 2^( 6) =       0.000471913704
  error estimate for blocks of size 2^( 7) =       0.000476771665

      target function =                  N/A
              le_mean =     -16.908825809141
             les_mean =     286.257932236901
             stat err =       0.000466784989
             autocorr =       1.246706384646
              std dev =       0.591220912848
             le_variance =       0.349542167789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349823608415
                                         uncertainty =       0.007028598154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349823608415
                                         uncertainty =       0.007028598154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418149859
  error estimate for blocks of size 2^( 2) =       0.000430040667
  error estimate for blocks of size 2^( 3) =       0.000442726349
  error estimate for blocks of size 2^( 4) =       0.000454393863
  error estimate for blocks of size 2^( 5) =       0.000464222563
  error estimate for blocks of size 2^( 6) =       0.000471985606
  error estimate for blocks of size 2^( 7) =       0.000476841559

      target function =                  N/A
              le_mean =     -16.908825716928
             les_mean =     286.258085559702
             stat err =       0.000466860898
             autocorr =       1.246553988506
              std dev =       0.591353201662
             le_variance =       0.349698609116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349784892224
                                         uncertainty =       0.007028141659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349784892224
                                         uncertainty =       0.007028141659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418126714
  error estimate for blocks of size 2^( 2) =       0.000430017651
  error estimate for blocks of size 2^( 3) =       0.000442704490
  error estimate for blocks of size 2^( 4) =       0.000454373335
  error estimate for blocks of size 2^( 5) =       0.000464202865
  error estimate for blocks of size 2^( 6) =       0.000471968569
  error estimate for blocks of size 2^( 7) =       0.000476825405

      target function =                  N/A
              le_mean =     -16.908825768140
             les_mean =     286.258048579843
             stat err =       0.000466842544
             autocorr =       1.246593974185
              std dev =       0.591320469250
             le_variance =       0.349659897354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349683683036
                                         uncertainty =       0.007026377884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349683683036
                                         uncertainty =       0.007026377884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418066196
  error estimate for blocks of size 2^( 2) =       0.000429958975
  error estimate for blocks of size 2^( 3) =       0.000442648878
  error estimate for blocks of size 2^( 4) =       0.000454320564
  error estimate for blocks of size 2^( 5) =       0.000464151076
  error estimate for blocks of size 2^( 6) =       0.000471921411
  error estimate for blocks of size 2^( 7) =       0.000476779212

      target function =                  N/A
              le_mean =     -16.908825796641
             les_mean =     286.257948334396
             stat err =       0.000466793066
             autocorr =       1.246690606594
              std dev =       0.591234883962
             le_variance =       0.349558688013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908825809141        initial  <--
     5.9605e-01     5.9605e+00             5.0417e-04       -16.908825716928
     2.3842e+00     2.3842e+01             1.2481e-04       -16.908825768140
     9.5367e+00     9.5367e+01             3.1279e-05       -16.908825796641

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3100
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260067e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849637e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765111e-03 1 1  ON 13
 ud_4                -5.994840e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167900e-01 1 1  ON 24
 eO_5                 4.709095e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094876e-01 1 1  ON 28
 eO_9                -6.753611e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379306e-01 1 1  ON 31
eH1_2                -9.593159e-02 1 1  ON 32
eH1_3                -4.424773e-02 1 1  ON 33
eH1_4                 1.212434e-02 1 1  ON 34
eH1_5                 4.908194e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512598e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548724e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455233e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347357e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9329
    reference variance = 0.251503
====================================================
  Execution time = 2.8723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4643e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346472408417
                                         uncertainty =       0.006435701475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346472408417
                                         uncertainty =       0.006435701475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416192457
  error estimate for blocks of size 2^( 2) =       0.000428555827
  error estimate for blocks of size 2^( 3) =       0.000441343111
  error estimate for blocks of size 2^( 4) =       0.000453920511
  error estimate for blocks of size 2^( 5) =       0.000465213855
  error estimate for blocks of size 2^( 6) =       0.000473284559
  error estimate for blocks of size 2^( 7) =       0.000478346194

      target function =                  N/A
              le_mean =     -16.909335856693
             les_mean =     286.272071263999
             stat err =       0.000467691280
             autocorr =       1.262787094143
              std dev =       0.588585017462
             le_variance =       0.346432322781


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690933585669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909335856693       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909335956702       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909336068150       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909336101404       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909336144813       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909336126974       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909336138335       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909336148413       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.470423e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909335856693       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909335882198       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909335911062       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909335919418       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909335930210       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909335925388       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909335928196       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909335930580       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.139959e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909335856693       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909335863101       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909335870383       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909335872475       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909335875170       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909335873941       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909335874640       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909335875227       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.864516e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5880e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.098840e-01 1 1  ON 0
 uu_1                 1.445474e-01 1 1  ON 1
 uu_2                 4.574611e-02 1 1  ON 2
 uu_3                -1.717701e-02 1 1  ON 3
 uu_4                -6.522274e-02 1 1  ON 4
 uu_5                -9.999111e-02 1 1  ON 5
 uu_6                -1.260070e-01 1 1  ON 6
 uu_7                -1.383867e-01 1 1  ON 7
 uu_8                -1.305264e-01 1 1  ON 8
 uu_9                -9.849942e-02 1 1  ON 9
 ud_0                 4.279563e-01 1 1  ON 10
 ud_1                 1.728392e-01 1 1  ON 11
 ud_2                 6.206123e-02 1 1  ON 12
 ud_3                -4.762480e-03 1 1  ON 13
 ud_4                -5.994414e-02 1 1  ON 14
 ud_5                -1.015512e-01 1 1  ON 15
 ud_6                -1.300986e-01 1 1  ON 16
 ud_7                -1.482528e-01 1 1  ON 17
 ud_8                -1.517668e-01 1 1  ON 18
 ud_9                -1.405619e-01 1 1  ON 19
 eO_0                -7.461870e-01 1 1  ON 20
 eO_1                -4.327672e-01 1 1  ON 21
 eO_2                -1.845776e-02 1 1  ON 22
 eO_3                 2.981634e-01 1 1  ON 23
 eO_4                 5.167944e-01 1 1  ON 24
 eO_5                 4.709175e-01 1 1  ON 25
 eO_6                 2.409317e-01 1 1  ON 26
 eO_7                -5.378097e-02 1 1  ON 27
 eO_8                -2.094923e-01 1 1  ON 28
 eO_9                -6.754184e-02 1 1  ON 29
eH1_0                -2.420056e-01 1 1  ON 30
eH1_1                -1.379377e-01 1 1  ON 31
eH1_2                -9.593687e-02 1 1  ON 32
eH1_3                -4.425012e-02 1 1  ON 33
eH1_4                 1.211484e-02 1 1  ON 34
eH1_5                 4.907856e-02 1 1  ON 35
eH1_6                 1.057381e-01 1 1  ON 36
eH1_7                 1.512686e-01 1 1  ON 37
eH1_8                 1.602353e-01 1 1  ON 38
eH1_9                 4.549310e-02 1 1  ON 39
eH2_0                -2.405799e-01 1 1  ON 40
eH2_1                -1.368996e-01 1 1  ON 41
eH2_2                -9.456373e-02 1 1  ON 42
eH2_3                -4.289866e-02 1 1  ON 43
eH2_4                 1.346455e-02 1 1  ON 44
eH2_5                 5.133734e-02 1 1  ON 45
eH2_6                 1.083046e-01 1 1  ON 46
eH2_7                 1.564604e-01 1 1  ON 47
eH2_8                 1.705224e-01 1 1  ON 48
eH2_9                 3.171699e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8745
    reference variance = 0.239559
====================================================
  Execution time = 2.7833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3813e-01
  Total weights = 2.0000e+06
  Execution time = 3.4520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338128257764
                                         uncertainty =       0.004059659712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338128257764
                                         uncertainty =       0.004059659712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411173043
  error estimate for blocks of size 2^( 2) =       0.000423748481
  error estimate for blocks of size 2^( 3) =       0.000436586194
  error estimate for blocks of size 2^( 4) =       0.000449183285
  error estimate for blocks of size 2^( 5) =       0.000460780006
  error estimate for blocks of size 2^( 6) =       0.000469846320
  error estimate for blocks of size 2^( 7) =       0.000477760747

      target function =                  N/A
              le_mean =     -16.908758517186
             les_mean =     286.244240965248
             stat err =       0.000464392589
             autocorr =       1.275619925797
              std dev =       0.581486493213
             le_variance =       0.338126541789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338140329697
                                         uncertainty =       0.004059763441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338140329697
                                         uncertainty =       0.004059763441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411180386
  error estimate for blocks of size 2^( 2) =       0.000423755489
  error estimate for blocks of size 2^( 3) =       0.000436592632
  error estimate for blocks of size 2^( 4) =       0.000449189113
  error estimate for blocks of size 2^( 5) =       0.000460785022
  error estimate for blocks of size 2^( 6) =       0.000469850426
  error estimate for blocks of size 2^( 7) =       0.000477764908

      target function =                  N/A
              le_mean =     -16.908758459962
             les_mean =     286.244251107342
             stat err =       0.000464397367
             autocorr =       1.275600612224
              std dev =       0.581496877950
             le_variance =       0.338138619066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338134539057
                                         uncertainty =       0.004059712863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338134539057
                                         uncertainty =       0.004059712863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411176863
  error estimate for blocks of size 2^( 2) =       0.000423752124
  error estimate for blocks of size 2^( 3) =       0.000436589542
  error estimate for blocks of size 2^( 4) =       0.000449186318
  error estimate for blocks of size 2^( 5) =       0.000460782618
  error estimate for blocks of size 2^( 6) =       0.000469848464
  error estimate for blocks of size 2^( 7) =       0.000477762926

      target function =                  N/A
              le_mean =     -16.908758485201
             les_mean =     286.244246167562
             stat err =       0.000464395082
             autocorr =       1.275609910080
              std dev =       0.581491896577
             le_variance =       0.338132825784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129050685
                                         uncertainty =       0.004059666396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338129050685
                                         uncertainty =       0.004059666396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411173525
  error estimate for blocks of size 2^( 2) =       0.000423748941
  error estimate for blocks of size 2^( 3) =       0.000436586616
  error estimate for blocks of size 2^( 4) =       0.000449183668
  error estimate for blocks of size 2^( 5) =       0.000460780336
  error estimate for blocks of size 2^( 6) =       0.000469846591
  error estimate for blocks of size 2^( 7) =       0.000477761022

      target function =                  N/A
              le_mean =     -16.908758513024
             les_mean =     286.244241617747
             stat err =       0.000464392904
             autocorr =       1.275618661940
              std dev =       0.581487175309
             le_variance =       0.338127335048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908758517186        initial  <--
     5.9605e+00     5.9605e+01             4.4704e-05       -16.908758459962
     2.3842e+01     2.3842e+02             1.1400e-05       -16.908758485201
     9.5367e+01     9.5367e+02             2.8645e-06       -16.908758513024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3499
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260067e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849637e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765111e-03 1 1  ON 13
 ud_4                -5.994840e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167900e-01 1 1  ON 24
 eO_5                 4.709095e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094876e-01 1 1  ON 28
 eO_9                -6.753611e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379306e-01 1 1  ON 31
eH1_2                -9.593159e-02 1 1  ON 32
eH1_3                -4.424773e-02 1 1  ON 33
eH1_4                 1.212434e-02 1 1  ON 34
eH1_5                 4.908194e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512598e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548724e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455233e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347357e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.927
    reference variance = 0.39698
====================================================
  Execution time = 3.0585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4622e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1528e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345633651814
                                         uncertainty =       0.005771883261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345633651814
                                         uncertainty =       0.005771883261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416062887
  error estimate for blocks of size 2^( 2) =       0.000427862407
  error estimate for blocks of size 2^( 3) =       0.000439914995
  error estimate for blocks of size 2^( 4) =       0.000451473670
  error estimate for blocks of size 2^( 5) =       0.000460882244
  error estimate for blocks of size 2^( 6) =       0.000468993480
  error estimate for blocks of size 2^( 7) =       0.000475592328

      target function =                  N/A
              le_mean =     -16.909422554257
             les_mean =     286.274787596651
             stat err =       0.000464235431
             autocorr =       1.244969207204
              std dev =       0.588401777154
             le_variance =       0.346216651358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690942255426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909422554257       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909422552418       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909422557432       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909422557934       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909422557019       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909422554923       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909422556242       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909422558489       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.858887e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909422554257       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909422553796       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909422555053       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909422555179       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909422554952       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909422554425       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909422554748       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909422555312       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 9.649079e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909422554257       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909422554141       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909422554456       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909422554487       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909422554431       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909422554298       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909422554379       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909422554518       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.412386e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7749e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.098832e-01 1 1  ON 0
 uu_1                 1.445454e-01 1 1  ON 1
 uu_2                 4.574598e-02 1 1  ON 2
 uu_3                -1.717544e-02 1 1  ON 3
 uu_4                -6.522319e-02 1 1  ON 4
 uu_5                -9.998968e-02 1 1  ON 5
 uu_6                -1.260071e-01 1 1  ON 6
 uu_7                -1.383845e-01 1 1  ON 7
 uu_8                -1.305257e-01 1 1  ON 8
 uu_9                -9.849678e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728366e-01 1 1  ON 11
 ud_2                 6.205969e-02 1 1  ON 12
 ud_3                -4.764968e-03 1 1  ON 13
 ud_4                -5.994842e-02 1 1  ON 14
 ud_5                -1.015497e-01 1 1  ON 15
 ud_6                -1.300996e-01 1 1  ON 16
 ud_7                -1.482467e-01 1 1  ON 17
 ud_8                -1.517637e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461841e-01 1 1  ON 20
 eO_1                -4.327630e-01 1 1  ON 21
 eO_2                -1.845848e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167907e-01 1 1  ON 24
 eO_5                 4.709101e-01 1 1  ON 25
 eO_6                 2.409285e-01 1 1  ON 26
 eO_7                -5.378113e-02 1 1  ON 27
 eO_8                -2.094882e-01 1 1  ON 28
 eO_9                -6.753669e-02 1 1  ON 29
eH1_0                -2.420023e-01 1 1  ON 30
eH1_1                -1.379312e-01 1 1  ON 31
eH1_2                -9.593217e-02 1 1  ON 32
eH1_3                -4.424837e-02 1 1  ON 33
eH1_4                 1.212405e-02 1 1  ON 34
eH1_5                 4.908198e-02 1 1  ON 35
eH1_6                 1.057300e-01 1 1  ON 36
eH1_7                 1.512604e-01 1 1  ON 37
eH1_8                 1.602281e-01 1 1  ON 38
eH1_9                 4.548811e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368986e-01 1 1  ON 41
eH2_2                -9.455317e-02 1 1  ON 42
eH2_3                -4.289479e-02 1 1  ON 43
eH2_4                 1.347264e-02 1 1  ON 44
eH2_5                 5.133501e-02 1 1  ON 45
eH2_6                 1.082988e-01 1 1  ON 46
eH2_7                 1.564591e-01 1 1  ON 47
eH2_8                 1.705165e-01 1 1  ON 48
eH2_9                 3.170846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8696
    reference variance = 0.130645
====================================================
  Execution time = 2.7893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4444e-01
  Total weights = 2.0000e+06
  Execution time = 3.4391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344515889427
                                         uncertainty =       0.007460948361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344515889427
                                         uncertainty =       0.007460948361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414996037
  error estimate for blocks of size 2^( 2) =       0.000427067729
  error estimate for blocks of size 2^( 3) =       0.000439711978
  error estimate for blocks of size 2^( 4) =       0.000451701281
  error estimate for blocks of size 2^( 5) =       0.000462467093
  error estimate for blocks of size 2^( 6) =       0.000470038048
  error estimate for blocks of size 2^( 7) =       0.000474063175

      target function =                  N/A
              le_mean =     -16.909782336870
             les_mean =     286.285181930047
             stat err =       0.000464567399
             autocorr =       1.253168762622
              std dev =       0.586893024290
             le_variance =       0.344443421960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344516152242
                                         uncertainty =       0.007460968526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344516152242
                                         uncertainty =       0.007460968526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414996195
  error estimate for blocks of size 2^( 2) =       0.000427067887
  error estimate for blocks of size 2^( 3) =       0.000439712127
  error estimate for blocks of size 2^( 4) =       0.000451701410
  error estimate for blocks of size 2^( 5) =       0.000462467210
  error estimate for blocks of size 2^( 6) =       0.000470038082
  error estimate for blocks of size 2^( 7) =       0.000474063259

      target function =                  N/A
              le_mean =     -16.909782330332
             les_mean =     286.285181971235
             stat err =       0.000464567490
             autocorr =       1.253168299614
              std dev =       0.586893247735
             le_variance =       0.344443684237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344516021124
                                         uncertainty =       0.007460958490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344516021124
                                         uncertainty =       0.007460958490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414996116
  error estimate for blocks of size 2^( 2) =       0.000427067808
  error estimate for blocks of size 2^( 3) =       0.000439712053
  error estimate for blocks of size 2^( 4) =       0.000451701346
  error estimate for blocks of size 2^( 5) =       0.000462467152
  error estimate for blocks of size 2^( 6) =       0.000470038065
  error estimate for blocks of size 2^( 7) =       0.000474063217

      target function =                  N/A
              le_mean =     -16.909782333572
             les_mean =     286.285181949937
             stat err =       0.000464567445
             autocorr =       1.253168530705
              std dev =       0.586893136258
             le_variance =       0.344443553387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344515905895
                                         uncertainty =       0.007460949628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344515905895
                                         uncertainty =       0.007460949628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414996047
  error estimate for blocks of size 2^( 2) =       0.000427067739
  error estimate for blocks of size 2^( 3) =       0.000439711987
  error estimate for blocks of size 2^( 4) =       0.000451701289
  error estimate for blocks of size 2^( 5) =       0.000462467100
  error estimate for blocks of size 2^( 6) =       0.000470038051
  error estimate for blocks of size 2^( 7) =       0.000474063180

      target function =                  N/A
              le_mean =     -16.909782336456
             les_mean =     286.285181932495
             stat err =       0.000464567405
             autocorr =       1.253168733615
              std dev =       0.586893038292
             le_variance =       0.344443438395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909782336870        initial  <--
     5.9605e+01     5.9605e+02             3.8589e-06       -16.909782330332
     2.3842e+02     2.3842e+03             9.6491e-07       -16.909782333572
     9.5367e+02     9.5367e+03             2.4124e-07       -16.909782336456

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3557
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260067e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849637e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765111e-03 1 1  ON 13
 ud_4                -5.994840e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167900e-01 1 1  ON 24
 eO_5                 4.709095e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094876e-01 1 1  ON 28
 eO_9                -6.753611e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379306e-01 1 1  ON 31
eH1_2                -9.593159e-02 1 1  ON 32
eH1_3                -4.424773e-02 1 1  ON 33
eH1_4                 1.212434e-02 1 1  ON 34
eH1_5                 4.908194e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512598e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548724e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455233e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347357e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8837
    reference variance = 0.845083
====================================================
  Execution time = 2.8404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3114e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331150439670
                                         uncertainty =       0.003056843436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331150439670
                                         uncertainty =       0.003056843436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406905132
  error estimate for blocks of size 2^( 2) =       0.000418801076
  error estimate for blocks of size 2^( 3) =       0.000432157891
  error estimate for blocks of size 2^( 4) =       0.000444485085
  error estimate for blocks of size 2^( 5) =       0.000456150870
  error estimate for blocks of size 2^( 6) =       0.000464137727
  error estimate for blocks of size 2^( 7) =       0.000468780228

      target function =                  N/A
              le_mean =     -16.909055036099
             les_mean =     286.247285621913
             stat err =       0.000458388478
             autocorr =       1.269056765982
              std dev =       0.575450756951
             le_variance =       0.331143573676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690905503610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909055036099       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909055036936       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909055037905       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909055037768       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909055039117       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909055038857       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909055038667       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909055038595       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.103728e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909055036099       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909055036308       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909055036550       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909055036516       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909055036852       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909055036788       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909055036738       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909055036715       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.026018e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909055036099       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909055036151       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909055036211       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909055036203       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909055036287       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909055036271       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909055036259       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909055036253       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.565100e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5521e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717560e-02 1 1  ON 3
 uu_4                -6.522335e-02 1 1  ON 4
 uu_5                -9.998933e-02 1 1  ON 5
 uu_6                -1.260068e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849636e-02 1 1  ON 9
 ud_0                 4.279525e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205946e-02 1 1  ON 12
 ud_3                -4.765119e-03 1 1  ON 13
 ud_4                -5.994838e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517638e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327627e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167901e-01 1 1  ON 24
 eO_5                 4.709096e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378142e-02 1 1  ON 27
 eO_8                -2.094877e-01 1 1  ON 28
 eO_9                -6.753616e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379307e-01 1 1  ON 31
eH1_2                -9.593167e-02 1 1  ON 32
eH1_3                -4.424779e-02 1 1  ON 33
eH1_4                 1.212429e-02 1 1  ON 34
eH1_5                 4.908196e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512599e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548732e-02 1 1  ON 39
eH2_0                -2.405782e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455241e-02 1 1  ON 42
eH2_3                -4.289455e-02 1 1  ON 43
eH2_4                 1.347350e-02 1 1  ON 44
eH2_5                 5.133492e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170760e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8035
    reference variance = 0.316679
====================================================
  Execution time = 2.7740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.0000e+06
  Execution time = 3.4536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341240759719
                                         uncertainty =       0.003603400818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341240759719
                                         uncertainty =       0.003603400818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413070702
  error estimate for blocks of size 2^( 2) =       0.000425189032
  error estimate for blocks of size 2^( 3) =       0.000438356750
  error estimate for blocks of size 2^( 4) =       0.000450712947
  error estimate for blocks of size 2^( 5) =       0.000460516839
  error estimate for blocks of size 2^( 6) =       0.000469134738
  error estimate for blocks of size 2^( 7) =       0.000472333233

      target function =                  N/A
              le_mean =     -16.909493151276
             les_mean =     286.272213271848
             stat err =       0.000463174439
             autocorr =       1.257304249641
              std dev =       0.584170188762
             le_variance =       0.341254809438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341241087830
                                         uncertainty =       0.003603404288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341241087830
                                         uncertainty =       0.003603404288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413070900
  error estimate for blocks of size 2^( 2) =       0.000425189221
  error estimate for blocks of size 2^( 3) =       0.000438356931
  error estimate for blocks of size 2^( 4) =       0.000450713118
  error estimate for blocks of size 2^( 5) =       0.000460517004
  error estimate for blocks of size 2^( 6) =       0.000469134905
  error estimate for blocks of size 2^( 7) =       0.000472333392

      target function =                  N/A
              le_mean =     -16.909493149296
             les_mean =     286.272213533016
             stat err =       0.000463174605
             autocorr =       1.257303940088
              std dev =       0.584170469599
             le_variance =       0.341255137552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341240923849
                                         uncertainty =       0.003603402554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341240923849
                                         uncertainty =       0.003603402554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413070801
  error estimate for blocks of size 2^( 2) =       0.000425189126
  error estimate for blocks of size 2^( 3) =       0.000438356841
  error estimate for blocks of size 2^( 4) =       0.000450713033
  error estimate for blocks of size 2^( 5) =       0.000460516922
  error estimate for blocks of size 2^( 6) =       0.000469134821
  error estimate for blocks of size 2^( 7) =       0.000472333312

      target function =                  N/A
              le_mean =     -16.909493150285
             les_mean =     286.272213402485
             stat err =       0.000463174522
             autocorr =       1.257304094802
              std dev =       0.584170329245
             le_variance =       0.341254973570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341240780238
                                         uncertainty =       0.003603401035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341240780238
                                         uncertainty =       0.003603401035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413070714
  error estimate for blocks of size 2^( 2) =       0.000425189044
  error estimate for blocks of size 2^( 3) =       0.000438356761
  error estimate for blocks of size 2^( 4) =       0.000450712958
  error estimate for blocks of size 2^( 5) =       0.000460516849
  error estimate for blocks of size 2^( 6) =       0.000469134748
  error estimate for blocks of size 2^( 7) =       0.000472333243

      target function =                  N/A
              le_mean =     -16.909493151152
             les_mean =     286.272213288180
             stat err =       0.000463174449
             autocorr =       1.257304230277
              std dev =       0.584170206324
             le_variance =       0.341254829957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909493151276        initial  <--
     5.9605e+02     5.9605e+03             4.1037e-07       -16.909493149296
     2.3842e+03     2.3842e+04             1.0260e-07       -16.909493150285
     9.5367e+03     9.5367e+04             2.5651e-08       -16.909493151152

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2299
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260067e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849637e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765111e-03 1 1  ON 13
 ud_4                -5.994840e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167900e-01 1 1  ON 24
 eO_5                 4.709095e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094876e-01 1 1  ON 28
 eO_9                -6.753611e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379306e-01 1 1  ON 31
eH1_2                -9.593159e-02 1 1  ON 32
eH1_3                -4.424773e-02 1 1  ON 33
eH1_4                 1.212434e-02 1 1  ON 34
eH1_5                 4.908194e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512598e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548724e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455233e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347357e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8932
    reference variance = 0.348912
====================================================
  Execution time = 2.8243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5800e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358063001859
                                         uncertainty =       0.008984352709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358063001859
                                         uncertainty =       0.008984352709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423083014
  error estimate for blocks of size 2^( 2) =       0.000434238711
  error estimate for blocks of size 2^( 3) =       0.000446754726
  error estimate for blocks of size 2^( 4) =       0.000458699354
  error estimate for blocks of size 2^( 5) =       0.000469123043
  error estimate for blocks of size 2^( 6) =       0.000477436339
  error estimate for blocks of size 2^( 7) =       0.000485010443

      target function =                  N/A
              le_mean =     -16.908849395565
             les_mean =     286.267186175793
             stat err =       0.000472567295
             autocorr =       1.247602238738
              std dev =       0.598329735937
             le_variance =       0.357998472907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690884939556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908849395565       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908849395535       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908849395672       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908849395755       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908849395859       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908849395853       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908849395835       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908849395833       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.638576e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908849395565       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908849395557       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908849395591       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908849395613       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908849395644       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908849395641       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908849395632       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908849395630       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.159645e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908849395565       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908849395563       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908849395571       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908849395577       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908849395580       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908849395571       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908849395582       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908849395637       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.899113e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5436e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574601e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522331e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260068e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849637e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765111e-03 1 1  ON 13
 ud_4                -5.994840e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167900e-01 1 1  ON 24
 eO_5                 4.709095e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094877e-01 1 1  ON 28
 eO_9                -6.753612e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379306e-01 1 1  ON 31
eH1_2                -9.593160e-02 1 1  ON 32
eH1_3                -4.424774e-02 1 1  ON 33
eH1_4                 1.212433e-02 1 1  ON 34
eH1_5                 4.908193e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512598e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548725e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455234e-02 1 1  ON 42
eH2_3                -4.289452e-02 1 1  ON 43
eH2_4                 1.347356e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170751e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 0.208573
====================================================
  Execution time = 2.7653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4037e-01
  Total weights = 2.0000e+06
  Execution time = 3.4423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390321631
                                         uncertainty =       0.006002627529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390321631
                                         uncertainty =       0.006002627529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412537145
  error estimate for blocks of size 2^( 2) =       0.000424551581
  error estimate for blocks of size 2^( 3) =       0.000437230259
  error estimate for blocks of size 2^( 4) =       0.000449936585
  error estimate for blocks of size 2^( 5) =       0.000460801883
  error estimate for blocks of size 2^( 6) =       0.000470015110
  error estimate for blocks of size 2^( 7) =       0.000475984037

      target function =                  N/A
              le_mean =     -16.909349952520
             les_mean =     286.266489438356
             stat err =       0.000464184404
             autocorr =       1.266061993686
              std dev =       0.583415625237
             le_variance =       0.340373791771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390333597
                                         uncertainty =       0.006002627787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390333597
                                         uncertainty =       0.006002627787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412537152
  error estimate for blocks of size 2^( 2) =       0.000424551588
  error estimate for blocks of size 2^( 3) =       0.000437230265
  error estimate for blocks of size 2^( 4) =       0.000449936590
  error estimate for blocks of size 2^( 5) =       0.000460801888
  error estimate for blocks of size 2^( 6) =       0.000470015115
  error estimate for blocks of size 2^( 7) =       0.000475984042

      target function =                  N/A
              le_mean =     -16.909349952844
             les_mean =     286.266489461290
             stat err =       0.000464184409
             autocorr =       1.266061976758
              std dev =       0.583415635483
             le_variance =       0.340373803727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390327614
                                         uncertainty =       0.006002627658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390327614
                                         uncertainty =       0.006002627658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412537148
  error estimate for blocks of size 2^( 2) =       0.000424551584
  error estimate for blocks of size 2^( 3) =       0.000437230262
  error estimate for blocks of size 2^( 4) =       0.000449936588
  error estimate for blocks of size 2^( 5) =       0.000460801886
  error estimate for blocks of size 2^( 6) =       0.000470015113
  error estimate for blocks of size 2^( 7) =       0.000475984039

      target function =                  N/A
              le_mean =     -16.909349952682
             les_mean =     286.266489449823
             stat err =       0.000464184406
             autocorr =       1.266061985220
              std dev =       0.583415630360
             le_variance =       0.340373797749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390322379
                                         uncertainty =       0.006002627545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390322379
                                         uncertainty =       0.006002627545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412537145
  error estimate for blocks of size 2^( 2) =       0.000424551581
  error estimate for blocks of size 2^( 3) =       0.000437230259
  error estimate for blocks of size 2^( 4) =       0.000449936585
  error estimate for blocks of size 2^( 5) =       0.000460801883
  error estimate for blocks of size 2^( 6) =       0.000470015111
  error estimate for blocks of size 2^( 7) =       0.000475984037

      target function =                  N/A
              le_mean =     -16.909349952540
             les_mean =     286.266489439789
             stat err =       0.000464184404
             autocorr =       1.266061992627
              std dev =       0.583415625877
             le_variance =       0.340373792518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909349952520        initial
     5.9605e+03     5.9605e+04             4.6386e-08       -16.909349952844  <--
     2.3842e+04     2.3842e+05             1.1596e-08       -16.909349952682
     9.5367e+04     9.5367e+05             2.8991e-09       -16.909349952540

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 4.5161e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574600e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522332e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260068e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849636e-02 1 1  ON 9
 ud_0                 4.279524e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765110e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845819e-02 1 1  ON 22
 eO_3                 2.981614e-01 1 1  ON 23
 eO_4                 5.167901e-01 1 1  ON 24
 eO_5                 4.709096e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378144e-02 1 1  ON 27
 eO_8                -2.094877e-01 1 1  ON 28
 eO_9                -6.753613e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379307e-01 1 1  ON 31
eH1_2                -9.593161e-02 1 1  ON 32
eH1_3                -4.424775e-02 1 1  ON 33
eH1_4                 1.212432e-02 1 1  ON 34
eH1_5                 4.908191e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512599e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548727e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455238e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347355e-02 1 1  ON 44
eH2_5                 5.133488e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.225583
====================================================
  Execution time = 2.8271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3852e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338535846076
                                         uncertainty =       0.005022968778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338535846076
                                         uncertainty =       0.005022968778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411411148
  error estimate for blocks of size 2^( 2) =       0.000423498783
  error estimate for blocks of size 2^( 3) =       0.000436248285
  error estimate for blocks of size 2^( 4) =       0.000448427639
  error estimate for blocks of size 2^( 5) =       0.000458199147
  error estimate for blocks of size 2^( 6) =       0.000465795010
  error estimate for blocks of size 2^( 7) =       0.000469960965

      target function =                  N/A
              le_mean =     -16.909521836358
             les_mean =     286.270446830078
             stat err =       0.000460595690
             autocorr =       1.253394051912
              std dev =       0.581823224935
             le_variance =       0.338518265074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690952183636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909521836358       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909521836725       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909521836999       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909521837149       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909521837055       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909521836980       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909521837012       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909521837056       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.125907e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909521836358       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909521836450       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909521836518       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909521836560       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909521836533       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909521836508       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909521836523       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909521836567       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 5.314788e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909521836358       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909521836381       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909521836398       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909521836407       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909521836401       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909521836380       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909521836402       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909521836397       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.328698e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5451e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.098829e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574602e-02 1 1  ON 2
 uu_3                -1.717558e-02 1 1  ON 3
 uu_4                -6.522331e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260068e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849640e-02 1 1  ON 9
 ud_0                 4.279525e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205948e-02 1 1  ON 12
 ud_3                -4.765095e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015492e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405609e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845821e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167901e-01 1 1  ON 24
 eO_5                 4.709096e-01 1 1  ON 25
 eO_6                 2.409282e-01 1 1  ON 26
 eO_7                -5.378143e-02 1 1  ON 27
 eO_8                -2.094877e-01 1 1  ON 28
 eO_9                -6.753616e-02 1 1  ON 29
eH1_0                -2.420017e-01 1 1  ON 30
eH1_1                -1.379307e-01 1 1  ON 31
eH1_2                -9.593162e-02 1 1  ON 32
eH1_3                -4.424776e-02 1 1  ON 33
eH1_4                 1.212430e-02 1 1  ON 34
eH1_5                 4.908189e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512599e-01 1 1  ON 37
eH1_8                 1.602272e-01 1 1  ON 38
eH1_9                 4.548731e-02 1 1  ON 39
eH2_0                -2.405781e-01 1 1  ON 40
eH2_1                -1.368981e-01 1 1  ON 41
eH2_2                -9.455240e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347354e-02 1 1  ON 44
eH2_5                 5.133489e-02 1 1  ON 45
eH2_6                 1.082984e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705158e-01 1 1  ON 48
eH2_9                 3.170757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9259
    reference variance = 0.214527
====================================================
  Execution time = 2.8157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3622e-01
  Total weights = 2.0000e+06
  Execution time = 3.8958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301184933
                                         uncertainty =       0.002701655953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301184933
                                         uncertainty =       0.002701655953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410012882
  error estimate for blocks of size 2^( 2) =       0.000421956568
  error estimate for blocks of size 2^( 3) =       0.000434488966
  error estimate for blocks of size 2^( 4) =       0.000446836886
  error estimate for blocks of size 2^( 5) =       0.000458662531
  error estimate for blocks of size 2^( 6) =       0.000467448127
  error estimate for blocks of size 2^( 7) =       0.000471702806

      target function =                  N/A
              le_mean =     -16.908575798620
             les_mean =     286.236156496925
             stat err =       0.000461162587
             autocorr =       1.265065843431
              std dev =       0.579845778937
             le_variance =       0.336221127351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301277595
                                         uncertainty =       0.002701656784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301277595
                                         uncertainty =       0.002701656784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410012939
  error estimate for blocks of size 2^( 2) =       0.000421956621
  error estimate for blocks of size 2^( 3) =       0.000434489016
  error estimate for blocks of size 2^( 4) =       0.000446836933
  error estimate for blocks of size 2^( 5) =       0.000458662577
  error estimate for blocks of size 2^( 6) =       0.000467448174
  error estimate for blocks of size 2^( 7) =       0.000471702852

      target function =                  N/A
              le_mean =     -16.908575798807
             les_mean =     286.236156595904
             stat err =       0.000461162634
             autocorr =       1.265065750975
              std dev =       0.579845858842
             le_variance =       0.336221220017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301231274
                                         uncertainty =       0.002701656369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301231274
                                         uncertainty =       0.002701656369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410012911
  error estimate for blocks of size 2^( 2) =       0.000421956595
  error estimate for blocks of size 2^( 3) =       0.000434488991
  error estimate for blocks of size 2^( 4) =       0.000446836910
  error estimate for blocks of size 2^( 5) =       0.000458662554
  error estimate for blocks of size 2^( 6) =       0.000467448150
  error estimate for blocks of size 2^( 7) =       0.000471702829

      target function =                  N/A
              le_mean =     -16.908575798714
             les_mean =     286.236156546425
             stat err =       0.000461162611
             autocorr =       1.265065797187
              std dev =       0.579845818898
             le_variance =       0.336221173694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301190726
                                         uncertainty =       0.002701656005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336301190726
                                         uncertainty =       0.002701656005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410012886
  error estimate for blocks of size 2^( 2) =       0.000421956571
  error estimate for blocks of size 2^( 3) =       0.000434488969
  error estimate for blocks of size 2^( 4) =       0.000446836889
  error estimate for blocks of size 2^( 5) =       0.000458662534
  error estimate for blocks of size 2^( 6) =       0.000467448130
  error estimate for blocks of size 2^( 7) =       0.000471702809

      target function =                  N/A
              le_mean =     -16.908575798632
             les_mean =     286.236156503113
             stat err =       0.000461162590
             autocorr =       1.265065837658
              std dev =       0.579845783932
             le_variance =       0.336221133144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908575798620        initial
     1.4901e+03     1.4901e+04             2.1259e-07       -16.908575798807  <--
     5.9605e+03     5.9605e+04             5.3148e-08       -16.908575798714
     2.3842e+04     2.3842e+05             1.3287e-08       -16.908575798632

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 4.6305e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.098830e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574609e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522329e-02 1 1  ON 4
 uu_5                -9.998930e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383842e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849649e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205950e-02 1 1  ON 12
 ud_3                -4.765050e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845827e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167901e-01 1 1  ON 24
 eO_5                 4.709096e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378140e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753623e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379307e-01 1 1  ON 31
eH1_2                -9.593167e-02 1 1  ON 32
eH1_3                -4.424779e-02 1 1  ON 33
eH1_4                 1.212426e-02 1 1  ON 34
eH1_5                 4.908183e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602274e-01 1 1  ON 38
eH1_9                 4.548741e-02 1 1  ON 39
eH2_0                -2.405782e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455248e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347351e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170764e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1764e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8721
    reference variance = 0.316731
====================================================
  Execution time = 2.8178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4770e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347785242248
                                         uncertainty =       0.007467242852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347785242248
                                         uncertainty =       0.007467242852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416952390
  error estimate for blocks of size 2^( 2) =       0.000428676204
  error estimate for blocks of size 2^( 3) =       0.000441778666
  error estimate for blocks of size 2^( 4) =       0.000452924917
  error estimate for blocks of size 2^( 5) =       0.000462794076
  error estimate for blocks of size 2^( 6) =       0.000469513102
  error estimate for blocks of size 2^( 7) =       0.000473454652

      target function =                  N/A
              le_mean =     -16.909606888885
             les_mean =     286.282503553164
             stat err =       0.000464671687
             autocorr =       1.241993970746
              std dev =       0.589659724250
             le_variance =       0.347698590402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690960688888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909606888885       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909606890986       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909606894016       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909606896627       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909606896602       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909606896862       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909606896487       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909606896370       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 7.027828e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909606888885       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909606889410       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909606890168       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909606890821       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909606890815       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909606890879       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909606890782       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909606890750       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.757102e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909606888885       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909606889016       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909606889205       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909606889368       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909606889366       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909606889389       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909606889347       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909606889354       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.392849e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312430 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5252e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.098830e-01 1 1  ON 0
 uu_1                 1.445450e-01 1 1  ON 1
 uu_2                 4.574616e-02 1 1  ON 2
 uu_3                -1.717555e-02 1 1  ON 3
 uu_4                -6.522329e-02 1 1  ON 4
 uu_5                -9.998935e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383842e-01 1 1  ON 7
 uu_8                -1.305256e-01 1 1  ON 8
 uu_9                -9.849659e-02 1 1  ON 9
 ud_0                 4.279525e-01 1 1  ON 10
 ud_1                 1.728365e-01 1 1  ON 11
 ud_2                 6.205954e-02 1 1  ON 12
 ud_3                -4.765026e-03 1 1  ON 13
 ud_4                -5.994831e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300996e-01 1 1  ON 16
 ud_7                -1.482469e-01 1 1  ON 17
 ud_8                -1.517640e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327627e-01 1 1  ON 21
 eO_2                -1.845845e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709098e-01 1 1  ON 25
 eO_6                 2.409284e-01 1 1  ON 26
 eO_7                -5.378142e-02 1 1  ON 27
 eO_8                -2.094879e-01 1 1  ON 28
 eO_9                -6.753632e-02 1 1  ON 29
eH1_0                -2.420019e-01 1 1  ON 30
eH1_1                -1.379309e-01 1 1  ON 31
eH1_2                -9.593181e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212414e-02 1 1  ON 34
eH1_5                 4.908178e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512601e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548752e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455259e-02 1 1  ON 42
eH2_3                -4.289459e-02 1 1  ON 43
eH2_4                 1.347338e-02 1 1  ON 44
eH2_5                 5.133480e-02 1 1  ON 45
eH2_6                 1.082986e-01 1 1  ON 46
eH2_7                 1.564590e-01 1 1  ON 47
eH2_8                 1.705160e-01 1 1  ON 48
eH2_9                 3.170779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9433
    reference variance = 0.438171
====================================================
  Execution time = 2.7842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3766e-01
  Total weights = 2.0000e+06
  Execution time = 3.4635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410349569
                                         uncertainty =       0.005434758466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410349569
                                         uncertainty =       0.005434758466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410890493
  error estimate for blocks of size 2^( 2) =       0.000423338813
  error estimate for blocks of size 2^( 3) =       0.000436323941
  error estimate for blocks of size 2^( 4) =       0.000448564744
  error estimate for blocks of size 2^( 5) =       0.000459170233
  error estimate for blocks of size 2^( 6) =       0.000467485168
  error estimate for blocks of size 2^( 7) =       0.000470966054

      target function =                  N/A
              le_mean =     -16.908893603954
             les_mean =     286.248344735103
             stat err =       0.000461546550
             autocorr =       1.261766035062
              std dev =       0.581086907511
             le_variance =       0.337661994081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337409981136
                                         uncertainty =       0.005434748333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337409981136
                                         uncertainty =       0.005434748333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410890269
  error estimate for blocks of size 2^( 2) =       0.000423338600
  error estimate for blocks of size 2^( 3) =       0.000436323735
  error estimate for blocks of size 2^( 4) =       0.000448564544
  error estimate for blocks of size 2^( 5) =       0.000459170033
  error estimate for blocks of size 2^( 6) =       0.000467484964
  error estimate for blocks of size 2^( 7) =       0.000470965854

      target function =                  N/A
              le_mean =     -16.908893602764
             les_mean =     286.248344326279
             stat err =       0.000461546349
             autocorr =       1.261766311715
              std dev =       0.581086590369
             le_variance =       0.337661625507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410165147
                                         uncertainty =       0.005434753393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410165147
                                         uncertainty =       0.005434753393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410890381
  error estimate for blocks of size 2^( 2) =       0.000423338706
  error estimate for blocks of size 2^( 3) =       0.000436323838
  error estimate for blocks of size 2^( 4) =       0.000448564644
  error estimate for blocks of size 2^( 5) =       0.000459170132
  error estimate for blocks of size 2^( 6) =       0.000467485066
  error estimate for blocks of size 2^( 7) =       0.000470965954

      target function =                  N/A
              le_mean =     -16.908893603358
             les_mean =     286.248344530447
             stat err =       0.000461546449
             autocorr =       1.261766173627
              std dev =       0.581086748763
             le_variance =       0.337661809588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410326509
                                         uncertainty =       0.005434757832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410326509
                                         uncertainty =       0.005434757832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410890479
  error estimate for blocks of size 2^( 2) =       0.000423338799
  error estimate for blocks of size 2^( 3) =       0.000436323928
  error estimate for blocks of size 2^( 4) =       0.000448564732
  error estimate for blocks of size 2^( 5) =       0.000459170220
  error estimate for blocks of size 2^( 6) =       0.000467485156
  error estimate for blocks of size 2^( 7) =       0.000470966042

      target function =                  N/A
              le_mean =     -16.908893603880
             les_mean =     286.248344709512
             stat err =       0.000461546537
             autocorr =       1.261766052394
              std dev =       0.581086887662
             le_variance =       0.337661971012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908893603954        initial  <--
     3.7253e+02     3.7253e+03             7.0278e-07       -16.908893602764
     1.4901e+03     1.4901e+04             1.7571e-07       -16.908893603358
     5.9605e+03     5.9605e+04             4.3928e-08       -16.908893603880

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5309
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.098830e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574609e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522329e-02 1 1  ON 4
 uu_5                -9.998930e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383842e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849649e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205950e-02 1 1  ON 12
 ud_3                -4.765050e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845827e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167901e-01 1 1  ON 24
 eO_5                 4.709096e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378140e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753623e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379307e-01 1 1  ON 31
eH1_2                -9.593167e-02 1 1  ON 32
eH1_3                -4.424779e-02 1 1  ON 33
eH1_4                 1.212426e-02 1 1  ON 34
eH1_5                 4.908183e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602274e-01 1 1  ON 38
eH1_9                 4.548741e-02 1 1  ON 39
eH2_0                -2.405782e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455248e-02 1 1  ON 42
eH2_3                -4.289451e-02 1 1  ON 43
eH2_4                 1.347351e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170764e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0791e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8745
    reference variance = 0.195515
====================================================
  Execution time = 2.8492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338478265846
                                         uncertainty =       0.003879724419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338478265846
                                         uncertainty =       0.003879724419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411896489
  error estimate for blocks of size 2^( 2) =       0.000424197039
  error estimate for blocks of size 2^( 3) =       0.000437137667
  error estimate for blocks of size 2^( 4) =       0.000448851538
  error estimate for blocks of size 2^( 5) =       0.000458712224
  error estimate for blocks of size 2^( 6) =       0.000466717654
  error estimate for blocks of size 2^( 7) =       0.000471487984

      target function =                  N/A
              le_mean =     -16.909632016330
             les_mean =     286.274972192827
             stat err =       0.000461442350
             autocorr =       1.255043334584
              std dev =       0.582509600594
             le_variance =       0.339317434784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690963201633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909632016330       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909632016443       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909632016843       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909632016823       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909632016845       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909632016744       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909632016756       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909632016749       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 8.575064e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909632016330       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909632016358       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909632016458       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909632016453       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909632016463       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909632016431       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909632016443       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909632016443       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.143811e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909632016330       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909632016337       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909632016362       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909632016323       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909632016365       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909632016355       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909632016349       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909632016351       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.359556e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5604e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.098830e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574608e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522329e-02 1 1  ON 4
 uu_5                -9.998931e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849649e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205950e-02 1 1  ON 12
 ud_3                -4.765049e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845827e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709096e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753624e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593168e-02 1 1  ON 32
eH1_3                -4.424780e-02 1 1  ON 33
eH1_4                 1.212425e-02 1 1  ON 34
eH1_5                 4.908183e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602274e-01 1 1  ON 38
eH1_9                 4.548743e-02 1 1  ON 39
eH2_0                -2.405782e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455250e-02 1 1  ON 42
eH2_3                -4.289452e-02 1 1  ON 43
eH2_4                 1.347350e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170766e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9982
    reference variance = 1.23567
====================================================
  Execution time = 2.7941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3906e-01
  Total weights = 2.0000e+06
  Execution time = 3.4727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114807795
                                         uncertainty =       0.003957087893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114807795
                                         uncertainty =       0.003957087893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411740465
  error estimate for blocks of size 2^( 2) =       0.000423887927
  error estimate for blocks of size 2^( 3) =       0.000436573818
  error estimate for blocks of size 2^( 4) =       0.000449017888
  error estimate for blocks of size 2^( 5) =       0.000459478615
  error estimate for blocks of size 2^( 6) =       0.000467653013
  error estimate for blocks of size 2^( 7) =       0.000473132729

      target function =                  N/A
              le_mean =     -16.909009764679
             les_mean =     286.253671473557
             stat err =       0.000462320561
             autocorr =       1.260780015330
              std dev =       0.582288949813
             le_variance =       0.339060421074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114866534
                                         uncertainty =       0.003957088455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114866534
                                         uncertainty =       0.003957088455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411740501
  error estimate for blocks of size 2^( 2) =       0.000423887961
  error estimate for blocks of size 2^( 3) =       0.000436573850
  error estimate for blocks of size 2^( 4) =       0.000449017919
  error estimate for blocks of size 2^( 5) =       0.000459478645
  error estimate for blocks of size 2^( 6) =       0.000467653041
  error estimate for blocks of size 2^( 7) =       0.000473132756

      target function =                  N/A
              le_mean =     -16.909009764765
             les_mean =     286.253671535240
             stat err =       0.000462320590
             autocorr =       1.260779954757
              std dev =       0.582289000281
             le_variance =       0.339060479848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114837166
                                         uncertainty =       0.003957088174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114837166
                                         uncertainty =       0.003957088174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411740483
  error estimate for blocks of size 2^( 2) =       0.000423887944
  error estimate for blocks of size 2^( 3) =       0.000436573834
  error estimate for blocks of size 2^( 4) =       0.000449017904
  error estimate for blocks of size 2^( 5) =       0.000459478630
  error estimate for blocks of size 2^( 6) =       0.000467653027
  error estimate for blocks of size 2^( 7) =       0.000473132742

      target function =                  N/A
              le_mean =     -16.909009764722
             les_mean =     286.253671504400
             stat err =       0.000462320576
             autocorr =       1.260779985037
              std dev =       0.582288975048
             le_variance =       0.339060450463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114811466
                                         uncertainty =       0.003957087928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339114811466
                                         uncertainty =       0.003957087928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411740467
  error estimate for blocks of size 2^( 2) =       0.000423887929
  error estimate for blocks of size 2^( 3) =       0.000436573820
  error estimate for blocks of size 2^( 4) =       0.000449017890
  error estimate for blocks of size 2^( 5) =       0.000459478617
  error estimate for blocks of size 2^( 6) =       0.000467653015
  error estimate for blocks of size 2^( 7) =       0.000473132731

      target function =                  N/A
              le_mean =     -16.909009764684
             les_mean =     286.253671477412
             stat err =       0.000462320563
             autocorr =       1.260780011545
              std dev =       0.582288952967
             le_variance =       0.339060424748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909009764679        initial
     3.7253e+03     3.7253e+04             8.5751e-08       -16.909009764765  <--
     1.4901e+04     1.4901e+05             2.1438e-08       -16.909009764722
     5.9605e+04     5.9605e+05             5.3596e-09       -16.909009764684

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 4.5650e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1264e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8733
    reference variance = 0.253245
====================================================
  Execution time = 2.8462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337654072554
                                         uncertainty =       0.004512679438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337654072554
                                         uncertainty =       0.004512679438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829698
  error estimate for blocks of size 2^( 2) =       0.000422934395
  error estimate for blocks of size 2^( 3) =       0.000435682922
  error estimate for blocks of size 2^( 4) =       0.000448572038
  error estimate for blocks of size 2^( 5) =       0.000459998461
  error estimate for blocks of size 2^( 6) =       0.000468822307
  error estimate for blocks of size 2^( 7) =       0.000472551397

      target function =                  N/A
              le_mean =     -16.909241309508
             les_mean =     286.260003575760
             stat err =       0.000462486051
             autocorr =       1.267283020094
              std dev =       0.581000930599
             le_variance =       0.337562081357


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690924130951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909241309508       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909241309392       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909241309804       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909241309484       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909241310261       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909241310348       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909241310335       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909241310307       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 3.277132e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909241309508       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909241309479       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909241309582       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909241309502       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909241309697       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909241309719       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909241309715       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909241309709       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 8.192928e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909241309508       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909241309501       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909241309527       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909241309507       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909241309548       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909241309556       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909241309555       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909241309568       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.048238e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5710e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574608e-02 1 1  ON 2
 uu_3                -1.717559e-02 1 1  ON 3
 uu_4                -6.522332e-02 1 1  ON 4
 uu_5                -9.998933e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205953e-02 1 1  ON 12
 ud_3                -4.765031e-03 1 1  ON 13
 ud_4                -5.994838e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482469e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327627e-01 1 1  ON 21
 eO_2                -1.845831e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378138e-02 1 1  ON 27
 eO_8                -2.094879e-01 1 1  ON 28
 eO_9                -6.753630e-02 1 1  ON 29
eH1_0                -2.420019e-01 1 1  ON 30
eH1_1                -1.379309e-01 1 1  ON 31
eH1_2                -9.593174e-02 1 1  ON 32
eH1_3                -4.424784e-02 1 1  ON 33
eH1_4                 1.212421e-02 1 1  ON 34
eH1_5                 4.908183e-02 1 1  ON 35
eH1_6                 1.057298e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548751e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455258e-02 1 1  ON 42
eH2_3                -4.289456e-02 1 1  ON 43
eH2_4                 1.347346e-02 1 1  ON 44
eH2_5                 5.133489e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564589e-01 1 1  ON 47
eH2_8                 1.705160e-01 1 1  ON 48
eH2_9                 3.170780e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9033
    reference variance = 0.306837
====================================================
  Execution time = 2.7600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4518e-01
  Total weights = 2.0000e+06
  Execution time = 3.4811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201498994
                                         uncertainty =       0.005258921375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201498994
                                         uncertainty =       0.005258921375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415439128
  error estimate for blocks of size 2^( 2) =       0.000427197234
  error estimate for blocks of size 2^( 3) =       0.000439182293
  error estimate for blocks of size 2^( 4) =       0.000450937327
  error estimate for blocks of size 2^( 5) =       0.000460135740
  error estimate for blocks of size 2^( 6) =       0.000468440181
  error estimate for blocks of size 2^( 7) =       0.000470444362

      target function =                  N/A
              le_mean =     -16.910069144547
             les_mean =     286.295617639688
             stat err =       0.000462489402
             autocorr =       1.239335169800
              std dev =       0.587519649812
             le_variance =       0.345179338915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201455138
                                         uncertainty =       0.005258920991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201455138
                                         uncertainty =       0.005258920991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415439102
  error estimate for blocks of size 2^( 2) =       0.000427197211
  error estimate for blocks of size 2^( 3) =       0.000439182273
  error estimate for blocks of size 2^( 4) =       0.000450937309
  error estimate for blocks of size 2^( 5) =       0.000460135723
  error estimate for blocks of size 2^( 6) =       0.000468440165
  error estimate for blocks of size 2^( 7) =       0.000470444343

      target function =                  N/A
              le_mean =     -16.910069143774
             les_mean =     286.295617569675
             stat err =       0.000462489385
             autocorr =       1.239335233729
              std dev =       0.587519612490
             le_variance =       0.345179295060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201477060
                                         uncertainty =       0.005258921183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201477060
                                         uncertainty =       0.005258921183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415439115
  error estimate for blocks of size 2^( 2) =       0.000427197222
  error estimate for blocks of size 2^( 3) =       0.000439182283
  error estimate for blocks of size 2^( 4) =       0.000450937318
  error estimate for blocks of size 2^( 5) =       0.000460135731
  error estimate for blocks of size 2^( 6) =       0.000468440173
  error estimate for blocks of size 2^( 7) =       0.000470444352

      target function =                  N/A
              le_mean =     -16.910069144160
             les_mean =     286.295617604670
             stat err =       0.000462489394
             autocorr =       1.239335201769
              std dev =       0.587519631145
             le_variance =       0.345179316981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201496252
                                         uncertainty =       0.005258921351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345201496252
                                         uncertainty =       0.005258921351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415439127
  error estimate for blocks of size 2^( 2) =       0.000427197232
  error estimate for blocks of size 2^( 3) =       0.000439182291
  error estimate for blocks of size 2^( 4) =       0.000450937326
  error estimate for blocks of size 2^( 5) =       0.000460135739
  error estimate for blocks of size 2^( 6) =       0.000468440180
  error estimate for blocks of size 2^( 7) =       0.000470444361

      target function =                  N/A
              le_mean =     -16.910069144499
             les_mean =     286.295617635311
             stat err =       0.000462489401
             autocorr =       1.239335173794
              std dev =       0.587519647478
             le_variance =       0.345179336173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910069144547        initial  <--
     9.3132e+02     9.3132e+03             3.2771e-07       -16.910069143774
     3.7253e+03     3.7253e+04             8.1929e-08       -16.910069144160
     1.4901e+04     1.4901e+05             2.0482e-08       -16.910069144499

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3760
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8411
    reference variance = 0.18215
====================================================
  Execution time = 2.8471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357143282523
                                         uncertainty =       0.012657387650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357143282523
                                         uncertainty =       0.012657387650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422508118
  error estimate for blocks of size 2^( 2) =       0.000434108458
  error estimate for blocks of size 2^( 3) =       0.000446459336
  error estimate for blocks of size 2^( 4) =       0.000458290636
  error estimate for blocks of size 2^( 5) =       0.000468552630
  error estimate for blocks of size 2^( 6) =       0.000476481806
  error estimate for blocks of size 2^( 7) =       0.000480183261

      target function =                  N/A
              le_mean =     -16.909175073262
             les_mean =     286.277227699049
             stat err =       0.000470877083
             autocorr =       1.242066915206
              std dev =       0.597516710506
             le_variance =       0.357026219334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690917507326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909175073262       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909175073253       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909175073220       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909175073244       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909175073312       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909175073376       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909175073378       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909175073359       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 4.075779e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909175073262       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909175073260       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909175073252       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909175073254       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909175073267       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909175073309       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909175073302       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909175073280       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.018975e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909175073262       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909175073262       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909175073259       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909175073274       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909175073288       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909175073267       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909175073267       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909175073279       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.547457e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5687e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455255e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170772e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9184
    reference variance = 0.247483
====================================================
  Execution time = 2.9942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4214e-01
  Total weights = 2.0000e+06
  Execution time = 3.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192251037
                                         uncertainty =       0.007359403287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192251037
                                         uncertainty =       0.007359403287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413605611
  error estimate for blocks of size 2^( 2) =       0.000425927451
  error estimate for blocks of size 2^( 3) =       0.000438620208
  error estimate for blocks of size 2^( 4) =       0.000451205100
  error estimate for blocks of size 2^( 5) =       0.000462256301
  error estimate for blocks of size 2^( 6) =       0.000470719135
  error estimate for blocks of size 2^( 7) =       0.000477204065

      target function =                  N/A
              le_mean =     -16.909010280670
             les_mean =     286.256767704082
             stat err =       0.000465346150
             autocorr =       1.265841723123
              std dev =       0.584926664928
             le_variance =       0.342139203344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192276573
                                         uncertainty =       0.007359403383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192276573
                                         uncertainty =       0.007359403383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413605627
  error estimate for blocks of size 2^( 2) =       0.000425927465
  error estimate for blocks of size 2^( 3) =       0.000438620222
  error estimate for blocks of size 2^( 4) =       0.000451205113
  error estimate for blocks of size 2^( 5) =       0.000462256313
  error estimate for blocks of size 2^( 6) =       0.000470719146
  error estimate for blocks of size 2^( 7) =       0.000477204077

      target function =                  N/A
              le_mean =     -16.909010280528
             les_mean =     286.256767724805
             stat err =       0.000465346162
             autocorr =       1.265841695364
              std dev =       0.584926686760
             le_variance =       0.342139228884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192263806
                                         uncertainty =       0.007359403335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192263806
                                         uncertainty =       0.007359403335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413605619
  error estimate for blocks of size 2^( 2) =       0.000425927458
  error estimate for blocks of size 2^( 3) =       0.000438620215
  error estimate for blocks of size 2^( 4) =       0.000451205107
  error estimate for blocks of size 2^( 5) =       0.000462256307
  error estimate for blocks of size 2^( 6) =       0.000470719140
  error estimate for blocks of size 2^( 7) =       0.000477204071

      target function =                  N/A
              le_mean =     -16.909010280599
             les_mean =     286.256767714444
             stat err =       0.000465346156
             autocorr =       1.265841709242
              std dev =       0.584926675844
             le_variance =       0.342139216114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192252633
                                         uncertainty =       0.007359403293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342192252633
                                         uncertainty =       0.007359403293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413605612
  error estimate for blocks of size 2^( 2) =       0.000425927452
  error estimate for blocks of size 2^( 3) =       0.000438620209
  error estimate for blocks of size 2^( 4) =       0.000451205101
  error estimate for blocks of size 2^( 5) =       0.000462256302
  error estimate for blocks of size 2^( 6) =       0.000470719135
  error estimate for blocks of size 2^( 7) =       0.000477204065

      target function =                  N/A
              le_mean =     -16.909010280661
             les_mean =     286.256767705377
             stat err =       0.000465346151
             autocorr =       1.265841721391
              std dev =       0.584926666292
             le_variance =       0.342139204940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909010280670        initial  <--
     9.3132e+03     9.3132e+04             4.0758e-08       -16.909010280528
     3.7253e+04     3.7253e+05             1.0190e-08       -16.909010280599
     1.4901e+05     1.4901e+06             2.5475e-09       -16.909010280661

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.6766
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.3370e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.427201
====================================================
  Execution time = 2.8066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3865e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338424674112
                                         uncertainty =       0.004009176482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338424674112
                                         uncertainty =       0.004009176482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411491624
  error estimate for blocks of size 2^( 2) =       0.000423680349
  error estimate for blocks of size 2^( 3) =       0.000436577869
  error estimate for blocks of size 2^( 4) =       0.000449716793
  error estimate for blocks of size 2^( 5) =       0.000461947553
  error estimate for blocks of size 2^( 6) =       0.000472251042
  error estimate for blocks of size 2^( 7) =       0.000478826529

      target function =                  N/A
              le_mean =     -16.909137183398
             les_mean =     286.257570830631
             stat err =       0.000465685479
             autocorr =       1.280747137074
              std dev =       0.581937035227
             le_variance =       0.338650712969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690913718340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909137183398       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909137183402       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909137183406       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909137183364       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909137183399       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909137183336       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909137183497       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909137183276       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.859912e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909137183398       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909137183399       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909137183400       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909137183433       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909137183230       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909137183448       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909137183311       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909137183567       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.149780e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909137183398       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909137183399       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909137183399       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909137182791       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909137183444       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909137183405       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909137184490       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909137183210       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.787447e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5155e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908185e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.22816
====================================================
  Execution time = 2.7444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3419e-01
  Total weights = 2.0000e+06
  Execution time = 3.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312102092
                                         uncertainty =       0.003738704199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312102092
                                         uncertainty =       0.003738704199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408775084
  error estimate for blocks of size 2^( 2) =       0.000420464922
  error estimate for blocks of size 2^( 3) =       0.000433446417
  error estimate for blocks of size 2^( 4) =       0.000445691674
  error estimate for blocks of size 2^( 5) =       0.000455228894
  error estimate for blocks of size 2^( 6) =       0.000463139468
  error estimate for blocks of size 2^( 7) =       0.000469384726

      target function =                  N/A
              le_mean =     -16.909566752537
             les_mean =     286.267641730475
             stat err =       0.000458361190
             autocorr =       1.257322952057
              std dev =       0.578095268162
             le_variance =       0.334194139071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312103877
                                         uncertainty =       0.003738704215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312103877
                                         uncertainty =       0.003738704215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408775085
  error estimate for blocks of size 2^( 2) =       0.000420464923
  error estimate for blocks of size 2^( 3) =       0.000433446418
  error estimate for blocks of size 2^( 4) =       0.000445691675
  error estimate for blocks of size 2^( 5) =       0.000455228895
  error estimate for blocks of size 2^( 6) =       0.000463139469
  error estimate for blocks of size 2^( 7) =       0.000469384727

      target function =                  N/A
              le_mean =     -16.909566752536
             les_mean =     286.267641732243
             stat err =       0.000458361191
             autocorr =       1.257322950056
              std dev =       0.578095269706
             le_variance =       0.334194140856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312102984
                                         uncertainty =       0.003738704207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312102984
                                         uncertainty =       0.003738704207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408775085
  error estimate for blocks of size 2^( 2) =       0.000420464923
  error estimate for blocks of size 2^( 3) =       0.000433446417
  error estimate for blocks of size 2^( 4) =       0.000445691674
  error estimate for blocks of size 2^( 5) =       0.000455228894
  error estimate for blocks of size 2^( 6) =       0.000463139468
  error estimate for blocks of size 2^( 7) =       0.000469384726

      target function =                  N/A
              le_mean =     -16.909566752537
             les_mean =     286.267641731359
             stat err =       0.000458361191
             autocorr =       1.257322951049
              std dev =       0.578095268934
             le_variance =       0.334194139964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312102204
                                         uncertainty =       0.003738704200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312102204
                                         uncertainty =       0.003738704200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408775084
  error estimate for blocks of size 2^( 2) =       0.000420464922
  error estimate for blocks of size 2^( 3) =       0.000433446417
  error estimate for blocks of size 2^( 4) =       0.000445691674
  error estimate for blocks of size 2^( 5) =       0.000455228894
  error estimate for blocks of size 2^( 6) =       0.000463139468
  error estimate for blocks of size 2^( 7) =       0.000469384726

      target function =                  N/A
              le_mean =     -16.909566752537
             les_mean =     286.267641730585
             stat err =       0.000458361190
             autocorr =       1.257322951933
              std dev =       0.578095268258
             le_variance =       0.334194139182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909566752537        initial  <--
     9.3132e+04     9.3132e+05             2.8599e-09       -16.909566752536
     3.7253e+05     3.7253e+06             7.1498e-10       -16.909566752537
     1.4901e+06     1.4901e+07             1.7874e-10       -16.909566752537

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1979
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.513868
====================================================
  Execution time = 2.8123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337578881532
                                         uncertainty =       0.003372723515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337578881532
                                         uncertainty =       0.003372723515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410830785
  error estimate for blocks of size 2^( 2) =       0.000423505252
  error estimate for blocks of size 2^( 3) =       0.000435991453
  error estimate for blocks of size 2^( 4) =       0.000448684666
  error estimate for blocks of size 2^( 5) =       0.000460356238
  error estimate for blocks of size 2^( 6) =       0.000468607203
  error estimate for blocks of size 2^( 7) =       0.000472382874

      target function =                  N/A
              le_mean =     -16.909483589471
             les_mean =     286.268198960990
             stat err =       0.000462507745
             autocorr =       1.267395210316
              std dev =       0.581002467449
             le_variance =       0.337563867182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690948358947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909483589471       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909483589471       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909483589471       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909483589471       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909483589471       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909483589452       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909483589436       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909483589824       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.655165e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909483589471       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909483589471       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909483589471       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909483589471       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909483587528       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909483588960       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909483589791       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909483588698       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 6.637924e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909483589471       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909483589471       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909483589471       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909483589471       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909483589471       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909483589476       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909483580715       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909483585822       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.659477e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5291e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 0.192611
====================================================
  Execution time = 2.7626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5572e-01
  Total weights = 2.0000e+06
  Execution time = 3.4893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928245
                                         uncertainty =       0.012212921427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928245
                                         uncertainty =       0.012212921427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421733729
  error estimate for blocks of size 2^( 2) =       0.000433575013
  error estimate for blocks of size 2^( 3) =       0.000445749297
  error estimate for blocks of size 2^( 4) =       0.000456968943
  error estimate for blocks of size 2^( 5) =       0.000467274441
  error estimate for blocks of size 2^( 6) =       0.000475526019
  error estimate for blocks of size 2^( 7) =       0.000480613851

      target function =                  N/A
              le_mean =     -16.909989333550
             les_mean =     286.303457759581
             stat err =       0.000470095813
             autocorr =       1.242499133913
              std dev =       0.596421559530
             le_variance =       0.355718676672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928427
                                         uncertainty =       0.012212921441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928427
                                         uncertainty =       0.012212921441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421733729
  error estimate for blocks of size 2^( 2) =       0.000433575013
  error estimate for blocks of size 2^( 3) =       0.000445749298
  error estimate for blocks of size 2^( 4) =       0.000456968943
  error estimate for blocks of size 2^( 5) =       0.000467274441
  error estimate for blocks of size 2^( 6) =       0.000475526019
  error estimate for blocks of size 2^( 7) =       0.000480613851

      target function =                  N/A
              le_mean =     -16.909989333550
             les_mean =     286.303457759753
             stat err =       0.000470095814
             autocorr =       1.242499133732
              std dev =       0.596421559683
             le_variance =       0.355718676854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928336
                                         uncertainty =       0.012212921434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928336
                                         uncertainty =       0.012212921434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421733729
  error estimate for blocks of size 2^( 2) =       0.000433575013
  error estimate for blocks of size 2^( 3) =       0.000445749297
  error estimate for blocks of size 2^( 4) =       0.000456968943
  error estimate for blocks of size 2^( 5) =       0.000467274441
  error estimate for blocks of size 2^( 6) =       0.000475526019
  error estimate for blocks of size 2^( 7) =       0.000480613851

      target function =                  N/A
              le_mean =     -16.909989333550
             les_mean =     286.303457759667
             stat err =       0.000470095814
             autocorr =       1.242499133825
              std dev =       0.596421559606
             le_variance =       0.355718676763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928256
                                         uncertainty =       0.012212921428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355801928256
                                         uncertainty =       0.012212921428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421733729
  error estimate for blocks of size 2^( 2) =       0.000433575013
  error estimate for blocks of size 2^( 3) =       0.000445749297
  error estimate for blocks of size 2^( 4) =       0.000456968943
  error estimate for blocks of size 2^( 5) =       0.000467274441
  error estimate for blocks of size 2^( 6) =       0.000475526019
  error estimate for blocks of size 2^( 7) =       0.000480613851

      target function =                  N/A
              le_mean =     -16.909989333550
             les_mean =     286.303457759592
             stat err =       0.000470095813
             autocorr =       1.242499133901
              std dev =       0.596421559540
             le_variance =       0.355718676684


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909989333550        initial  <--
     9.3132e+05     9.3132e+06             2.6552e-10       -16.909989333550
     3.7253e+06     3.7253e+07             6.6379e-11       -16.909989333550
     1.4901e+07     1.4901e+08             1.6595e-11       -16.909989333550

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4475
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.352441
====================================================
  Execution time = 2.8188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.5551e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355660913463
                                         uncertainty =       0.011284541162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355660913463
                                         uncertainty =       0.011284541162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421612233
  error estimate for blocks of size 2^( 2) =       0.000433760386
  error estimate for blocks of size 2^( 3) =       0.000446215617
  error estimate for blocks of size 2^( 4) =       0.000457630797
  error estimate for blocks of size 2^( 5) =       0.000468909794
  error estimate for blocks of size 2^( 6) =       0.000477062970
  error estimate for blocks of size 2^( 7) =       0.000480705723

      target function =                  N/A
              le_mean =     -16.908781332722
             les_mean =     286.262399729782
             stat err =       0.000471077321
             autocorr =       1.248412151855
              std dev =       0.596249737728
             le_variance =       0.355513749741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690878133272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908781332722       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908781332722       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908781332722       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908781336395       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908781332700       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908781321775       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908781325300       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908781338723       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.779824e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908781332722       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908781332722       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908781332722       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908781332722       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908781317678       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908781330443       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908781329072       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908781352273       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.949584e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908781332722       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908781332722       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908781332722       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908781332722       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908781355712       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908781362989       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908781353211       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908781444172       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.737543e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5427e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9242
    reference variance = 0.157469
====================================================
  Execution time = 2.7995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4115e-01
  Total weights = 2.0000e+06
  Execution time = 3.4737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712903
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712903
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413010279
  error estimate for blocks of size 2^( 2) =       0.000424893617
  error estimate for blocks of size 2^( 3) =       0.000437526963
  error estimate for blocks of size 2^( 4) =       0.000448665151
  error estimate for blocks of size 2^( 5) =       0.000459692718
  error estimate for blocks of size 2^( 6) =       0.000466815770
  error estimate for blocks of size 2^( 7) =       0.000469850421

      target function =                  N/A
              le_mean =     -16.909594029219
             les_mean =     286.275525043855
             stat err =       0.000461256015
             autocorr =       1.247275420618
              std dev =       0.584084738235
             le_variance =       0.341154981440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712917
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712917
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413010279
  error estimate for blocks of size 2^( 2) =       0.000424893617
  error estimate for blocks of size 2^( 3) =       0.000437526963
  error estimate for blocks of size 2^( 4) =       0.000448665151
  error estimate for blocks of size 2^( 5) =       0.000459692718
  error estimate for blocks of size 2^( 6) =       0.000466815771
  error estimate for blocks of size 2^( 7) =       0.000469850421

      target function =                  N/A
              le_mean =     -16.909594029219
             les_mean =     286.275525043868
             stat err =       0.000461256015
             autocorr =       1.247275420606
              std dev =       0.584084738247
             le_variance =       0.341154981453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712910
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712910
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413010279
  error estimate for blocks of size 2^( 2) =       0.000424893617
  error estimate for blocks of size 2^( 3) =       0.000437526963
  error estimate for blocks of size 2^( 4) =       0.000448665151
  error estimate for blocks of size 2^( 5) =       0.000459692718
  error estimate for blocks of size 2^( 6) =       0.000466815771
  error estimate for blocks of size 2^( 7) =       0.000469850421

      target function =                  N/A
              le_mean =     -16.909594029219
             les_mean =     286.275525043861
             stat err =       0.000461256015
             autocorr =       1.247275420625
              std dev =       0.584084738241
             le_variance =       0.341154981446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712904
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255712904
                                         uncertainty =       0.005069947078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413010279
  error estimate for blocks of size 2^( 2) =       0.000424893617
  error estimate for blocks of size 2^( 3) =       0.000437526963
  error estimate for blocks of size 2^( 4) =       0.000448665151
  error estimate for blocks of size 2^( 5) =       0.000459692718
  error estimate for blocks of size 2^( 6) =       0.000466815770
  error estimate for blocks of size 2^( 7) =       0.000469850421

      target function =                  N/A
              le_mean =     -16.909594029219
             les_mean =     286.275525043856
             stat err =       0.000461256015
             autocorr =       1.247275420617
              std dev =       0.584084738236
             le_variance =       0.341154981441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909594029219        initial  <--
     9.3132e+06     9.3132e+07             2.7798e-11       -16.909594029219
     3.7253e+07     3.7253e+08             6.9496e-12       -16.909594029219
     1.4901e+08     1.4901e+09             1.7375e-12       -16.909594029219

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7011
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.94
    reference variance = 0.41046
====================================================
  Execution time = 3.0251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3943e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339430821236
                                         uncertainty =       0.007635522296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339430821236
                                         uncertainty =       0.007635522296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411966526
  error estimate for blocks of size 2^( 2) =       0.000424080797
  error estimate for blocks of size 2^( 3) =       0.000436794666
  error estimate for blocks of size 2^( 4) =       0.000448058583
  error estimate for blocks of size 2^( 5) =       0.000459156002
  error estimate for blocks of size 2^( 6) =       0.000466036953
  error estimate for blocks of size 2^( 7) =       0.000471528847

      target function =                  N/A
              le_mean =     -16.909563728829
             les_mean =     286.272778166848
             stat err =       0.000461195097
             autocorr =       1.253272481231
              std dev =       0.582608648448
             le_variance =       0.339432837246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690956372883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909563728829       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909563728829       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909563728829       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909563728829       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909563722689       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909563782638       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909563783489       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909563833087       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 3.549331e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909563728829       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909563728829       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909563728829       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909563728829       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909563671281       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909563728384       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909563523554       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909563817404       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 8.874681e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909563728829       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909563728829       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909563728829       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909563058093       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909563189359       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909564726428       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909566880554       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909563976797       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 2.220143e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7374e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9327
    reference variance = 0.144837
====================================================
  Execution time = 2.7733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4380e-01
  Total weights = 2.0000e+06
  Execution time = 3.4731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588219
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588219
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414605965
  error estimate for blocks of size 2^( 2) =       0.000426766365
  error estimate for blocks of size 2^( 3) =       0.000438879200
  error estimate for blocks of size 2^( 4) =       0.000450544274
  error estimate for blocks of size 2^( 5) =       0.000460401474
  error estimate for blocks of size 2^( 6) =       0.000468303005
  error estimate for blocks of size 2^( 7) =       0.000472457126

      target function =                  N/A
              le_mean =     -16.908427177174
             les_mean =     286.238705646373
             stat err =       0.000462926470
             autocorr =       1.246674096594
              std dev =       0.586341378795
             le_variance =       0.343796212488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588220
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588220
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414605965
  error estimate for blocks of size 2^( 2) =       0.000426766365
  error estimate for blocks of size 2^( 3) =       0.000438879200
  error estimate for blocks of size 2^( 4) =       0.000450544274
  error estimate for blocks of size 2^( 5) =       0.000460401474
  error estimate for blocks of size 2^( 6) =       0.000468303005
  error estimate for blocks of size 2^( 7) =       0.000472457126

      target function =                  N/A
              le_mean =     -16.908427177174
             les_mean =     286.238705646375
             stat err =       0.000462926470
             autocorr =       1.246674096592
              std dev =       0.586341378797
             le_variance =       0.343796212490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588219
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588219
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414605965
  error estimate for blocks of size 2^( 2) =       0.000426766365
  error estimate for blocks of size 2^( 3) =       0.000438879200
  error estimate for blocks of size 2^( 4) =       0.000450544274
  error estimate for blocks of size 2^( 5) =       0.000460401474
  error estimate for blocks of size 2^( 6) =       0.000468303005
  error estimate for blocks of size 2^( 7) =       0.000472457126

      target function =                  N/A
              le_mean =     -16.908427177174
             les_mean =     286.238705646374
             stat err =       0.000462926470
             autocorr =       1.246674096597
              std dev =       0.586341378796
             le_variance =       0.343796212489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588219
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343626588219
                                         uncertainty =       0.006367162274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414605965
  error estimate for blocks of size 2^( 2) =       0.000426766365
  error estimate for blocks of size 2^( 3) =       0.000438879200
  error estimate for blocks of size 2^( 4) =       0.000450544274
  error estimate for blocks of size 2^( 5) =       0.000460401474
  error estimate for blocks of size 2^( 6) =       0.000468303005
  error estimate for blocks of size 2^( 7) =       0.000472457126

      target function =                  N/A
              le_mean =     -16.908427177174
             les_mean =     286.238705646373
             stat err =       0.000462926470
             autocorr =       1.246674096596
              std dev =       0.586341378795
             le_variance =       0.343796212488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908427177174        initial  <--
     9.3132e+07     9.3132e+08             3.5493e-12       -16.908427177174
     3.7253e+08     3.7253e+09             8.8747e-13       -16.908427177174
     1.4901e+09     1.4901e+10             2.2201e-13       -16.908427177174

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4266
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8925
    reference variance = 0.1637
====================================================
  Execution time = 2.8326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3258e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331817240529
                                         uncertainty =       0.003224119504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331817240529
                                         uncertainty =       0.003224119504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407789196
  error estimate for blocks of size 2^( 2) =       0.000420231085
  error estimate for blocks of size 2^( 3) =       0.000433367727
  error estimate for blocks of size 2^( 4) =       0.000446328532
  error estimate for blocks of size 2^( 5) =       0.000458469388
  error estimate for blocks of size 2^( 6) =       0.000469062853
  error estimate for blocks of size 2^( 7) =       0.000475642251

      target function =                  N/A
              le_mean =     -16.908920222184
             les_mean =     286.244166970376
             stat err =       0.000462375756
             autocorr =       1.285637935552
              std dev =       0.576701011337
             le_variance =       0.332584056477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690892022218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908920222184       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908920222184       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908920222184       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908920222184       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908920222184       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908920230476       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908920358673       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908920075861       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.719412e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908920222184       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908920222184       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908920222184       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908921700771       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908922145183       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908921702873       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908917225083       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908943742465       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908925839507       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 6.820066e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908920222184       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908920222184       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908920222184       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908920244338       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908919311486       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908934884548       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908926670899       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908917403842       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908899601403       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908863143410       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909012667280       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909018724400       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908969748308       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908758589356       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908898488724       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909027561961       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909138875647       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908472914313       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908426837328       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908969121475       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.909002357642       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909360652149       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909018176919       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.909762758836       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.907309223659       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909007674671       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.908429658343       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908032388880       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909377395108       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.911456685423       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.908512559982       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.908574289615       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.909797035897       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.908594241332       residual = 4.26e-05           smallest_sin_value = 9.98e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.909562089983       residual = 7.00e-05           smallest_sin_value = 9.90e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.18e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 1.706945e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5462e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8145
    reference variance = 0.208599
====================================================
  Execution time = 2.7945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4768e-01
  Total weights = 2.0000e+06
  Execution time = 3.4802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416941381
  error estimate for blocks of size 2^( 2) =       0.000428956407
  error estimate for blocks of size 2^( 3) =       0.000441404048
  error estimate for blocks of size 2^( 4) =       0.000453551546
  error estimate for blocks of size 2^( 5) =       0.000465460431
  error estimate for blocks of size 2^( 6) =       0.000476523288
  error estimate for blocks of size 2^( 7) =       0.000484083511

      target function =                  N/A
              le_mean =     -16.909798424731
             les_mean =     286.288962821711
             stat err =       0.000469904694
             autocorr =       1.270192561990
              std dev =       0.589644155845
             le_variance =       0.347680230523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416941381
  error estimate for blocks of size 2^( 2) =       0.000428956407
  error estimate for blocks of size 2^( 3) =       0.000441404048
  error estimate for blocks of size 2^( 4) =       0.000453551546
  error estimate for blocks of size 2^( 5) =       0.000465460431
  error estimate for blocks of size 2^( 6) =       0.000476523288
  error estimate for blocks of size 2^( 7) =       0.000484083511

      target function =                  N/A
              le_mean =     -16.909798424731
             les_mean =     286.288962821711
             stat err =       0.000469904694
             autocorr =       1.270192561994
              std dev =       0.589644155845
             le_variance =       0.347680230523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416941381
  error estimate for blocks of size 2^( 2) =       0.000428956407
  error estimate for blocks of size 2^( 3) =       0.000441404048
  error estimate for blocks of size 2^( 4) =       0.000453551546
  error estimate for blocks of size 2^( 5) =       0.000465460431
  error estimate for blocks of size 2^( 6) =       0.000476523288
  error estimate for blocks of size 2^( 7) =       0.000484083511

      target function =                  N/A
              le_mean =     -16.909798424731
             les_mean =     286.288962821711
             stat err =       0.000469904694
             autocorr =       1.270192561987
              std dev =       0.589644155845
             le_variance =       0.347680230523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347664917440
                                         uncertainty =       0.006678390079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416941381
  error estimate for blocks of size 2^( 2) =       0.000428956407
  error estimate for blocks of size 2^( 3) =       0.000441404048
  error estimate for blocks of size 2^( 4) =       0.000453551546
  error estimate for blocks of size 2^( 5) =       0.000465460431
  error estimate for blocks of size 2^( 6) =       0.000476523288
  error estimate for blocks of size 2^( 7) =       0.000484083511

      target function =                  N/A
              le_mean =     -16.909798424731
             les_mean =     286.288962821711
             stat err =       0.000469904694
             autocorr =       1.270192561992
              std dev =       0.589644155845
             le_variance =       0.347680230523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909798424731        initial
     9.3132e+08     9.3132e+09             2.7194e-13       -16.909798424731  <--
     3.7253e+09     3.7253e+10             6.8201e-14       -16.909798424731
     1.4901e+10     1.4901e+11             1.7069e-14       -16.909798424731

*****************************************************************************
Applying the update for shift_i =   9.3132e+08     and shift_s =   9.3132e+09
*****************************************************************************

  Execution time = 4.5679e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1149e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9585
    reference variance = 0.220462
====================================================
  Execution time = 2.8248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.6693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367009207578
                                         uncertainty =       0.017394762341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367009207578
                                         uncertainty =       0.017394762341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428328437
  error estimate for blocks of size 2^( 2) =       0.000439626619
  error estimate for blocks of size 2^( 3) =       0.000452668490
  error estimate for blocks of size 2^( 4) =       0.000464336927
  error estimate for blocks of size 2^( 5) =       0.000474047810
  error estimate for blocks of size 2^( 6) =       0.000482852515
  error estimate for blocks of size 2^( 7) =       0.000489938310

      target function =                  N/A
              le_mean =     -16.909303763041
             les_mean =     286.291484067453
             stat err =       0.000477793890
             autocorr =       1.244306492372
              std dev =       0.605747884953
             le_variance =       0.366930500125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690930376304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909303763041       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909303763041       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909303763041       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909303763041       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909303763041       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909303706139       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909303796321       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909303740010       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.248288e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909303763041       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909303763041       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909303763041       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909303924457       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909303923597       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909303772350       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909304059513       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909303640248       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 3.121791e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909303763041       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909303763041       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909303763041       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909303745176       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909301262977       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909304305540       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909304129085       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909301856381       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 7.800130e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5399e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8966
    reference variance = 0.406975
====================================================
  Execution time = 2.7908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4096e-01
  Total weights = 2.0000e+06
  Execution time = 3.4786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412892409
  error estimate for blocks of size 2^( 2) =       0.000424857849
  error estimate for blocks of size 2^( 3) =       0.000437488008
  error estimate for blocks of size 2^( 4) =       0.000450638133
  error estimate for blocks of size 2^( 5) =       0.000461667952
  error estimate for blocks of size 2^( 6) =       0.000468138596
  error estimate for blocks of size 2^( 7) =       0.000473015662

      target function =                  N/A
              le_mean =     -16.909442213644
             les_mean =     286.270196089166
             stat err =       0.000463365086
             autocorr =       1.259426469431
              std dev =       0.583918044819
             le_variance =       0.340960283065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412892409
  error estimate for blocks of size 2^( 2) =       0.000424857849
  error estimate for blocks of size 2^( 3) =       0.000437488008
  error estimate for blocks of size 2^( 4) =       0.000450638133
  error estimate for blocks of size 2^( 5) =       0.000461667952
  error estimate for blocks of size 2^( 6) =       0.000468138596
  error estimate for blocks of size 2^( 7) =       0.000473015662

      target function =                  N/A
              le_mean =     -16.909442213644
             les_mean =     286.270196089166
             stat err =       0.000463365086
             autocorr =       1.259426469428
              std dev =       0.583918044819
             le_variance =       0.340960283065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412892409
  error estimate for blocks of size 2^( 2) =       0.000424857849
  error estimate for blocks of size 2^( 3) =       0.000437488008
  error estimate for blocks of size 2^( 4) =       0.000450638133
  error estimate for blocks of size 2^( 5) =       0.000461667952
  error estimate for blocks of size 2^( 6) =       0.000468138596
  error estimate for blocks of size 2^( 7) =       0.000473015662

      target function =                  N/A
              le_mean =     -16.909442213644
             les_mean =     286.270196089166
             stat err =       0.000463365086
             autocorr =       1.259426469423
              std dev =       0.583918044819
             le_variance =       0.340960283065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340984516400
                                         uncertainty =       0.004004193932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412892409
  error estimate for blocks of size 2^( 2) =       0.000424857849
  error estimate for blocks of size 2^( 3) =       0.000437488008
  error estimate for blocks of size 2^( 4) =       0.000450638133
  error estimate for blocks of size 2^( 5) =       0.000461667952
  error estimate for blocks of size 2^( 6) =       0.000468138596
  error estimate for blocks of size 2^( 7) =       0.000473015662

      target function =                  N/A
              le_mean =     -16.909442213644
             les_mean =     286.270196089166
             stat err =       0.000463365086
             autocorr =       1.259426469430
              std dev =       0.583918044819
             le_variance =       0.340960283065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909442213644        initial
     2.3283e+08     2.3283e+09             1.2483e-12       -16.909442213644  <--
     9.3132e+08     9.3132e+09             3.1218e-13       -16.909442213644
     3.7253e+09     3.7253e+10             7.8001e-14       -16.909442213644

*****************************************************************************
Applying the update for shift_i =   2.3283e+08     and shift_s =   2.3283e+09
*****************************************************************************

  Execution time = 4.5648e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1055e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9998
    reference variance = 0.161576
====================================================
  Execution time = 2.8114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3471e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334720699110
                                         uncertainty =       0.004911231024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334720699110
                                         uncertainty =       0.004911231024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409089533
  error estimate for blocks of size 2^( 2) =       0.000420828977
  error estimate for blocks of size 2^( 3) =       0.000433452470
  error estimate for blocks of size 2^( 4) =       0.000444778499
  error estimate for blocks of size 2^( 5) =       0.000454833997
  error estimate for blocks of size 2^( 6) =       0.000462754049
  error estimate for blocks of size 2^( 7) =       0.000467313464

      target function =                  N/A
              le_mean =     -16.909898973944
             les_mean =     286.279391633359
             stat err =       0.000457420002
             autocorr =       1.250240515017
              std dev =       0.578539965526
             le_variance =       0.334708491711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690989897394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909898973944       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909898973944       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909898973944       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909898997236       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909898973843       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909898911465       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909898987716       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909898943388       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.375962e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909898973944       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909898973944       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909898973944       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909898983132       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909898975913       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909898909712       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909898957673       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909899220531       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.093984e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909898973944       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909898973944       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909898973944       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909898674157       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909898922038       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909898974026       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909898284773       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909899836472       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 2.735298e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5255e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9313
    reference variance = 0.200038
====================================================
  Execution time = 2.7525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3584e-01
  Total weights = 2.0000e+06
  Execution time = 3.4652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780760
  error estimate for blocks of size 2^( 2) =       0.000421746303
  error estimate for blocks of size 2^( 3) =       0.000434544095
  error estimate for blocks of size 2^( 4) =       0.000446781241
  error estimate for blocks of size 2^( 5) =       0.000456137410
  error estimate for blocks of size 2^( 6) =       0.000464466243
  error estimate for blocks of size 2^( 7) =       0.000468501832

      target function =                  N/A
              le_mean =     -16.910176489136
             les_mean =     286.289909268383
             stat err =       0.000458971681
             autocorr =       1.254494187654
              std dev =       0.579517508435
             le_variance =       0.335840542582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780760
  error estimate for blocks of size 2^( 2) =       0.000421746303
  error estimate for blocks of size 2^( 3) =       0.000434544095
  error estimate for blocks of size 2^( 4) =       0.000446781241
  error estimate for blocks of size 2^( 5) =       0.000456137410
  error estimate for blocks of size 2^( 6) =       0.000464466243
  error estimate for blocks of size 2^( 7) =       0.000468501832

      target function =                  N/A
              le_mean =     -16.910176489136
             les_mean =     286.289909268383
             stat err =       0.000458971681
             autocorr =       1.254494187642
              std dev =       0.579517508434
             le_variance =       0.335840542582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780760
  error estimate for blocks of size 2^( 2) =       0.000421746303
  error estimate for blocks of size 2^( 3) =       0.000434544095
  error estimate for blocks of size 2^( 4) =       0.000446781241
  error estimate for blocks of size 2^( 5) =       0.000456137410
  error estimate for blocks of size 2^( 6) =       0.000464466243
  error estimate for blocks of size 2^( 7) =       0.000468501832

      target function =                  N/A
              le_mean =     -16.910176489136
             les_mean =     286.289909268383
             stat err =       0.000458971681
             autocorr =       1.254494187650
              std dev =       0.579517508434
             le_variance =       0.335840542582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335954126756
                                         uncertainty =       0.003974018256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409780760
  error estimate for blocks of size 2^( 2) =       0.000421746303
  error estimate for blocks of size 2^( 3) =       0.000434544095
  error estimate for blocks of size 2^( 4) =       0.000446781241
  error estimate for blocks of size 2^( 5) =       0.000456137410
  error estimate for blocks of size 2^( 6) =       0.000464466243
  error estimate for blocks of size 2^( 7) =       0.000468501832

      target function =                  N/A
              le_mean =     -16.910176489136
             les_mean =     286.289909268383
             stat err =       0.000458971681
             autocorr =       1.254494187654
              std dev =       0.579517508435
             le_variance =       0.335840542582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910176489136        initial
     5.8208e+07     5.8208e+08             4.3760e-12       -16.910176489136  <--
     2.3283e+08     2.3283e+09             1.0940e-12       -16.910176489136
     9.3132e+08     9.3132e+09             2.7353e-13       -16.910176489136

*****************************************************************************
Applying the update for shift_i =   5.8208e+07     and shift_s =   5.8208e+08
*****************************************************************************

  Execution time = 4.6709e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.874
    reference variance = 0.147388
====================================================
  Execution time = 2.8188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3612e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336217880582
                                         uncertainty =       0.002897265225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336217880582
                                         uncertainty =       0.002897265225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409949902
  error estimate for blocks of size 2^( 2) =       0.000422203891
  error estimate for blocks of size 2^( 3) =       0.000435034479
  error estimate for blocks of size 2^( 4) =       0.000448245522
  error estimate for blocks of size 2^( 5) =       0.000459861818
  error estimate for blocks of size 2^( 6) =       0.000467488848
  error estimate for blocks of size 2^( 7) =       0.000472867719

      target function =                  N/A
              le_mean =     -16.909378359372
             les_mean =     286.263194176216
             stat err =       0.000462115977
             autocorr =       1.270692286330
              std dev =       0.579756710938
             le_variance =       0.336117843878


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690937835937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909378359372       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909378359372       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909378359372       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909378359372       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909378359360       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909378351929       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909378356352       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909378363672       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.848907e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909378359372       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909378359372       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909378359372       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909378358963       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909378359112       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909378419482       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909378387664       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909378372025       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.622670e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909378359372       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909378359372       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909378359372       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909378359372       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909378332736       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909378540083       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909378322208       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909378277508       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.155701e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5348e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9178
    reference variance = 0.279048
====================================================
  Execution time = 2.8138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5304e-01
  Total weights = 2.0000e+06
  Execution time = 3.5026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823759
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823759
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420140655
  error estimate for blocks of size 2^( 2) =       0.000431944626
  error estimate for blocks of size 2^( 3) =       0.000444160892
  error estimate for blocks of size 2^( 4) =       0.000456456780
  error estimate for blocks of size 2^( 5) =       0.000467827519
  error estimate for blocks of size 2^( 6) =       0.000475620266
  error estimate for blocks of size 2^( 7) =       0.000479295365

      target function =                  N/A
              le_mean =     -16.909903289026
             les_mean =     286.297865407106
             stat err =       0.000469799983
             autocorr =       1.250364334089
              std dev =       0.594168611951
             le_variance =       0.353036339427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823767
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823767
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420140655
  error estimate for blocks of size 2^( 2) =       0.000431944626
  error estimate for blocks of size 2^( 3) =       0.000444160892
  error estimate for blocks of size 2^( 4) =       0.000456456780
  error estimate for blocks of size 2^( 5) =       0.000467827519
  error estimate for blocks of size 2^( 6) =       0.000475620266
  error estimate for blocks of size 2^( 7) =       0.000479295365

      target function =                  N/A
              le_mean =     -16.909903289026
             les_mean =     286.297865407115
             stat err =       0.000469799983
             autocorr =       1.250364334082
              std dev =       0.594168611958
             le_variance =       0.353036339436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823763
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823763
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420140655
  error estimate for blocks of size 2^( 2) =       0.000431944626
  error estimate for blocks of size 2^( 3) =       0.000444160892
  error estimate for blocks of size 2^( 4) =       0.000456456780
  error estimate for blocks of size 2^( 5) =       0.000467827519
  error estimate for blocks of size 2^( 6) =       0.000475620266
  error estimate for blocks of size 2^( 7) =       0.000479295365

      target function =                  N/A
              le_mean =     -16.909903289026
             les_mean =     286.297865407110
             stat err =       0.000469799983
             autocorr =       1.250364334081
              std dev =       0.594168611954
             le_variance =       0.353036339431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823759
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353127823759
                                         uncertainty =       0.011887659576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420140655
  error estimate for blocks of size 2^( 2) =       0.000431944626
  error estimate for blocks of size 2^( 3) =       0.000444160892
  error estimate for blocks of size 2^( 4) =       0.000456456780
  error estimate for blocks of size 2^( 5) =       0.000467827519
  error estimate for blocks of size 2^( 6) =       0.000475620266
  error estimate for blocks of size 2^( 7) =       0.000479295365

      target function =                  N/A
              le_mean =     -16.909903289026
             les_mean =     286.297865407106
             stat err =       0.000469799983
             autocorr =       1.250364334082
              std dev =       0.594168611951
             le_variance =       0.353036339428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909903289026        initial
     1.4552e+07     1.4552e+08             1.8489e-11       -16.909903289026  <--
     5.8208e+07     5.8208e+08             4.6227e-12       -16.909903289026
     2.3283e+08     2.3283e+09             1.1557e-12       -16.909903289026

*****************************************************************************
Applying the update for shift_i =   1.4552e+07     and shift_s =   1.4552e+08
*****************************************************************************

  Execution time = 4.5996e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1351e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9266
    reference variance = 0.577203
====================================================
  Execution time = 2.8251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4016e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340217995967
                                         uncertainty =       0.003955421518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340217995967
                                         uncertainty =       0.003955421518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412405438
  error estimate for blocks of size 2^( 2) =       0.000424184424
  error estimate for blocks of size 2^( 3) =       0.000436675656
  error estimate for blocks of size 2^( 4) =       0.000449389644
  error estimate for blocks of size 2^( 5) =       0.000459945536
  error estimate for blocks of size 2^( 6) =       0.000467231383
  error estimate for blocks of size 2^( 7) =       0.000469611709

      target function =                  N/A
              le_mean =     -16.908077425225
             les_mean =     286.223238537897
             stat err =       0.000461544568
             autocorr =       1.252502268560
              std dev =       0.583229363609
             le_variance =       0.340156490576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690807742522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908077425225       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908077425225       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908077425225       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908077425475       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908077425468       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908077425167       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908077421084       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908077426004       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 6.941009e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908077425225       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908077425225       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908077425225       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908077427151       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908077426243       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908077422443       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908077424745       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908077427725       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.735251e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908077425225       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908077425225       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908077425225       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908077423913       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908077440824       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908077388033       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908077442127       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908077406773       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.338091e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5364e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.205502
====================================================
  Execution time = 2.7778e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3548e-01
  Total weights = 2.0000e+06
  Execution time = 3.4820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768896
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768896
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409561556
  error estimate for blocks of size 2^( 2) =       0.000421681813
  error estimate for blocks of size 2^( 3) =       0.000434861369
  error estimate for blocks of size 2^( 4) =       0.000447660347
  error estimate for blocks of size 2^( 5) =       0.000459234665
  error estimate for blocks of size 2^( 6) =       0.000469400173
  error estimate for blocks of size 2^( 7) =       0.000479447074

      target function =                  N/A
              le_mean =     -16.908333059329
             les_mean =     286.227208014327
             stat err =       0.000463935565
             autocorr =       1.283148626306
              std dev =       0.579207507617
             le_variance =       0.335481336880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768952
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768952
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409561556
  error estimate for blocks of size 2^( 2) =       0.000421681813
  error estimate for blocks of size 2^( 3) =       0.000434861369
  error estimate for blocks of size 2^( 4) =       0.000447660347
  error estimate for blocks of size 2^( 5) =       0.000459234665
  error estimate for blocks of size 2^( 6) =       0.000469400173
  error estimate for blocks of size 2^( 7) =       0.000479447074

      target function =                  N/A
              le_mean =     -16.908333059328
             les_mean =     286.227208014369
             stat err =       0.000463935565
             autocorr =       1.283148626237
              std dev =       0.579207507664
             le_variance =       0.335481336935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768924
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768924
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409561556
  error estimate for blocks of size 2^( 2) =       0.000421681813
  error estimate for blocks of size 2^( 3) =       0.000434861369
  error estimate for blocks of size 2^( 4) =       0.000447660347
  error estimate for blocks of size 2^( 5) =       0.000459234665
  error estimate for blocks of size 2^( 6) =       0.000469400173
  error estimate for blocks of size 2^( 7) =       0.000479447074

      target function =                  N/A
              le_mean =     -16.908333059329
             les_mean =     286.227208014348
             stat err =       0.000463935565
             autocorr =       1.283148626280
              std dev =       0.579207507640
             le_variance =       0.335481336907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768900
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330768900
                                         uncertainty =       0.003600422312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409561556
  error estimate for blocks of size 2^( 2) =       0.000421681813
  error estimate for blocks of size 2^( 3) =       0.000434861369
  error estimate for blocks of size 2^( 4) =       0.000447660347
  error estimate for blocks of size 2^( 5) =       0.000459234665
  error estimate for blocks of size 2^( 6) =       0.000469400173
  error estimate for blocks of size 2^( 7) =       0.000479447074

      target function =                  N/A
              le_mean =     -16.908333059329
             les_mean =     286.227208014330
             stat err =       0.000463935565
             autocorr =       1.283148626304
              std dev =       0.579207507620
             le_variance =       0.335481336883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908333059329        initial  <--
     3.6380e+06     3.6380e+07             6.9410e-11       -16.908333059328
     1.4552e+07     1.4552e+08             1.7353e-11       -16.908333059329
     5.8208e+07     5.8208e+08             4.3381e-12       -16.908333059329

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5453
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.098831e-01 1 1  ON 0
 uu_1                 1.445451e-01 1 1  ON 1
 uu_2                 4.574607e-02 1 1  ON 2
 uu_3                -1.717557e-02 1 1  ON 3
 uu_4                -6.522330e-02 1 1  ON 4
 uu_5                -9.998932e-02 1 1  ON 5
 uu_6                -1.260069e-01 1 1  ON 6
 uu_7                -1.383843e-01 1 1  ON 7
 uu_8                -1.305255e-01 1 1  ON 8
 uu_9                -9.849651e-02 1 1  ON 9
 ud_0                 4.279526e-01 1 1  ON 10
 ud_1                 1.728364e-01 1 1  ON 11
 ud_2                 6.205952e-02 1 1  ON 12
 ud_3                -4.765048e-03 1 1  ON 13
 ud_4                -5.994839e-02 1 1  ON 14
 ud_5                -1.015493e-01 1 1  ON 15
 ud_6                -1.300997e-01 1 1  ON 16
 ud_7                -1.482468e-01 1 1  ON 17
 ud_8                -1.517639e-01 1 1  ON 18
 ud_9                -1.405610e-01 1 1  ON 19
 eO_0                -7.461843e-01 1 1  ON 20
 eO_1                -4.327626e-01 1 1  ON 21
 eO_2                -1.845826e-02 1 1  ON 22
 eO_3                 2.981615e-01 1 1  ON 23
 eO_4                 5.167902e-01 1 1  ON 24
 eO_5                 4.709097e-01 1 1  ON 25
 eO_6                 2.409283e-01 1 1  ON 26
 eO_7                -5.378139e-02 1 1  ON 27
 eO_8                -2.094878e-01 1 1  ON 28
 eO_9                -6.753627e-02 1 1  ON 29
eH1_0                -2.420018e-01 1 1  ON 30
eH1_1                -1.379308e-01 1 1  ON 31
eH1_2                -9.593171e-02 1 1  ON 32
eH1_3                -4.424782e-02 1 1  ON 33
eH1_4                 1.212424e-02 1 1  ON 34
eH1_5                 4.908186e-02 1 1  ON 35
eH1_6                 1.057297e-01 1 1  ON 36
eH1_7                 1.512600e-01 1 1  ON 37
eH1_8                 1.602275e-01 1 1  ON 38
eH1_9                 4.548746e-02 1 1  ON 39
eH2_0                -2.405783e-01 1 1  ON 40
eH2_1                -1.368982e-01 1 1  ON 41
eH2_2                -9.455254e-02 1 1  ON 42
eH2_3                -4.289453e-02 1 1  ON 43
eH2_4                 1.347347e-02 1 1  ON 44
eH2_5                 5.133490e-02 1 1  ON 45
eH2_6                 1.082985e-01 1 1  ON 46
eH2_7                 1.564588e-01 1 1  ON 47
eH2_8                 1.705159e-01 1 1  ON 48
eH2_9                 3.170771e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0974e+01 secs
  Total Execution time = 3.2536e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
