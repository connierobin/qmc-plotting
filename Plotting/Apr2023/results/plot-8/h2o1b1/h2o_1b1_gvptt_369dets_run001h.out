Rank =    0  Free Memory = 70723 MB
Rank =    1  Free Memory = 70722 MB
Rank =    2  Free Memory = 70722 MB
Rank =    3  Free Memory = 70722 MB
Rank =    4  Free Memory = 70721 MB
Rank =    5  Free Memory = 70721 MB
Rank =    6  Free Memory = 70721 MB
Rank =    7  Free Memory = 70721 MB
Rank =    8  Free Memory = 70721 MB
Rank =    9  Free Memory = 70721 MB
Rank =   10  Free Memory = 70721 MB
Rank =   11  Free Memory = 70721 MB
Rank =   12  Free Memory = 70721 MB
Rank =   13  Free Memory = 70721 MB
Rank =   14  Free Memory = 70720 MB
Rank =   15  Free Memory = 70709 MB
Rank =   16  Free Memory = 70708 MB
Rank =   17  Free Memory = 70708 MB
Rank =   18  Free Memory = 70707 MB
Rank =   19  Free Memory = 70707 MB
Rank =   20  Free Memory = 70707 MB
Rank =   21  Free Memory = 70707 MB
Rank =   22  Free Memory = 70707 MB
Rank =   23  Free Memory = 70707 MB
Rank =   24  Free Memory = 70707 MB
Rank =   25  Free Memory = 70707 MB
Rank =   26  Free Memory = 70707 MB
Rank =   27  Free Memory = 70707 MB
Rank =   28  Free Memory = 70707 MB
Rank =   29  Free Memory = 70707 MB
Rank =   30  Free Memory = 70707 MB
Rank =   31  Free Memory = 70707 MB
Rank =   32  Free Memory = 86472 MB
Rank =   33  Free Memory = 86472 MB
Rank =   34  Free Memory = 86472 MB
Rank =   35  Free Memory = 86472 MB
Rank =   36  Free Memory = 86472 MB
Rank =   37  Free Memory = 86472 MB
Rank =   38  Free Memory = 86472 MB
Rank =   39  Free Memory = 86472 MB
Rank =   40  Free Memory = 86472 MB
Rank =   41  Free Memory = 86472 MB
Rank =   42  Free Memory = 86472 MB
Rank =   43  Free Memory = 86472 MB
Rank =   44  Free Memory = 86472 MB
Rank =   45  Free Memory = 86472 MB
Rank =   46  Free Memory = 86472 MB
Rank =   47  Free Memory = 86472 MB
Rank =   48  Free Memory = 86472 MB
Rank =   49  Free Memory = 86472 MB
Rank =   50  Free Memory = 86472 MB
Rank =   51  Free Memory = 86472 MB
Rank =   52  Free Memory = 86472 MB
Rank =   53  Free Memory = 86472 MB
Rank =   54  Free Memory = 86472 MB
Rank =   55  Free Memory = 86472 MB
Rank =   56  Free Memory = 86472 MB
Rank =   57  Free Memory = 86472 MB
Rank =   58  Free Memory = 86472 MB
Rank =   59  Free Memory = 86472 MB
Rank =   60  Free Memory = 86472 MB
Rank =   61  Free Memory = 86472 MB
Rank =   62  Free Memory = 86472 MB
Rank =   63  Free Memory = 86472 MB
Rank =   64  Free Memory = 89467 MB
Rank =   65  Free Memory = 89467 MB
Rank =   66  Free Memory = 89467 MB
Rank =   67  Free Memory = 89467 MB
Rank =   68  Free Memory = 89467 MB
Rank =   69  Free Memory = 89467 MB
Rank =   70  Free Memory = 89467 MB
Rank =   71  Free Memory = 89467 MB
Rank =   72  Free Memory = 89467 MB
Rank =   73  Free Memory = 89467 MB
Rank =   74  Free Memory = 89467 MB
Rank =   75  Free Memory = 89467 MB
Rank =   76  Free Memory = 89467 MB
Rank =   77  Free Memory = 89467 MB
Rank =   78  Free Memory = 89467 MB
Rank =   79  Free Memory = 89467 MB
Rank =   80  Free Memory = 89467 MB
Rank =   81  Free Memory = 89467 MB
Rank =   82  Free Memory = 89467 MB
Rank =   83  Free Memory = 89467 MB
Rank =   84  Free Memory = 89467 MB
Rank =   85  Free Memory = 89467 MB
Rank =   86  Free Memory = 89467 MB
Rank =   87  Free Memory = 89467 MB
Rank =   88  Free Memory = 89467 MB
Rank =   89  Free Memory = 89467 MB
Rank =   90  Free Memory = 89467 MB
Rank =   91  Free Memory = 89467 MB
Rank =   92  Free Memory = 89467 MB
Rank =   93  Free Memory = 89467 MB
Rank =   94  Free Memory = 89467 MB
Rank =   95  Free Memory = 89467 MB
Rank =   96  Free Memory = 76852 MB
Rank =   97  Free Memory = 76852 MB
Rank =   98  Free Memory = 76852 MB
Rank =   99  Free Memory = 76852 MB
Rank =  100  Free Memory = 76852 MB
Rank =  101  Free Memory = 76852 MB
Rank =  102  Free Memory = 76852 MB
Rank =  103  Free Memory = 76852 MB
Rank =  104  Free Memory = 76852 MB
Rank =  105  Free Memory = 76852 MB
Rank =  106  Free Memory = 76852 MB
Rank =  107  Free Memory = 76852 MB
Rank =  108  Free Memory = 76852 MB
Rank =  109  Free Memory = 76851 MB
Rank =  110  Free Memory = 76851 MB
Rank =  111  Free Memory = 76851 MB
Rank =  112  Free Memory = 76851 MB
Rank =  113  Free Memory = 76851 MB
Rank =  114  Free Memory = 76851 MB
Rank =  115  Free Memory = 76851 MB
Rank =  116  Free Memory = 76851 MB
Rank =  117  Free Memory = 76851 MB
Rank =  118  Free Memory = 76851 MB
Rank =  119  Free Memory = 76851 MB
Rank =  120  Free Memory = 76851 MB
Rank =  121  Free Memory = 76851 MB
Rank =  122  Free Memory = 76851 MB
Rank =  123  Free Memory = 76851 MB
Rank =  124  Free Memory = 76851 MB
Rank =  125  Free Memory = 76851 MB
Rank =  126  Free Memory = 76851 MB
Rank =  127  Free Memory = 76851 MB
  Input file(s): opt_h2o_1b1_gvptt_369dets_run001h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_369dets_run001h.xml

  Project = H2O
  date    = 2023-05-15 14:18:11 PDT
  host    = n0026.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 403

  Range of prime numbers to use as seeds over processors and threads = 2789-3847


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.082082e-01    1         1  ON     0
     uu_1                 1.432603e-01    1         1  ON     1
     uu_2                 4.597145e-02    1         1  ON     2
     uu_3                -1.620535e-02    1         1  ON     3
     uu_4                -6.441045e-02    1         1  ON     4
     uu_5                -9.943215e-02    1         1  ON     5
     uu_6                -1.259196e-01    1         1  ON     6
     uu_7                -1.376090e-01    1         1  ON     7
     uu_8                -1.283339e-01    1         1  ON     8
     uu_9                -9.888524e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.306294e-01    1         1  ON     0
     ud_1                 1.742874e-01    1         1  ON     1
     ud_2                 6.136616e-02    1         1  ON     2
     ud_3                -6.096156e-03    1         1  ON     3
     ud_4                -6.048189e-02    1         1  ON     4
     ud_5                -1.020292e-01    1         1  ON     5
     ud_6                -1.304350e-01    1         1  ON     6
     ud_7                -1.483846e-01    1         1  ON     7
     ud_8                -1.509348e-01    1         1  ON     8
     ud_9                -1.399676e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.453560e-01    1         1  ON     0
     eO_1                -4.311340e-01    1         1  ON     1
     eO_2                -1.701160e-02    1         1  ON     2
     eO_3                 2.974036e-01    1         1  ON     3
     eO_4                 5.142758e-01    1         1  ON     4
     eO_5                 4.691238e-01    1         1  ON     5
     eO_6                 2.396093e-01    1         1  ON     6
     eO_7                -5.249441e-02    1         1  ON     7
     eO_8                -2.081295e-01    1         1  ON     8
     eO_9                -6.776471e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.419009e-01    1         1  ON     0
     eH1_1                -1.380306e-01    1         1  ON     1
     eH1_2                -9.497510e-02    1         1  ON     2
     eH1_3                -4.353488e-02    1         1  ON     3
     eH1_4                 1.229558e-02    1         1  ON     4
     eH1_5                 4.924344e-02    1         1  ON     5
     eH1_6                 1.059109e-01    1         1  ON     6
     eH1_7                 1.523201e-01    1         1  ON     7
     eH1_8                 1.609251e-01    1         1  ON     8
     eH1_9                 4.339469e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.407742e-01    1         1  ON     0
     eH2_1                -1.364522e-01    1         1  ON     1
     eH2_2                -9.334514e-02    1         1  ON     2
     eH2_3                -4.180876e-02    1         1  ON     3
     eH2_4                 1.462414e-02    1         1  ON     4
     eH2_5                 5.182405e-02    1         1  ON     5
     eH2_6                 1.090218e-01    1         1  ON     6
     eH2_7                 1.557199e-01    1         1  ON     7
     eH2_8                 1.689714e-01    1         1  ON     8
     eH2_9                 2.966750e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 369 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 6.010500e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 79 unique up determinants.
Found 79 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9415e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.359822
====================================================
  Execution time = 2.5814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3263e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332666025704
                                         uncertainty =       0.004040414055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332666025704
                                         uncertainty =       0.004040414055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407815031
  error estimate for blocks of size 2^( 2) =       0.000418958254
  error estimate for blocks of size 2^( 3) =       0.000430597663
  error estimate for blocks of size 2^( 4) =       0.000441714314
  error estimate for blocks of size 2^( 5) =       0.000451905198
  error estimate for blocks of size 2^( 6) =       0.000459463152
  error estimate for blocks of size 2^( 7) =       0.000463232563

      target function =                  N/A
              le_mean =     -16.910291902875
             les_mean =     286.290598273627
             stat err =       0.000454078807
             autocorr =       1.239755397066
              std dev =       0.576737548186
             le_variance =       0.332626199487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691029190288e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910291902875       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910295014063       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910295850122       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910297844343       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910299837072       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910300522775       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910301536925       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910301230650       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910301159138       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910301150170       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910301128082       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.021025e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910291902875       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910293085483       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910293537072       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910293843710       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910294901118       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910294840515       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910295074042       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910295028418       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910295022561       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.463222e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910291902875       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910292242750       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910292392749       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910292464591       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910292765787       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910292731128       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910292778379       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910292774088       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910292776094       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 9.794342e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2508e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.081359e-01                 1 1 ON  0
uu_1  1.432278e-01                 1 1 ON  1
uu_2  4.607120e-02                 1 1 ON  2
uu_3  -1.614637e-02                1 1 ON  3
uu_4  -6.444076e-02                1 1 ON  4
uu_5  -9.948419e-02                1 1 ON  5
uu_6  -1.258583e-01                1 1 ON  6
uu_7  -1.376924e-01                1 1 ON  7
uu_8  -1.284897e-01                1 1 ON  8
uu_9  -9.894045e-02                1 1 ON  9
ud_0  4.309757e-01                 1 1 ON  10
ud_1  1.744858e-01                 1 1 ON  11
ud_2  6.141184e-02                 1 1 ON  12
ud_3  -6.276264e-03                1 1 ON  13
ud_4  -6.061610e-02                1 1 ON  14
ud_5  -1.020332e-01                1 1 ON  15
ud_6  -1.304800e-01                1 1 ON  16
ud_7  -1.484679e-01                1 1 ON  17
ud_8  -1.510324e-01                1 1 ON  18
ud_9  -1.400679e-01                1 1 ON  19
eO_0  -7.455762e-01                1 1 ON  20
eO_1  -4.313723e-01                1 1 ON  21
eO_2  -1.704025e-02                1 1 ON  22
eO_3  2.977269e-01                 1 1 ON  23
eO_4  5.145417e-01                 1 1 ON  24
eO_5  4.692341e-01                 1 1 ON  25
eO_6  2.396920e-01                 1 1 ON  26
eO_7  -5.246029e-02                1 1 ON  27
eO_8  -2.083220e-01                1 1 ON  28
eO_9  -6.789210e-02                1 1 ON  29
eH1_0 -2.421015e-01                1 1 ON  30
eH1_1 -1.381899e-01                1 1 ON  31
eH1_2 -9.517440e-02                1 1 ON  32
eH1_3 -4.369046e-02                1 1 ON  33
eH1_4 1.219362e-02                 1 1 ON  34
eH1_5 4.928927e-02                 1 1 ON  35
eH1_6 1.060724e-01                 1 1 ON  36
eH1_7 1.525288e-01                 1 1 ON  37
eH1_8 1.611307e-01                 1 1 ON  38
eH1_9 4.357480e-02                 1 1 ON  39
eH2_0 -2.409917e-01                1 1 ON  40
eH2_1 -1.366418e-01                1 1 ON  41
eH2_2 -9.338989e-02                1 1 ON  42
eH2_3 -4.193384e-02                1 1 ON  43
eH2_4 1.451637e-02                 1 1 ON  44
eH2_5 5.191548e-02                 1 1 ON  45
eH2_6 1.091171e-01                 1 1 ON  46
eH2_7 1.557844e-01                 1 1 ON  47
eH2_8 1.691796e-01                 1 1 ON  48
eH2_9 2.987701e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8639
    reference variance = 0.268313
====================================================
  Execution time = 2.5587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3117e-01
  Total weights = 2.0000e+06
  Execution time = 2.9589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331083566731
                                         uncertainty =       0.005655879711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331083566731
                                         uncertainty =       0.005655879711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406839041
  error estimate for blocks of size 2^( 2) =       0.000418186389
  error estimate for blocks of size 2^( 3) =       0.000430747967
  error estimate for blocks of size 2^( 4) =       0.000442199838
  error estimate for blocks of size 2^( 5) =       0.000451626220
  error estimate for blocks of size 2^( 6) =       0.000458275395
  error estimate for blocks of size 2^( 7) =       0.000461285300

      target function =                  N/A
              le_mean =     -16.910412382258
             les_mean =     286.293082782698
             stat err =       0.000453346688
             autocorr =       1.241697056191
              std dev =       0.575357289175
             le_variance =       0.331036010206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331522923266
                                         uncertainty =       0.005661673343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331522923266
                                         uncertainty =       0.005661673343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407108909
  error estimate for blocks of size 2^( 2) =       0.000418437023
  error estimate for blocks of size 2^( 3) =       0.000430976931
  error estimate for blocks of size 2^( 4) =       0.000442409028
  error estimate for blocks of size 2^( 5) =       0.000451814480
  error estimate for blocks of size 2^( 6) =       0.000458448391
  error estimate for blocks of size 2^( 7) =       0.000461438829

      target function =                  N/A
              le_mean =     -16.910412151449
             les_mean =     286.293514293610
             stat err =       0.000453527682
             autocorr =       1.241041739356
              std dev =       0.575738940392
             le_variance =       0.331475327483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331362611630
                                         uncertainty =       0.005659778003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331362611630
                                         uncertainty =       0.005659778003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407010480
  error estimate for blocks of size 2^( 2) =       0.000418344380
  error estimate for blocks of size 2^( 3) =       0.000430891853
  error estimate for blocks of size 2^( 4) =       0.000442331487
  error estimate for blocks of size 2^( 5) =       0.000451744025
  error estimate for blocks of size 2^( 6) =       0.000458383421
  error estimate for blocks of size 2^( 7) =       0.000461377411

      target function =                  N/A
              le_mean =     -16.910411792618
             les_mean =     286.293341891106
             stat err =       0.000453459086
             autocorr =       1.241266497515
              std dev =       0.575599740143
             le_variance =       0.331315060853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331121544134
                                         uncertainty =       0.005656442799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331121544134
                                         uncertainty =       0.005656442799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406862379
  error estimate for blocks of size 2^( 2) =       0.000418207762
  error estimate for blocks of size 2^( 3) =       0.000430767367
  error estimate for blocks of size 2^( 4) =       0.000442217560
  error estimate for blocks of size 2^( 5) =       0.000451642004
  error estimate for blocks of size 2^( 6) =       0.000458289783
  error estimate for blocks of size 2^( 7) =       0.000461297208

      target function =                  N/A
              le_mean =     -16.910412114264
             les_mean =     286.293111699147
             stat err =       0.000453361639
             autocorr =       1.241636500035
              std dev =       0.575390293999
             le_variance =       0.331073990428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910412382258        initial  <--
     2.5000e-01     2.5000e+00             1.0210e-03       -16.910412151449
     1.0000e+00     1.0000e+01             3.4632e-04       -16.910411792618
     4.0000e+00     4.0000e+01             9.7943e-05       -16.910412114264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.4918
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.0285
    reference variance = 0.272893
====================================================
  Execution time = 2.5606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3282e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332813447492
                                         uncertainty =       0.003918447343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332813447492
                                         uncertainty =       0.003918447343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407936116
  error estimate for blocks of size 2^( 2) =       0.000419468063
  error estimate for blocks of size 2^( 3) =       0.000431647510
  error estimate for blocks of size 2^( 4) =       0.000443619779
  error estimate for blocks of size 2^( 5) =       0.000454044120
  error estimate for blocks of size 2^( 6) =       0.000463039923
  error estimate for blocks of size 2^( 7) =       0.000468699926

      target function =                  N/A
              le_mean =     -16.911239377996
             les_mean =     286.322840882975
             stat err =       0.000457350937
             autocorr =       1.256940827414
              std dev =       0.576908787862
             le_variance =       0.332823749512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691123937800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911239377996       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911239496354       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911239363139       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911239800891       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911239993950       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911240052796       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911240011904       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911239948405       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911239971735       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.878430e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911239377996       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911239409867       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911239373363       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911239475214       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911239530904       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911239550844       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911239542907       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911239524965       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911239527651       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.989553e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911239377996       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911239386120       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911239376771       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911239401649       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911239416025       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911239421414       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911239419687       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911239415079       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.299850e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2265e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.081887e-01 1 1  ON 0
 uu_1                 1.432449e-01 1 1  ON 1
 uu_2                 4.598453e-02 1 1  ON 2
 uu_3                -1.618765e-02 1 1  ON 3
 uu_4                -6.439986e-02 1 1  ON 4
 uu_5                -9.943576e-02 1 1  ON 5
 uu_6                -1.259160e-01 1 1  ON 6
 uu_7                -1.376201e-01 1 1  ON 7
 uu_8                -1.283463e-01 1 1  ON 8
 uu_9                -9.889087e-02 1 1  ON 9
 ud_0                 4.306793e-01 1 1  ON 10
 ud_1                 1.743104e-01 1 1  ON 11
 ud_2                 6.136487e-02 1 1  ON 12
 ud_3                -6.117102e-03 1 1  ON 13
 ud_4                -6.049397e-02 1 1  ON 14
 ud_5                -1.020340e-01 1 1  ON 15
 ud_6                -1.304424e-01 1 1  ON 16
 ud_7                -1.483986e-01 1 1  ON 17
 ud_8                -1.509478e-01 1 1  ON 18
 ud_9                -1.399726e-01 1 1  ON 19
 eO_0                -7.453735e-01 1 1  ON 20
 eO_1                -4.311547e-01 1 1  ON 21
 eO_2                -1.701619e-02 1 1  ON 22
 eO_3                 2.974344e-01 1 1  ON 23
 eO_4                 5.142940e-01 1 1  ON 24
 eO_5                 4.691403e-01 1 1  ON 25
 eO_6                 2.396161e-01 1 1  ON 26
 eO_7                -5.249347e-02 1 1  ON 27
 eO_8                -2.081471e-01 1 1  ON 28
 eO_9                -6.777666e-02 1 1  ON 29
eH1_0                -2.419326e-01 1 1  ON 30
eH1_1                -1.380453e-01 1 1  ON 31
eH1_2                -9.498158e-02 1 1  ON 32
eH1_3                -4.354874e-02 1 1  ON 33
eH1_4                 1.229959e-02 1 1  ON 34
eH1_5                 4.924883e-02 1 1  ON 35
eH1_6                 1.059197e-01 1 1  ON 36
eH1_7                 1.523324e-01 1 1  ON 37
eH1_8                 1.609460e-01 1 1  ON 38
eH1_9                 4.341179e-02 1 1  ON 39
eH2_0                -2.407965e-01 1 1  ON 40
eH2_1                -1.364699e-01 1 1  ON 41
eH2_2                -9.335552e-02 1 1  ON 42
eH2_3                -4.181493e-02 1 1  ON 43
eH2_4                 1.460730e-02 1 1  ON 44
eH2_5                 5.182237e-02 1 1  ON 45
eH2_6                 1.090208e-01 1 1  ON 46
eH2_7                 1.557369e-01 1 1  ON 47
eH2_8                 1.689967e-01 1 1  ON 48
eH2_9                 2.969454e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9628
    reference variance = 0.252454
====================================================
  Execution time = 2.5233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3690e-01
  Total weights = 2.0000e+06
  Execution time = 2.9640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010381545
                                         uncertainty =       0.006159312085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010381545
                                         uncertainty =       0.006159312085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416325
  error estimate for blocks of size 2^( 2) =       0.000421896821
  error estimate for blocks of size 2^( 3) =       0.000434897296
  error estimate for blocks of size 2^( 4) =       0.000446788321
  error estimate for blocks of size 2^( 5) =       0.000457675455
  error estimate for blocks of size 2^( 6) =       0.000465980770
  error estimate for blocks of size 2^( 7) =       0.000472482503

      target function =                  N/A
              le_mean =     -16.911022159579
             les_mean =     286.319553433724
             stat err =       0.000460731762
             autocorr =       1.260221981236
              std dev =       0.580416333665
             le_variance =       0.336883120386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337079462187
                                         uncertainty =       0.006158076059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337079462187
                                         uncertainty =       0.006158076059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410458395
  error estimate for blocks of size 2^( 2) =       0.000421935973
  error estimate for blocks of size 2^( 3) =       0.000434932569
  error estimate for blocks of size 2^( 4) =       0.000446821220
  error estimate for blocks of size 2^( 5) =       0.000457704642
  error estimate for blocks of size 2^( 6) =       0.000466009165
  error estimate for blocks of size 2^( 7) =       0.000472512453

      target function =                  N/A
              le_mean =     -16.911022144247
             les_mean =     286.319621982789
             stat err =       0.000460761870
             autocorr =       1.260128342185
              std dev =       0.580475829014
             le_variance =       0.336952188070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337047571088
                                         uncertainty =       0.006158603525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337047571088
                                         uncertainty =       0.006158603525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410438974
  error estimate for blocks of size 2^( 2) =       0.000421917891
  error estimate for blocks of size 2^( 3) =       0.000434916273
  error estimate for blocks of size 2^( 4) =       0.000446806037
  error estimate for blocks of size 2^( 5) =       0.000457691201
  error estimate for blocks of size 2^( 6) =       0.000465996130
  error estimate for blocks of size 2^( 7) =       0.000472498680

      target function =                  N/A
              le_mean =     -16.911022126322
             les_mean =     286.319589490677
             stat err =       0.000460748012
             autocorr =       1.260171792824
              std dev =       0.580448363079
             le_variance =       0.336920302201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337015344630
                                         uncertainty =       0.006159225132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337015344630
                                         uncertainty =       0.006159225132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410419348
  error estimate for blocks of size 2^( 2) =       0.000421899635
  error estimate for blocks of size 2^( 3) =       0.000434899841
  error estimate for blocks of size 2^( 4) =       0.000446790703
  error estimate for blocks of size 2^( 5) =       0.000457677588
  error estimate for blocks of size 2^( 6) =       0.000465982851
  error estimate for blocks of size 2^( 7) =       0.000472484691

      target function =                  N/A
              le_mean =     -16.911022151774
             les_mean =     286.319558131762
             stat err =       0.000460733958
             autocorr =       1.260215432695
              std dev =       0.580420608194
             le_variance =       0.336888082416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911022159579        initial  <--
     2.5000e+00     2.5000e+01             1.8784e-04       -16.911022144247
     1.0000e+01     1.0000e+02             4.9896e-05       -16.911022126322
     4.0000e+01     4.0000e+02             1.2999e-05       -16.911022151774

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1987
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6960e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8203
    reference variance = 0.409097
====================================================
  Execution time = 2.5727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3123e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331208969788
                                         uncertainty =       0.005312143208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331208969788
                                         uncertainty =       0.005312143208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406958984
  error estimate for blocks of size 2^( 2) =       0.000418572989
  error estimate for blocks of size 2^( 3) =       0.000430533103
  error estimate for blocks of size 2^( 4) =       0.000441984720
  error estimate for blocks of size 2^( 5) =       0.000452582042
  error estimate for blocks of size 2^( 6) =       0.000460503297
  error estimate for blocks of size 2^( 7) =       0.000464223153

      target function =                  N/A
              le_mean =     -16.911067844803
             les_mean =     286.315446714413
             stat err =       0.000454823303
             autocorr =       1.249062401432
              std dev =       0.575526913804
             le_variance =       0.331231228513


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691106784480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911067844803       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911067900897       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911067960451       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911067964699       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911067975045       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911067973294       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911067975168       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911067976538       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.368214e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911067844803       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911067858916       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911067873912       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911067874986       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911067877536       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911067877081       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911067877540       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911067877887       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 3.435974e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911067844803       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911067848337       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911067852092       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911067852362       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911067852997       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911067852882       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911067852996       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911067853084       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 8.599687e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2436e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.082075e-01 1 1  ON 0
 uu_1                 1.432596e-01 1 1  ON 1
 uu_2                 4.597266e-02 1 1  ON 2
 uu_3                -1.620514e-02 1 1  ON 3
 uu_4                -6.440878e-02 1 1  ON 4
 uu_5                -9.943203e-02 1 1  ON 5
 uu_6                -1.259198e-01 1 1  ON 6
 uu_7                -1.376094e-01 1 1  ON 7
 uu_8                -1.283351e-01 1 1  ON 8
 uu_9                -9.888692e-02 1 1  ON 9
 ud_0                 4.306319e-01 1 1  ON 10
 ud_1                 1.742903e-01 1 1  ON 11
 ud_2                 6.136681e-02 1 1  ON 12
 ud_3                -6.097783e-03 1 1  ON 13
 ud_4                -6.048326e-02 1 1  ON 14
 ud_5                -1.020295e-01 1 1  ON 15
 ud_6                -1.304347e-01 1 1  ON 16
 ud_7                -1.483837e-01 1 1  ON 17
 ud_8                -1.509360e-01 1 1  ON 18
 ud_9                -1.399692e-01 1 1  ON 19
 eO_0                -7.453590e-01 1 1  ON 20
 eO_1                -4.311360e-01 1 1  ON 21
 eO_2                -1.701172e-02 1 1  ON 22
 eO_3                 2.974071e-01 1 1  ON 23
 eO_4                 5.142783e-01 1 1  ON 24
 eO_5                 4.691250e-01 1 1  ON 25
 eO_6                 2.396099e-01 1 1  ON 26
 eO_7                -5.249335e-02 1 1  ON 27
 eO_8                -2.081316e-01 1 1  ON 28
 eO_9                -6.776633e-02 1 1  ON 29
eH1_0                -2.419043e-01 1 1  ON 30
eH1_1                -1.380319e-01 1 1  ON 31
eH1_2                -9.497676e-02 1 1  ON 32
eH1_3                -4.353625e-02 1 1  ON 33
eH1_4                 1.229416e-02 1 1  ON 34
eH1_5                 4.924569e-02 1 1  ON 35
eH1_6                 1.059125e-01 1 1  ON 36
eH1_7                 1.523212e-01 1 1  ON 37
eH1_8                 1.609272e-01 1 1  ON 38
eH1_9                 4.339668e-02 1 1  ON 39
eH2_0                -2.407762e-01 1 1  ON 40
eH2_1                -1.364535e-01 1 1  ON 41
eH2_2                -9.334564e-02 1 1  ON 42
eH2_3                -4.180905e-02 1 1  ON 43
eH2_4                 1.462194e-02 1 1  ON 44
eH2_5                 5.182562e-02 1 1  ON 45
eH2_6                 1.090233e-01 1 1  ON 46
eH2_7                 1.557202e-01 1 1  ON 47
eH2_8                 1.689725e-01 1 1  ON 48
eH2_9                 2.966923e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9062
    reference variance = 0.154183
====================================================
  Execution time = 2.5203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2823e-01
  Total weights = 2.0000e+06
  Execution time = 2.9567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328300144922
                                         uncertainty =       0.004326652800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328300144922
                                         uncertainty =       0.004326652800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405109641
  error estimate for blocks of size 2^( 2) =       0.000416950726
  error estimate for blocks of size 2^( 3) =       0.000429773097
  error estimate for blocks of size 2^( 4) =       0.000442369109
  error estimate for blocks of size 2^( 5) =       0.000453618325
  error estimate for blocks of size 2^( 6) =       0.000463231783
  error estimate for blocks of size 2^( 7) =       0.000472135840

      target function =                  N/A
              le_mean =     -16.910625999984
             les_mean =     286.297499189367
             stat err =       0.000457838764
             autocorr =       1.277261918791
              std dev =       0.572911548278
             le_variance =       0.328227642150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328301153114
                                         uncertainty =       0.004326655767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328301153114
                                         uncertainty =       0.004326655767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405110264
  error estimate for blocks of size 2^( 2) =       0.000416951214
  error estimate for blocks of size 2^( 3) =       0.000429773293
  error estimate for blocks of size 2^( 4) =       0.000442369228
  error estimate for blocks of size 2^( 5) =       0.000453618360
  error estimate for blocks of size 2^( 6) =       0.000463231924
  error estimate for blocks of size 2^( 7) =       0.000472136070

      target function =                  N/A
              le_mean =     -16.910626012323
             les_mean =     286.297500615928
             stat err =       0.000457838896
             autocorr =       1.277258724448
              std dev =       0.572912429071
             le_variance =       0.328228651384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328300616499
                                         uncertainty =       0.004326653952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328300616499
                                         uncertainty =       0.004326653952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405109932
  error estimate for blocks of size 2^( 2) =       0.000416950951
  error estimate for blocks of size 2^( 3) =       0.000429773175
  error estimate for blocks of size 2^( 4) =       0.000442369150
  error estimate for blocks of size 2^( 5) =       0.000453618325
  error estimate for blocks of size 2^( 6) =       0.000463231837
  error estimate for blocks of size 2^( 7) =       0.000472135940

      target function =                  N/A
              le_mean =     -16.910626006173
             les_mean =     286.297499870788
             stat err =       0.000457838813
             autocorr =       1.277260354938
              std dev =       0.572911960299
             le_variance =       0.328228114254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328300202761
                                         uncertainty =       0.004326652933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328300202761
                                         uncertainty =       0.004326652933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405109677
  error estimate for blocks of size 2^( 2) =       0.000416950754
  error estimate for blocks of size 2^( 3) =       0.000429773106
  error estimate for blocks of size 2^( 4) =       0.000442369113
  error estimate for blocks of size 2^( 5) =       0.000453618324
  error estimate for blocks of size 2^( 6) =       0.000463231789
  error estimate for blocks of size 2^( 7) =       0.000472135852

      target function =                  N/A
              le_mean =     -16.910626000746
             les_mean =     286.297499273059
             stat err =       0.000457838770
             autocorr =       1.277261724350
              std dev =       0.572911598813
             le_variance =       0.328227700055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910625999984        initial
     2.5000e+01     2.5000e+02             1.3682e-05       -16.910626012323  <--
     1.0000e+02     1.0000e+03             3.4360e-06       -16.910626006173
     4.0000e+02     4.0000e+03             8.5997e-07       -16.910626000746

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 4.0066e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.082055e-01 1 1  ON 0
 uu_1                 1.432574e-01 1 1  ON 1
 uu_2                 4.597620e-02 1 1  ON 2
 uu_3                -1.620446e-02 1 1  ON 3
 uu_4                -6.440385e-02 1 1  ON 4
 uu_5                -9.943164e-02 1 1  ON 5
 uu_6                -1.259202e-01 1 1  ON 6
 uu_7                -1.376109e-01 1 1  ON 7
 uu_8                -1.283388e-01 1 1  ON 8
 uu_9                -9.889195e-02 1 1  ON 9
 ud_0                 4.306393e-01 1 1  ON 10
 ud_1                 1.742986e-01 1 1  ON 11
 ud_2                 6.136877e-02 1 1  ON 12
 ud_3                -6.102610e-03 1 1  ON 13
 ud_4                -6.048736e-02 1 1  ON 14
 ud_5                -1.020305e-01 1 1  ON 15
 ud_6                -1.304336e-01 1 1  ON 16
 ud_7                -1.483810e-01 1 1  ON 17
 ud_8                -1.509397e-01 1 1  ON 18
 ud_9                -1.399742e-01 1 1  ON 19
 eO_0                -7.453678e-01 1 1  ON 20
 eO_1                -4.311419e-01 1 1  ON 21
 eO_2                -1.701206e-02 1 1  ON 22
 eO_3                 2.974173e-01 1 1  ON 23
 eO_4                 5.142860e-01 1 1  ON 24
 eO_5                 4.691286e-01 1 1  ON 25
 eO_6                 2.396117e-01 1 1  ON 26
 eO_7                -5.249017e-02 1 1  ON 27
 eO_8                -2.081376e-01 1 1  ON 28
 eO_9                -6.777118e-02 1 1  ON 29
eH1_0                -2.419143e-01 1 1  ON 30
eH1_1                -1.380356e-01 1 1  ON 31
eH1_2                -9.498173e-02 1 1  ON 32
eH1_3                -4.354036e-02 1 1  ON 33
eH1_4                 1.228989e-02 1 1  ON 34
eH1_5                 4.925243e-02 1 1  ON 35
eH1_6                 1.059171e-01 1 1  ON 36
eH1_7                 1.523244e-01 1 1  ON 37
eH1_8                 1.609338e-01 1 1  ON 38
eH1_9                 4.340265e-02 1 1  ON 39
eH2_0                -2.407820e-01 1 1  ON 40
eH2_1                -1.364573e-01 1 1  ON 41
eH2_2                -9.334715e-02 1 1  ON 42
eH2_3                -4.180992e-02 1 1  ON 43
eH2_4                 1.461538e-02 1 1  ON 44
eH2_5                 5.183034e-02 1 1  ON 45
eH2_6                 1.090280e-01 1 1  ON 46
eH2_7                 1.557209e-01 1 1  ON 47
eH2_8                 1.689760e-01 1 1  ON 48
eH2_9                 2.967440e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2510e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.946
    reference variance = 0.588058
====================================================
  Execution time = 2.8099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4387e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.8042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343828806719
                                         uncertainty =       0.009757958951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343828806719
                                         uncertainty =       0.009757958951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414647614
  error estimate for blocks of size 2^( 2) =       0.000425985437
  error estimate for blocks of size 2^( 3) =       0.000437997072
  error estimate for blocks of size 2^( 4) =       0.000449717415
  error estimate for blocks of size 2^( 5) =       0.000459430150
  error estimate for blocks of size 2^( 6) =       0.000466127261
  error estimate for blocks of size 2^( 7) =       0.000471162475

      target function =                  N/A
              le_mean =     -16.911238257321
             les_mean =     286.333844511160
             stat err =       0.000461609326
             autocorr =       1.239340970531
              std dev =       0.586400279015
             le_variance =       0.343865287229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691123825732e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911238257321       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911238286927       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911238255705       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911238225259       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911238252691       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911238283933       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911238325254       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911238324340       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911238321898       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.262593e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911238257321       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911238264904       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911238256816       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911238250155       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911238257232       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911238263935       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911238273789       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911238273837       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.893558e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911238257321       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911238259228       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911238257188       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911238255591       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911238257371       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911238258973       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911238261403       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911238261432       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.752105e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4914e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.082016e-01 1 1  ON 0
 uu_1                 1.432540e-01 1 1  ON 1
 uu_2                 4.597929e-02 1 1  ON 2
 uu_3                -1.620215e-02 1 1  ON 3
 uu_4                -6.440138e-02 1 1  ON 4
 uu_5                -9.942934e-02 1 1  ON 5
 uu_6                -1.259142e-01 1 1  ON 6
 uu_7                -1.376136e-01 1 1  ON 7
 uu_8                -1.283443e-01 1 1  ON 8
 uu_9                -9.889769e-02 1 1  ON 9
 ud_0                 4.306526e-01 1 1  ON 10
 ud_1                 1.743135e-01 1 1  ON 11
 ud_2                 6.137281e-02 1 1  ON 12
 ud_3                -6.109635e-03 1 1  ON 13
 ud_4                -6.049116e-02 1 1  ON 14
 ud_5                -1.020323e-01 1 1  ON 15
 ud_6                -1.304367e-01 1 1  ON 16
 ud_7                -1.483814e-01 1 1  ON 17
 ud_8                -1.509454e-01 1 1  ON 18
 ud_9                -1.399808e-01 1 1  ON 19
 eO_0                -7.453779e-01 1 1  ON 20
 eO_1                -4.311509e-01 1 1  ON 21
 eO_2                -1.700909e-02 1 1  ON 22
 eO_3                 2.974363e-01 1 1  ON 23
 eO_4                 5.142911e-01 1 1  ON 24
 eO_5                 4.691317e-01 1 1  ON 25
 eO_6                 2.396132e-01 1 1  ON 26
 eO_7                -5.248967e-02 1 1  ON 27
 eO_8                -2.081438e-01 1 1  ON 28
 eO_9                -6.777711e-02 1 1  ON 29
eH1_0                -2.419278e-01 1 1  ON 30
eH1_1                -1.380395e-01 1 1  ON 31
eH1_2                -9.498594e-02 1 1  ON 32
eH1_3                -4.354526e-02 1 1  ON 33
eH1_4                 1.228674e-02 1 1  ON 34
eH1_5                 4.925735e-02 1 1  ON 35
eH1_6                 1.059229e-01 1 1  ON 36
eH1_7                 1.523309e-01 1 1  ON 37
eH1_8                 1.609412e-01 1 1  ON 38
eH1_9                 4.340799e-02 1 1  ON 39
eH2_0                -2.407888e-01 1 1  ON 40
eH2_1                -1.364613e-01 1 1  ON 41
eH2_2                -9.335296e-02 1 1  ON 42
eH2_3                -4.181457e-02 1 1  ON 43
eH2_4                 1.461316e-02 1 1  ON 44
eH2_5                 5.183212e-02 1 1  ON 45
eH2_6                 1.090326e-01 1 1  ON 46
eH2_7                 1.557244e-01 1 1  ON 47
eH2_8                 1.689808e-01 1 1  ON 48
eH2_9                 2.968252e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.961
    reference variance = 0.336349
====================================================
  Execution time = 2.5541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2804e-01
  Total weights = 2.0000e+06
  Execution time = 2.9649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327609935806
                                         uncertainty =       0.004388862332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327609935806
                                         uncertainty =       0.004388862332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404994357
  error estimate for blocks of size 2^( 2) =       0.000416844897
  error estimate for blocks of size 2^( 3) =       0.000429140299
  error estimate for blocks of size 2^( 4) =       0.000440573868
  error estimate for blocks of size 2^( 5) =       0.000452243772
  error estimate for blocks of size 2^( 6) =       0.000461503353
  error estimate for blocks of size 2^( 7) =       0.000462255424

      target function =                  N/A
              le_mean =     -16.911834210152
             les_mean =     286.338177045449
             stat err =       0.000454144104
             autocorr =       1.257446214103
              std dev =       0.572748511838
             le_variance =       0.328040857812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327618734997
                                         uncertainty =       0.004388951596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327618734997
                                         uncertainty =       0.004388951596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404999802
  error estimate for blocks of size 2^( 2) =       0.000416849377
  error estimate for blocks of size 2^( 3) =       0.000429143861
  error estimate for blocks of size 2^( 4) =       0.000440576425
  error estimate for blocks of size 2^( 5) =       0.000452245780
  error estimate for blocks of size 2^( 6) =       0.000461505836
  error estimate for blocks of size 2^( 7) =       0.000462258237

      target function =                  N/A
              le_mean =     -16.911834227250
             les_mean =     286.338186444794
             stat err =       0.000454146570
             autocorr =       1.257426055136
              std dev =       0.572756212380
             le_variance =       0.328049678820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327613642108
                                         uncertainty =       0.004388899983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327613642108
                                         uncertainty =       0.004388899983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404996650
  error estimate for blocks of size 2^( 2) =       0.000416846723
  error estimate for blocks of size 2^( 3) =       0.000429141682
  error estimate for blocks of size 2^( 4) =       0.000440574751
  error estimate for blocks of size 2^( 5) =       0.000452244387
  error estimate for blocks of size 2^( 6) =       0.000461504212
  error estimate for blocks of size 2^( 7) =       0.000462256463

      target function =                  N/A
              le_mean =     -16.911834218775
             les_mean =     286.338181052742
             stat err =       0.000454144953
             autocorr =       1.257436674434
              std dev =       0.572751755512
             le_variance =       0.328044573442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327610380050
                                         uncertainty =       0.004388866848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327610380050
                                         uncertainty =       0.004388866848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404994632
  error estimate for blocks of size 2^( 2) =       0.000416845114
  error estimate for blocks of size 2^( 3) =       0.000429140460
  error estimate for blocks of size 2^( 4) =       0.000440573966
  error estimate for blocks of size 2^( 5) =       0.000452243836
  error estimate for blocks of size 2^( 6) =       0.000461503449
  error estimate for blocks of size 2^( 7) =       0.000462255541

      target function =                  N/A
              le_mean =     -16.911834210986
             les_mean =     286.338177519071
             stat err =       0.000454144198
             autocorr =       1.257445027291
              std dev =       0.572748900665
             le_variance =       0.328041303213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911834210152        initial
     6.2500e+00     6.2500e+01             7.2626e-05       -16.911834227250  <--
     2.5000e+01     2.5000e+02             1.8936e-05       -16.911834218775
     1.0000e+02     1.0000e+03             4.7521e-06       -16.911834210986

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 4.0426e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.081904e-01 1 1  ON 0
 uu_1                 1.432446e-01 1 1  ON 1
 uu_2                 4.598918e-02 1 1  ON 2
 uu_3                -1.619540e-02 1 1  ON 3
 uu_4                -6.439393e-02 1 1  ON 4
 uu_5                -9.942243e-02 1 1  ON 5
 uu_6                -1.258994e-01 1 1  ON 6
 uu_7                -1.376222e-01 1 1  ON 7
 uu_8                -1.283601e-01 1 1  ON 8
 uu_9                -9.891508e-02 1 1  ON 9
 ud_0                 4.306924e-01 1 1  ON 10
 ud_1                 1.743564e-01 1 1  ON 11
 ud_2                 6.138420e-02 1 1  ON 12
 ud_3                -6.128835e-03 1 1  ON 13
 ud_4                -6.050277e-02 1 1  ON 14
 ud_5                -1.020367e-01 1 1  ON 15
 ud_6                -1.304454e-01 1 1  ON 16
 ud_7                -1.483827e-01 1 1  ON 17
 ud_8                -1.509625e-01 1 1  ON 18
 ud_9                -1.400006e-01 1 1  ON 19
 eO_0                -7.454091e-01 1 1  ON 20
 eO_1                -4.311766e-01 1 1  ON 21
 eO_2                -1.700007e-02 1 1  ON 22
 eO_3                 2.974900e-01 1 1  ON 23
 eO_4                 5.143084e-01 1 1  ON 24
 eO_5                 4.691428e-01 1 1  ON 25
 eO_6                 2.396176e-01 1 1  ON 26
 eO_7                -5.248774e-02 1 1  ON 27
 eO_8                -2.081628e-01 1 1  ON 28
 eO_9                -6.779585e-02 1 1  ON 29
eH1_0                -2.419685e-01 1 1  ON 30
eH1_1                -1.380504e-01 1 1  ON 31
eH1_2                -9.499915e-02 1 1  ON 32
eH1_3                -4.356117e-02 1 1  ON 33
eH1_4                 1.227627e-02 1 1  ON 34
eH1_5                 4.927072e-02 1 1  ON 35
eH1_6                 1.059402e-01 1 1  ON 36
eH1_7                 1.523510e-01 1 1  ON 37
eH1_8                 1.609649e-01 1 1  ON 38
eH1_9                 4.342519e-02 1 1  ON 39
eH2_0                -2.408097e-01 1 1  ON 40
eH2_1                -1.364728e-01 1 1  ON 41
eH2_2                -9.337121e-02 1 1  ON 42
eH2_3                -4.183023e-02 1 1  ON 43
eH2_4                 1.460604e-02 1 1  ON 44
eH2_5                 5.183695e-02 1 1  ON 45
eH2_6                 1.090467e-01 1 1  ON 46
eH2_7                 1.557354e-01 1 1  ON 47
eH2_8                 1.689966e-01 1 1  ON 48
eH2_9                 2.970855e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6934e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.234946
====================================================
  Execution time = 2.5622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336087708568
                                         uncertainty =       0.011563976615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336087708568
                                         uncertainty =       0.011563976615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409870819
  error estimate for blocks of size 2^( 2) =       0.000421788687
  error estimate for blocks of size 2^( 3) =       0.000433618165
  error estimate for blocks of size 2^( 4) =       0.000445948603
  error estimate for blocks of size 2^( 5) =       0.000456752752
  error estimate for blocks of size 2^( 6) =       0.000466120845
  error estimate for blocks of size 2^( 7) =       0.000472586994

      target function =                  N/A
              le_mean =     -16.911361819294
             les_mean =     286.330146591374
             stat err =       0.000460352299
             autocorr =       1.261498194027
              std dev =       0.579644870847
             le_variance =       0.335988176300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691136181929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911361819294       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911363424080       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911364399415       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911364096439       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911364507596       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911364774770       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911364875924       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911364758524       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911364762522       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.083041e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911361819294       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911362267689       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911362554765       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911362478575       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911362573960       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911362653690       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911362665590       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911362636131       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.719249e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911361819294       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911361934790       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911362009871       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911361990842       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911362014106       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911362035372       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911362036596       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911362029728       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.453227e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2284e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.081693e-01 1 1  ON 0
 uu_1                 1.432241e-01 1 1  ON 1
 uu_2                 4.600451e-02 1 1  ON 2
 uu_3                -1.618356e-02 1 1  ON 3
 uu_4                -6.438601e-02 1 1  ON 4
 uu_5                -9.941089e-02 1 1  ON 5
 uu_6                -1.258944e-01 1 1  ON 6
 uu_7                -1.376293e-01 1 1  ON 7
 uu_8                -1.283973e-01 1 1  ON 8
 uu_9                -9.892128e-02 1 1  ON 9
 ud_0                 4.307336e-01 1 1  ON 10
 ud_1                 1.744035e-01 1 1  ON 11
 ud_2                 6.137900e-02 1 1  ON 12
 ud_3                -6.169706e-03 1 1  ON 13
 ud_4                -6.052275e-02 1 1  ON 14
 ud_5                -1.020487e-01 1 1  ON 15
 ud_6                -1.304640e-01 1 1  ON 16
 ud_7                -1.484072e-01 1 1  ON 17
 ud_8                -1.509605e-01 1 1  ON 18
 ud_9                -1.399803e-01 1 1  ON 19
 eO_0                -7.454400e-01 1 1  ON 20
 eO_1                -4.312136e-01 1 1  ON 21
 eO_2                -1.699181e-02 1 1  ON 22
 eO_3                 2.975471e-01 1 1  ON 23
 eO_4                 5.143274e-01 1 1  ON 24
 eO_5                 4.691589e-01 1 1  ON 25
 eO_6                 2.396179e-01 1 1  ON 26
 eO_7                -5.248630e-02 1 1  ON 27
 eO_8                -2.081826e-01 1 1  ON 28
 eO_9                -6.780973e-02 1 1  ON 29
eH1_0                -2.420126e-01 1 1  ON 30
eH1_1                -1.380736e-01 1 1  ON 31
eH1_2                -9.501973e-02 1 1  ON 32
eH1_3                -4.359754e-02 1 1  ON 33
eH1_4                 1.226228e-02 1 1  ON 34
eH1_5                 4.929142e-02 1 1  ON 35
eH1_6                 1.059543e-01 1 1  ON 36
eH1_7                 1.523734e-01 1 1  ON 37
eH1_8                 1.610042e-01 1 1  ON 38
eH1_9                 4.345896e-02 1 1  ON 39
eH2_0                -2.408459e-01 1 1  ON 40
eH2_1                -1.364942e-01 1 1  ON 41
eH2_2                -9.339605e-02 1 1  ON 42
eH2_3                -4.183313e-02 1 1  ON 43
eH2_4                 1.460193e-02 1 1  ON 44
eH2_5                 5.183998e-02 1 1  ON 45
eH2_6                 1.090670e-01 1 1  ON 46
eH2_7                 1.557516e-01 1 1  ON 47
eH2_8                 1.690173e-01 1 1  ON 48
eH2_9                 2.973681e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.945
    reference variance = 0.197875
====================================================
  Execution time = 2.5271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5772e-01
  Total weights = 2.0000e+06
  Execution time = 2.9564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357794405394
                                         uncertainty =       0.028682216265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357794405394
                                         uncertainty =       0.028682216265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422910576
  error estimate for blocks of size 2^( 2) =       0.000434170486
  error estimate for blocks of size 2^( 3) =       0.000445394378
  error estimate for blocks of size 2^( 4) =       0.000457313972
  error estimate for blocks of size 2^( 5) =       0.000467886025
  error estimate for blocks of size 2^( 6) =       0.000475251456
  error estimate for blocks of size 2^( 7) =       0.000477929992

      target function =                  N/A
              le_mean =     -16.910423661837
             les_mean =     286.320134955309
             stat err =       0.000469595361
             autocorr =       1.232964304539
              std dev =       0.598085872874
             le_variance =       0.357706711331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357841404862
                                         uncertainty =       0.028684439985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357841404862
                                         uncertainty =       0.028684439985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422938360
  error estimate for blocks of size 2^( 2) =       0.000434196020
  error estimate for blocks of size 2^( 3) =       0.000445416543
  error estimate for blocks of size 2^( 4) =       0.000457332566
  error estimate for blocks of size 2^( 5) =       0.000467900914
  error estimate for blocks of size 2^( 6) =       0.000475266850
  error estimate for blocks of size 2^( 7) =       0.000477943436

      target function =                  N/A
              le_mean =     -16.910423840160
             les_mean =     286.320187987479
             stat err =       0.000469610941
             autocorr =       1.232884124687
              std dev =       0.598125164594
             le_variance =       0.357753712521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357814553986
                                         uncertainty =       0.028683457938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357814553986
                                         uncertainty =       0.028683457938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422922488
  error estimate for blocks of size 2^( 2) =       0.000434181264
  error estimate for blocks of size 2^( 3) =       0.000445403436
  error estimate for blocks of size 2^( 4) =       0.000457321194
  error estimate for blocks of size 2^( 5) =       0.000467891299
  error estimate for blocks of size 2^( 6) =       0.000475257160
  error estimate for blocks of size 2^( 7) =       0.000477934496

      target function =                  N/A
              le_mean =     -16.910423685552
             les_mean =     286.320155907289
             stat err =       0.000469601037
             autocorr =       1.232924658744
              std dev =       0.598102718000
             le_variance =       0.357726861279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357796666612
                                         uncertainty =       0.028682382426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357796666612
                                         uncertainty =       0.028682382426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422911913
  error estimate for blocks of size 2^( 2) =       0.000434171680
  error estimate for blocks of size 2^( 3) =       0.000445395357
  error estimate for blocks of size 2^( 4) =       0.000457314719
  error estimate for blocks of size 2^( 5) =       0.000467886526
  error estimate for blocks of size 2^( 6) =       0.000475252021
  error estimate for blocks of size 2^( 7) =       0.000477930399

      target function =                  N/A
              le_mean =     -16.910423657494
             les_mean =     286.320137069763
             stat err =       0.000469595916
             autocorr =       1.232959425003
              std dev =       0.598087763360
             le_variance =       0.357708972681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910423661837        initial
     1.5625e+00     1.5625e+01             2.0830e-04       -16.910423840160  <--
     6.2500e+00     6.2500e+01             5.7192e-05       -16.910423685552
     2.5000e+01     2.5000e+02             1.4532e-05       -16.910423657494

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 4.0131e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.081100e-01 1 1  ON 0
 uu_1                 1.431791e-01 1 1  ON 1
 uu_2                 4.604449e-02 1 1  ON 2
 uu_3                -1.615173e-02 1 1  ON 3
 uu_4                -6.436130e-02 1 1  ON 4
 uu_5                -9.938011e-02 1 1  ON 5
 uu_6                -1.258873e-01 1 1  ON 6
 uu_7                -1.376517e-01 1 1  ON 7
 uu_8                -1.285106e-01 1 1  ON 8
 uu_9                -9.894160e-02 1 1  ON 9
 ud_0                 4.308521e-01 1 1  ON 10
 ud_1                 1.745215e-01 1 1  ON 11
 ud_2                 6.136803e-02 1 1  ON 12
 ud_3                -6.273402e-03 1 1  ON 13
 ud_4                -6.058337e-02 1 1  ON 14
 ud_5                -1.020849e-01 1 1  ON 15
 ud_6                -1.305123e-01 1 1  ON 16
 ud_7                -1.484776e-01 1 1  ON 17
 ud_8                -1.509591e-01 1 1  ON 18
 ud_9                -1.399202e-01 1 1  ON 19
 eO_0                -7.455375e-01 1 1  ON 20
 eO_1                -4.313081e-01 1 1  ON 21
 eO_2                -1.696952e-02 1 1  ON 22
 eO_3                 2.976983e-01 1 1  ON 23
 eO_4                 5.143917e-01 1 1  ON 24
 eO_5                 4.692137e-01 1 1  ON 25
 eO_6                 2.396210e-01 1 1  ON 26
 eO_7                -5.248169e-02 1 1  ON 27
 eO_8                -2.082448e-01 1 1  ON 28
 eO_9                -6.785335e-02 1 1  ON 29
eH1_0                -2.421435e-01 1 1  ON 30
eH1_1                -1.381390e-01 1 1  ON 31
eH1_2                -9.508748e-02 1 1  ON 32
eH1_3                -4.370259e-02 1 1  ON 33
eH1_4                 1.221188e-02 1 1  ON 34
eH1_5                 4.934651e-02 1 1  ON 35
eH1_6                 1.059966e-01 1 1  ON 36
eH1_7                 1.524433e-01 1 1  ON 37
eH1_8                 1.611262e-01 1 1  ON 38
eH1_9                 4.356414e-02 1 1  ON 39
eH2_0                -2.409545e-01 1 1  ON 40
eH2_1                -1.365575e-01 1 1  ON 41
eH2_2                -9.346787e-02 1 1  ON 42
eH2_3                -4.184874e-02 1 1  ON 43
eH2_4                 1.458675e-02 1 1  ON 44
eH2_5                 5.184786e-02 1 1  ON 45
eH2_6                 1.091278e-01 1 1  ON 46
eH2_7                 1.558017e-01 1 1  ON 47
eH2_8                 1.690818e-01 1 1  ON 48
eH2_9                 2.982497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2423e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8759
    reference variance = 0.26735
====================================================
  Execution time = 2.5741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3772e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337709760830
                                         uncertainty =       0.004952669783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337709760830
                                         uncertainty =       0.004952669783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410924787
  error estimate for blocks of size 2^( 2) =       0.000422854301
  error estimate for blocks of size 2^( 3) =       0.000435001268
  error estimate for blocks of size 2^( 4) =       0.000447244290
  error estimate for blocks of size 2^( 5) =       0.000459317398
  error estimate for blocks of size 2^( 6) =       0.000470237045
  error estimate for blocks of size 2^( 7) =       0.000477078020

      target function =                  N/A
              le_mean =     -16.910932763809
             les_mean =     286.317365134919
             stat err =       0.000463469188
             autocorr =       1.272087708372
              std dev =       0.581135407374
             le_variance =       0.337718361704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691093276381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910932763809       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910931927284       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910932489376       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910933224832       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910935559046       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910934875431       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910935297641       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910935523320       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910935646628       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910935690351       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 7.959719e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910932763809       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910932486070       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910932653294       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910932560196       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910933377341       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910933237055       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910933279349       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910933327997       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910933331367       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.168943e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910932763809       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910932688171       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910932731639       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910932689564       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910932895703       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910932861343       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910932870688       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910932884448       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.078686e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2453e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.078931e-01 1 1  ON 0
 uu_1                 1.432044e-01 1 1  ON 1
 uu_2                 4.609191e-02 1 1  ON 2
 uu_3                -1.610458e-02 1 1  ON 3
 uu_4                -6.432794e-02 1 1  ON 4
 uu_5                -9.940799e-02 1 1  ON 5
 uu_6                -1.259140e-01 1 1  ON 6
 uu_7                -1.376945e-01 1 1  ON 7
 uu_8                -1.284841e-01 1 1  ON 8
 uu_9                -9.896326e-02 1 1  ON 9
 ud_0                 4.310171e-01 1 1  ON 10
 ud_1                 1.745985e-01 1 1  ON 11
 ud_2                 6.138056e-02 1 1  ON 12
 ud_3                -6.412081e-03 1 1  ON 13
 ud_4                -6.071257e-02 1 1  ON 14
 ud_5                -1.020847e-01 1 1  ON 15
 ud_6                -1.305459e-01 1 1  ON 16
 ud_7                -1.485426e-01 1 1  ON 17
 ud_8                -1.508824e-01 1 1  ON 18
 ud_9                -1.398684e-01 1 1  ON 19
 eO_0                -7.457464e-01 1 1  ON 20
 eO_1                -4.314210e-01 1 1  ON 21
 eO_2                -1.696820e-02 1 1  ON 22
 eO_3                 2.978829e-01 1 1  ON 23
 eO_4                 5.145272e-01 1 1  ON 24
 eO_5                 4.693093e-01 1 1  ON 25
 eO_6                 2.396132e-01 1 1  ON 26
 eO_7                -5.244870e-02 1 1  ON 27
 eO_8                -2.082989e-01 1 1  ON 28
 eO_9                -6.790842e-02 1 1  ON 29
eH1_0                -2.423516e-01 1 1  ON 30
eH1_1                -1.383296e-01 1 1  ON 31
eH1_2                -9.512709e-02 1 1  ON 32
eH1_3                -4.374206e-02 1 1  ON 33
eH1_4                 1.217441e-02 1 1  ON 34
eH1_5                 4.936631e-02 1 1  ON 35
eH1_6                 1.061148e-01 1 1  ON 36
eH1_7                 1.525555e-01 1 1  ON 37
eH1_8                 1.612913e-01 1 1  ON 38
eH1_9                 4.367248e-02 1 1  ON 39
eH2_0                -2.410983e-01 1 1  ON 40
eH2_1                -1.366251e-01 1 1  ON 41
eH2_2                -9.355661e-02 1 1  ON 42
eH2_3                -4.195664e-02 1 1  ON 43
eH2_4                 1.453990e-02 1 1  ON 44
eH2_5                 5.186266e-02 1 1  ON 45
eH2_6                 1.092051e-01 1 1  ON 46
eH2_7                 1.558677e-01 1 1  ON 47
eH2_8                 1.691868e-01 1 1  ON 48
eH2_9                 2.998505e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9751
    reference variance = 0.251095
====================================================
  Execution time = 2.5088e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3392e-01
  Total weights = 2.0000e+06
  Execution time = 2.9750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333846066909
                                         uncertainty =       0.007309662814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333846066909
                                         uncertainty =       0.007309662814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408583076
  error estimate for blocks of size 2^( 2) =       0.000420163448
  error estimate for blocks of size 2^( 3) =       0.000432311549
  error estimate for blocks of size 2^( 4) =       0.000444394260
  error estimate for blocks of size 2^( 5) =       0.000455999852
  error estimate for blocks of size 2^( 6) =       0.000464553485
  error estimate for blocks of size 2^( 7) =       0.000468262179

      target function =                  N/A
              le_mean =     -16.910964096907
             les_mean =     286.314586780745
             stat err =       0.000458302444
             autocorr =       1.258182377812
              std dev =       0.577823728136
             le_variance =       0.333880260797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333991928945
                                         uncertainty =       0.007318325018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333991928945
                                         uncertainty =       0.007318325018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408672290
  error estimate for blocks of size 2^( 2) =       0.000420248061
  error estimate for blocks of size 2^( 3) =       0.000432390517
  error estimate for blocks of size 2^( 4) =       0.000444469164
  error estimate for blocks of size 2^( 5) =       0.000456061706
  error estimate for blocks of size 2^( 6) =       0.000464610537
  error estimate for blocks of size 2^( 7) =       0.000468317820

      target function =                  N/A
              le_mean =     -16.910962576649
             les_mean =     286.314681183794
             stat err =       0.000458364807
             autocorr =       1.257975395276
              std dev =       0.577949895745
             le_variance =       0.334026081991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333930983367
                                         uncertainty =       0.007315597141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333930983367
                                         uncertainty =       0.007315597141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408635008
  error estimate for blocks of size 2^( 2) =       0.000420212042
  error estimate for blocks of size 2^( 3) =       0.000432356329
  error estimate for blocks of size 2^( 4) =       0.000444437091
  error estimate for blocks of size 2^( 5) =       0.000456034938
  error estimate for blocks of size 2^( 6) =       0.000464586001
  error estimate for blocks of size 2^( 7) =       0.000468294761

      target function =                  N/A
              le_mean =     -16.910962801644
             les_mean =     286.314627850367
             stat err =       0.000458338198
             autocorr =       1.258058874936
              std dev =       0.577897169707
             le_variance =       0.333965138755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333857398924
                                         uncertainty =       0.007310473253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333857398924
                                         uncertainty =       0.007310473253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408590007
  error estimate for blocks of size 2^( 2) =       0.000420169909
  error estimate for blocks of size 2^( 3) =       0.000432317497
  error estimate for blocks of size 2^( 4) =       0.000444399971
  error estimate for blocks of size 2^( 5) =       0.000456004552
  error estimate for blocks of size 2^( 6) =       0.000464557871
  error estimate for blocks of size 2^( 7) =       0.000468266545

      target function =                  N/A
              le_mean =     -16.910963860242
             les_mean =     286.314590103725
             stat err =       0.000458307235
             autocorr =       1.258165997288
              std dev =       0.577833529887
             le_variance =       0.333891588262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910964096907        initial  <--
     3.9062e-01     3.9062e+00             7.9597e-04       -16.910962576649
     1.5625e+00     1.5625e+01             2.1689e-04       -16.910962801644
     6.2500e+00     6.2500e+01             6.0787e-05       -16.910963860242

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5913
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.081100e-01 1 1  ON 0
 uu_1                 1.431791e-01 1 1  ON 1
 uu_2                 4.604449e-02 1 1  ON 2
 uu_3                -1.615173e-02 1 1  ON 3
 uu_4                -6.436130e-02 1 1  ON 4
 uu_5                -9.938011e-02 1 1  ON 5
 uu_6                -1.258873e-01 1 1  ON 6
 uu_7                -1.376517e-01 1 1  ON 7
 uu_8                -1.285106e-01 1 1  ON 8
 uu_9                -9.894160e-02 1 1  ON 9
 ud_0                 4.308521e-01 1 1  ON 10
 ud_1                 1.745215e-01 1 1  ON 11
 ud_2                 6.136803e-02 1 1  ON 12
 ud_3                -6.273402e-03 1 1  ON 13
 ud_4                -6.058337e-02 1 1  ON 14
 ud_5                -1.020849e-01 1 1  ON 15
 ud_6                -1.305123e-01 1 1  ON 16
 ud_7                -1.484776e-01 1 1  ON 17
 ud_8                -1.509591e-01 1 1  ON 18
 ud_9                -1.399202e-01 1 1  ON 19
 eO_0                -7.455375e-01 1 1  ON 20
 eO_1                -4.313081e-01 1 1  ON 21
 eO_2                -1.696952e-02 1 1  ON 22
 eO_3                 2.976983e-01 1 1  ON 23
 eO_4                 5.143917e-01 1 1  ON 24
 eO_5                 4.692137e-01 1 1  ON 25
 eO_6                 2.396210e-01 1 1  ON 26
 eO_7                -5.248169e-02 1 1  ON 27
 eO_8                -2.082448e-01 1 1  ON 28
 eO_9                -6.785335e-02 1 1  ON 29
eH1_0                -2.421435e-01 1 1  ON 30
eH1_1                -1.381390e-01 1 1  ON 31
eH1_2                -9.508748e-02 1 1  ON 32
eH1_3                -4.370259e-02 1 1  ON 33
eH1_4                 1.221188e-02 1 1  ON 34
eH1_5                 4.934651e-02 1 1  ON 35
eH1_6                 1.059966e-01 1 1  ON 36
eH1_7                 1.524433e-01 1 1  ON 37
eH1_8                 1.611262e-01 1 1  ON 38
eH1_9                 4.356414e-02 1 1  ON 39
eH2_0                -2.409545e-01 1 1  ON 40
eH2_1                -1.365575e-01 1 1  ON 41
eH2_2                -9.346787e-02 1 1  ON 42
eH2_3                -4.184874e-02 1 1  ON 43
eH2_4                 1.458675e-02 1 1  ON 44
eH2_5                 5.184786e-02 1 1  ON 45
eH2_6                 1.091278e-01 1 1  ON 46
eH2_7                 1.558017e-01 1 1  ON 47
eH2_8                 1.690818e-01 1 1  ON 48
eH2_9                 2.982497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6932e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8814
    reference variance = 0.176534
====================================================
  Execution time = 2.5914e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2822e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328032524225
                                         uncertainty =       0.003525605371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328032524225
                                         uncertainty =       0.003525605371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405105378
  error estimate for blocks of size 2^( 2) =       0.000416894379
  error estimate for blocks of size 2^( 3) =       0.000428997448
  error estimate for blocks of size 2^( 4) =       0.000440946193
  error estimate for blocks of size 2^( 5) =       0.000451654628
  error estimate for blocks of size 2^( 6) =       0.000460716931
  error estimate for blocks of size 2^( 7) =       0.000465803126

      target function =                  N/A
              le_mean =     -16.911218951332
             les_mean =     286.317546990104
             stat err =       0.000454780219
             autocorr =       1.260280210160
              std dev =       0.572905519536
             le_variance =       0.328220734315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691121895133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911218951332       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911219208015       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911219600917       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911219718155       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911219869407       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911219907291       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911219916784       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911219903033       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911219876518       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.120863e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911218951332       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911219018218       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911219120651       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911219148522       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911219182813       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911219195510       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911219199164       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911219196193       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.007381e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911218951332       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911218968232       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911218994122       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911219000997       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911219009295       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911219012678       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911219013698       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911219012993       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 7.589343e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2529e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.081015e-01 1 1  ON 0
 uu_1                 1.431814e-01 1 1  ON 1
 uu_2                 4.604726e-02 1 1  ON 2
 uu_3                -1.614470e-02 1 1  ON 3
 uu_4                -6.435566e-02 1 1  ON 4
 uu_5                -9.938160e-02 1 1  ON 5
 uu_6                -1.258849e-01 1 1  ON 6
 uu_7                -1.376494e-01 1 1  ON 7
 uu_8                -1.285264e-01 1 1  ON 8
 uu_9                -9.895260e-02 1 1  ON 9
 ud_0                 4.308822e-01 1 1  ON 10
 ud_1                 1.745316e-01 1 1  ON 11
 ud_2                 6.136898e-02 1 1  ON 12
 ud_3                -6.283535e-03 1 1  ON 13
 ud_4                -6.059097e-02 1 1  ON 14
 ud_5                -1.020905e-01 1 1  ON 15
 ud_6                -1.305091e-01 1 1  ON 16
 ud_7                -1.484770e-01 1 1  ON 17
 ud_8                -1.509690e-01 1 1  ON 18
 ud_9                -1.399300e-01 1 1  ON 19
 eO_0                -7.455574e-01 1 1  ON 20
 eO_1                -4.313151e-01 1 1  ON 21
 eO_2                -1.697032e-02 1 1  ON 22
 eO_3                 2.977249e-01 1 1  ON 23
 eO_4                 5.144028e-01 1 1  ON 24
 eO_5                 4.692201e-01 1 1  ON 25
 eO_6                 2.396289e-01 1 1  ON 26
 eO_7                -5.248157e-02 1 1  ON 27
 eO_8                -2.082591e-01 1 1  ON 28
 eO_9                -6.786253e-02 1 1  ON 29
eH1_0                -2.421613e-01 1 1  ON 30
eH1_1                -1.381459e-01 1 1  ON 31
eH1_2                -9.509553e-02 1 1  ON 32
eH1_3                -4.371239e-02 1 1  ON 33
eH1_4                 1.221052e-02 1 1  ON 34
eH1_5                 4.934401e-02 1 1  ON 35
eH1_6                 1.060066e-01 1 1  ON 36
eH1_7                 1.524563e-01 1 1  ON 37
eH1_8                 1.611384e-01 1 1  ON 38
eH1_9                 4.357317e-02 1 1  ON 39
eH2_0                -2.409650e-01 1 1  ON 40
eH2_1                -1.365618e-01 1 1  ON 41
eH2_2                -9.347033e-02 1 1  ON 42
eH2_3                -4.185852e-02 1 1  ON 43
eH2_4                 1.458027e-02 1 1  ON 44
eH2_5                 5.184932e-02 1 1  ON 45
eH2_6                 1.091336e-01 1 1  ON 46
eH2_7                 1.558069e-01 1 1  ON 47
eH2_8                 1.690921e-01 1 1  ON 48
eH2_9                 2.983719e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9573
    reference variance = 0.180221
====================================================
  Execution time = 2.5009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2698e-01
  Total weights = 2.0000e+06
  Execution time = 2.9748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326859251002
                                         uncertainty =       0.005281554946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326859251002
                                         uncertainty =       0.005281554946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404331120
  error estimate for blocks of size 2^( 2) =       0.000415891703
  error estimate for blocks of size 2^( 3) =       0.000428549952
  error estimate for blocks of size 2^( 4) =       0.000440127300
  error estimate for blocks of size 2^( 5) =       0.000451626918
  error estimate for blocks of size 2^( 6) =       0.000458182231
  error estimate for blocks of size 2^( 7) =       0.000461156561

      target function =                  N/A
              le_mean =     -16.910279959620
             les_mean =     286.284535457930
             stat err =       0.000452773253
             autocorr =       1.253970123905
              std dev =       0.571810553139
             le_variance =       0.326967308682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326919837861
                                         uncertainty =       0.005281658593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326919837861
                                         uncertainty =       0.005281658593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404368592
  error estimate for blocks of size 2^( 2) =       0.000415926662
  error estimate for blocks of size 2^( 3) =       0.000428582318
  error estimate for blocks of size 2^( 4) =       0.000440157442
  error estimate for blocks of size 2^( 5) =       0.000451656256
  error estimate for blocks of size 2^( 6) =       0.000458209322
  error estimate for blocks of size 2^( 7) =       0.000461182237

      target function =                  N/A
              le_mean =     -16.910280167230
             les_mean =     286.284603086277
             stat err =       0.000452801314
             autocorr =       1.253893139894
              std dev =       0.571863546300
             le_variance =       0.327027915586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326892505833
                                         uncertainty =       0.005281622288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326892505833
                                         uncertainty =       0.005281622288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404351689
  error estimate for blocks of size 2^( 2) =       0.000415910923
  error estimate for blocks of size 2^( 3) =       0.000428567788
  error estimate for blocks of size 2^( 4) =       0.000440143964
  error estimate for blocks of size 2^( 5) =       0.000451643147
  error estimate for blocks of size 2^( 6) =       0.000458197252
  error estimate for blocks of size 2^( 7) =       0.000461170851

      target function =                  N/A
              le_mean =     -16.910280068644
             les_mean =     286.284572413693
             stat err =       0.000452788803
             autocorr =       1.253928676993
              std dev =       0.571839642909
             le_variance =       0.327000577202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326863452122
                                         uncertainty =       0.005281563398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326863452122
                                         uncertainty =       0.005281563398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404333718
  error estimate for blocks of size 2^( 2) =       0.000415894130
  error estimate for blocks of size 2^( 3) =       0.000428552205
  error estimate for blocks of size 2^( 4) =       0.000440129405
  error estimate for blocks of size 2^( 5) =       0.000451628968
  error estimate for blocks of size 2^( 6) =       0.000458184127
  error estimate for blocks of size 2^( 7) =       0.000461158366

      target function =                  N/A
              le_mean =     -16.910279972778
             les_mean =     286.284540105759
             stat err =       0.000452775216
             autocorr =       1.253964883311
              std dev =       0.571814228158
             le_variance =       0.326971511524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910279959620        initial
     3.9062e+00     3.9062e+01             1.1209e-04       -16.910280167230  <--
     1.5625e+01     1.5625e+02             3.0074e-05       -16.910280068644
     6.2500e+01     6.2500e+02             7.5893e-06       -16.910279972778

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.9927e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.080790e-01 1 1  ON 0
 uu_1                 1.431867e-01 1 1  ON 1
 uu_2                 4.605634e-02 1 1  ON 2
 uu_3                -1.612560e-02 1 1  ON 3
 uu_4                -6.434120e-02 1 1  ON 4
 uu_5                -9.938375e-02 1 1  ON 5
 uu_6                -1.258816e-01 1 1  ON 6
 uu_7                -1.376433e-01 1 1  ON 7
 uu_8                -1.285726e-01 1 1  ON 8
 uu_9                -9.898552e-02 1 1  ON 9
 ud_0                 4.309642e-01 1 1  ON 10
 ud_1                 1.745637e-01 1 1  ON 11
 ud_2                 6.137217e-02 1 1  ON 12
 ud_3                -6.310267e-03 1 1  ON 13
 ud_4                -6.061411e-02 1 1  ON 14
 ud_5                -1.021046e-01 1 1  ON 15
 ud_6                -1.305020e-01 1 1  ON 16
 ud_7                -1.484754e-01 1 1  ON 17
 ud_8                -1.509963e-01 1 1  ON 18
 ud_9                -1.399591e-01 1 1  ON 19
 eO_0                -7.456165e-01 1 1  ON 20
 eO_1                -4.313381e-01 1 1  ON 21
 eO_2                -1.697123e-02 1 1  ON 22
 eO_3                 2.977999e-01 1 1  ON 23
 eO_4                 5.144390e-01 1 1  ON 24
 eO_5                 4.692425e-01 1 1  ON 25
 eO_6                 2.396527e-01 1 1  ON 26
 eO_7                -5.248022e-02 1 1  ON 27
 eO_8                -2.083031e-01 1 1  ON 28
 eO_9                -6.789141e-02 1 1  ON 29
eH1_0                -2.422146e-01 1 1  ON 30
eH1_1                -1.381675e-01 1 1  ON 31
eH1_2                -9.512183e-02 1 1  ON 32
eH1_3                -4.374314e-02 1 1  ON 33
eH1_4                 1.220551e-02 1 1  ON 34
eH1_5                 4.933625e-02 1 1  ON 35
eH1_6                 1.060363e-01 1 1  ON 36
eH1_7                 1.524961e-01 1 1  ON 37
eH1_8                 1.611771e-01 1 1  ON 38
eH1_9                 4.360242e-02 1 1  ON 39
eH2_0                -2.409972e-01 1 1  ON 40
eH2_1                -1.365756e-01 1 1  ON 41
eH2_2                -9.347793e-02 1 1  ON 42
eH2_3                -4.188909e-02 1 1  ON 43
eH2_4                 1.455847e-02 1 1  ON 44
eH2_5                 5.185184e-02 1 1  ON 45
eH2_6                 1.091516e-01 1 1  ON 46
eH2_7                 1.558238e-01 1 1  ON 47
eH2_8                 1.691256e-01 1 1  ON 48
eH2_9                 2.987652e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9219
    reference variance = 0.18495
====================================================
  Execution time = 2.5866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2816e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328192272973
                                         uncertainty =       0.004004702993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328192272973
                                         uncertainty =       0.004004702993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405065772
  error estimate for blocks of size 2^( 2) =       0.000417195783
  error estimate for blocks of size 2^( 3) =       0.000430005195
  error estimate for blocks of size 2^( 4) =       0.000443002783
  error estimate for blocks of size 2^( 5) =       0.000453783991
  error estimate for blocks of size 2^( 6) =       0.000462943736
  error estimate for blocks of size 2^( 7) =       0.000470273192

      target function =                  N/A
              le_mean =     -16.910908887370
             les_mean =     286.306995792112
             stat err =       0.000457500925
             autocorr =       1.275653896758
              std dev =       0.572849508399
             le_variance =       0.328156559273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691090888737e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910908887370       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910909442373       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910910194660       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910909330514       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910909339796       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910909341716       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910909495039       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910909808306       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910909730915       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.287855e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910908887370       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910909046329       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910909259971       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910909026506       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910909040711       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910909039194       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910909069241       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910909123117       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 9.177910e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910908887370       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910908928611       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910908984086       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910908924505       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910908929317       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910908929251       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910908936508       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910908947700       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.359201e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2493e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.080500e-01 1 1  ON 0
 uu_1                 1.431783e-01 1 1  ON 1
 uu_2                 4.605285e-02 1 1  ON 2
 uu_3                -1.609162e-02 1 1  ON 3
 uu_4                -6.434116e-02 1 1  ON 4
 uu_5                -9.938579e-02 1 1  ON 5
 uu_6                -1.258823e-01 1 1  ON 6
 uu_7                -1.376643e-01 1 1  ON 7
 uu_8                -1.285752e-01 1 1  ON 8
 uu_9                -9.900760e-02 1 1  ON 9
 ud_0                 4.310560e-01 1 1  ON 10
 ud_1                 1.746134e-01 1 1  ON 11
 ud_2                 6.135709e-02 1 1  ON 12
 ud_3                -6.360636e-03 1 1  ON 13
 ud_4                -6.065092e-02 1 1  ON 14
 ud_5                -1.021169e-01 1 1  ON 15
 ud_6                -1.305301e-01 1 1  ON 16
 ud_7                -1.484697e-01 1 1  ON 17
 ud_8                -1.509845e-01 1 1  ON 18
 ud_9                -1.399766e-01 1 1  ON 19
 eO_0                -7.456851e-01 1 1  ON 20
 eO_1                -4.313898e-01 1 1  ON 21
 eO_2                -1.696388e-02 1 1  ON 22
 eO_3                 2.978492e-01 1 1  ON 23
 eO_4                 5.144926e-01 1 1  ON 24
 eO_5                 4.692914e-01 1 1  ON 25
 eO_6                 2.396621e-01 1 1  ON 26
 eO_7                -5.246377e-02 1 1  ON 27
 eO_8                -2.083363e-01 1 1  ON 28
 eO_9                -6.792032e-02 1 1  ON 29
eH1_0                -2.422988e-01 1 1  ON 30
eH1_1                -1.382147e-01 1 1  ON 31
eH1_2                -9.514911e-02 1 1  ON 32
eH1_3                -4.378578e-02 1 1  ON 33
eH1_4                 1.220268e-02 1 1  ON 34
eH1_5                 4.932133e-02 1 1  ON 35
eH1_6                 1.060832e-01 1 1  ON 36
eH1_7                 1.525643e-01 1 1  ON 37
eH1_8                 1.612321e-01 1 1  ON 38
eH1_9                 4.364407e-02 1 1  ON 39
eH2_0                -2.410438e-01 1 1  ON 40
eH2_1                -1.366169e-01 1 1  ON 41
eH2_2                -9.351189e-02 1 1  ON 42
eH2_3                -4.190514e-02 1 1  ON 43
eH2_4                 1.451116e-02 1 1  ON 44
eH2_5                 5.185511e-02 1 1  ON 45
eH2_6                 1.091937e-01 1 1  ON 46
eH2_7                 1.558606e-01 1 1  ON 47
eH2_8                 1.691685e-01 1 1  ON 48
eH2_9                 2.993489e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.390016
====================================================
  Execution time = 2.5214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3345e-01
  Total weights = 2.0000e+06
  Execution time = 3.0366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333454267370
                                         uncertainty =       0.005735139176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333454267370
                                         uncertainty =       0.005735139176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408282196
  error estimate for blocks of size 2^( 2) =       0.000419444683
  error estimate for blocks of size 2^( 3) =       0.000431763666
  error estimate for blocks of size 2^( 4) =       0.000441985906
  error estimate for blocks of size 2^( 5) =       0.000451183011
  error estimate for blocks of size 2^( 6) =       0.000459569486
  error estimate for blocks of size 2^( 7) =       0.000465548292

      target function =                  N/A
              le_mean =     -16.911133018925
             les_mean =     286.319808519698
             stat err =       0.000454571674
             autocorr =       1.239606532077
              std dev =       0.577398218390
             le_variance =       0.333388702600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640559605
                                         uncertainty =       0.005740134024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333640559605
                                         uncertainty =       0.005740134024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408396198
  error estimate for blocks of size 2^( 2) =       0.000419552790
  error estimate for blocks of size 2^( 3) =       0.000431864654
  error estimate for blocks of size 2^( 4) =       0.000442080176
  error estimate for blocks of size 2^( 5) =       0.000451275104
  error estimate for blocks of size 2^( 6) =       0.000459656837
  error estimate for blocks of size 2^( 7) =       0.000465626583

      target function =                  N/A
              le_mean =     -16.911133322885
             les_mean =     286.320005006153
             stat err =       0.000454659675
             autocorr =       1.239394300004
              std dev =       0.577559441564
             le_variance =       0.333574908540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333568627086
                                         uncertainty =       0.005738137373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333568627086
                                         uncertainty =       0.005738137373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408352184
  error estimate for blocks of size 2^( 2) =       0.000419510983
  error estimate for blocks of size 2^( 3) =       0.000431825601
  error estimate for blocks of size 2^( 4) =       0.000442043942
  error estimate for blocks of size 2^( 5) =       0.000451239953
  error estimate for blocks of size 2^( 6) =       0.000459623606
  error estimate for blocks of size 2^( 7) =       0.000465597164

      target function =                  N/A
              le_mean =     -16.911133209162
             les_mean =     286.319929263175
             stat err =       0.000454626166
             autocorr =       1.239478765755
              std dev =       0.577497196451
             le_variance =       0.333503011908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333469051572
                                         uncertainty =       0.005735529033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333469051572
                                         uncertainty =       0.005735529033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408291244
  error estimate for blocks of size 2^( 2) =       0.000419453241
  error estimate for blocks of size 2^( 3) =       0.000431771651
  error estimate for blocks of size 2^( 4) =       0.000441993383
  error estimate for blocks of size 2^( 5) =       0.000451190354
  error estimate for blocks of size 2^( 6) =       0.000459576462
  error estimate for blocks of size 2^( 7) =       0.000465554573

      target function =                  N/A
              le_mean =     -16.911133036208
             les_mean =     286.319823882093
             stat err =       0.000454578693
             autocorr =       1.239589866783
              std dev =       0.577411015200
             le_variance =       0.333403480474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911133018925        initial
     9.7656e-01     9.7656e+00             3.2879e-04       -16.911133322885  <--
     3.9062e+00     3.9062e+01             9.1779e-05       -16.911133209162
     1.5625e+01     1.5625e+02             2.3592e-05       -16.911133036208

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.0225e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.079752e-01 1 1  ON 0
 uu_1                 1.431577e-01 1 1  ON 1
 uu_2                 4.605586e-02 1 1  ON 2
 uu_3                -1.602223e-02 1 1  ON 3
 uu_4                -6.433099e-02 1 1  ON 4
 uu_5                -9.939402e-02 1 1  ON 5
 uu_6                -1.258891e-01 1 1  ON 6
 uu_7                -1.377259e-01 1 1  ON 7
 uu_8                -1.285862e-01 1 1  ON 8
 uu_9                -9.907643e-02 1 1  ON 9
 ud_0                 4.312784e-01 1 1  ON 10
 ud_1                 1.747451e-01 1 1  ON 11
 ud_2                 6.133267e-02 1 1  ON 12
 ud_3                -6.475990e-03 1 1  ON 13
 ud_4                -6.075365e-02 1 1  ON 14
 ud_5                -1.021605e-01 1 1  ON 15
 ud_6                -1.305907e-01 1 1  ON 16
 ud_7                -1.484578e-01 1 1  ON 17
 ud_8                -1.509538e-01 1 1  ON 18
 ud_9                -1.400296e-01 1 1  ON 19
 eO_0                -7.458861e-01 1 1  ON 20
 eO_1                -4.315318e-01 1 1  ON 21
 eO_2                -1.695804e-02 1 1  ON 22
 eO_3                 2.979828e-01 1 1  ON 23
 eO_4                 5.146561e-01 1 1  ON 24
 eO_5                 4.694456e-01 1 1  ON 25
 eO_6                 2.396977e-01 1 1  ON 26
 eO_7                -5.241403e-02 1 1  ON 27
 eO_8                -2.084387e-01 1 1  ON 28
 eO_9                -6.800922e-02 1 1  ON 29
eH1_0                -2.425434e-01 1 1  ON 30
eH1_1                -1.383527e-01 1 1  ON 31
eH1_2                -9.524845e-02 1 1  ON 32
eH1_3                -4.390569e-02 1 1  ON 33
eH1_4                 1.218046e-02 1 1  ON 34
eH1_5                 4.928058e-02 1 1  ON 35
eH1_6                 1.062221e-01 1 1  ON 36
eH1_7                 1.527709e-01 1 1  ON 37
eH1_8                 1.614007e-01 1 1  ON 38
eH1_9                 4.377242e-02 1 1  ON 39
eH2_0                -2.411881e-01 1 1  ON 40
eH2_1                -1.367416e-01 1 1  ON 41
eH2_2                -9.360649e-02 1 1  ON 42
eH2_3                -4.196277e-02 1 1  ON 43
eH2_4                 1.437824e-02 1 1  ON 44
eH2_5                 5.185414e-02 1 1  ON 45
eH2_6                 1.093165e-01 1 1  ON 46
eH2_7                 1.559753e-01 1 1  ON 47
eH2_8                 1.693012e-01 1 1  ON 48
eH2_9                 3.011454e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8548
    reference variance = 0.381323
====================================================
  Execution time = 2.5664e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2463e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324674627987
                                         uncertainty =       0.002894654660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324674627987
                                         uncertainty =       0.002894654660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402885319
  error estimate for blocks of size 2^( 2) =       0.000414308103
  error estimate for blocks of size 2^( 3) =       0.000427055650
  error estimate for blocks of size 2^( 4) =       0.000438621194
  error estimate for blocks of size 2^( 5) =       0.000449789471
  error estimate for blocks of size 2^( 6) =       0.000458702760
  error estimate for blocks of size 2^( 7) =       0.000461839508

      target function =                  N/A
              le_mean =     -16.910910544779
             les_mean =     286.303528451569
             stat err =       0.000452238233
             autocorr =       1.260003257498
              std dev =       0.569765882065
             le_variance =       0.324633160365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691091054478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910910544779       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910912219822       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910914589546       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910913368805       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910914553964       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910914622002       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910915881075       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910915765661       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910916057052       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910915966929       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910915969465       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 9.697396e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910910544779       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910911178219       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910912137462       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910911843606       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910911973643       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910911915939       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910912242501       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910912173803       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910912206401       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.701144e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910910544779       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910910726419       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910911014124       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910910964789       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910910874956       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910910962322       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910911013395       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910910992309       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910910994285       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.238845e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2363e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.079652e-01 1 1  ON 0
 uu_1                 1.431142e-01 1 1  ON 1
 uu_2                 4.612080e-02 1 1  ON 2
 uu_3                -1.598183e-02 1 1  ON 3
 uu_4                -6.430801e-02 1 1  ON 4
 uu_5                -9.935733e-02 1 1  ON 5
 uu_6                -1.258037e-01 1 1  ON 6
 uu_7                -1.376996e-01 1 1  ON 7
 uu_8                -1.287186e-01 1 1  ON 8
 uu_9                -9.922356e-02 1 1  ON 9
 ud_0                 4.315440e-01 1 1  ON 10
 ud_1                 1.749374e-01 1 1  ON 11
 ud_2                 6.146406e-02 1 1  ON 12
 ud_3                -6.512462e-03 1 1  ON 13
 ud_4                -6.087359e-02 1 1  ON 14
 ud_5                -1.022211e-01 1 1  ON 15
 ud_6                -1.305742e-01 1 1  ON 16
 ud_7                -1.484729e-01 1 1  ON 17
 ud_8                -1.511574e-01 1 1  ON 18
 ud_9                -1.401499e-01 1 1  ON 19
 eO_0                -7.460873e-01 1 1  ON 20
 eO_1                -4.317327e-01 1 1  ON 21
 eO_2                -1.696143e-02 1 1  ON 22
 eO_3                 2.982529e-01 1 1  ON 23
 eO_4                 5.148883e-01 1 1  ON 24
 eO_5                 4.696887e-01 1 1  ON 25
 eO_6                 2.397752e-01 1 1  ON 26
 eO_7                -5.240292e-02 1 1  ON 27
 eO_8                -2.086650e-01 1 1  ON 28
 eO_9                -6.818965e-02 1 1  ON 29
eH1_0                -2.427676e-01 1 1  ON 30
eH1_1                -1.385899e-01 1 1  ON 31
eH1_2                -9.536672e-02 1 1  ON 32
eH1_3                -4.397712e-02 1 1  ON 33
eH1_4                 1.212397e-02 1 1  ON 34
eH1_5                 4.940087e-02 1 1  ON 35
eH1_6                 1.063119e-01 1 1  ON 36
eH1_7                 1.529027e-01 1 1  ON 37
eH1_8                 1.616330e-01 1 1  ON 38
eH1_9                 4.393204e-02 1 1  ON 39
eH2_0                -2.413794e-01 1 1  ON 40
eH2_1                -1.369016e-01 1 1  ON 41
eH2_2                -9.372518e-02 1 1  ON 42
eH2_3                -4.203474e-02 1 1  ON 43
eH2_4                 1.426922e-02 1 1  ON 44
eH2_5                 5.186129e-02 1 1  ON 45
eH2_6                 1.095053e-01 1 1  ON 46
eH2_7                 1.560790e-01 1 1  ON 47
eH2_8                 1.694115e-01 1 1  ON 48
eH2_9                 3.033043e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9432
    reference variance = 0.69003
====================================================
  Execution time = 2.5710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2457e-01
  Total weights = 2.0000e+06
  Execution time = 2.9655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324411309961
                                         uncertainty =       0.003729985539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324411309961
                                         uncertainty =       0.003729985539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402815728
  error estimate for blocks of size 2^( 2) =       0.000414894152
  error estimate for blocks of size 2^( 3) =       0.000427290427
  error estimate for blocks of size 2^( 4) =       0.000438016951
  error estimate for blocks of size 2^( 5) =       0.000446654345
  error estimate for blocks of size 2^( 6) =       0.000452392888
  error estimate for blocks of size 2^( 7) =       0.000452578149

      target function =                  N/A
              le_mean =     -16.911417094422
             les_mean =     286.320549001011
             stat err =       0.000447410583
             autocorr =       1.233671883936
              std dev =       0.569667465957
             le_variance =       0.324521021770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324612321111
                                         uncertainty =       0.003731562812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324612321111
                                         uncertainty =       0.003731562812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402940920
  error estimate for blocks of size 2^( 2) =       0.000415012691
  error estimate for blocks of size 2^( 3) =       0.000427399621
  error estimate for blocks of size 2^( 4) =       0.000438113864
  error estimate for blocks of size 2^( 5) =       0.000446743369
  error estimate for blocks of size 2^( 6) =       0.000452468740
  error estimate for blocks of size 2^( 7) =       0.000452649397

      target function =                  N/A
              le_mean =     -16.911417123475
             les_mean =     286.320751731717
             stat err =       0.000447493843
             autocorr =       1.233364320416
              std dev =       0.569844513797
             le_variance =       0.324722769905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518194084
                                         uncertainty =       0.003730458193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518194084
                                         uncertainty =       0.003730458193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402882380
  error estimate for blocks of size 2^( 2) =       0.000414956841
  error estimate for blocks of size 2^( 3) =       0.000427348008
  error estimate for blocks of size 2^( 4) =       0.000438067717
  error estimate for blocks of size 2^( 5) =       0.000446700558
  error estimate for blocks of size 2^( 6) =       0.000452432091
  error estimate for blocks of size 2^( 7) =       0.000452615086

      target function =                  N/A
              le_mean =     -16.911416973711
             les_mean =     286.320652320186
             stat err =       0.000447453863
             autocorr =       1.233502335315
              std dev =       0.569761725432
             le_variance =       0.324628423767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423044204
                                         uncertainty =       0.003730002424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423044204
                                         uncertainty =       0.003730002424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402823057
  error estimate for blocks of size 2^( 2) =       0.000414901018
  error estimate for blocks of size 2^( 3) =       0.000427296694
  error estimate for blocks of size 2^( 4) =       0.000438022379
  error estimate for blocks of size 2^( 5) =       0.000446659177
  error estimate for blocks of size 2^( 6) =       0.000452396844
  error estimate for blocks of size 2^( 7) =       0.000452581896

      target function =                  N/A
              le_mean =     -16.911417010049
             les_mean =     286.320557956211
             stat err =       0.000447415074
             autocorr =       1.233651757756
              std dev =       0.569677830635
             le_variance =       0.324532830717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911417094422        initial
     2.4414e-01     2.4414e+00             9.6974e-04       -16.911417123475  <--
     9.7656e-01     9.7656e+00             2.7011e-04       -16.911416973711
     3.9062e+00     3.9062e+01             7.2388e-05       -16.911417010049

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.0609e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.080204e-01 1 1  ON 0
 uu_1                 1.431322e-01 1 1  ON 1
 uu_2                 4.623603e-02 1 1  ON 2
 uu_3                -1.589344e-02 1 1  ON 3
 uu_4                -6.427578e-02 1 1  ON 4
 uu_5                -9.928576e-02 1 1  ON 5
 uu_6                -1.256897e-01 1 1  ON 6
 uu_7                -1.376244e-01 1 1  ON 7
 uu_8                -1.290321e-01 1 1  ON 8
 uu_9                -9.964317e-02 1 1  ON 9
 ud_0                 4.321254e-01 1 1  ON 10
 ud_1                 1.753979e-01 1 1  ON 11
 ud_2                 6.177520e-02 1 1  ON 12
 ud_3                -6.502726e-03 1 1  ON 13
 ud_4                -6.106923e-02 1 1  ON 14
 ud_5                -1.023859e-01 1 1  ON 15
 ud_6                -1.305975e-01 1 1  ON 16
 ud_7                -1.484885e-01 1 1  ON 17
 ud_8                -1.516331e-01 1 1  ON 18
 ud_9                -1.404832e-01 1 1  ON 19
 eO_0                -7.466367e-01 1 1  ON 20
 eO_1                -4.321951e-01 1 1  ON 21
 eO_2                -1.696253e-02 1 1  ON 22
 eO_3                 2.988394e-01 1 1  ON 23
 eO_4                 5.155258e-01 1 1  ON 24
 eO_5                 4.704153e-01 1 1  ON 25
 eO_6                 2.400447e-01 1 1  ON 26
 eO_7                -5.234160e-02 1 1  ON 27
 eO_8                -2.093251e-01 1 1  ON 28
 eO_9                -6.873109e-02 1 1  ON 29
eH1_0                -2.434143e-01 1 1  ON 30
eH1_1                -1.391675e-01 1 1  ON 31
eH1_2                -9.572420e-02 1 1  ON 32
eH1_3                -4.424487e-02 1 1  ON 33
eH1_4                 1.192727e-02 1 1  ON 34
eH1_5                 4.964775e-02 1 1  ON 35
eH1_6                 1.065868e-01 1 1  ON 36
eH1_7                 1.533172e-01 1 1  ON 37
eH1_8                 1.623356e-01 1 1  ON 38
eH1_9                 4.441682e-02 1 1  ON 39
eH2_0                -2.419235e-01 1 1  ON 40
eH2_1                -1.373643e-01 1 1  ON 41
eH2_2                -9.407899e-02 1 1  ON 42
eH2_3                -4.227560e-02 1 1  ON 43
eH2_4                 1.397401e-02 1 1  ON 44
eH2_5                 5.182618e-02 1 1  ON 45
eH2_6                 1.100231e-01 1 1  ON 46
eH2_7                 1.564114e-01 1 1  ON 47
eH2_8                 1.697604e-01 1 1  ON 48
eH2_9                 3.098532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.93
    reference variance = 0.393309
====================================================
  Execution time = 2.5431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.8343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339296984102
                                         uncertainty =       0.005623221871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339296984102
                                         uncertainty =       0.005623221871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411845702
  error estimate for blocks of size 2^( 2) =       0.000423094366
  error estimate for blocks of size 2^( 3) =       0.000435331273
  error estimate for blocks of size 2^( 4) =       0.000447249948
  error estimate for blocks of size 2^( 5) =       0.000457888892
  error estimate for blocks of size 2^( 6) =       0.000465006585
  error estimate for blocks of size 2^( 7) =       0.000470846975

      target function =                  N/A
              le_mean =     -16.910793915371
             les_mean =     286.314184443855
             stat err =       0.000460248100
             autocorr =       1.248863381378
              std dev =       0.582437778080
             le_variance =       0.339233765335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691079391537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910793915371       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910793443230       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910800323342       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910797970210       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910797792586       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910798715746       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910800007371       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910800468151       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910801569325       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910802810581       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910804082441       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910804734423       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910803878172       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910803926603       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.546994e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910793915371       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910793649905       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910797382248       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910795522006       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910795400228       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910796136988       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910796834443       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910796911322       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910796827936       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910796947690       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910797167134       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.141801e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910793915371       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910793818872       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910795098437       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910794177505       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910794311576       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910794598227       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910794867574       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910794861341       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910794813048       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.835625e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2279e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.078884e-01 1 1  ON 0
 uu_1                 1.433271e-01 1 1  ON 1
 uu_2                 4.637917e-02 1 1  ON 2
 uu_3                -1.586651e-02 1 1  ON 3
 uu_4                -6.427822e-02 1 1  ON 4
 uu_5                -9.954517e-02 1 1  ON 5
 uu_6                -1.259015e-01 1 1  ON 6
 uu_7                -1.380909e-01 1 1  ON 7
 uu_8                -1.293713e-01 1 1  ON 8
 uu_9                -9.948825e-02 1 1  ON 9
 ud_0                 4.327830e-01 1 1  ON 10
 ud_1                 1.757139e-01 1 1  ON 11
 ud_2                 6.196014e-02 1 1  ON 12
 ud_3                -6.798367e-03 1 1  ON 13
 ud_4                -6.151414e-02 1 1  ON 14
 ud_5                -1.027384e-01 1 1  ON 15
 ud_6                -1.306518e-01 1 1  ON 16
 ud_7                -1.482181e-01 1 1  ON 17
 ud_8                -1.515017e-01 1 1  ON 18
 ud_9                -1.406870e-01 1 1  ON 19
 eO_0                -7.474041e-01 1 1  ON 20
 eO_1                -4.327235e-01 1 1  ON 21
 eO_2                -1.685440e-02 1 1  ON 22
 eO_3                 2.994122e-01 1 1  ON 23
 eO_4                 5.163536e-01 1 1  ON 24
 eO_5                 4.708664e-01 1 1  ON 25
 eO_6                 2.401393e-01 1 1  ON 26
 eO_7                -5.213356e-02 1 1  ON 27
 eO_8                -2.096763e-01 1 1  ON 28
 eO_9                -6.922599e-02 1 1  ON 29
eH1_0                -2.439826e-01 1 1  ON 30
eH1_1                -1.394205e-01 1 1  ON 31
eH1_2                -9.620991e-02 1 1  ON 32
eH1_3                -4.477034e-02 1 1  ON 33
eH1_4                 1.143969e-02 1 1  ON 34
eH1_5                 4.945899e-02 1 1  ON 35
eH1_6                 1.072028e-01 1 1  ON 36
eH1_7                 1.538286e-01 1 1  ON 37
eH1_8                 1.629764e-01 1 1  ON 38
eH1_9                 4.509062e-02 1 1  ON 39
eH2_0                -2.429131e-01 1 1  ON 40
eH2_1                -1.380248e-01 1 1  ON 41
eH2_2                -9.467587e-02 1 1  ON 42
eH2_3                -4.286060e-02 1 1  ON 43
eH2_4                 1.391622e-02 1 1  ON 44
eH2_5                 5.196902e-02 1 1  ON 45
eH2_6                 1.105272e-01 1 1  ON 46
eH2_7                 1.566728e-01 1 1  ON 47
eH2_8                 1.705433e-01 1 1  ON 48
eH2_9                 3.212713e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.297987
====================================================
  Execution time = 2.5074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3200e-01
  Total weights = 2.0000e+06
  Execution time = 2.9623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331705905483
                                         uncertainty =       0.004508052533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331705905483
                                         uncertainty =       0.004508052533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407205790
  error estimate for blocks of size 2^( 2) =       0.000419023364
  error estimate for blocks of size 2^( 3) =       0.000431502483
  error estimate for blocks of size 2^( 4) =       0.000443194913
  error estimate for blocks of size 2^( 5) =       0.000453615627
  error estimate for blocks of size 2^( 6) =       0.000462727425
  error estimate for blocks of size 2^( 7) =       0.000463428701

      target function =                  N/A
              le_mean =     -16.911285428481
             les_mean =     286.323207788909
             stat err =       0.000455741666
             autocorr =       1.252591852679
              std dev =       0.575875951202
             le_variance =       0.331633111173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332513513167
                                         uncertainty =       0.004513656091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332513513167
                                         uncertainty =       0.004513656091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407701054
  error estimate for blocks of size 2^( 2) =       0.000419498785
  error estimate for blocks of size 2^( 3) =       0.000431939174
  error estimate for blocks of size 2^( 4) =       0.000443603998
  error estimate for blocks of size 2^( 5) =       0.000453994444
  error estimate for blocks of size 2^( 6) =       0.000463081037
  error estimate for blocks of size 2^( 7) =       0.000463790863

      target function =                  N/A
              le_mean =     -16.911285416562
             les_mean =     286.324014572698
             stat err =       0.000456117586
             autocorr =       1.251612712467
              std dev =       0.576576359638
             le_variance =       0.332440298494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332447693739
                                         uncertainty =       0.004514443099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332447693739
                                         uncertainty =       0.004514443099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407660761
  error estimate for blocks of size 2^( 2) =       0.000419457063
  error estimate for blocks of size 2^( 3) =       0.000431897745
  error estimate for blocks of size 2^( 4) =       0.000443566413
  error estimate for blocks of size 2^( 5) =       0.000453969645
  error estimate for blocks of size 2^( 6) =       0.000463064730
  error estimate for blocks of size 2^( 7) =       0.000463775826

      target function =                  N/A
              le_mean =     -16.911283503128
             les_mean =     286.323884149688
             stat err =       0.000456094154
             autocorr =       1.251731519279
              std dev =       0.576519377566
             le_variance =       0.332374592709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820402682
                                         uncertainty =       0.004509301281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331820402682
                                         uncertainty =       0.004509301281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407276058
  error estimate for blocks of size 2^( 2) =       0.000419089742
  error estimate for blocks of size 2^( 3) =       0.000431561766
  error estimate for blocks of size 2^( 4) =       0.000443250079
  error estimate for blocks of size 2^( 5) =       0.000453669016
  error estimate for blocks of size 2^( 6) =       0.000462778369
  error estimate for blocks of size 2^( 7) =       0.000463481644

      target function =                  N/A
              le_mean =     -16.911284300744
             les_mean =     286.323284109613
             stat err =       0.000455794777
             autocorr =       1.252451529927
              std dev =       0.575975324909
             le_variance =       0.331747574904


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911285428481        initial  <--
     6.1035e-02     6.1035e-01             4.5470e-03       -16.911285416562
     2.4414e-01     2.4414e+00             1.1418e-03       -16.911283503128
     9.7656e-01     9.7656e+00             2.8356e-04       -16.911284300744

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9725
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.080204e-01 1 1  ON 0
 uu_1                 1.431322e-01 1 1  ON 1
 uu_2                 4.623603e-02 1 1  ON 2
 uu_3                -1.589344e-02 1 1  ON 3
 uu_4                -6.427578e-02 1 1  ON 4
 uu_5                -9.928576e-02 1 1  ON 5
 uu_6                -1.256897e-01 1 1  ON 6
 uu_7                -1.376244e-01 1 1  ON 7
 uu_8                -1.290321e-01 1 1  ON 8
 uu_9                -9.964317e-02 1 1  ON 9
 ud_0                 4.321254e-01 1 1  ON 10
 ud_1                 1.753979e-01 1 1  ON 11
 ud_2                 6.177520e-02 1 1  ON 12
 ud_3                -6.502726e-03 1 1  ON 13
 ud_4                -6.106923e-02 1 1  ON 14
 ud_5                -1.023859e-01 1 1  ON 15
 ud_6                -1.305975e-01 1 1  ON 16
 ud_7                -1.484885e-01 1 1  ON 17
 ud_8                -1.516331e-01 1 1  ON 18
 ud_9                -1.404832e-01 1 1  ON 19
 eO_0                -7.466367e-01 1 1  ON 20
 eO_1                -4.321951e-01 1 1  ON 21
 eO_2                -1.696253e-02 1 1  ON 22
 eO_3                 2.988394e-01 1 1  ON 23
 eO_4                 5.155258e-01 1 1  ON 24
 eO_5                 4.704153e-01 1 1  ON 25
 eO_6                 2.400447e-01 1 1  ON 26
 eO_7                -5.234160e-02 1 1  ON 27
 eO_8                -2.093251e-01 1 1  ON 28
 eO_9                -6.873109e-02 1 1  ON 29
eH1_0                -2.434143e-01 1 1  ON 30
eH1_1                -1.391675e-01 1 1  ON 31
eH1_2                -9.572420e-02 1 1  ON 32
eH1_3                -4.424487e-02 1 1  ON 33
eH1_4                 1.192727e-02 1 1  ON 34
eH1_5                 4.964775e-02 1 1  ON 35
eH1_6                 1.065868e-01 1 1  ON 36
eH1_7                 1.533172e-01 1 1  ON 37
eH1_8                 1.623356e-01 1 1  ON 38
eH1_9                 4.441682e-02 1 1  ON 39
eH2_0                -2.419235e-01 1 1  ON 40
eH2_1                -1.373643e-01 1 1  ON 41
eH2_2                -9.407899e-02 1 1  ON 42
eH2_3                -4.227560e-02 1 1  ON 43
eH2_4                 1.397401e-02 1 1  ON 44
eH2_5                 5.182618e-02 1 1  ON 45
eH2_6                 1.100231e-01 1 1  ON 46
eH2_7                 1.564114e-01 1 1  ON 47
eH2_8                 1.697604e-01 1 1  ON 48
eH2_9                 3.098532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.889
    reference variance = 0.147618
====================================================
  Execution time = 2.7881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4618e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346203941750
                                         uncertainty =       0.009956349303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346203941750
                                         uncertainty =       0.009956349303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416043535
  error estimate for blocks of size 2^( 2) =       0.000427823968
  error estimate for blocks of size 2^( 3) =       0.000439789482
  error estimate for blocks of size 2^( 4) =       0.000451081560
  error estimate for blocks of size 2^( 5) =       0.000460782287
  error estimate for blocks of size 2^( 6) =       0.000468942373
  error estimate for blocks of size 2^( 7) =       0.000469641129

      target function =                  N/A
              le_mean =     -16.911137149201
             les_mean =     286.332743951749
             stat err =       0.000462611837
             autocorr =       1.236391261754
              std dev =       0.588374409510
             le_variance =       0.346184445766


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691113714920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911137149201       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911137804275       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911139198577       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911138348934       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911138056273       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911138507010       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911138518487       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911138710554       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911138741996       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.419075e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911137149201       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911137350712       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911137810381       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911137506713       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911137469810       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911137518698       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911137575721       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911137579312       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911137590034       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.575335e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911137149201       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911137202658       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911137327511       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911137253518       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911137246420       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911137241065       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911137259508       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911137262615       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.512322e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4499e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.079685e-01 1 1  ON 0
 uu_1                 1.431660e-01 1 1  ON 1
 uu_2                 4.624330e-02 1 1  ON 2
 uu_3                -1.584915e-02 1 1  ON 3
 uu_4                -6.423048e-02 1 1  ON 4
 uu_5                -9.931332e-02 1 1  ON 5
 uu_6                -1.256964e-01 1 1  ON 6
 uu_7                -1.376424e-01 1 1  ON 7
 uu_8                -1.290919e-01 1 1  ON 8
 uu_9                -9.967408e-02 1 1  ON 9
 ud_0                 4.321935e-01 1 1  ON 10
 ud_1                 1.754695e-01 1 1  ON 11
 ud_2                 6.180896e-02 1 1  ON 12
 ud_3                -6.547951e-03 1 1  ON 13
 ud_4                -6.109975e-02 1 1  ON 14
 ud_5                -1.023962e-01 1 1  ON 15
 ud_6                -1.305880e-01 1 1  ON 16
 ud_7                -1.485052e-01 1 1  ON 17
 ud_8                -1.516474e-01 1 1  ON 18
 ud_9                -1.405411e-01 1 1  ON 19
 eO_0                -7.467325e-01 1 1  ON 20
 eO_1                -4.322083e-01 1 1  ON 21
 eO_2                -1.697799e-02 1 1  ON 22
 eO_3                 2.989006e-01 1 1  ON 23
 eO_4                 5.155972e-01 1 1  ON 24
 eO_5                 4.704813e-01 1 1  ON 25
 eO_6                 2.400830e-01 1 1  ON 26
 eO_7                -5.231652e-02 1 1  ON 27
 eO_8                -2.093888e-01 1 1  ON 28
 eO_9                -6.879488e-02 1 1  ON 29
eH1_0                -2.434868e-01 1 1  ON 30
eH1_1                -1.392413e-01 1 1  ON 31
eH1_2                -9.577406e-02 1 1  ON 32
eH1_3                -4.427834e-02 1 1  ON 33
eH1_4                 1.194786e-02 1 1  ON 34
eH1_5                 4.961334e-02 1 1  ON 35
eH1_6                 1.066088e-01 1 1  ON 36
eH1_7                 1.533790e-01 1 1  ON 37
eH1_8                 1.624219e-01 1 1  ON 38
eH1_9                 4.448814e-02 1 1  ON 39
eH2_0                -2.420108e-01 1 1  ON 40
eH2_1                -1.374211e-01 1 1  ON 41
eH2_2                -9.409430e-02 1 1  ON 42
eH2_3                -4.230843e-02 1 1  ON 43
eH2_4                 1.396345e-02 1 1  ON 44
eH2_5                 5.186270e-02 1 1  ON 45
eH2_6                 1.100361e-01 1 1  ON 46
eH2_7                 1.564383e-01 1 1  ON 47
eH2_8                 1.698018e-01 1 1  ON 48
eH2_9                 3.107205e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9269
    reference variance = 0.247764
====================================================
  Execution time = 2.5091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2453e-01
  Total weights = 2.0000e+06
  Execution time = 2.9541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324482910673
                                         uncertainty =       0.002989710615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324482910673
                                         uncertainty =       0.002989710615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402815679
  error estimate for blocks of size 2^( 2) =       0.000414780259
  error estimate for blocks of size 2^( 3) =       0.000427280991
  error estimate for blocks of size 2^( 4) =       0.000439165565
  error estimate for blocks of size 2^( 5) =       0.000450945791
  error estimate for blocks of size 2^( 6) =       0.000461078438
  error estimate for blocks of size 2^( 7) =       0.000464875638

      target function =                  N/A
              le_mean =     -16.911420124184
             les_mean =     286.320651397517
             stat err =       0.000454016358
             autocorr =       1.270370111239
              std dev =       0.569667396925
             le_variance =       0.324520943119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324529850838
                                         uncertainty =       0.002989970244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324529850838
                                         uncertainty =       0.002989970244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402844765
  error estimate for blocks of size 2^( 2) =       0.000414805938
  error estimate for blocks of size 2^( 3) =       0.000427301795
  error estimate for blocks of size 2^( 4) =       0.000439180385
  error estimate for blocks of size 2^( 5) =       0.000450959576
  error estimate for blocks of size 2^( 6) =       0.000461088036
  error estimate for blocks of size 2^( 7) =       0.000464887205

      target function =                  N/A
              le_mean =     -16.911420435493
             les_mean =     286.320708793352
             stat err =       0.000454028800
             autocorr =       1.270256294456
              std dev =       0.569708530417
             le_variance =       0.324567809630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324496363278
                                         uncertainty =       0.002989792537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324496363278
                                         uncertainty =       0.002989792537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402824005
  error estimate for blocks of size 2^( 2) =       0.000414786954
  error estimate for blocks of size 2^( 3) =       0.000427285280
  error estimate for blocks of size 2^( 4) =       0.000439166683
  error estimate for blocks of size 2^( 5) =       0.000450946609
  error estimate for blocks of size 2^( 6) =       0.000461076832
  error estimate for blocks of size 2^( 7) =       0.000464875428

      target function =                  N/A
              le_mean =     -16.911420329473
             les_mean =     286.320671756255
             stat err =       0.000454016388
             autocorr =       1.270317765365
              std dev =       0.569679171460
             le_variance =       0.324534358396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324483492540
                                         uncertainty =       0.002989718280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324483492540
                                         uncertainty =       0.002989718280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402816038
  error estimate for blocks of size 2^( 2) =       0.000414780441
  error estimate for blocks of size 2^( 3) =       0.000427280901
  error estimate for blocks of size 2^( 4) =       0.000439165089
  error estimate for blocks of size 2^( 5) =       0.000450945307
  error estimate for blocks of size 2^( 6) =       0.000461077642
  error estimate for blocks of size 2^( 7) =       0.000464875058

      target function =                  N/A
              le_mean =     -16.911420146578
             les_mean =     286.320652732784
             stat err =       0.000454015774
             autocorr =       1.270364580975
              std dev =       0.569667904106
             le_variance =       0.324521520969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911420124184        initial
     6.1035e-01     6.1035e+00             3.4191e-04       -16.911420435493  <--
     2.4414e+00     2.4414e+01             9.5753e-05       -16.911420329473
     9.7656e+00     9.7656e+01             2.5123e-05       -16.911420146578

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.9952e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.078795e-01 1 1  ON 0
 uu_1                 1.432461e-01 1 1  ON 1
 uu_2                 4.627868e-02 1 1  ON 2
 uu_3                -1.575044e-02 1 1  ON 3
 uu_4                -6.413818e-02 1 1  ON 4
 uu_5                -9.936191e-02 1 1  ON 5
 uu_6                -1.257284e-01 1 1  ON 6
 uu_7                -1.376995e-01 1 1  ON 7
 uu_8                -1.292656e-01 1 1  ON 8
 uu_9                -9.976770e-02 1 1  ON 9
 ud_0                 4.323885e-01 1 1  ON 10
 ud_1                 1.756525e-01 1 1  ON 11
 ud_2                 6.189132e-02 1 1  ON 12
 ud_3                -6.624365e-03 1 1  ON 13
 ud_4                -6.118441e-02 1 1  ON 14
 ud_5                -1.024310e-01 1 1  ON 15
 ud_6                -1.305783e-01 1 1  ON 16
 ud_7                -1.485463e-01 1 1  ON 17
 ud_8                -1.516859e-01 1 1  ON 18
 ud_9                -1.407111e-01 1 1  ON 19
 eO_0                -7.469735e-01 1 1  ON 20
 eO_1                -4.322735e-01 1 1  ON 21
 eO_2                -1.700896e-02 1 1  ON 22
 eO_3                 2.990467e-01 1 1  ON 23
 eO_4                 5.158086e-01 1 1  ON 24
 eO_5                 4.706790e-01 1 1  ON 25
 eO_6                 2.401956e-01 1 1  ON 26
 eO_7                -5.224148e-02 1 1  ON 27
 eO_8                -2.095763e-01 1 1  ON 28
 eO_9                -6.898332e-02 1 1  ON 29
eH1_0                -2.436983e-01 1 1  ON 30
eH1_1                -1.394533e-01 1 1  ON 31
eH1_2                -9.591515e-02 1 1  ON 32
eH1_3                -4.437728e-02 1 1  ON 33
eH1_4                 1.198693e-02 1 1  ON 34
eH1_5                 4.951883e-02 1 1  ON 35
eH1_6                 1.066746e-01 1 1  ON 36
eH1_7                 1.535608e-01 1 1  ON 37
eH1_8                 1.626771e-01 1 1  ON 38
eH1_9                 4.469863e-02 1 1  ON 39
eH2_0                -2.422579e-01 1 1  ON 40
eH2_1                -1.375790e-01 1 1  ON 41
eH2_2                -9.415687e-02 1 1  ON 42
eH2_3                -4.239742e-02 1 1  ON 43
eH2_4                 1.392726e-02 1 1  ON 44
eH2_5                 5.196109e-02 1 1  ON 45
eH2_6                 1.100786e-01 1 1  ON 46
eH2_7                 1.565180e-01 1 1  ON 47
eH2_8                 1.699241e-01 1 1  ON 48
eH2_9                 3.132723e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4465e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.264218
====================================================
  Execution time = 2.5628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3232e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332349796200
                                         uncertainty =       0.007599523339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332349796200
                                         uncertainty =       0.007599523339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407626283
  error estimate for blocks of size 2^( 2) =       0.000418845598
  error estimate for blocks of size 2^( 3) =       0.000430746803
  error estimate for blocks of size 2^( 4) =       0.000441926948
  error estimate for blocks of size 2^( 5) =       0.000450411503
  error estimate for blocks of size 2^( 6) =       0.000457821980
  error estimate for blocks of size 2^( 7) =       0.000460975910

      target function =                  N/A
              le_mean =     -16.911555056420
             les_mean =     286.333012633114
             stat err =       0.000452784085
             autocorr =       1.233837456807
              std dev =       0.576470617581
             le_variance =       0.332318372934


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691155505642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911555056420       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911558065648       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911559253181       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911557956031       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911556324845       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911558903963       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911560160031       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911559647933       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911560250435       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911560148550       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911560076623       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.760120e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911555056420       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911556479365       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911556883372       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911556433042       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911555950798       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911555819126       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911556607370       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911556614762       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911556613613       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 5.310315e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911555056420       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911555514171       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911555629186       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911555526261       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911555387168       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911555272221       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911555470616       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911555493303       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.421654e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2213e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.078045e-01 1 1  ON 0
 uu_1                 1.432781e-01 1 1  ON 1
 uu_2                 4.637379e-02 1 1  ON 2
 uu_3                -1.567891e-02 1 1  ON 3
 uu_4                -6.400984e-02 1 1  ON 4
 uu_5                -9.941418e-02 1 1  ON 5
 uu_6                -1.258399e-01 1 1  ON 6
 uu_7                -1.378998e-01 1 1  ON 7
 uu_8                -1.294372e-01 1 1  ON 8
 uu_9                -9.988359e-02 1 1  ON 9
 ud_0                 4.326241e-01 1 1  ON 10
 ud_1                 1.758761e-01 1 1  ON 11
 ud_2                 6.194569e-02 1 1  ON 12
 ud_3                -6.619864e-03 1 1  ON 13
 ud_4                -6.130567e-02 1 1  ON 14
 ud_5                -1.024012e-01 1 1  ON 15
 ud_6                -1.305126e-01 1 1  ON 16
 ud_7                -1.487215e-01 1 1  ON 17
 ud_8                -1.518436e-01 1 1  ON 18
 ud_9                -1.407741e-01 1 1  ON 19
 eO_0                -7.473007e-01 1 1  ON 20
 eO_1                -4.324014e-01 1 1  ON 21
 eO_2                -1.710409e-02 1 1  ON 22
 eO_3                 2.993301e-01 1 1  ON 23
 eO_4                 5.160991e-01 1 1  ON 24
 eO_5                 4.709687e-01 1 1  ON 25
 eO_6                 2.403249e-01 1 1  ON 26
 eO_7                -5.221369e-02 1 1  ON 27
 eO_8                -2.098562e-01 1 1  ON 28
 eO_9                -6.916096e-02 1 1  ON 29
eH1_0                -2.442293e-01 1 1  ON 30
eH1_1                -1.395880e-01 1 1  ON 31
eH1_2                -9.611054e-02 1 1  ON 32
eH1_3                -4.460328e-02 1 1  ON 33
eH1_4                 1.187361e-02 1 1  ON 34
eH1_5                 4.948643e-02 1 1  ON 35
eH1_6                 1.069393e-01 1 1  ON 36
eH1_7                 1.538704e-01 1 1  ON 37
eH1_8                 1.630293e-01 1 1  ON 38
eH1_9                 4.496355e-02 1 1  ON 39
eH2_0                -2.425334e-01 1 1  ON 40
eH2_1                -1.377104e-01 1 1  ON 41
eH2_2                -9.424562e-02 1 1  ON 42
eH2_3                -4.261754e-02 1 1  ON 43
eH2_4                 1.392199e-02 1 1  ON 44
eH2_5                 5.195356e-02 1 1  ON 45
eH2_6                 1.100712e-01 1 1  ON 46
eH2_7                 1.566471e-01 1 1  ON 47
eH2_8                 1.701943e-01 1 1  ON 48
eH2_9                 3.163178e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.22195
====================================================
  Execution time = 2.5011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5496e-01
  Total weights = 2.0000e+06
  Execution time = 2.9655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354984261671
                                         uncertainty =       0.021906127037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354984261671
                                         uncertainty =       0.021906127037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421248220
  error estimate for blocks of size 2^( 2) =       0.000432329538
  error estimate for blocks of size 2^( 3) =       0.000444309221
  error estimate for blocks of size 2^( 4) =       0.000456481393
  error estimate for blocks of size 2^( 5) =       0.000466370331
  error estimate for blocks of size 2^( 6) =       0.000475634581
  error estimate for blocks of size 2^( 7) =       0.000480260381

      target function =                  N/A
              le_mean =     -16.910721534341
             les_mean =     286.327402760175
             stat err =       0.000469686672
             autocorr =       1.243198035209
              std dev =       0.595734945762
             le_variance =       0.354900125602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355241425022
                                         uncertainty =       0.021916449133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355241425022
                                         uncertainty =       0.021916449133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421400767
  error estimate for blocks of size 2^( 2) =       0.000432476072
  error estimate for blocks of size 2^( 3) =       0.000444443734
  error estimate for blocks of size 2^( 4) =       0.000456596897
  error estimate for blocks of size 2^( 5) =       0.000466465623
  error estimate for blocks of size 2^( 6) =       0.000475720743
  error estimate for blocks of size 2^( 7) =       0.000480322577

      target function =                  N/A
              le_mean =     -16.910720523686
             les_mean =     286.327625664922
             stat err =       0.000469776460
             autocorr =       1.242773142865
              std dev =       0.595950679415
             le_variance =       0.355157212295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355116133950
                                         uncertainty =       0.021914014321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355116133950
                                         uncertainty =       0.021914014321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421326457
  error estimate for blocks of size 2^( 2) =       0.000432403688
  error estimate for blocks of size 2^( 3) =       0.000444375281
  error estimate for blocks of size 2^( 4) =       0.000456535215
  error estimate for blocks of size 2^( 5) =       0.000466410663
  error estimate for blocks of size 2^( 6) =       0.000475670672
  error estimate for blocks of size 2^( 7) =       0.000480276096

      target function =                  N/A
              le_mean =     -16.910721513620
             les_mean =     286.327533899802
             stat err =       0.000469723162
             autocorr =       1.242929481100
              std dev =       0.595845589143
             le_variance =       0.355031966101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354998929011
                                         uncertainty =       0.021907286609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354998929011
                                         uncertainty =       0.021907286609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421256923
  error estimate for blocks of size 2^( 2) =       0.000432337607
  error estimate for blocks of size 2^( 3) =       0.000444316090
  error estimate for blocks of size 2^( 4) =       0.000456486528
  error estimate for blocks of size 2^( 5) =       0.000466373483
  error estimate for blocks of size 2^( 6) =       0.000475637529
  error estimate for blocks of size 2^( 7) =       0.000480260147

      target function =                  N/A
              le_mean =     -16.910721474184
             les_mean =     286.327415390233
             stat err =       0.000469689422
             autocorr =       1.243161225737
              std dev =       0.595747253674
             le_variance =       0.354914790260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910721534341        initial  <--
     1.5259e-01     1.5259e+00             1.7601e-03       -16.910720523686
     6.1035e-01     6.1035e+00             5.3103e-04       -16.910721513620
     2.4414e+00     2.4414e+01             1.4217e-04       -16.910721474184

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9024
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.078795e-01 1 1  ON 0
 uu_1                 1.432461e-01 1 1  ON 1
 uu_2                 4.627868e-02 1 1  ON 2
 uu_3                -1.575044e-02 1 1  ON 3
 uu_4                -6.413818e-02 1 1  ON 4
 uu_5                -9.936191e-02 1 1  ON 5
 uu_6                -1.257284e-01 1 1  ON 6
 uu_7                -1.376995e-01 1 1  ON 7
 uu_8                -1.292656e-01 1 1  ON 8
 uu_9                -9.976770e-02 1 1  ON 9
 ud_0                 4.323885e-01 1 1  ON 10
 ud_1                 1.756525e-01 1 1  ON 11
 ud_2                 6.189132e-02 1 1  ON 12
 ud_3                -6.624365e-03 1 1  ON 13
 ud_4                -6.118441e-02 1 1  ON 14
 ud_5                -1.024310e-01 1 1  ON 15
 ud_6                -1.305783e-01 1 1  ON 16
 ud_7                -1.485463e-01 1 1  ON 17
 ud_8                -1.516859e-01 1 1  ON 18
 ud_9                -1.407111e-01 1 1  ON 19
 eO_0                -7.469735e-01 1 1  ON 20
 eO_1                -4.322735e-01 1 1  ON 21
 eO_2                -1.700896e-02 1 1  ON 22
 eO_3                 2.990467e-01 1 1  ON 23
 eO_4                 5.158086e-01 1 1  ON 24
 eO_5                 4.706790e-01 1 1  ON 25
 eO_6                 2.401956e-01 1 1  ON 26
 eO_7                -5.224148e-02 1 1  ON 27
 eO_8                -2.095763e-01 1 1  ON 28
 eO_9                -6.898332e-02 1 1  ON 29
eH1_0                -2.436983e-01 1 1  ON 30
eH1_1                -1.394533e-01 1 1  ON 31
eH1_2                -9.591515e-02 1 1  ON 32
eH1_3                -4.437728e-02 1 1  ON 33
eH1_4                 1.198693e-02 1 1  ON 34
eH1_5                 4.951883e-02 1 1  ON 35
eH1_6                 1.066746e-01 1 1  ON 36
eH1_7                 1.535608e-01 1 1  ON 37
eH1_8                 1.626771e-01 1 1  ON 38
eH1_9                 4.469863e-02 1 1  ON 39
eH2_0                -2.422579e-01 1 1  ON 40
eH2_1                -1.375790e-01 1 1  ON 41
eH2_2                -9.415687e-02 1 1  ON 42
eH2_3                -4.239742e-02 1 1  ON 43
eH2_4                 1.392726e-02 1 1  ON 44
eH2_5                 5.196109e-02 1 1  ON 45
eH2_6                 1.100786e-01 1 1  ON 46
eH2_7                 1.565180e-01 1 1  ON 47
eH2_8                 1.699241e-01 1 1  ON 48
eH2_9                 3.132723e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.139312
====================================================
  Execution time = 2.5753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2488e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324873865200
                                         uncertainty =       0.002923801650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324873865200
                                         uncertainty =       0.002923801650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403040337
  error estimate for blocks of size 2^( 2) =       0.000414619953
  error estimate for blocks of size 2^( 3) =       0.000427185583
  error estimate for blocks of size 2^( 4) =       0.000438332882
  error estimate for blocks of size 2^( 5) =       0.000448449277
  error estimate for blocks of size 2^( 6) =       0.000453105542
  error estimate for blocks of size 2^( 7) =       0.000457188609

      target function =                  N/A
              le_mean =     -16.910748758296
             les_mean =     286.298306429579
             stat err =       0.000449269077
             autocorr =       1.242556169005
              std dev =       0.569985110170
             le_variance =       0.324883025816


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691074875830e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910748758296       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910748920482       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910749282298       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910749274669       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910749362274       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910749411841       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910749120759       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910749139681       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910749265391       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.507032e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910748758296       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910748802301       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910748895978       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910748892674       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910748920531       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910748933794       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910748863375       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910748862627       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910748887472       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.829951e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910748758296       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910748769537       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910748793165       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910748792276       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910748799664       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910748802988       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910748785688       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910748785209       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.768528e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2389e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.078756e-01 1 1  ON 0
 uu_1                 1.432536e-01 1 1  ON 1
 uu_2                 4.630681e-02 1 1  ON 2
 uu_3                -1.575079e-02 1 1  ON 3
 uu_4                -6.411753e-02 1 1  ON 4
 uu_5                -9.934240e-02 1 1  ON 5
 uu_6                -1.257361e-01 1 1  ON 6
 uu_7                -1.377048e-01 1 1  ON 7
 uu_8                -1.293118e-01 1 1  ON 8
 uu_9                -9.980099e-02 1 1  ON 9
 ud_0                 4.324568e-01 1 1  ON 10
 ud_1                 1.756859e-01 1 1  ON 11
 ud_2                 6.190500e-02 1 1  ON 12
 ud_3                -6.623447e-03 1 1  ON 13
 ud_4                -6.119478e-02 1 1  ON 14
 ud_5                -1.024392e-01 1 1  ON 15
 ud_6                -1.305660e-01 1 1  ON 16
 ud_7                -1.485666e-01 1 1  ON 17
 ud_8                -1.517208e-01 1 1  ON 18
 ud_9                -1.407501e-01 1 1  ON 19
 eO_0                -7.469875e-01 1 1  ON 20
 eO_1                -4.323001e-01 1 1  ON 21
 eO_2                -1.700541e-02 1 1  ON 22
 eO_3                 2.990787e-01 1 1  ON 23
 eO_4                 5.158358e-01 1 1  ON 24
 eO_5                 4.707092e-01 1 1  ON 25
 eO_6                 2.402128e-01 1 1  ON 26
 eO_7                -5.223789e-02 1 1  ON 27
 eO_8                -2.096176e-01 1 1  ON 28
 eO_9                -6.901070e-02 1 1  ON 29
eH1_0                -2.437369e-01 1 1  ON 30
eH1_1                -1.394678e-01 1 1  ON 31
eH1_2                -9.594256e-02 1 1  ON 32
eH1_3                -4.437725e-02 1 1  ON 33
eH1_4                 1.196738e-02 1 1  ON 34
eH1_5                 4.952358e-02 1 1  ON 35
eH1_6                 1.066833e-01 1 1  ON 36
eH1_7                 1.535688e-01 1 1  ON 37
eH1_8                 1.627150e-01 1 1  ON 38
eH1_9                 4.473386e-02 1 1  ON 39
eH2_0                -2.423083e-01 1 1  ON 40
eH2_1                -1.375884e-01 1 1  ON 41
eH2_2                -9.416192e-02 1 1  ON 42
eH2_3                -4.241608e-02 1 1  ON 43
eH2_4                 1.393358e-02 1 1  ON 44
eH2_5                 5.197192e-02 1 1  ON 45
eH2_6                 1.100966e-01 1 1  ON 46
eH2_7                 1.565260e-01 1 1  ON 47
eH2_8                 1.699406e-01 1 1  ON 48
eH2_9                 3.135400e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9538
    reference variance = 0.272376
====================================================
  Execution time = 2.5242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2672e-01
  Total weights = 2.0000e+06
  Execution time = 2.9779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326755785900
                                         uncertainty =       0.004097962872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326755785900
                                         uncertainty =       0.004097962872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404163191
  error estimate for blocks of size 2^( 2) =       0.000415620090
  error estimate for blocks of size 2^( 3) =       0.000427986274
  error estimate for blocks of size 2^( 4) =       0.000440036346
  error estimate for blocks of size 2^( 5) =       0.000450044454
  error estimate for blocks of size 2^( 6) =       0.000458660010
  error estimate for blocks of size 2^( 7) =       0.000463453092

      target function =                  N/A
              le_mean =     -16.911065188407
             les_mean =     286.310821413334
             stat err =       0.000453048476
             autocorr =       1.256538589910
              std dev =       0.571573066318
             le_variance =       0.326695770140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326852474068
                                         uncertainty =       0.004097402688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326852474068
                                         uncertainty =       0.004097402688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404222953
  error estimate for blocks of size 2^( 2) =       0.000415675589
  error estimate for blocks of size 2^( 3) =       0.000428037168
  error estimate for blocks of size 2^( 4) =       0.000440082769
  error estimate for blocks of size 2^( 5) =       0.000450087582
  error estimate for blocks of size 2^( 6) =       0.000458701247
  error estimate for blocks of size 2^( 7) =       0.000463498670

      target function =                  N/A
              le_mean =     -16.911065549818
             les_mean =     286.310930258191
             stat err =       0.000453092567
             autocorr =       1.256411592058
              std dev =       0.571657582247
             le_variance =       0.326792391340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326810306013
                                         uncertainty =       0.004097645511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326810306013
                                         uncertainty =       0.004097645511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404196891
  error estimate for blocks of size 2^( 2) =       0.000415651377
  error estimate for blocks of size 2^( 3) =       0.000428015044
  error estimate for blocks of size 2^( 4) =       0.000440062684
  error estimate for blocks of size 2^( 5) =       0.000450068978
  error estimate for blocks of size 2^( 6) =       0.000458683459
  error estimate for blocks of size 2^( 7) =       0.000463479111

      target function =                  N/A
              le_mean =     -16.911065364367
             les_mean =     286.310881848401
             stat err =       0.000453073558
             autocorr =       1.256468181716
              std dev =       0.571620725567
             le_variance =       0.326750253897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326762762957
                                         uncertainty =       0.004097915195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326762762957
                                         uncertainty =       0.004097915195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404167504
  error estimate for blocks of size 2^( 2) =       0.000415624095
  error estimate for blocks of size 2^( 3) =       0.000427989969
  error estimate for blocks of size 2^( 4) =       0.000440039723
  error estimate for blocks of size 2^( 5) =       0.000450047616
  error estimate for blocks of size 2^( 6) =       0.000458663043
  error estimate for blocks of size 2^( 7) =       0.000463456471

      target function =                  N/A
              le_mean =     -16.911065210799
             les_mean =     286.310829143277
             stat err =       0.000453051713
             autocorr =       1.256529732220
              std dev =       0.571579165754
             le_variance =       0.326702742724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911065188407        initial
     1.5259e+00     1.5259e+01             2.5070e-04       -16.911065549818  <--
     6.1035e+00     6.1035e+01             6.8300e-05       -16.911065364367
     2.4414e+01     2.4414e+02             1.7685e-05       -16.911065210799

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 4.0178e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.078695e-01 1 1  ON 0
 uu_1                 1.432818e-01 1 1  ON 1
 uu_2                 4.637617e-02 1 1  ON 2
 uu_3                -1.574151e-02 1 1  ON 3
 uu_4                -6.406540e-02 1 1  ON 4
 uu_5                -9.928962e-02 1 1  ON 5
 uu_6                -1.257549e-01 1 1  ON 6
 uu_7                -1.377185e-01 1 1  ON 7
 uu_8                -1.294474e-01 1 1  ON 8
 uu_9                -9.990039e-02 1 1  ON 9
 ud_0                 4.326392e-01 1 1  ON 10
 ud_1                 1.757836e-01 1 1  ON 11
 ud_2                 6.195134e-02 1 1  ON 12
 ud_3                -6.616960e-03 1 1  ON 13
 ud_4                -6.121923e-02 1 1  ON 14
 ud_5                -1.024601e-01 1 1  ON 15
 ud_6                -1.305349e-01 1 1  ON 16
 ud_7                -1.486204e-01 1 1  ON 17
 ud_8                -1.518220e-01 1 1  ON 18
 ud_9                -1.408663e-01 1 1  ON 19
 eO_0                -7.470347e-01 1 1  ON 20
 eO_1                -4.323702e-01 1 1  ON 21
 eO_2                -1.699391e-02 1 1  ON 22
 eO_3                 2.991670e-01 1 1  ON 23
 eO_4                 5.159175e-01 1 1  ON 24
 eO_5                 4.707993e-01 1 1  ON 25
 eO_6                 2.402649e-01 1 1  ON 26
 eO_7                -5.222658e-02 1 1  ON 27
 eO_8                -2.097401e-01 1 1  ON 28
 eO_9                -6.909207e-02 1 1  ON 29
eH1_0                -2.438507e-01 1 1  ON 30
eH1_1                -1.395147e-01 1 1  ON 31
eH1_2                -9.602036e-02 1 1  ON 32
eH1_3                -4.438107e-02 1 1  ON 33
eH1_4                 1.191174e-02 1 1  ON 34
eH1_5                 4.953767e-02 1 1  ON 35
eH1_6                 1.067102e-01 1 1  ON 36
eH1_7                 1.535933e-01 1 1  ON 37
eH1_8                 1.628276e-01 1 1  ON 38
eH1_9                 4.483820e-02 1 1  ON 39
eH2_0                -2.424551e-01 1 1  ON 40
eH2_1                -1.376178e-01 1 1  ON 41
eH2_2                -9.418178e-02 1 1  ON 42
eH2_3                -4.246490e-02 1 1  ON 43
eH2_4                 1.394645e-02 1 1  ON 44
eH2_5                 5.200551e-02 1 1  ON 45
eH2_6                 1.101514e-01 1 1  ON 46
eH2_7                 1.565504e-01 1 1  ON 47
eH2_8                 1.699893e-01 1 1  ON 48
eH2_9                 3.143310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9705
    reference variance = 0.906491
====================================================
  Execution time = 2.5820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2551e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325541715008
                                         uncertainty =       0.002729385954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325541715008
                                         uncertainty =       0.002729385954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403432047
  error estimate for blocks of size 2^( 2) =       0.000415621660
  error estimate for blocks of size 2^( 3) =       0.000428092705
  error estimate for blocks of size 2^( 4) =       0.000441184846
  error estimate for blocks of size 2^( 5) =       0.000452137690
  error estimate for blocks of size 2^( 6) =       0.000460511061
  error estimate for blocks of size 2^( 7) =       0.000465346400

      target function =                  N/A
              le_mean =     -16.911097619662
             les_mean =     286.310737371608
             stat err =       0.000454794999
             autocorr =       1.270839117742
              std dev =       0.570539071962
             le_variance =       0.325514832636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691109761966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911097619662       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911097785095       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911098263109       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911099661917       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911099418470       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911100540080       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911100777092       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911100530894       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911100602359       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.958004e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911097619662       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911097678561       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911097781592       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911098275830       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911098254652       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911098313706       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911098445838       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911098425436       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.753940e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911097619662       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911097636133       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911097659008       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911097795581       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911097798447       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911097798989       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911097825397       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911097831420       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.410753e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048917 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2571e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.078803e-01 1 1  ON 0
 uu_1                 1.433023e-01 1 1  ON 1
 uu_2                 4.639949e-02 1 1  ON 2
 uu_3                -1.571420e-02 1 1  ON 3
 uu_4                -6.402996e-02 1 1  ON 4
 uu_5                -9.931311e-02 1 1  ON 5
 uu_6                -1.257702e-01 1 1  ON 6
 uu_7                -1.377773e-01 1 1  ON 7
 uu_8                -1.295279e-01 1 1  ON 8
 uu_9                -9.995767e-02 1 1  ON 9
 ud_0                 4.327558e-01 1 1  ON 10
 ud_1                 1.758576e-01 1 1  ON 11
 ud_2                 6.193348e-02 1 1  ON 12
 ud_3                -6.654100e-03 1 1  ON 13
 ud_4                -6.124113e-02 1 1  ON 14
 ud_5                -1.024643e-01 1 1  ON 15
 ud_6                -1.305850e-01 1 1  ON 16
 ud_7                -1.486703e-01 1 1  ON 17
 ud_8                -1.517760e-01 1 1  ON 18
 ud_9                -1.408857e-01 1 1  ON 19
 eO_0                -7.471710e-01 1 1  ON 20
 eO_1                -4.324249e-01 1 1  ON 21
 eO_2                -1.694477e-02 1 1  ON 22
 eO_3                 2.991905e-01 1 1  ON 23
 eO_4                 5.160743e-01 1 1  ON 24
 eO_5                 4.709098e-01 1 1  ON 25
 eO_6                 2.402602e-01 1 1  ON 26
 eO_7                -5.220710e-02 1 1  ON 27
 eO_8                -2.097958e-01 1 1  ON 28
 eO_9                -6.918553e-02 1 1  ON 29
eH1_0                -2.440029e-01 1 1  ON 30
eH1_1                -1.395402e-01 1 1  ON 31
eH1_2                -9.609799e-02 1 1  ON 32
eH1_3                -4.444298e-02 1 1  ON 33
eH1_4                 1.187222e-02 1 1  ON 34
eH1_5                 4.946232e-02 1 1  ON 35
eH1_6                 1.067374e-01 1 1  ON 36
eH1_7                 1.536540e-01 1 1  ON 37
eH1_8                 1.629824e-01 1 1  ON 38
eH1_9                 4.501359e-02 1 1  ON 39
eH2_0                -2.425492e-01 1 1  ON 40
eH2_1                -1.377174e-01 1 1  ON 41
eH2_2                -9.423057e-02 1 1  ON 42
eH2_3                -4.255481e-02 1 1  ON 43
eH2_4                 1.384836e-02 1 1  ON 44
eH2_5                 5.199657e-02 1 1  ON 45
eH2_6                 1.102365e-01 1 1  ON 46
eH2_7                 1.566170e-01 1 1  ON 47
eH2_8                 1.701326e-01 1 1  ON 48
eH2_9                 3.159208e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9282
    reference variance = 0.174087
====================================================
  Execution time = 2.4942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2504e-01
  Total weights = 2.0000e+06
  Execution time = 2.9857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361734394
                                         uncertainty =       0.003100112068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361734394
                                         uncertainty =       0.003100112068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403084691
  error estimate for blocks of size 2^( 2) =       0.000415025511
  error estimate for blocks of size 2^( 3) =       0.000427491319
  error estimate for blocks of size 2^( 4) =       0.000439425234
  error estimate for blocks of size 2^( 5) =       0.000449381893
  error estimate for blocks of size 2^( 6) =       0.000455774587
  error estimate for blocks of size 2^( 7) =       0.000463428270

      target function =                  N/A
              le_mean =     -16.911168558939
             les_mean =     286.312576402467
             stat err =       0.000452002496
             autocorr =       1.257445172528
              std dev =       0.570047836675
             le_variance =       0.324954536098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324600541940
                                         uncertainty =       0.003101246419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324600541940
                                         uncertainty =       0.003101246419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403233204
  error estimate for blocks of size 2^( 2) =       0.000415166152
  error estimate for blocks of size 2^( 3) =       0.000427620306
  error estimate for blocks of size 2^( 4) =       0.000439544816
  error estimate for blocks of size 2^( 5) =       0.000449498326
  error estimate for blocks of size 2^( 6) =       0.000455883903
  error estimate for blocks of size 2^( 7) =       0.000463534261

      target function =                  N/A
              le_mean =     -16.911166497978
             les_mean =     286.312746193145
             stat err =       0.000452115327
             autocorr =       1.257146488283
              std dev =       0.570257865701
             le_variance =       0.325194033394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324529829412
                                         uncertainty =       0.003100914006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324529829412
                                         uncertainty =       0.003100914006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403189232
  error estimate for blocks of size 2^( 2) =       0.000415124391
  error estimate for blocks of size 2^( 3) =       0.000427582008
  error estimate for blocks of size 2^( 4) =       0.000439509765
  error estimate for blocks of size 2^( 5) =       0.000449464873
  error estimate for blocks of size 2^( 6) =       0.000455853085
  error estimate for blocks of size 2^( 7) =       0.000463504554

      target function =                  N/A
              le_mean =     -16.911166947826
             les_mean =     286.312690488908
             stat err =       0.000452083069
             autocorr =       1.257241289226
              std dev =       0.570195680635
             le_variance =       0.325123114215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385082002
                                         uncertainty =       0.003100218782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385082002
                                         uncertainty =       0.003100218782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403099211
  error estimate for blocks of size 2^( 2) =       0.000415039212
  error estimate for blocks of size 2^( 3) =       0.000427503845
  error estimate for blocks of size 2^( 4) =       0.000439436912
  error estimate for blocks of size 2^( 5) =       0.000449393389
  error estimate for blocks of size 2^( 6) =       0.000455785460
  error estimate for blocks of size 2^( 7) =       0.000463438902

      target function =                  N/A
              le_mean =     -16.911168293156
             les_mean =     286.312590824667
             stat err =       0.000452013666
             autocorr =       1.257416728711
              std dev =       0.570068371082
             le_variance =       0.324977947708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911168558939        initial  <--
     3.8147e-01     3.8147e+00             6.9580e-04       -16.911166497978
     1.5259e+00     1.5259e+01             1.7539e-04       -16.911166947826
     6.1035e+00     6.1035e+01             4.4108e-05       -16.911168293156

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9395
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.078695e-01 1 1  ON 0
 uu_1                 1.432818e-01 1 1  ON 1
 uu_2                 4.637617e-02 1 1  ON 2
 uu_3                -1.574151e-02 1 1  ON 3
 uu_4                -6.406540e-02 1 1  ON 4
 uu_5                -9.928962e-02 1 1  ON 5
 uu_6                -1.257549e-01 1 1  ON 6
 uu_7                -1.377185e-01 1 1  ON 7
 uu_8                -1.294474e-01 1 1  ON 8
 uu_9                -9.990039e-02 1 1  ON 9
 ud_0                 4.326392e-01 1 1  ON 10
 ud_1                 1.757836e-01 1 1  ON 11
 ud_2                 6.195134e-02 1 1  ON 12
 ud_3                -6.616960e-03 1 1  ON 13
 ud_4                -6.121923e-02 1 1  ON 14
 ud_5                -1.024601e-01 1 1  ON 15
 ud_6                -1.305349e-01 1 1  ON 16
 ud_7                -1.486204e-01 1 1  ON 17
 ud_8                -1.518220e-01 1 1  ON 18
 ud_9                -1.408663e-01 1 1  ON 19
 eO_0                -7.470347e-01 1 1  ON 20
 eO_1                -4.323702e-01 1 1  ON 21
 eO_2                -1.699391e-02 1 1  ON 22
 eO_3                 2.991670e-01 1 1  ON 23
 eO_4                 5.159175e-01 1 1  ON 24
 eO_5                 4.707993e-01 1 1  ON 25
 eO_6                 2.402649e-01 1 1  ON 26
 eO_7                -5.222658e-02 1 1  ON 27
 eO_8                -2.097401e-01 1 1  ON 28
 eO_9                -6.909207e-02 1 1  ON 29
eH1_0                -2.438507e-01 1 1  ON 30
eH1_1                -1.395147e-01 1 1  ON 31
eH1_2                -9.602036e-02 1 1  ON 32
eH1_3                -4.438107e-02 1 1  ON 33
eH1_4                 1.191174e-02 1 1  ON 34
eH1_5                 4.953767e-02 1 1  ON 35
eH1_6                 1.067102e-01 1 1  ON 36
eH1_7                 1.535933e-01 1 1  ON 37
eH1_8                 1.628276e-01 1 1  ON 38
eH1_9                 4.483820e-02 1 1  ON 39
eH2_0                -2.424551e-01 1 1  ON 40
eH2_1                -1.376178e-01 1 1  ON 41
eH2_2                -9.418178e-02 1 1  ON 42
eH2_3                -4.246490e-02 1 1  ON 43
eH2_4                 1.394645e-02 1 1  ON 44
eH2_5                 5.200551e-02 1 1  ON 45
eH2_6                 1.101514e-01 1 1  ON 46
eH2_7                 1.565504e-01 1 1  ON 47
eH2_8                 1.699893e-01 1 1  ON 48
eH2_9                 3.143310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8079
    reference variance = 0.39819
====================================================
  Execution time = 2.7731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4042e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390024344
                                         uncertainty =       0.007729117900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340390024344
                                         uncertainty =       0.007729117900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412564507
  error estimate for blocks of size 2^( 2) =       0.000424182366
  error estimate for blocks of size 2^( 3) =       0.000436082550
  error estimate for blocks of size 2^( 4) =       0.000447146542
  error estimate for blocks of size 2^( 5) =       0.000457864548
  error estimate for blocks of size 2^( 6) =       0.000467806551
  error estimate for blocks of size 2^( 7) =       0.000471941206

      target function =                  N/A
              le_mean =     -16.911697309350
             les_mean =     286.345924658022
             stat err =       0.000461189712
             autocorr =       1.249612885955
              std dev =       0.583454321395
             le_variance =       0.340418945155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691169730935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911697309350       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911697391626       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911697382329       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911697366546       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911697410924       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911697441932       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911697472023       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911697469438       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 6.904320e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911697309350       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911697330901       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911697329024       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911697325444       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911697337151       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911697345160       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911697351843       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911697351470       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.737080e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911697309350       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911697314803       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911697314366       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911697313499       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911697316467       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911697318496       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911697320100       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911697320036       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.349676e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4416e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.078682e-01 1 1  ON 0
 uu_1                 1.432840e-01 1 1  ON 1
 uu_2                 4.637570e-02 1 1  ON 2
 uu_3                -1.573731e-02 1 1  ON 3
 uu_4                -6.406664e-02 1 1  ON 4
 uu_5                -9.928262e-02 1 1  ON 5
 uu_6                -1.257543e-01 1 1  ON 6
 uu_7                -1.377275e-01 1 1  ON 7
 uu_8                -1.294618e-01 1 1  ON 8
 uu_9                -9.990406e-02 1 1  ON 9
 ud_0                 4.326535e-01 1 1  ON 10
 ud_1                 1.757816e-01 1 1  ON 11
 ud_2                 6.196053e-02 1 1  ON 12
 ud_3                -6.621113e-03 1 1  ON 13
 ud_4                -6.122675e-02 1 1  ON 14
 ud_5                -1.024611e-01 1 1  ON 15
 ud_6                -1.305406e-01 1 1  ON 16
 ud_7                -1.486213e-01 1 1  ON 17
 ud_8                -1.518221e-01 1 1  ON 18
 ud_9                -1.408712e-01 1 1  ON 19
 eO_0                -7.470458e-01 1 1  ON 20
 eO_1                -4.323770e-01 1 1  ON 21
 eO_2                -1.699476e-02 1 1  ON 22
 eO_3                 2.991756e-01 1 1  ON 23
 eO_4                 5.159303e-01 1 1  ON 24
 eO_5                 4.708058e-01 1 1  ON 25
 eO_6                 2.402731e-01 1 1  ON 26
 eO_7                -5.222546e-02 1 1  ON 27
 eO_8                -2.097506e-01 1 1  ON 28
 eO_9                -6.910018e-02 1 1  ON 29
eH1_0                -2.438681e-01 1 1  ON 30
eH1_1                -1.395246e-01 1 1  ON 31
eH1_2                -9.602821e-02 1 1  ON 32
eH1_3                -4.438834e-02 1 1  ON 33
eH1_4                 1.191293e-02 1 1  ON 34
eH1_5                 4.953986e-02 1 1  ON 35
eH1_6                 1.067145e-01 1 1  ON 36
eH1_7                 1.535996e-01 1 1  ON 37
eH1_8                 1.628423e-01 1 1  ON 38
eH1_9                 4.485071e-02 1 1  ON 39
eH2_0                -2.424662e-01 1 1  ON 40
eH2_1                -1.376199e-01 1 1  ON 41
eH2_2                -9.418637e-02 1 1  ON 42
eH2_3                -4.247615e-02 1 1  ON 43
eH2_4                 1.394160e-02 1 1  ON 44
eH2_5                 5.200787e-02 1 1  ON 45
eH2_6                 1.101547e-01 1 1  ON 46
eH2_7                 1.565528e-01 1 1  ON 47
eH2_8                 1.699994e-01 1 1  ON 48
eH2_9                 3.144668e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9174
    reference variance = 0.143456
====================================================
  Execution time = 2.5415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3595e-01
  Total weights = 2.0000e+06
  Execution time = 2.9618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335749386472
                                         uncertainty =       0.006685254349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335749386472
                                         uncertainty =       0.006685254349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409844473
  error estimate for blocks of size 2^( 2) =       0.000421176950
  error estimate for blocks of size 2^( 3) =       0.000433266771
  error estimate for blocks of size 2^( 4) =       0.000444992615
  error estimate for blocks of size 2^( 5) =       0.000453944123
  error estimate for blocks of size 2^( 6) =       0.000461696777
  error estimate for blocks of size 2^( 7) =       0.000463699211

      target function =                  N/A
              le_mean =     -16.911290299779
             les_mean =     286.327684418961
             stat err =       0.000456083182
             autocorr =       1.238368653570
              std dev =       0.579607611708
             le_variance =       0.335944983549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335772303204
                                         uncertainty =       0.006685285095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335772303204
                                         uncertainty =       0.006685285095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409858459
  error estimate for blocks of size 2^( 2) =       0.000421190680
  error estimate for blocks of size 2^( 3) =       0.000433280052
  error estimate for blocks of size 2^( 4) =       0.000445005356
  error estimate for blocks of size 2^( 5) =       0.000453956243
  error estimate for blocks of size 2^( 6) =       0.000461709029
  error estimate for blocks of size 2^( 7) =       0.000463711810

      target function =                  N/A
              le_mean =     -16.911290519126
             les_mean =     286.327714766878
             stat err =       0.000456095609
             autocorr =       1.238351622955
              std dev =       0.579627391168
             le_variance =       0.335967912592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335761602840
                                         uncertainty =       0.006685271166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335761602840
                                         uncertainty =       0.006685271166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409851927
  error estimate for blocks of size 2^( 2) =       0.000421184280
  error estimate for blocks of size 2^( 3) =       0.000433273881
  error estimate for blocks of size 2^( 4) =       0.000444999465
  error estimate for blocks of size 2^( 5) =       0.000453950653
  error estimate for blocks of size 2^( 6) =       0.000461703384
  error estimate for blocks of size 2^( 7) =       0.000463705997

      target function =                  N/A
              le_mean =     -16.911290421684
             les_mean =     286.327700762712
             stat err =       0.000456089875
             autocorr =       1.238359952239
              std dev =       0.579618153745
             le_variance =       0.335957204151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335750938454
                                         uncertainty =       0.006685256513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335750938454
                                         uncertainty =       0.006685256513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409845420
  error estimate for blocks of size 2^( 2) =       0.000421177882
  error estimate for blocks of size 2^( 3) =       0.000433267675
  error estimate for blocks of size 2^( 4) =       0.000444993487
  error estimate for blocks of size 2^( 5) =       0.000453944954
  error estimate for blocks of size 2^( 6) =       0.000461697619
  error estimate for blocks of size 2^( 7) =       0.000463700075

      target function =                  N/A
              le_mean =     -16.911290315250
             les_mean =     286.327686494696
             stat err =       0.000456084034
             autocorr =       1.238367559886
              std dev =       0.579608950927
             le_variance =       0.335946535994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911290299779        initial
     3.8147e+00     3.8147e+01             6.9043e-05       -16.911290519126  <--
     1.5259e+01     1.5259e+02             1.7371e-05       -16.911290421684
     6.1035e+01     6.1035e+02             4.3497e-06       -16.911290315250

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.0311e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.078645e-01 1 1  ON 0
 uu_1                 1.432903e-01 1 1  ON 1
 uu_2                 4.637514e-02 1 1  ON 2
 uu_3                -1.572561e-02 1 1  ON 3
 uu_4                -6.406941e-02 1 1  ON 4
 uu_5                -9.926323e-02 1 1  ON 5
 uu_6                -1.257523e-01 1 1  ON 6
 uu_7                -1.377538e-01 1 1  ON 7
 uu_8                -1.295050e-01 1 1  ON 8
 uu_9                -9.991512e-02 1 1  ON 9
 ud_0                 4.326931e-01 1 1  ON 10
 ud_1                 1.757789e-01 1 1  ON 11
 ud_2                 6.198507e-02 1 1  ON 12
 ud_3                -6.632063e-03 1 1  ON 13
 ud_4                -6.124814e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305572e-01 1 1  ON 16
 ud_7                -1.486240e-01 1 1  ON 17
 ud_8                -1.518226e-01 1 1  ON 18
 ud_9                -1.408857e-01 1 1  ON 19
 eO_0                -7.470795e-01 1 1  ON 20
 eO_1                -4.323973e-01 1 1  ON 21
 eO_2                -1.699653e-02 1 1  ON 22
 eO_3                 2.992008e-01 1 1  ON 23
 eO_4                 5.159685e-01 1 1  ON 24
 eO_5                 4.708255e-01 1 1  ON 25
 eO_6                 2.402976e-01 1 1  ON 26
 eO_7                -5.222211e-02 1 1  ON 27
 eO_8                -2.097818e-01 1 1  ON 28
 eO_9                -6.912443e-02 1 1  ON 29
eH1_0                -2.439197e-01 1 1  ON 30
eH1_1                -1.395543e-01 1 1  ON 31
eH1_2                -9.605195e-02 1 1  ON 32
eH1_3                -4.440943e-02 1 1  ON 33
eH1_4                 1.191593e-02 1 1  ON 34
eH1_5                 4.954645e-02 1 1  ON 35
eH1_6                 1.067275e-01 1 1  ON 36
eH1_7                 1.536186e-01 1 1  ON 37
eH1_8                 1.628864e-01 1 1  ON 38
eH1_9                 4.488808e-02 1 1  ON 39
eH2_0                -2.424991e-01 1 1  ON 40
eH2_1                -1.376273e-01 1 1  ON 41
eH2_2                -9.420077e-02 1 1  ON 42
eH2_3                -4.250864e-02 1 1  ON 43
eH2_4                 1.392677e-02 1 1  ON 44
eH2_5                 5.201496e-02 1 1  ON 45
eH2_6                 1.101649e-01 1 1  ON 46
eH2_7                 1.565601e-01 1 1  ON 47
eH2_8                 1.700298e-01 1 1  ON 48
eH2_9                 3.148721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4736e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9296
    reference variance = 0.18107
====================================================
  Execution time = 2.5617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334408279253
                                         uncertainty =       0.005239261961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334408279253
                                         uncertainty =       0.005239261961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408916790
  error estimate for blocks of size 2^( 2) =       0.000420804475
  error estimate for blocks of size 2^( 3) =       0.000432855402
  error estimate for blocks of size 2^( 4) =       0.000443490963
  error estimate for blocks of size 2^( 5) =       0.000453978393
  error estimate for blocks of size 2^( 6) =       0.000461343953
  error estimate for blocks of size 2^( 7) =       0.000465200141

      target function =                  N/A
              le_mean =     -16.911251215969
             les_mean =     286.324843405027
             stat err =       0.000456003362
             autocorr =       1.243558452227
              std dev =       0.578295670592
             le_variance =       0.334425882625


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691125121597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911251215969       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911252044357       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911252287035       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911252192467       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911252406739       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911252704772       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911252934543       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911252839790       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911252815442       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.239528e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911251215969       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911251456014       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911251529600       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911251505491       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911251565617       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911251610091       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911251674360       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911251677666       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.689754e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911251215969       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911251278466       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911251298224       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911251292232       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911251307718       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911251317341       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911251332146       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911251335037       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.424662e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2238e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.078766e-01 1 1  ON 0
 uu_1                 1.433062e-01 1 1  ON 1
 uu_2                 4.639297e-02 1 1  ON 2
 uu_3                -1.570281e-02 1 1  ON 3
 uu_4                -6.405438e-02 1 1  ON 4
 uu_5                -9.926608e-02 1 1  ON 5
 uu_6                -1.257557e-01 1 1  ON 6
 uu_7                -1.377966e-01 1 1  ON 7
 uu_8                -1.295619e-01 1 1  ON 8
 uu_9                -9.994536e-02 1 1  ON 9
 ud_0                 4.326903e-01 1 1  ON 10
 ud_1                 1.758055e-01 1 1  ON 11
 ud_2                 6.201995e-02 1 1  ON 12
 ud_3                -6.638296e-03 1 1  ON 13
 ud_4                -6.125756e-02 1 1  ON 14
 ud_5                -1.024643e-01 1 1  ON 15
 ud_6                -1.305491e-01 1 1  ON 16
 ud_7                -1.486341e-01 1 1  ON 17
 ud_8                -1.518283e-01 1 1  ON 18
 ud_9                -1.409098e-01 1 1  ON 19
 eO_0                -7.471227e-01 1 1  ON 20
 eO_1                -4.324157e-01 1 1  ON 21
 eO_2                -1.701763e-02 1 1  ON 22
 eO_3                 2.992543e-01 1 1  ON 23
 eO_4                 5.160056e-01 1 1  ON 24
 eO_5                 4.708646e-01 1 1  ON 25
 eO_6                 2.403457e-01 1 1  ON 26
 eO_7                -5.221573e-02 1 1  ON 27
 eO_8                -2.098367e-01 1 1  ON 28
 eO_9                -6.916457e-02 1 1  ON 29
eH1_0                -2.439650e-01 1 1  ON 30
eH1_1                -1.395783e-01 1 1  ON 31
eH1_2                -9.608887e-02 1 1  ON 32
eH1_3                -4.443346e-02 1 1  ON 33
eH1_4                 1.189203e-02 1 1  ON 34
eH1_5                 4.953856e-02 1 1  ON 35
eH1_6                 1.067527e-01 1 1  ON 36
eH1_7                 1.536590e-01 1 1  ON 37
eH1_8                 1.629388e-01 1 1  ON 38
eH1_9                 4.493139e-02 1 1  ON 39
eH2_0                -2.425482e-01 1 1  ON 40
eH2_1                -1.376602e-01 1 1  ON 41
eH2_2                -9.423751e-02 1 1  ON 42
eH2_3                -4.254462e-02 1 1  ON 43
eH2_4                 1.388556e-02 1 1  ON 44
eH2_5                 5.204096e-02 1 1  ON 45
eH2_6                 1.101977e-01 1 1  ON 46
eH2_7                 1.565994e-01 1 1  ON 47
eH2_8                 1.700724e-01 1 1  ON 48
eH2_9                 3.153670e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.18832
====================================================
  Execution time = 2.5217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4581e-01
  Total weights = 2.0000e+06
  Execution time = 2.9636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345917288939
                                         uncertainty =       0.020359310835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345917288939
                                         uncertainty =       0.020359310835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415837575
  error estimate for blocks of size 2^( 2) =       0.000427505206
  error estimate for blocks of size 2^( 3) =       0.000439230259
  error estimate for blocks of size 2^( 4) =       0.000450359821
  error estimate for blocks of size 2^( 5) =       0.000460256261
  error estimate for blocks of size 2^( 6) =       0.000467408929
  error estimate for blocks of size 2^( 7) =       0.000473855474

      target function =                  N/A
              le_mean =     -16.911227795564
             les_mean =     286.335467158910
             stat err =       0.000462970121
             autocorr =       1.239534067546
              std dev =       0.588083138993
             le_variance =       0.345841778367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345846127327
                                         uncertainty =       0.020346762057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345846127327
                                         uncertainty =       0.020346762057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415794842
  error estimate for blocks of size 2^( 2) =       0.000427464719
  error estimate for blocks of size 2^( 3) =       0.000439190460
  error estimate for blocks of size 2^( 4) =       0.000450320582
  error estimate for blocks of size 2^( 5) =       0.000460216873
  error estimate for blocks of size 2^( 6) =       0.000467371281
  error estimate for blocks of size 2^( 7) =       0.000473821261

      target function =                  N/A
              le_mean =     -16.911226771308
             les_mean =     286.335361439128
             stat err =       0.000462932499
             autocorr =       1.239587380198
              std dev =       0.588022704843
             le_variance =       0.345770701410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345859691820
                                         uncertainty =       0.020350462298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345859691820
                                         uncertainty =       0.020350462298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415802982
  error estimate for blocks of size 2^( 2) =       0.000427472414
  error estimate for blocks of size 2^( 3) =       0.000439198380
  error estimate for blocks of size 2^( 4) =       0.000450328910
  error estimate for blocks of size 2^( 5) =       0.000460225520
  error estimate for blocks of size 2^( 6) =       0.000467379470
  error estimate for blocks of size 2^( 7) =       0.000473828036

      target function =                  N/A
              le_mean =     -16.911227157648
             les_mean =     286.335388045089
             stat err =       0.000462940484
             autocorr =       1.239581603990
              std dev =       0.588034217041
             le_variance =       0.345784240411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345909192305
                                         uncertainty =       0.020358096799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345909192305
                                         uncertainty =       0.020358096799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415832713
  error estimate for blocks of size 2^( 2) =       0.000427500595
  error estimate for blocks of size 2^( 3) =       0.000439225783
  error estimate for blocks of size 2^( 4) =       0.000450355492
  error estimate for blocks of size 2^( 5) =       0.000460251963
  error estimate for blocks of size 2^( 6) =       0.000467404804
  error estimate for blocks of size 2^( 7) =       0.000473851624

      target function =                  N/A
              le_mean =     -16.911227708354
             les_mean =     286.335456120657
             stat err =       0.000462965971
             autocorr =       1.239540832749
              std dev =       0.588076261881
             le_variance =       0.345833689788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911227795564        initial  <--
     9.5367e-01     9.5367e+00             2.2395e-04       -16.911226771308
     3.8147e+00     3.8147e+01             5.6898e-05       -16.911227157648
     1.5259e+01     1.5259e+02             1.4247e-05       -16.911227708354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1233
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.078645e-01 1 1  ON 0
 uu_1                 1.432903e-01 1 1  ON 1
 uu_2                 4.637514e-02 1 1  ON 2
 uu_3                -1.572561e-02 1 1  ON 3
 uu_4                -6.406941e-02 1 1  ON 4
 uu_5                -9.926323e-02 1 1  ON 5
 uu_6                -1.257523e-01 1 1  ON 6
 uu_7                -1.377538e-01 1 1  ON 7
 uu_8                -1.295050e-01 1 1  ON 8
 uu_9                -9.991512e-02 1 1  ON 9
 ud_0                 4.326931e-01 1 1  ON 10
 ud_1                 1.757789e-01 1 1  ON 11
 ud_2                 6.198507e-02 1 1  ON 12
 ud_3                -6.632063e-03 1 1  ON 13
 ud_4                -6.124814e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305572e-01 1 1  ON 16
 ud_7                -1.486240e-01 1 1  ON 17
 ud_8                -1.518226e-01 1 1  ON 18
 ud_9                -1.408857e-01 1 1  ON 19
 eO_0                -7.470795e-01 1 1  ON 20
 eO_1                -4.323973e-01 1 1  ON 21
 eO_2                -1.699653e-02 1 1  ON 22
 eO_3                 2.992008e-01 1 1  ON 23
 eO_4                 5.159685e-01 1 1  ON 24
 eO_5                 4.708255e-01 1 1  ON 25
 eO_6                 2.402976e-01 1 1  ON 26
 eO_7                -5.222211e-02 1 1  ON 27
 eO_8                -2.097818e-01 1 1  ON 28
 eO_9                -6.912443e-02 1 1  ON 29
eH1_0                -2.439197e-01 1 1  ON 30
eH1_1                -1.395543e-01 1 1  ON 31
eH1_2                -9.605195e-02 1 1  ON 32
eH1_3                -4.440943e-02 1 1  ON 33
eH1_4                 1.191593e-02 1 1  ON 34
eH1_5                 4.954645e-02 1 1  ON 35
eH1_6                 1.067275e-01 1 1  ON 36
eH1_7                 1.536186e-01 1 1  ON 37
eH1_8                 1.628864e-01 1 1  ON 38
eH1_9                 4.488808e-02 1 1  ON 39
eH2_0                -2.424991e-01 1 1  ON 40
eH2_1                -1.376273e-01 1 1  ON 41
eH2_2                -9.420077e-02 1 1  ON 42
eH2_3                -4.250864e-02 1 1  ON 43
eH2_4                 1.392677e-02 1 1  ON 44
eH2_5                 5.201496e-02 1 1  ON 45
eH2_6                 1.101649e-01 1 1  ON 46
eH2_7                 1.565601e-01 1 1  ON 47
eH2_8                 1.700298e-01 1 1  ON 48
eH2_9                 3.148721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.235399
====================================================
  Execution time = 2.5882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2688e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326883653291
                                         uncertainty =       0.003472992481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326883653291
                                         uncertainty =       0.003472992481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404276192
  error estimate for blocks of size 2^( 2) =       0.000415859492
  error estimate for blocks of size 2^( 3) =       0.000428931796
  error estimate for blocks of size 2^( 4) =       0.000440442894
  error estimate for blocks of size 2^( 5) =       0.000450577233
  error estimate for blocks of size 2^( 6) =       0.000458607021
  error estimate for blocks of size 2^( 7) =       0.000465276708

      target function =                  N/A
              le_mean =     -16.910872574503
             les_mean =     286.304489546737
             stat err =       0.000453725964
             autocorr =       1.259595008376
              std dev =       0.571732873903
             le_variance =       0.326878479102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691087257450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910872574503       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910872621686       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910872780329       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910872790713       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910872763351       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910872727241       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910872714432       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910872717575       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.546769e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910872574503       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910872586479       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910872627038       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910872630358       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910872623654       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910872614488       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910872610722       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910872611315       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.463220e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910872574503       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910872577508       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910872587706       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910872588582       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910872586918       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910872584619       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910872583641       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910872583777       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.621922e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2563e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.078621e-01 1 1  ON 0
 uu_1                 1.432934e-01 1 1  ON 1
 uu_2                 4.637586e-02 1 1  ON 2
 uu_3                -1.572483e-02 1 1  ON 3
 uu_4                -6.406927e-02 1 1  ON 4
 uu_5                -9.926480e-02 1 1  ON 5
 uu_6                -1.257508e-01 1 1  ON 6
 uu_7                -1.377566e-01 1 1  ON 7
 uu_8                -1.295099e-01 1 1  ON 8
 uu_9                -9.991610e-02 1 1  ON 9
 ud_0                 4.326996e-01 1 1  ON 10
 ud_1                 1.757816e-01 1 1  ON 11
 ud_2                 6.198459e-02 1 1  ON 12
 ud_3                -6.632438e-03 1 1  ON 13
 ud_4                -6.125094e-02 1 1  ON 14
 ud_5                -1.024654e-01 1 1  ON 15
 ud_6                -1.305570e-01 1 1  ON 16
 ud_7                -1.486276e-01 1 1  ON 17
 ud_8                -1.518222e-01 1 1  ON 18
 ud_9                -1.408855e-01 1 1  ON 19
 eO_0                -7.470849e-01 1 1  ON 20
 eO_1                -4.324014e-01 1 1  ON 21
 eO_2                -1.699530e-02 1 1  ON 22
 eO_3                 2.992062e-01 1 1  ON 23
 eO_4                 5.159718e-01 1 1  ON 24
 eO_5                 4.708289e-01 1 1  ON 25
 eO_6                 2.403010e-01 1 1  ON 26
 eO_7                -5.222189e-02 1 1  ON 27
 eO_8                -2.097853e-01 1 1  ON 28
 eO_9                -6.912778e-02 1 1  ON 29
eH1_0                -2.439248e-01 1 1  ON 30
eH1_1                -1.395587e-01 1 1  ON 31
eH1_2                -9.605540e-02 1 1  ON 32
eH1_3                -4.441237e-02 1 1  ON 33
eH1_4                 1.191616e-02 1 1  ON 34
eH1_5                 4.954428e-02 1 1  ON 35
eH1_6                 1.067294e-01 1 1  ON 36
eH1_7                 1.536227e-01 1 1  ON 37
eH1_8                 1.628926e-01 1 1  ON 38
eH1_9                 4.489350e-02 1 1  ON 39
eH2_0                -2.425025e-01 1 1  ON 40
eH2_1                -1.376316e-01 1 1  ON 41
eH2_2                -9.420360e-02 1 1  ON 42
eH2_3                -4.251134e-02 1 1  ON 43
eH2_4                 1.392427e-02 1 1  ON 44
eH2_5                 5.201522e-02 1 1  ON 45
eH2_6                 1.101661e-01 1 1  ON 46
eH2_7                 1.565633e-01 1 1  ON 47
eH2_8                 1.700346e-01 1 1  ON 48
eH2_9                 3.149303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9571
    reference variance = 0.492511
====================================================
  Execution time = 2.4899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3418e-01
  Total weights = 2.0000e+06
  Execution time = 2.9563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334215762386
                                         uncertainty =       0.004242399798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334215762386
                                         uncertainty =       0.004242399798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408766692
  error estimate for blocks of size 2^( 2) =       0.000420735601
  error estimate for blocks of size 2^( 3) =       0.000433422863
  error estimate for blocks of size 2^( 4) =       0.000445512393
  error estimate for blocks of size 2^( 5) =       0.000455834561
  error estimate for blocks of size 2^( 6) =       0.000464326024
  error estimate for blocks of size 2^( 7) =       0.000470790942

      target function =                  N/A
              le_mean =     -16.911275588218
             les_mean =     286.325422271149
             stat err =       0.000459115980
             autocorr =       1.261519057925
              std dev =       0.578083400193
             le_variance =       0.334180417578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334232637589
                                         uncertainty =       0.004242525066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334232637589
                                         uncertainty =       0.004242525066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408777017
  error estimate for blocks of size 2^( 2) =       0.000420745393
  error estimate for blocks of size 2^( 3) =       0.000433431944
  error estimate for blocks of size 2^( 4) =       0.000445520876
  error estimate for blocks of size 2^( 5) =       0.000455842601
  error estimate for blocks of size 2^( 6) =       0.000464333935
  error estimate for blocks of size 2^( 7) =       0.000470798519

      target function =                  N/A
              le_mean =     -16.911275555191
             les_mean =     286.325438035393
             stat err =       0.000459123983
             autocorr =       1.261499314028
              std dev =       0.578098001111
             le_variance =       0.334197298888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224386688
                                         uncertainty =       0.004242463500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334224386688
                                         uncertainty =       0.004242463500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408771969
  error estimate for blocks of size 2^( 2) =       0.000420740603
  error estimate for blocks of size 2^( 3) =       0.000433427502
  error estimate for blocks of size 2^( 4) =       0.000445516727
  error estimate for blocks of size 2^( 5) =       0.000455838668
  error estimate for blocks of size 2^( 6) =       0.000464330066
  error estimate for blocks of size 2^( 7) =       0.000470794814

      target function =                  N/A
              le_mean =     -16.911275569802
             les_mean =     286.325430275677
             stat err =       0.000459120069
             autocorr =       1.261508960474
              std dev =       0.578090862228
             le_variance =       0.334189044992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334216846266
                                         uncertainty =       0.004242407794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334216846266
                                         uncertainty =       0.004242407794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408767356
  error estimate for blocks of size 2^( 2) =       0.000420736230
  error estimate for blocks of size 2^( 3) =       0.000433423446
  error estimate for blocks of size 2^( 4) =       0.000445512937
  error estimate for blocks of size 2^( 5) =       0.000455835077
  error estimate for blocks of size 2^( 6) =       0.000464326532
  error estimate for blocks of size 2^( 7) =       0.000470791428

      target function =                  N/A
              le_mean =     -16.911275585831
             les_mean =     286.325423274676
             stat err =       0.000459116493
             autocorr =       1.261517788451
              std dev =       0.578084338007
             le_variance =       0.334181501849


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911275588218        initial  <--
     9.5367e+00     9.5367e+01             2.5468e-05       -16.911275555191
     3.8147e+01     3.8147e+02             6.4632e-06       -16.911275569802
     1.5259e+02     1.5259e+03             1.6219e-06       -16.911275585831

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7450
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.078645e-01 1 1  ON 0
 uu_1                 1.432903e-01 1 1  ON 1
 uu_2                 4.637514e-02 1 1  ON 2
 uu_3                -1.572561e-02 1 1  ON 3
 uu_4                -6.406941e-02 1 1  ON 4
 uu_5                -9.926323e-02 1 1  ON 5
 uu_6                -1.257523e-01 1 1  ON 6
 uu_7                -1.377538e-01 1 1  ON 7
 uu_8                -1.295050e-01 1 1  ON 8
 uu_9                -9.991512e-02 1 1  ON 9
 ud_0                 4.326931e-01 1 1  ON 10
 ud_1                 1.757789e-01 1 1  ON 11
 ud_2                 6.198507e-02 1 1  ON 12
 ud_3                -6.632063e-03 1 1  ON 13
 ud_4                -6.124814e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305572e-01 1 1  ON 16
 ud_7                -1.486240e-01 1 1  ON 17
 ud_8                -1.518226e-01 1 1  ON 18
 ud_9                -1.408857e-01 1 1  ON 19
 eO_0                -7.470795e-01 1 1  ON 20
 eO_1                -4.323973e-01 1 1  ON 21
 eO_2                -1.699653e-02 1 1  ON 22
 eO_3                 2.992008e-01 1 1  ON 23
 eO_4                 5.159685e-01 1 1  ON 24
 eO_5                 4.708255e-01 1 1  ON 25
 eO_6                 2.402976e-01 1 1  ON 26
 eO_7                -5.222211e-02 1 1  ON 27
 eO_8                -2.097818e-01 1 1  ON 28
 eO_9                -6.912443e-02 1 1  ON 29
eH1_0                -2.439197e-01 1 1  ON 30
eH1_1                -1.395543e-01 1 1  ON 31
eH1_2                -9.605195e-02 1 1  ON 32
eH1_3                -4.440943e-02 1 1  ON 33
eH1_4                 1.191593e-02 1 1  ON 34
eH1_5                 4.954645e-02 1 1  ON 35
eH1_6                 1.067275e-01 1 1  ON 36
eH1_7                 1.536186e-01 1 1  ON 37
eH1_8                 1.628864e-01 1 1  ON 38
eH1_9                 4.488808e-02 1 1  ON 39
eH2_0                -2.424991e-01 1 1  ON 40
eH2_1                -1.376273e-01 1 1  ON 41
eH2_2                -9.420077e-02 1 1  ON 42
eH2_3                -4.250864e-02 1 1  ON 43
eH2_4                 1.392677e-02 1 1  ON 44
eH2_5                 5.201496e-02 1 1  ON 45
eH2_6                 1.101649e-01 1 1  ON 46
eH2_7                 1.565601e-01 1 1  ON 47
eH2_8                 1.700298e-01 1 1  ON 48
eH2_9                 3.148721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9689
    reference variance = 0.193203
====================================================
  Execution time = 2.5695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326278721384
                                         uncertainty =       0.003423143629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326278721384
                                         uncertainty =       0.003423143629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403861294
  error estimate for blocks of size 2^( 2) =       0.000415960357
  error estimate for blocks of size 2^( 3) =       0.000427948852
  error estimate for blocks of size 2^( 4) =       0.000440563287
  error estimate for blocks of size 2^( 5) =       0.000451244973
  error estimate for blocks of size 2^( 6) =       0.000459381503
  error estimate for blocks of size 2^( 7) =       0.000463627467

      target function =                  N/A
              le_mean =     -16.911187259001
             les_mean =     286.314462234973
             stat err =       0.000453704307
             autocorr =       1.262063889170
              std dev =       0.571146118864
             le_variance =       0.326207889093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691118725900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911187259001       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911187252594       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911187252696       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911187261591       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911187266822       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911187270246       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911187268250       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911187268280       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.444558e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911187259001       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911187257396       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911187257421       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911187259644       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911187260954       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911187261814       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911187261316       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911187261325       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 8.615306e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911187259001       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911187258599       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911187258606       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911187259161       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911187259489       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911187259704       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911187259580       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911187259582       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.154071e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2285e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.078646e-01 1 1  ON 0
 uu_1                 1.432903e-01 1 1  ON 1
 uu_2                 4.637502e-02 1 1  ON 2
 uu_3                -1.572563e-02 1 1  ON 3
 uu_4                -6.406953e-02 1 1  ON 4
 uu_5                -9.926330e-02 1 1  ON 5
 uu_6                -1.257525e-01 1 1  ON 6
 uu_7                -1.377540e-01 1 1  ON 7
 uu_8                -1.295051e-01 1 1  ON 8
 uu_9                -9.991502e-02 1 1  ON 9
 ud_0                 4.326937e-01 1 1  ON 10
 ud_1                 1.757790e-01 1 1  ON 11
 ud_2                 6.198514e-02 1 1  ON 12
 ud_3                -6.632295e-03 1 1  ON 13
 ud_4                -6.124834e-02 1 1  ON 14
 ud_5                -1.024649e-01 1 1  ON 15
 ud_6                -1.305577e-01 1 1  ON 16
 ud_7                -1.486242e-01 1 1  ON 17
 ud_8                -1.518226e-01 1 1  ON 18
 ud_9                -1.408855e-01 1 1  ON 19
 eO_0                -7.470800e-01 1 1  ON 20
 eO_1                -4.323976e-01 1 1  ON 21
 eO_2                -1.699654e-02 1 1  ON 22
 eO_3                 2.992010e-01 1 1  ON 23
 eO_4                 5.159690e-01 1 1  ON 24
 eO_5                 4.708260e-01 1 1  ON 25
 eO_6                 2.402977e-01 1 1  ON 26
 eO_7                -5.222200e-02 1 1  ON 27
 eO_8                -2.097821e-01 1 1  ON 28
 eO_9                -6.912473e-02 1 1  ON 29
eH1_0                -2.439206e-01 1 1  ON 30
eH1_1                -1.395543e-01 1 1  ON 31
eH1_2                -9.605238e-02 1 1  ON 32
eH1_3                -4.440956e-02 1 1  ON 33
eH1_4                 1.191588e-02 1 1  ON 34
eH1_5                 4.954609e-02 1 1  ON 35
eH1_6                 1.067276e-01 1 1  ON 36
eH1_7                 1.536189e-01 1 1  ON 37
eH1_8                 1.628871e-01 1 1  ON 38
eH1_9                 4.488872e-02 1 1  ON 39
eH2_0                -2.424999e-01 1 1  ON 40
eH2_1                -1.376278e-01 1 1  ON 41
eH2_2                -9.420095e-02 1 1  ON 42
eH2_3                -4.250894e-02 1 1  ON 43
eH2_4                 1.392676e-02 1 1  ON 44
eH2_5                 5.201498e-02 1 1  ON 45
eH2_6                 1.101651e-01 1 1  ON 46
eH2_7                 1.565603e-01 1 1  ON 47
eH2_8                 1.700303e-01 1 1  ON 48
eH2_9                 3.148787e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.0163
    reference variance = 0.410586
====================================================
  Execution time = 2.5215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4012e-01
  Total weights = 2.0000e+06
  Execution time = 2.9654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340058244982
                                         uncertainty =       0.009185740730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340058244982
                                         uncertainty =       0.009185740730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412380257
  error estimate for blocks of size 2^( 2) =       0.000424028452
  error estimate for blocks of size 2^( 3) =       0.000435796371
  error estimate for blocks of size 2^( 4) =       0.000447972997
  error estimate for blocks of size 2^( 5) =       0.000460348706
  error estimate for blocks of size 2^( 6) =       0.000469687913
  error estimate for blocks of size 2^( 7) =       0.000479577600

      target function =                  N/A
              le_mean =     -16.910457407359
             les_mean =     286.303684508764
             stat err =       0.000464396804
             autocorr =       1.268185299286
              std dev =       0.583193752287
             le_variance =       0.340114952707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340060184826
                                         uncertainty =       0.009185771211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340060184826
                                         uncertainty =       0.009185771211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412381433
  error estimate for blocks of size 2^( 2) =       0.000424029591
  error estimate for blocks of size 2^( 3) =       0.000435797464
  error estimate for blocks of size 2^( 4) =       0.000447974029
  error estimate for blocks of size 2^( 5) =       0.000460349682
  error estimate for blocks of size 2^( 6) =       0.000469688871
  error estimate for blocks of size 2^( 7) =       0.000479578539

      target function =                  N/A
              le_mean =     -16.910457404342
             les_mean =     286.303686347169
             stat err =       0.000464397780
             autocorr =       1.268183395611
              std dev =       0.583195415926
             le_variance =       0.340116893157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340059217219
                                         uncertainty =       0.009185755969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340059217219
                                         uncertainty =       0.009185755969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412380847
  error estimate for blocks of size 2^( 2) =       0.000424029022
  error estimate for blocks of size 2^( 3) =       0.000435796919
  error estimate for blocks of size 2^( 4) =       0.000447973514
  error estimate for blocks of size 2^( 5) =       0.000460349195
  error estimate for blocks of size 2^( 6) =       0.000469688393
  error estimate for blocks of size 2^( 7) =       0.000479578071

      target function =                  N/A
              le_mean =     -16.910457405846
             les_mean =     286.303685430111
             stat err =       0.000464397293
             autocorr =       1.268184345273
              std dev =       0.583194586092
             le_variance =       0.340115925247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340058366582
                                         uncertainty =       0.009185742635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340058366582
                                         uncertainty =       0.009185742635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412380331
  error estimate for blocks of size 2^( 2) =       0.000424028523
  error estimate for blocks of size 2^( 3) =       0.000435796440
  error estimate for blocks of size 2^( 4) =       0.000447973061
  error estimate for blocks of size 2^( 5) =       0.000460348767
  error estimate for blocks of size 2^( 6) =       0.000469687973
  error estimate for blocks of size 2^( 7) =       0.000479577659

      target function =                  N/A
              le_mean =     -16.910457407170
             les_mean =     286.303684623991
             stat err =       0.000464396865
             autocorr =       1.268185179963
              std dev =       0.583193856574
             le_variance =       0.340115074346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910457407359        initial  <--
     9.5367e+01     9.5367e+02             3.4446e-06       -16.910457404342
     3.8147e+02     3.8147e+03             8.6153e-07       -16.910457405846
     1.5259e+03     1.5259e+04             2.1541e-07       -16.910457407170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0946
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.078645e-01 1 1  ON 0
 uu_1                 1.432903e-01 1 1  ON 1
 uu_2                 4.637514e-02 1 1  ON 2
 uu_3                -1.572561e-02 1 1  ON 3
 uu_4                -6.406941e-02 1 1  ON 4
 uu_5                -9.926323e-02 1 1  ON 5
 uu_6                -1.257523e-01 1 1  ON 6
 uu_7                -1.377538e-01 1 1  ON 7
 uu_8                -1.295050e-01 1 1  ON 8
 uu_9                -9.991512e-02 1 1  ON 9
 ud_0                 4.326931e-01 1 1  ON 10
 ud_1                 1.757789e-01 1 1  ON 11
 ud_2                 6.198507e-02 1 1  ON 12
 ud_3                -6.632063e-03 1 1  ON 13
 ud_4                -6.124814e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305572e-01 1 1  ON 16
 ud_7                -1.486240e-01 1 1  ON 17
 ud_8                -1.518226e-01 1 1  ON 18
 ud_9                -1.408857e-01 1 1  ON 19
 eO_0                -7.470795e-01 1 1  ON 20
 eO_1                -4.323973e-01 1 1  ON 21
 eO_2                -1.699653e-02 1 1  ON 22
 eO_3                 2.992008e-01 1 1  ON 23
 eO_4                 5.159685e-01 1 1  ON 24
 eO_5                 4.708255e-01 1 1  ON 25
 eO_6                 2.402976e-01 1 1  ON 26
 eO_7                -5.222211e-02 1 1  ON 27
 eO_8                -2.097818e-01 1 1  ON 28
 eO_9                -6.912443e-02 1 1  ON 29
eH1_0                -2.439197e-01 1 1  ON 30
eH1_1                -1.395543e-01 1 1  ON 31
eH1_2                -9.605195e-02 1 1  ON 32
eH1_3                -4.440943e-02 1 1  ON 33
eH1_4                 1.191593e-02 1 1  ON 34
eH1_5                 4.954645e-02 1 1  ON 35
eH1_6                 1.067275e-01 1 1  ON 36
eH1_7                 1.536186e-01 1 1  ON 37
eH1_8                 1.628864e-01 1 1  ON 38
eH1_9                 4.488808e-02 1 1  ON 39
eH2_0                -2.424991e-01 1 1  ON 40
eH2_1                -1.376273e-01 1 1  ON 41
eH2_2                -9.420077e-02 1 1  ON 42
eH2_3                -4.250864e-02 1 1  ON 43
eH2_4                 1.392677e-02 1 1  ON 44
eH2_5                 5.201496e-02 1 1  ON 45
eH2_6                 1.101649e-01 1 1  ON 46
eH2_7                 1.565601e-01 1 1  ON 47
eH2_8                 1.700298e-01 1 1  ON 48
eH2_9                 3.148721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8735
    reference variance = 0.248003
====================================================
  Execution time = 2.7580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323160805007
                                         uncertainty =       0.002708982544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323160805007
                                         uncertainty =       0.002708982544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401940866
  error estimate for blocks of size 2^( 2) =       0.000413588990
  error estimate for blocks of size 2^( 3) =       0.000425558533
  error estimate for blocks of size 2^( 4) =       0.000436824992
  error estimate for blocks of size 2^( 5) =       0.000446975924
  error estimate for blocks of size 2^( 6) =       0.000453979357
  error estimate for blocks of size 2^( 7) =       0.000459239960

      target function =                  N/A
              le_mean =     -16.911253953747
             les_mean =     286.313623046780
             stat err =       0.000449255058
             autocorr =       1.249285279010
              std dev =       0.568430224563
             le_variance =       0.323112920197


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691125395375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911253953747       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911253953886       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911253954020       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911253954711       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911253954805       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911253954291       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911253954724       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911253954632       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.584221e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911253953747       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911253953782       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911253953816       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911253953989       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911253954011       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911253953883       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911253953992       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911253953968       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.460650e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911253953747       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911253953756       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911253953765       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911253953808       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911253953814       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911253953773       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911253953809       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911253953809       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.615169e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4224e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.078645e-01 1 1  ON 0
 uu_1                 1.432903e-01 1 1  ON 1
 uu_2                 4.637516e-02 1 1  ON 2
 uu_3                -1.572560e-02 1 1  ON 3
 uu_4                -6.406940e-02 1 1  ON 4
 uu_5                -9.926322e-02 1 1  ON 5
 uu_6                -1.257523e-01 1 1  ON 6
 uu_7                -1.377538e-01 1 1  ON 7
 uu_8                -1.295051e-01 1 1  ON 8
 uu_9                -9.991516e-02 1 1  ON 9
 ud_0                 4.326931e-01 1 1  ON 10
 ud_1                 1.757789e-01 1 1  ON 11
 ud_2                 6.198510e-02 1 1  ON 12
 ud_3                -6.632083e-03 1 1  ON 13
 ud_4                -6.124816e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305573e-01 1 1  ON 16
 ud_7                -1.486240e-01 1 1  ON 17
 ud_8                -1.518226e-01 1 1  ON 18
 ud_9                -1.408857e-01 1 1  ON 19
 eO_0                -7.470796e-01 1 1  ON 20
 eO_1                -4.323974e-01 1 1  ON 21
 eO_2                -1.699652e-02 1 1  ON 22
 eO_3                 2.992008e-01 1 1  ON 23
 eO_4                 5.159686e-01 1 1  ON 24
 eO_5                 4.708256e-01 1 1  ON 25
 eO_6                 2.402976e-01 1 1  ON 26
 eO_7                -5.222209e-02 1 1  ON 27
 eO_8                -2.097818e-01 1 1  ON 28
 eO_9                -6.912447e-02 1 1  ON 29
eH1_0                -2.439198e-01 1 1  ON 30
eH1_1                -1.395543e-01 1 1  ON 31
eH1_2                -9.605199e-02 1 1  ON 32
eH1_3                -4.440945e-02 1 1  ON 33
eH1_4                 1.191590e-02 1 1  ON 34
eH1_5                 4.954646e-02 1 1  ON 35
eH1_6                 1.067276e-01 1 1  ON 36
eH1_7                 1.536186e-01 1 1  ON 37
eH1_8                 1.628864e-01 1 1  ON 38
eH1_9                 4.488814e-02 1 1  ON 39
eH2_0                -2.424992e-01 1 1  ON 40
eH2_1                -1.376274e-01 1 1  ON 41
eH2_2                -9.420079e-02 1 1  ON 42
eH2_3                -4.250865e-02 1 1  ON 43
eH2_4                 1.392674e-02 1 1  ON 44
eH2_5                 5.201495e-02 1 1  ON 45
eH2_6                 1.101649e-01 1 1  ON 46
eH2_7                 1.565602e-01 1 1  ON 47
eH2_8                 1.700298e-01 1 1  ON 48
eH2_9                 3.148726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9304
    reference variance = 0.251559
====================================================
  Execution time = 2.4950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3429e-01
  Total weights = 2.0000e+06
  Execution time = 2.9610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386978162
                                         uncertainty =       0.006807455741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386978162
                                         uncertainty =       0.006807455741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408834147
  error estimate for blocks of size 2^( 2) =       0.000420548185
  error estimate for blocks of size 2^( 3) =       0.000432471352
  error estimate for blocks of size 2^( 4) =       0.000444039656
  error estimate for blocks of size 2^( 5) =       0.000455244233
  error estimate for blocks of size 2^( 6) =       0.000462327622
  error estimate for blocks of size 2^( 7) =       0.000464281400

      target function =                  N/A
              le_mean =     -16.911035246836
             les_mean =     286.317403672072
             stat err =       0.000456473227
             autocorr =       1.246626336036
              std dev =       0.578178795426
             le_variance =       0.334290719481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386909436
                                         uncertainty =       0.006807453392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386909436
                                         uncertainty =       0.006807453392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408834105
  error estimate for blocks of size 2^( 2) =       0.000420548145
  error estimate for blocks of size 2^( 3) =       0.000432471312
  error estimate for blocks of size 2^( 4) =       0.000444039616
  error estimate for blocks of size 2^( 5) =       0.000455244193
  error estimate for blocks of size 2^( 6) =       0.000462327578
  error estimate for blocks of size 2^( 7) =       0.000464281358

      target function =                  N/A
              le_mean =     -16.911035247444
             les_mean =     286.317403623962
             stat err =       0.000456473186
             autocorr =       1.246626366372
              std dev =       0.578178736047
             le_variance =       0.334290650817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386943775
                                         uncertainty =       0.006807454566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386943775
                                         uncertainty =       0.006807454566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408834126
  error estimate for blocks of size 2^( 2) =       0.000420548165
  error estimate for blocks of size 2^( 3) =       0.000432471332
  error estimate for blocks of size 2^( 4) =       0.000444039636
  error estimate for blocks of size 2^( 5) =       0.000455244213
  error estimate for blocks of size 2^( 6) =       0.000462327600
  error estimate for blocks of size 2^( 7) =       0.000464281379

      target function =                  N/A
              le_mean =     -16.911035247140
             les_mean =     286.317403647996
             stat err =       0.000456473207
             autocorr =       1.246626351224
              std dev =       0.578178765716
             le_variance =       0.334290685124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386973863
                                         uncertainty =       0.006807455594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334386973863
                                         uncertainty =       0.006807455594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408834144
  error estimate for blocks of size 2^( 2) =       0.000420548183
  error estimate for blocks of size 2^( 3) =       0.000432471350
  error estimate for blocks of size 2^( 4) =       0.000444039653
  error estimate for blocks of size 2^( 5) =       0.000455244230
  error estimate for blocks of size 2^( 6) =       0.000462327619
  error estimate for blocks of size 2^( 7) =       0.000464281397

      target function =                  N/A
              le_mean =     -16.911035246874
             les_mean =     286.317403669061
             stat err =       0.000456473225
             autocorr =       1.246626337936
              std dev =       0.578178791712
             le_variance =       0.334290715185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911035246836        initial
     9.5367e+02     9.5367e+03             2.5842e-07       -16.911035247444  <--
     3.8147e+03     3.8147e+04             6.4607e-08       -16.911035247140
     1.5259e+04     1.5259e+05             1.6152e-08       -16.911035246874

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 3.9826e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.078645e-01 1 1  ON 0
 uu_1                 1.432903e-01 1 1  ON 1
 uu_2                 4.637523e-02 1 1  ON 2
 uu_3                -1.572558e-02 1 1  ON 3
 uu_4                -6.406935e-02 1 1  ON 4
 uu_5                -9.926321e-02 1 1  ON 5
 uu_6                -1.257523e-01 1 1  ON 6
 uu_7                -1.377538e-01 1 1  ON 7
 uu_8                -1.295052e-01 1 1  ON 8
 uu_9                -9.991527e-02 1 1  ON 9
 ud_0                 4.326932e-01 1 1  ON 10
 ud_1                 1.757790e-01 1 1  ON 11
 ud_2                 6.198518e-02 1 1  ON 12
 ud_3                -6.632141e-03 1 1  ON 13
 ud_4                -6.124823e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305573e-01 1 1  ON 16
 ud_7                -1.486240e-01 1 1  ON 17
 ud_8                -1.518226e-01 1 1  ON 18
 ud_9                -1.408857e-01 1 1  ON 19
 eO_0                -7.470797e-01 1 1  ON 20
 eO_1                -4.323975e-01 1 1  ON 21
 eO_2                -1.699647e-02 1 1  ON 22
 eO_3                 2.992009e-01 1 1  ON 23
 eO_4                 5.159687e-01 1 1  ON 24
 eO_5                 4.708257e-01 1 1  ON 25
 eO_6                 2.402976e-01 1 1  ON 26
 eO_7                -5.222203e-02 1 1  ON 27
 eO_8                -2.097819e-01 1 1  ON 28
 eO_9                -6.912458e-02 1 1  ON 29
eH1_0                -2.439200e-01 1 1  ON 30
eH1_1                -1.395544e-01 1 1  ON 31
eH1_2                -9.605208e-02 1 1  ON 32
eH1_3                -4.440952e-02 1 1  ON 33
eH1_4                 1.191581e-02 1 1  ON 34
eH1_5                 4.954650e-02 1 1  ON 35
eH1_6                 1.067276e-01 1 1  ON 36
eH1_7                 1.536187e-01 1 1  ON 37
eH1_8                 1.628866e-01 1 1  ON 38
eH1_9                 4.488832e-02 1 1  ON 39
eH2_0                -2.424992e-01 1 1  ON 40
eH2_1                -1.376275e-01 1 1  ON 41
eH2_2                -9.420088e-02 1 1  ON 42
eH2_3                -4.250867e-02 1 1  ON 43
eH2_4                 1.392666e-02 1 1  ON 44
eH2_5                 5.201494e-02 1 1  ON 45
eH2_6                 1.101650e-01 1 1  ON 46
eH2_7                 1.565603e-01 1 1  ON 47
eH2_8                 1.700299e-01 1 1  ON 48
eH2_9                 3.148741e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4076e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9675
    reference variance = 0.293858
====================================================
  Execution time = 2.5549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331104459020
                                         uncertainty =       0.005733579616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331104459020
                                         uncertainty =       0.005733579616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406853845
  error estimate for blocks of size 2^( 2) =       0.000418555621
  error estimate for blocks of size 2^( 3) =       0.000430503512
  error estimate for blocks of size 2^( 4) =       0.000442204160
  error estimate for blocks of size 2^( 5) =       0.000450803517
  error estimate for blocks of size 2^( 6) =       0.000458629259
  error estimate for blocks of size 2^( 7) =       0.000461027017

      target function =                  N/A
              le_mean =     -16.911847849382
             les_mean =     286.341657617033
             stat err =       0.000453165988
             autocorr =       1.240617106250
              std dev =       0.575378225085
             le_variance =       0.331060101901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691184784938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911847849382       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911847850948       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911847850975       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911847851013       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911847852036       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911847854400       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911847854665       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911847854359       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.069690e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911847849382       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911847849774       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911847849781       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911847849789       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911847850045       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911847850636       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911847850703       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911847850628       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.674235e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911847849382       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911847849480       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911847849482       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911847849484       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911847849546       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911847849696       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911847849715       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911847849695       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.685594e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2168e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.078646e-01 1 1  ON 0
 uu_1                 1.432904e-01 1 1  ON 1
 uu_2                 4.637534e-02 1 1  ON 2
 uu_3                -1.572552e-02 1 1  ON 3
 uu_4                -6.406929e-02 1 1  ON 4
 uu_5                -9.926326e-02 1 1  ON 5
 uu_6                -1.257524e-01 1 1  ON 6
 uu_7                -1.377539e-01 1 1  ON 7
 uu_8                -1.295052e-01 1 1  ON 8
 uu_9                -9.991546e-02 1 1  ON 9
 ud_0                 4.326933e-01 1 1  ON 10
 ud_1                 1.757792e-01 1 1  ON 11
 ud_2                 6.198521e-02 1 1  ON 12
 ud_3                -6.632115e-03 1 1  ON 13
 ud_4                -6.124819e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305573e-01 1 1  ON 16
 ud_7                -1.486241e-01 1 1  ON 17
 ud_8                -1.518227e-01 1 1  ON 18
 ud_9                -1.408859e-01 1 1  ON 19
 eO_0                -7.470798e-01 1 1  ON 20
 eO_1                -4.323975e-01 1 1  ON 21
 eO_2                -1.699652e-02 1 1  ON 22
 eO_3                 2.992010e-01 1 1  ON 23
 eO_4                 5.159690e-01 1 1  ON 24
 eO_5                 4.708258e-01 1 1  ON 25
 eO_6                 2.402977e-01 1 1  ON 26
 eO_7                -5.222200e-02 1 1  ON 27
 eO_8                -2.097821e-01 1 1  ON 28
 eO_9                -6.912475e-02 1 1  ON 29
eH1_0                -2.439201e-01 1 1  ON 30
eH1_1                -1.395545e-01 1 1  ON 31
eH1_2                -9.605230e-02 1 1  ON 32
eH1_3                -4.440961e-02 1 1  ON 33
eH1_4                 1.191575e-02 1 1  ON 34
eH1_5                 4.954655e-02 1 1  ON 35
eH1_6                 1.067277e-01 1 1  ON 36
eH1_7                 1.536188e-01 1 1  ON 37
eH1_8                 1.628868e-01 1 1  ON 38
eH1_9                 4.488850e-02 1 1  ON 39
eH2_0                -2.424994e-01 1 1  ON 40
eH2_1                -1.376276e-01 1 1  ON 41
eH2_2                -9.420110e-02 1 1  ON 42
eH2_3                -4.250865e-02 1 1  ON 43
eH2_4                 1.392657e-02 1 1  ON 44
eH2_5                 5.201490e-02 1 1  ON 45
eH2_6                 1.101651e-01 1 1  ON 46
eH2_7                 1.565604e-01 1 1  ON 47
eH2_8                 1.700301e-01 1 1  ON 48
eH2_9                 3.148760e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.223699
====================================================
  Execution time = 2.5028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3354e-01
  Total weights = 2.0000e+06
  Execution time = 2.9568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603188404
                                         uncertainty =       0.011251932142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603188404
                                         uncertainty =       0.011251932142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408376666
  error estimate for blocks of size 2^( 2) =       0.000420058618
  error estimate for blocks of size 2^( 3) =       0.000431945071
  error estimate for blocks of size 2^( 4) =       0.000442795068
  error estimate for blocks of size 2^( 5) =       0.000453048058
  error estimate for blocks of size 2^( 6) =       0.000460951102
  error estimate for blocks of size 2^( 7) =       0.000466822379

      target function =                  N/A
              le_mean =     -16.912413109346
             les_mean =     286.363260017622
             stat err =       0.000455904152
             autocorr =       1.246307633505
              std dev =       0.577531820085
             le_variance =       0.333543003210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603581618
                                         uncertainty =       0.011251925487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603581618
                                         uncertainty =       0.011251925487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408376907
  error estimate for blocks of size 2^( 2) =       0.000420058844
  error estimate for blocks of size 2^( 3) =       0.000431945270
  error estimate for blocks of size 2^( 4) =       0.000442795247
  error estimate for blocks of size 2^( 5) =       0.000453048229
  error estimate for blocks of size 2^( 6) =       0.000460951269
  error estimate for blocks of size 2^( 7) =       0.000466822554

      target function =                  N/A
              le_mean =     -16.912413111090
             les_mean =     286.363260469675
             stat err =       0.000455904325
             autocorr =       1.246307110622
              std dev =       0.577532160398
             le_variance =       0.333543396294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603385088
                                         uncertainty =       0.011251928813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603385088
                                         uncertainty =       0.011251928813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408376787
  error estimate for blocks of size 2^( 2) =       0.000420058731
  error estimate for blocks of size 2^( 3) =       0.000431945171
  error estimate for blocks of size 2^( 4) =       0.000442795157
  error estimate for blocks of size 2^( 5) =       0.000453048143
  error estimate for blocks of size 2^( 6) =       0.000460951186
  error estimate for blocks of size 2^( 7) =       0.000466822466

      target function =                  N/A
              le_mean =     -16.912413110217
             les_mean =     286.363260243707
             stat err =       0.000455904238
             autocorr =       1.246307371946
              std dev =       0.577531990307
             le_variance =       0.333543199828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603212991
                                         uncertainty =       0.011251931726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333603212991
                                         uncertainty =       0.011251931726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408376681
  error estimate for blocks of size 2^( 2) =       0.000420058632
  error estimate for blocks of size 2^( 3) =       0.000431945083
  error estimate for blocks of size 2^( 4) =       0.000442795079
  error estimate for blocks of size 2^( 5) =       0.000453048069
  error estimate for blocks of size 2^( 6) =       0.000460951113
  error estimate for blocks of size 2^( 7) =       0.000466822389

      target function =                  N/A
              le_mean =     -16.912413109455
             les_mean =     286.363260045883
             stat err =       0.000455904162
             autocorr =       1.246307600817
              std dev =       0.577531841364
             le_variance =       0.333543027790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.912413109346        initial
     2.3842e+02     2.3842e+03             1.0697e-06       -16.912413111090  <--
     9.5367e+02     9.5367e+03             2.6742e-07       -16.912413110217
     3.8147e+03     3.8147e+04             6.6856e-08       -16.912413109455

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 3.9898e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.078647e-01 1 1  ON 0
 uu_1                 1.432907e-01 1 1  ON 1
 uu_2                 4.637566e-02 1 1  ON 2
 uu_3                -1.572536e-02 1 1  ON 3
 uu_4                -6.406912e-02 1 1  ON 4
 uu_5                -9.926341e-02 1 1  ON 5
 uu_6                -1.257529e-01 1 1  ON 6
 uu_7                -1.377540e-01 1 1  ON 7
 uu_8                -1.295054e-01 1 1  ON 8
 uu_9                -9.991606e-02 1 1  ON 9
 ud_0                 4.326938e-01 1 1  ON 10
 ud_1                 1.757796e-01 1 1  ON 11
 ud_2                 6.198528e-02 1 1  ON 12
 ud_3                -6.632039e-03 1 1  ON 13
 ud_4                -6.124807e-02 1 1  ON 14
 ud_5                -1.024647e-01 1 1  ON 15
 ud_6                -1.305572e-01 1 1  ON 16
 ud_7                -1.486242e-01 1 1  ON 17
 ud_8                -1.518231e-01 1 1  ON 18
 ud_9                -1.408863e-01 1 1  ON 19
 eO_0                -7.470802e-01 1 1  ON 20
 eO_1                -4.323976e-01 1 1  ON 21
 eO_2                -1.699665e-02 1 1  ON 22
 eO_3                 2.992016e-01 1 1  ON 23
 eO_4                 5.159698e-01 1 1  ON 24
 eO_5                 4.708259e-01 1 1  ON 25
 eO_6                 2.402979e-01 1 1  ON 26
 eO_7                -5.222190e-02 1 1  ON 27
 eO_8                -2.097827e-01 1 1  ON 28
 eO_9                -6.912525e-02 1 1  ON 29
eH1_0                -2.439203e-01 1 1  ON 30
eH1_1                -1.395549e-01 1 1  ON 31
eH1_2                -9.605293e-02 1 1  ON 32
eH1_3                -4.440990e-02 1 1  ON 33
eH1_4                 1.191556e-02 1 1  ON 34
eH1_5                 4.954668e-02 1 1  ON 35
eH1_6                 1.067279e-01 1 1  ON 36
eH1_7                 1.536190e-01 1 1  ON 37
eH1_8                 1.628874e-01 1 1  ON 38
eH1_9                 4.488904e-02 1 1  ON 39
eH2_0                -2.425000e-01 1 1  ON 40
eH2_1                -1.376279e-01 1 1  ON 41
eH2_2                -9.420176e-02 1 1  ON 42
eH2_3                -4.250860e-02 1 1  ON 43
eH2_4                 1.392631e-02 1 1  ON 44
eH2_5                 5.201480e-02 1 1  ON 45
eH2_6                 1.101654e-01 1 1  ON 46
eH2_7                 1.565607e-01 1 1  ON 47
eH2_8                 1.700307e-01 1 1  ON 48
eH2_9                 3.148818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2088e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9309
    reference variance = 0.304272
====================================================
  Execution time = 2.5573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321039882498
                                         uncertainty =       0.003242100469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321039882498
                                         uncertainty =       0.003242100469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400621466
  error estimate for blocks of size 2^( 2) =       0.000412561817
  error estimate for blocks of size 2^( 3) =       0.000424933546
  error estimate for blocks of size 2^( 4) =       0.000436575541
  error estimate for blocks of size 2^( 5) =       0.000447092138
  error estimate for blocks of size 2^( 6) =       0.000453531298
  error estimate for blocks of size 2^( 7) =       0.000460431447

      target function =                  N/A
              le_mean =     -16.912229417288
             les_mean =     286.344498821275
             stat err =       0.000449407606
             autocorr =       1.258381728243
              std dev =       0.566564311267
             le_variance =       0.320995118801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691222941729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912229417288       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912229405653       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912229412741       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912229410154       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912229405548       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912229411800       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912229411877       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912229411045       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 6.600825e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912229417288       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912229414374       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912229416145       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912229415495       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912229414338       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912229415902       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912229415920       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912229415710       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.651293e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912229417288       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912229416559       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912229417002       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912229416839       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912229416550       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912229416940       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912229416946       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912229416893       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.128914e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2267e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.078644e-01 1 1  ON 0
 uu_1                 1.432913e-01 1 1  ON 1
 uu_2                 4.637585e-02 1 1  ON 2
 uu_3                -1.572494e-02 1 1  ON 3
 uu_4                -6.406912e-02 1 1  ON 4
 uu_5                -9.926330e-02 1 1  ON 5
 uu_6                -1.257527e-01 1 1  ON 6
 uu_7                -1.377547e-01 1 1  ON 7
 uu_8                -1.295064e-01 1 1  ON 8
 uu_9                -9.991653e-02 1 1  ON 9
 ud_0                 4.326942e-01 1 1  ON 10
 ud_1                 1.757799e-01 1 1  ON 11
 ud_2                 6.198551e-02 1 1  ON 12
 ud_3                -6.632202e-03 1 1  ON 13
 ud_4                -6.124816e-02 1 1  ON 14
 ud_5                -1.024653e-01 1 1  ON 15
 ud_6                -1.305570e-01 1 1  ON 16
 ud_7                -1.486241e-01 1 1  ON 17
 ud_8                -1.518234e-01 1 1  ON 18
 ud_9                -1.408865e-01 1 1  ON 19
 eO_0                -7.470811e-01 1 1  ON 20
 eO_1                -4.323980e-01 1 1  ON 21
 eO_2                -1.699681e-02 1 1  ON 22
 eO_3                 2.992025e-01 1 1  ON 23
 eO_4                 5.159707e-01 1 1  ON 24
 eO_5                 4.708267e-01 1 1  ON 25
 eO_6                 2.402982e-01 1 1  ON 26
 eO_7                -5.222184e-02 1 1  ON 27
 eO_8                -2.097835e-01 1 1  ON 28
 eO_9                -6.912581e-02 1 1  ON 29
eH1_0                -2.439220e-01 1 1  ON 30
eH1_1                -1.395555e-01 1 1  ON 31
eH1_2                -9.605331e-02 1 1  ON 32
eH1_3                -4.441017e-02 1 1  ON 33
eH1_4                 1.191532e-02 1 1  ON 34
eH1_5                 4.954721e-02 1 1  ON 35
eH1_6                 1.067284e-01 1 1  ON 36
eH1_7                 1.536195e-01 1 1  ON 37
eH1_8                 1.628883e-01 1 1  ON 38
eH1_9                 4.488982e-02 1 1  ON 39
eH2_0                -2.425005e-01 1 1  ON 40
eH2_1                -1.376285e-01 1 1  ON 41
eH2_2                -9.420225e-02 1 1  ON 42
eH2_3                -4.250908e-02 1 1  ON 43
eH2_4                 1.392589e-02 1 1  ON 44
eH2_5                 5.201470e-02 1 1  ON 45
eH2_6                 1.101654e-01 1 1  ON 46
eH2_7                 1.565611e-01 1 1  ON 47
eH2_8                 1.700318e-01 1 1  ON 48
eH2_9                 3.148927e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.961
    reference variance = 0.18745
====================================================
  Execution time = 2.5023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3469e-01
  Total weights = 2.0000e+06
  Execution time = 2.9661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714285634
                                         uncertainty =       0.005176660267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714285634
                                         uncertainty =       0.005176660267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409075783
  error estimate for blocks of size 2^( 2) =       0.000420685268
  error estimate for blocks of size 2^( 3) =       0.000433312328
  error estimate for blocks of size 2^( 4) =       0.000445599000
  error estimate for blocks of size 2^( 5) =       0.000456559762
  error estimate for blocks of size 2^( 6) =       0.000464974767
  error estimate for blocks of size 2^( 7) =       0.000468063401

      target function =                  N/A
              le_mean =     -16.911156176809
             les_mean =     286.321889061808
             stat err =       0.000458799233
             autocorr =       1.257875981848
              std dev =       0.578520520580
             le_variance =       0.334685992732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714541035
                                         uncertainty =       0.005176681700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714541035
                                         uncertainty =       0.005176681700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409075939
  error estimate for blocks of size 2^( 2) =       0.000420685427
  error estimate for blocks of size 2^( 3) =       0.000433312473
  error estimate for blocks of size 2^( 4) =       0.000445599117
  error estimate for blocks of size 2^( 5) =       0.000456559877
  error estimate for blocks of size 2^( 6) =       0.000464974865
  error estimate for blocks of size 2^( 7) =       0.000468063477

      target function =                  N/A
              le_mean =     -16.911156185425
             les_mean =     286.321889608861
             stat err =       0.000458799334
             autocorr =       1.257875576962
              std dev =       0.578520741527
             le_variance =       0.334686248377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714412007
                                         uncertainty =       0.005176670985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714412007
                                         uncertainty =       0.005176670985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409075860
  error estimate for blocks of size 2^( 2) =       0.000420685347
  error estimate for blocks of size 2^( 3) =       0.000433312400
  error estimate for blocks of size 2^( 4) =       0.000445599058
  error estimate for blocks of size 2^( 5) =       0.000456559819
  error estimate for blocks of size 2^( 6) =       0.000464974816
  error estimate for blocks of size 2^( 7) =       0.000468063438

      target function =                  N/A
              le_mean =     -16.911156181148
             les_mean =     286.321889335061
             stat err =       0.000458799283
             autocorr =       1.257875780467
              std dev =       0.578520629907
             le_variance =       0.334686119228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714301385
                                         uncertainty =       0.005176661607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334714301385
                                         uncertainty =       0.005176661607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409075793
  error estimate for blocks of size 2^( 2) =       0.000420685278
  error estimate for blocks of size 2^( 3) =       0.000433312337
  error estimate for blocks of size 2^( 4) =       0.000445599008
  error estimate for blocks of size 2^( 5) =       0.000456559769
  error estimate for blocks of size 2^( 6) =       0.000464974773
  error estimate for blocks of size 2^( 7) =       0.000468063405

      target function =                  N/A
              le_mean =     -16.911156177352
             les_mean =     286.321889095937
             stat err =       0.000458799239
             autocorr =       1.257875956701
              std dev =       0.578520534206
             le_variance =       0.334686008498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911156176809        initial
     5.9605e+01     5.9605e+02             6.6008e-06       -16.911156185425  <--
     2.3842e+02     2.3842e+03             1.6513e-06       -16.911156181148
     9.5367e+02     9.5367e+03             4.1289e-07       -16.911156177352

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 3.9919e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124842e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489214e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392465e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2237e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9326
    reference variance = 0.330198
====================================================
  Execution time = 2.5648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2749e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.9164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327458733486
                                         uncertainty =       0.003325662052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327458733486
                                         uncertainty =       0.003325662052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404651937
  error estimate for blocks of size 2^( 2) =       0.000416725008
  error estimate for blocks of size 2^( 3) =       0.000429452640
  error estimate for blocks of size 2^( 4) =       0.000441970717
  error estimate for blocks of size 2^( 5) =       0.000454225813
  error estimate for blocks of size 2^( 6) =       0.000465220922
  error estimate for blocks of size 2^( 7) =       0.000471348750

      target function =                  N/A
              le_mean =     -16.911082553522
             les_mean =     286.312199348464
             stat err =       0.000458191551
             autocorr =       1.282126585129
              std dev =       0.572264257276
             le_variance =       0.327486380156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691108255352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911082553522       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911082566876       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911082603005       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911082601060       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911082575700       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911082597420       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911082603823       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911082606456       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.020186e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911082553522       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911082556898       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911082566052       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911082565542       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911082558761       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911082564065       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911082565758       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911082566497       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.052815e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911082553522       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911082554369       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911082556665       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911082556536       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911082554813       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911082556130       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911082556559       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911082556750       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.263350e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2575e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.078645e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637527e-02 1 1  ON 2
 uu_3                -1.572355e-02 1 1  ON 3
 uu_4                -6.406956e-02 1 1  ON 4
 uu_5                -9.926316e-02 1 1  ON 5
 uu_6                -1.257543e-01 1 1  ON 6
 uu_7                -1.377585e-01 1 1  ON 7
 uu_8                -1.295103e-01 1 1  ON 8
 uu_9                -9.991727e-02 1 1  ON 9
 ud_0                 4.326969e-01 1 1  ON 10
 ud_1                 1.757827e-01 1 1  ON 11
 ud_2                 6.198460e-02 1 1  ON 12
 ud_3                -6.633082e-03 1 1  ON 13
 ud_4                -6.125171e-02 1 1  ON 14
 ud_5                -1.024676e-01 1 1  ON 15
 ud_6                -1.305593e-01 1 1  ON 16
 ud_7                -1.486233e-01 1 1  ON 17
 ud_8                -1.518216e-01 1 1  ON 18
 ud_9                -1.408855e-01 1 1  ON 19
 eO_0                -7.470871e-01 1 1  ON 20
 eO_1                -4.324017e-01 1 1  ON 21
 eO_2                -1.699808e-02 1 1  ON 22
 eO_3                 2.992065e-01 1 1  ON 23
 eO_4                 5.159769e-01 1 1  ON 24
 eO_5                 4.708317e-01 1 1  ON 25
 eO_6                 2.402996e-01 1 1  ON 26
 eO_7                -5.222069e-02 1 1  ON 27
 eO_8                -2.097870e-01 1 1  ON 28
 eO_9                -6.912900e-02 1 1  ON 29
eH1_0                -2.439310e-01 1 1  ON 30
eH1_1                -1.395587e-01 1 1  ON 31
eH1_2                -9.605778e-02 1 1  ON 32
eH1_3                -4.441428e-02 1 1  ON 33
eH1_4                 1.191386e-02 1 1  ON 34
eH1_5                 4.954793e-02 1 1  ON 35
eH1_6                 1.067307e-01 1 1  ON 36
eH1_7                 1.536238e-01 1 1  ON 37
eH1_8                 1.628959e-01 1 1  ON 38
eH1_9                 4.489598e-02 1 1  ON 39
eH2_0                -2.425042e-01 1 1  ON 40
eH2_1                -1.376314e-01 1 1  ON 41
eH2_2                -9.420640e-02 1 1  ON 42
eH2_3                -4.251062e-02 1 1  ON 43
eH2_4                 1.392130e-02 1 1  ON 44
eH2_5                 5.201391e-02 1 1  ON 45
eH2_6                 1.101644e-01 1 1  ON 46
eH2_7                 1.565645e-01 1 1  ON 47
eH2_8                 1.700386e-01 1 1  ON 48
eH2_9                 3.149664e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.319773
====================================================
  Execution time = 2.5249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4913e-01
  Total weights = 2.0000e+06
  Execution time = 2.9760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348761884990
                                         uncertainty =       0.013970196317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348761884990
                                         uncertainty =       0.013970196317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417809662
  error estimate for blocks of size 2^( 2) =       0.000429449130
  error estimate for blocks of size 2^( 3) =       0.000441636769
  error estimate for blocks of size 2^( 4) =       0.000453656339
  error estimate for blocks of size 2^( 5) =       0.000465328562
  error estimate for blocks of size 2^( 6) =       0.000474637115
  error estimate for blocks of size 2^( 7) =       0.000481841023

      target function =                  N/A
              le_mean =     -16.911069402901
             les_mean =     286.333398003299
             stat err =       0.000468865760
             autocorr =       1.259331532798
              std dev =       0.590872091171
             le_variance =       0.349129828125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348771600130
                                         uncertainty =       0.013969916308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348771600130
                                         uncertainty =       0.013969916308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417815477
  error estimate for blocks of size 2^( 2) =       0.000429454762
  error estimate for blocks of size 2^( 3) =       0.000441642040
  error estimate for blocks of size 2^( 4) =       0.000453661239
  error estimate for blocks of size 2^( 5) =       0.000465333306
  error estimate for blocks of size 2^( 6) =       0.000474641310
  error estimate for blocks of size 2^( 7) =       0.000481845195

      target function =                  N/A
              le_mean =     -16.911069324647
             les_mean =     286.333405073585
             stat err =       0.000468870262
             autocorr =       1.259320670429
              std dev =       0.590880313708
             le_variance =       0.349139545128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348766794237
                                         uncertainty =       0.013970057392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348766794237
                                         uncertainty =       0.013970057392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417812601
  error estimate for blocks of size 2^( 2) =       0.000429451975
  error estimate for blocks of size 2^( 3) =       0.000441639431
  error estimate for blocks of size 2^( 4) =       0.000453658815
  error estimate for blocks of size 2^( 5) =       0.000465330960
  error estimate for blocks of size 2^( 6) =       0.000474639236
  error estimate for blocks of size 2^( 7) =       0.000481843134

      target function =                  N/A
              le_mean =     -16.911069362515
             les_mean =     286.333401547651
             stat err =       0.000468868036
             autocorr =       1.259326049540
              std dev =       0.590876246278
             le_variance =       0.349134738416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348762500178
                                         uncertainty =       0.013970178989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348762500178
                                         uncertainty =       0.013970178989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417810031
  error estimate for blocks of size 2^( 2) =       0.000429449486
  error estimate for blocks of size 2^( 3) =       0.000441637102
  error estimate for blocks of size 2^( 4) =       0.000453656649
  error estimate for blocks of size 2^( 5) =       0.000465328863
  error estimate for blocks of size 2^( 6) =       0.000474637381
  error estimate for blocks of size 2^( 7) =       0.000481841288

      target function =                  N/A
              le_mean =     -16.911069397797
             les_mean =     286.333398445989
             stat err =       0.000468866045
             autocorr =       1.259330845742
              std dev =       0.590872611861
             le_variance =       0.349130443448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911069402901        initial  <--
     1.4901e+01     1.4901e+02             2.0202e-05       -16.911069324647
     5.9605e+01     5.9605e+02             5.0528e-06       -16.911069362515
     2.3842e+02     2.3842e+03             1.2634e-06       -16.911069397797

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.2013
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124842e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489214e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392465e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 0.330661
====================================================
  Execution time = 2.5533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338843875472
                                         uncertainty =       0.008211866419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338843875472
                                         uncertainty =       0.008211866419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411651054
  error estimate for blocks of size 2^( 2) =       0.000423336698
  error estimate for blocks of size 2^( 3) =       0.000435572724
  error estimate for blocks of size 2^( 4) =       0.000447302294
  error estimate for blocks of size 2^( 5) =       0.000456717259
  error estimate for blocks of size 2^( 6) =       0.000463243648
  error estimate for blocks of size 2^( 7) =       0.000465002250

      target function =                  N/A
              le_mean =     -16.911429116885
             les_mean =     286.335347785760
             stat err =       0.000458066363
             autocorr =       1.238221497959
              std dev =       0.582162502901
             le_variance =       0.338913179783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691142911689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911429116885       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911429117147       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911429110950       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911429111718       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911429114635       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911429116823       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911429116845       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911429117014       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.691669e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911429116885       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911429116951       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911429115399       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911429115590       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911429116318       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911429116866       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911429116872       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911429116914       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.229716e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911429116885       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911429116902       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911429116514       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911429116561       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911429116743       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911429116880       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911429116880       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911429116887       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.057463e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2676e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432932e-01 1 1  ON 1
 uu_2                 4.637659e-02 1 1  ON 2
 uu_3                -1.572356e-02 1 1  ON 3
 uu_4                -6.406902e-02 1 1  ON 4
 uu_5                -9.926310e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377568e-01 1 1  ON 7
 uu_8                -1.295097e-01 1 1  ON 8
 uu_9                -9.991806e-02 1 1  ON 9
 ud_0                 4.326960e-01 1 1  ON 10
 ud_1                 1.757810e-01 1 1  ON 11
 ud_2                 6.198615e-02 1 1  ON 12
 ud_3                -6.632648e-03 1 1  ON 13
 ud_4                -6.124863e-02 1 1  ON 14
 ud_5                -1.024672e-01 1 1  ON 15
 ud_6                -1.305561e-01 1 1  ON 16
 ud_7                -1.486239e-01 1 1  ON 17
 ud_8                -1.518244e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470844e-01 1 1  ON 20
 eO_1                -4.323996e-01 1 1  ON 21
 eO_2                -1.699729e-02 1 1  ON 22
 eO_3                 2.992052e-01 1 1  ON 23
 eO_4                 5.159736e-01 1 1  ON 24
 eO_5                 4.708294e-01 1 1  ON 25
 eO_6                 2.402996e-01 1 1  ON 26
 eO_7                -5.222171e-02 1 1  ON 27
 eO_8                -2.097861e-01 1 1  ON 28
 eO_9                -6.912768e-02 1 1  ON 29
eH1_0                -2.439272e-01 1 1  ON 30
eH1_1                -1.395573e-01 1 1  ON 31
eH1_2                -9.605455e-02 1 1  ON 32
eH1_3                -4.441100e-02 1 1  ON 33
eH1_4                 1.191440e-02 1 1  ON 34
eH1_5                 4.954864e-02 1 1  ON 35
eH1_6                 1.067297e-01 1 1  ON 36
eH1_7                 1.536212e-01 1 1  ON 37
eH1_8                 1.628911e-01 1 1  ON 38
eH1_9                 4.489233e-02 1 1  ON 39
eH2_0                -2.425027e-01 1 1  ON 40
eH2_1                -1.376307e-01 1 1  ON 41
eH2_2                -9.420390e-02 1 1  ON 42
eH2_3                -4.251082e-02 1 1  ON 43
eH2_4                 1.392459e-02 1 1  ON 44
eH2_5                 5.201440e-02 1 1  ON 45
eH2_6                 1.101656e-01 1 1  ON 46
eH2_7                 1.565625e-01 1 1  ON 47
eH2_8                 1.700355e-01 1 1  ON 48
eH2_9                 3.149294e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.118102
====================================================
  Execution time = 2.5339e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3047e-01
  Total weights = 2.0000e+06
  Execution time = 2.9716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330531556139
                                         uncertainty =       0.004653296308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330531556139
                                         uncertainty =       0.004653296308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406488426
  error estimate for blocks of size 2^( 2) =       0.000418393481
  error estimate for blocks of size 2^( 3) =       0.000430646308
  error estimate for blocks of size 2^( 4) =       0.000442681145
  error estimate for blocks of size 2^( 5) =       0.000453620152
  error estimate for blocks of size 2^( 6) =       0.000461592275
  error estimate for blocks of size 2^( 7) =       0.000467347129

      target function =                  N/A
              le_mean =     -16.910539916392
             les_mean =     286.296825778957
             stat err =       0.000456310175
             autocorr =       1.260154917624
              std dev =       0.574861444444
             le_variance =       0.330465680308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330532505576
                                         uncertainty =       0.004653305377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330532505576
                                         uncertainty =       0.004653305377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406489009
  error estimate for blocks of size 2^( 2) =       0.000418394025
  error estimate for blocks of size 2^( 3) =       0.000430646810
  error estimate for blocks of size 2^( 4) =       0.000442681620
  error estimate for blocks of size 2^( 5) =       0.000453620599
  error estimate for blocks of size 2^( 6) =       0.000461592695
  error estimate for blocks of size 2^( 7) =       0.000467347558

      target function =                  N/A
              le_mean =     -16.910539912333
             les_mean =     286.296826590955
             stat err =       0.000456310618
             autocorr =       1.260153742940
              std dev =       0.574862270087
             le_variance =       0.330466629569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330532031586
                                         uncertainty =       0.004653300846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330532031586
                                         uncertainty =       0.004653300846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406488718
  error estimate for blocks of size 2^( 2) =       0.000418393753
  error estimate for blocks of size 2^( 3) =       0.000430646559
  error estimate for blocks of size 2^( 4) =       0.000442681383
  error estimate for blocks of size 2^( 5) =       0.000453620376
  error estimate for blocks of size 2^( 6) =       0.000461592485
  error estimate for blocks of size 2^( 7) =       0.000467347344

      target function =                  N/A
              le_mean =     -16.910539914361
             les_mean =     286.296826185613
             stat err =       0.000456310397
             autocorr =       1.260154329264
              std dev =       0.574861857898
             le_variance =       0.330466155666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330531615592
                                         uncertainty =       0.004653296876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330531615592
                                         uncertainty =       0.004653296876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406488462
  error estimate for blocks of size 2^( 2) =       0.000418393515
  error estimate for blocks of size 2^( 3) =       0.000430646339
  error estimate for blocks of size 2^( 4) =       0.000442681174
  error estimate for blocks of size 2^( 5) =       0.000453620180
  error estimate for blocks of size 2^( 6) =       0.000461592301
  error estimate for blocks of size 2^( 7) =       0.000467347156

      target function =                  N/A
              le_mean =     -16.910539916138
             les_mean =     286.296825829805
             stat err =       0.000456310203
             autocorr =       1.260154844043
              std dev =       0.574861496145
             le_variance =       0.330465739750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910539916392        initial  <--
     1.4901e+02     1.4901e+03             1.6917e-06       -16.910539912333
     5.9605e+02     5.9605e+03             4.2297e-07       -16.910539914361
     2.3842e+03     2.3842e+04             1.0575e-07       -16.910539916138

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.3268
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124842e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489214e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392465e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 0.3502
====================================================
  Execution time = 2.5869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3679e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336836141565
                                         uncertainty =       0.006259002250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336836141565
                                         uncertainty =       0.006259002250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410357613
  error estimate for blocks of size 2^( 2) =       0.000421845003
  error estimate for blocks of size 2^( 3) =       0.000433814660
  error estimate for blocks of size 2^( 4) =       0.000445227474
  error estimate for blocks of size 2^( 5) =       0.000454636039
  error estimate for blocks of size 2^( 6) =       0.000461251758
  error estimate for blocks of size 2^( 7) =       0.000466778751

      target function =                  N/A
              le_mean =     -16.911329585430
             les_mean =     286.329854918905
             stat err =       0.000456973505
             autocorr =       1.240100987882
              std dev =       0.580333301021
             le_variance =       0.336786740274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691132958543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911329585430       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911329585433       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911329585481       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911329586040       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911329586147       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911329586332       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911329586331       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.000445e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911329585430       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911329585430       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911329585442       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911329585582       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911329585611       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911329585652       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911329585657       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 5.001193e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911329585430       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911329585430       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911329585433       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911329585468       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911329585469       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911329585493       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911329585483       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.250303e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075283 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2501e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637644e-02 1 1  ON 2
 uu_3                -1.572367e-02 1 1  ON 3
 uu_4                -6.406910e-02 1 1  ON 4
 uu_5                -9.926299e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991795e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198622e-02 1 1  ON 12
 ud_3                -6.632681e-03 1 1  ON 13
 ud_4                -6.124845e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699731e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222166e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912751e-02 1 1  ON 29
eH1_0                -2.439270e-01 1 1  ON 30
eH1_1                -1.395573e-01 1 1  ON 31
eH1_2                -9.605449e-02 1 1  ON 32
eH1_3                -4.441100e-02 1 1  ON 33
eH1_4                 1.191458e-02 1 1  ON 34
eH1_5                 4.954880e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628909e-01 1 1  ON 38
eH1_9                 4.489217e-02 1 1  ON 39
eH2_0                -2.425023e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420375e-02 1 1  ON 42
eH2_3                -4.251054e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700352e-01 1 1  ON 48
eH2_9                 3.149259e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.233939
====================================================
  Execution time = 2.5179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4081e-01
  Total weights = 2.0000e+06
  Execution time = 2.9757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613318894
                                         uncertainty =       0.008083627441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613318894
                                         uncertainty =       0.008083627441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412799004
  error estimate for blocks of size 2^( 2) =       0.000424605119
  error estimate for blocks of size 2^( 3) =       0.000436546986
  error estimate for blocks of size 2^( 4) =       0.000447937937
  error estimate for blocks of size 2^( 5) =       0.000457499696
  error estimate for blocks of size 2^( 6) =       0.000464156995
  error estimate for blocks of size 2^( 7) =       0.000468705232

      target function =                  N/A
              le_mean =     -16.911581494840
             les_mean =     286.342394521840
             stat err =       0.000459574965
             autocorr =       1.239468356794
              std dev =       0.583785950177
             le_variance =       0.340806035625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613277567
                                         uncertainty =       0.008083626449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613277567
                                         uncertainty =       0.008083626449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412798979
  error estimate for blocks of size 2^( 2) =       0.000424605096
  error estimate for blocks of size 2^( 3) =       0.000436546963
  error estimate for blocks of size 2^( 4) =       0.000447937913
  error estimate for blocks of size 2^( 5) =       0.000457499670
  error estimate for blocks of size 2^( 6) =       0.000464156968
  error estimate for blocks of size 2^( 7) =       0.000468705203

      target function =                  N/A
              le_mean =     -16.911581494039
             les_mean =     286.342394453457
             stat err =       0.000459574938
             autocorr =       1.239468363822
              std dev =       0.583785914811
             le_variance =       0.340805994332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613298226
                                         uncertainty =       0.008083626945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613298226
                                         uncertainty =       0.008083626945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412798992
  error estimate for blocks of size 2^( 2) =       0.000424605108
  error estimate for blocks of size 2^( 3) =       0.000436546975
  error estimate for blocks of size 2^( 4) =       0.000447937925
  error estimate for blocks of size 2^( 5) =       0.000457499683
  error estimate for blocks of size 2^( 6) =       0.000464156981
  error estimate for blocks of size 2^( 7) =       0.000468705218

      target function =                  N/A
              le_mean =     -16.911581494440
             les_mean =     286.342394487642
             stat err =       0.000459574952
             autocorr =       1.239468360314
              std dev =       0.583785932490
             le_variance =       0.340806014974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613316310
                                         uncertainty =       0.008083627379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340613316310
                                         uncertainty =       0.008083627379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412799003
  error estimate for blocks of size 2^( 2) =       0.000424605118
  error estimate for blocks of size 2^( 3) =       0.000436546985
  error estimate for blocks of size 2^( 4) =       0.000447937936
  error estimate for blocks of size 2^( 5) =       0.000457499694
  error estimate for blocks of size 2^( 6) =       0.000464156993
  error estimate for blocks of size 2^( 7) =       0.000468705230

      target function =                  N/A
              le_mean =     -16.911581494790
             les_mean =     286.342394517565
             stat err =       0.000459574963
             autocorr =       1.239468357238
              std dev =       0.583785947966
             le_variance =       0.340806033043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911581494840        initial  <--
     1.4901e+03     1.4901e+04             2.0004e-07       -16.911581494039
     5.9605e+03     5.9605e+04             5.0012e-08       -16.911581494440
     2.3842e+04     2.3842e+05             1.2503e-08       -16.911581494790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1256
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124842e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489214e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392465e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9595
    reference variance = 0.286541
====================================================
  Execution time = 2.5731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2885e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328903435198
                                         uncertainty =       0.003509907623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328903435198
                                         uncertainty =       0.003509907623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405495277
  error estimate for blocks of size 2^( 2) =       0.000417243610
  error estimate for blocks of size 2^( 3) =       0.000429497225
  error estimate for blocks of size 2^( 4) =       0.000441863506
  error estimate for blocks of size 2^( 5) =       0.000451361257
  error estimate for blocks of size 2^( 6) =       0.000458902680
  error estimate for blocks of size 2^( 7) =       0.000463271679

      target function =                  N/A
              le_mean =     -16.911408209591
             les_mean =     286.324580307080
             stat err =       0.000453849781
             autocorr =       1.252716098989
              std dev =       0.573456920848
             le_variance =       0.328852840068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691140820959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911408209591       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911408209615       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911408209601       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911408209655       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911408209635       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911408209641       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911408209640       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911408209679       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.011408e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911408209591       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911408209597       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911408209594       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911408209609       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911408209638       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911408209614       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911408209604       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911408209566       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.028535e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911408209591       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911408209593       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911408209592       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911408209595       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911408209594       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911408209477       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911408209853       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911408208963       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.257135e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2433e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991794e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632687e-03 1 1  ON 13
 ud_4                -6.124842e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392465e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700352e-01 1 1  ON 48
eH2_9                 3.149255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9076
    reference variance = 0.323887
====================================================
  Execution time = 2.5004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2830e-01
  Total weights = 2.0000e+06
  Execution time = 2.9603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252364966
                                         uncertainty =       0.003138704556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252364966
                                         uncertainty =       0.003138704556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405157172
  error estimate for blocks of size 2^( 2) =       0.000416531441
  error estimate for blocks of size 2^( 3) =       0.000429385511
  error estimate for blocks of size 2^( 4) =       0.000441152832
  error estimate for blocks of size 2^( 5) =       0.000451401677
  error estimate for blocks of size 2^( 6) =       0.000460720597
  error estimate for blocks of size 2^( 7) =       0.000466503783

      target function =                  N/A
              le_mean =     -16.911967601383
             les_mean =     286.342952653777
             stat err =       0.000454944722
             autocorr =       1.260869677929
              std dev =       0.572978767230
             le_variance =       0.328304667696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252367269
                                         uncertainty =       0.003138704557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252367269
                                         uncertainty =       0.003138704557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405157173
  error estimate for blocks of size 2^( 2) =       0.000416531443
  error estimate for blocks of size 2^( 3) =       0.000429385512
  error estimate for blocks of size 2^( 4) =       0.000441152833
  error estimate for blocks of size 2^( 5) =       0.000451401678
  error estimate for blocks of size 2^( 6) =       0.000460720598
  error estimate for blocks of size 2^( 7) =       0.000466503783

      target function =                  N/A
              le_mean =     -16.911967601374
             les_mean =     286.342952655768
             stat err =       0.000454944723
             autocorr =       1.260869672641
              std dev =       0.572978769233
             le_variance =       0.328304669992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252366117
                                         uncertainty =       0.003138704556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252366117
                                         uncertainty =       0.003138704556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405157172
  error estimate for blocks of size 2^( 2) =       0.000416531442
  error estimate for blocks of size 2^( 3) =       0.000429385512
  error estimate for blocks of size 2^( 4) =       0.000441152832
  error estimate for blocks of size 2^( 5) =       0.000451401678
  error estimate for blocks of size 2^( 6) =       0.000460720597
  error estimate for blocks of size 2^( 7) =       0.000466503783

      target function =                  N/A
              le_mean =     -16.911967601379
             les_mean =     286.342952654773
             stat err =       0.000454944723
             autocorr =       1.260869675292
              std dev =       0.572978768231
             le_variance =       0.328304668844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252365110
                                         uncertainty =       0.003138704556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328252365110
                                         uncertainty =       0.003138704556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405157172
  error estimate for blocks of size 2^( 2) =       0.000416531441
  error estimate for blocks of size 2^( 3) =       0.000429385511
  error estimate for blocks of size 2^( 4) =       0.000441152832
  error estimate for blocks of size 2^( 5) =       0.000451401677
  error estimate for blocks of size 2^( 6) =       0.000460720597
  error estimate for blocks of size 2^( 7) =       0.000466503783

      target function =                  N/A
              le_mean =     -16.911967601383
             les_mean =     286.342952653901
             stat err =       0.000454944722
             autocorr =       1.260869677610
              std dev =       0.572978767355
             le_variance =       0.328304667839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911967601383        initial  <--
     1.4901e+04     1.4901e+05             2.0114e-08       -16.911967601374
     5.9605e+04     5.9605e+05             5.0285e-09       -16.911967601379
     2.3842e+05     2.3842e+06             1.2571e-09       -16.911967601383

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9011
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124842e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489214e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392465e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8672
    reference variance = 0.362394
====================================================
  Execution time = 2.5626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2341e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323440272099
                                         uncertainty =       0.003338129261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323440272099
                                         uncertainty =       0.003338129261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402124140
  error estimate for blocks of size 2^( 2) =       0.000413692929
  error estimate for blocks of size 2^( 3) =       0.000425675045
  error estimate for blocks of size 2^( 4) =       0.000437418896
  error estimate for blocks of size 2^( 5) =       0.000449055447
  error estimate for blocks of size 2^( 6) =       0.000455096111
  error estimate for blocks of size 2^( 7) =       0.000460205741

      target function =                  N/A
              le_mean =     -16.910043081946
             les_mean =     286.272964519994
             stat err =       0.000450444049
             autocorr =       1.254762167920
              std dev =       0.568689412975
             le_variance =       0.323407648430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691004308195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910043081946       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910043081947       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910043081941       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910043081944       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910043081949       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910043081942       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910043081948       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910043081798       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.788493e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910043081946       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910043081946       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910043081945       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910043081946       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910043081198       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910043082171       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910043082356       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910043082090       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.471234e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910043081946       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910043081946       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910043081946       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910043081951       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910043081987       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910043081946       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910043080142       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910043081705       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.117807e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2235e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124842e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489214e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392465e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9552
    reference variance = 0.231235
====================================================
  Execution time = 2.5041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2697e-01
  Total weights = 2.0000e+06
  Execution time = 2.9666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955533610
                                         uncertainty =       0.003327945120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955533610
                                         uncertainty =       0.003327945120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404334148
  error estimate for blocks of size 2^( 2) =       0.000416183503
  error estimate for blocks of size 2^( 3) =       0.000428419512
  error estimate for blocks of size 2^( 4) =       0.000439818451
  error estimate for blocks of size 2^( 5) =       0.000450512364
  error estimate for blocks of size 2^( 6) =       0.000458703378
  error estimate for blocks of size 2^( 7) =       0.000464311787

      target function =                  N/A
              le_mean =     -16.911095979006
             les_mean =     286.312139253883
             stat err =       0.000453336495
             autocorr =       1.257073071250
              std dev =       0.571814835605
             le_variance =       0.326972206218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955534570
                                         uncertainty =       0.003327945126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955534570
                                         uncertainty =       0.003327945126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404334148
  error estimate for blocks of size 2^( 2) =       0.000416183504
  error estimate for blocks of size 2^( 3) =       0.000428419512
  error estimate for blocks of size 2^( 4) =       0.000439818452
  error estimate for blocks of size 2^( 5) =       0.000450512364
  error estimate for blocks of size 2^( 6) =       0.000458703378
  error estimate for blocks of size 2^( 7) =       0.000464311788

      target function =                  N/A
              le_mean =     -16.911095979011
             les_mean =     286.312139255014
             stat err =       0.000453336495
             autocorr =       1.257073070046
              std dev =       0.571814836446
             le_variance =       0.326972207179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955534090
                                         uncertainty =       0.003327945123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955534090
                                         uncertainty =       0.003327945123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404334148
  error estimate for blocks of size 2^( 2) =       0.000416183504
  error estimate for blocks of size 2^( 3) =       0.000428419512
  error estimate for blocks of size 2^( 4) =       0.000439818452
  error estimate for blocks of size 2^( 5) =       0.000450512364
  error estimate for blocks of size 2^( 6) =       0.000458703378
  error estimate for blocks of size 2^( 7) =       0.000464311787

      target function =                  N/A
              le_mean =     -16.911095979008
             les_mean =     286.312139254449
             stat err =       0.000453336495
             autocorr =       1.257073070650
              std dev =       0.571814836026
             le_variance =       0.326972206699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955533670
                                         uncertainty =       0.003327945121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326955533670
                                         uncertainty =       0.003327945121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404334148
  error estimate for blocks of size 2^( 2) =       0.000416183503
  error estimate for blocks of size 2^( 3) =       0.000428419512
  error estimate for blocks of size 2^( 4) =       0.000439818451
  error estimate for blocks of size 2^( 5) =       0.000450512364
  error estimate for blocks of size 2^( 6) =       0.000458703378
  error estimate for blocks of size 2^( 7) =       0.000464311787

      target function =                  N/A
              le_mean =     -16.911095979006
             les_mean =     286.312139253954
             stat err =       0.000453336495
             autocorr =       1.257073071187
              std dev =       0.571814835658
             le_variance =       0.326972206279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911095979006        initial
     1.4901e+05     1.4901e+06             1.7885e-09       -16.911095979011  <--
     5.9605e+05     5.9605e+06             4.4712e-10       -16.911095979008
     2.3842e+06     2.3842e+07             1.1178e-10       -16.911095979006

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 3.9931e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9438
    reference variance = 0.356958
====================================================
  Execution time = 2.5724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4064e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340623332394
                                         uncertainty =       0.009855510783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340623332394
                                         uncertainty =       0.009855510783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412700020
  error estimate for blocks of size 2^( 2) =       0.000423832933
  error estimate for blocks of size 2^( 3) =       0.000434602061
  error estimate for blocks of size 2^( 4) =       0.000446083723
  error estimate for blocks of size 2^( 5) =       0.000455937062
  error estimate for blocks of size 2^( 6) =       0.000461988638
  error estimate for blocks of size 2^( 7) =       0.000465905523

      target function =                  N/A
              le_mean =     -16.911221885481
             les_mean =     286.330068102788
             stat err =       0.000457478737
             autocorr =       1.228776355782
              std dev =       0.583645965584
             le_variance =       0.340642613143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691122188548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911221885481       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911221885486       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911221885481       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911221885484       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911221885516       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911221885506       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911221885514       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911221885513       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.634381e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911221885481       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911221885482       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911221885481       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911221885483       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911221885567       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911221885507       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911221885511       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911221885490       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.658596e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911221885481       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911221885481       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911221885481       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911221885347       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911221885402       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911221885607       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911221885582       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911221885073       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.146490e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2308e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9631
    reference variance = 0.274242
====================================================
  Execution time = 2.7230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4253e-01
  Total weights = 2.0000e+06
  Execution time = 2.9676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485087715
                                         uncertainty =       0.009148094245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485087715
                                         uncertainty =       0.009148094245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413844810
  error estimate for blocks of size 2^( 2) =       0.000425704554
  error estimate for blocks of size 2^( 3) =       0.000437703366
  error estimate for blocks of size 2^( 4) =       0.000449894098
  error estimate for blocks of size 2^( 5) =       0.000460666570
  error estimate for blocks of size 2^( 6) =       0.000470366960
  error estimate for blocks of size 2^( 7) =       0.000477583956

      target function =                  N/A
              le_mean =     -16.910536484603
             les_mean =     286.308779079427
             stat err =       0.000464627896
             autocorr =       1.260478770199
              std dev =       0.585264943072
             le_variance =       0.342535053589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485091162
                                         uncertainty =       0.009148094383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485091162
                                         uncertainty =       0.009148094383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413844812
  error estimate for blocks of size 2^( 2) =       0.000425704556
  error estimate for blocks of size 2^( 3) =       0.000437703368
  error estimate for blocks of size 2^( 4) =       0.000449894099
  error estimate for blocks of size 2^( 5) =       0.000460666571
  error estimate for blocks of size 2^( 6) =       0.000470366961
  error estimate for blocks of size 2^( 7) =       0.000477583958

      target function =                  N/A
              le_mean =     -16.910536484577
             les_mean =     286.308779081994
             stat err =       0.000464627897
             autocorr =       1.260478766500
              std dev =       0.585264946018
             le_variance =       0.342535057037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485089438
                                         uncertainty =       0.009148094314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485089438
                                         uncertainty =       0.009148094314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413844811
  error estimate for blocks of size 2^( 2) =       0.000425704555
  error estimate for blocks of size 2^( 3) =       0.000437703367
  error estimate for blocks of size 2^( 4) =       0.000449894098
  error estimate for blocks of size 2^( 5) =       0.000460666571
  error estimate for blocks of size 2^( 6) =       0.000470366960
  error estimate for blocks of size 2^( 7) =       0.000477583957

      target function =                  N/A
              le_mean =     -16.910536484590
             les_mean =     286.308779080710
             stat err =       0.000464627897
             autocorr =       1.260478768350
              std dev =       0.585264944545
             le_variance =       0.342535055313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485087930
                                         uncertainty =       0.009148094253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485087930
                                         uncertainty =       0.009148094253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413844810
  error estimate for blocks of size 2^( 2) =       0.000425704554
  error estimate for blocks of size 2^( 3) =       0.000437703366
  error estimate for blocks of size 2^( 4) =       0.000449894098
  error estimate for blocks of size 2^( 5) =       0.000460666570
  error estimate for blocks of size 2^( 6) =       0.000470366960
  error estimate for blocks of size 2^( 7) =       0.000477583956

      target function =                  N/A
              le_mean =     -16.910536484602
             les_mean =     286.308779079587
             stat err =       0.000464627896
             autocorr =       1.260478769966
              std dev =       0.585264943256
             le_variance =       0.342535053805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910536484603        initial  <--
     3.7253e+04     3.7253e+05             6.6344e-09       -16.910536484577
     1.4901e+05     1.4901e+06             1.6586e-09       -16.910536484590
     5.9605e+05     5.9605e+06             4.1465e-10       -16.910536484602

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1204
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.981
    reference variance = 0.431538
====================================================
  Execution time = 2.5595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2860e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328670442669
                                         uncertainty =       0.003315048910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328670442669
                                         uncertainty =       0.003315048910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405336727
  error estimate for blocks of size 2^( 2) =       0.000416918257
  error estimate for blocks of size 2^( 3) =       0.000429730834
  error estimate for blocks of size 2^( 4) =       0.000441718510
  error estimate for blocks of size 2^( 5) =       0.000452549148
  error estimate for blocks of size 2^( 6) =       0.000460955432
  error estimate for blocks of size 2^( 7) =       0.000466729078

      target function =                  N/A
              le_mean =     -16.910409812000
             les_mean =     286.290555570611
             stat err =       0.000455488042
             autocorr =       1.262763575552
              std dev =       0.573232697187
             le_variance =       0.328595725124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691040981200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910409812000       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910409812000       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910409812000       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910409812000       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910409811968       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910409811682       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910409812284       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910409812171       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.768687e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910409812000       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910409812000       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910409812000       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910409812094       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910409812112       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910409810920       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910409810629       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910409811965       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.942170e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910409812000       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910409812000       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910409812000       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910409812000       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910409811993       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910409812179       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910409814950       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910409807081       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.855437e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2259e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632688e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.7434
    reference variance = 2.01167
====================================================
  Execution time = 2.5341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3066e-01
  Total weights = 2.0000e+06
  Execution time = 2.9613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884080
                                         uncertainty =       0.004493044667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884080
                                         uncertainty =       0.004493044667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406608405
  error estimate for blocks of size 2^( 2) =       0.000418283399
  error estimate for blocks of size 2^( 3) =       0.000430928212
  error estimate for blocks of size 2^( 4) =       0.000443275256
  error estimate for blocks of size 2^( 5) =       0.000454226569
  error estimate for blocks of size 2^( 6) =       0.000462196881
  error estimate for blocks of size 2^( 7) =       0.000464741336

      target function =                  N/A
              le_mean =     -16.910284960099
             les_mean =     286.288398056285
             stat err =       0.000456110010
             autocorr =       1.258306687520
              std dev =       0.575031120775
             le_variance =       0.330660789860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884529
                                         uncertainty =       0.004493044670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884529
                                         uncertainty =       0.004493044670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406608405
  error estimate for blocks of size 2^( 2) =       0.000418283399
  error estimate for blocks of size 2^( 3) =       0.000430928213
  error estimate for blocks of size 2^( 4) =       0.000443275256
  error estimate for blocks of size 2^( 5) =       0.000454226569
  error estimate for blocks of size 2^( 6) =       0.000462196881
  error estimate for blocks of size 2^( 7) =       0.000464741336

      target function =                  N/A
              le_mean =     -16.910284960100
             les_mean =     286.288398056775
             stat err =       0.000456110011
             autocorr =       1.258306687125
              std dev =       0.575031121165
             le_variance =       0.330660790308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884305
                                         uncertainty =       0.004493044669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884305
                                         uncertainty =       0.004493044669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406608405
  error estimate for blocks of size 2^( 2) =       0.000418283399
  error estimate for blocks of size 2^( 3) =       0.000430928212
  error estimate for blocks of size 2^( 4) =       0.000443275256
  error estimate for blocks of size 2^( 5) =       0.000454226569
  error estimate for blocks of size 2^( 6) =       0.000462196881
  error estimate for blocks of size 2^( 7) =       0.000464741336

      target function =                  N/A
              le_mean =     -16.910284960100
             les_mean =     286.288398056530
             stat err =       0.000456110011
             autocorr =       1.258306687326
              std dev =       0.575031120970
             le_variance =       0.330660790084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884108
                                         uncertainty =       0.004493044667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330648884108
                                         uncertainty =       0.004493044667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406608405
  error estimate for blocks of size 2^( 2) =       0.000418283399
  error estimate for blocks of size 2^( 3) =       0.000430928212
  error estimate for blocks of size 2^( 4) =       0.000443275256
  error estimate for blocks of size 2^( 5) =       0.000454226569
  error estimate for blocks of size 2^( 6) =       0.000462196881
  error estimate for blocks of size 2^( 7) =       0.000464741336

      target function =                  N/A
              le_mean =     -16.910284960099
             les_mean =     286.288398056315
             stat err =       0.000456110010
             autocorr =       1.258306687504
              std dev =       0.575031120799
             le_variance =       0.330660789887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910284960099        initial
     3.7253e+05     3.7253e+06             7.7687e-10       -16.910284960100  <--
     1.4901e+06     1.4901e+07             1.9422e-10       -16.910284960100
     5.9605e+06     5.9605e+07             4.8554e-11       -16.910284960099

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 4.0205e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.300273
====================================================
  Execution time = 2.5587e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3127e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331269654462
                                         uncertainty =       0.003808523469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331269654462
                                         uncertainty =       0.003808523469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406982750
  error estimate for blocks of size 2^( 2) =       0.000418995390
  error estimate for blocks of size 2^( 3) =       0.000431665838
  error estimate for blocks of size 2^( 4) =       0.000444696636
  error estimate for blocks of size 2^( 5) =       0.000456199852
  error estimate for blocks of size 2^( 6) =       0.000466642209
  error estimate for blocks of size 2^( 7) =       0.000468079616

      target function =                  N/A
              le_mean =     -16.910574176428
             les_mean =     286.298788728409
             stat err =       0.000458904578
             autocorr =       1.271430944154
              std dev =       0.575560524690
             le_variance =       0.331269917581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691057417643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910574176428       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910574176430       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910574176444       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910574176454       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910574176451       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910574176415       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910574176461       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910574176402       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.872735e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910574176428       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910574176428       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910574176432       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910574176435       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910574176422       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910574176621       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910574176631       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910574176335       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.181841e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910574176428       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910574176428       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910574176429       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910574176429       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910574176430       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910574176187       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910574176387       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910574176422       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.795460e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2301e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9795
    reference variance = 0.909057
====================================================
  Execution time = 2.5119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3341e-01
  Total weights = 2.0000e+06
  Execution time = 2.9761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134474222
                                         uncertainty =       0.004429268742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134474222
                                         uncertainty =       0.004429268742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408297794
  error estimate for blocks of size 2^( 2) =       0.000420010278
  error estimate for blocks of size 2^( 3) =       0.000431690015
  error estimate for blocks of size 2^( 4) =       0.000443205932
  error estimate for blocks of size 2^( 5) =       0.000453380813
  error estimate for blocks of size 2^( 6) =       0.000461022500
  error estimate for blocks of size 2^( 7) =       0.000465687462

      target function =                  N/A
              le_mean =     -16.911227525595
             les_mean =     286.323030433712
             stat err =       0.000455824177
             autocorr =       1.246351797744
              std dev =       0.577420278464
             le_variance =       0.333414177981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134477035
                                         uncertainty =       0.004429268778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134477035
                                         uncertainty =       0.004429268778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408297796
  error estimate for blocks of size 2^( 2) =       0.000420010280
  error estimate for blocks of size 2^( 3) =       0.000431690017
  error estimate for blocks of size 2^( 4) =       0.000443205934
  error estimate for blocks of size 2^( 5) =       0.000453380814
  error estimate for blocks of size 2^( 6) =       0.000461022502
  error estimate for blocks of size 2^( 7) =       0.000465687463

      target function =                  N/A
              le_mean =     -16.911227525582
             les_mean =     286.323030436099
             stat err =       0.000455824178
             autocorr =       1.246351795459
              std dev =       0.577420280902
             le_variance =       0.333414180797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134475629
                                         uncertainty =       0.004429268760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134475629
                                         uncertainty =       0.004429268760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408297795
  error estimate for blocks of size 2^( 2) =       0.000420010279
  error estimate for blocks of size 2^( 3) =       0.000431690016
  error estimate for blocks of size 2^( 4) =       0.000443205933
  error estimate for blocks of size 2^( 5) =       0.000453380813
  error estimate for blocks of size 2^( 6) =       0.000461022501
  error estimate for blocks of size 2^( 7) =       0.000465687462

      target function =                  N/A
              le_mean =     -16.911227525589
             les_mean =     286.323030434905
             stat err =       0.000455824177
             autocorr =       1.246351796601
              std dev =       0.577420279683
             le_variance =       0.333414179389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134474398
                                         uncertainty =       0.004429268745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333134474398
                                         uncertainty =       0.004429268745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408297795
  error estimate for blocks of size 2^( 2) =       0.000420010279
  error estimate for blocks of size 2^( 3) =       0.000431690015
  error estimate for blocks of size 2^( 4) =       0.000443205932
  error estimate for blocks of size 2^( 5) =       0.000453380813
  error estimate for blocks of size 2^( 6) =       0.000461022501
  error estimate for blocks of size 2^( 7) =       0.000465687462

      target function =                  N/A
              le_mean =     -16.911227525594
             les_mean =     286.323030433861
             stat err =       0.000455824177
             autocorr =       1.246351797597
              std dev =       0.577420278616
             le_variance =       0.333414178157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911227525595        initial  <--
     9.3132e+04     9.3132e+05             2.8727e-09       -16.911227525582
     3.7253e+05     3.7253e+06             7.1818e-10       -16.911227525589
     1.4901e+06     1.4901e+07             1.7955e-10       -16.911227525594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0524
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.2305
====================================================
  Execution time = 2.5590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2501e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325158272583
                                         uncertainty =       0.004417372762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325158272583
                                         uncertainty =       0.004417372762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403116382
  error estimate for blocks of size 2^( 2) =       0.000414787773
  error estimate for blocks of size 2^( 3) =       0.000426951327
  error estimate for blocks of size 2^( 4) =       0.000438893202
  error estimate for blocks of size 2^( 5) =       0.000449066714
  error estimate for blocks of size 2^( 6) =       0.000458428867
  error estimate for blocks of size 2^( 7) =       0.000464784991

      target function =                  N/A
              le_mean =     -16.911333354875
             les_mean =     286.318201312836
             stat err =       0.000452793444
             autocorr =       1.261651369220
              std dev =       0.570092655291
             le_variance =       0.325005635616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691133335488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911333354875       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911333354876       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911333354876       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911333354870       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911333354524       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911333354777       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911333354944       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911333353178       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.164478e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911333354875       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911333354875       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911333354876       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911333354646       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911333355424       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911333354045       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911333357644       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911333351941       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.911179e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911333354875       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911333354875       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911333354875       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911333354789       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911333353885       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911333357133       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911333351717       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911333350736       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.977794e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2205e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8673
    reference variance = 0.316181
====================================================
  Execution time = 2.5302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3256e-01
  Total weights = 2.0000e+06
  Execution time = 2.9670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439292
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439292
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407776193
  error estimate for blocks of size 2^( 2) =       0.000419035259
  error estimate for blocks of size 2^( 3) =       0.000431086362
  error estimate for blocks of size 2^( 4) =       0.000442740938
  error estimate for blocks of size 2^( 5) =       0.000451861549
  error estimate for blocks of size 2^( 6) =       0.000459137334
  error estimate for blocks of size 2^( 7) =       0.000462585799

      target function =                  N/A
              le_mean =     -16.910314192672
             les_mean =     286.291288775486
             stat err =       0.000454081405
             autocorr =       1.240005757500
              std dev =       0.576682622318
             le_variance =       0.332562846883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439284
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439284
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407776193
  error estimate for blocks of size 2^( 2) =       0.000419035259
  error estimate for blocks of size 2^( 3) =       0.000431086362
  error estimate for blocks of size 2^( 4) =       0.000442740938
  error estimate for blocks of size 2^( 5) =       0.000451861549
  error estimate for blocks of size 2^( 6) =       0.000459137334
  error estimate for blocks of size 2^( 7) =       0.000462585799

      target function =                  N/A
              le_mean =     -16.910314192671
             les_mean =     286.291288775456
             stat err =       0.000454081405
             autocorr =       1.240005757483
              std dev =       0.576682622310
             le_variance =       0.332562846875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439288
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439288
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407776193
  error estimate for blocks of size 2^( 2) =       0.000419035259
  error estimate for blocks of size 2^( 3) =       0.000431086362
  error estimate for blocks of size 2^( 4) =       0.000442740938
  error estimate for blocks of size 2^( 5) =       0.000451861549
  error estimate for blocks of size 2^( 6) =       0.000459137334
  error estimate for blocks of size 2^( 7) =       0.000462585799

      target function =                  N/A
              le_mean =     -16.910314192672
             les_mean =     286.291288775471
             stat err =       0.000454081405
             autocorr =       1.240005757490
              std dev =       0.576682622314
             le_variance =       0.332562846879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439291
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332601439291
                                         uncertainty =       0.004657982423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407776193
  error estimate for blocks of size 2^( 2) =       0.000419035259
  error estimate for blocks of size 2^( 3) =       0.000431086362
  error estimate for blocks of size 2^( 4) =       0.000442740938
  error estimate for blocks of size 2^( 5) =       0.000451861549
  error estimate for blocks of size 2^( 6) =       0.000459137334
  error estimate for blocks of size 2^( 7) =       0.000462585799

      target function =                  N/A
              le_mean =     -16.910314192672
             les_mean =     286.291288775484
             stat err =       0.000454081405
             autocorr =       1.240005757501
              std dev =       0.576682622317
             le_variance =       0.332562846883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910314192672        initial  <--
     9.3132e+05     9.3132e+06             3.1645e-10       -16.910314192671
     3.7253e+06     3.7253e+07             7.9112e-11       -16.910314192672
     1.4901e+07     1.4901e+08             1.9778e-11       -16.910314192672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.2289
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9483
    reference variance = 0.234789
====================================================
  Execution time = 2.5638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2825e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328342964474
                                         uncertainty =       0.003371620119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328342964474
                                         uncertainty =       0.003371620119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405125235
  error estimate for blocks of size 2^( 2) =       0.000416719755
  error estimate for blocks of size 2^( 3) =       0.000428566609
  error estimate for blocks of size 2^( 4) =       0.000439971499
  error estimate for blocks of size 2^( 5) =       0.000449550291
  error estimate for blocks of size 2^( 6) =       0.000457066930
  error estimate for blocks of size 2^( 7) =       0.000460491973

      target function =                  N/A
              le_mean =     -16.910795776923
             les_mean =     286.303266555967
             stat err =       0.000451770173
             autocorr =       1.243530718674
              std dev =       0.572933601119
             le_variance =       0.328252911292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691079577692e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910795776923       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910795776923       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910795776923       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910795776923       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910795772288       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910795776725       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910795780013       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910795782692       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.462350e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910795776923       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910795776923       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910795776923       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910795776954       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910795669939       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910795769028       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910795770712       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910795782380       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 8.655916e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910795776923       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910795776923       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910795776923       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910795768908       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910795782252       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910795816233       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910795814066       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910795766846       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 2.163963e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2188e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.208816
====================================================
  Execution time = 2.7207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3942e-01
  Total weights = 2.0000e+06
  Execution time = 2.9680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654646
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654646
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411957537
  error estimate for blocks of size 2^( 2) =       0.000424002632
  error estimate for blocks of size 2^( 3) =       0.000436272688
  error estimate for blocks of size 2^( 4) =       0.000448497165
  error estimate for blocks of size 2^( 5) =       0.000459690144
  error estimate for blocks of size 2^( 6) =       0.000470040410
  error estimate for blocks of size 2^( 7) =       0.000474728607

      target function =                  N/A
              le_mean =     -16.911367658289
             les_mean =     286.333773928053
             stat err =       0.000463239081
             autocorr =       1.264461114940
              std dev =       0.582595935406
             le_variance =       0.339418023952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654660
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654660
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411957537
  error estimate for blocks of size 2^( 2) =       0.000424002632
  error estimate for blocks of size 2^( 3) =       0.000436272688
  error estimate for blocks of size 2^( 4) =       0.000448497165
  error estimate for blocks of size 2^( 5) =       0.000459690144
  error estimate for blocks of size 2^( 6) =       0.000470040410
  error estimate for blocks of size 2^( 7) =       0.000474728607

      target function =                  N/A
              le_mean =     -16.911367658289
             les_mean =     286.333773928067
             stat err =       0.000463239081
             autocorr =       1.264461114921
              std dev =       0.582595935418
             le_variance =       0.339418023966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654653
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654653
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411957537
  error estimate for blocks of size 2^( 2) =       0.000424002632
  error estimate for blocks of size 2^( 3) =       0.000436272688
  error estimate for blocks of size 2^( 4) =       0.000448497165
  error estimate for blocks of size 2^( 5) =       0.000459690144
  error estimate for blocks of size 2^( 6) =       0.000470040410
  error estimate for blocks of size 2^( 7) =       0.000474728607

      target function =                  N/A
              le_mean =     -16.911367658289
             les_mean =     286.333773928060
             stat err =       0.000463239081
             autocorr =       1.264461114919
              std dev =       0.582595935412
             le_variance =       0.339418023959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654647
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339451654647
                                         uncertainty =       0.006318419260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411957537
  error estimate for blocks of size 2^( 2) =       0.000424002632
  error estimate for blocks of size 2^( 3) =       0.000436272688
  error estimate for blocks of size 2^( 4) =       0.000448497165
  error estimate for blocks of size 2^( 5) =       0.000459690144
  error estimate for blocks of size 2^( 6) =       0.000470040410
  error estimate for blocks of size 2^( 7) =       0.000474728607

      target function =                  N/A
              le_mean =     -16.911367658289
             les_mean =     286.333773928054
             stat err =       0.000463239081
             autocorr =       1.264461114934
              std dev =       0.582595935407
             le_variance =       0.339418023952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911367658289        initial
     9.3132e+06     9.3132e+07             3.4624e-11       -16.911367658289
     3.7253e+07     3.7253e+08             8.6559e-12       -16.911367658289
     1.4901e+08     1.4901e+09             2.1640e-12       -16.911367658289  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+08     and shift_s =   1.4901e+09
*****************************************************************************

  Execution time = 4.2098e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8686
    reference variance = 0.364343
====================================================
  Execution time = 2.5636e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340495516104
                                         uncertainty =       0.007033363910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340495516104
                                         uncertainty =       0.007033363910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412646121
  error estimate for blocks of size 2^( 2) =       0.000424570233
  error estimate for blocks of size 2^( 3) =       0.000436459494
  error estimate for blocks of size 2^( 4) =       0.000447907679
  error estimate for blocks of size 2^( 5) =       0.000458145107
  error estimate for blocks of size 2^( 6) =       0.000464926081
  error estimate for blocks of size 2^( 7) =       0.000471925716

      target function =                  N/A
              le_mean =     -16.912069964253
             les_mean =     286.358663948559
             stat err =       0.000460726146
             autocorr =       1.246608784426
              std dev =       0.583569741379
             le_variance =       0.340553643053


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691206996425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912069964253       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912069964253       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912069964253       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912069964253       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912069959460       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912069959462       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912069957280       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912069955949       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.385526e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912069964253       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912069964253       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912069964253       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912069964253       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912069964253       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912070780310       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912070072722       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912069498830       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.596271e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912069964253       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912069964253       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912069964253       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912070034362       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912070262552       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912069326086       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912069929599       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912069883715       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 3.991043e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2172e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.207514
====================================================
  Execution time = 2.5171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2346e-01
  Total weights = 2.0000e+06
  Execution time = 2.9602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545701
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545701
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155288
  error estimate for blocks of size 2^( 2) =       0.000413862791
  error estimate for blocks of size 2^( 3) =       0.000426559168
  error estimate for blocks of size 2^( 4) =       0.000438559375
  error estimate for blocks of size 2^( 5) =       0.000450388880
  error estimate for blocks of size 2^( 6) =       0.000459775351
  error estimate for blocks of size 2^( 7) =       0.000464004671

      target function =                  N/A
              le_mean =     -16.911589133026
             les_mean =     286.325304593307
             stat err =       0.000453182069
             autocorr =       1.269865923952
              std dev =       0.568733461971
             le_variance =       0.323457750766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545702
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545702
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155288
  error estimate for blocks of size 2^( 2) =       0.000413862791
  error estimate for blocks of size 2^( 3) =       0.000426559168
  error estimate for blocks of size 2^( 4) =       0.000438559375
  error estimate for blocks of size 2^( 5) =       0.000450388880
  error estimate for blocks of size 2^( 6) =       0.000459775351
  error estimate for blocks of size 2^( 7) =       0.000464004671

      target function =                  N/A
              le_mean =     -16.911589133026
             les_mean =     286.325304593307
             stat err =       0.000453182069
             autocorr =       1.269865923953
              std dev =       0.568733461972
             le_variance =       0.323457750766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545701
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545701
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155288
  error estimate for blocks of size 2^( 2) =       0.000413862791
  error estimate for blocks of size 2^( 3) =       0.000426559168
  error estimate for blocks of size 2^( 4) =       0.000438559375
  error estimate for blocks of size 2^( 5) =       0.000450388880
  error estimate for blocks of size 2^( 6) =       0.000459775351
  error estimate for blocks of size 2^( 7) =       0.000464004671

      target function =                  N/A
              le_mean =     -16.911589133026
             les_mean =     286.325304593307
             stat err =       0.000453182069
             autocorr =       1.269865923943
              std dev =       0.568733461972
             le_variance =       0.323457750766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545701
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537545701
                                         uncertainty =       0.002685115076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155288
  error estimate for blocks of size 2^( 2) =       0.000413862791
  error estimate for blocks of size 2^( 3) =       0.000426559168
  error estimate for blocks of size 2^( 4) =       0.000438559375
  error estimate for blocks of size 2^( 5) =       0.000450388880
  error estimate for blocks of size 2^( 6) =       0.000459775351
  error estimate for blocks of size 2^( 7) =       0.000464004671

      target function =                  N/A
              le_mean =     -16.911589133026
             les_mean =     286.325304593307
             stat err =       0.000453182069
             autocorr =       1.269865923949
              std dev =       0.568733461971
             le_variance =       0.323457750766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911589133026        initial  <--
     3.7253e+07     3.7253e+08             6.3855e-12       -16.911589133026
     1.4901e+08     1.4901e+09             1.5963e-12       -16.911589133026
     5.9605e+08     5.9605e+09             3.9910e-13       -16.911589133026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0435
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8967
    reference variance = 0.310738
====================================================
  Execution time = 2.5468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2563e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325609040282
                                         uncertainty =       0.002723146798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325609040282
                                         uncertainty =       0.002723146798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403504964
  error estimate for blocks of size 2^( 2) =       0.000415308991
  error estimate for blocks of size 2^( 3) =       0.000428163405
  error estimate for blocks of size 2^( 4) =       0.000439374943
  error estimate for blocks of size 2^( 5) =       0.000449731566
  error estimate for blocks of size 2^( 6) =       0.000456806072
  error estimate for blocks of size 2^( 7) =       0.000462387574

      target function =                  N/A
              le_mean =     -16.910787330219
             les_mean =     286.300360476770
             stat err =       0.000452075039
             autocorr =       1.255229948834
              std dev =       0.570642192345
             le_variance =       0.325632511684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691078733022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910787330219       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910787330219       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910787330219       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910787315267       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910787328204       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910787252132       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910787087531       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910787202830       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 7.792645e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910787330219       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910787330219       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910787330219       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910787330219       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910786964147       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910787230712       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910787303367       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910786180060       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 1.948307e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910787330219       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910787330219       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910787330219       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910787594102       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910787516708       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910786560020       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910789496437       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910783081849       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+09 is 4.872076e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2090e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9457
    reference variance = 0.154427
====================================================
  Execution time = 2.4935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2840e-01
  Total weights = 2.0000e+06
  Execution time = 2.9595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820308
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820308
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405213811
  error estimate for blocks of size 2^( 2) =       0.000417114980
  error estimate for blocks of size 2^( 3) =       0.000429467346
  error estimate for blocks of size 2^( 4) =       0.000441320268
  error estimate for blocks of size 2^( 5) =       0.000451354240
  error estimate for blocks of size 2^( 6) =       0.000460710122
  error estimate for blocks of size 2^( 7) =       0.000466487485

      target function =                  N/A
              le_mean =     -16.911200334317
             les_mean =     286.317093047778
             stat err =       0.000454968029
             autocorr =       1.260646379801
              std dev =       0.573058866599
             le_variance =       0.328396464588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820307
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820307
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405213811
  error estimate for blocks of size 2^( 2) =       0.000417114980
  error estimate for blocks of size 2^( 3) =       0.000429467346
  error estimate for blocks of size 2^( 4) =       0.000441320268
  error estimate for blocks of size 2^( 5) =       0.000451354240
  error estimate for blocks of size 2^( 6) =       0.000460710122
  error estimate for blocks of size 2^( 7) =       0.000466487485

      target function =                  N/A
              le_mean =     -16.911200334317
             les_mean =     286.317093047778
             stat err =       0.000454968029
             autocorr =       1.260646379803
              std dev =       0.573058866599
             le_variance =       0.328396464588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820307
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820307
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405213811
  error estimate for blocks of size 2^( 2) =       0.000417114980
  error estimate for blocks of size 2^( 3) =       0.000429467346
  error estimate for blocks of size 2^( 4) =       0.000441320268
  error estimate for blocks of size 2^( 5) =       0.000451354240
  error estimate for blocks of size 2^( 6) =       0.000460710122
  error estimate for blocks of size 2^( 7) =       0.000466487485

      target function =                  N/A
              le_mean =     -16.911200334317
             les_mean =     286.317093047778
             stat err =       0.000454968029
             autocorr =       1.260646379804
              std dev =       0.573058866599
             le_variance =       0.328396464588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820308
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328459820308
                                         uncertainty =       0.003834538292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405213811
  error estimate for blocks of size 2^( 2) =       0.000417114980
  error estimate for blocks of size 2^( 3) =       0.000429467346
  error estimate for blocks of size 2^( 4) =       0.000441320268
  error estimate for blocks of size 2^( 5) =       0.000451354240
  error estimate for blocks of size 2^( 6) =       0.000460710122
  error estimate for blocks of size 2^( 7) =       0.000466487485

      target function =                  N/A
              le_mean =     -16.911200334317
             les_mean =     286.317093047778
             stat err =       0.000454968029
             autocorr =       1.260646379801
              std dev =       0.573058866599
             le_variance =       0.328396464588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911200334317        initial  <--
     3.7253e+08     3.7253e+09             7.7926e-13       -16.911200334317
     1.4901e+09     1.4901e+10             1.9483e-13       -16.911200334317
     5.9605e+09     5.9605e+10             4.8721e-14       -16.911200334317

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7992
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8583
    reference variance = 0.547353
====================================================
  Execution time = 2.5509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5994e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360116210415
                                         uncertainty =       0.022658762831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360116210415
                                         uncertainty =       0.022658762831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424225994
  error estimate for blocks of size 2^( 2) =       0.000435372015
  error estimate for blocks of size 2^( 3) =       0.000447080711
  error estimate for blocks of size 2^( 4) =       0.000458270306
  error estimate for blocks of size 2^( 5) =       0.000467110015
  error estimate for blocks of size 2^( 6) =       0.000473112277
  error estimate for blocks of size 2^( 7) =       0.000479548554

      target function =                  N/A
              le_mean =     -16.911009153178
             les_mean =     286.342165786104
             stat err =       0.000469510288
             autocorr =       1.224886012067
              std dev =       0.599946153585
             le_variance =       0.359935387202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691100915318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911009153178       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911009153178       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911009153178       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911010395477       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911009553039       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911006254813       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911008581980       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911009556236       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 7.956834e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911009153178       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911009153178       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911009153178       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911009153178       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911015157161       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911005615939       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911007661009       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911009876886       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 1.994984e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911009153178       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911009153178       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911009153178       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911009153178       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910984724220       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911005854837       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911004438943       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911015170722       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911062760752       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911010177994       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910870624262       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910950038442       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910676706630       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911788893688       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908559463001       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911913111987       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908475920288       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910728773403       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909900777284       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911938431993       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904747739544       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.915247350865       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911978824027       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908709257436       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903275162388       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.898250565877       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.911113472252       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908887349140       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.912053403625       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.915769016351       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.907282252692       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.904550454875       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.910090179479       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.901384640774       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.906920357582       residual = 2.28e-03           smallest_sin_value = 9.97e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+10 is 4.994437e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2130e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8893
    reference variance = 0.446336
====================================================
  Execution time = 2.5400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2892e-01
  Total weights = 2.0000e+06
  Execution time = 2.9679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405538509
  error estimate for blocks of size 2^( 2) =       0.000417366225
  error estimate for blocks of size 2^( 3) =       0.000429622663
  error estimate for blocks of size 2^( 4) =       0.000441741837
  error estimate for blocks of size 2^( 5) =       0.000451894845
  error estimate for blocks of size 2^( 6) =       0.000460405989
  error estimate for blocks of size 2^( 7) =       0.000465793535

      target function =                  N/A
              le_mean =     -16.911553293354
             les_mean =     286.329557593976
             stat err =       0.000454959052
             autocorr =       1.258578823371
              std dev =       0.573518059435
             le_variance =       0.328922964498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405538509
  error estimate for blocks of size 2^( 2) =       0.000417366225
  error estimate for blocks of size 2^( 3) =       0.000429622663
  error estimate for blocks of size 2^( 4) =       0.000441741837
  error estimate for blocks of size 2^( 5) =       0.000451894845
  error estimate for blocks of size 2^( 6) =       0.000460405989
  error estimate for blocks of size 2^( 7) =       0.000465793535

      target function =                  N/A
              le_mean =     -16.911553293354
             les_mean =     286.329557593976
             stat err =       0.000454959052
             autocorr =       1.258578823375
              std dev =       0.573518059435
             le_variance =       0.328922964498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405538509
  error estimate for blocks of size 2^( 2) =       0.000417366225
  error estimate for blocks of size 2^( 3) =       0.000429622663
  error estimate for blocks of size 2^( 4) =       0.000441741837
  error estimate for blocks of size 2^( 5) =       0.000451894845
  error estimate for blocks of size 2^( 6) =       0.000460405989
  error estimate for blocks of size 2^( 7) =       0.000465793535

      target function =                  N/A
              le_mean =     -16.911553293354
             les_mean =     286.329557593976
             stat err =       0.000454959052
             autocorr =       1.258578823369
              std dev =       0.573518059435
             le_variance =       0.328922964498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328875547602
                                         uncertainty =       0.004595154758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405538509
  error estimate for blocks of size 2^( 2) =       0.000417366225
  error estimate for blocks of size 2^( 3) =       0.000429622663
  error estimate for blocks of size 2^( 4) =       0.000441741837
  error estimate for blocks of size 2^( 5) =       0.000451894845
  error estimate for blocks of size 2^( 6) =       0.000460405989
  error estimate for blocks of size 2^( 7) =       0.000465793535

      target function =                  N/A
              le_mean =     -16.911553293354
             les_mean =     286.329557593976
             stat err =       0.000454959052
             autocorr =       1.258578823373
              std dev =       0.573518059435
             le_variance =       0.328922964498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911553293354        initial  <--
     3.7253e+09     3.7253e+10             7.9568e-14       -16.911553293354
     1.4901e+10     1.4901e+11             1.9950e-14       -16.911553293354
     5.9605e+10     5.9605e+11             4.9944e-15       -16.911553293354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.3126
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8636
    reference variance = 0.365617
====================================================
  Execution time = 2.5546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3169e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331808108143
                                         uncertainty =       0.004912652300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331808108143
                                         uncertainty =       0.004912652300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407241039
  error estimate for blocks of size 2^( 2) =       0.000419357718
  error estimate for blocks of size 2^( 3) =       0.000431385281
  error estimate for blocks of size 2^( 4) =       0.000442774392
  error estimate for blocks of size 2^( 5) =       0.000452227035
  error estimate for blocks of size 2^( 6) =       0.000459347547
  error estimate for blocks of size 2^( 7) =       0.000463644897

      target function =                  N/A
              le_mean =     -16.911739313583
             les_mean =     286.338616972824
             stat err =       0.000454498468
             autocorr =       1.245551740325
              std dev =       0.575925800860
             le_variance =       0.331690528096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691173931358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911739313583       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911739313583       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911739313583       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911739313583       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911758334823       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911752757521       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911749297042       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911740443693       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 7.578354e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911739313583       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911739313583       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911739313583       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911763073143       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911752064990       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911867989912       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911788895322       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911505912272       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911779876979       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.914107066389       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.913033564971       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.914998987385       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.913324239445       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911673693103       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.913216470073       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909319356171       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.917035922818       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910817327604       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.912167627604       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.914976447213       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.912163882645       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910074347750       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904892900386       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914019096784       residual = 6.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.919578197455       residual = 7.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908217353052       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.948085273699       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.918353376270       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.924399552123       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.899104591775       residual = 2.07e-02           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.957262123964       residual = 2.73e-01           smallest_sin_value = 9.92e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.896504454542       residual = 3.08e-02           smallest_sin_value = 9.92e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.40e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 1.862583e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911739313583       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911739313583       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911739313583       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911739313583       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911739313582       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911645449638       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.913722532155       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912441350181       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911658820597       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906542903337       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918542308244       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.902867550765       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.914228716529       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.930598169061       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.923855856738       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.955862868524       residual = 2.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.919496473093       residual = 8.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904960922282       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.915417650921       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.952239272038       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.920345912544       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.840600353535       residual = 6.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.921350831956       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.926405558141       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.914133913922       residual = 8.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.809545699711       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906498256159       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.016943686201       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.869968322495       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.896492591857       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.901594916100       residual = 6.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.907764189771       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.795665623329       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.842540410498       residual = 6.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.936782101478       residual = 6.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.953284419616       residual = 3.29e-01           smallest_sin_value = 9.97e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.59e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+11 is 3.945415e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2241e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9576
    reference variance = 0.263274
====================================================
  Execution time = 2.7076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2140e-01
  Total weights = 2.0000e+06
  Execution time = 2.9608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400871138
  error estimate for blocks of size 2^( 2) =       0.000412694999
  error estimate for blocks of size 2^( 3) =       0.000424591764
  error estimate for blocks of size 2^( 4) =       0.000435564355
  error estimate for blocks of size 2^( 5) =       0.000445825507
  error estimate for blocks of size 2^( 6) =       0.000453426412
  error estimate for blocks of size 2^( 7) =       0.000458131536

      target function =                  N/A
              le_mean =     -16.911428253977
             les_mean =     286.317800766624
             stat err =       0.000448236952
             autocorr =       1.250275543652
              std dev =       0.566917399547
             le_variance =       0.321395337909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400871138
  error estimate for blocks of size 2^( 2) =       0.000412694999
  error estimate for blocks of size 2^( 3) =       0.000424591764
  error estimate for blocks of size 2^( 4) =       0.000435564355
  error estimate for blocks of size 2^( 5) =       0.000445825507
  error estimate for blocks of size 2^( 6) =       0.000453426412
  error estimate for blocks of size 2^( 7) =       0.000458131536

      target function =                  N/A
              le_mean =     -16.911428253977
             les_mean =     286.317800766624
             stat err =       0.000448236952
             autocorr =       1.250275543650
              std dev =       0.566917399547
             le_variance =       0.321395337909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400871138
  error estimate for blocks of size 2^( 2) =       0.000412694999
  error estimate for blocks of size 2^( 3) =       0.000424591764
  error estimate for blocks of size 2^( 4) =       0.000435564355
  error estimate for blocks of size 2^( 5) =       0.000445825507
  error estimate for blocks of size 2^( 6) =       0.000453426412
  error estimate for blocks of size 2^( 7) =       0.000458131536

      target function =                  N/A
              le_mean =     -16.911428253977
             les_mean =     286.317800766624
             stat err =       0.000448236952
             autocorr =       1.250275543651
              std dev =       0.566917399547
             le_variance =       0.321395337909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321408023907
                                         uncertainty =       0.002942382980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400871138
  error estimate for blocks of size 2^( 2) =       0.000412694999
  error estimate for blocks of size 2^( 3) =       0.000424591764
  error estimate for blocks of size 2^( 4) =       0.000435564355
  error estimate for blocks of size 2^( 5) =       0.000445825507
  error estimate for blocks of size 2^( 6) =       0.000453426412
  error estimate for blocks of size 2^( 7) =       0.000458131536

      target function =                  N/A
              le_mean =     -16.911428253977
             les_mean =     286.317800766624
             stat err =       0.000448236952
             autocorr =       1.250275543652
              std dev =       0.566917399547
             le_variance =       0.321395337909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911428253977        initial  <--
     3.7253e+10     3.7253e+11             7.5784e-15       -16.911428253977
     1.4901e+11     1.4901e+12             1.8626e-15       -16.911428253977
     5.9605e+11     5.9605e+12             3.9454e-16       -16.911428253977

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9717
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8961
    reference variance = 0.197278
====================================================
  Execution time = 2.5619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4713e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347218788735
                                         uncertainty =       0.019099321208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347218788735
                                         uncertainty =       0.019099321208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416611102
  error estimate for blocks of size 2^( 2) =       0.000427963392
  error estimate for blocks of size 2^( 3) =       0.000439639824
  error estimate for blocks of size 2^( 4) =       0.000451368950
  error estimate for blocks of size 2^( 5) =       0.000461893850
  error estimate for blocks of size 2^( 6) =       0.000468573528
  error estimate for blocks of size 2^( 7) =       0.000472925049

      target function =                  N/A
              le_mean =     -16.911042135990
             les_mean =     286.330475571823
             stat err =       0.000463690344
             autocorr =       1.238780691400
              std dev =       0.589177070280
             le_variance =       0.347129620144


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691104213599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911042135990       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911042135990       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911042135990       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911217365991       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911085231676       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911017148702       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911039265038       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910478786977       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910926308818       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910669607945       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911325673164       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908646482988       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911385301749       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907427765855       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911463444313       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907956953066       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.917573494229       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910665292886       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910338653429       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904442648232       residual = 4.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.895963214475       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.916174604387       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.923715829902       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.913767680365       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.911714765983       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.903274720311       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.885382322297       residual = 8.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.911724506069       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909787672102       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.922206591330       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.799607753366       residual = 1.71e+00           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.926988890388       residual = 3.13e-02           smallest_sin_value = 9.91e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 7.055647e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911042135990       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911042135990       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.38e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911042135990       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911042135990       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.38e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2306e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 0.426353
====================================================
  Execution time = 2.5149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2863e-01
  Total weights = 2.0000e+06
  Execution time = 2.9553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405358832
  error estimate for blocks of size 2^( 2) =       0.000416851458
  error estimate for blocks of size 2^( 3) =       0.000429078155
  error estimate for blocks of size 2^( 4) =       0.000441133114
  error estimate for blocks of size 2^( 5) =       0.000451211199
  error estimate for blocks of size 2^( 6) =       0.000459932643
  error estimate for blocks of size 2^( 7) =       0.000466718333

      target function =                  N/A
              le_mean =     -16.910388695031
             les_mean =     286.289877217269
             stat err =       0.000454748822
             autocorr =       1.258530911613
              std dev =       0.573263957145
             le_variance =       0.328631564561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405358832
  error estimate for blocks of size 2^( 2) =       0.000416851458
  error estimate for blocks of size 2^( 3) =       0.000429078155
  error estimate for blocks of size 2^( 4) =       0.000441133114
  error estimate for blocks of size 2^( 5) =       0.000451211199
  error estimate for blocks of size 2^( 6) =       0.000459932643
  error estimate for blocks of size 2^( 7) =       0.000466718333

      target function =                  N/A
              le_mean =     -16.910388695031
             les_mean =     286.289877217269
             stat err =       0.000454748822
             autocorr =       1.258530911613
              std dev =       0.573263957145
             le_variance =       0.328631564561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405358832
  error estimate for blocks of size 2^( 2) =       0.000416851458
  error estimate for blocks of size 2^( 3) =       0.000429078155
  error estimate for blocks of size 2^( 4) =       0.000441133114
  error estimate for blocks of size 2^( 5) =       0.000451211199
  error estimate for blocks of size 2^( 6) =       0.000459932643
  error estimate for blocks of size 2^( 7) =       0.000466718333

      target function =                  N/A
              le_mean =     -16.910388695031
             les_mean =     286.289877217269
             stat err =       0.000454748822
             autocorr =       1.258530911613
              std dev =       0.573263957145
             le_variance =       0.328631564561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328550308148
                                         uncertainty =       0.004028048383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405358832
  error estimate for blocks of size 2^( 2) =       0.000416851458
  error estimate for blocks of size 2^( 3) =       0.000429078155
  error estimate for blocks of size 2^( 4) =       0.000441133114
  error estimate for blocks of size 2^( 5) =       0.000451211199
  error estimate for blocks of size 2^( 6) =       0.000459932643
  error estimate for blocks of size 2^( 7) =       0.000466718333

      target function =                  N/A
              le_mean =     -16.910388695031
             les_mean =     286.289877217269
             stat err =       0.000454748822
             autocorr =       1.258530911613
              std dev =       0.573263957145
             le_variance =       0.328631564561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910388695031        initial  <--
     3.7253e+11     3.7253e+12             7.0556e-16       -16.910388695031
     1.4901e+12     1.4901e+13             0.0000e+00       -16.910388695031
     5.9605e+12     5.9605e+13             0.0000e+00       -16.910388695031

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0395
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.937
    reference variance = 0.303332
====================================================
  Execution time = 2.5420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3255e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332639707837
                                         uncertainty =       0.006316708414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332639707837
                                         uncertainty =       0.006316708414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407771395
  error estimate for blocks of size 2^( 2) =       0.000419408729
  error estimate for blocks of size 2^( 3) =       0.000431729186
  error estimate for blocks of size 2^( 4) =       0.000443303023
  error estimate for blocks of size 2^( 5) =       0.000454330338
  error estimate for blocks of size 2^( 6) =       0.000462507717
  error estimate for blocks of size 2^( 7) =       0.000467617190

      target function =                  N/A
              le_mean =     -16.910838739926
             les_mean =     286.309021742421
             stat err =       0.000456939567
             autocorr =       1.255694575304
              std dev =       0.576675836948
             le_variance =       0.332555020920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691083873993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910838739926       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910838739926       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910838739926       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910838739926       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910838739926       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910838739926       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2131e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9457
    reference variance = 0.365114
====================================================
  Execution time = 2.5272e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3910e-01
  Total weights = 2.0000e+06
  Execution time = 2.9624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411763578
  error estimate for blocks of size 2^( 2) =       0.000423259087
  error estimate for blocks of size 2^( 3) =       0.000435695032
  error estimate for blocks of size 2^( 4) =       0.000447198289
  error estimate for blocks of size 2^( 5) =       0.000457512029
  error estimate for blocks of size 2^( 6) =       0.000466201551
  error estimate for blocks of size 2^( 7) =       0.000471342883

      target function =                  N/A
              le_mean =     -16.910593516464
             les_mean =     286.307271398252
             stat err =       0.000460563688
             autocorr =       1.251075529113
              std dev =       0.582321636831
             le_variance =       0.339098488722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411763578
  error estimate for blocks of size 2^( 2) =       0.000423259087
  error estimate for blocks of size 2^( 3) =       0.000435695032
  error estimate for blocks of size 2^( 4) =       0.000447198289
  error estimate for blocks of size 2^( 5) =       0.000457512029
  error estimate for blocks of size 2^( 6) =       0.000466201551
  error estimate for blocks of size 2^( 7) =       0.000471342883

      target function =                  N/A
              le_mean =     -16.910593516464
             les_mean =     286.307271398252
             stat err =       0.000460563688
             autocorr =       1.251075529113
              std dev =       0.582321636831
             le_variance =       0.339098488722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411763578
  error estimate for blocks of size 2^( 2) =       0.000423259087
  error estimate for blocks of size 2^( 3) =       0.000435695032
  error estimate for blocks of size 2^( 4) =       0.000447198289
  error estimate for blocks of size 2^( 5) =       0.000457512029
  error estimate for blocks of size 2^( 6) =       0.000466201551
  error estimate for blocks of size 2^( 7) =       0.000471342883

      target function =                  N/A
              le_mean =     -16.910593516464
             les_mean =     286.307271398252
             stat err =       0.000460563688
             autocorr =       1.251075529113
              std dev =       0.582321636831
             le_variance =       0.339098488722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339005585355
                                         uncertainty =       0.013893197032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411763578
  error estimate for blocks of size 2^( 2) =       0.000423259087
  error estimate for blocks of size 2^( 3) =       0.000435695032
  error estimate for blocks of size 2^( 4) =       0.000447198289
  error estimate for blocks of size 2^( 5) =       0.000457512029
  error estimate for blocks of size 2^( 6) =       0.000466201551
  error estimate for blocks of size 2^( 7) =       0.000471342883

      target function =                  N/A
              le_mean =     -16.910593516464
             les_mean =     286.307271398252
             stat err =       0.000460563688
             autocorr =       1.251075529113
              std dev =       0.582321636831
             le_variance =       0.339098488722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910593516464        initial  <--
     3.7253e+12     3.7253e+13             0.0000e+00       -16.910593516464
     1.4901e+13     1.4901e+14             0.0000e+00       -16.910593516464
     5.9605e+13     5.9605e+14             0.0000e+00       -16.910593516464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1562
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8582
    reference variance = 0.262418
====================================================
  Execution time = 2.5673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2454e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583889307
                                         uncertainty =       0.003130834719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324583889307
                                         uncertainty =       0.003130834719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402829019
  error estimate for blocks of size 2^( 2) =       0.000415036496
  error estimate for blocks of size 2^( 3) =       0.000428120316
  error estimate for blocks of size 2^( 4) =       0.000441708348
  error estimate for blocks of size 2^( 5) =       0.000453494342
  error estimate for blocks of size 2^( 6) =       0.000462607732
  error estimate for blocks of size 2^( 7) =       0.000470727752

      target function =                  N/A
              le_mean =     -16.911160598237
             les_mean =     286.311895053423
             stat err =       0.000457134543
             autocorr =       1.287794552866
              std dev =       0.569686261307
             le_variance =       0.324542436322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691116059824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911160598237       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911160598237       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911160598237       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911160598237       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.853101182398       residual = 4.56e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.851746798033       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.797460056750       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909531189555       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.616529064957       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.245344791260       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.278309569772       residual = 5.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.768919631541       residual = 2.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -13.474168890972       residual = 1.54e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -15.395226446984       residual = 3.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -19.031969907857       residual = 5.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -18.377516166541       residual = 2.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -15.827380430992       residual = 1.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -15.336248136627       residual = 3.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.768406318578       residual = 9.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -19.746359844577       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -15.666001124676       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -18.102983674812       residual = 1.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -13.266268091471       residual = 1.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -19.543804919069       residual = 7.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.706603874435       residual = 8.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -19.789414160708       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.807613580551       residual = 9.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.126023962816       residual = 6.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -15.695228847396       residual = 2.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -13.801054585460       residual = 1.07e+03           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -14.952218296713       residual = 5.71e+02           smallest_sin_value = 9.95e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.52e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+13 is 1.828881e-18

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911160598237       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911160598237       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911160598237       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.004187172727       residual = 9.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.935445709682       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.710890026105       residual = 7.22e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.271617597456       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.459795110668       residual = 4.02e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.503050537677       residual = 2.43e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.949077911938       residual = 7.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -12.895218552042       residual = 2.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.398724387984       residual = 3.96e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -18.627769576502       residual = 4.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -18.018240701538       residual = 1.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -12.153463583592       residual = 2.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -19.156098980622       residual = 7.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -12.808232217336       residual = 2.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.527262971922       residual = 5.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =      -8.084143304711       residual = 1.03e+04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -14.286894214473       residual = 8.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -20.344818259308       residual = 1.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.521807918921       residual = 4.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -11.809287020379       residual = 3.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -13.637641685521       residual = 1.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+14 is 4.572204e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911160598237       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911160598237       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911160598237       residual = 5.70e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905192566064       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.012631362125       residual = 9.04e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -20.682843848432       residual = 1.91e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.638156558740       residual = 6.61e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -15.973835361438       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -20.436481168850       residual = 1.46e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -12.094207308680       residual = 2.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.644116909104       residual = 2.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.034021595736       residual = 8.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -15.802732084726       residual = 1.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   13 stopping due to too large eigenvalue change
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+14 is 1.143051e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2409e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.176807
====================================================
  Execution time = 2.5414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2607e-01
  Total weights = 2.0000e+06
  Execution time = 2.9597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403774891
  error estimate for blocks of size 2^( 2) =       0.000415637545
  error estimate for blocks of size 2^( 3) =       0.000428356019
  error estimate for blocks of size 2^( 4) =       0.000440717503
  error estimate for blocks of size 2^( 5) =       0.000452613642
  error estimate for blocks of size 2^( 6) =       0.000461316848
  error estimate for blocks of size 2^( 7) =       0.000470819385

      target function =                  N/A
              le_mean =     -16.911064111020
             les_mean =     286.310157528400
             stat err =       0.000456366844
             autocorr =       1.277466598440
              std dev =       0.571023926303
             le_variance =       0.326068324410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403774891
  error estimate for blocks of size 2^( 2) =       0.000415637545
  error estimate for blocks of size 2^( 3) =       0.000428356019
  error estimate for blocks of size 2^( 4) =       0.000440717503
  error estimate for blocks of size 2^( 5) =       0.000452613642
  error estimate for blocks of size 2^( 6) =       0.000461316848
  error estimate for blocks of size 2^( 7) =       0.000470819385

      target function =                  N/A
              le_mean =     -16.911064111020
             les_mean =     286.310157528400
             stat err =       0.000456366844
             autocorr =       1.277466598440
              std dev =       0.571023926303
             le_variance =       0.326068324410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403774891
  error estimate for blocks of size 2^( 2) =       0.000415637545
  error estimate for blocks of size 2^( 3) =       0.000428356019
  error estimate for blocks of size 2^( 4) =       0.000440717503
  error estimate for blocks of size 2^( 5) =       0.000452613642
  error estimate for blocks of size 2^( 6) =       0.000461316848
  error estimate for blocks of size 2^( 7) =       0.000470819385

      target function =                  N/A
              le_mean =     -16.911064111020
             les_mean =     286.310157528400
             stat err =       0.000456366844
             autocorr =       1.277466598440
              std dev =       0.571023926303
             le_variance =       0.326068324410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325764440138
                                         uncertainty =       0.003574485235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403774891
  error estimate for blocks of size 2^( 2) =       0.000415637545
  error estimate for blocks of size 2^( 3) =       0.000428356019
  error estimate for blocks of size 2^( 4) =       0.000440717503
  error estimate for blocks of size 2^( 5) =       0.000452613642
  error estimate for blocks of size 2^( 6) =       0.000461316848
  error estimate for blocks of size 2^( 7) =       0.000470819385

      target function =                  N/A
              le_mean =     -16.911064111020
             les_mean =     286.310157528400
             stat err =       0.000456366844
             autocorr =       1.277466598440
              std dev =       0.571023926303
             le_variance =       0.326068324410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911064111020        initial  <--
     3.7253e+13     3.7253e+14             1.8289e-18       -16.911064111020
     1.4901e+14     1.4901e+15             4.5722e-19       -16.911064111020
     5.9605e+14     5.9605e+15             1.1431e-19       -16.911064111020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.2984
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2715e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.230581
====================================================
  Execution time = 2.5483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3650e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989206572
                                         uncertainty =       0.006635623234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335989206572
                                         uncertainty =       0.006635623234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410185185
  error estimate for blocks of size 2^( 2) =       0.000422301476
  error estimate for blocks of size 2^( 3) =       0.000434686871
  error estimate for blocks of size 2^( 4) =       0.000446967013
  error estimate for blocks of size 2^( 5) =       0.000457581271
  error estimate for blocks of size 2^( 6) =       0.000464394073
  error estimate for blocks of size 2^( 7) =       0.000471675054

      target function =                  N/A
              le_mean =     -16.910587433658
             les_mean =     286.304470955130
             stat err =       0.000460154353
             autocorr =       1.258482347554
              std dev =       0.580089451714
             le_variance =       0.336503771990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691058743366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910587433658       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910587433658       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910587433658       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.876528211447       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.892011968102       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.571053403396       residual = 1.74e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.120363915552       residual = 6.13e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.413127117863       residual = 2.94e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.176068546950       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -19.043650889277       residual = 6.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -14.869669896765       residual = 6.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.458039541106       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -19.608756777934       residual = 1.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   13 stopping due to too large eigenvalue change
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+14 is 2.008204e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910587433658       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910587433658       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910587433658       residual = 2.54e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910587433658       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.184883685400       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.447233988685       residual = 2.85e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.968517916540       residual = 4.82e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.612050932408       residual = 3.84e+01           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+15 is 5.020509e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910587433658       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910587433658       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910587433658       residual = 6.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910587433645       residual = 2.39e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+15 is 1.255127e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2124e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8747
    reference variance = 0.253941
====================================================
  Execution time = 2.5069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4930e-01
  Total weights = 2.0000e+06
  Execution time = 2.9616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417911732
  error estimate for blocks of size 2^( 2) =       0.000429199316
  error estimate for blocks of size 2^( 3) =       0.000440689610
  error estimate for blocks of size 2^( 4) =       0.000451287565
  error estimate for blocks of size 2^( 5) =       0.000461048635
  error estimate for blocks of size 2^( 6) =       0.000468265639
  error estimate for blocks of size 2^( 7) =       0.000472199787

      target function =                  N/A
              le_mean =     -16.911200903780
             les_mean =     286.338016265084
             stat err =       0.000463200406
             autocorr =       1.228481828435
              std dev =       0.591016439459
             le_variance =       0.349300431711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417911732
  error estimate for blocks of size 2^( 2) =       0.000429199316
  error estimate for blocks of size 2^( 3) =       0.000440689610
  error estimate for blocks of size 2^( 4) =       0.000451287565
  error estimate for blocks of size 2^( 5) =       0.000461048635
  error estimate for blocks of size 2^( 6) =       0.000468265639
  error estimate for blocks of size 2^( 7) =       0.000472199787

      target function =                  N/A
              le_mean =     -16.911200903780
             les_mean =     286.338016265084
             stat err =       0.000463200406
             autocorr =       1.228481828435
              std dev =       0.591016439459
             le_variance =       0.349300431711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417911732
  error estimate for blocks of size 2^( 2) =       0.000429199316
  error estimate for blocks of size 2^( 3) =       0.000440689610
  error estimate for blocks of size 2^( 4) =       0.000451287565
  error estimate for blocks of size 2^( 5) =       0.000461048635
  error estimate for blocks of size 2^( 6) =       0.000468265639
  error estimate for blocks of size 2^( 7) =       0.000472199787

      target function =                  N/A
              le_mean =     -16.911200903780
             les_mean =     286.338016265084
             stat err =       0.000463200406
             autocorr =       1.228481828435
              std dev =       0.591016439459
             le_variance =       0.349300431711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349378917644
                                         uncertainty =       0.021036519084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417911732
  error estimate for blocks of size 2^( 2) =       0.000429199316
  error estimate for blocks of size 2^( 3) =       0.000440689610
  error estimate for blocks of size 2^( 4) =       0.000451287565
  error estimate for blocks of size 2^( 5) =       0.000461048635
  error estimate for blocks of size 2^( 6) =       0.000468265639
  error estimate for blocks of size 2^( 7) =       0.000472199787

      target function =                  N/A
              le_mean =     -16.911200903780
             les_mean =     286.338016265084
             stat err =       0.000463200406
             autocorr =       1.228481828435
              std dev =       0.591016439459
             le_variance =       0.349300431711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911200903780        initial  <--
     3.7253e+14     3.7253e+15             2.0082e-19       -16.911200903780
     1.4901e+15     1.4901e+16             5.0205e-20       -16.911200903780
     5.9605e+15     5.9605e+16             1.2551e-20       -16.911200903780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.8131
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9612
    reference variance = 0.19507
====================================================
  Execution time = 2.5527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326937058436
                                         uncertainty =       0.003810427883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326937058436
                                         uncertainty =       0.003810427883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404322167
  error estimate for blocks of size 2^( 2) =       0.000416394054
  error estimate for blocks of size 2^( 3) =       0.000429352371
  error estimate for blocks of size 2^( 4) =       0.000441224335
  error estimate for blocks of size 2^( 5) =       0.000453396807
  error estimate for blocks of size 2^( 6) =       0.000462698985
  error estimate for blocks of size 2^( 7) =       0.000466526551

      target function =                  N/A
              le_mean =     -16.910646824018
             les_mean =     286.296928671926
             stat err =       0.000455961670
             autocorr =       1.271749475168
              std dev =       0.571797891517
             le_variance =       0.326952828744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691064682402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+15, overlap shift 3.7253e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910646824018       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910646824018       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910646824018       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+15 is 1.956630e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910646824018       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910646824018       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910646824018       residual = 9.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.858072759108       residual = 3.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+16 is 4.891574e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910646824018       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910646824018       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910646824018       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+16 is 1.222893e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2241e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9321
    reference variance = 0.215557
====================================================
  Execution time = 2.5273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2391e-01
  Total weights = 2.0000e+06
  Execution time = 2.9727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433610
  error estimate for blocks of size 2^( 2) =       0.000414809681
  error estimate for blocks of size 2^( 3) =       0.000427689837
  error estimate for blocks of size 2^( 4) =       0.000440970392
  error estimate for blocks of size 2^( 5) =       0.000454319073
  error estimate for blocks of size 2^( 6) =       0.000463627408
  error estimate for blocks of size 2^( 7) =       0.000469928952

      target function =                  N/A
              le_mean =     -16.911001181171
             les_mean =     286.305866408503
             stat err =       0.000457211456
             autocorr =       1.290760655549
              std dev =       0.569127069184
             le_variance =       0.323905620878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433610
  error estimate for blocks of size 2^( 2) =       0.000414809681
  error estimate for blocks of size 2^( 3) =       0.000427689837
  error estimate for blocks of size 2^( 4) =       0.000440970392
  error estimate for blocks of size 2^( 5) =       0.000454319073
  error estimate for blocks of size 2^( 6) =       0.000463627408
  error estimate for blocks of size 2^( 7) =       0.000469928952

      target function =                  N/A
              le_mean =     -16.911001181171
             les_mean =     286.305866408503
             stat err =       0.000457211456
             autocorr =       1.290760655549
              std dev =       0.569127069184
             le_variance =       0.323905620878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433610
  error estimate for blocks of size 2^( 2) =       0.000414809681
  error estimate for blocks of size 2^( 3) =       0.000427689837
  error estimate for blocks of size 2^( 4) =       0.000440970392
  error estimate for blocks of size 2^( 5) =       0.000454319073
  error estimate for blocks of size 2^( 6) =       0.000463627408
  error estimate for blocks of size 2^( 7) =       0.000469928952

      target function =                  N/A
              le_mean =     -16.911001181171
             les_mean =     286.305866408503
             stat err =       0.000457211456
             autocorr =       1.290760655549
              std dev =       0.569127069184
             le_variance =       0.323905620878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323976874071
                                         uncertainty =       0.002826047357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433610
  error estimate for blocks of size 2^( 2) =       0.000414809681
  error estimate for blocks of size 2^( 3) =       0.000427689837
  error estimate for blocks of size 2^( 4) =       0.000440970392
  error estimate for blocks of size 2^( 5) =       0.000454319073
  error estimate for blocks of size 2^( 6) =       0.000463627408
  error estimate for blocks of size 2^( 7) =       0.000469928952

      target function =                  N/A
              le_mean =     -16.911001181171
             les_mean =     286.305866408503
             stat err =       0.000457211456
             autocorr =       1.290760655549
              std dev =       0.569127069184
             le_variance =       0.323905620878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911001181171        initial  <--
     3.7253e+15     3.7253e+16             1.9566e-20       -16.911001181171
     1.4901e+16     1.4901e+17             4.8916e-21       -16.911001181171
     5.9605e+16     5.9605e+17             1.2229e-21       -16.911001181171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.2024
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.078633e-01 1 1  ON 0
 uu_1                 1.432930e-01 1 1  ON 1
 uu_2                 4.637643e-02 1 1  ON 2
 uu_3                -1.572368e-02 1 1  ON 3
 uu_4                -6.406911e-02 1 1  ON 4
 uu_5                -9.926298e-02 1 1  ON 5
 uu_6                -1.257522e-01 1 1  ON 6
 uu_7                -1.377567e-01 1 1  ON 7
 uu_8                -1.295094e-01 1 1  ON 8
 uu_9                -9.991793e-02 1 1  ON 9
 ud_0                 4.326956e-01 1 1  ON 10
 ud_1                 1.757809e-01 1 1  ON 11
 ud_2                 6.198621e-02 1 1  ON 12
 ud_3                -6.632689e-03 1 1  ON 13
 ud_4                -6.124843e-02 1 1  ON 14
 ud_5                -1.024671e-01 1 1  ON 15
 ud_6                -1.305562e-01 1 1  ON 16
 ud_7                -1.486237e-01 1 1  ON 17
 ud_8                -1.518242e-01 1 1  ON 18
 ud_9                -1.408868e-01 1 1  ON 19
 eO_0                -7.470841e-01 1 1  ON 20
 eO_1                -4.323993e-01 1 1  ON 21
 eO_2                -1.699730e-02 1 1  ON 22
 eO_3                 2.992050e-01 1 1  ON 23
 eO_4                 5.159732e-01 1 1  ON 24
 eO_5                 4.708292e-01 1 1  ON 25
 eO_6                 2.402994e-01 1 1  ON 26
 eO_7                -5.222168e-02 1 1  ON 27
 eO_8                -2.097858e-01 1 1  ON 28
 eO_9                -6.912749e-02 1 1  ON 29
eH1_0                -2.439269e-01 1 1  ON 30
eH1_1                -1.395572e-01 1 1  ON 31
eH1_2                -9.605447e-02 1 1  ON 32
eH1_3                -4.441097e-02 1 1  ON 33
eH1_4                 1.191459e-02 1 1  ON 34
eH1_5                 4.954879e-02 1 1  ON 35
eH1_6                 1.067296e-01 1 1  ON 36
eH1_7                 1.536209e-01 1 1  ON 37
eH1_8                 1.628908e-01 1 1  ON 38
eH1_9                 4.489215e-02 1 1  ON 39
eH2_0                -2.425022e-01 1 1  ON 40
eH2_1                -1.376304e-01 1 1  ON 41
eH2_2                -9.420372e-02 1 1  ON 42
eH2_3                -4.251053e-02 1 1  ON 43
eH2_4                 1.392464e-02 1 1  ON 44
eH2_5                 5.201438e-02 1 1  ON 45
eH2_6                 1.101655e-01 1 1  ON 46
eH2_7                 1.565622e-01 1 1  ON 47
eH2_8                 1.700351e-01 1 1  ON 48
eH2_9                 3.149254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2465e+01 secs
  Total Execution time = 2.9224e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
