Rank =    0  Free Memory = 76617 MB
Rank =    1  Free Memory = 76617 MB
Rank =    2  Free Memory = 76617 MB
Rank =    3  Free Memory = 76617 MB
Rank =    4  Free Memory = 76617 MB
Rank =    5  Free Memory = 76617 MB
Rank =    6  Free Memory = 76616 MB
Rank =    7  Free Memory = 76616 MB
Rank =    8  Free Memory = 76616 MB
Rank =    9  Free Memory = 76616 MB
Rank =   10  Free Memory = 76616 MB
Rank =   11  Free Memory = 76616 MB
Rank =   12  Free Memory = 76616 MB
Rank =   13  Free Memory = 76616 MB
Rank =   14  Free Memory = 76616 MB
Rank =   15  Free Memory = 76602 MB
Rank =   16  Free Memory = 76602 MB
Rank =   17  Free Memory = 76602 MB
Rank =   18  Free Memory = 76602 MB
Rank =   19  Free Memory = 76602 MB
Rank =   20  Free Memory = 76602 MB
Rank =   21  Free Memory = 76602 MB
Rank =   22  Free Memory = 76602 MB
Rank =   23  Free Memory = 76602 MB
Rank =   24  Free Memory = 76602 MB
Rank =   25  Free Memory = 76602 MB
Rank =   26  Free Memory = 76602 MB
Rank =   27  Free Memory = 76602 MB
Rank =   28  Free Memory = 76602 MB
Rank =   29  Free Memory = 76602 MB
Rank =   30  Free Memory = 76601 MB
Rank =   31  Free Memory = 76601 MB
Rank =   32  Free Memory = 79138 MB
Rank =   33  Free Memory = 79138 MB
Rank =   34  Free Memory = 79137 MB
Rank =   35  Free Memory = 79137 MB
Rank =   36  Free Memory = 79137 MB
Rank =   37  Free Memory = 79137 MB
Rank =   38  Free Memory = 79137 MB
Rank =   39  Free Memory = 79137 MB
Rank =   40  Free Memory = 79137 MB
Rank =   41  Free Memory = 79137 MB
Rank =   42  Free Memory = 79137 MB
Rank =   43  Free Memory = 79137 MB
Rank =   44  Free Memory = 79137 MB
Rank =   45  Free Memory = 79137 MB
Rank =   46  Free Memory = 79137 MB
Rank =   47  Free Memory = 79137 MB
Rank =   48  Free Memory = 79137 MB
Rank =   49  Free Memory = 79137 MB
Rank =   50  Free Memory = 79137 MB
Rank =   51  Free Memory = 79137 MB
Rank =   52  Free Memory = 79137 MB
Rank =   53  Free Memory = 79137 MB
Rank =   54  Free Memory = 79137 MB
Rank =   55  Free Memory = 79137 MB
Rank =   56  Free Memory = 79137 MB
Rank =   57  Free Memory = 79137 MB
Rank =   58  Free Memory = 79137 MB
Rank =   59  Free Memory = 79137 MB
Rank =   60  Free Memory = 79137 MB
Rank =   61  Free Memory = 79137 MB
Rank =   62  Free Memory = 79137 MB
Rank =   63  Free Memory = 79137 MB
Rank =   64  Free Memory = 87328 MB
Rank =   65  Free Memory = 87328 MB
Rank =   66  Free Memory = 87328 MB
Rank =   67  Free Memory = 87328 MB
Rank =   68  Free Memory = 87328 MB
Rank =   69  Free Memory = 87328 MB
Rank =   70  Free Memory = 87328 MB
Rank =   71  Free Memory = 87328 MB
Rank =   72  Free Memory = 87328 MB
Rank =   73  Free Memory = 87328 MB
Rank =   74  Free Memory = 87328 MB
Rank =   75  Free Memory = 87328 MB
Rank =   76  Free Memory = 87328 MB
Rank =   77  Free Memory = 87328 MB
Rank =   78  Free Memory = 87328 MB
Rank =   79  Free Memory = 87328 MB
Rank =   80  Free Memory = 87328 MB
Rank =   81  Free Memory = 87328 MB
Rank =   82  Free Memory = 87328 MB
Rank =   83  Free Memory = 87328 MB
Rank =   84  Free Memory = 87328 MB
Rank =   85  Free Memory = 87328 MB
Rank =   86  Free Memory = 87328 MB
Rank =   87  Free Memory = 87328 MB
Rank =   88  Free Memory = 87328 MB
Rank =   89  Free Memory = 87328 MB
Rank =   90  Free Memory = 87328 MB
Rank =   91  Free Memory = 87328 MB
Rank =   92  Free Memory = 87328 MB
Rank =   93  Free Memory = 87328 MB
Rank =   94  Free Memory = 87328 MB
Rank =   95  Free Memory = 87328 MB
Rank =   96  Free Memory = 85250 MB
Rank =   97  Free Memory = 85250 MB
Rank =   98  Free Memory = 85250 MB
Rank =   99  Free Memory = 85250 MB
Rank =  100  Free Memory = 85250 MB
Rank =  101  Free Memory = 85250 MB
Rank =  102  Free Memory = 85250 MB
Rank =  103  Free Memory = 85250 MB
Rank =  104  Free Memory = 85250 MB
Rank =  105  Free Memory = 85250 MB
Rank =  106  Free Memory = 85250 MB
Rank =  107  Free Memory = 85250 MB
Rank =  108  Free Memory = 85250 MB
Rank =  109  Free Memory = 85250 MB
Rank =  110  Free Memory = 85250 MB
Rank =  111  Free Memory = 85250 MB
Rank =  112  Free Memory = 85250 MB
Rank =  113  Free Memory = 85250 MB
Rank =  114  Free Memory = 85250 MB
Rank =  115  Free Memory = 85250 MB
Rank =  116  Free Memory = 85250 MB
Rank =  117  Free Memory = 85250 MB
Rank =  118  Free Memory = 85250 MB
Rank =  119  Free Memory = 85250 MB
Rank =  120  Free Memory = 85250 MB
Rank =  121  Free Memory = 85250 MB
Rank =  122  Free Memory = 85250 MB
Rank =  123  Free Memory = 85249 MB
Rank =  124  Free Memory = 85249 MB
Rank =  125  Free Memory = 85249 MB
Rank =  126  Free Memory = 85249 MB
Rank =  127  Free Memory = 85249 MB
  Input file(s): opt_h2o_1b1_gvptt_193dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_193dets_run001f.xml

  Project = H2O
  date    = 2023-05-14 15:00:13 PDT
  host    = n0022.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 493

  Range of prime numbers to use as seeds over processors and threads = 3539-4603


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.073415e-01    1         1  ON     0
     uu_1                 1.420408e-01    1         1  ON     1
     uu_2                 4.333878e-02    1         1  ON     2
     uu_3                -1.788819e-02    1         1  ON     3
     uu_4                -6.302883e-02    1         1  ON     4
     uu_5                -9.707649e-02    1         1  ON     5
     uu_6                -1.244297e-01    1         1  ON     6
     uu_7                -1.378634e-01    1         1  ON     7
     uu_8                -1.332383e-01    1         1  ON     8
     uu_9                -1.047493e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.354415e-01    1         1  ON     0
     ud_1                 1.776003e-01    1         1  ON     1
     ud_2                 6.403511e-02    1         1  ON     2
     ud_3                -4.618944e-03    1         1  ON     3
     ud_4                -6.088974e-02    1         1  ON     4
     ud_5                -1.025083e-01    1         1  ON     5
     ud_6                -1.302613e-01    1         1  ON     6
     ud_7                -1.481255e-01    1         1  ON     7
     ud_8                -1.518987e-01    1         1  ON     8
     ud_9                -1.447696e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.494233e-01    1         1  ON     0
     eO_1                -4.362100e-01    1         1  ON     1
     eO_2                -2.586677e-02    1         1  ON     2
     eO_3                 2.941643e-01    1         1  ON     3
     eO_4                 5.211227e-01    1         1  ON     4
     eO_5                 4.824165e-01    1         1  ON     5
     eO_6                 2.579421e-01    1         1  ON     6
     eO_7                -4.115084e-02    1         1  ON     7
     eO_8                -2.209873e-01    1         1  ON     8
     eO_9                -8.107947e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.396232e-01    1         1  ON     0
     eH1_1                -1.368837e-01    1         1  ON     1
     eH1_2                -9.223381e-02    1         1  ON     2
     eH1_3                -4.109373e-02    1         1  ON     3
     eH1_4                 7.323284e-03    1         1  ON     4
     eH1_5                 3.841446e-02    1         1  ON     5
     eH1_6                 9.634798e-02    1         1  ON     6
     eH1_7                 1.491719e-01    1         1  ON     7
     eH1_8                 1.684890e-01    1         1  ON     8
     eH1_9                 5.459742e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.383690e-01    1         1  ON     0
     eH2_1                -1.356293e-01    1         1  ON     1
     eH2_2                -9.106485e-02    1         1  ON     2
     eH2_3                -3.968533e-02    1         1  ON     3
     eH2_4                 8.363161e-03    1         1  ON     4
     eH2_5                 3.990453e-02    1         1  ON     5
     eH2_6                 9.820817e-02    1         1  ON     6
     eH2_7                 1.497104e-01    1         1  ON     7
     eH2_8                 1.800563e-01    1         1  ON     8
     eH2_9                 4.486017e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 193 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 3.850832e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 57 unique up determinants.
Found 57 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.2497e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8775
    reference variance = 0.225909
====================================================
  Execution time = 2.6010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328274341301
                                         uncertainty =       0.003572380065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328274341301
                                         uncertainty =       0.003572380065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405146624
  error estimate for blocks of size 2^( 2) =       0.000417454451
  error estimate for blocks of size 2^( 3) =       0.000430649420
  error estimate for blocks of size 2^( 4) =       0.000443109020
  error estimate for blocks of size 2^( 5) =       0.000454291052
  error estimate for blocks of size 2^( 6) =       0.000463148897
  error estimate for blocks of size 2^( 7) =       0.000467170579

      target function =                  N/A
              le_mean =     -16.910545774219
             les_mean =     286.294845792279
             stat err =       0.000456929887
             autocorr =       1.271963593637
              std dev =       0.572963850932
             le_variance =       0.328287574475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691054577422e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910545774219       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910571431110       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910580984650       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910580123492       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910580452844       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910582506130       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910582632379       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910583304723       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910583395997       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910583231428       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910583355674       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.759449e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910545774219       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910555541026       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910560046375       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910560448338       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910560056371       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910560419261       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910560620431       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910560949317       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910560946806       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.247764e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910545774219       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910548582932       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910550023093       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910550252261       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910550203091       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910550261714       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910550247033       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910550357735       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910550369406       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.479598e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2157e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.073038e-01                 1 1 ON  0
uu_1  1.420133e-01                 1 1 ON  1
uu_2  4.345953e-02                 1 1 ON  2
uu_3  -1.787609e-02                1 1 ON  3
uu_4  -6.312665e-02                1 1 ON  4
uu_5  -9.720142e-02                1 1 ON  5
uu_6  -1.245352e-01                1 1 ON  6
uu_7  -1.379282e-01                1 1 ON  7
uu_8  -1.330946e-01                1 1 ON  8
uu_9  -1.047547e-01                1 1 ON  9
ud_0  4.359662e-01                 1 1 ON  10
ud_1  1.779477e-01                 1 1 ON  11
ud_2  6.376492e-02                 1 1 ON  12
ud_3  -5.027661e-03                1 1 ON  13
ud_4  -6.095365e-02                1 1 ON  14
ud_5  -1.025224e-01                1 1 ON  15
ud_6  -1.304004e-01                1 1 ON  16
ud_7  -1.482475e-01                1 1 ON  17
ud_8  -1.517209e-01                1 1 ON  18
ud_9  -1.447439e-01                1 1 ON  19
eO_0  -7.497595e-01                1 1 ON  20
eO_1  -4.361060e-01                1 1 ON  21
eO_2  -2.593454e-02                1 1 ON  22
eO_3  2.944357e-01                 1 1 ON  23
eO_4  5.211366e-01                 1 1 ON  24
eO_5  4.825010e-01                 1 1 ON  25
eO_6  2.579850e-01                 1 1 ON  26
eO_7  -4.106034e-02                1 1 ON  27
eO_8  -2.210190e-01                1 1 ON  28
eO_9  -8.122290e-02                1 1 ON  29
eH1_0 -2.400196e-01                1 1 ON  30
eH1_1 -1.370259e-01                1 1 ON  31
eH1_2 -9.207645e-02                1 1 ON  32
eH1_3 -4.100800e-02                1 1 ON  33
eH1_4 7.233588e-03                 1 1 ON  34
eH1_5 3.826488e-02                 1 1 ON  35
eH1_6 9.650715e-02                 1 1 ON  36
eH1_7 1.492302e-01                 1 1 ON  37
eH1_8 1.686511e-01                 1 1 ON  38
eH1_9 5.477070e-02                 1 1 ON  39
eH2_0 -2.388618e-01                1 1 ON  40
eH2_1 -1.358876e-01                1 1 ON  41
eH2_2 -9.094802e-02                1 1 ON  42
eH2_3 -3.963043e-02                1 1 ON  43
eH2_4 8.468764e-03                 1 1 ON  44
eH2_5 3.984714e-02                 1 1 ON  45
eH2_6 9.837196e-02                 1 1 ON  46
eH2_7 1.497775e-01                 1 1 ON  47
eH2_8 1.800926e-01                 1 1 ON  48
eH2_9 4.505106e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.242063
====================================================
  Execution time = 2.2863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4514e-01
  Total weights = 2.0000e+06
  Execution time = 2.4404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344866356653
                                         uncertainty =       0.011180160771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344866356653
                                         uncertainty =       0.011180160771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415207377
  error estimate for blocks of size 2^( 2) =       0.000426929764
  error estimate for blocks of size 2^( 3) =       0.000439579171
  error estimate for blocks of size 2^( 4) =       0.000451872422
  error estimate for blocks of size 2^( 5) =       0.000463849548
  error estimate for blocks of size 2^( 6) =       0.000475925465
  error estimate for blocks of size 2^( 7) =       0.000483205283

      target function =                  N/A
              le_mean =     -16.909822473941
             les_mean =     286.286890259191
             stat err =       0.000468713179
             autocorr =       1.274336753931
              std dev =       0.587191903364
             le_variance =       0.344794331376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345832927451
                                         uncertainty =       0.011235240383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345832927451
                                         uncertainty =       0.011235240383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415788420
  error estimate for blocks of size 2^( 2) =       0.000427442305
  error estimate for blocks of size 2^( 3) =       0.000440015829
  error estimate for blocks of size 2^( 4) =       0.000452255403
  error estimate for blocks of size 2^( 5) =       0.000464203287
  error estimate for blocks of size 2^( 6) =       0.000476281162
  error estimate for blocks of size 2^( 7) =       0.000483529517

      target function =                  N/A
              le_mean =     -16.909813709032
             les_mean =     286.287559522303
             stat err =       0.000469067342
             autocorr =       1.272698739109
              std dev =       0.588013623143
             le_variance =       0.345760021001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345578767967
                                         uncertainty =       0.011225684921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345578767967
                                         uncertainty =       0.011225684921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415635684
  error estimate for blocks of size 2^( 2) =       0.000427303082
  error estimate for blocks of size 2^( 3) =       0.000439891441
  error estimate for blocks of size 2^( 4) =       0.000452144429
  error estimate for blocks of size 2^( 5) =       0.000464098696
  error estimate for blocks of size 2^( 6) =       0.000476179353
  error estimate for blocks of size 2^( 7) =       0.000483442856

      target function =                  N/A
              le_mean =     -16.909814973327
             les_mean =     286.287348303015
             stat err =       0.000468966333
             autocorr =       1.273085817168
              std dev =       0.587797621295
             le_variance =       0.345506043600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344961623821
                                         uncertainty =       0.011187027107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344961623821
                                         uncertainty =       0.011187027107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415264671
  error estimate for blocks of size 2^( 2) =       0.000426978384
  error estimate for blocks of size 2^( 3) =       0.000439618254
  error estimate for blocks of size 2^( 4) =       0.000451905447
  error estimate for blocks of size 2^( 5) =       0.000463879050
  error estimate for blocks of size 2^( 6) =       0.000475955963
  error estimate for blocks of size 2^( 7) =       0.000483234096

      target function =                  N/A
              le_mean =     -16.909820283937
             les_mean =     286.286911355916
             stat err =       0.000468743639
             autocorr =       1.274150726420
              std dev =       0.587272929165
             le_variance =       0.344889493330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909822473941        initial  <--
     2.5000e-01     2.5000e+00             1.7594e-03       -16.909813709032
     1.0000e+00     1.0000e+01             5.2478e-04       -16.909814973327
     4.0000e+00     4.0000e+01             1.4796e-04       -16.909820283937

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.1344
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7298e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9493
    reference variance = 0.213032
====================================================
  Execution time = 2.2896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3408e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334221893638
                                         uncertainty =       0.006024779498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334221893638
                                         uncertainty =       0.006024779498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408705181
  error estimate for blocks of size 2^( 2) =       0.000420266511
  error estimate for blocks of size 2^( 3) =       0.000432289467
  error estimate for blocks of size 2^( 4) =       0.000443166667
  error estimate for blocks of size 2^( 5) =       0.000453026482
  error estimate for blocks of size 2^( 6) =       0.000461018104
  error estimate for blocks of size 2^( 7) =       0.000466338259

      target function =                  N/A
              le_mean =     -16.910586886751
             les_mean =     286.302028537529
             stat err =       0.000455887378
             autocorr =       1.244213329900
              std dev =       0.577996410220
             le_variance =       0.334079850228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691058688675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910586886751       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910591867423       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910592080614       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910592961909       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910593770372       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910594084153       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910594278000       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910594135579       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910594126666       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.786958e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910586886751       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910588210281       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910588260223       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910588481585       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910588662696       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910588748449       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910588818216       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910588782727       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910588778575       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 7.281502e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910586886751       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910587222922       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910587235242       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910587290650       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910587334450       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910587355564       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910587374512       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910587365984       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.850050e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8988e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.073259e-01 1 1  ON 0
 uu_1                 1.420398e-01 1 1  ON 1
 uu_2                 4.335139e-02 1 1  ON 2
 uu_3                -1.787321e-02 1 1  ON 3
 uu_4                -6.302867e-02 1 1  ON 4
 uu_5                -9.708703e-02 1 1  ON 5
 uu_6                -1.244353e-01 1 1  ON 6
 uu_7                -1.378702e-01 1 1  ON 7
 uu_8                -1.332286e-01 1 1  ON 8
 uu_9                -1.047594e-01 1 1  ON 9
 ud_0                 4.355143e-01 1 1  ON 10
 ud_1                 1.776566e-01 1 1  ON 11
 ud_2                 6.399837e-02 1 1  ON 12
 ud_3                -4.669278e-03 1 1  ON 13
 ud_4                -6.089049e-02 1 1  ON 14
 ud_5                -1.025240e-01 1 1  ON 15
 ud_6                -1.302757e-01 1 1  ON 16
 ud_7                -1.481291e-01 1 1  ON 17
 ud_8                -1.518957e-01 1 1  ON 18
 ud_9                -1.447740e-01 1 1  ON 19
 eO_0                -7.494691e-01 1 1  ON 20
 eO_1                -4.361910e-01 1 1  ON 21
 eO_2                -2.587547e-02 1 1  ON 22
 eO_3                 2.941980e-01 1 1  ON 23
 eO_4                 5.211396e-01 1 1  ON 24
 eO_5                 4.824267e-01 1 1  ON 25
 eO_6                 2.579410e-01 1 1  ON 26
 eO_7                -4.114101e-02 1 1  ON 27
 eO_8                -2.210004e-01 1 1  ON 28
 eO_9                -8.109791e-02 1 1  ON 29
eH1_0                -2.396707e-01 1 1  ON 30
eH1_1                -1.368992e-01 1 1  ON 31
eH1_2                -9.221348e-02 1 1  ON 32
eH1_3                -4.109735e-02 1 1  ON 33
eH1_4                 7.330868e-03 1 1  ON 34
eH1_5                 3.842031e-02 1 1  ON 35
eH1_6                 9.635642e-02 1 1  ON 36
eH1_7                 1.491743e-01 1 1  ON 37
eH1_8                 1.685015e-01 1 1  ON 38
eH1_9                 5.461021e-02 1 1  ON 39
eH2_0                -2.384052e-01 1 1  ON 40
eH2_1                -1.356418e-01 1 1  ON 41
eH2_2                -9.105153e-02 1 1  ON 42
eH2_3                -3.968510e-02 1 1  ON 43
eH2_4                 8.363489e-03 1 1  ON 44
eH2_5                 3.989913e-02 1 1  ON 45
eH2_6                 9.821543e-02 1 1  ON 46
eH2_7                 1.497106e-01 1 1  ON 47
eH2_8                 1.800641e-01 1 1  ON 48
eH2_9                 4.488487e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8793
    reference variance = 0.200859
====================================================
  Execution time = 2.2685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2529e-01
  Total weights = 2.0000e+06
  Execution time = 2.4282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325298297388
                                         uncertainty =       0.003105994901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325298297388
                                         uncertainty =       0.003105994901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403267961
  error estimate for blocks of size 2^( 2) =       0.000415278484
  error estimate for blocks of size 2^( 3) =       0.000428441801
  error estimate for blocks of size 2^( 4) =       0.000440663603
  error estimate for blocks of size 2^( 5) =       0.000450961695
  error estimate for blocks of size 2^( 6) =       0.000459290255
  error estimate for blocks of size 2^( 7) =       0.000466757145

      target function =                  N/A
              le_mean =     -16.909326545516
             les_mean =     286.250574157000
             stat err =       0.000454418175
             autocorr =       1.269766739532
              std dev =       0.570307019724
             le_variance =       0.325250096747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325468936252
                                         uncertainty =       0.003108043031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325468936252
                                         uncertainty =       0.003108043031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403373804
  error estimate for blocks of size 2^( 2) =       0.000415371111
  error estimate for blocks of size 2^( 3) =       0.000428518366
  error estimate for blocks of size 2^( 4) =       0.000440730377
  error estimate for blocks of size 2^( 5) =       0.000451022466
  error estimate for blocks of size 2^( 6) =       0.000459342586
  error estimate for blocks of size 2^( 7) =       0.000466818055

      target function =                  N/A
              le_mean =     -16.909327221946
             les_mean =     286.250767787208
             stat err =       0.000454478371
             autocorr =       1.269436725899
              std dev =       0.570456703946
             le_variance =       0.325420851077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325387888155
                                         uncertainty =       0.003107052066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325387888155
                                         uncertainty =       0.003107052066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403323538
  error estimate for blocks of size 2^( 2) =       0.000415326860
  error estimate for blocks of size 2^( 3) =       0.000428481427
  error estimate for blocks of size 2^( 4) =       0.000440697907
  error estimate for blocks of size 2^( 5) =       0.000450992786
  error estimate for blocks of size 2^( 6) =       0.000459316691
  error estimate for blocks of size 2^( 7) =       0.000466788425

      target function =                  N/A
              le_mean =     -16.909326766425
             les_mean =     286.250671283878
             stat err =       0.000454448952
             autocorr =       1.269588781493
              std dev =       0.570385617634
             le_variance =       0.325339752804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325309671776
                                         uncertainty =       0.003106130131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325309671776
                                         uncertainty =       0.003106130131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403275018
  error estimate for blocks of size 2^( 2) =       0.000415284609
  error estimate for blocks of size 2^( 3) =       0.000428446799
  error estimate for blocks of size 2^( 4) =       0.000440667920
  error estimate for blocks of size 2^( 5) =       0.000450965598
  error estimate for blocks of size 2^( 6) =       0.000459293570
  error estimate for blocks of size 2^( 7) =       0.000466761083

      target function =                  N/A
              le_mean =     -16.909326554481
             les_mean =     286.250585843156
             stat err =       0.000454422042
             autocorr =       1.269743916888
              std dev =       0.570316999311
             le_variance =       0.325261479703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909326545516        initial
     2.5000e+00     2.5000e+01             2.7870e-04       -16.909327221946  <--
     1.0000e+01     1.0000e+02             7.2815e-05       -16.909326766425
     4.0000e+01     4.0000e+02             1.8501e-05       -16.909326554481

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.4890e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.072852e-01 1 1  ON 0
 uu_1                 1.420383e-01 1 1  ON 1
 uu_2                 4.338506e-02 1 1  ON 2
 uu_3                -1.783292e-02 1 1  ON 3
 uu_4                -6.302861e-02 1 1  ON 4
 uu_5                -9.711627e-02 1 1  ON 5
 uu_6                -1.244522e-01 1 1  ON 6
 uu_7                -1.378905e-01 1 1  ON 7
 uu_8                -1.332003e-01 1 1  ON 8
 uu_9                -1.047891e-01 1 1  ON 9
 ud_0                 4.357202e-01 1 1  ON 10
 ud_1                 1.778030e-01 1 1  ON 11
 ud_2                 6.390992e-02 1 1  ON 12
 ud_3                -4.807870e-03 1 1  ON 13
 ud_4                -6.090107e-02 1 1  ON 14
 ud_5                -1.025659e-01 1 1  ON 15
 ud_6                -1.303161e-01 1 1  ON 16
 ud_7                -1.481399e-01 1 1  ON 17
 ud_8                -1.518862e-01 1 1  ON 18
 ud_9                -1.447866e-01 1 1  ON 19
 eO_0                -7.495993e-01 1 1  ON 20
 eO_1                -4.361386e-01 1 1  ON 21
 eO_2                -2.589971e-02 1 1  ON 22
 eO_3                 2.942893e-01 1 1  ON 23
 eO_4                 5.211937e-01 1 1  ON 24
 eO_5                 4.824583e-01 1 1  ON 25
 eO_6                 2.579378e-01 1 1  ON 26
 eO_7                -4.111160e-02 1 1  ON 27
 eO_8                -2.210394e-01 1 1  ON 28
 eO_9                -8.115291e-02 1 1  ON 29
eH1_0                -2.398107e-01 1 1  ON 30
eH1_1                -1.369437e-01 1 1  ON 31
eH1_2                -9.215776e-02 1 1  ON 32
eH1_3                -4.110526e-02 1 1  ON 33
eH1_4                 7.351608e-03 1 1  ON 34
eH1_5                 3.843736e-02 1 1  ON 35
eH1_6                 9.638230e-02 1 1  ON 36
eH1_7                 1.491817e-01 1 1  ON 37
eH1_8                 1.685387e-01 1 1  ON 38
eH1_9                 5.464849e-02 1 1  ON 39
eH2_0                -2.385123e-01 1 1  ON 40
eH2_1                -1.356791e-01 1 1  ON 41
eH2_2                -9.101428e-02 1 1  ON 42
eH2_3                -3.968343e-02 1 1  ON 43
eH2_4                 8.364153e-03 1 1  ON 44
eH2_5                 3.988304e-02 1 1  ON 45
eH2_6                 9.823755e-02 1 1  ON 46
eH2_7                 1.497112e-01 1 1  ON 47
eH2_8                 1.800877e-01 1 1  ON 48
eH2_9                 4.495876e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9161
    reference variance = 0.273003
====================================================
  Execution time = 2.2892e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3899e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338783930582
                                         uncertainty =       0.007961149486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338783930582
                                         uncertainty =       0.007961149486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411698954
  error estimate for blocks of size 2^( 2) =       0.000423139059
  error estimate for blocks of size 2^( 3) =       0.000435230578
  error estimate for blocks of size 2^( 4) =       0.000447022172
  error estimate for blocks of size 2^( 5) =       0.000457030216
  error estimate for blocks of size 2^( 6) =       0.000467018709
  error estimate for blocks of size 2^( 7) =       0.000475538627

      target function =                  N/A
              le_mean =     -16.909643163759
             les_mean =     286.275023814125
             stat err =       0.000461652431
             autocorr =       1.257392095232
              std dev =       0.582230244810
             le_variance =       0.338992057972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690964316376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909643163759       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909659518057       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909662982366       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909663330633       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909663394776       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909664036965       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909664170905       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909664703207       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909664869756       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909664707638       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.842720e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909643163759       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909648176918       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909649355377       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909649560041       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909649619327       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909649777698       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909649673452       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909649868816       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909649873891       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.062404e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909643163759       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909644492148       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909644818864       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909644883687       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909644907647       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909644950963       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909644911627       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909644959597       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.487238e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9153e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.072255e-01 1 1  ON 0
 uu_1                 1.420409e-01 1 1  ON 1
 uu_2                 4.345816e-02 1 1  ON 2
 uu_3                -1.778328e-02 1 1  ON 3
 uu_4                -6.302646e-02 1 1  ON 4
 uu_5                -9.717792e-02 1 1  ON 5
 uu_6                -1.245079e-01 1 1  ON 6
 uu_7                -1.379267e-01 1 1  ON 7
 uu_8                -1.331663e-01 1 1  ON 8
 uu_9                -1.047971e-01 1 1  ON 9
 ud_0                 4.359264e-01 1 1  ON 10
 ud_1                 1.779568e-01 1 1  ON 11
 ud_2                 6.381658e-02 1 1  ON 12
 ud_3                -4.993685e-03 1 1  ON 13
 ud_4                -6.094885e-02 1 1  ON 14
 ud_5                -1.025991e-01 1 1  ON 15
 ud_6                -1.303754e-01 1 1  ON 16
 ud_7                -1.481374e-01 1 1  ON 17
 ud_8                -1.518656e-01 1 1  ON 18
 ud_9                -1.447367e-01 1 1  ON 19
 eO_0                -7.497049e-01 1 1  ON 20
 eO_1                -4.361213e-01 1 1  ON 21
 eO_2                -2.594782e-02 1 1  ON 22
 eO_3                 2.944042e-01 1 1  ON 23
 eO_4                 5.212269e-01 1 1  ON 24
 eO_5                 4.825075e-01 1 1  ON 25
 eO_6                 2.579613e-01 1 1  ON 26
 eO_7                -4.110311e-02 1 1  ON 27
 eO_8                -2.210786e-01 1 1  ON 28
 eO_9                -8.119949e-02 1 1  ON 29
eH1_0                -2.399696e-01 1 1  ON 30
eH1_1                -1.369894e-01 1 1  ON 31
eH1_2                -9.211845e-02 1 1  ON 32
eH1_3                -4.110079e-02 1 1  ON 33
eH1_4                 7.312797e-03 1 1  ON 34
eH1_5                 3.845775e-02 1 1  ON 35
eH1_6                 9.642576e-02 1 1  ON 36
eH1_7                 1.491963e-01 1 1  ON 37
eH1_8                 1.686009e-01 1 1  ON 38
eH1_9                 5.471213e-02 1 1  ON 39
eH2_0                -2.386806e-01 1 1  ON 40
eH2_1                -1.357607e-01 1 1  ON 41
eH2_2                -9.093796e-02 1 1  ON 42
eH2_3                -3.967633e-02 1 1  ON 43
eH2_4                 8.336667e-03 1 1  ON 44
eH2_5                 3.988987e-02 1 1  ON 45
eH2_6                 9.823807e-02 1 1  ON 46
eH2_7                 1.497223e-01 1 1  ON 47
eH2_8                 1.801366e-01 1 1  ON 48
eH2_9                 4.506645e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9416
    reference variance = 0.130318
====================================================
  Execution time = 2.2502e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 4.9610e-01
  Total weights = 2.0000e+06
  Execution time = 2.4608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496332483323
                                         uncertainty =       0.154387222509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496332483323
                                         uncertainty =       0.154387222509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498035569
  error estimate for blocks of size 2^( 2) =       0.000507609353
  error estimate for blocks of size 2^( 3) =       0.000518071536
  error estimate for blocks of size 2^( 4) =       0.000528541979
  error estimate for blocks of size 2^( 5) =       0.000538595875
  error estimate for blocks of size 2^( 6) =       0.000546589422
  error estimate for blocks of size 2^( 7) =       0.000550114509

      target function =                  N/A
              le_mean =     -16.911268386191
             les_mean =     286.487077038351
             stat err =       0.000540960446
             autocorr =       1.179805188422
              std dev =       0.704328656679
             le_variance =       0.496078856619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496500974640
                                         uncertainty =       0.154197579527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496500974640
                                         uncertainty =       0.154197579527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498119933
  error estimate for blocks of size 2^( 2) =       0.000507671073
  error estimate for blocks of size 2^( 3) =       0.000518108934
  error estimate for blocks of size 2^( 4) =       0.000528557738
  error estimate for blocks of size 2^( 5) =       0.000538598383
  error estimate for blocks of size 2^( 6) =       0.000546579299
  error estimate for blocks of size 2^( 7) =       0.000550103992

      target function =                  N/A
              le_mean =     -16.911267053022
             les_mean =     286.487200025577
             stat err =       0.000540959853
             autocorr =       1.179403002531
              std dev =       0.704447964775
             le_variance =       0.496246935075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496386593849
                                         uncertainty =       0.154229211677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496386593849
                                         uncertainty =       0.154229211677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498062617
  error estimate for blocks of size 2^( 2) =       0.000507622008
  error estimate for blocks of size 2^( 3) =       0.000518069155
  error estimate for blocks of size 2^( 4) =       0.000528526142
  error estimate for blocks of size 2^( 5) =       0.000538571009
  error estimate for blocks of size 2^( 6) =       0.000546557171
  error estimate for blocks of size 2^( 7) =       0.000550080842

      target function =                  N/A
              le_mean =     -16.911266246866
             les_mean =     286.487058565447
             stat err =       0.000540933791
             autocorr =       1.179560797994
              std dev =       0.704366908039
             le_variance =       0.496132741140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496338232279
                                         uncertainty =       0.154365142943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496338232279
                                         uncertainty =       0.154365142943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498038439
  error estimate for blocks of size 2^( 2) =       0.000507610186
  error estimate for blocks of size 2^( 3) =       0.000518070272
  error estimate for blocks of size 2^( 4) =       0.000528538851
  error estimate for blocks of size 2^( 5) =       0.000538591447
  error estimate for blocks of size 2^( 6) =       0.000546584019
  error estimate for blocks of size 2^( 7) =       0.000550108844

      target function =                  N/A
              le_mean =     -16.911267877114
             les_mean =     286.487065537271
             stat err =       0.000540955790
             autocorr =       1.179771281869
              std dev =       0.704332715282
             le_variance =       0.496084573816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911268386191        initial  <--
     6.2500e-01     6.2500e+00             6.8427e-04       -16.911267053022
     2.5000e+00     2.5000e+01             2.0624e-04       -16.911266246866
     1.0000e+01     1.0000e+02             5.4872e-05       -16.911267877114

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.0147
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.072852e-01 1 1  ON 0
 uu_1                 1.420383e-01 1 1  ON 1
 uu_2                 4.338506e-02 1 1  ON 2
 uu_3                -1.783292e-02 1 1  ON 3
 uu_4                -6.302861e-02 1 1  ON 4
 uu_5                -9.711627e-02 1 1  ON 5
 uu_6                -1.244522e-01 1 1  ON 6
 uu_7                -1.378905e-01 1 1  ON 7
 uu_8                -1.332003e-01 1 1  ON 8
 uu_9                -1.047891e-01 1 1  ON 9
 ud_0                 4.357202e-01 1 1  ON 10
 ud_1                 1.778030e-01 1 1  ON 11
 ud_2                 6.390992e-02 1 1  ON 12
 ud_3                -4.807870e-03 1 1  ON 13
 ud_4                -6.090107e-02 1 1  ON 14
 ud_5                -1.025659e-01 1 1  ON 15
 ud_6                -1.303161e-01 1 1  ON 16
 ud_7                -1.481399e-01 1 1  ON 17
 ud_8                -1.518862e-01 1 1  ON 18
 ud_9                -1.447866e-01 1 1  ON 19
 eO_0                -7.495993e-01 1 1  ON 20
 eO_1                -4.361386e-01 1 1  ON 21
 eO_2                -2.589971e-02 1 1  ON 22
 eO_3                 2.942893e-01 1 1  ON 23
 eO_4                 5.211937e-01 1 1  ON 24
 eO_5                 4.824583e-01 1 1  ON 25
 eO_6                 2.579378e-01 1 1  ON 26
 eO_7                -4.111160e-02 1 1  ON 27
 eO_8                -2.210394e-01 1 1  ON 28
 eO_9                -8.115291e-02 1 1  ON 29
eH1_0                -2.398107e-01 1 1  ON 30
eH1_1                -1.369437e-01 1 1  ON 31
eH1_2                -9.215776e-02 1 1  ON 32
eH1_3                -4.110526e-02 1 1  ON 33
eH1_4                 7.351608e-03 1 1  ON 34
eH1_5                 3.843736e-02 1 1  ON 35
eH1_6                 9.638230e-02 1 1  ON 36
eH1_7                 1.491817e-01 1 1  ON 37
eH1_8                 1.685387e-01 1 1  ON 38
eH1_9                 5.464849e-02 1 1  ON 39
eH2_0                -2.385123e-01 1 1  ON 40
eH2_1                -1.356791e-01 1 1  ON 41
eH2_2                -9.101428e-02 1 1  ON 42
eH2_3                -3.968343e-02 1 1  ON 43
eH2_4                 8.364153e-03 1 1  ON 44
eH2_5                 3.988304e-02 1 1  ON 45
eH2_6                 9.823755e-02 1 1  ON 46
eH2_7                 1.497112e-01 1 1  ON 47
eH2_8                 1.800877e-01 1 1  ON 48
eH2_9                 4.495876e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.0064
    reference variance = 0.591169
====================================================
  Execution time = 2.2909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2416e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324161613214
                                         uncertainty =       0.004113219389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324161613214
                                         uncertainty =       0.004113219389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402588646
  error estimate for blocks of size 2^( 2) =       0.000414641324
  error estimate for blocks of size 2^( 3) =       0.000427606818
  error estimate for blocks of size 2^( 4) =       0.000439550707
  error estimate for blocks of size 2^( 5) =       0.000450290185
  error estimate for blocks of size 2^( 6) =       0.000458618961
  error estimate for blocks of size 2^( 7) =       0.000462104480

      target function =                  N/A
              le_mean =     -16.909629403255
             les_mean =     286.259721629353
             stat err =       0.000452641083
             autocorr =       1.264110076000
              std dev =       0.569346323438
             le_variance =       0.324155236012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690962940325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909629403255       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909630479301       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909630615168       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909630865225       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909631137158       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909631077944       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909631058495       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909631033691       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909631039035       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.047061e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909629403255       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909629678906       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909629712027       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909629775250       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909629843606       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909629830330       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909629826270       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909629820079       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.728877e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909629403255       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909629472595       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909629480822       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909629496672       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909629513771       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909629510550       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909629509592       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909629508046       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 6.855148e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9042e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.072798e-01 1 1  ON 0
 uu_1                 1.420414e-01 1 1  ON 1
 uu_2                 4.339184e-02 1 1  ON 2
 uu_3                -1.782797e-02 1 1  ON 3
 uu_4                -6.302921e-02 1 1  ON 4
 uu_5                -9.712288e-02 1 1  ON 5
 uu_6                -1.244564e-01 1 1  ON 6
 uu_7                -1.378955e-01 1 1  ON 7
 uu_8                -1.331973e-01 1 1  ON 8
 uu_9                -1.047901e-01 1 1  ON 9
 ud_0                 4.357474e-01 1 1  ON 10
 ud_1                 1.778169e-01 1 1  ON 11
 ud_2                 6.389749e-02 1 1  ON 12
 ud_3                -4.829467e-03 1 1  ON 13
 ud_4                -6.090436e-02 1 1  ON 14
 ud_5                -1.025682e-01 1 1  ON 15
 ud_6                -1.303188e-01 1 1  ON 16
 ud_7                -1.481429e-01 1 1  ON 17
 ud_8                -1.518820e-01 1 1  ON 18
 ud_9                -1.447843e-01 1 1  ON 19
 eO_0                -7.496139e-01 1 1  ON 20
 eO_1                -4.361364e-01 1 1  ON 21
 eO_2                -2.590174e-02 1 1  ON 22
 eO_3                 2.943047e-01 1 1  ON 23
 eO_4                 5.211973e-01 1 1  ON 24
 eO_5                 4.824612e-01 1 1  ON 25
 eO_6                 2.579382e-01 1 1  ON 26
 eO_7                -4.110862e-02 1 1  ON 27
 eO_8                -2.210429e-01 1 1  ON 28
 eO_9                -8.115882e-02 1 1  ON 29
eH1_0                -2.398254e-01 1 1  ON 30
eH1_1                -1.369500e-01 1 1  ON 31
eH1_2                -9.215584e-02 1 1  ON 32
eH1_3                -4.110587e-02 1 1  ON 33
eH1_4                 7.347486e-03 1 1  ON 34
eH1_5                 3.843947e-02 1 1  ON 35
eH1_6                 9.638318e-02 1 1  ON 36
eH1_7                 1.491862e-01 1 1  ON 37
eH1_8                 1.685464e-01 1 1  ON 38
eH1_9                 5.465616e-02 1 1  ON 39
eH2_0                -2.385262e-01 1 1  ON 40
eH2_1                -1.356880e-01 1 1  ON 41
eH2_2                -9.100877e-02 1 1  ON 42
eH2_3                -3.968107e-02 1 1  ON 43
eH2_4                 8.359060e-03 1 1  ON 44
eH2_5                 3.988140e-02 1 1  ON 45
eH2_6                 9.824027e-02 1 1  ON 46
eH2_7                 1.497168e-01 1 1  ON 47
eH2_8                 1.800917e-01 1 1  ON 48
eH2_9                 4.496741e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8959
    reference variance = 0.25765
====================================================
  Execution time = 2.2697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3311e-01
  Total weights = 2.0000e+06
  Execution time = 2.4615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333165870140
                                         uncertainty =       0.004192080174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333165870140
                                         uncertainty =       0.004192080174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408102250
  error estimate for blocks of size 2^( 2) =       0.000420336189
  error estimate for blocks of size 2^( 3) =       0.000432045888
  error estimate for blocks of size 2^( 4) =       0.000444105622
  error estimate for blocks of size 2^( 5) =       0.000454181239
  error estimate for blocks of size 2^( 6) =       0.000461862622
  error estimate for blocks of size 2^( 7) =       0.000467541083

      target function =                  N/A
              le_mean =     -16.910121898891
             les_mean =     286.285317362023
             stat err =       0.000456922641
             autocorr =       1.253566503347
              std dev =       0.577143737050
             le_variance =       0.333094893216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333241335244
                                         uncertainty =       0.004194711684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333241335244
                                         uncertainty =       0.004194711684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408148445
  error estimate for blocks of size 2^( 2) =       0.000420376672
  error estimate for blocks of size 2^( 3) =       0.000432081073
  error estimate for blocks of size 2^( 4) =       0.000444137317
  error estimate for blocks of size 2^( 5) =       0.000454211112
  error estimate for blocks of size 2^( 6) =       0.000461891493
  error estimate for blocks of size 2^( 7) =       0.000467569129

      target function =                  N/A
              le_mean =     -16.910121956823
             les_mean =     286.285394735074
             stat err =       0.000456952263
             autocorr =       1.253445255327
              std dev =       0.577209067008
             le_variance =       0.333170307036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333205546018
                                         uncertainty =       0.004193455628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333205546018
                                         uncertainty =       0.004193455628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408126538
  error estimate for blocks of size 2^( 2) =       0.000420357489
  error estimate for blocks of size 2^( 3) =       0.000432064432
  error estimate for blocks of size 2^( 4) =       0.000444122359
  error estimate for blocks of size 2^( 5) =       0.000454197035
  error estimate for blocks of size 2^( 6) =       0.000461877866
  error estimate for blocks of size 2^( 7) =       0.000467555929

      target function =                  N/A
              le_mean =     -16.910121906607
             les_mean =     286.285357272015
             stat err =       0.000456938297
             autocorr =       1.253503199538
              std dev =       0.577178085414
             le_variance =       0.333134542283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170843827
                                         uncertainty =       0.004192252885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170843827
                                         uncertainty =       0.004192252885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408105295
  error estimate for blocks of size 2^( 2) =       0.000420338856
  error estimate for blocks of size 2^( 3) =       0.000432048207
  error estimate for blocks of size 2^( 4) =       0.000444107713
  error estimate for blocks of size 2^( 5) =       0.000454183212
  error estimate for blocks of size 2^( 6) =       0.000461864525
  error estimate for blocks of size 2^( 7) =       0.000467542935

      target function =                  N/A
              le_mean =     -16.910121897674
             les_mean =     286.285322291175
             stat err =       0.000456924596
             autocorr =       1.253558524973
              std dev =       0.577148042993
             le_variance =       0.333099863531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910121898891        initial
     6.2500e+00     6.2500e+01             1.0471e-04       -16.910121956823  <--
     2.5000e+01     2.5000e+02             2.7289e-05       -16.910121906607
     1.0000e+02     1.0000e+03             6.8551e-06       -16.910121897674

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 3.5296e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.072656e-01 1 1  ON 0
 uu_1                 1.420503e-01 1 1  ON 1
 uu_2                 4.341051e-02 1 1  ON 2
 uu_3                -1.781333e-02 1 1  ON 3
 uu_4                -6.303143e-02 1 1  ON 4
 uu_5                -9.714178e-02 1 1  ON 5
 uu_6                -1.244684e-01 1 1  ON 6
 uu_7                -1.379105e-01 1 1  ON 7
 uu_8                -1.331888e-01 1 1  ON 8
 uu_9                -1.047942e-01 1 1  ON 9
 ud_0                 4.358249e-01 1 1  ON 10
 ud_1                 1.778581e-01 1 1  ON 11
 ud_2                 6.386380e-02 1 1  ON 12
 ud_3                -4.890890e-03 1 1  ON 13
 ud_4                -6.091481e-02 1 1  ON 14
 ud_5                -1.025753e-01 1 1  ON 15
 ud_6                -1.303258e-01 1 1  ON 16
 ud_7                -1.481520e-01 1 1  ON 17
 ud_8                -1.518699e-01 1 1  ON 18
 ud_9                -1.447777e-01 1 1  ON 19
 eO_0                -7.496575e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.590832e-02 1 1  ON 22
 eO_3                 2.943485e-01 1 1  ON 23
 eO_4                 5.212106e-01 1 1  ON 24
 eO_5                 4.824720e-01 1 1  ON 25
 eO_6                 2.579400e-01 1 1  ON 26
 eO_7                -4.109929e-02 1 1  ON 27
 eO_8                -2.210545e-01 1 1  ON 28
 eO_9                -8.117789e-02 1 1  ON 29
eH1_0                -2.398697e-01 1 1  ON 30
eH1_1                -1.369692e-01 1 1  ON 31
eH1_2                -9.215249e-02 1 1  ON 32
eH1_3                -4.110757e-02 1 1  ON 33
eH1_4                 7.334423e-03 1 1  ON 34
eH1_5                 3.844538e-02 1 1  ON 35
eH1_6                 9.638624e-02 1 1  ON 36
eH1_7                 1.492005e-01 1 1  ON 37
eH1_8                 1.685709e-01 1 1  ON 38
eH1_9                 5.468060e-02 1 1  ON 39
eH2_0                -2.385686e-01 1 1  ON 40
eH2_1                -1.357152e-01 1 1  ON 41
eH2_2                -9.099249e-02 1 1  ON 42
eH2_3                -3.967286e-02 1 1  ON 43
eH2_4                 8.341672e-03 1 1  ON 44
eH2_5                 3.987528e-02 1 1  ON 45
eH2_6                 9.824880e-02 1 1  ON 46
eH2_7                 1.497343e-01 1 1  ON 47
eH2_8                 1.801045e-01 1 1  ON 48
eH2_9                 4.499506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8881
    reference variance = 0.240551
====================================================
  Execution time = 2.3095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2955e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329623886465
                                         uncertainty =       0.004236656300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329623886465
                                         uncertainty =       0.004236656300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405924708
  error estimate for blocks of size 2^( 2) =       0.000417895874
  error estimate for blocks of size 2^( 3) =       0.000430333504
  error estimate for blocks of size 2^( 4) =       0.000442212676
  error estimate for blocks of size 2^( 5) =       0.000451554621
  error estimate for blocks of size 2^( 6) =       0.000458582092
  error estimate for blocks of size 2^( 7) =       0.000462712350

      target function =                  N/A
              le_mean =     -16.909859141755
             les_mean =     286.272885766183
             stat err =       0.000453765435
             autocorr =       1.249602391140
              std dev =       0.574064227216
             le_variance =       0.329549736969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690985914175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909859141755       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909864519342       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909866014179       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909865751256       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909865207161       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909865571580       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909865509536       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909865681965       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909865664609       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.898884e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909859141755       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909860615806       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909861082451       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909861036685       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909860892014       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909860980116       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909860959370       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909860994608       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909860995465       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.040957e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909859141755       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909859519372       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909859643330       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909859633701       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909859597630       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909859619758       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909859614250       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909859622355       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909859622572       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.638431e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9307e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.072637e-01 1 1  ON 0
 uu_1                 1.420429e-01 1 1  ON 1
 uu_2                 4.342904e-02 1 1  ON 2
 uu_3                -1.779827e-02 1 1  ON 3
 uu_4                -6.303676e-02 1 1  ON 4
 uu_5                -9.717264e-02 1 1  ON 5
 uu_6                -1.244650e-01 1 1  ON 6
 uu_7                -1.379022e-01 1 1  ON 7
 uu_8                -1.331799e-01 1 1  ON 8
 uu_9                -1.048121e-01 1 1  ON 9
 ud_0                 4.359290e-01 1 1  ON 10
 ud_1                 1.779427e-01 1 1  ON 11
 ud_2                 6.382159e-02 1 1  ON 12
 ud_3                -4.944349e-03 1 1  ON 13
 ud_4                -6.093327e-02 1 1  ON 14
 ud_5                -1.025792e-01 1 1  ON 15
 ud_6                -1.303449e-01 1 1  ON 16
 ud_7                -1.481785e-01 1 1  ON 17
 ud_8                -1.518743e-01 1 1  ON 18
 ud_9                -1.447835e-01 1 1  ON 19
 eO_0                -7.497021e-01 1 1  ON 20
 eO_1                -4.361201e-01 1 1  ON 21
 eO_2                -2.591883e-02 1 1  ON 22
 eO_3                 2.943934e-01 1 1  ON 23
 eO_4                 5.212383e-01 1 1  ON 24
 eO_5                 4.824766e-01 1 1  ON 25
 eO_6                 2.579424e-01 1 1  ON 26
 eO_7                -4.108096e-02 1 1  ON 27
 eO_8                -2.210749e-01 1 1  ON 28
 eO_9                -8.120628e-02 1 1  ON 29
eH1_0                -2.399371e-01 1 1  ON 30
eH1_1                -1.369988e-01 1 1  ON 31
eH1_2                -9.210988e-02 1 1  ON 32
eH1_3                -4.109936e-02 1 1  ON 33
eH1_4                 7.343938e-03 1 1  ON 34
eH1_5                 3.843892e-02 1 1  ON 35
eH1_6                 9.639083e-02 1 1  ON 36
eH1_7                 1.491965e-01 1 1  ON 37
eH1_8                 1.685826e-01 1 1  ON 38
eH1_9                 5.470864e-02 1 1  ON 39
eH2_0                -2.386287e-01 1 1  ON 40
eH2_1                -1.357491e-01 1 1  ON 41
eH2_2                -9.098172e-02 1 1  ON 42
eH2_3                -3.967720e-02 1 1  ON 43
eH2_4                 8.336591e-03 1 1  ON 44
eH2_5                 3.989588e-02 1 1  ON 45
eH2_6                 9.826498e-02 1 1  ON 46
eH2_7                 1.497381e-01 1 1  ON 47
eH2_8                 1.801216e-01 1 1  ON 48
eH2_9                 4.502900e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9612
    reference variance = 0.757099
====================================================
  Execution time = 2.4900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2702e-01
  Total weights = 2.0000e+06
  Execution time = 2.4753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327042957086
                                         uncertainty =       0.003159284110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327042957086
                                         uncertainty =       0.003159284110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404329172
  error estimate for blocks of size 2^( 2) =       0.000416462207
  error estimate for blocks of size 2^( 3) =       0.000428912119
  error estimate for blocks of size 2^( 4) =       0.000440903396
  error estimate for blocks of size 2^( 5) =       0.000450563109
  error estimate for blocks of size 2^( 6) =       0.000458131715
  error estimate for blocks of size 2^( 7) =       0.000464013718

      target function =                  N/A
              le_mean =     -16.910438982662
             les_mean =     286.289910582125
             stat err =       0.000453402985
             autocorr =       1.257472787399
              std dev =       0.571807799249
             le_variance =       0.326964159281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327256013555
                                         uncertainty =       0.003161009055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327256013555
                                         uncertainty =       0.003161009055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404460868
  error estimate for blocks of size 2^( 2) =       0.000416578743
  error estimate for blocks of size 2^( 3) =       0.000429010919
  error estimate for blocks of size 2^( 4) =       0.000440989182
  error estimate for blocks of size 2^( 5) =       0.000450652037
  error estimate for blocks of size 2^( 6) =       0.000458210082
  error estimate for blocks of size 2^( 7) =       0.000464086832

      target function =                  N/A
              le_mean =     -16.910437563751
             les_mean =     286.290075622151
             stat err =       0.000453484533
             autocorr =       1.257106113487
              std dev =       0.571994045622
             le_variance =       0.327177188227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327157799617
                                         uncertainty =       0.003160176732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327157799617
                                         uncertainty =       0.003160176732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404400167
  error estimate for blocks of size 2^( 2) =       0.000416524778
  error estimate for blocks of size 2^( 3) =       0.000428964732
  error estimate for blocks of size 2^( 4) =       0.000440948797
  error estimate for blocks of size 2^( 5) =       0.000450610360
  error estimate for blocks of size 2^( 6) =       0.000458173155
  error estimate for blocks of size 2^( 7) =       0.000464052376

      target function =                  N/A
              le_mean =     -16.910437942619
             les_mean =     286.289990238572
             stat err =       0.000453446172
             autocorr =       1.257270790655
              std dev =       0.571908201496
             le_variance =       0.327078990939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327057408722
                                         uncertainty =       0.003159395738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327057408722
                                         uncertainty =       0.003159395738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404338107
  error estimate for blocks of size 2^( 2) =       0.000416470046
  error estimate for blocks of size 2^( 3) =       0.000428918661
  error estimate for blocks of size 2^( 4) =       0.000440909006
  error estimate for blocks of size 2^( 5) =       0.000450568957
  error estimate for blocks of size 2^( 6) =       0.000458136821
  error estimate for blocks of size 2^( 7) =       0.000464018476

      target function =                  N/A
              le_mean =     -16.910438811991
             les_mean =     286.289919260313
             stat err =       0.000453408315
             autocorr =       1.257446780721
              std dev =       0.571820434858
             le_variance =       0.326978609721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910438982662        initial  <--
     1.5625e+00     1.5625e+01             3.8989e-04       -16.910437563751
     6.2500e+00     6.2500e+01             1.0410e-04       -16.910437942619
     2.5000e+01     2.5000e+02             2.6384e-05       -16.910438811991

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5098
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.072656e-01 1 1  ON 0
 uu_1                 1.420503e-01 1 1  ON 1
 uu_2                 4.341051e-02 1 1  ON 2
 uu_3                -1.781333e-02 1 1  ON 3
 uu_4                -6.303143e-02 1 1  ON 4
 uu_5                -9.714178e-02 1 1  ON 5
 uu_6                -1.244684e-01 1 1  ON 6
 uu_7                -1.379105e-01 1 1  ON 7
 uu_8                -1.331888e-01 1 1  ON 8
 uu_9                -1.047942e-01 1 1  ON 9
 ud_0                 4.358249e-01 1 1  ON 10
 ud_1                 1.778581e-01 1 1  ON 11
 ud_2                 6.386380e-02 1 1  ON 12
 ud_3                -4.890890e-03 1 1  ON 13
 ud_4                -6.091481e-02 1 1  ON 14
 ud_5                -1.025753e-01 1 1  ON 15
 ud_6                -1.303258e-01 1 1  ON 16
 ud_7                -1.481520e-01 1 1  ON 17
 ud_8                -1.518699e-01 1 1  ON 18
 ud_9                -1.447777e-01 1 1  ON 19
 eO_0                -7.496575e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.590832e-02 1 1  ON 22
 eO_3                 2.943485e-01 1 1  ON 23
 eO_4                 5.212106e-01 1 1  ON 24
 eO_5                 4.824720e-01 1 1  ON 25
 eO_6                 2.579400e-01 1 1  ON 26
 eO_7                -4.109929e-02 1 1  ON 27
 eO_8                -2.210545e-01 1 1  ON 28
 eO_9                -8.117789e-02 1 1  ON 29
eH1_0                -2.398697e-01 1 1  ON 30
eH1_1                -1.369692e-01 1 1  ON 31
eH1_2                -9.215249e-02 1 1  ON 32
eH1_3                -4.110757e-02 1 1  ON 33
eH1_4                 7.334423e-03 1 1  ON 34
eH1_5                 3.844538e-02 1 1  ON 35
eH1_6                 9.638624e-02 1 1  ON 36
eH1_7                 1.492005e-01 1 1  ON 37
eH1_8                 1.685709e-01 1 1  ON 38
eH1_9                 5.468060e-02 1 1  ON 39
eH2_0                -2.385686e-01 1 1  ON 40
eH2_1                -1.357152e-01 1 1  ON 41
eH2_2                -9.099249e-02 1 1  ON 42
eH2_3                -3.967286e-02 1 1  ON 43
eH2_4                 8.341672e-03 1 1  ON 44
eH2_5                 3.987528e-02 1 1  ON 45
eH2_6                 9.824880e-02 1 1  ON 46
eH2_7                 1.497343e-01 1 1  ON 47
eH2_8                 1.801045e-01 1 1  ON 48
eH2_9                 4.499506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8725
    reference variance = 0.293129
====================================================
  Execution time = 2.2985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3882e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338868156096
                                         uncertainty =       0.009037463238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338868156096
                                         uncertainty =       0.009037463238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411595773
  error estimate for blocks of size 2^( 2) =       0.000423137307
  error estimate for blocks of size 2^( 3) =       0.000435919754
  error estimate for blocks of size 2^( 4) =       0.000447878881
  error estimate for blocks of size 2^( 5) =       0.000456945638
  error estimate for blocks of size 2^( 6) =       0.000464522824
  error estimate for blocks of size 2^( 7) =       0.000467339608

      target function =                  N/A
              le_mean =     -16.908789713735
             les_mean =     286.245991574826
             stat err =       0.000459171738
             autocorr =       1.244538929733
              std dev =       0.582084324586
             le_variance =       0.338822160929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690878971373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908789713735       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908790436036       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908790621900       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908790637208       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908790629987       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908790588631       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908790593789       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908790583234       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908790584565       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.827768e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908789713735       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908789896103       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908789943706       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908789947869       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908789946666       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908789936629       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908789937651       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908789934796       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 9.689601e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908789713735       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908789759440       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908789771414       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908789772476       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908789772214       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908789769726       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908789769966       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908789769238       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.424605e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9183e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.072641e-01 1 1  ON 0
 uu_1                 1.420501e-01 1 1  ON 1
 uu_2                 4.341284e-02 1 1  ON 2
 uu_3                -1.781250e-02 1 1  ON 3
 uu_4                -6.303160e-02 1 1  ON 4
 uu_5                -9.714525e-02 1 1  ON 5
 uu_6                -1.244697e-01 1 1  ON 6
 uu_7                -1.379117e-01 1 1  ON 7
 uu_8                -1.331867e-01 1 1  ON 8
 uu_9                -1.047944e-01 1 1  ON 9
 ud_0                 4.358345e-01 1 1  ON 10
 ud_1                 1.778657e-01 1 1  ON 11
 ud_2                 6.385906e-02 1 1  ON 12
 ud_3                -4.898695e-03 1 1  ON 13
 ud_4                -6.091577e-02 1 1  ON 14
 ud_5                -1.025770e-01 1 1  ON 15
 ud_6                -1.303275e-01 1 1  ON 16
 ud_7                -1.481531e-01 1 1  ON 17
 ud_8                -1.518676e-01 1 1  ON 18
 ud_9                -1.447774e-01 1 1  ON 19
 eO_0                -7.496625e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.590933e-02 1 1  ON 22
 eO_3                 2.943541e-01 1 1  ON 23
 eO_4                 5.212121e-01 1 1  ON 24
 eO_5                 4.824734e-01 1 1  ON 25
 eO_6                 2.579403e-01 1 1  ON 26
 eO_7                -4.109797e-02 1 1  ON 27
 eO_8                -2.210557e-01 1 1  ON 28
 eO_9                -8.118039e-02 1 1  ON 29
eH1_0                -2.398768e-01 1 1  ON 30
eH1_1                -1.369721e-01 1 1  ON 31
eH1_2                -9.215043e-02 1 1  ON 32
eH1_3                -4.110575e-02 1 1  ON 33
eH1_4                 7.333786e-03 1 1  ON 34
eH1_5                 3.844552e-02 1 1  ON 35
eH1_6                 9.638613e-02 1 1  ON 36
eH1_7                 1.492010e-01 1 1  ON 37
eH1_8                 1.685739e-01 1 1  ON 38
eH1_9                 5.468381e-02 1 1  ON 39
eH2_0                -2.385745e-01 1 1  ON 40
eH2_1                -1.357196e-01 1 1  ON 41
eH2_2                -9.098972e-02 1 1  ON 42
eH2_3                -3.967303e-02 1 1  ON 43
eH2_4                 8.343046e-03 1 1  ON 44
eH2_5                 3.987456e-02 1 1  ON 45
eH2_6                 9.825083e-02 1 1  ON 46
eH2_7                 1.497356e-01 1 1  ON 47
eH2_8                 1.801057e-01 1 1  ON 48
eH2_9                 4.499788e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8943
    reference variance = 0.270618
====================================================
  Execution time = 2.2730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3669e-01
  Total weights = 2.0000e+06
  Execution time = 2.4647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336636109169
                                         uncertainty =       0.005505025566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336636109169
                                         uncertainty =       0.005505025566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410297262
  error estimate for blocks of size 2^( 2) =       0.000421633806
  error estimate for blocks of size 2^( 3) =       0.000433581700
  error estimate for blocks of size 2^( 4) =       0.000445909302
  error estimate for blocks of size 2^( 5) =       0.000455749520
  error estimate for blocks of size 2^( 6) =       0.000462193938
  error estimate for blocks of size 2^( 7) =       0.000467266133

      target function =                  N/A
              le_mean =     -16.909485068370
             les_mean =     286.267372794889
             stat err =       0.000457779723
             autocorr =       1.244846686409
              std dev =       0.580247952018
             le_variance =       0.336687685821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336658029502
                                         uncertainty =       0.005505203625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336658029502
                                         uncertainty =       0.005505203625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410310618
  error estimate for blocks of size 2^( 2) =       0.000421644928
  error estimate for blocks of size 2^( 3) =       0.000433590819
  error estimate for blocks of size 2^( 4) =       0.000445916673
  error estimate for blocks of size 2^( 5) =       0.000455756334
  error estimate for blocks of size 2^( 6) =       0.000462200931
  error estimate for blocks of size 2^( 7) =       0.000467272626

      target function =                  N/A
              le_mean =     -16.909485272253
             les_mean =     286.267401609981
             stat err =       0.000457786641
             autocorr =       1.244803268773
              std dev =       0.580266840167
             le_variance =       0.336709605797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336647154628
                                         uncertainty =       0.005505114762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336647154628
                                         uncertainty =       0.005505114762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410303991
  error estimate for blocks of size 2^( 2) =       0.000421639400
  error estimate for blocks of size 2^( 3) =       0.000433586281
  error estimate for blocks of size 2^( 4) =       0.000445912996
  error estimate for blocks of size 2^( 5) =       0.000455752935
  error estimate for blocks of size 2^( 6) =       0.000462197444
  error estimate for blocks of size 2^( 7) =       0.000467269388

      target function =                  N/A
              le_mean =     -16.909485167509
             les_mean =     286.267387192391
             stat err =       0.000457783191
             autocorr =       1.244824709262
              std dev =       0.580257469188
             le_variance =       0.336698730549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336637488610
                                         uncertainty =       0.005505036663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336637488610
                                         uncertainty =       0.005505036663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410298102
  error estimate for blocks of size 2^( 2) =       0.000421634504
  error estimate for blocks of size 2^( 3) =       0.000433582271
  error estimate for blocks of size 2^( 4) =       0.000445909761
  error estimate for blocks of size 2^( 5) =       0.000455749944
  error estimate for blocks of size 2^( 6) =       0.000462194374
  error estimate for blocks of size 2^( 7) =       0.000467266538

      target function =                  N/A
              le_mean =     -16.909485080459
             les_mean =     286.267374583087
             stat err =       0.000457780154
             autocorr =       1.244843931008
              std dev =       0.580249140603
             le_variance =       0.336689065170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909485068370        initial
     1.5625e+01     1.5625e+02             3.8278e-05       -16.909485272253  <--
     6.2500e+01     6.2500e+02             9.6896e-06       -16.909485167509
     2.5000e+02     2.5000e+03             2.4246e-06       -16.909485080459

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 3.5231e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.072601e-01 1 1  ON 0
 uu_1                 1.420495e-01 1 1  ON 1
 uu_2                 4.341927e-02 1 1  ON 2
 uu_3                -1.780981e-02 1 1  ON 3
 uu_4                -6.303218e-02 1 1  ON 4
 uu_5                -9.715548e-02 1 1  ON 5
 uu_6                -1.244738e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331806e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358631e-01 1 1  ON 10
 ud_1                 1.778882e-01 1 1  ON 11
 ud_2                 6.384550e-02 1 1  ON 12
 ud_3                -4.921347e-03 1 1  ON 13
 ud_4                -6.091879e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303321e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518610e-01 1 1  ON 18
 ud_9                -1.447767e-01 1 1  ON 19
 eO_0                -7.496780e-01 1 1  ON 20
 eO_1                -4.361308e-01 1 1  ON 21
 eO_2                -2.591283e-02 1 1  ON 22
 eO_3                 2.943705e-01 1 1  ON 23
 eO_4                 5.212175e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579417e-01 1 1  ON 26
 eO_7                -4.109379e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118845e-02 1 1  ON 29
eH1_0                -2.398983e-01 1 1  ON 30
eH1_1                -1.369812e-01 1 1  ON 31
eH1_2                -9.214455e-02 1 1  ON 32
eH1_3                -4.109978e-02 1 1  ON 33
eH1_4                 7.330789e-03 1 1  ON 34
eH1_5                 3.844565e-02 1 1  ON 35
eH1_6                 9.638605e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685833e-01 1 1  ON 38
eH1_9                 5.469404e-02 1 1  ON 39
eH2_0                -2.385923e-01 1 1  ON 40
eH2_1                -1.357326e-01 1 1  ON 41
eH2_2                -9.098232e-02 1 1  ON 42
eH2_3                -3.967284e-02 1 1  ON 43
eH2_4                 8.346151e-03 1 1  ON 44
eH2_5                 3.987212e-02 1 1  ON 45
eH2_6                 9.825725e-02 1 1  ON 46
eH2_7                 1.497395e-01 1 1  ON 47
eH2_8                 1.801095e-01 1 1  ON 48
eH2_9                 4.500692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8653
    reference variance = 0.226024
====================================================
  Execution time = 2.2996e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2646e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326514110331
                                         uncertainty =       0.003600616627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326514110331
                                         uncertainty =       0.003600616627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404016563
  error estimate for blocks of size 2^( 2) =       0.000415590007
  error estimate for blocks of size 2^( 3) =       0.000427699141
  error estimate for blocks of size 2^( 4) =       0.000439477372
  error estimate for blocks of size 2^( 5) =       0.000450396126
  error estimate for blocks of size 2^( 6) =       0.000458374676
  error estimate for blocks of size 2^( 7) =       0.000465309364

      target function =                  N/A
              le_mean =     -16.910709254079
             les_mean =     286.298546078335
             stat err =       0.000453389385
             autocorr =       1.259343940051
              std dev =       0.571365702144
             le_variance =       0.326458765586


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691070925408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910709254079       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910710250808       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910711147480       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910711206275       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910711263230       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910711560636       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910711483536       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910711474117       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910711472828       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.440963e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910709254079       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910709513092       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910709753503       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910709772274       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910709782001       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910709862703       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910709842233       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910709839901       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910709839555       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.709080e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910709254079       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910709319477       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910709380681       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910709385669       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910709387847       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910709408422       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910709403251       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910709402635       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 9.410576e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9084e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.072587e-01 1 1  ON 0
 uu_1                 1.420451e-01 1 1  ON 1
 uu_2                 4.342936e-02 1 1  ON 2
 uu_3                -1.780163e-02 1 1  ON 3
 uu_4                -6.303727e-02 1 1  ON 4
 uu_5                -9.716304e-02 1 1  ON 5
 uu_6                -1.244867e-01 1 1  ON 6
 uu_7                -1.379185e-01 1 1  ON 7
 uu_8                -1.331774e-01 1 1  ON 8
 uu_9                -1.047960e-01 1 1  ON 9
 ud_0                 4.359002e-01 1 1  ON 10
 ud_1                 1.779146e-01 1 1  ON 11
 ud_2                 6.382570e-02 1 1  ON 12
 ud_3                -4.948311e-03 1 1  ON 13
 ud_4                -6.092459e-02 1 1  ON 14
 ud_5                -1.025778e-01 1 1  ON 15
 ud_6                -1.303395e-01 1 1  ON 16
 ud_7                -1.481621e-01 1 1  ON 17
 ud_8                -1.518592e-01 1 1  ON 18
 ud_9                -1.447750e-01 1 1  ON 19
 eO_0                -7.496991e-01 1 1  ON 20
 eO_1                -4.361231e-01 1 1  ON 21
 eO_2                -2.591214e-02 1 1  ON 22
 eO_3                 2.943865e-01 1 1  ON 23
 eO_4                 5.212235e-01 1 1  ON 24
 eO_5                 4.824810e-01 1 1  ON 25
 eO_6                 2.579439e-01 1 1  ON 26
 eO_7                -4.109019e-02 1 1  ON 27
 eO_8                -2.210671e-01 1 1  ON 28
 eO_9                -8.119721e-02 1 1  ON 29
eH1_0                -2.399253e-01 1 1  ON 30
eH1_1                -1.369953e-01 1 1  ON 31
eH1_2                -9.213147e-02 1 1  ON 32
eH1_3                -4.109756e-02 1 1  ON 33
eH1_4                 7.322778e-03 1 1  ON 34
eH1_5                 3.845101e-02 1 1  ON 35
eH1_6                 9.638971e-02 1 1  ON 36
eH1_7                 1.492021e-01 1 1  ON 37
eH1_8                 1.685931e-01 1 1  ON 38
eH1_9                 5.470780e-02 1 1  ON 39
eH2_0                -2.386276e-01 1 1  ON 40
eH2_1                -1.357439e-01 1 1  ON 41
eH2_2                -9.097503e-02 1 1  ON 42
eH2_3                -3.966952e-02 1 1  ON 43
eH2_4                 8.347820e-03 1 1  ON 44
eH2_5                 3.987241e-02 1 1  ON 45
eH2_6                 9.826346e-02 1 1  ON 46
eH2_7                 1.497461e-01 1 1  ON 47
eH2_8                 1.801181e-01 1 1  ON 48
eH2_9                 4.501949e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9725
    reference variance = 0.199965
====================================================
  Execution time = 2.2492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3246e-01
  Total weights = 2.0000e+06
  Execution time = 2.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332544014902
                                         uncertainty =       0.003764109591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332544014902
                                         uncertainty =       0.003764109591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407700825
  error estimate for blocks of size 2^( 2) =       0.000419562734
  error estimate for blocks of size 2^( 3) =       0.000432016455
  error estimate for blocks of size 2^( 4) =       0.000443021663
  error estimate for blocks of size 2^( 5) =       0.000453047189
  error estimate for blocks of size 2^( 6) =       0.000456931227
  error estimate for blocks of size 2^( 7) =       0.000462188301

      target function =                  N/A
              le_mean =     -16.910479609080
             les_mean =     286.296760367518
             stat err =       0.000453797095
             autocorr =       1.238911383987
              std dev =       0.576576035431
             le_variance =       0.332439924634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332633759843
                                         uncertainty =       0.003765340268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332633759843
                                         uncertainty =       0.003765340268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407755867
  error estimate for blocks of size 2^( 2) =       0.000419609935
  error estimate for blocks of size 2^( 3) =       0.000432057070
  error estimate for blocks of size 2^( 4) =       0.000443057575
  error estimate for blocks of size 2^( 5) =       0.000453081618
  error estimate for blocks of size 2^( 6) =       0.000456968037
  error estimate for blocks of size 2^( 7) =       0.000462221829

      target function =                  N/A
              le_mean =     -16.910479460296
             les_mean =     286.296845105261
             stat err =       0.000453832265
             autocorr =       1.238768915656
              std dev =       0.576653877505
             le_variance =       0.332529694442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590295314
                                         uncertainty =       0.003764743816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332590295314
                                         uncertainty =       0.003764743816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407729211
  error estimate for blocks of size 2^( 2) =       0.000419586968
  error estimate for blocks of size 2^( 3) =       0.000432037250
  error estimate for blocks of size 2^( 4) =       0.000443039975
  error estimate for blocks of size 2^( 5) =       0.000453064742
  error estimate for blocks of size 2^( 6) =       0.000456950060
  error estimate for blocks of size 2^( 7) =       0.000462205306

      target function =                  N/A
              le_mean =     -16.910479482028
             les_mean =     286.296802365005
             stat err =       0.000453815021
             autocorr =       1.238836746642
              std dev =       0.576616180094
             le_variance =       0.332486219147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332549930093
                                         uncertainty =       0.003764190252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332549930093
                                         uncertainty =       0.003764190252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407704453
  error estimate for blocks of size 2^( 2) =       0.000419565830
  error estimate for blocks of size 2^( 3) =       0.000432019111
  error estimate for blocks of size 2^( 4) =       0.000443024002
  error estimate for blocks of size 2^( 5) =       0.000453049432
  error estimate for blocks of size 2^( 6) =       0.000456933631
  error estimate for blocks of size 2^( 7) =       0.000462190471

      target function =                  N/A
              le_mean =     -16.910479587167
             les_mean =     286.296765543352
             stat err =       0.000453799384
             autocorr =       1.238901829477
              std dev =       0.576581166521
             le_variance =       0.332445841587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910479609080        initial  <--
     3.9062e+00     3.9062e+01             1.4410e-04       -16.910479460296
     1.5625e+01     1.5625e+02             3.7091e-05       -16.910479482028
     6.2500e+01     6.2500e+02             9.4106e-06       -16.910479587167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.0647
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.072601e-01 1 1  ON 0
 uu_1                 1.420495e-01 1 1  ON 1
 uu_2                 4.341927e-02 1 1  ON 2
 uu_3                -1.780981e-02 1 1  ON 3
 uu_4                -6.303218e-02 1 1  ON 4
 uu_5                -9.715548e-02 1 1  ON 5
 uu_6                -1.244738e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331806e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358631e-01 1 1  ON 10
 ud_1                 1.778882e-01 1 1  ON 11
 ud_2                 6.384550e-02 1 1  ON 12
 ud_3                -4.921347e-03 1 1  ON 13
 ud_4                -6.091879e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303321e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518610e-01 1 1  ON 18
 ud_9                -1.447767e-01 1 1  ON 19
 eO_0                -7.496780e-01 1 1  ON 20
 eO_1                -4.361308e-01 1 1  ON 21
 eO_2                -2.591283e-02 1 1  ON 22
 eO_3                 2.943705e-01 1 1  ON 23
 eO_4                 5.212175e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579417e-01 1 1  ON 26
 eO_7                -4.109379e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118845e-02 1 1  ON 29
eH1_0                -2.398983e-01 1 1  ON 30
eH1_1                -1.369812e-01 1 1  ON 31
eH1_2                -9.214455e-02 1 1  ON 32
eH1_3                -4.109978e-02 1 1  ON 33
eH1_4                 7.330789e-03 1 1  ON 34
eH1_5                 3.844565e-02 1 1  ON 35
eH1_6                 9.638605e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685833e-01 1 1  ON 38
eH1_9                 5.469404e-02 1 1  ON 39
eH2_0                -2.385923e-01 1 1  ON 40
eH2_1                -1.357326e-01 1 1  ON 41
eH2_2                -9.098232e-02 1 1  ON 42
eH2_3                -3.967284e-02 1 1  ON 43
eH2_4                 8.346151e-03 1 1  ON 44
eH2_5                 3.987212e-02 1 1  ON 45
eH2_6                 9.825725e-02 1 1  ON 46
eH2_7                 1.497395e-01 1 1  ON 47
eH2_8                 1.801095e-01 1 1  ON 48
eH2_9                 4.500692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.136401
====================================================
  Execution time = 2.3153e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3062e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330708366960
                                         uncertainty =       0.004604481151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330708366960
                                         uncertainty =       0.004604481151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406583008
  error estimate for blocks of size 2^( 2) =       0.000419033724
  error estimate for blocks of size 2^( 3) =       0.000431539432
  error estimate for blocks of size 2^( 4) =       0.000443693112
  error estimate for blocks of size 2^( 5) =       0.000453514577
  error estimate for blocks of size 2^( 6) =       0.000461143120
  error estimate for blocks of size 2^( 7) =       0.000466706039

      target function =                  N/A
              le_mean =     -16.910177448681
             les_mean =     286.284720665217
             stat err =       0.000456264212
             autocorr =       1.259314958091
              std dev =       0.574995204030
             le_variance =       0.330619484658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691017744868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910177448681       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910177574208       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910177597206       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910177599657       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910177598308       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910177609273       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910177621639       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910177620904       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910177621970       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.214930e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910177448681       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910177480188       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910177485994       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910177486586       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910177486121       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910177488802       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910177491909       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910177491738       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910177492010       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.066624e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910177448681       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910177456565       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910177458020       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910177458167       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910177458042       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910177458710       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910177459487       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910177459446       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910177459512       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 7.685158e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9241e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.072592e-01 1 1  ON 0
 uu_1                 1.420494e-01 1 1  ON 1
 uu_2                 4.342010e-02 1 1  ON 2
 uu_3                -1.780921e-02 1 1  ON 3
 uu_4                -6.303223e-02 1 1  ON 4
 uu_5                -9.715615e-02 1 1  ON 5
 uu_6                -1.244751e-01 1 1  ON 6
 uu_7                -1.379161e-01 1 1  ON 7
 uu_8                -1.331799e-01 1 1  ON 8
 uu_9                -1.047951e-01 1 1  ON 9
 ud_0                 4.358657e-01 1 1  ON 10
 ud_1                 1.778913e-01 1 1  ON 11
 ud_2                 6.384316e-02 1 1  ON 12
 ud_3                -4.923869e-03 1 1  ON 13
 ud_4                -6.092010e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303334e-01 1 1  ON 16
 ud_7                -1.481568e-01 1 1  ON 17
 ud_8                -1.518598e-01 1 1  ON 18
 ud_9                -1.447757e-01 1 1  ON 19
 eO_0                -7.496801e-01 1 1  ON 20
 eO_1                -4.361302e-01 1 1  ON 21
 eO_2                -2.591299e-02 1 1  ON 22
 eO_3                 2.943722e-01 1 1  ON 23
 eO_4                 5.212179e-01 1 1  ON 24
 eO_5                 4.824795e-01 1 1  ON 25
 eO_6                 2.579416e-01 1 1  ON 26
 eO_7                -4.109381e-02 1 1  ON 27
 eO_8                -2.210601e-01 1 1  ON 28
 eO_9                -8.118903e-02 1 1  ON 29
eH1_0                -2.399013e-01 1 1  ON 30
eH1_1                -1.369831e-01 1 1  ON 31
eH1_2                -9.214382e-02 1 1  ON 32
eH1_3                -4.109991e-02 1 1  ON 33
eH1_4                 7.330828e-03 1 1  ON 34
eH1_5                 3.844564e-02 1 1  ON 35
eH1_6                 9.638693e-02 1 1  ON 36
eH1_7                 1.492038e-01 1 1  ON 37
eH1_8                 1.685846e-01 1 1  ON 38
eH1_9                 5.469524e-02 1 1  ON 39
eH2_0                -2.385953e-01 1 1  ON 40
eH2_1                -1.357346e-01 1 1  ON 41
eH2_2                -9.098068e-02 1 1  ON 42
eH2_3                -3.967314e-02 1 1  ON 43
eH2_4                 8.346518e-03 1 1  ON 44
eH2_5                 3.987230e-02 1 1  ON 45
eH2_6                 9.825815e-02 1 1  ON 46
eH2_7                 1.497397e-01 1 1  ON 47
eH2_8                 1.801099e-01 1 1  ON 48
eH2_9                 4.500836e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9053
    reference variance = 0.359277
====================================================
  Execution time = 2.2896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3059e-01
  Total weights = 2.0000e+06
  Execution time = 2.4831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330606398901
                                         uncertainty =       0.004988881282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330606398901
                                         uncertainty =       0.004988881282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406566731
  error estimate for blocks of size 2^( 2) =       0.000418103851
  error estimate for blocks of size 2^( 3) =       0.000429880893
  error estimate for blocks of size 2^( 4) =       0.000441611473
  error estimate for blocks of size 2^( 5) =       0.000450875118
  error estimate for blocks of size 2^( 6) =       0.000457181073
  error estimate for blocks of size 2^( 7) =       0.000461306263

      target function =                  N/A
              le_mean =     -16.910323141044
             les_mean =     286.289621582771
             stat err =       0.000452743482
             autocorr =       1.240054399341
              std dev =       0.574972185004
             le_variance =       0.330593013528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330611471695
                                         uncertainty =       0.004988798020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330611471695
                                         uncertainty =       0.004988798020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406569853
  error estimate for blocks of size 2^( 2) =       0.000418106351
  error estimate for blocks of size 2^( 3) =       0.000429882701
  error estimate for blocks of size 2^( 4) =       0.000441612587
  error estimate for blocks of size 2^( 5) =       0.000450876052
  error estimate for blocks of size 2^( 6) =       0.000457182004
  error estimate for blocks of size 2^( 7) =       0.000461307597

      target function =                  N/A
              le_mean =     -16.910323005617
             les_mean =     286.289622079498
             stat err =       0.000452744560
             autocorr =       1.240041262418
              std dev =       0.574976599945
             le_variance =       0.330598090484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330608929596
                                         uncertainty =       0.004988839070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330608929596
                                         uncertainty =       0.004988839070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406568288
  error estimate for blocks of size 2^( 2) =       0.000418105096
  error estimate for blocks of size 2^( 3) =       0.000429881790
  error estimate for blocks of size 2^( 4) =       0.000441612022
  error estimate for blocks of size 2^( 5) =       0.000450875576
  error estimate for blocks of size 2^( 6) =       0.000457181530
  error estimate for blocks of size 2^( 7) =       0.000461306923

      target function =                  N/A
              le_mean =     -16.910323072272
             les_mean =     286.289621789664
             stat err =       0.000452744013
             autocorr =       1.240047807643
              std dev =       0.574974387550
             le_variance =       0.330595546338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330606714854
                                         uncertainty =       0.004988875987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330606714854
                                         uncertainty =       0.004988875987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406566925
  error estimate for blocks of size 2^( 2) =       0.000418104007
  error estimate for blocks of size 2^( 3) =       0.000429881005
  error estimate for blocks of size 2^( 4) =       0.000441611541
  error estimate for blocks of size 2^( 5) =       0.000450875175
  error estimate for blocks of size 2^( 6) =       0.000457181130
  error estimate for blocks of size 2^( 7) =       0.000461306345

      target function =                  N/A
              le_mean =     -16.910323132376
             les_mean =     286.289621605809
             stat err =       0.000452743548
             autocorr =       1.240053574462
              std dev =       0.574972459989
             le_variance =       0.330593329746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910323141044        initial  <--
     3.9062e+01     3.9062e+02             1.2149e-05       -16.910323005617
     1.5625e+02     1.5625e+03             3.0666e-06       -16.910323072272
     6.2500e+02     6.2500e+03             7.6852e-07       -16.910323132376

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.4915
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.072601e-01 1 1  ON 0
 uu_1                 1.420495e-01 1 1  ON 1
 uu_2                 4.341927e-02 1 1  ON 2
 uu_3                -1.780981e-02 1 1  ON 3
 uu_4                -6.303218e-02 1 1  ON 4
 uu_5                -9.715548e-02 1 1  ON 5
 uu_6                -1.244738e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331806e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358631e-01 1 1  ON 10
 ud_1                 1.778882e-01 1 1  ON 11
 ud_2                 6.384550e-02 1 1  ON 12
 ud_3                -4.921347e-03 1 1  ON 13
 ud_4                -6.091879e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303321e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518610e-01 1 1  ON 18
 ud_9                -1.447767e-01 1 1  ON 19
 eO_0                -7.496780e-01 1 1  ON 20
 eO_1                -4.361308e-01 1 1  ON 21
 eO_2                -2.591283e-02 1 1  ON 22
 eO_3                 2.943705e-01 1 1  ON 23
 eO_4                 5.212175e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579417e-01 1 1  ON 26
 eO_7                -4.109379e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118845e-02 1 1  ON 29
eH1_0                -2.398983e-01 1 1  ON 30
eH1_1                -1.369812e-01 1 1  ON 31
eH1_2                -9.214455e-02 1 1  ON 32
eH1_3                -4.109978e-02 1 1  ON 33
eH1_4                 7.330789e-03 1 1  ON 34
eH1_5                 3.844565e-02 1 1  ON 35
eH1_6                 9.638605e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685833e-01 1 1  ON 38
eH1_9                 5.469404e-02 1 1  ON 39
eH2_0                -2.385923e-01 1 1  ON 40
eH2_1                -1.357326e-01 1 1  ON 41
eH2_2                -9.098232e-02 1 1  ON 42
eH2_3                -3.967284e-02 1 1  ON 43
eH2_4                 8.346151e-03 1 1  ON 44
eH2_5                 3.987212e-02 1 1  ON 45
eH2_6                 9.825725e-02 1 1  ON 46
eH2_7                 1.497395e-01 1 1  ON 47
eH2_8                 1.801095e-01 1 1  ON 48
eH2_9                 4.500692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.908
    reference variance = 0.34857
====================================================
  Execution time = 2.2907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329987241698
                                         uncertainty =       0.003403577673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329987241698
                                         uncertainty =       0.003403577673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406199749
  error estimate for blocks of size 2^( 2) =       0.000418238825
  error estimate for blocks of size 2^( 3) =       0.000430165700
  error estimate for blocks of size 2^( 4) =       0.000441799038
  error estimate for blocks of size 2^( 5) =       0.000452365842
  error estimate for blocks of size 2^( 6) =       0.000459248639
  error estimate for blocks of size 2^( 7) =       0.000462432408

      target function =                  N/A
              le_mean =     -16.910218288650
             les_mean =     286.285478877709
             stat err =       0.000453961482
             autocorr =       1.248989270828
              std dev =       0.574453194703
             le_variance =       0.329996472904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691021828865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910218288650       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910218320889       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910218328472       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910218329086       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910218327051       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910218328716       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910218327507       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910218327722       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910218328029       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.300410e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910218288650       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910218296713       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910218298611       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910218298765       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910218298256       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910218298673       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910218298370       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910218298422       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910218298499       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.252343e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910218288650       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910218290666       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910218291141       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910218291179       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910218291050       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910218291158       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910218291084       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910218291089       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910218291110       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 8.131683e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8992e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.072600e-01 1 1  ON 0
 uu_1                 1.420495e-01 1 1  ON 1
 uu_2                 4.341941e-02 1 1  ON 2
 uu_3                -1.780975e-02 1 1  ON 3
 uu_4                -6.303227e-02 1 1  ON 4
 uu_5                -9.715558e-02 1 1  ON 5
 uu_6                -1.244740e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331805e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358634e-01 1 1  ON 10
 ud_1                 1.778885e-01 1 1  ON 11
 ud_2                 6.384531e-02 1 1  ON 12
 ud_3                -4.921672e-03 1 1  ON 13
 ud_4                -6.091884e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303323e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518608e-01 1 1  ON 18
 ud_9                -1.447766e-01 1 1  ON 19
 eO_0                -7.496782e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.591292e-02 1 1  ON 22
 eO_3                 2.943707e-01 1 1  ON 23
 eO_4                 5.212176e-01 1 1  ON 24
 eO_5                 4.824787e-01 1 1  ON 25
 eO_6                 2.579417e-01 1 1  ON 26
 eO_7                -4.109373e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118854e-02 1 1  ON 29
eH1_0                -2.398986e-01 1 1  ON 30
eH1_1                -1.369814e-01 1 1  ON 31
eH1_2                -9.214447e-02 1 1  ON 32
eH1_3                -4.109974e-02 1 1  ON 33
eH1_4                 7.330775e-03 1 1  ON 34
eH1_5                 3.844568e-02 1 1  ON 35
eH1_6                 9.638606e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685834e-01 1 1  ON 38
eH1_9                 5.469416e-02 1 1  ON 39
eH2_0                -2.385925e-01 1 1  ON 40
eH2_1                -1.357327e-01 1 1  ON 41
eH2_2                -9.098230e-02 1 1  ON 42
eH2_3                -3.967286e-02 1 1  ON 43
eH2_4                 8.346171e-03 1 1  ON 44
eH2_5                 3.987211e-02 1 1  ON 45
eH2_6                 9.825727e-02 1 1  ON 46
eH2_7                 1.497396e-01 1 1  ON 47
eH2_8                 1.801097e-01 1 1  ON 48
eH2_9                 4.500710e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9248
    reference variance = 0.20597
====================================================
  Execution time = 2.2590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2758e-01
  Total weights = 2.0000e+06
  Execution time = 2.4682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635368776
                                         uncertainty =       0.003166366070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635368776
                                         uncertainty =       0.003166366070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404712607
  error estimate for blocks of size 2^( 2) =       0.000416715956
  error estimate for blocks of size 2^( 3) =       0.000428240293
  error estimate for blocks of size 2^( 4) =       0.000439675800
  error estimate for blocks of size 2^( 5) =       0.000449184844
  error estimate for blocks of size 2^( 6) =       0.000457177385
  error estimate for blocks of size 2^( 7) =       0.000463657217

      target function =                  N/A
              le_mean =     -16.910619481450
             les_mean =     286.296635671160
             stat err =       0.000452423812
             autocorr =       1.249676038189
              std dev =       0.572350057721
             le_variance =       0.327584588573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635985102
                                         uncertainty =       0.003166370902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635985102
                                         uncertainty =       0.003166370902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404712988
  error estimate for blocks of size 2^( 2) =       0.000416716263
  error estimate for blocks of size 2^( 3) =       0.000428240523
  error estimate for blocks of size 2^( 4) =       0.000439675983
  error estimate for blocks of size 2^( 5) =       0.000449184995
  error estimate for blocks of size 2^( 6) =       0.000457177536
  error estimate for blocks of size 2^( 7) =       0.000463657367

      target function =                  N/A
              le_mean =     -16.910619474939
             les_mean =     286.296636067253
             stat err =       0.000452423970
             autocorr =       1.249674561819
              std dev =       0.572350596094
             le_variance =       0.327585204849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635676902
                                         uncertainty =       0.003166368485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635676902
                                         uncertainty =       0.003166368485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404712797
  error estimate for blocks of size 2^( 2) =       0.000416716109
  error estimate for blocks of size 2^( 3) =       0.000428240408
  error estimate for blocks of size 2^( 4) =       0.000439675891
  error estimate for blocks of size 2^( 5) =       0.000449184920
  error estimate for blocks of size 2^( 6) =       0.000457177460
  error estimate for blocks of size 2^( 7) =       0.000463657292

      target function =                  N/A
              le_mean =     -16.910619478187
             les_mean =     286.296635868933
             stat err =       0.000452423891
             autocorr =       1.249675299779
              std dev =       0.572350326875
             le_variance =       0.327584896674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635407289
                                         uncertainty =       0.003166366372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327635407289
                                         uncertainty =       0.003166366372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404712631
  error estimate for blocks of size 2^( 2) =       0.000416715975
  error estimate for blocks of size 2^( 3) =       0.000428240307
  error estimate for blocks of size 2^( 4) =       0.000439675811
  error estimate for blocks of size 2^( 5) =       0.000449184854
  error estimate for blocks of size 2^( 6) =       0.000457177394
  error estimate for blocks of size 2^( 7) =       0.000463657227

      target function =                  N/A
              le_mean =     -16.910619481041
             les_mean =     286.296635695858
             stat err =       0.000452423822
             autocorr =       1.249675945884
              std dev =       0.572350091362
             le_variance =       0.327584627083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910619481450        initial  <--
     3.9062e+02     3.9062e+03             1.3004e-06       -16.910619474939
     1.5625e+03     1.5625e+04             3.2523e-07       -16.910619478187
     6.2500e+03     6.2500e+04             8.1317e-08       -16.910619481041

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.3426
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.072601e-01 1 1  ON 0
 uu_1                 1.420495e-01 1 1  ON 1
 uu_2                 4.341927e-02 1 1  ON 2
 uu_3                -1.780981e-02 1 1  ON 3
 uu_4                -6.303218e-02 1 1  ON 4
 uu_5                -9.715548e-02 1 1  ON 5
 uu_6                -1.244738e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331806e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358631e-01 1 1  ON 10
 ud_1                 1.778882e-01 1 1  ON 11
 ud_2                 6.384550e-02 1 1  ON 12
 ud_3                -4.921347e-03 1 1  ON 13
 ud_4                -6.091879e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303321e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518610e-01 1 1  ON 18
 ud_9                -1.447767e-01 1 1  ON 19
 eO_0                -7.496780e-01 1 1  ON 20
 eO_1                -4.361308e-01 1 1  ON 21
 eO_2                -2.591283e-02 1 1  ON 22
 eO_3                 2.943705e-01 1 1  ON 23
 eO_4                 5.212175e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579417e-01 1 1  ON 26
 eO_7                -4.109379e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118845e-02 1 1  ON 29
eH1_0                -2.398983e-01 1 1  ON 30
eH1_1                -1.369812e-01 1 1  ON 31
eH1_2                -9.214455e-02 1 1  ON 32
eH1_3                -4.109978e-02 1 1  ON 33
eH1_4                 7.330789e-03 1 1  ON 34
eH1_5                 3.844565e-02 1 1  ON 35
eH1_6                 9.638605e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685833e-01 1 1  ON 38
eH1_9                 5.469404e-02 1 1  ON 39
eH2_0                -2.385923e-01 1 1  ON 40
eH2_1                -1.357326e-01 1 1  ON 41
eH2_2                -9.098232e-02 1 1  ON 42
eH2_3                -3.967284e-02 1 1  ON 43
eH2_4                 8.346151e-03 1 1  ON 44
eH2_5                 3.987212e-02 1 1  ON 45
eH2_6                 9.825725e-02 1 1  ON 46
eH2_7                 1.497395e-01 1 1  ON 47
eH2_8                 1.801095e-01 1 1  ON 48
eH2_9                 4.500692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.176608
====================================================
  Execution time = 2.5371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3182e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331831829709
                                         uncertainty =       0.004369140230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331831829709
                                         uncertainty =       0.004369140230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407321865
  error estimate for blocks of size 2^( 2) =       0.000419316326
  error estimate for blocks of size 2^( 3) =       0.000431856487
  error estimate for blocks of size 2^( 4) =       0.000443684504
  error estimate for blocks of size 2^( 5) =       0.000452952772
  error estimate for blocks of size 2^( 6) =       0.000460521748
  error estimate for blocks of size 2^( 7) =       0.000464361582

      target function =                  N/A
              le_mean =     -16.910572517501
             les_mean =     286.299284907568
             stat err =       0.000455380151
             autocorr =       1.249892743212
              std dev =       0.576040106073
             le_variance =       0.331822203805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691057251750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910572517501       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910572518835       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910572519571       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910572519813       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910572519989       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910572520275       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910572520369       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910572520356       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910572520366       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.281312e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910572517501       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910572517835       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910572518019       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910572518079       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910572518123       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910572518195       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910572518216       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910572518214       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910572518197       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.203573e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910572517501       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910572517585       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910572517631       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910572517653       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910572517676       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910572517693       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910572517658       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910572517652       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910572517670       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 8.009115e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1513e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.072601e-01 1 1  ON 0
 uu_1                 1.420495e-01 1 1  ON 1
 uu_2                 4.341928e-02 1 1  ON 2
 uu_3                -1.780981e-02 1 1  ON 3
 uu_4                -6.303219e-02 1 1  ON 4
 uu_5                -9.715549e-02 1 1  ON 5
 uu_6                -1.244738e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331806e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358632e-01 1 1  ON 10
 ud_1                 1.778883e-01 1 1  ON 11
 ud_2                 6.384548e-02 1 1  ON 12
 ud_3                -4.921373e-03 1 1  ON 13
 ud_4                -6.091879e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303321e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518610e-01 1 1  ON 18
 ud_9                -1.447767e-01 1 1  ON 19
 eO_0                -7.496780e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.591284e-02 1 1  ON 22
 eO_3                 2.943705e-01 1 1  ON 23
 eO_4                 5.212175e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579417e-01 1 1  ON 26
 eO_7                -4.109379e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118846e-02 1 1  ON 29
eH1_0                -2.398984e-01 1 1  ON 30
eH1_1                -1.369812e-01 1 1  ON 31
eH1_2                -9.214454e-02 1 1  ON 32
eH1_3                -4.109978e-02 1 1  ON 33
eH1_4                 7.330776e-03 1 1  ON 34
eH1_5                 3.844566e-02 1 1  ON 35
eH1_6                 9.638606e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685833e-01 1 1  ON 38
eH1_9                 5.469405e-02 1 1  ON 39
eH2_0                -2.385923e-01 1 1  ON 40
eH2_1                -1.357326e-01 1 1  ON 41
eH2_2                -9.098231e-02 1 1  ON 42
eH2_3                -3.967284e-02 1 1  ON 43
eH2_4                 8.346161e-03 1 1  ON 44
eH2_5                 3.987212e-02 1 1  ON 45
eH2_6                 9.825726e-02 1 1  ON 46
eH2_7                 1.497395e-01 1 1  ON 47
eH2_8                 1.801095e-01 1 1  ON 48
eH2_9                 4.500694e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8815
    reference variance = 0.309071
====================================================
  Execution time = 2.2469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3101e-01
  Total weights = 2.0000e+06
  Execution time = 2.4656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005569512
                                         uncertainty =       0.003573177064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005569512
                                         uncertainty =       0.003573177064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406822738
  error estimate for blocks of size 2^( 2) =       0.000419306946
  error estimate for blocks of size 2^( 3) =       0.000432347505
  error estimate for blocks of size 2^( 4) =       0.000444933253
  error estimate for blocks of size 2^( 5) =       0.000455766297
  error estimate for blocks of size 2^( 6) =       0.000464282400
  error estimate for blocks of size 2^( 7) =       0.000469680924

      target function =                  N/A
              le_mean =     -16.909091642926
             les_mean =     286.248389504046
             stat err =       0.000458665719
             autocorr =       1.271107044739
              std dev =       0.575334233890
             le_variance =       0.331009480685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005640192
                                         uncertainty =       0.003573177942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005640192
                                         uncertainty =       0.003573177942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406822782
  error estimate for blocks of size 2^( 2) =       0.000419306983
  error estimate for blocks of size 2^( 3) =       0.000432347534
  error estimate for blocks of size 2^( 4) =       0.000444933280
  error estimate for blocks of size 2^( 5) =       0.000455766322
  error estimate for blocks of size 2^( 6) =       0.000464282423
  error estimate for blocks of size 2^( 7) =       0.000469680946

      target function =                  N/A
              le_mean =     -16.909091644385
             les_mean =     286.248389623940
             stat err =       0.000458665743
             autocorr =       1.271106907532
              std dev =       0.575334295209
             le_variance =       0.331009551243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005604852
                                         uncertainty =       0.003573177503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005604852
                                         uncertainty =       0.003573177503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406822760
  error estimate for blocks of size 2^( 2) =       0.000419306964
  error estimate for blocks of size 2^( 3) =       0.000432347520
  error estimate for blocks of size 2^( 4) =       0.000444933267
  error estimate for blocks of size 2^( 5) =       0.000455766309
  error estimate for blocks of size 2^( 6) =       0.000464282411
  error estimate for blocks of size 2^( 7) =       0.000469680935

      target function =                  N/A
              le_mean =     -16.909091643655
             les_mean =     286.248389563994
             stat err =       0.000458665731
             autocorr =       1.271106976137
              std dev =       0.575334264549
             le_variance =       0.331009515964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005573930
                                         uncertainty =       0.003573177119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331005573930
                                         uncertainty =       0.003573177119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406822741
  error estimate for blocks of size 2^( 2) =       0.000419306949
  error estimate for blocks of size 2^( 3) =       0.000432347507
  error estimate for blocks of size 2^( 4) =       0.000444933255
  error estimate for blocks of size 2^( 5) =       0.000455766299
  error estimate for blocks of size 2^( 6) =       0.000464282401
  error estimate for blocks of size 2^( 7) =       0.000469680926

      target function =                  N/A
              le_mean =     -16.909091643017
             les_mean =     286.248389511540
             stat err =       0.000458665720
             autocorr =       1.271107036170
              std dev =       0.575334237722
             le_variance =       0.331009485095


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909091642926        initial
     3.9062e+03     3.9062e+04             1.2813e-07       -16.909091644385  <--
     1.5625e+04     1.5625e+05             3.2036e-08       -16.909091643655
     6.2500e+04     6.2500e+05             8.0091e-09       -16.909091643017

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 3.4986e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.072601e-01 1 1  ON 0
 uu_1                 1.420494e-01 1 1  ON 1
 uu_2                 4.341930e-02 1 1  ON 2
 uu_3                -1.780978e-02 1 1  ON 3
 uu_4                -6.303221e-02 1 1  ON 4
 uu_5                -9.715554e-02 1 1  ON 5
 uu_6                -1.244739e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331805e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358633e-01 1 1  ON 10
 ud_1                 1.778884e-01 1 1  ON 11
 ud_2                 6.384541e-02 1 1  ON 12
 ud_3                -4.921453e-03 1 1  ON 13
 ud_4                -6.091881e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303322e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518609e-01 1 1  ON 18
 ud_9                -1.447767e-01 1 1  ON 19
 eO_0                -7.496781e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.591286e-02 1 1  ON 22
 eO_3                 2.943706e-01 1 1  ON 23
 eO_4                 5.212176e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579417e-01 1 1  ON 26
 eO_7                -4.109377e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118849e-02 1 1  ON 29
eH1_0                -2.398984e-01 1 1  ON 30
eH1_1                -1.369813e-01 1 1  ON 31
eH1_2                -9.214450e-02 1 1  ON 32
eH1_3                -4.109977e-02 1 1  ON 33
eH1_4                 7.330734e-03 1 1  ON 34
eH1_5                 3.844568e-02 1 1  ON 35
eH1_6                 9.638609e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685834e-01 1 1  ON 38
eH1_9                 5.469409e-02 1 1  ON 39
eH2_0                -2.385924e-01 1 1  ON 40
eH2_1                -1.357326e-01 1 1  ON 41
eH2_2                -9.098228e-02 1 1  ON 42
eH2_3                -3.967285e-02 1 1  ON 43
eH2_4                 8.346189e-03 1 1  ON 44
eH2_5                 3.987212e-02 1 1  ON 45
eH2_6                 9.825728e-02 1 1  ON 46
eH2_7                 1.497395e-01 1 1  ON 47
eH2_8                 1.801096e-01 1 1  ON 48
eH2_9                 4.500697e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6505e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9683
    reference variance = 0.19149
====================================================
  Execution time = 2.2910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336730785157
                                         uncertainty =       0.007158796015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336730785157
                                         uncertainty =       0.007158796015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410259699
  error estimate for blocks of size 2^( 2) =       0.000422114070
  error estimate for blocks of size 2^( 3) =       0.000434766380
  error estimate for blocks of size 2^( 4) =       0.000446022181
  error estimate for blocks of size 2^( 5) =       0.000456995526
  error estimate for blocks of size 2^( 6) =       0.000464532456
  error estimate for blocks of size 2^( 7) =       0.000471164725

      target function =                  N/A
              le_mean =     -16.909111494819
             les_mean =     286.254677416498
             stat err =       0.000459678722
             autocorr =       1.255425915187
              std dev =       0.580194829849
             le_variance =       0.336626040583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690911149482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909111494819       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909111502650       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909111503021       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909111502755       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909111502769       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909111503008       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909111503579       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909111503470       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909111503660       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.829664e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909111494819       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909111496777       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909111496870       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909111496805       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909111496809       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909111496865       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909111497009       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909111496986       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909111497032       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.457572e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909111494819       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909111495309       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909111495332       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909111495312       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909111495316       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909111495341       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909111495378       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909111495363       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909111495375       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.644027e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9044e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.072601e-01 1 1  ON 0
 uu_1                 1.420494e-01 1 1  ON 1
 uu_2                 4.341934e-02 1 1  ON 2
 uu_3                -1.780976e-02 1 1  ON 3
 uu_4                -6.303222e-02 1 1  ON 4
 uu_5                -9.715559e-02 1 1  ON 5
 uu_6                -1.244739e-01 1 1  ON 6
 uu_7                -1.379154e-01 1 1  ON 7
 uu_8                -1.331805e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358634e-01 1 1  ON 10
 ud_1                 1.778885e-01 1 1  ON 11
 ud_2                 6.384533e-02 1 1  ON 12
 ud_3                -4.921561e-03 1 1  ON 13
 ud_4                -6.091883e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303322e-01 1 1  ON 16
 ud_7                -1.481566e-01 1 1  ON 17
 ud_8                -1.518609e-01 1 1  ON 18
 ud_9                -1.447767e-01 1 1  ON 19
 eO_0                -7.496781e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.591287e-02 1 1  ON 22
 eO_3                 2.943707e-01 1 1  ON 23
 eO_4                 5.212176e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579418e-01 1 1  ON 26
 eO_7                -4.109374e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118853e-02 1 1  ON 29
eH1_0                -2.398986e-01 1 1  ON 30
eH1_1                -1.369813e-01 1 1  ON 31
eH1_2                -9.214447e-02 1 1  ON 32
eH1_3                -4.109975e-02 1 1  ON 33
eH1_4                 7.330725e-03 1 1  ON 34
eH1_5                 3.844570e-02 1 1  ON 35
eH1_6                 9.638611e-02 1 1  ON 36
eH1_7                 1.492029e-01 1 1  ON 37
eH1_8                 1.685834e-01 1 1  ON 38
eH1_9                 5.469413e-02 1 1  ON 39
eH2_0                -2.385925e-01 1 1  ON 40
eH2_1                -1.357327e-01 1 1  ON 41
eH2_2                -9.098222e-02 1 1  ON 42
eH2_3                -3.967285e-02 1 1  ON 43
eH2_4                 8.346181e-03 1 1  ON 44
eH2_5                 3.987211e-02 1 1  ON 45
eH2_6                 9.825731e-02 1 1  ON 46
eH2_7                 1.497395e-01 1 1  ON 47
eH2_8                 1.801096e-01 1 1  ON 48
eH2_9                 4.500704e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.214187
====================================================
  Execution time = 2.2627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4204e-01
  Total weights = 2.0000e+06
  Execution time = 2.4787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342071873143
                                         uncertainty =       0.009029278827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342071873143
                                         uncertainty =       0.009029278827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413545119
  error estimate for blocks of size 2^( 2) =       0.000425675793
  error estimate for blocks of size 2^( 3) =       0.000438388523
  error estimate for blocks of size 2^( 4) =       0.000450043419
  error estimate for blocks of size 2^( 5) =       0.000460281930
  error estimate for blocks of size 2^( 6) =       0.000467775408
  error estimate for blocks of size 2^( 7) =       0.000472150691

      target function =                  N/A
              le_mean =     -16.910139091815
             les_mean =     286.294843064847
             stat err =       0.000462562862
             autocorr =       1.251110657637
              std dev =       0.584841116323
             le_variance =       0.342039131342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072234576
                                         uncertainty =       0.009029305932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072234576
                                         uncertainty =       0.009029305932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413545338
  error estimate for blocks of size 2^( 2) =       0.000425675981
  error estimate for blocks of size 2^( 3) =       0.000438388680
  error estimate for blocks of size 2^( 4) =       0.000450043560
  error estimate for blocks of size 2^( 5) =       0.000460282058
  error estimate for blocks of size 2^( 6) =       0.000467775522
  error estimate for blocks of size 2^( 7) =       0.000472150822

      target function =                  N/A
              le_mean =     -16.910139097376
             les_mean =     286.294843614058
             stat err =       0.000462562990
             autocorr =       1.251110031126
              std dev =       0.584841425052
             le_variance =       0.342039492457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072053880
                                         uncertainty =       0.009029292384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342072053880
                                         uncertainty =       0.009029292384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413545228
  error estimate for blocks of size 2^( 2) =       0.000425675887
  error estimate for blocks of size 2^( 3) =       0.000438388602
  error estimate for blocks of size 2^( 4) =       0.000450043489
  error estimate for blocks of size 2^( 5) =       0.000460281994
  error estimate for blocks of size 2^( 6) =       0.000467775465
  error estimate for blocks of size 2^( 7) =       0.000472150756

      target function =                  N/A
              le_mean =     -16.910139094596
             les_mean =     286.294843339474
             stat err =       0.000462562926
             autocorr =       1.251110344318
              std dev =       0.584841270705
             le_variance =       0.342039311920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342071895736
                                         uncertainty =       0.009029280522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342071895736
                                         uncertainty =       0.009029280522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413545133
  error estimate for blocks of size 2^( 2) =       0.000425675804
  error estimate for blocks of size 2^( 3) =       0.000438388533
  error estimate for blocks of size 2^( 4) =       0.000450043427
  error estimate for blocks of size 2^( 5) =       0.000460281938
  error estimate for blocks of size 2^( 6) =       0.000467775415
  error estimate for blocks of size 2^( 7) =       0.000472150699

      target function =                  N/A
              le_mean =     -16.910139092162
             les_mean =     286.294843099173
             stat err =       0.000462562870
             autocorr =       1.251110618470
              std dev =       0.584841135621
             le_variance =       0.342039153915


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910139091815        initial
     9.7656e+02     9.7656e+03             5.8297e-07       -16.910139097376  <--
     3.9062e+03     3.9062e+04             1.4576e-07       -16.910139094596
     1.5625e+04     1.5625e+05             3.6440e-08       -16.910139092162

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 3.5237e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.072600e-01 1 1  ON 0
 uu_1                 1.420494e-01 1 1  ON 1
 uu_2                 4.341945e-02 1 1  ON 2
 uu_3                -1.780971e-02 1 1  ON 3
 uu_4                -6.303226e-02 1 1  ON 4
 uu_5                -9.715574e-02 1 1  ON 5
 uu_6                -1.244739e-01 1 1  ON 6
 uu_7                -1.379155e-01 1 1  ON 7
 uu_8                -1.331804e-01 1 1  ON 8
 uu_9                -1.047953e-01 1 1  ON 9
 ud_0                 4.358638e-01 1 1  ON 10
 ud_1                 1.778888e-01 1 1  ON 11
 ud_2                 6.384507e-02 1 1  ON 12
 ud_3                -4.921884e-03 1 1  ON 13
 ud_4                -6.091890e-02 1 1  ON 14
 ud_5                -1.025823e-01 1 1  ON 15
 ud_6                -1.303324e-01 1 1  ON 16
 ud_7                -1.481567e-01 1 1  ON 17
 ud_8                -1.518608e-01 1 1  ON 18
 ud_9                -1.447766e-01 1 1  ON 19
 eO_0                -7.496783e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.591292e-02 1 1  ON 22
 eO_3                 2.943708e-01 1 1  ON 23
 eO_4                 5.212177e-01 1 1  ON 24
 eO_5                 4.824786e-01 1 1  ON 25
 eO_6                 2.579418e-01 1 1  ON 26
 eO_7                -4.109366e-02 1 1  ON 27
 eO_8                -2.210598e-01 1 1  ON 28
 eO_9                -8.118864e-02 1 1  ON 29
eH1_0                -2.398989e-01 1 1  ON 30
eH1_1                -1.369816e-01 1 1  ON 31
eH1_2                -9.214439e-02 1 1  ON 32
eH1_3                -4.109971e-02 1 1  ON 33
eH1_4                 7.330696e-03 1 1  ON 34
eH1_5                 3.844576e-02 1 1  ON 35
eH1_6                 9.638615e-02 1 1  ON 36
eH1_7                 1.492030e-01 1 1  ON 37
eH1_8                 1.685835e-01 1 1  ON 38
eH1_9                 5.469428e-02 1 1  ON 39
eH2_0                -2.385929e-01 1 1  ON 40
eH2_1                -1.357329e-01 1 1  ON 41
eH2_2                -9.098205e-02 1 1  ON 42
eH2_3                -3.967283e-02 1 1  ON 43
eH2_4                 8.346158e-03 1 1  ON 44
eH2_5                 3.987208e-02 1 1  ON 45
eH2_6                 9.825737e-02 1 1  ON 46
eH2_7                 1.497396e-01 1 1  ON 47
eH2_8                 1.801097e-01 1 1  ON 48
eH2_9                 4.500723e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.339913
====================================================
  Execution time = 2.3046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339154872013
                                         uncertainty =       0.005969681515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339154872013
                                         uncertainty =       0.005969681515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411842190
  error estimate for blocks of size 2^( 2) =       0.000423208870
  error estimate for blocks of size 2^( 3) =       0.000434991875
  error estimate for blocks of size 2^( 4) =       0.000445908102
  error estimate for blocks of size 2^( 5) =       0.000457184486
  error estimate for blocks of size 2^( 6) =       0.000465651307
  error estimate for blocks of size 2^( 7) =       0.000470243955

      target function =                  N/A
              le_mean =     -16.909589634890
             les_mean =     286.273449429376
             stat err =       0.000459746962
             autocorr =       1.246166487992
              std dev =       0.582432810387
             le_variance =       0.339227978615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690958963489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909589634890       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909589668203       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909589674108       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909589679140       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909589682602       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909589685627       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909589685077       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909589685465       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909589685492       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.457660e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909589634890       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909589643223       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909589644701       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909589645960       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909589646824       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909589647581       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909589647446       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909589647542       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909589647545       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 6.146923e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909589634890       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909589636974       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909589637343       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909589637658       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909589637874       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909589638063       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909589638029       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909589638053       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909589638056       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.536904e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9121e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.072600e-01 1 1  ON 0
 uu_1                 1.420494e-01 1 1  ON 1
 uu_2                 4.341967e-02 1 1  ON 2
 uu_3                -1.780954e-02 1 1  ON 3
 uu_4                -6.303237e-02 1 1  ON 4
 uu_5                -9.715583e-02 1 1  ON 5
 uu_6                -1.244740e-01 1 1  ON 6
 uu_7                -1.379156e-01 1 1  ON 7
 uu_8                -1.331804e-01 1 1  ON 8
 uu_9                -1.047954e-01 1 1  ON 9
 ud_0                 4.358645e-01 1 1  ON 10
 ud_1                 1.778892e-01 1 1  ON 11
 ud_2                 6.384483e-02 1 1  ON 12
 ud_3                -4.922381e-03 1 1  ON 13
 ud_4                -6.091891e-02 1 1  ON 14
 ud_5                -1.025824e-01 1 1  ON 15
 ud_6                -1.303326e-01 1 1  ON 16
 ud_7                -1.481568e-01 1 1  ON 17
 ud_8                -1.518608e-01 1 1  ON 18
 ud_9                -1.447766e-01 1 1  ON 19
 eO_0                -7.496785e-01 1 1  ON 20
 eO_1                -4.361307e-01 1 1  ON 21
 eO_2                -2.591299e-02 1 1  ON 22
 eO_3                 2.943711e-01 1 1  ON 23
 eO_4                 5.212177e-01 1 1  ON 24
 eO_5                 4.824787e-01 1 1  ON 25
 eO_6                 2.579418e-01 1 1  ON 26
 eO_7                -4.109364e-02 1 1  ON 27
 eO_8                -2.210600e-01 1 1  ON 28
 eO_9                -8.118878e-02 1 1  ON 29
eH1_0                -2.398995e-01 1 1  ON 30
eH1_1                -1.369818e-01 1 1  ON 31
eH1_2                -9.214422e-02 1 1  ON 32
eH1_3                -4.109970e-02 1 1  ON 33
eH1_4                 7.330637e-03 1 1  ON 34
eH1_5                 3.844593e-02 1 1  ON 35
eH1_6                 9.638632e-02 1 1  ON 36
eH1_7                 1.492031e-01 1 1  ON 37
eH1_8                 1.685837e-01 1 1  ON 38
eH1_9                 5.469445e-02 1 1  ON 39
eH2_0                -2.385933e-01 1 1  ON 40
eH2_1                -1.357331e-01 1 1  ON 41
eH2_2                -9.098179e-02 1 1  ON 42
eH2_3                -3.967287e-02 1 1  ON 43
eH2_4                 8.346245e-03 1 1  ON 44
eH2_5                 3.987210e-02 1 1  ON 45
eH2_6                 9.825735e-02 1 1  ON 46
eH2_7                 1.497396e-01 1 1  ON 47
eH2_8                 1.801097e-01 1 1  ON 48
eH2_9                 4.500745e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.0448
    reference variance = 0.581497
====================================================
  Execution time = 2.2508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3471e-01
  Total weights = 2.0000e+06
  Execution time = 2.4651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792715787
                                         uncertainty =       0.004063738217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792715787
                                         uncertainty =       0.004063738217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409088701
  error estimate for blocks of size 2^( 2) =       0.000421209179
  error estimate for blocks of size 2^( 3) =       0.000433540595
  error estimate for blocks of size 2^( 4) =       0.000445405843
  error estimate for blocks of size 2^( 5) =       0.000455663265
  error estimate for blocks of size 2^( 6) =       0.000461539417
  error estimate for blocks of size 2^( 7) =       0.000465052288

      target function =                  N/A
              le_mean =     -16.909593462943
             les_mean =     286.269058044841
             stat err =       0.000456915203
             autocorr =       1.247487634103
              std dev =       0.578538788845
             le_variance =       0.334707130198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793879665
                                         uncertainty =       0.004063763652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793879665
                                         uncertainty =       0.004063763652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409089412
  error estimate for blocks of size 2^( 2) =       0.000421209764
  error estimate for blocks of size 2^( 3) =       0.000433541037
  error estimate for blocks of size 2^( 4) =       0.000445406207
  error estimate for blocks of size 2^( 5) =       0.000455663626
  error estimate for blocks of size 2^( 6) =       0.000461539784
  error estimate for blocks of size 2^( 7) =       0.000465052628

      target function =                  N/A
              le_mean =     -16.909593471555
             les_mean =     286.269059499166
             stat err =       0.000456915561
             autocorr =       1.247485252404
              std dev =       0.578539794012
             le_variance =       0.334708293255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793297894
                                         uncertainty =       0.004063750950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793297894
                                         uncertainty =       0.004063750950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409089056
  error estimate for blocks of size 2^( 2) =       0.000421209471
  error estimate for blocks of size 2^( 3) =       0.000433540816
  error estimate for blocks of size 2^( 4) =       0.000445406025
  error estimate for blocks of size 2^( 5) =       0.000455663445
  error estimate for blocks of size 2^( 6) =       0.000461539600
  error estimate for blocks of size 2^( 7) =       0.000465052458

      target function =                  N/A
              le_mean =     -16.909593467244
             les_mean =     286.269058772008
             stat err =       0.000456915382
             autocorr =       1.247486442368
              std dev =       0.578539291573
             le_variance =       0.334707711893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792788551
                                         uncertainty =       0.004063739809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334792788551
                                         uncertainty =       0.004063739809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409088745
  error estimate for blocks of size 2^( 2) =       0.000421209215
  error estimate for blocks of size 2^( 3) =       0.000433540623
  error estimate for blocks of size 2^( 4) =       0.000445405866
  error estimate for blocks of size 2^( 5) =       0.000455663288
  error estimate for blocks of size 2^( 6) =       0.000461539440
  error estimate for blocks of size 2^( 7) =       0.000465052309

      target function =                  N/A
              le_mean =     -16.909593463479
             les_mean =     286.269058135695
             stat err =       0.000456915226
             autocorr =       1.247487485103
              std dev =       0.578538851686
             le_variance =       0.334707202910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909593462943        initial
     2.4414e+02     2.4414e+03             2.4577e-06       -16.909593471555  <--
     9.7656e+02     9.7656e+03             6.1469e-07       -16.909593467244
     3.9062e+03     3.9062e+04             1.5369e-07       -16.909593463479

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 3.5024e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.072599e-01 1 1  ON 0
 uu_1                 1.420492e-01 1 1  ON 1
 uu_2                 4.342034e-02 1 1  ON 2
 uu_3                -1.780905e-02 1 1  ON 3
 uu_4                -6.303269e-02 1 1  ON 4
 uu_5                -9.715610e-02 1 1  ON 5
 uu_6                -1.244742e-01 1 1  ON 6
 uu_7                -1.379158e-01 1 1  ON 7
 uu_8                -1.331804e-01 1 1  ON 8
 uu_9                -1.047956e-01 1 1  ON 9
 ud_0                 4.358663e-01 1 1  ON 10
 ud_1                 1.778905e-01 1 1  ON 11
 ud_2                 6.384411e-02 1 1  ON 12
 ud_3                -4.923869e-03 1 1  ON 13
 ud_4                -6.091892e-02 1 1  ON 14
 ud_5                -1.025824e-01 1 1  ON 15
 ud_6                -1.303331e-01 1 1  ON 16
 ud_7                -1.481571e-01 1 1  ON 17
 ud_8                -1.518607e-01 1 1  ON 18
 ud_9                -1.447766e-01 1 1  ON 19
 eO_0                -7.496790e-01 1 1  ON 20
 eO_1                -4.361306e-01 1 1  ON 21
 eO_2                -2.591319e-02 1 1  ON 22
 eO_3                 2.943720e-01 1 1  ON 23
 eO_4                 5.212179e-01 1 1  ON 24
 eO_5                 4.824790e-01 1 1  ON 25
 eO_6                 2.579419e-01 1 1  ON 26
 eO_7                -4.109357e-02 1 1  ON 27
 eO_8                -2.210603e-01 1 1  ON 28
 eO_9                -8.118922e-02 1 1  ON 29
eH1_0                -2.399012e-01 1 1  ON 30
eH1_1                -1.369827e-01 1 1  ON 31
eH1_2                -9.214369e-02 1 1  ON 32
eH1_3                -4.109966e-02 1 1  ON 33
eH1_4                 7.330460e-03 1 1  ON 34
eH1_5                 3.844642e-02 1 1  ON 35
eH1_6                 9.638681e-02 1 1  ON 36
eH1_7                 1.492032e-01 1 1  ON 37
eH1_8                 1.685842e-01 1 1  ON 38
eH1_9                 5.469494e-02 1 1  ON 39
eH2_0                -2.385946e-01 1 1  ON 40
eH2_1                -1.357337e-01 1 1  ON 41
eH2_2                -9.098101e-02 1 1  ON 42
eH2_3                -3.967299e-02 1 1  ON 43
eH2_4                 8.346506e-03 1 1  ON 44
eH2_5                 3.987217e-02 1 1  ON 45
eH2_6                 9.825730e-02 1 1  ON 46
eH2_7                 1.497396e-01 1 1  ON 47
eH2_8                 1.801099e-01 1 1  ON 48
eH2_9                 4.500812e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9942
    reference variance = 0.41521
====================================================
  Execution time = 2.3019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3164e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331738524742
                                         uncertainty =       0.003435540335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331738524742
                                         uncertainty =       0.003435540335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407208423
  error estimate for blocks of size 2^( 2) =       0.000419276312
  error estimate for blocks of size 2^( 3) =       0.000431842642
  error estimate for blocks of size 2^( 4) =       0.000443995120
  error estimate for blocks of size 2^( 5) =       0.000454947421
  error estimate for blocks of size 2^( 6) =       0.000462881338
  error estimate for blocks of size 2^( 7) =       0.000465300725

      target function =                  N/A
              le_mean =     -16.909380340974
             les_mean =     286.258780749361
             stat err =       0.000456781151
             autocorr =       1.258296081667
              std dev =       0.575879674471
             le_variance =       0.331637399469


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690938034097e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909380340974       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909380464710       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909380473015       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909380488498       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909380503116       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909380514392       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909380521368       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909380521653       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 9.301039e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909380340974       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909380371986       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909380374066       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909380377936       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909380381582       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909380384413       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909380386154       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909380386245       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.327378e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909380340974       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909380348732       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909380349252       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909380350219       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909380351130       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909380351839       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909380352274       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909380352296       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.819743e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9060e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.072595e-01 1 1  ON 0
 uu_1                 1.420490e-01 1 1  ON 1
 uu_2                 4.342100e-02 1 1  ON 2
 uu_3                -1.780883e-02 1 1  ON 3
 uu_4                -6.303273e-02 1 1  ON 4
 uu_5                -9.715673e-02 1 1  ON 5
 uu_6                -1.244748e-01 1 1  ON 6
 uu_7                -1.379164e-01 1 1  ON 7
 uu_8                -1.331797e-01 1 1  ON 8
 uu_9                -1.047954e-01 1 1  ON 9
 ud_0                 4.358686e-01 1 1  ON 10
 ud_1                 1.778924e-01 1 1  ON 11
 ud_2                 6.384307e-02 1 1  ON 12
 ud_3                -4.925709e-03 1 1  ON 13
 ud_4                -6.091936e-02 1 1  ON 14
 ud_5                -1.025828e-01 1 1  ON 15
 ud_6                -1.303340e-01 1 1  ON 16
 ud_7                -1.481573e-01 1 1  ON 17
 ud_8                -1.518600e-01 1 1  ON 18
 ud_9                -1.447763e-01 1 1  ON 19
 eO_0                -7.496799e-01 1 1  ON 20
 eO_1                -4.361309e-01 1 1  ON 21
 eO_2                -2.591344e-02 1 1  ON 22
 eO_3                 2.943732e-01 1 1  ON 23
 eO_4                 5.212185e-01 1 1  ON 24
 eO_5                 4.824796e-01 1 1  ON 25
 eO_6                 2.579420e-01 1 1  ON 26
 eO_7                -4.109358e-02 1 1  ON 27
 eO_8                -2.210607e-01 1 1  ON 28
 eO_9                -8.118970e-02 1 1  ON 29
eH1_0                -2.399030e-01 1 1  ON 30
eH1_1                -1.369837e-01 1 1  ON 31
eH1_2                -9.214301e-02 1 1  ON 32
eH1_3                -4.109941e-02 1 1  ON 33
eH1_4                 7.329938e-03 1 1  ON 34
eH1_5                 3.844678e-02 1 1  ON 35
eH1_6                 9.638686e-02 1 1  ON 36
eH1_7                 1.492034e-01 1 1  ON 37
eH1_8                 1.685849e-01 1 1  ON 38
eH1_9                 5.469592e-02 1 1  ON 39
eH2_0                -2.385962e-01 1 1  ON 40
eH2_1                -1.357349e-01 1 1  ON 41
eH2_2                -9.098046e-02 1 1  ON 42
eH2_3                -3.967289e-02 1 1  ON 43
eH2_4                 8.346470e-03 1 1  ON 44
eH2_5                 3.987233e-02 1 1  ON 45
eH2_6                 9.825784e-02 1 1  ON 46
eH2_7                 1.497402e-01 1 1  ON 47
eH2_8                 1.801102e-01 1 1  ON 48
eH2_9                 4.500876e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9511
    reference variance = 0.279264
====================================================
  Execution time = 2.2541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.6673e-01
  Total weights = 2.0000e+06
  Execution time = 2.4596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366781992312
                                         uncertainty =       0.023791694660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366781992312
                                         uncertainty =       0.023791694660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428207897
  error estimate for blocks of size 2^( 2) =       0.000439167301
  error estimate for blocks of size 2^( 3) =       0.000450709652
  error estimate for blocks of size 2^( 4) =       0.000461733588
  error estimate for blocks of size 2^( 5) =       0.000471840069
  error estimate for blocks of size 2^( 6) =       0.000479263996
  error estimate for blocks of size 2^( 7) =       0.000483092834

      target function =                  N/A
              le_mean =     -16.910012075129
             les_mean =     286.315232203465
             stat err =       0.000473982622
             autocorr =       1.225223995070
              std dev =       0.605577415204
             le_variance =       0.366724005805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366786725684
                                         uncertainty =       0.023791630546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366786725684
                                         uncertainty =       0.023791630546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428210660
  error estimate for blocks of size 2^( 2) =       0.000439169661
  error estimate for blocks of size 2^( 3) =       0.000450711551
  error estimate for blocks of size 2^( 4) =       0.000461735037
  error estimate for blocks of size 2^( 5) =       0.000471841410
  error estimate for blocks of size 2^( 6) =       0.000479265218
  error estimate for blocks of size 2^( 7) =       0.000483094061

      target function =                  N/A
              le_mean =     -16.910012091914
             les_mean =     286.315237504381
             stat err =       0.000473983932
             autocorr =       1.225214952925
              std dev =       0.605581323250
             le_variance =       0.366728739070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366784357831
                                         uncertainty =       0.023791661986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366784357831
                                         uncertainty =       0.023791661986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428209278
  error estimate for blocks of size 2^( 2) =       0.000439168480
  error estimate for blocks of size 2^( 3) =       0.000450710599
  error estimate for blocks of size 2^( 4) =       0.000461734310
  error estimate for blocks of size 2^( 5) =       0.000471840737
  error estimate for blocks of size 2^( 6) =       0.000479264604
  error estimate for blocks of size 2^( 7) =       0.000483093445

      target function =                  N/A
              le_mean =     -16.910012083321
             les_mean =     286.315234845966
             stat err =       0.000473983274
             autocorr =       1.225219463078
              std dev =       0.605579368265
             le_variance =       0.366726371268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366782287893
                                         uncertainty =       0.023791690557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366782287893
                                         uncertainty =       0.023791690557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428208069
  error estimate for blocks of size 2^( 2) =       0.000439167448
  error estimate for blocks of size 2^( 3) =       0.000450709770
  error estimate for blocks of size 2^( 4) =       0.000461733678
  error estimate for blocks of size 2^( 5) =       0.000471840152
  error estimate for blocks of size 2^( 6) =       0.000479264072
  error estimate for blocks of size 2^( 7) =       0.000483092911

      target function =                  N/A
              le_mean =     -16.910012076131
             les_mean =     286.315232532921
             stat err =       0.000473982703
             autocorr =       1.225223428140
              std dev =       0.605577659246
             le_variance =       0.366724301378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910012075129        initial
     6.1035e+01     6.1035e+02             9.3010e-06       -16.910012091914  <--
     2.4414e+02     2.4414e+03             2.3274e-06       -16.910012083321
     9.7656e+02     9.7656e+03             5.8197e-07       -16.910012076131

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 3.5031e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.072583e-01 1 1  ON 0
 uu_1                 1.420482e-01 1 1  ON 1
 uu_2                 4.342297e-02 1 1  ON 2
 uu_3                -1.780814e-02 1 1  ON 3
 uu_4                -6.303285e-02 1 1  ON 4
 uu_5                -9.715863e-02 1 1  ON 5
 uu_6                -1.244766e-01 1 1  ON 6
 uu_7                -1.379180e-01 1 1  ON 7
 uu_8                -1.331778e-01 1 1  ON 8
 uu_9                -1.047948e-01 1 1  ON 9
 ud_0                 4.358756e-01 1 1  ON 10
 ud_1                 1.778979e-01 1 1  ON 11
 ud_2                 6.383999e-02 1 1  ON 12
 ud_3                -4.931211e-03 1 1  ON 13
 ud_4                -6.092069e-02 1 1  ON 14
 ud_5                -1.025840e-01 1 1  ON 15
 ud_6                -1.303369e-01 1 1  ON 16
 ud_7                -1.481577e-01 1 1  ON 17
 ud_8                -1.518581e-01 1 1  ON 18
 ud_9                -1.447755e-01 1 1  ON 19
 eO_0                -7.496826e-01 1 1  ON 20
 eO_1                -4.361318e-01 1 1  ON 21
 eO_2                -2.591420e-02 1 1  ON 22
 eO_3                 2.943766e-01 1 1  ON 23
 eO_4                 5.212202e-01 1 1  ON 24
 eO_5                 4.824812e-01 1 1  ON 25
 eO_6                 2.579423e-01 1 1  ON 26
 eO_7                -4.109362e-02 1 1  ON 27
 eO_8                -2.210617e-01 1 1  ON 28
 eO_9                -8.119115e-02 1 1  ON 29
eH1_0                -2.399084e-01 1 1  ON 30
eH1_1                -1.369867e-01 1 1  ON 31
eH1_2                -9.214097e-02 1 1  ON 32
eH1_3                -4.109864e-02 1 1  ON 33
eH1_4                 7.328378e-03 1 1  ON 34
eH1_5                 3.844786e-02 1 1  ON 35
eH1_6                 9.638702e-02 1 1  ON 36
eH1_7                 1.492037e-01 1 1  ON 37
eH1_8                 1.685869e-01 1 1  ON 38
eH1_9                 5.469886e-02 1 1  ON 39
eH2_0                -2.386011e-01 1 1  ON 40
eH2_1                -1.357385e-01 1 1  ON 41
eH2_2                -9.097881e-02 1 1  ON 42
eH2_3                -3.967261e-02 1 1  ON 43
eH2_4                 8.346361e-03 1 1  ON 44
eH2_5                 3.987279e-02 1 1  ON 45
eH2_6                 9.825946e-02 1 1  ON 46
eH2_7                 1.497418e-01 1 1  ON 47
eH2_8                 1.801110e-01 1 1  ON 48
eH2_9                 4.501069e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.298582
====================================================
  Execution time = 2.3507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329098328963
                                         uncertainty =       0.004054345319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329098328963
                                         uncertainty =       0.004054345319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405678703
  error estimate for blocks of size 2^( 2) =       0.000417710796
  error estimate for blocks of size 2^( 3) =       0.000430585573
  error estimate for blocks of size 2^( 4) =       0.000443478371
  error estimate for blocks of size 2^( 5) =       0.000453338009
  error estimate for blocks of size 2^( 6) =       0.000460289586
  error estimate for blocks of size 2^( 7) =       0.000466966232

      target function =                  N/A
              le_mean =     -16.910515938810
             les_mean =     286.294699572531
             stat err =       0.000456018049
             autocorr =       1.263570991231
              std dev =       0.573716323943
             le_variance =       0.329150420358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691051593881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910515938810       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910516592037       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910516805985       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910516887012       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910516975541       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910517031361       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910517052910       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910517062759       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910517060413       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.503639e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910515938810       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910516103787       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910516158170       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910516178811       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910516200886       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910516215409       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910516220653       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910516223188       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910516222722       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 8.778496e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910515938810       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910515980160       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910515993813       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910515998998       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910516004514       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910516008181       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910516009484       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910516010121       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910516010012       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.195841e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9658e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.072558e-01 1 1  ON 0
 uu_1                 1.420492e-01 1 1  ON 1
 uu_2                 4.342601e-02 1 1  ON 2
 uu_3                -1.780534e-02 1 1  ON 3
 uu_4                -6.303481e-02 1 1  ON 4
 uu_5                -9.716101e-02 1 1  ON 5
 uu_6                -1.244801e-01 1 1  ON 6
 uu_7                -1.379198e-01 1 1  ON 7
 uu_8                -1.331751e-01 1 1  ON 8
 uu_9                -1.047947e-01 1 1  ON 9
 ud_0                 4.358843e-01 1 1  ON 10
 ud_1                 1.779031e-01 1 1  ON 11
 ud_2                 6.383309e-02 1 1  ON 12
 ud_3                -4.936825e-03 1 1  ON 13
 ud_4                -6.092295e-02 1 1  ON 14
 ud_5                -1.025842e-01 1 1  ON 15
 ud_6                -1.303363e-01 1 1  ON 16
 ud_7                -1.481584e-01 1 1  ON 17
 ud_8                -1.518564e-01 1 1  ON 18
 ud_9                -1.447752e-01 1 1  ON 19
 eO_0                -7.496893e-01 1 1  ON 20
 eO_1                -4.361269e-01 1 1  ON 21
 eO_2                -2.591648e-02 1 1  ON 22
 eO_3                 2.943808e-01 1 1  ON 23
 eO_4                 5.212211e-01 1 1  ON 24
 eO_5                 4.824829e-01 1 1  ON 25
 eO_6                 2.579422e-01 1 1  ON 26
 eO_7                -4.109205e-02 1 1  ON 27
 eO_8                -2.210630e-01 1 1  ON 28
 eO_9                -8.119353e-02 1 1  ON 29
eH1_0                -2.399162e-01 1 1  ON 30
eH1_1                -1.369905e-01 1 1  ON 31
eH1_2                -9.213837e-02 1 1  ON 32
eH1_3                -4.110034e-02 1 1  ON 33
eH1_4                 7.327741e-03 1 1  ON 34
eH1_5                 3.844826e-02 1 1  ON 35
eH1_6                 9.638797e-02 1 1  ON 36
eH1_7                 1.492061e-01 1 1  ON 37
eH1_8                 1.685906e-01 1 1  ON 38
eH1_9                 5.470237e-02 1 1  ON 39
eH2_0                -2.386099e-01 1 1  ON 40
eH2_1                -1.357436e-01 1 1  ON 41
eH2_2                -9.097488e-02 1 1  ON 42
eH2_3                -3.967238e-02 1 1  ON 43
eH2_4                 8.348243e-03 1 1  ON 44
eH2_5                 3.987422e-02 1 1  ON 45
eH2_6                 9.826080e-02 1 1  ON 46
eH2_7                 1.497423e-01 1 1  ON 47
eH2_8                 1.801120e-01 1 1  ON 48
eH2_9                 4.501408e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8793
    reference variance = 0.372148
====================================================
  Execution time = 2.2448e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2792e-01
  Total weights = 2.0000e+06
  Execution time = 2.4639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327940204472
                                         uncertainty =       0.004190488500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327940204472
                                         uncertainty =       0.004190488500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404914259
  error estimate for blocks of size 2^( 2) =       0.000417396222
  error estimate for blocks of size 2^( 3) =       0.000430170879
  error estimate for blocks of size 2^( 4) =       0.000442131700
  error estimate for blocks of size 2^( 5) =       0.000452578066
  error estimate for blocks of size 2^( 6) =       0.000459779176
  error estimate for blocks of size 2^( 7) =       0.000464291116

      target function =                  N/A
              le_mean =     -16.910328659777
             les_mean =     286.287126332476
             stat err =       0.000454695014
             autocorr =       1.260997549939
              std dev =       0.572635237082
             le_variance =       0.327911114748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327964592578
                                         uncertainty =       0.004190980924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327964592578
                                         uncertainty =       0.004190980924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404929314
  error estimate for blocks of size 2^( 2) =       0.000417409116
  error estimate for blocks of size 2^( 3) =       0.000430181598
  error estimate for blocks of size 2^( 4) =       0.000442140493
  error estimate for blocks of size 2^( 5) =       0.000452586064
  error estimate for blocks of size 2^( 6) =       0.000459786836
  error estimate for blocks of size 2^( 7) =       0.000464298123

      target function =                  N/A
              le_mean =     -16.910328939859
             les_mean =     286.287160189518
             stat err =       0.000454702879
             autocorr =       1.260947403969
              std dev =       0.572656528175
             le_variance =       0.327935499261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327952536184
                                         uncertainty =       0.004190738194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327952536184
                                         uncertainty =       0.004190738194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404921872
  error estimate for blocks of size 2^( 2) =       0.000417402737
  error estimate for blocks of size 2^( 3) =       0.000430176288
  error estimate for blocks of size 2^( 4) =       0.000442136128
  error estimate for blocks of size 2^( 5) =       0.000452582088
  error estimate for blocks of size 2^( 6) =       0.000459783031
  error estimate for blocks of size 2^( 7) =       0.000464294640

      target function =                  N/A
              le_mean =     -16.910328800550
             les_mean =     286.287143423438
             stat err =       0.000454698972
             autocorr =       1.260972084411
              std dev =       0.572646002933
             le_variance =       0.327923444675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327941748954
                                         uncertainty =       0.004190519820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327941748954
                                         uncertainty =       0.004190519820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404915213
  error estimate for blocks of size 2^( 2) =       0.000417397038
  error estimate for blocks of size 2^( 3) =       0.000430171556
  error estimate for blocks of size 2^( 4) =       0.000442132253
  error estimate for blocks of size 2^( 5) =       0.000452578568
  error estimate for blocks of size 2^( 6) =       0.000459779658
  error estimate for blocks of size 2^( 7) =       0.000464291556

      target function =                  N/A
              le_mean =     -16.910328677137
             les_mean =     286.287128463853
             stat err =       0.000454695509
             autocorr =       1.260994352954
              std dev =       0.572636585460
             le_variance =       0.327912659007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910328659777        initial
     1.5259e+01     1.5259e+02             3.5036e-05       -16.910328939859  <--
     6.1035e+01     6.1035e+02             8.7785e-06       -16.910328800550
     2.4414e+02     2.4414e+03             2.1958e-06       -16.910328677137

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 3.8940e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.072487e-01 1 1  ON 0
 uu_1                 1.420524e-01 1 1  ON 1
 uu_2                 4.343493e-02 1 1  ON 2
 uu_3                -1.779707e-02 1 1  ON 3
 uu_4                -6.304062e-02 1 1  ON 4
 uu_5                -9.716814e-02 1 1  ON 5
 uu_6                -1.244907e-01 1 1  ON 6
 uu_7                -1.379252e-01 1 1  ON 7
 uu_8                -1.331670e-01 1 1  ON 8
 uu_9                -1.047946e-01 1 1  ON 9
 ud_0                 4.359103e-01 1 1  ON 10
 ud_1                 1.779182e-01 1 1  ON 11
 ud_2                 6.381311e-02 1 1  ON 12
 ud_3                -4.953612e-03 1 1  ON 13
 ud_4                -6.092973e-02 1 1  ON 14
 ud_5                -1.025847e-01 1 1  ON 15
 ud_6                -1.303344e-01 1 1  ON 16
 ud_7                -1.481605e-01 1 1  ON 17
 ud_8                -1.518514e-01 1 1  ON 18
 ud_9                -1.447741e-01 1 1  ON 19
 eO_0                -7.497092e-01 1 1  ON 20
 eO_1                -4.361126e-01 1 1  ON 21
 eO_2                -2.592316e-02 1 1  ON 22
 eO_3                 2.943930e-01 1 1  ON 23
 eO_4                 5.212240e-01 1 1  ON 24
 eO_5                 4.824881e-01 1 1  ON 25
 eO_6                 2.579422e-01 1 1  ON 26
 eO_7                -4.108736e-02 1 1  ON 27
 eO_8                -2.210668e-01 1 1  ON 28
 eO_9                -8.120066e-02 1 1  ON 29
eH1_0                -2.399392e-01 1 1  ON 30
eH1_1                -1.370018e-01 1 1  ON 31
eH1_2                -9.213073e-02 1 1  ON 32
eH1_3                -4.110539e-02 1 1  ON 33
eH1_4                 7.325819e-03 1 1  ON 34
eH1_5                 3.844943e-02 1 1  ON 35
eH1_6                 9.639082e-02 1 1  ON 36
eH1_7                 1.492133e-01 1 1  ON 37
eH1_8                 1.686019e-01 1 1  ON 38
eH1_9                 5.471290e-02 1 1  ON 39
eH2_0                -2.386362e-01 1 1  ON 40
eH2_1                -1.357590e-01 1 1  ON 41
eH2_2                -9.096329e-02 1 1  ON 42
eH2_3                -3.967165e-02 1 1  ON 43
eH2_4                 8.353863e-03 1 1  ON 44
eH2_5                 3.987851e-02 1 1  ON 45
eH2_6                 9.826481e-02 1 1  ON 46
eH2_7                 1.497436e-01 1 1  ON 47
eH2_8                 1.801151e-01 1 1  ON 48
eH2_9                 4.502421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.8604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.179418
====================================================
  Execution time = 2.3174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2804e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328082592074
                                         uncertainty =       0.002950595408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328082592074
                                         uncertainty =       0.002950595408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404991250
  error estimate for blocks of size 2^( 2) =       0.000416976546
  error estimate for blocks of size 2^( 3) =       0.000429202368
  error estimate for blocks of size 2^( 4) =       0.000440888252
  error estimate for blocks of size 2^( 5) =       0.000451717582
  error estimate for blocks of size 2^( 6) =       0.000458688359
  error estimate for blocks of size 2^( 7) =       0.000461170516

      target function =                  N/A
              le_mean =     -16.909668553949
             les_mean =     286.264926265050
             stat err =       0.000453116177
             autocorr =       1.251779559997
              std dev =       0.572744117962
             le_variance =       0.328035824660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690966855395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909668553949       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909670506953       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909670623969       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909670556607       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909670662154       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909670762283       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909670849159       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909670837363       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909670838068       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.768117e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909668553949       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909669061610       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909669096376       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909669076949       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909669097318       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909669124899       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909669147715       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909669145966       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909669146444       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 4.613186e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909668553949       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909668682138       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909668691218       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909668686192       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909668690886       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909668697902       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909668703675       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909668703335       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909668703477       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.165734e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9274e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.072453e-01 1 1  ON 0
 uu_1                 1.420453e-01 1 1  ON 1
 uu_2                 4.344669e-02 1 1  ON 2
 uu_3                -1.779155e-02 1 1  ON 3
 uu_4                -6.305101e-02 1 1  ON 4
 uu_5                -9.717629e-02 1 1  ON 5
 uu_6                -1.244928e-01 1 1  ON 6
 uu_7                -1.379279e-01 1 1  ON 7
 uu_8                -1.331591e-01 1 1  ON 8
 uu_9                -1.047948e-01 1 1  ON 9
 ud_0                 4.359564e-01 1 1  ON 10
 ud_1                 1.779403e-01 1 1  ON 11
 ud_2                 6.380003e-02 1 1  ON 12
 ud_3                -4.981830e-03 1 1  ON 13
 ud_4                -6.093458e-02 1 1  ON 14
 ud_5                -1.025855e-01 1 1  ON 15
 ud_6                -1.303433e-01 1 1  ON 16
 ud_7                -1.481680e-01 1 1  ON 17
 ud_8                -1.518540e-01 1 1  ON 18
 ud_9                -1.447769e-01 1 1  ON 19
 eO_0                -7.497235e-01 1 1  ON 20
 eO_1                -4.361117e-01 1 1  ON 21
 eO_2                -2.593011e-02 1 1  ON 22
 eO_3                 2.944092e-01 1 1  ON 23
 eO_4                 5.212336e-01 1 1  ON 24
 eO_5                 4.824936e-01 1 1  ON 25
 eO_6                 2.579469e-01 1 1  ON 26
 eO_7                -4.108150e-02 1 1  ON 27
 eO_8                -2.210764e-01 1 1  ON 28
 eO_9                -8.121109e-02 1 1  ON 29
eH1_0                -2.399672e-01 1 1  ON 30
eH1_1                -1.370121e-01 1 1  ON 31
eH1_2                -9.211851e-02 1 1  ON 32
eH1_3                -4.111205e-02 1 1  ON 33
eH1_4                 7.327585e-03 1 1  ON 34
eH1_5                 3.844714e-02 1 1  ON 35
eH1_6                 9.639321e-02 1 1  ON 36
eH1_7                 1.492215e-01 1 1  ON 37
eH1_8                 1.686134e-01 1 1  ON 38
eH1_9                 5.472425e-02 1 1  ON 39
eH2_0                -2.386622e-01 1 1  ON 40
eH2_1                -1.357748e-01 1 1  ON 41
eH2_2                -9.095111e-02 1 1  ON 42
eH2_3                -3.967370e-02 1 1  ON 43
eH2_4                 8.357753e-03 1 1  ON 44
eH2_5                 3.987421e-02 1 1  ON 45
eH2_6                 9.826882e-02 1 1  ON 46
eH2_7                 1.497496e-01 1 1  ON 47
eH2_8                 1.801207e-01 1 1  ON 48
eH2_9                 4.503919e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.194376
====================================================
  Execution time = 2.2226e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2966e-01
  Total weights = 2.0000e+06
  Execution time = 2.4662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329595723094
                                         uncertainty =       0.004871548118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329595723094
                                         uncertainty =       0.004871548118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405977085
  error estimate for blocks of size 2^( 2) =       0.000417881338
  error estimate for blocks of size 2^( 3) =       0.000429938265
  error estimate for blocks of size 2^( 4) =       0.000440809850
  error estimate for blocks of size 2^( 5) =       0.000450813308
  error estimate for blocks of size 2^( 6) =       0.000461066919
  error estimate for blocks of size 2^( 7) =       0.000468696460

      target function =                  N/A
              le_mean =     -16.910534290960
             les_mean =     286.295804628770
             stat err =       0.000455346634
             autocorr =       1.258001673628
              std dev =       0.574138300272
             le_variance =       0.329634787839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329689134686
                                         uncertainty =       0.004871625751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329689134686
                                         uncertainty =       0.004871625751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406034611
  error estimate for blocks of size 2^( 2) =       0.000417932121
  error estimate for blocks of size 2^( 3) =       0.000429982771
  error estimate for blocks of size 2^( 4) =       0.000440849023
  error estimate for blocks of size 2^( 5) =       0.000450849998
  error estimate for blocks of size 2^( 6) =       0.000461102757
  error estimate for blocks of size 2^( 7) =       0.000468735753

      target function =                  N/A
              le_mean =     -16.910533750891
             les_mean =     286.295879786050
             stat err =       0.000455384383
             autocorr =       1.257853767572
              std dev =       0.574219653857
             le_variance =       0.329728210876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329644521998
                                         uncertainty =       0.004871584304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329644521998
                                         uncertainty =       0.004871584304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406007138
  error estimate for blocks of size 2^( 2) =       0.000417907818
  error estimate for blocks of size 2^( 3) =       0.000429961424
  error estimate for blocks of size 2^( 4) =       0.000440830212
  error estimate for blocks of size 2^( 5) =       0.000450832355
  error estimate for blocks of size 2^( 6) =       0.000461085480
  error estimate for blocks of size 2^( 7) =       0.000468716837

      target function =                  N/A
              le_mean =     -16.910533958784
             les_mean =     286.295842198975
             stat err =       0.000455366221
             autocorr =       1.257923656450
              std dev =       0.574180801347
             le_variance =       0.329683592636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329601871397
                                         uncertainty =       0.004871552518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329601871397
                                         uncertainty =       0.004871552518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405980872
  error estimate for blocks of size 2^( 2) =       0.000417884669
  error estimate for blocks of size 2^( 3) =       0.000429941173
  error estimate for blocks of size 2^( 4) =       0.000440812403
  error estimate for blocks of size 2^( 5) =       0.000450815694
  error estimate for blocks of size 2^( 6) =       0.000461069242
  error estimate for blocks of size 2^( 7) =       0.000468699013

      target function =                  N/A
              le_mean =     -16.910534243358
             les_mean =     286.295809167839
             stat err =       0.000455349088
             autocorr =       1.257991765356
              std dev =       0.574143655266
             le_variance =       0.329640936882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910534290960        initial  <--
     3.8147e+00     3.8147e+01             1.7681e-04       -16.910533750891
     1.5259e+01     1.5259e+02             4.6132e-05       -16.910533958784
     6.1035e+01     6.1035e+02             1.1657e-05       -16.910534243358

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.7559
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.072487e-01 1 1  ON 0
 uu_1                 1.420524e-01 1 1  ON 1
 uu_2                 4.343493e-02 1 1  ON 2
 uu_3                -1.779707e-02 1 1  ON 3
 uu_4                -6.304062e-02 1 1  ON 4
 uu_5                -9.716814e-02 1 1  ON 5
 uu_6                -1.244907e-01 1 1  ON 6
 uu_7                -1.379252e-01 1 1  ON 7
 uu_8                -1.331670e-01 1 1  ON 8
 uu_9                -1.047946e-01 1 1  ON 9
 ud_0                 4.359103e-01 1 1  ON 10
 ud_1                 1.779182e-01 1 1  ON 11
 ud_2                 6.381311e-02 1 1  ON 12
 ud_3                -4.953612e-03 1 1  ON 13
 ud_4                -6.092973e-02 1 1  ON 14
 ud_5                -1.025847e-01 1 1  ON 15
 ud_6                -1.303344e-01 1 1  ON 16
 ud_7                -1.481605e-01 1 1  ON 17
 ud_8                -1.518514e-01 1 1  ON 18
 ud_9                -1.447741e-01 1 1  ON 19
 eO_0                -7.497092e-01 1 1  ON 20
 eO_1                -4.361126e-01 1 1  ON 21
 eO_2                -2.592316e-02 1 1  ON 22
 eO_3                 2.943930e-01 1 1  ON 23
 eO_4                 5.212240e-01 1 1  ON 24
 eO_5                 4.824881e-01 1 1  ON 25
 eO_6                 2.579422e-01 1 1  ON 26
 eO_7                -4.108736e-02 1 1  ON 27
 eO_8                -2.210668e-01 1 1  ON 28
 eO_9                -8.120066e-02 1 1  ON 29
eH1_0                -2.399392e-01 1 1  ON 30
eH1_1                -1.370018e-01 1 1  ON 31
eH1_2                -9.213073e-02 1 1  ON 32
eH1_3                -4.110539e-02 1 1  ON 33
eH1_4                 7.325819e-03 1 1  ON 34
eH1_5                 3.844943e-02 1 1  ON 35
eH1_6                 9.639082e-02 1 1  ON 36
eH1_7                 1.492133e-01 1 1  ON 37
eH1_8                 1.686019e-01 1 1  ON 38
eH1_9                 5.471290e-02 1 1  ON 39
eH2_0                -2.386362e-01 1 1  ON 40
eH2_1                -1.357590e-01 1 1  ON 41
eH2_2                -9.096329e-02 1 1  ON 42
eH2_3                -3.967165e-02 1 1  ON 43
eH2_4                 8.353863e-03 1 1  ON 44
eH2_5                 3.987851e-02 1 1  ON 45
eH2_6                 9.826481e-02 1 1  ON 46
eH2_7                 1.497436e-01 1 1  ON 47
eH2_8                 1.801151e-01 1 1  ON 48
eH2_9                 4.502421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.976
    reference variance = 0.257041
====================================================
  Execution time = 2.2898e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326940964453
                                         uncertainty =       0.003616393038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326940964453
                                         uncertainty =       0.003616393038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404241058
  error estimate for blocks of size 2^( 2) =       0.000416270345
  error estimate for blocks of size 2^( 3) =       0.000429038064
  error estimate for blocks of size 2^( 4) =       0.000440502887
  error estimate for blocks of size 2^( 5) =       0.000451288854
  error estimate for blocks of size 2^( 6) =       0.000459678507
  error estimate for blocks of size 2^( 7) =       0.000464566327

      target function =                  N/A
              le_mean =     -16.910212549578
             les_mean =     286.282109974385
             stat err =       0.000454009144
             autocorr =       1.261387013628
              std dev =       0.571683186655
             le_variance =       0.326821665904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691021254958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212549578       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212757714       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212750779       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212751693       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212768309       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212789121       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212790526       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212789511       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.277169e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212549578       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212601822       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212600088       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212600274       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212604293       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212609515       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212609905       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212609663       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.204426e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212549578       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212562652       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212562218       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212562262       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212563259       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212564565       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212564666       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212564605       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 8.018256e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051990 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8983e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.072483e-01 1 1  ON 0
 uu_1                 1.420527e-01 1 1  ON 1
 uu_2                 4.343541e-02 1 1  ON 2
 uu_3                -1.779610e-02 1 1  ON 3
 uu_4                -6.304115e-02 1 1  ON 4
 uu_5                -9.716920e-02 1 1  ON 5
 uu_6                -1.244918e-01 1 1  ON 6
 uu_7                -1.379262e-01 1 1  ON 7
 uu_8                -1.331662e-01 1 1  ON 8
 uu_9                -1.047945e-01 1 1  ON 9
 ud_0                 4.359129e-01 1 1  ON 10
 ud_1                 1.779206e-01 1 1  ON 11
 ud_2                 6.381085e-02 1 1  ON 12
 ud_3                -4.956816e-03 1 1  ON 13
 ud_4                -6.093040e-02 1 1  ON 14
 ud_5                -1.025847e-01 1 1  ON 15
 ud_6                -1.303353e-01 1 1  ON 16
 ud_7                -1.481606e-01 1 1  ON 17
 ud_8                -1.518503e-01 1 1  ON 18
 ud_9                -1.447732e-01 1 1  ON 19
 eO_0                -7.497116e-01 1 1  ON 20
 eO_1                -4.361118e-01 1 1  ON 21
 eO_2                -2.592321e-02 1 1  ON 22
 eO_3                 2.943942e-01 1 1  ON 23
 eO_4                 5.212241e-01 1 1  ON 24
 eO_5                 4.824888e-01 1 1  ON 25
 eO_6                 2.579424e-01 1 1  ON 26
 eO_7                -4.108685e-02 1 1  ON 27
 eO_8                -2.210671e-01 1 1  ON 28
 eO_9                -8.120140e-02 1 1  ON 29
eH1_0                -2.399417e-01 1 1  ON 30
eH1_1                -1.370029e-01 1 1  ON 31
eH1_2                -9.212970e-02 1 1  ON 32
eH1_3                -4.110584e-02 1 1  ON 33
eH1_4                 7.325801e-03 1 1  ON 34
eH1_5                 3.844935e-02 1 1  ON 35
eH1_6                 9.639066e-02 1 1  ON 36
eH1_7                 1.492139e-01 1 1  ON 37
eH1_8                 1.686030e-01 1 1  ON 38
eH1_9                 5.471427e-02 1 1  ON 39
eH2_0                -2.386386e-01 1 1  ON 40
eH2_1                -1.357599e-01 1 1  ON 41
eH2_2                -9.096196e-02 1 1  ON 42
eH2_3                -3.967195e-02 1 1  ON 43
eH2_4                 8.353682e-03 1 1  ON 44
eH2_5                 3.987745e-02 1 1  ON 45
eH2_6                 9.826553e-02 1 1  ON 46
eH2_7                 1.497439e-01 1 1  ON 47
eH2_8                 1.801159e-01 1 1  ON 48
eH2_9                 4.502578e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8804
    reference variance = 0.134391
====================================================
  Execution time = 2.2290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2480e-01
  Total weights = 2.0000e+06
  Execution time = 2.4653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324484659508
                                         uncertainty =       0.002658051061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324484659508
                                         uncertainty =       0.002658051061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402985047
  error estimate for blocks of size 2^( 2) =       0.000415118721
  error estimate for blocks of size 2^( 3) =       0.000427719258
  error estimate for blocks of size 2^( 4) =       0.000439492517
  error estimate for blocks of size 2^( 5) =       0.000450474090
  error estimate for blocks of size 2^( 6) =       0.000460369853
  error estimate for blocks of size 2^( 7) =       0.000468615571

      target function =                  N/A
              le_mean =     -16.909656839241
             les_mean =     286.261288155100
             stat err =       0.000454738008
             autocorr =       1.273340773167
              std dev =       0.569906919258
             le_variance =       0.324793896618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492098864
                                         uncertainty =       0.002658098505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492098864
                                         uncertainty =       0.002658098505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402989659
  error estimate for blocks of size 2^( 2) =       0.000415122551
  error estimate for blocks of size 2^( 3) =       0.000427722438
  error estimate for blocks of size 2^( 4) =       0.000439495329
  error estimate for blocks of size 2^( 5) =       0.000450476776
  error estimate for blocks of size 2^( 6) =       0.000460372474
  error estimate for blocks of size 2^( 7) =       0.000468617774

      target function =                  N/A
              le_mean =     -16.909657009250
             les_mean =     286.261301338282
             stat err =       0.000454740588
             autocorr =       1.273326081481
              std dev =       0.569913440987
             le_variance =       0.324801330217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488379156
                                         uncertainty =       0.002658074808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488379156
                                         uncertainty =       0.002658074808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402987353
  error estimate for blocks of size 2^( 2) =       0.000415120634
  error estimate for blocks of size 2^( 3) =       0.000427720845
  error estimate for blocks of size 2^( 4) =       0.000439493919
  error estimate for blocks of size 2^( 5) =       0.000450475428
  error estimate for blocks of size 2^( 6) =       0.000460371158
  error estimate for blocks of size 2^( 7) =       0.000468616666

      target function =                  N/A
              le_mean =     -16.909656924200
             les_mean =     286.261294745088
             stat err =       0.000454739293
             autocorr =       1.273333399007
              std dev =       0.569910180071
             le_variance =       0.324797613348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324485124280
                                         uncertainty =       0.002658054030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324485124280
                                         uncertainty =       0.002658054030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402985335
  error estimate for blocks of size 2^( 2) =       0.000415118960
  error estimate for blocks of size 2^( 3) =       0.000427719456
  error estimate for blocks of size 2^( 4) =       0.000439492692
  error estimate for blocks of size 2^( 5) =       0.000450474257
  error estimate for blocks of size 2^( 6) =       0.000460370016
  error estimate for blocks of size 2^( 7) =       0.000468615708

      target function =                  N/A
              le_mean =     -16.909656849820
             les_mean =     286.261288977301
             stat err =       0.000454738168
             autocorr =       1.273339850300
              std dev =       0.569907326698
             le_variance =       0.324794361025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909656839241        initial
     3.8147e+01     3.8147e+02             1.2772e-05       -16.909657009250  <--
     1.5259e+02     1.5259e+03             3.2044e-06       -16.909656924200
     6.1035e+02     6.1035e+03             8.0183e-07       -16.909656849820

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 3.4825e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.072469e-01 1 1  ON 0
 uu_1                 1.420538e-01 1 1  ON 1
 uu_2                 4.343685e-02 1 1  ON 2
 uu_3                -1.779321e-02 1 1  ON 3
 uu_4                -6.304274e-02 1 1  ON 4
 uu_5                -9.717239e-02 1 1  ON 5
 uu_6                -1.244954e-01 1 1  ON 6
 uu_7                -1.379294e-01 1 1  ON 7
 uu_8                -1.331638e-01 1 1  ON 8
 uu_9                -1.047940e-01 1 1  ON 9
 ud_0                 4.359209e-01 1 1  ON 10
 ud_1                 1.779277e-01 1 1  ON 11
 ud_2                 6.380415e-02 1 1  ON 12
 ud_3                -4.966383e-03 1 1  ON 13
 ud_4                -6.093242e-02 1 1  ON 14
 ud_5                -1.025846e-01 1 1  ON 15
 ud_6                -1.303378e-01 1 1  ON 16
 ud_7                -1.481610e-01 1 1  ON 17
 ud_8                -1.518470e-01 1 1  ON 18
 ud_9                -1.447706e-01 1 1  ON 19
 eO_0                -7.497189e-01 1 1  ON 20
 eO_1                -4.361092e-01 1 1  ON 21
 eO_2                -2.592335e-02 1 1  ON 22
 eO_3                 2.943978e-01 1 1  ON 23
 eO_4                 5.212245e-01 1 1  ON 24
 eO_5                 4.824910e-01 1 1  ON 25
 eO_6                 2.579430e-01 1 1  ON 26
 eO_7                -4.108532e-02 1 1  ON 27
 eO_8                -2.210680e-01 1 1  ON 28
 eO_9                -8.120364e-02 1 1  ON 29
eH1_0                -2.399490e-01 1 1  ON 30
eH1_1                -1.370061e-01 1 1  ON 31
eH1_2                -9.212661e-02 1 1  ON 32
eH1_3                -4.110717e-02 1 1  ON 33
eH1_4                 7.325746e-03 1 1  ON 34
eH1_5                 3.844913e-02 1 1  ON 35
eH1_6                 9.639020e-02 1 1  ON 36
eH1_7                 1.492157e-01 1 1  ON 37
eH1_8                 1.686062e-01 1 1  ON 38
eH1_9                 5.471839e-02 1 1  ON 39
eH2_0                -2.386461e-01 1 1  ON 40
eH2_1                -1.357626e-01 1 1  ON 41
eH2_2                -9.095798e-02 1 1  ON 42
eH2_3                -3.967281e-02 1 1  ON 43
eH2_4                 8.353139e-03 1 1  ON 44
eH2_5                 3.987430e-02 1 1  ON 45
eH2_6                 9.826767e-02 1 1  ON 46
eH2_7                 1.497446e-01 1 1  ON 47
eH2_8                 1.801182e-01 1 1  ON 48
eH2_9                 4.503047e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3814e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8787
    reference variance = 0.443941
====================================================
  Execution time = 2.3150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329318932749
                                         uncertainty =       0.006231376579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329318932749
                                         uncertainty =       0.006231376579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405785800
  error estimate for blocks of size 2^( 2) =       0.000417483400
  error estimate for blocks of size 2^( 3) =       0.000429559689
  error estimate for blocks of size 2^( 4) =       0.000441516662
  error estimate for blocks of size 2^( 5) =       0.000450922261
  error estimate for blocks of size 2^( 6) =       0.000458863085
  error estimate for blocks of size 2^( 7) =       0.000466480321

      target function =                  N/A
              le_mean =     -16.909452900660
             les_mean =     286.258921465628
             stat err =       0.000454445582
             autocorr =       1.254209487519
              std dev =       0.573867781510
             le_variance =       0.329324230655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690945290066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909452900660       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909454180506       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909454774833       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909454840772       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909454810320       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909454743117       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909454675205       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909454679669       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909454688457       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 7.478992e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909452900660       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909453225925       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909453379122       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909453397172       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909453390964       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909453373667       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909453356099       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909453356685       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909453358458       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.902506e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909452900660       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909452982314       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909453020914       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909453025528       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909453024069       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909453019719       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909453015291       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909453015401       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909453015815       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 4.776924e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9285e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.072468e-01 1 1  ON 0
 uu_1                 1.420528e-01 1 1  ON 1
 uu_2                 4.343909e-02 1 1  ON 2
 uu_3                -1.779057e-02 1 1  ON 3
 uu_4                -6.304372e-02 1 1  ON 4
 uu_5                -9.717473e-02 1 1  ON 5
 uu_6                -1.244967e-01 1 1  ON 6
 uu_7                -1.379317e-01 1 1  ON 7
 uu_8                -1.331612e-01 1 1  ON 8
 uu_9                -1.047954e-01 1 1  ON 9
 ud_0                 4.359399e-01 1 1  ON 10
 ud_1                 1.779371e-01 1 1  ON 11
 ud_2                 6.379727e-02 1 1  ON 12
 ud_3                -4.978678e-03 1 1  ON 13
 ud_4                -6.093489e-02 1 1  ON 14
 ud_5                -1.025848e-01 1 1  ON 15
 ud_6                -1.303425e-01 1 1  ON 16
 ud_7                -1.481635e-01 1 1  ON 17
 ud_8                -1.518452e-01 1 1  ON 18
 ud_9                -1.447715e-01 1 1  ON 19
 eO_0                -7.497261e-01 1 1  ON 20
 eO_1                -4.361073e-01 1 1  ON 21
 eO_2                -2.592476e-02 1 1  ON 22
 eO_3                 2.944033e-01 1 1  ON 23
 eO_4                 5.212287e-01 1 1  ON 24
 eO_5                 4.824936e-01 1 1  ON 25
 eO_6                 2.579435e-01 1 1  ON 26
 eO_7                -4.108333e-02 1 1  ON 27
 eO_8                -2.210708e-01 1 1  ON 28
 eO_9                -8.120814e-02 1 1  ON 29
eH1_0                -2.399609e-01 1 1  ON 30
eH1_1                -1.370111e-01 1 1  ON 31
eH1_2                -9.212173e-02 1 1  ON 32
eH1_3                -4.110691e-02 1 1  ON 33
eH1_4                 7.322698e-03 1 1  ON 34
eH1_5                 3.844935e-02 1 1  ON 35
eH1_6                 9.639161e-02 1 1  ON 36
eH1_7                 1.492182e-01 1 1  ON 37
eH1_8                 1.686107e-01 1 1  ON 38
eH1_9                 5.472386e-02 1 1  ON 39
eH2_0                -2.386580e-01 1 1  ON 40
eH2_1                -1.357670e-01 1 1  ON 41
eH2_2                -9.095310e-02 1 1  ON 42
eH2_3                -3.967151e-02 1 1  ON 43
eH2_4                 8.354500e-03 1 1  ON 44
eH2_5                 3.987486e-02 1 1  ON 45
eH2_6                 9.826840e-02 1 1  ON 46
eH2_7                 1.497457e-01 1 1  ON 47
eH2_8                 1.801205e-01 1 1  ON 48
eH2_9                 4.503499e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.348544
====================================================
  Execution time = 2.2606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3567e-01
  Total weights = 2.0000e+06
  Execution time = 2.4652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335742975307
                                         uncertainty =       0.005330939893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335742975307
                                         uncertainty =       0.005330939893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409666158
  error estimate for blocks of size 2^( 2) =       0.000421630491
  error estimate for blocks of size 2^( 3) =       0.000433834693
  error estimate for blocks of size 2^( 4) =       0.000445507863
  error estimate for blocks of size 2^( 5) =       0.000456807752
  error estimate for blocks of size 2^( 6) =       0.000465139001
  error estimate for blocks of size 2^( 7) =       0.000472063061

      target function =                  N/A
              le_mean =     -16.910602848146
             les_mean =     286.304141241805
             stat err =       0.000459879419
             autocorr =       1.260166038073
              std dev =       0.579355436592
             le_variance =       0.335652721908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335792928112
                                         uncertainty =       0.005331098792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335792928112
                                         uncertainty =       0.005331098792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409696629
  error estimate for blocks of size 2^( 2) =       0.000421657871
  error estimate for blocks of size 2^( 3) =       0.000433859279
  error estimate for blocks of size 2^( 4) =       0.000445530539
  error estimate for blocks of size 2^( 5) =       0.000456828598
  error estimate for blocks of size 2^( 6) =       0.000465159293
  error estimate for blocks of size 2^( 7) =       0.000472083278

      target function =                  N/A
              le_mean =     -16.910603163083
             les_mean =     286.304201826634
             stat err =       0.000459900427
             autocorr =       1.260093712333
              std dev =       0.579398528842
             le_variance =       0.335702655224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335768453585
                                         uncertainty =       0.005331018801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335768453585
                                         uncertainty =       0.005331018801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409681700
  error estimate for blocks of size 2^( 2) =       0.000421644451
  error estimate for blocks of size 2^( 3) =       0.000433847224
  error estimate for blocks of size 2^( 4) =       0.000445519416
  error estimate for blocks of size 2^( 5) =       0.000456818370
  error estimate for blocks of size 2^( 6) =       0.000465149337
  error estimate for blocks of size 2^( 7) =       0.000472073359

      target function =                  N/A
              le_mean =     -16.910603004977
             les_mean =     286.304172014376
             stat err =       0.000459890121
             autocorr =       1.260129070616
              std dev =       0.579377416098
             le_variance =       0.335678190284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335746173054
                                         uncertainty =       0.005330949731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335746173054
                                         uncertainty =       0.005330949731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409668109
  error estimate for blocks of size 2^( 2) =       0.000421632242
  error estimate for blocks of size 2^( 3) =       0.000433836264
  error estimate for blocks of size 2^( 4) =       0.000445509311
  error estimate for blocks of size 2^( 5) =       0.000456809083
  error estimate for blocks of size 2^( 6) =       0.000465140297
  error estimate for blocks of size 2^( 7) =       0.000472064352

      target function =                  N/A
              le_mean =     -16.910602867055
             les_mean =     286.304145077824
             stat err =       0.000459880761
             autocorr =       1.260161387485
              std dev =       0.579358195259
             le_variance =       0.335655918414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910602848146        initial
     9.5367e+00     9.5367e+01             7.4790e-05       -16.910603163083  <--
     3.8147e+01     3.8147e+02             1.9025e-05       -16.910603004977
     1.5259e+02     1.5259e+03             4.7769e-06       -16.910602867055

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 3.5150e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.072467e-01 1 1  ON 0
 uu_1                 1.420502e-01 1 1  ON 1
 uu_2                 4.344559e-02 1 1  ON 2
 uu_3                -1.778289e-02 1 1  ON 3
 uu_4                -6.304661e-02 1 1  ON 4
 uu_5                -9.718158e-02 1 1  ON 5
 uu_6                -1.245005e-01 1 1  ON 6
 uu_7                -1.379387e-01 1 1  ON 7
 uu_8                -1.331536e-01 1 1  ON 8
 uu_9                -1.047995e-01 1 1  ON 9
 ud_0                 4.359957e-01 1 1  ON 10
 ud_1                 1.779641e-01 1 1  ON 11
 ud_2                 6.377779e-02 1 1  ON 12
 ud_3                -5.014651e-03 1 1  ON 13
 ud_4                -6.094255e-02 1 1  ON 14
 ud_5                -1.025854e-01 1 1  ON 15
 ud_6                -1.303562e-01 1 1  ON 16
 ud_7                -1.481710e-01 1 1  ON 17
 ud_8                -1.518399e-01 1 1  ON 18
 ud_9                -1.447742e-01 1 1  ON 19
 eO_0                -7.497475e-01 1 1  ON 20
 eO_1                -4.361013e-01 1 1  ON 21
 eO_2                -2.592893e-02 1 1  ON 22
 eO_3                 2.944192e-01 1 1  ON 23
 eO_4                 5.212413e-01 1 1  ON 24
 eO_5                 4.825014e-01 1 1  ON 25
 eO_6                 2.579449e-01 1 1  ON 26
 eO_7                -4.107737e-02 1 1  ON 27
 eO_8                -2.210790e-01 1 1  ON 28
 eO_9                -8.122161e-02 1 1  ON 29
eH1_0                -2.399965e-01 1 1  ON 30
eH1_1                -1.370256e-01 1 1  ON 31
eH1_2                -9.210752e-02 1 1  ON 32
eH1_3                -4.110605e-02 1 1  ON 33
eH1_4                 7.313613e-03 1 1  ON 34
eH1_5                 3.844996e-02 1 1  ON 35
eH1_6                 9.639589e-02 1 1  ON 36
eH1_7                 1.492255e-01 1 1  ON 37
eH1_8                 1.686242e-01 1 1  ON 38
eH1_9                 5.474024e-02 1 1  ON 39
eH2_0                -2.386938e-01 1 1  ON 40
eH2_1                -1.357799e-01 1 1  ON 41
eH2_2                -9.093884e-02 1 1  ON 42
eH2_3                -3.966750e-02 1 1  ON 43
eH2_4                 8.358531e-03 1 1  ON 44
eH2_5                 3.987653e-02 1 1  ON 45
eH2_6                 9.827063e-02 1 1  ON 46
eH2_7                 1.497491e-01 1 1  ON 47
eH2_8                 1.801277e-01 1 1  ON 48
eH2_9                 4.504853e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8694
    reference variance = 0.301503
====================================================
  Execution time = 2.3318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329902837079
                                         uncertainty =       0.004914067228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329902837079
                                         uncertainty =       0.004914067228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406212871
  error estimate for blocks of size 2^( 2) =       0.000418292315
  error estimate for blocks of size 2^( 3) =       0.000430831380
  error estimate for blocks of size 2^( 4) =       0.000443378614
  error estimate for blocks of size 2^( 5) =       0.000455416615
  error estimate for blocks of size 2^( 6) =       0.000465059409
  error estimate for blocks of size 2^( 7) =       0.000473106569

      target function =                  N/A
              le_mean =     -16.909733559284
             les_mean =     286.269106674825
             stat err =       0.000459240302
             autocorr =       1.278122930514
              std dev =       0.574471752020
             le_variance =       0.330017793869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690973355928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909733559284       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909736126952       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909736493690       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909736624491       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909736900444       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909737333816       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909737374983       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909737393400       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909737400523       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 2.239349e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909733559284       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909734243085       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909734349898       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909734383043       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909734430232       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909734551767       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909734566460       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909734570921       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909734573119       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 5.934248e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909733559284       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909733733069       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909733760900       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909733769271       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909733779643       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909733810588       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909733814570       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909733815780       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909733816298       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.503631e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9457e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.072431e-01 1 1  ON 0
 uu_1                 1.420431e-01 1 1  ON 1
 uu_2                 4.345691e-02 1 1  ON 2
 uu_3                -1.777950e-02 1 1  ON 3
 uu_4                -6.305377e-02 1 1  ON 4
 uu_5                -9.720428e-02 1 1  ON 5
 uu_6                -1.245186e-01 1 1  ON 6
 uu_7                -1.379412e-01 1 1  ON 7
 uu_8                -1.331283e-01 1 1  ON 8
 uu_9                -1.047933e-01 1 1  ON 9
 ud_0                 4.360550e-01 1 1  ON 10
 ud_1                 1.780023e-01 1 1  ON 11
 ud_2                 6.373925e-02 1 1  ON 12
 ud_3                -5.059491e-03 1 1  ON 13
 ud_4                -6.094994e-02 1 1  ON 14
 ud_5                -1.026002e-01 1 1  ON 15
 ud_6                -1.303711e-01 1 1  ON 16
 ud_7                -1.481877e-01 1 1  ON 17
 ud_8                -1.518142e-01 1 1  ON 18
 ud_9                -1.447584e-01 1 1  ON 19
 eO_0                -7.497865e-01 1 1  ON 20
 eO_1                -4.360901e-01 1 1  ON 21
 eO_2                -2.593598e-02 1 1  ON 22
 eO_3                 2.944429e-01 1 1  ON 23
 eO_4                 5.212514e-01 1 1  ON 24
 eO_5                 4.825140e-01 1 1  ON 25
 eO_6                 2.579458e-01 1 1  ON 26
 eO_7                -4.107330e-02 1 1  ON 27
 eO_8                -2.210825e-01 1 1  ON 28
 eO_9                -8.123231e-02 1 1  ON 29
eH1_0                -2.400452e-01 1 1  ON 30
eH1_1                -1.370473e-01 1 1  ON 31
eH1_2                -9.208614e-02 1 1  ON 32
eH1_3                -4.110693e-02 1 1  ON 33
eH1_4                 7.309116e-03 1 1  ON 34
eH1_5                 3.845191e-02 1 1  ON 35
eH1_6                 9.639672e-02 1 1  ON 36
eH1_7                 1.492311e-01 1 1  ON 37
eH1_8                 1.686474e-01 1 1  ON 38
eH1_9                 5.476302e-02 1 1  ON 39
eH2_0                -2.387469e-01 1 1  ON 40
eH2_1                -1.358156e-01 1 1  ON 41
eH2_2                -9.092498e-02 1 1  ON 42
eH2_3                -3.966725e-02 1 1  ON 43
eH2_4                 8.354013e-03 1 1  ON 44
eH2_5                 3.988640e-02 1 1  ON 45
eH2_6                 9.829093e-02 1 1  ON 46
eH2_7                 1.497602e-01 1 1  ON 47
eH2_8                 1.801387e-01 1 1  ON 48
eH2_9                 4.507233e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8482
    reference variance = 0.303045
====================================================
  Execution time = 2.2212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2794e-01
  Total weights = 2.0000e+06
  Execution time = 2.4554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327993755781
                                         uncertainty =       0.002920204574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327993755781
                                         uncertainty =       0.002920204574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404904235
  error estimate for blocks of size 2^( 2) =       0.000416694884
  error estimate for blocks of size 2^( 3) =       0.000429516041
  error estimate for blocks of size 2^( 4) =       0.000442049154
  error estimate for blocks of size 2^( 5) =       0.000453680765
  error estimate for blocks of size 2^( 6) =       0.000462644470
  error estimate for blocks of size 2^( 7) =       0.000469054653

      target function =                  N/A
              le_mean =     -16.909691047240
             les_mean =     286.265546028589
             stat err =       0.000456857260
             autocorr =       1.273082133046
              std dev =       0.572621060947
             le_variance =       0.327894879440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328149910133
                                         uncertainty =       0.002920123843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328149910133
                                         uncertainty =       0.002920123843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405000595
  error estimate for blocks of size 2^( 2) =       0.000416779673
  error estimate for blocks of size 2^( 3) =       0.000429590460
  error estimate for blocks of size 2^( 4) =       0.000442114999
  error estimate for blocks of size 2^( 5) =       0.000453743965
  error estimate for blocks of size 2^( 6) =       0.000462704246
  error estimate for blocks of size 2^( 7) =       0.000469115989

      target function =                  N/A
              le_mean =     -16.909689632814
             les_mean =     286.265654278034
             stat err =       0.000456919800
             autocorr =       1.272824813325
              std dev =       0.572757334265
             le_variance =       0.328050963954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328076942491
                                         uncertainty =       0.002920120486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328076942491
                                         uncertainty =       0.002920120486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404955571
  error estimate for blocks of size 2^( 2) =       0.000416739880
  error estimate for blocks of size 2^( 3) =       0.000429555354
  error estimate for blocks of size 2^( 4) =       0.000442083861
  error estimate for blocks of size 2^( 5) =       0.000453713953
  error estimate for blocks of size 2^( 6) =       0.000462675817
  error estimate for blocks of size 2^( 7) =       0.000469086968

      target function =                  N/A
              le_mean =     -16.909690106597
             les_mean =     286.265597366441
             stat err =       0.000456890150
             autocorr =       1.272942638101
              std dev =       0.572693660944
             le_variance =       0.327978029286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328004256316
                                         uncertainty =       0.002920192128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328004256316
                                         uncertainty =       0.002920192128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404910716
  error estimate for blocks of size 2^( 2) =       0.000416700547
  error estimate for blocks of size 2^( 3) =       0.000429520972
  error estimate for blocks of size 2^( 4) =       0.000442053495
  error estimate for blocks of size 2^( 5) =       0.000453684908
  error estimate for blocks of size 2^( 6) =       0.000462648378
  error estimate for blocks of size 2^( 7) =       0.000469058690

      target function =                  N/A
              le_mean =     -16.909690909562
             les_mean =     286.265551868282
             stat err =       0.000456861368
             autocorr =       1.273064275892
              std dev =       0.572630225631
             le_variance =       0.327905375306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909691047240        initial  <--
     2.3842e+00     2.3842e+01             2.2393e-04       -16.909689632814
     9.5367e+00     9.5367e+01             5.9342e-05       -16.909690106597
     3.8147e+01     3.8147e+02             1.5036e-05       -16.909690909562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.6998
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.072467e-01 1 1  ON 0
 uu_1                 1.420502e-01 1 1  ON 1
 uu_2                 4.344559e-02 1 1  ON 2
 uu_3                -1.778289e-02 1 1  ON 3
 uu_4                -6.304661e-02 1 1  ON 4
 uu_5                -9.718158e-02 1 1  ON 5
 uu_6                -1.245005e-01 1 1  ON 6
 uu_7                -1.379387e-01 1 1  ON 7
 uu_8                -1.331536e-01 1 1  ON 8
 uu_9                -1.047995e-01 1 1  ON 9
 ud_0                 4.359957e-01 1 1  ON 10
 ud_1                 1.779641e-01 1 1  ON 11
 ud_2                 6.377779e-02 1 1  ON 12
 ud_3                -5.014651e-03 1 1  ON 13
 ud_4                -6.094255e-02 1 1  ON 14
 ud_5                -1.025854e-01 1 1  ON 15
 ud_6                -1.303562e-01 1 1  ON 16
 ud_7                -1.481710e-01 1 1  ON 17
 ud_8                -1.518399e-01 1 1  ON 18
 ud_9                -1.447742e-01 1 1  ON 19
 eO_0                -7.497475e-01 1 1  ON 20
 eO_1                -4.361013e-01 1 1  ON 21
 eO_2                -2.592893e-02 1 1  ON 22
 eO_3                 2.944192e-01 1 1  ON 23
 eO_4                 5.212413e-01 1 1  ON 24
 eO_5                 4.825014e-01 1 1  ON 25
 eO_6                 2.579449e-01 1 1  ON 26
 eO_7                -4.107737e-02 1 1  ON 27
 eO_8                -2.210790e-01 1 1  ON 28
 eO_9                -8.122161e-02 1 1  ON 29
eH1_0                -2.399965e-01 1 1  ON 30
eH1_1                -1.370256e-01 1 1  ON 31
eH1_2                -9.210752e-02 1 1  ON 32
eH1_3                -4.110605e-02 1 1  ON 33
eH1_4                 7.313613e-03 1 1  ON 34
eH1_5                 3.844996e-02 1 1  ON 35
eH1_6                 9.639589e-02 1 1  ON 36
eH1_7                 1.492255e-01 1 1  ON 37
eH1_8                 1.686242e-01 1 1  ON 38
eH1_9                 5.474024e-02 1 1  ON 39
eH2_0                -2.386938e-01 1 1  ON 40
eH2_1                -1.357799e-01 1 1  ON 41
eH2_2                -9.093884e-02 1 1  ON 42
eH2_3                -3.966750e-02 1 1  ON 43
eH2_4                 8.358531e-03 1 1  ON 44
eH2_5                 3.987653e-02 1 1  ON 45
eH2_6                 9.827063e-02 1 1  ON 46
eH2_7                 1.497491e-01 1 1  ON 47
eH2_8                 1.801277e-01 1 1  ON 48
eH2_9                 4.504853e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4163e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9068
    reference variance = 0.214257
====================================================
  Execution time = 2.2966e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326201194796
                                         uncertainty =       0.003465143531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326201194796
                                         uncertainty =       0.003465143531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403865552
  error estimate for blocks of size 2^( 2) =       0.000416077377
  error estimate for blocks of size 2^( 3) =       0.000428823155
  error estimate for blocks of size 2^( 4) =       0.000440306678
  error estimate for blocks of size 2^( 5) =       0.000449271630
  error estimate for blocks of size 2^( 6) =       0.000457678717
  error estimate for blocks of size 2^( 7) =       0.000460366512

      target function =                  N/A
              le_mean =     -16.910644326339
             les_mean =     286.296106137302
             stat err =       0.000451905884
             autocorr =       1.252052009499
              std dev =       0.571152141266
             le_variance =       0.326214768472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691064432634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910644326339       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910644723811       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910644896881       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910644924915       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910644926163       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910644920711       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910644918790       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910644919490       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910644921725       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 2.021277e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910644326339       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910644426326       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910644469989       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910644477156       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910644477578       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910644476185       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910644475759       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910644475898       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910644476447       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 5.055992e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910644326339       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910644351375       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910644362316       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910644364117       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910644364230       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910644363880       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910644363777       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910644363810       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910644363946       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.264169e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061362 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9123e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.072453e-01 1 1  ON 0
 uu_1                 1.420486e-01 1 1  ON 1
 uu_2                 4.344803e-02 1 1  ON 2
 uu_3                -1.778293e-02 1 1  ON 3
 uu_4                -6.304724e-02 1 1  ON 4
 uu_5                -9.718352e-02 1 1  ON 5
 uu_6                -1.245009e-01 1 1  ON 6
 uu_7                -1.379389e-01 1 1  ON 7
 uu_8                -1.331523e-01 1 1  ON 8
 uu_9                -1.047991e-01 1 1  ON 9
 ud_0                 4.360001e-01 1 1  ON 10
 ud_1                 1.779691e-01 1 1  ON 11
 ud_2                 6.377588e-02 1 1  ON 12
 ud_3                -5.018780e-03 1 1  ON 13
 ud_4                -6.094314e-02 1 1  ON 14
 ud_5                -1.025855e-01 1 1  ON 15
 ud_6                -1.303584e-01 1 1  ON 16
 ud_7                -1.481731e-01 1 1  ON 17
 ud_8                -1.518395e-01 1 1  ON 18
 ud_9                -1.447734e-01 1 1  ON 19
 eO_0                -7.497504e-01 1 1  ON 20
 eO_1                -4.361003e-01 1 1  ON 21
 eO_2                -2.593003e-02 1 1  ON 22
 eO_3                 2.944216e-01 1 1  ON 23
 eO_4                 5.212426e-01 1 1  ON 24
 eO_5                 4.825019e-01 1 1  ON 25
 eO_6                 2.579454e-01 1 1  ON 26
 eO_7                -4.107716e-02 1 1  ON 27
 eO_8                -2.210797e-01 1 1  ON 28
 eO_9                -8.122282e-02 1 1  ON 29
eH1_0                -2.400016e-01 1 1  ON 30
eH1_1                -1.370301e-01 1 1  ON 31
eH1_2                -9.210568e-02 1 1  ON 32
eH1_3                -4.110405e-02 1 1  ON 33
eH1_4                 7.313179e-03 1 1  ON 34
eH1_5                 3.845004e-02 1 1  ON 35
eH1_6                 9.639775e-02 1 1  ON 36
eH1_7                 1.492264e-01 1 1  ON 37
eH1_8                 1.686256e-01 1 1  ON 38
eH1_9                 5.474207e-02 1 1  ON 39
eH2_0                -2.386979e-01 1 1  ON 40
eH2_1                -1.357817e-01 1 1  ON 41
eH2_2                -9.093705e-02 1 1  ON 42
eH2_3                -3.966719e-02 1 1  ON 43
eH2_4                 8.359018e-03 1 1  ON 44
eH2_5                 3.987626e-02 1 1  ON 45
eH2_6                 9.827056e-02 1 1  ON 46
eH2_7                 1.497495e-01 1 1  ON 47
eH2_8                 1.801289e-01 1 1  ON 48
eH2_9                 4.505050e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.278419
====================================================
  Execution time = 2.4586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3714e-01
  Total weights = 2.0000e+06
  Execution time = 2.4651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337256835180
                                         uncertainty =       0.005502466663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337256835180
                                         uncertainty =       0.005502466663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410569376
  error estimate for blocks of size 2^( 2) =       0.000423000074
  error estimate for blocks of size 2^( 3) =       0.000435612023
  error estimate for blocks of size 2^( 4) =       0.000448362335
  error estimate for blocks of size 2^( 5) =       0.000459342951
  error estimate for blocks of size 2^( 6) =       0.000469404900
  error estimate for blocks of size 2^( 7) =       0.000477196556

      target function =                  N/A
              le_mean =     -16.910203007239
             les_mean =     286.292100001706
             stat err =       0.000463576686
             autocorr =       1.274882230787
              std dev =       0.580632779176
             le_variance =       0.337134424254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337261892427
                                         uncertainty =       0.005502774749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337261892427
                                         uncertainty =       0.005502774749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410572453
  error estimate for blocks of size 2^( 2) =       0.000423002125
  error estimate for blocks of size 2^( 3) =       0.000435613177
  error estimate for blocks of size 2^( 4) =       0.000448362509
  error estimate for blocks of size 2^( 5) =       0.000459342611
  error estimate for blocks of size 2^( 6) =       0.000469404709
  error estimate for blocks of size 2^( 7) =       0.000477196236

      target function =                  N/A
              le_mean =     -16.910203348537
             les_mean =     286.292116598485
             stat err =       0.000463576516
             autocorr =       1.274862187590
              std dev =       0.580637131242
             le_variance =       0.337139478177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337259323097
                                         uncertainty =       0.005502621628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337259323097
                                         uncertainty =       0.005502621628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410570889
  error estimate for blocks of size 2^( 2) =       0.000423001070
  error estimate for blocks of size 2^( 3) =       0.000435612568
  error estimate for blocks of size 2^( 4) =       0.000448362387
  error estimate for blocks of size 2^( 5) =       0.000459342745
  error estimate for blocks of size 2^( 6) =       0.000469404771
  error estimate for blocks of size 2^( 7) =       0.000477196365

      target function =                  N/A
              le_mean =     -16.910203178313
             les_mean =     286.292108273785
             stat err =       0.000463576567
             autocorr =       1.274872176635
              std dev =       0.580634920179
             le_variance =       0.337136910531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257144364
                                         uncertainty =       0.005502486062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257144364
                                         uncertainty =       0.005502486062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410569564
  error estimate for blocks of size 2^( 2) =       0.000423000197
  error estimate for blocks of size 2^( 3) =       0.000435612089
  error estimate for blocks of size 2^( 4) =       0.000448362340
  error estimate for blocks of size 2^( 5) =       0.000459342924
  error estimate for blocks of size 2^( 6) =       0.000469404882
  error estimate for blocks of size 2^( 7) =       0.000477196531

      target function =                  N/A
              le_mean =     -16.910203028537
             les_mean =     286.292101031008
             stat err =       0.000463576669
             autocorr =       1.274880972525
              std dev =       0.580633045248
             le_variance =       0.337134733234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910203007239        initial
     2.3842e+01     2.3842e+02             2.0213e-05       -16.910203348537  <--
     9.5367e+01     9.5367e+02             5.0560e-06       -16.910203178313
     3.8147e+02     3.8147e+03             1.2642e-06       -16.910203028537

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 3.7098e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.072412e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778302e-02 1 1  ON 3
 uu_4                -6.304914e-02 1 1  ON 4
 uu_5                -9.718929e-02 1 1  ON 5
 uu_6                -1.245020e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360135e-01 1 1  ON 10
 ud_1                 1.779835e-01 1 1  ON 11
 ud_2                 6.377029e-02 1 1  ON 12
 ud_3                -5.031051e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025858e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944288e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107654e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122645e-02 1 1  ON 29
eH1_0                -2.400167e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210023e-02 1 1  ON 32
eH1_3                -4.109809e-02 1 1  ON 33
eH1_4                 7.311902e-03 1 1  ON 34
eH1_5                 3.845028e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686297e-01 1 1  ON 38
eH1_9                 5.474756e-02 1 1  ON 39
eH2_0                -2.387104e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093173e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360466e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827035e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801324e-01 1 1  ON 48
eH2_9                 4.505639e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8632
    reference variance = 0.165113
====================================================
  Execution time = 2.2881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3287e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332899649304
                                         uncertainty =       0.003383276017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332899649304
                                         uncertainty =       0.003383276017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407961536
  error estimate for blocks of size 2^( 2) =       0.000420311676
  error estimate for blocks of size 2^( 3) =       0.000433274803
  error estimate for blocks of size 2^( 4) =       0.000444914454
  error estimate for blocks of size 2^( 5) =       0.000456278498
  error estimate for blocks of size 2^( 6) =       0.000464310533
  error estimate for blocks of size 2^( 7) =       0.000469205745

      target function =                  N/A
              le_mean =     -16.910239717688
             les_mean =     286.289072372989
             stat err =       0.000458677307
             autocorr =       1.264084401497
              std dev =       0.576944737169
             le_variance =       0.332865229747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691023971769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910239717688       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910240180087       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910240832384       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910241078494       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910241191766       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910241289915       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910241198673       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910241255621       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910241253675       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 8.523935e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910239717688       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910239836291       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910240005566       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910240071877       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910240102034       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910240128477       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910240103282       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910240117541       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910240117302       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 2.183844e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910239717688       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910239747533       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910239790260       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910239807158       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910239814828       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910239821574       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910239815128       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910239818679       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910239818634       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 5.492246e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8949e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.072353e-01 1 1  ON 0
 uu_1                 1.420384e-01 1 1  ON 1
 uu_2                 4.346045e-02 1 1  ON 2
 uu_3                -1.778234e-02 1 1  ON 3
 uu_4                -6.305172e-02 1 1  ON 4
 uu_5                -9.719527e-02 1 1  ON 5
 uu_6                -1.245074e-01 1 1  ON 6
 uu_7                -1.379433e-01 1 1  ON 7
 uu_8                -1.331390e-01 1 1  ON 8
 uu_9                -1.047944e-01 1 1  ON 9
 ud_0                 4.360353e-01 1 1  ON 10
 ud_1                 1.779961e-01 1 1  ON 11
 ud_2                 6.375653e-02 1 1  ON 12
 ud_3                -5.046468e-03 1 1  ON 13
 ud_4                -6.095065e-02 1 1  ON 14
 ud_5                -1.025867e-01 1 1  ON 15
 ud_6                -1.303724e-01 1 1  ON 16
 ud_7                -1.481844e-01 1 1  ON 17
 ud_8                -1.518327e-01 1 1  ON 18
 ud_9                -1.447657e-01 1 1  ON 19
 eO_0                -7.497735e-01 1 1  ON 20
 eO_1                -4.360932e-01 1 1  ON 21
 eO_2                -2.593665e-02 1 1  ON 22
 eO_3                 2.944355e-01 1 1  ON 23
 eO_4                 5.212493e-01 1 1  ON 24
 eO_5                 4.825094e-01 1 1  ON 25
 eO_6                 2.579503e-01 1 1  ON 26
 eO_7                -4.107373e-02 1 1  ON 27
 eO_8                -2.210833e-01 1 1  ON 28
 eO_9                -8.123113e-02 1 1  ON 29
eH1_0                -2.400365e-01 1 1  ON 30
eH1_1                -1.370528e-01 1 1  ON 31
eH1_2                -9.209400e-02 1 1  ON 32
eH1_3                -4.109941e-02 1 1  ON 33
eH1_4                 7.306798e-03 1 1  ON 34
eH1_5                 3.845041e-02 1 1  ON 35
eH1_6                 9.640957e-02 1 1  ON 36
eH1_7                 1.492326e-01 1 1  ON 37
eH1_8                 1.686371e-01 1 1  ON 38
eH1_9                 5.475772e-02 1 1  ON 39
eH2_0                -2.387293e-01 1 1  ON 40
eH2_1                -1.357942e-01 1 1  ON 41
eH2_2                -9.092310e-02 1 1  ON 42
eH2_3                -3.966783e-02 1 1  ON 43
eH2_4                 8.360362e-03 1 1  ON 44
eH2_5                 3.987180e-02 1 1  ON 45
eH2_6                 9.827215e-02 1 1  ON 46
eH2_7                 1.497549e-01 1 1  ON 47
eH2_8                 1.801376e-01 1 1  ON 48
eH2_9                 4.506704e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9599
    reference variance = 0.220701
====================================================
  Execution time = 2.2612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4443e-01
  Total weights = 2.0000e+06
  Execution time = 2.4689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344438583189
                                         uncertainty =       0.010533061249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344438583189
                                         uncertainty =       0.010533061249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414977445
  error estimate for blocks of size 2^( 2) =       0.000426512491
  error estimate for blocks of size 2^( 3) =       0.000438180076
  error estimate for blocks of size 2^( 4) =       0.000448424258
  error estimate for blocks of size 2^( 5) =       0.000457559632
  error estimate for blocks of size 2^( 6) =       0.000465746649
  error estimate for blocks of size 2^( 7) =       0.000469929842

      target function =                  N/A
              le_mean =     -16.910466898086
             les_mean =     286.308303098827
             stat err =       0.000460415095
             autocorr =       1.230977523122
              std dev =       0.586866730847
             le_variance =       0.344412559775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344491406703
                                         uncertainty =       0.010533286451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344491406703
                                         uncertainty =       0.010533286451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415009254
  error estimate for blocks of size 2^( 2) =       0.000426540426
  error estimate for blocks of size 2^( 3) =       0.000438204097
  error estimate for blocks of size 2^( 4) =       0.000448445220
  error estimate for blocks of size 2^( 5) =       0.000457577842
  error estimate for blocks of size 2^( 6) =       0.000465764384
  error estimate for blocks of size 2^( 7) =       0.000469944181

      target function =                  N/A
              le_mean =     -16.910466591673
             les_mean =     286.308345537214
             stat err =       0.000460432907
             autocorr =       1.230884062740
              std dev =       0.586911715132
             le_variance =       0.344465361359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344465664985
                                         uncertainty =       0.010533185564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344465664985
                                         uncertainty =       0.010533185564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414993753
  error estimate for blocks of size 2^( 2) =       0.000426526784
  error estimate for blocks of size 2^( 3) =       0.000438192349
  error estimate for blocks of size 2^( 4) =       0.000448434950
  error estimate for blocks of size 2^( 5) =       0.000457568883
  error estimate for blocks of size 2^( 6) =       0.000465755649
  error estimate for blocks of size 2^( 7) =       0.000469937044

      target function =                  N/A
              le_mean =     -16.910466717501
             les_mean =     286.308324061651
             stat err =       0.000460424132
             autocorr =       1.230929093851
              std dev =       0.586889793876
             le_variance =       0.344439630156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344441982515
                                         uncertainty =       0.010533077159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344441982515
                                         uncertainty =       0.010533077159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414979492
  error estimate for blocks of size 2^( 2) =       0.000426514283
  error estimate for blocks of size 2^( 3) =       0.000438181613
  error estimate for blocks of size 2^( 4) =       0.000448425595
  error estimate for blocks of size 2^( 5) =       0.000457560786
  error estimate for blocks of size 2^( 6) =       0.000465747772
  error estimate for blocks of size 2^( 7) =       0.000469930737

      target function =                  N/A
              le_mean =     -16.910466873244
             les_mean =     286.308305656538
             stat err =       0.000460416223
             autocorr =       1.230971406869
              std dev =       0.586869625776
             le_variance =       0.344415957658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910466898086        initial  <--
     5.9605e+00     5.9605e+01             8.5239e-05       -16.910466591673
     2.3842e+01     2.3842e+02             2.1838e-05       -16.910466717501
     9.5367e+01     9.5367e+02             5.4922e-06       -16.910466873244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.1687
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.072412e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778302e-02 1 1  ON 3
 uu_4                -6.304914e-02 1 1  ON 4
 uu_5                -9.718929e-02 1 1  ON 5
 uu_6                -1.245020e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360135e-01 1 1  ON 10
 ud_1                 1.779835e-01 1 1  ON 11
 ud_2                 6.377029e-02 1 1  ON 12
 ud_3                -5.031051e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025858e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944288e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107654e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122645e-02 1 1  ON 29
eH1_0                -2.400167e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210023e-02 1 1  ON 32
eH1_3                -4.109809e-02 1 1  ON 33
eH1_4                 7.311902e-03 1 1  ON 34
eH1_5                 3.845028e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686297e-01 1 1  ON 38
eH1_9                 5.474756e-02 1 1  ON 39
eH2_0                -2.387104e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093173e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360466e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827035e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801324e-01 1 1  ON 48
eH2_9                 4.505639e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8809
    reference variance = 0.347703
====================================================
  Execution time = 2.3075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3177e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331858259156
                                         uncertainty =       0.004005811407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331858259156
                                         uncertainty =       0.004005811407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407289234
  error estimate for blocks of size 2^( 2) =       0.000419295353
  error estimate for blocks of size 2^( 3) =       0.000431391400
  error estimate for blocks of size 2^( 4) =       0.000442918273
  error estimate for blocks of size 2^( 5) =       0.000452239363
  error estimate for blocks of size 2^( 6) =       0.000459390253
  error estimate for blocks of size 2^( 7) =       0.000463133533

      target function =                  N/A
              le_mean =     -16.909639872048
             les_mean =     286.267689477533
             stat err =       0.000454420356
             autocorr =       1.244828987389
              std dev =       0.575993959221
             le_variance =       0.331769041059


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690963987205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909639872048       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909639967880       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909640013930       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909640005939       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909640007750       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909640019253       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909640020190       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909640025880       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909640025651       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 9.552884e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909639872048       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909639896067       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909639907647       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909639905654       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909639906093       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909639908976       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909639909195       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909639910626       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909639910575       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 2.394080e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909639872048       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909639878057       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909639880956       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909639880458       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909639880567       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909639881288       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909639881342       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909639881700       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909639881686       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 5.988856e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9191e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.072410e-01 1 1  ON 0
 uu_1                 1.420441e-01 1 1  ON 1
 uu_2                 4.345542e-02 1 1  ON 2
 uu_3                -1.778222e-02 1 1  ON 3
 uu_4                -6.304978e-02 1 1  ON 4
 uu_5                -9.718993e-02 1 1  ON 5
 uu_6                -1.245025e-01 1 1  ON 6
 uu_7                -1.379404e-01 1 1  ON 7
 uu_8                -1.331479e-01 1 1  ON 8
 uu_9                -1.047978e-01 1 1  ON 9
 ud_0                 4.360159e-01 1 1  ON 10
 ud_1                 1.779848e-01 1 1  ON 11
 ud_2                 6.376901e-02 1 1  ON 12
 ud_3                -5.033027e-03 1 1  ON 13
 ud_4                -6.094534e-02 1 1  ON 14
 ud_5                -1.025862e-01 1 1  ON 15
 ud_6                -1.303659e-01 1 1  ON 16
 ud_7                -1.481797e-01 1 1  ON 17
 ud_8                -1.518375e-01 1 1  ON 18
 ud_9                -1.447704e-01 1 1  ON 19
 eO_0                -7.497604e-01 1 1  ON 20
 eO_1                -4.360965e-01 1 1  ON 21
 eO_2                -2.593346e-02 1 1  ON 22
 eO_3                 2.944299e-01 1 1  ON 23
 eO_4                 5.212466e-01 1 1  ON 24
 eO_5                 4.825041e-01 1 1  ON 25
 eO_6                 2.579471e-01 1 1  ON 26
 eO_7                -4.107656e-02 1 1  ON 27
 eO_8                -2.210817e-01 1 1  ON 28
 eO_9                -8.122695e-02 1 1  ON 29
eH1_0                -2.400187e-01 1 1  ON 30
eH1_1                -1.370447e-01 1 1  ON 31
eH1_2                -9.209996e-02 1 1  ON 32
eH1_3                -4.109793e-02 1 1  ON 33
eH1_4                 7.311834e-03 1 1  ON 34
eH1_5                 3.845068e-02 1 1  ON 35
eH1_6                 9.640386e-02 1 1  ON 36
eH1_7                 1.492296e-01 1 1  ON 37
eH1_8                 1.686305e-01 1 1  ON 38
eH1_9                 5.474833e-02 1 1  ON 39
eH2_0                -2.387118e-01 1 1  ON 40
eH2_1                -1.357879e-01 1 1  ON 41
eH2_2                -9.093094e-02 1 1  ON 42
eH2_3                -3.966592e-02 1 1  ON 43
eH2_4                 8.360488e-03 1 1  ON 44
eH2_5                 3.987485e-02 1 1  ON 45
eH2_6                 9.827003e-02 1 1  ON 46
eH2_7                 1.497512e-01 1 1  ON 47
eH2_8                 1.801329e-01 1 1  ON 48
eH2_9                 4.505750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8947
    reference variance = 0.28896
====================================================
  Execution time = 2.2319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5023e-01
  Total weights = 2.0000e+06
  Execution time = 2.4656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350200599294
                                         uncertainty =       0.012771546826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350200599294
                                         uncertainty =       0.012771546826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418466389
  error estimate for blocks of size 2^( 2) =       0.000430235904
  error estimate for blocks of size 2^( 3) =       0.000443029516
  error estimate for blocks of size 2^( 4) =       0.000455682403
  error estimate for blocks of size 2^( 5) =       0.000467737054
  error estimate for blocks of size 2^( 6) =       0.000476441768
  error estimate for blocks of size 2^( 7) =       0.000483811941

      target function =                  N/A
              le_mean =     -16.909843477151
             les_mean =     286.293034483323
             stat err =       0.000470918291
             autocorr =       1.266397245719
              std dev =       0.591800842085
             le_variance =       0.350228236692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350207744666
                                         uncertainty =       0.012771526508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350207744666
                                         uncertainty =       0.012771526508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418470659
  error estimate for blocks of size 2^( 2) =       0.000430239716
  error estimate for blocks of size 2^( 3) =       0.000443032809
  error estimate for blocks of size 2^( 4) =       0.000455685364
  error estimate for blocks of size 2^( 5) =       0.000467739894
  error estimate for blocks of size 2^( 6) =       0.000476444239
  error estimate for blocks of size 2^( 7) =       0.000483814394

      target function =                  N/A
              le_mean =     -16.909843345981
             les_mean =     286.293037194981
             stat err =       0.000470920973
             autocorr =       1.266385820752
              std dev =       0.591806881057
             le_variance =       0.350235384466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350204181480
                                         uncertainty =       0.012771536224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350204181480
                                         uncertainty =       0.012771536224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418468529
  error estimate for blocks of size 2^( 2) =       0.000430237815
  error estimate for blocks of size 2^( 3) =       0.000443031166
  error estimate for blocks of size 2^( 4) =       0.000455683887
  error estimate for blocks of size 2^( 5) =       0.000467738477
  error estimate for blocks of size 2^( 6) =       0.000476443005
  error estimate for blocks of size 2^( 7) =       0.000483813170

      target function =                  N/A
              le_mean =     -16.909843411159
             les_mean =     286.293035834866
             stat err =       0.000470919635
             autocorr =       1.266391512699
              std dev =       0.591803869606
             le_variance =       0.350231820080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350201047300
                                         uncertainty =       0.012771545487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350201047300
                                         uncertainty =       0.012771545487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418466656
  error estimate for blocks of size 2^( 2) =       0.000430236143
  error estimate for blocks of size 2^( 3) =       0.000443029722
  error estimate for blocks of size 2^( 4) =       0.000455682588
  error estimate for blocks of size 2^( 5) =       0.000467737232
  error estimate for blocks of size 2^( 6) =       0.000476441923
  error estimate for blocks of size 2^( 7) =       0.000483812094

      target function =                  N/A
              le_mean =     -16.909843468875
             les_mean =     286.293034651592
             stat err =       0.000470918459
             autocorr =       1.266396528371
              std dev =       0.591801220722
             le_variance =       0.350228684848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909843477151        initial  <--
     5.9605e+01     5.9605e+02             9.5529e-06       -16.909843345981
     2.3842e+02     2.3842e+03             2.3941e-06       -16.909843411159
     9.5367e+02     9.5367e+03             5.9889e-07       -16.909843468875

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.8349
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.072412e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778302e-02 1 1  ON 3
 uu_4                -6.304914e-02 1 1  ON 4
 uu_5                -9.718929e-02 1 1  ON 5
 uu_6                -1.245020e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360135e-01 1 1  ON 10
 ud_1                 1.779835e-01 1 1  ON 11
 ud_2                 6.377029e-02 1 1  ON 12
 ud_3                -5.031051e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025858e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944288e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107654e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122645e-02 1 1  ON 29
eH1_0                -2.400167e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210023e-02 1 1  ON 32
eH1_3                -4.109809e-02 1 1  ON 33
eH1_4                 7.311902e-03 1 1  ON 34
eH1_5                 3.845028e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686297e-01 1 1  ON 38
eH1_9                 5.474756e-02 1 1  ON 39
eH2_0                -2.387104e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093173e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360466e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827035e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801324e-01 1 1  ON 48
eH2_9                 4.505639e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9169
    reference variance = 0.382767
====================================================
  Execution time = 2.2847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330963508822
                                         uncertainty =       0.004015389132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330963508822
                                         uncertainty =       0.004015389132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406855251
  error estimate for blocks of size 2^( 2) =       0.000418390831
  error estimate for blocks of size 2^( 3) =       0.000430581334
  error estimate for blocks of size 2^( 4) =       0.000442257679
  error estimate for blocks of size 2^( 5) =       0.000451962276
  error estimate for blocks of size 2^( 6) =       0.000458981444
  error estimate for blocks of size 2^( 7) =       0.000461917009

      target function =                  N/A
              le_mean =     -16.910219550440
             les_mean =     286.286587468392
             stat err =       0.000453779602
             autocorr =       1.243970522973
              std dev =       0.575380213300
             le_variance =       0.331062389857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691021955044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910219550440       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910219566855       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910219572287       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910219573119       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910219573399       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910219573050       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910219573124       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910219572801       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910219572891       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 1.162989e-06

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910219550440       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910219554544       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910219555903       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910219556110       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910219556181       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910219556097       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910219556112       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910219556036       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910219556057       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 2.908180e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910219550440       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910219551466       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910219551806       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910219551858       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910219551871       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910219551851       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910219551860       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910219551820       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910219551839       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 7.270891e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8954e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345528e-02 1 1  ON 2
 uu_3                -1.778295e-02 1 1  ON 3
 uu_4                -6.304918e-02 1 1  ON 4
 uu_5                -9.718937e-02 1 1  ON 5
 uu_6                -1.245020e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360138e-01 1 1  ON 10
 ud_1                 1.779837e-01 1 1  ON 11
 ud_2                 6.377022e-02 1 1  ON 12
 ud_3                -5.031217e-03 1 1  ON 13
 ud_4                -6.094498e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497589e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593331e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107655e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122651e-02 1 1  ON 29
eH1_0                -2.400169e-01 1 1  ON 30
eH1_1                -1.370435e-01 1 1  ON 31
eH1_2                -9.210014e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311915e-03 1 1  ON 34
eH1_5                 3.845028e-02 1 1  ON 35
eH1_6                 9.640337e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387106e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093167e-02 1 1  ON 42
eH2_3                -3.966626e-02 1 1  ON 43
eH2_4                 8.360510e-03 1 1  ON 44
eH2_5                 3.987544e-02 1 1  ON 45
eH2_6                 9.827037e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505649e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.277457
====================================================
  Execution time = 2.2667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3747e-01
  Total weights = 2.0000e+06
  Execution time = 2.4692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579674696
                                         uncertainty =       0.005544691044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579674696
                                         uncertainty =       0.005544691044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410770863
  error estimate for blocks of size 2^( 2) =       0.000422773219
  error estimate for blocks of size 2^( 3) =       0.000435714383
  error estimate for blocks of size 2^( 4) =       0.000447651193
  error estimate for blocks of size 2^( 5) =       0.000457818477
  error estimate for blocks of size 2^( 6) =       0.000467434155
  error estimate for blocks of size 2^( 7) =       0.000472683249

      target function =                  N/A
              le_mean =     -16.909383279061
             les_mean =     286.264708112786
             stat err =       0.000461396769
             autocorr =       1.261681795809
              std dev =       0.580917725099
             le_variance =       0.337465403334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337580255758
                                         uncertainty =       0.005544686631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337580255758
                                         uncertainty =       0.005544686631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410771216
  error estimate for blocks of size 2^( 2) =       0.000422773525
  error estimate for blocks of size 2^( 3) =       0.000435714640
  error estimate for blocks of size 2^( 4) =       0.000447651420
  error estimate for blocks of size 2^( 5) =       0.000457818688
  error estimate for blocks of size 2^( 6) =       0.000467434336
  error estimate for blocks of size 2^( 7) =       0.000472683453

      target function =                  N/A
              le_mean =     -16.909383272727
             les_mean =     286.264708479724
             stat err =       0.000461396974
             autocorr =       1.261680747889
              std dev =       0.580918225300
             le_variance =       0.337465984485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579965296
                                         uncertainty =       0.005544688836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579965296
                                         uncertainty =       0.005544688836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410771040
  error estimate for blocks of size 2^( 2) =       0.000422773372
  error estimate for blocks of size 2^( 3) =       0.000435714512
  error estimate for blocks of size 2^( 4) =       0.000447651307
  error estimate for blocks of size 2^( 5) =       0.000457818582
  error estimate for blocks of size 2^( 6) =       0.000467434246
  error estimate for blocks of size 2^( 7) =       0.000472683351

      target function =                  N/A
              le_mean =     -16.909383275891
             les_mean =     286.264708296222
             stat err =       0.000461396871
             autocorr =       1.261681271675
              std dev =       0.580917975259
             le_variance =       0.337465693979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579711022
                                         uncertainty =       0.005544690768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337579711022
                                         uncertainty =       0.005544690768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410770885
  error estimate for blocks of size 2^( 2) =       0.000422773239
  error estimate for blocks of size 2^( 3) =       0.000435714400
  error estimate for blocks of size 2^( 4) =       0.000447651208
  error estimate for blocks of size 2^( 5) =       0.000457818490
  error estimate for blocks of size 2^( 6) =       0.000467434167
  error estimate for blocks of size 2^( 7) =       0.000472683262

      target function =                  N/A
              le_mean =     -16.909383278664
             les_mean =     286.264708135709
             stat err =       0.000461396781
             autocorr =       1.261681730288
              std dev =       0.580917756370
             le_variance =       0.337465439666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909383279061        initial  <--
     5.9605e+02     5.9605e+03             1.1630e-06       -16.909383272727
     2.3842e+03     2.3842e+04             2.9082e-07       -16.909383275891
     9.5367e+03     9.5367e+04             7.2709e-08       -16.909383278664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.2753
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.072412e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778302e-02 1 1  ON 3
 uu_4                -6.304914e-02 1 1  ON 4
 uu_5                -9.718929e-02 1 1  ON 5
 uu_6                -1.245020e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360135e-01 1 1  ON 10
 ud_1                 1.779835e-01 1 1  ON 11
 ud_2                 6.377029e-02 1 1  ON 12
 ud_3                -5.031051e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025858e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944288e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107654e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122645e-02 1 1  ON 29
eH1_0                -2.400167e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210023e-02 1 1  ON 32
eH1_3                -4.109809e-02 1 1  ON 33
eH1_4                 7.311902e-03 1 1  ON 34
eH1_5                 3.845028e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686297e-01 1 1  ON 38
eH1_9                 5.474756e-02 1 1  ON 39
eH2_0                -2.387104e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093173e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360466e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827035e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801324e-01 1 1  ON 48
eH2_9                 4.505639e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4236e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8482
    reference variance = 0.354344
====================================================
  Execution time = 2.3041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2760e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327491915276
                                         uncertainty =       0.005056030277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327491915276
                                         uncertainty =       0.005056030277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404723778
  error estimate for blocks of size 2^( 2) =       0.000416148476
  error estimate for blocks of size 2^( 3) =       0.000428594471
  error estimate for blocks of size 2^( 4) =       0.000440406831
  error estimate for blocks of size 2^( 5) =       0.000449877030
  error estimate for blocks of size 2^( 6) =       0.000456903220
  error estimate for blocks of size 2^( 7) =       0.000461010507

      target function =                  N/A
              le_mean =     -16.909580063852
             les_mean =     286.261500445331
             stat err =       0.000452049397
             autocorr =       1.247539619275
              std dev =       0.572365856181
             le_variance =       0.327602673322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690958006385e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909580063852       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909580065803       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909580065918       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909580066035       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909580066093       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909580066006       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909580065979       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909580066006       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909580066017       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 1.132383e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909580063852       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909580064340       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909580064368       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909580064397       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909580064412       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909580064390       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909580064384       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909580064382       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909580064405       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.831024e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909580063852       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909580063974       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909580063981       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909580063988       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909580063992       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909580063986       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909580064016       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909580064139       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909580064033       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 7.077604e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9115e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.072412e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778301e-02 1 1  ON 3
 uu_4                -6.304914e-02 1 1  ON 4
 uu_5                -9.718930e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360135e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377027e-02 1 1  ON 12
 ud_3                -5.031072e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025858e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944288e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107654e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122646e-02 1 1  ON 29
eH1_0                -2.400167e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210023e-02 1 1  ON 32
eH1_3                -4.109809e-02 1 1  ON 33
eH1_4                 7.311896e-03 1 1  ON 34
eH1_5                 3.845028e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686297e-01 1 1  ON 38
eH1_9                 5.474758e-02 1 1  ON 39
eH2_0                -2.387104e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093173e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360465e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827036e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801324e-01 1 1  ON 48
eH2_9                 4.505640e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8483
    reference variance = 0.215347
====================================================
  Execution time = 2.2331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3772e-01
  Total weights = 2.0000e+06
  Execution time = 2.4709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777552664
                                         uncertainty =       0.004292157255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777552664
                                         uncertainty =       0.004292157255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922856
  error estimate for blocks of size 2^( 2) =       0.000422839568
  error estimate for blocks of size 2^( 3) =       0.000435062227
  error estimate for blocks of size 2^( 4) =       0.000447533149
  error estimate for blocks of size 2^( 5) =       0.000458767233
  error estimate for blocks of size 2^( 6) =       0.000468297713
  error estimate for blocks of size 2^( 7) =       0.000473518677

      target function =                  N/A
              le_mean =     -16.909939824786
             les_mean =     286.283779896663
             stat err =       0.000462029193
             autocorr =       1.264207136876
              std dev =       0.581132676452
             le_variance =       0.337715187641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777639126
                                         uncertainty =       0.004292158537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777639126
                                         uncertainty =       0.004292158537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922909
  error estimate for blocks of size 2^( 2) =       0.000422839615
  error estimate for blocks of size 2^( 3) =       0.000435062267
  error estimate for blocks of size 2^( 4) =       0.000447533186
  error estimate for blocks of size 2^( 5) =       0.000458767268
  error estimate for blocks of size 2^( 6) =       0.000468297747
  error estimate for blocks of size 2^( 7) =       0.000473518712

      target function =                  N/A
              le_mean =     -16.909939826444
             les_mean =     286.283780039192
             stat err =       0.000462029228
             autocorr =       1.264207006185
              std dev =       0.581132750835
             le_variance =       0.337715274093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777595897
                                         uncertainty =       0.004292157896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777595897
                                         uncertainty =       0.004292157896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922883
  error estimate for blocks of size 2^( 2) =       0.000422839591
  error estimate for blocks of size 2^( 3) =       0.000435062247
  error estimate for blocks of size 2^( 4) =       0.000447533168
  error estimate for blocks of size 2^( 5) =       0.000458767251
  error estimate for blocks of size 2^( 6) =       0.000468297730
  error estimate for blocks of size 2^( 7) =       0.000473518694

      target function =                  N/A
              le_mean =     -16.909939825615
             les_mean =     286.283779967929
             stat err =       0.000462029211
             autocorr =       1.264207071519
              std dev =       0.581132713645
             le_variance =       0.337715230868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777558068
                                         uncertainty =       0.004292157335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337777558068
                                         uncertainty =       0.004292157335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410922860
  error estimate for blocks of size 2^( 2) =       0.000422839571
  error estimate for blocks of size 2^( 3) =       0.000435062229
  error estimate for blocks of size 2^( 4) =       0.000447533152
  error estimate for blocks of size 2^( 5) =       0.000458767235
  error estimate for blocks of size 2^( 6) =       0.000468297715
  error estimate for blocks of size 2^( 7) =       0.000473518679

      target function =                  N/A
              le_mean =     -16.909939824890
             les_mean =     286.283779905571
             stat err =       0.000462029195
             autocorr =       1.264207128708
              std dev =       0.581132681101
             le_variance =       0.337715193044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909939824786        initial
     5.9605e+03     5.9605e+04             1.1324e-07       -16.909939826444  <--
     2.3842e+04     2.3842e+05             2.8310e-08       -16.909939825615
     9.5367e+04     9.5367e+05             7.0776e-09       -16.909939824890

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 3.4872e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3993e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.433205
====================================================
  Execution time = 2.5206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2799e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328022891412
                                         uncertainty =       0.003272214043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328022891412
                                         uncertainty =       0.003272214043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404964462
  error estimate for blocks of size 2^( 2) =       0.000416882426
  error estimate for blocks of size 2^( 3) =       0.000429595007
  error estimate for blocks of size 2^( 4) =       0.000441670810
  error estimate for blocks of size 2^( 5) =       0.000452420379
  error estimate for blocks of size 2^( 6) =       0.000461837506
  error estimate for blocks of size 2^( 7) =       0.000467702235

      target function =                  N/A
              le_mean =     -16.909906422408
             les_mean =     286.272927480799
             stat err =       0.000455907733
             autocorr =       1.267418644733
              std dev =       0.572706233781
             le_variance =       0.327992430212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690990642241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909906422408       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909906426559       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909906426844       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909906427689       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909906427567       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909906427060       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909906427419       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909906427494       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909906427485       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 4.115559e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909906422408       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909906423446       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909906423517       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909906423727       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909906423698       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909906423565       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909906423660       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909906423674       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909906423655       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 1.028980e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909906422408       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909906422667       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909906422685       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909906422744       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909906422734       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909906422694       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909906422706       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909906422722       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909906422739       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.572507e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1306e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345521e-02 1 1  ON 2
 uu_3                -1.778297e-02 1 1  ON 3
 uu_4                -6.304918e-02 1 1  ON 4
 uu_5                -9.718935e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360137e-01 1 1  ON 10
 ud_1                 1.779837e-01 1 1  ON 11
 ud_2                 6.377019e-02 1 1  ON 12
 ud_3                -5.031207e-03 1 1  ON 13
 ud_4                -6.094502e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447709e-01 1 1  ON 19
 eO_0                -7.497589e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593329e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107652e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122649e-02 1 1  ON 29
eH1_0                -2.400169e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210019e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311870e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640334e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474764e-02 1 1  ON 39
eH2_0                -2.387106e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093166e-02 1 1  ON 42
eH2_3                -3.966625e-02 1 1  ON 43
eH2_4                 8.360461e-03 1 1  ON 44
eH2_5                 3.987543e-02 1 1  ON 45
eH2_6                 9.827039e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505648e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.241533
====================================================
  Execution time = 2.2442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3046e-01
  Total weights = 2.0000e+06
  Execution time = 2.4622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330482945930
                                         uncertainty =       0.003098611058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330482945930
                                         uncertainty =       0.003098611058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406484081
  error estimate for blocks of size 2^( 2) =       0.000419145651
  error estimate for blocks of size 2^( 3) =       0.000431810601
  error estimate for blocks of size 2^( 4) =       0.000444703602
  error estimate for blocks of size 2^( 5) =       0.000457264585
  error estimate for blocks of size 2^( 6) =       0.000467203194
  error estimate for blocks of size 2^( 7) =       0.000475336602

      target function =                  N/A
              le_mean =     -16.909268793400
             les_mean =     286.253829578784
             stat err =       0.000461126996
             autocorr =       1.286927292945
              std dev =       0.574855300547
             le_variance =       0.330458616567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483218141
                                         uncertainty =       0.003098614875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483218141
                                         uncertainty =       0.003098614875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406484249
  error estimate for blocks of size 2^( 2) =       0.000419145800
  error estimate for blocks of size 2^( 3) =       0.000431810731
  error estimate for blocks of size 2^( 4) =       0.000444703720
  error estimate for blocks of size 2^( 5) =       0.000457264694
  error estimate for blocks of size 2^( 6) =       0.000467203300
  error estimate for blocks of size 2^( 7) =       0.000475336721

      target function =                  N/A
              le_mean =     -16.909268792416
             les_mean =     286.253829817537
             stat err =       0.000461127109
             autocorr =       1.286926861941
              std dev =       0.574855537155
             le_variance =       0.330458888598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483082049
                                         uncertainty =       0.003098612967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483082049
                                         uncertainty =       0.003098612967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406484165
  error estimate for blocks of size 2^( 2) =       0.000419145726
  error estimate for blocks of size 2^( 3) =       0.000431810666
  error estimate for blocks of size 2^( 4) =       0.000444703661
  error estimate for blocks of size 2^( 5) =       0.000457264639
  error estimate for blocks of size 2^( 6) =       0.000467203247
  error estimate for blocks of size 2^( 7) =       0.000475336661

      target function =                  N/A
              le_mean =     -16.909268792907
             les_mean =     286.253829698158
             stat err =       0.000461127052
             autocorr =       1.286927077415
              std dev =       0.574855418863
             le_variance =       0.330458752596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330482962946
                                         uncertainty =       0.003098611296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330482962946
                                         uncertainty =       0.003098611296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406484092
  error estimate for blocks of size 2^( 2) =       0.000419145661
  error estimate for blocks of size 2^( 3) =       0.000431810610
  error estimate for blocks of size 2^( 4) =       0.000444703609
  error estimate for blocks of size 2^( 5) =       0.000457264592
  error estimate for blocks of size 2^( 6) =       0.000467203201
  error estimate for blocks of size 2^( 7) =       0.000475336610

      target function =                  N/A
              le_mean =     -16.909268793338
             les_mean =     286.253829593705
             stat err =       0.000461127003
             autocorr =       1.286927266006
              std dev =       0.574855315337
             le_variance =       0.330458633571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909268793400        initial  <--
     1.4901e+03     1.4901e+04             4.1156e-07       -16.909268792416
     5.9605e+03     5.9605e+04             1.0290e-07       -16.909268792907
     2.3842e+04     2.3842e+05             2.5725e-08       -16.909268793338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9664
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8895
    reference variance = 0.250869
====================================================
  Execution time = 2.2915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2954e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329680629983
                                         uncertainty =       0.003260604733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329680629983
                                         uncertainty =       0.003260604733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405917619
  error estimate for blocks of size 2^( 2) =       0.000417857238
  error estimate for blocks of size 2^( 3) =       0.000430372361
  error estimate for blocks of size 2^( 4) =       0.000442296496
  error estimate for blocks of size 2^( 5) =       0.000451643273
  error estimate for blocks of size 2^( 6) =       0.000458106846
  error estimate for blocks of size 2^( 7) =       0.000464725470

      target function =                  N/A
              le_mean =     -16.909860845340
             les_mean =     286.272931870983
             stat err =       0.000454193021
             autocorr =       1.252002248151
              std dev =       0.574054202129
             le_variance =       0.329538226982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690986084534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909860845340       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909860845957       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909860846240       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909860846264       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909860846296       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909860846339       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909860846311       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909860846369       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 3.203228e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909860845340       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909860845494       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909860845565       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909860845571       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909860845573       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909860845559       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909860845595       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909860845531       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 8.008072e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909860845340       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909860845379       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909860845396       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909860845398       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909860845400       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909860845462       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909860845302       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909860845551       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 2.002018e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9040e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304917e-02 1 1  ON 4
 uu_5                -9.718933e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031141e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210021e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311879e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360464e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505644e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8464
    reference variance = 0.216838
====================================================
  Execution time = 2.2682e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.6022e-01
  Total weights = 2.0000e+06
  Execution time = 2.4569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339045391
                                         uncertainty =       0.021508260729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339045391
                                         uncertainty =       0.021508260729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424391342
  error estimate for blocks of size 2^( 2) =       0.000435771568
  error estimate for blocks of size 2^( 3) =       0.000448137983
  error estimate for blocks of size 2^( 4) =       0.000460257073
  error estimate for blocks of size 2^( 5) =       0.000470562256
  error estimate for blocks of size 2^( 6) =       0.000478170014
  error estimate for blocks of size 2^( 7) =       0.000482141014

      target function =                  N/A
              le_mean =     -16.910564066341
             les_mean =     286.327392884044
             stat err =       0.000472782589
             autocorr =       1.241051829135
              std dev =       0.600179991599
             le_variance =       0.360216022316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339063482
                                         uncertainty =       0.021508262132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339063482
                                         uncertainty =       0.021508262132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424391353
  error estimate for blocks of size 2^( 2) =       0.000435771577
  error estimate for blocks of size 2^( 3) =       0.000448137990
  error estimate for blocks of size 2^( 4) =       0.000460257079
  error estimate for blocks of size 2^( 5) =       0.000470562262
  error estimate for blocks of size 2^( 6) =       0.000478170020
  error estimate for blocks of size 2^( 7) =       0.000482141019

      target function =                  N/A
              le_mean =     -16.910564066256
             les_mean =     286.327392899204
             stat err =       0.000472782595
             autocorr =       1.241051796660
              std dev =       0.600180006640
             le_variance =       0.360216040370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339054437
                                         uncertainty =       0.021508261430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339054437
                                         uncertainty =       0.021508261430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424391347
  error estimate for blocks of size 2^( 2) =       0.000435771572
  error estimate for blocks of size 2^( 3) =       0.000448137987
  error estimate for blocks of size 2^( 4) =       0.000460257076
  error estimate for blocks of size 2^( 5) =       0.000470562259
  error estimate for blocks of size 2^( 6) =       0.000478170017
  error estimate for blocks of size 2^( 7) =       0.000482141016

      target function =                  N/A
              le_mean =     -16.910564066299
             les_mean =     286.327392891624
             stat err =       0.000472782592
             autocorr =       1.241051812898
              std dev =       0.600179999119
             le_variance =       0.360216031343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339046522
                                         uncertainty =       0.021508260816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360339046522
                                         uncertainty =       0.021508260816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424391343
  error estimate for blocks of size 2^( 2) =       0.000435771568
  error estimate for blocks of size 2^( 3) =       0.000448137983
  error estimate for blocks of size 2^( 4) =       0.000460257074
  error estimate for blocks of size 2^( 5) =       0.000470562256
  error estimate for blocks of size 2^( 6) =       0.000478170015
  error estimate for blocks of size 2^( 7) =       0.000482141014

      target function =                  N/A
              le_mean =     -16.910564066336
             les_mean =     286.327392884991
             stat err =       0.000472782590
             autocorr =       1.241051827102
              std dev =       0.600179992539
             le_variance =       0.360216023444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910564066341        initial  <--
     1.4901e+04     1.4901e+05             3.2032e-08       -16.910564066256
     5.9605e+04     5.9605e+05             8.0081e-09       -16.910564066299
     2.3842e+05     2.3842e+06             2.0020e-09       -16.910564066336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.1546
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9506
    reference variance = 0.231227
====================================================
  Execution time = 2.3474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328170845385
                                         uncertainty =       0.004152453950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328170845385
                                         uncertainty =       0.004152453950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405071505
  error estimate for blocks of size 2^( 2) =       0.000417204538
  error estimate for blocks of size 2^( 3) =       0.000429943786
  error estimate for blocks of size 2^( 4) =       0.000442671547
  error estimate for blocks of size 2^( 5) =       0.000454528499
  error estimate for blocks of size 2^( 6) =       0.000461727612
  error estimate for blocks of size 2^( 7) =       0.000464870928

      target function =                  N/A
              le_mean =     -16.910137442706
             les_mean =     286.280914015331
             stat err =       0.000455949647
             autocorr =       1.266981810107
              std dev =       0.572857615991
             le_variance =       0.328165848199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691013744271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910137442706       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910137442748       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910137442761       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910137442876       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910137442736       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910137442738       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910137442958       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910137442938       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 3.454392e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910137442706       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910137442717       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910137442720       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910137442720       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910137442457       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910137443025       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910137442950       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910137442155       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 8.635987e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910137442706       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910137442709       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910137442710       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910137441602       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910137442518       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910137442710       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910137442662       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910137442687       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.158995e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9571e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8554
    reference variance = 0.400033
====================================================
  Execution time = 2.2561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2660e-01
  Total weights = 2.0000e+06
  Execution time = 2.4721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659548606
                                         uncertainty =       0.003068297121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659548606
                                         uncertainty =       0.003068297121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404103724
  error estimate for blocks of size 2^( 2) =       0.000415864589
  error estimate for blocks of size 2^( 3) =       0.000428496647
  error estimate for blocks of size 2^( 4) =       0.000440126426
  error estimate for blocks of size 2^( 5) =       0.000450907787
  error estimate for blocks of size 2^( 6) =       0.000456967013
  error estimate for blocks of size 2^( 7) =       0.000461308972

      target function =                  N/A
              le_mean =     -16.909736878505
             les_mean =     286.265800776275
             stat err =       0.000452327549
             autocorr =       1.252911438647
              std dev =       0.571488966908
             le_variance =       0.326599639298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659550793
                                         uncertainty =       0.003068297141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659550793
                                         uncertainty =       0.003068297141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404103725
  error estimate for blocks of size 2^( 2) =       0.000415864590
  error estimate for blocks of size 2^( 3) =       0.000428496648
  error estimate for blocks of size 2^( 4) =       0.000440126426
  error estimate for blocks of size 2^( 5) =       0.000450907788
  error estimate for blocks of size 2^( 6) =       0.000456967014
  error estimate for blocks of size 2^( 7) =       0.000461308972

      target function =                  N/A
              le_mean =     -16.909736878488
             les_mean =     286.265800777871
             stat err =       0.000452327550
             autocorr =       1.252911434478
              std dev =       0.571488968821
             le_variance =       0.326599641484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659549700
                                         uncertainty =       0.003068297131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659549700
                                         uncertainty =       0.003068297131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404103725
  error estimate for blocks of size 2^( 2) =       0.000415864590
  error estimate for blocks of size 2^( 3) =       0.000428496648
  error estimate for blocks of size 2^( 4) =       0.000440126426
  error estimate for blocks of size 2^( 5) =       0.000450907788
  error estimate for blocks of size 2^( 6) =       0.000456967014
  error estimate for blocks of size 2^( 7) =       0.000461308972

      target function =                  N/A
              le_mean =     -16.909736878496
             les_mean =     286.265800777073
             stat err =       0.000452327550
             autocorr =       1.252911436566
              std dev =       0.571488967865
             le_variance =       0.326599640391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659548743
                                         uncertainty =       0.003068297122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326659548743
                                         uncertainty =       0.003068297122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404103724
  error estimate for blocks of size 2^( 2) =       0.000415864589
  error estimate for blocks of size 2^( 3) =       0.000428496647
  error estimate for blocks of size 2^( 4) =       0.000440126426
  error estimate for blocks of size 2^( 5) =       0.000450907787
  error estimate for blocks of size 2^( 6) =       0.000456967013
  error estimate for blocks of size 2^( 7) =       0.000461308972

      target function =                  N/A
              le_mean =     -16.909736878504
             les_mean =     286.265800776375
             stat err =       0.000452327549
             autocorr =       1.252911438387
              std dev =       0.571488967028
             le_variance =       0.326599639434


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909736878505        initial  <--
     1.4901e+05     1.4901e+06             3.4544e-09       -16.909736878488
     5.9605e+05     5.9605e+06             8.6360e-10       -16.909736878496
     2.3842e+06     2.3842e+07             2.1590e-10       -16.909736878504

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.1203
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.283903
====================================================
  Execution time = 2.2811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2856e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328609090526
                                         uncertainty =       0.004225400111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328609090526
                                         uncertainty =       0.004225400111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405312427
  error estimate for blocks of size 2^( 2) =       0.000417232195
  error estimate for blocks of size 2^( 3) =       0.000429480849
  error estimate for blocks of size 2^( 4) =       0.000441044946
  error estimate for blocks of size 2^( 5) =       0.000451144267
  error estimate for blocks of size 2^( 6) =       0.000457195000
  error estimate for blocks of size 2^( 7) =       0.000459854598

      target function =                  N/A
              le_mean =     -16.909579087667
             les_mean =     286.262421085283
             stat err =       0.000452309703
             autocorr =       1.245351558418
              std dev =       0.573198331722
             le_variance =       0.328556327489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690957908767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909579087667       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909579087672       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909579087675       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909579087648       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909579087880       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909579087911       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909579087828       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909579087857       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.852581e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909579087667       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909579087668       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909579087669       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909579090096       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909579090892       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909579092786       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909579092421       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909579084891       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 9.631514e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909579087667       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909579087668       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909579087668       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909579103325       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909579087295       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909579094201       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909579087668       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909579088696       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 2.407884e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8949e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.853
    reference variance = 0.269137
====================================================
  Execution time = 2.2288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3004e-01
  Total weights = 2.0000e+06
  Execution time = 2.4660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251300
                                         uncertainty =       0.003208265929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251300
                                         uncertainty =       0.003208265929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406229060
  error estimate for blocks of size 2^( 2) =       0.000418377934
  error estimate for blocks of size 2^( 3) =       0.000431676215
  error estimate for blocks of size 2^( 4) =       0.000443935875
  error estimate for blocks of size 2^( 5) =       0.000454977266
  error estimate for blocks of size 2^( 6) =       0.000462914550
  error estimate for blocks of size 2^( 7) =       0.000466068015

      target function =                  N/A
              le_mean =     -16.909800042884
             les_mean =     286.271381423368
             stat err =       0.000456973926
             autocorr =       1.265437986309
              std dev =       0.574494645817
             le_variance =       0.330044098073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251520
                                         uncertainty =       0.003208265931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251520
                                         uncertainty =       0.003208265931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406229060
  error estimate for blocks of size 2^( 2) =       0.000418377934
  error estimate for blocks of size 2^( 3) =       0.000431676215
  error estimate for blocks of size 2^( 4) =       0.000443935875
  error estimate for blocks of size 2^( 5) =       0.000454977266
  error estimate for blocks of size 2^( 6) =       0.000462914551
  error estimate for blocks of size 2^( 7) =       0.000466068015

      target function =                  N/A
              le_mean =     -16.909800042881
             les_mean =     286.271381423487
             stat err =       0.000456973927
             autocorr =       1.265437985945
              std dev =       0.574494646009
             le_variance =       0.330044098293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251410
                                         uncertainty =       0.003208265930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251410
                                         uncertainty =       0.003208265930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406229060
  error estimate for blocks of size 2^( 2) =       0.000418377934
  error estimate for blocks of size 2^( 3) =       0.000431676215
  error estimate for blocks of size 2^( 4) =       0.000443935875
  error estimate for blocks of size 2^( 5) =       0.000454977266
  error estimate for blocks of size 2^( 6) =       0.000462914551
  error estimate for blocks of size 2^( 7) =       0.000466068015

      target function =                  N/A
              le_mean =     -16.909800042882
             les_mean =     286.271381423427
             stat err =       0.000456973926
             autocorr =       1.265437986128
              std dev =       0.574494645913
             le_variance =       0.330044098183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251314
                                         uncertainty =       0.003208265929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330123251314
                                         uncertainty =       0.003208265929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406229060
  error estimate for blocks of size 2^( 2) =       0.000418377934
  error estimate for blocks of size 2^( 3) =       0.000431676215
  error estimate for blocks of size 2^( 4) =       0.000443935875
  error estimate for blocks of size 2^( 5) =       0.000454977266
  error estimate for blocks of size 2^( 6) =       0.000462914550
  error estimate for blocks of size 2^( 7) =       0.000466068015

      target function =                  N/A
              le_mean =     -16.909800042884
             les_mean =     286.271381423375
             stat err =       0.000456973926
             autocorr =       1.265437986283
              std dev =       0.574494645829
             le_variance =       0.330044098087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909800042884        initial  <--
     1.4901e+06     1.4901e+07             3.8526e-10       -16.909800042881
     5.9605e+06     5.9605e+07             9.6315e-11       -16.909800042882
     2.3842e+07     2.3842e+08             2.4079e-11       -16.909800042884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.8153
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.908
    reference variance = 0.214985
====================================================
  Execution time = 2.2829e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3246e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332508148095
                                         uncertainty =       0.005822006360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332508148095
                                         uncertainty =       0.005822006360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407711995
  error estimate for blocks of size 2^( 2) =       0.000419532962
  error estimate for blocks of size 2^( 3) =       0.000431724771
  error estimate for blocks of size 2^( 4) =       0.000443682401
  error estimate for blocks of size 2^( 5) =       0.000454380561
  error estimate for blocks of size 2^( 6) =       0.000461959588
  error estimate for blocks of size 2^( 7) =       0.000466959952

      target function =                  N/A
              le_mean =     -16.910389484788
             les_mean =     286.293730502324
             stat err =       0.000456745625
             autocorr =       1.254994481460
              std dev =       0.576591832519
             le_variance =       0.332458141327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691038948479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910389484788       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910389484788       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910389484789       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910389484789       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910389472443       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910389486647       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910389505896       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910389502026       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910389481720       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 3.995645e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910389484788       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910389484788       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910389484788       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910389492936       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910389419428       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910389457860       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910389498003       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910389506524       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910389461719       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 9.989025e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910389484788       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910389484788       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910389484788       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910389467923       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910389484788       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910389373711       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910389543533       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910389473552       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910389705362       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 2.497053e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9005e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9034
    reference variance = 0.208886
====================================================
  Execution time = 2.3566e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3869e-01
  Total weights = 2.0000e+06
  Execution time = 2.8451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936425
                                         uncertainty =       0.006795839490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936425
                                         uncertainty =       0.006795839490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411514129
  error estimate for blocks of size 2^( 2) =       0.000423444362
  error estimate for blocks of size 2^( 3) =       0.000435623023
  error estimate for blocks of size 2^( 4) =       0.000447726875
  error estimate for blocks of size 2^( 5) =       0.000457145902
  error estimate for blocks of size 2^( 6) =       0.000464824300
  error estimate for blocks of size 2^( 7) =       0.000468078367

      target function =                  N/A
              le_mean =     -16.909807918821
             les_mean =     286.280291438678
             stat err =       0.000459443861
             autocorr =       1.246508959618
              std dev =       0.581968862211
             le_variance =       0.338687756584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936451
                                         uncertainty =       0.006795839491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936451
                                         uncertainty =       0.006795839491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411514129
  error estimate for blocks of size 2^( 2) =       0.000423444362
  error estimate for blocks of size 2^( 3) =       0.000435623023
  error estimate for blocks of size 2^( 4) =       0.000447726876
  error estimate for blocks of size 2^( 5) =       0.000457145902
  error estimate for blocks of size 2^( 6) =       0.000464824300
  error estimate for blocks of size 2^( 7) =       0.000468078367

      target function =                  N/A
              le_mean =     -16.909807918822
             les_mean =     286.280291438704
             stat err =       0.000459443861
             autocorr =       1.246508959568
              std dev =       0.581968862233
             le_variance =       0.338687756609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936438
                                         uncertainty =       0.006795839490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936438
                                         uncertainty =       0.006795839490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411514129
  error estimate for blocks of size 2^( 2) =       0.000423444362
  error estimate for blocks of size 2^( 3) =       0.000435623023
  error estimate for blocks of size 2^( 4) =       0.000447726876
  error estimate for blocks of size 2^( 5) =       0.000457145902
  error estimate for blocks of size 2^( 6) =       0.000464824300
  error estimate for blocks of size 2^( 7) =       0.000468078367

      target function =                  N/A
              le_mean =     -16.909807918821
             les_mean =     286.280291438691
             stat err =       0.000459443861
             autocorr =       1.246508959590
              std dev =       0.581968862222
             le_variance =       0.338687756596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936427
                                         uncertainty =       0.006795839490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338640936427
                                         uncertainty =       0.006795839490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411514129
  error estimate for blocks of size 2^( 2) =       0.000423444362
  error estimate for blocks of size 2^( 3) =       0.000435623023
  error estimate for blocks of size 2^( 4) =       0.000447726875
  error estimate for blocks of size 2^( 5) =       0.000457145902
  error estimate for blocks of size 2^( 6) =       0.000464824300
  error estimate for blocks of size 2^( 7) =       0.000468078367

      target function =                  N/A
              le_mean =     -16.909807918821
             les_mean =     286.280291438679
             stat err =       0.000459443861
             autocorr =       1.246508959622
              std dev =       0.581968862213
             le_variance =       0.338687756585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909807918821        initial
     1.4901e+07     1.4901e+08             3.9956e-11       -16.909807918822  <--
     5.9605e+07     5.9605e+08             9.9890e-12       -16.909807918821
     2.3842e+08     2.3842e+09             2.4971e-12       -16.909807918821

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 3.6474e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.5486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8384
    reference variance = 0.165945
====================================================
  Execution time = 2.3175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334463490856
                                         uncertainty =       0.005460393242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334463490856
                                         uncertainty =       0.005460393242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408917765
  error estimate for blocks of size 2^( 2) =       0.000420594258
  error estimate for blocks of size 2^( 3) =       0.000433106426
  error estimate for blocks of size 2^( 4) =       0.000444685163
  error estimate for blocks of size 2^( 5) =       0.000456791691
  error estimate for blocks of size 2^( 6) =       0.000464009667
  error estimate for blocks of size 2^( 7) =       0.000470331741

      target function =                  N/A
              le_mean =     -16.909883312415
             les_mean =     286.278580948727
             stat err =       0.000458954566
             autocorr =       1.259700880533
              std dev =       0.578297048616
             le_variance =       0.334427476437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690988331242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909883312415       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909883312417       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909883312419       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909883312419       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909883312554       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909883313673       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909883314941       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909883308208       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909883314463       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.644387e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909883312415       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909883312416       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909883312416       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909883312416       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909883291313       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909883305730       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909883323504       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909883297990       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909883324059       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 4.110901e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909883312415       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909883312415       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909883312416       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909883299056       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909883338147       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909883291775       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909883272290       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909883339109       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909883301195       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 1.027758e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9221e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.202983
====================================================
  Execution time = 2.2389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3099e-01
  Total weights = 2.0000e+06
  Execution time = 2.4587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476520
                                         uncertainty =       0.005362643251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476520
                                         uncertainty =       0.005362643251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406812803
  error estimate for blocks of size 2^( 2) =       0.000418393322
  error estimate for blocks of size 2^( 3) =       0.000430355948
  error estimate for blocks of size 2^( 4) =       0.000441849727
  error estimate for blocks of size 2^( 5) =       0.000452545916
  error estimate for blocks of size 2^( 6) =       0.000460157468
  error estimate for blocks of size 2^( 7) =       0.000463523517

      target function =                  N/A
              le_mean =     -16.909963765954
             les_mean =     286.277867714218
             stat err =       0.000454519157
             autocorr =       1.248289047204
              std dev =       0.575320183769
             le_variance =       0.330993313852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476638
                                         uncertainty =       0.005362643252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476638
                                         uncertainty =       0.005362643252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406812803
  error estimate for blocks of size 2^( 2) =       0.000418393322
  error estimate for blocks of size 2^( 3) =       0.000430355948
  error estimate for blocks of size 2^( 4) =       0.000441849727
  error estimate for blocks of size 2^( 5) =       0.000452545916
  error estimate for blocks of size 2^( 6) =       0.000460157468
  error estimate for blocks of size 2^( 7) =       0.000463523517

      target function =                  N/A
              le_mean =     -16.909963765953
             les_mean =     286.277867714302
             stat err =       0.000454519157
             autocorr =       1.248289047008
              std dev =       0.575320183872
             le_variance =       0.330993313970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476579
                                         uncertainty =       0.005362643252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476579
                                         uncertainty =       0.005362643252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406812803
  error estimate for blocks of size 2^( 2) =       0.000418393322
  error estimate for blocks of size 2^( 3) =       0.000430355948
  error estimate for blocks of size 2^( 4) =       0.000441849727
  error estimate for blocks of size 2^( 5) =       0.000452545916
  error estimate for blocks of size 2^( 6) =       0.000460157468
  error estimate for blocks of size 2^( 7) =       0.000463523517

      target function =                  N/A
              le_mean =     -16.909963765953
             les_mean =     286.277867714260
             stat err =       0.000454519157
             autocorr =       1.248289047108
              std dev =       0.575320183821
             le_variance =       0.330993313911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476527
                                         uncertainty =       0.005362643251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330906476527
                                         uncertainty =       0.005362643251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406812803
  error estimate for blocks of size 2^( 2) =       0.000418393322
  error estimate for blocks of size 2^( 3) =       0.000430355948
  error estimate for blocks of size 2^( 4) =       0.000441849727
  error estimate for blocks of size 2^( 5) =       0.000452545916
  error estimate for blocks of size 2^( 6) =       0.000460157468
  error estimate for blocks of size 2^( 7) =       0.000463523517

      target function =                  N/A
              le_mean =     -16.909963765953
             les_mean =     286.277867714223
             stat err =       0.000454519157
             autocorr =       1.248289047184
              std dev =       0.575320183776
             le_variance =       0.330993313859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909963765954        initial  <--
     3.7253e+06     3.7253e+07             1.6444e-10       -16.909963765953
     1.4901e+07     1.4901e+08             4.1109e-11       -16.909963765953
     5.9605e+07     5.9605e+08             1.0278e-11       -16.909963765953

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9619
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.941
    reference variance = 0.167438
====================================================
  Execution time = 2.2935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729369135
                                         uncertainty =       0.003378868618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326729369135
                                         uncertainty =       0.003378868618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404917445
  error estimate for blocks of size 2^( 2) =       0.000417041335
  error estimate for blocks of size 2^( 3) =       0.000429211958
  error estimate for blocks of size 2^( 4) =       0.000440809968
  error estimate for blocks of size 2^( 5) =       0.000449886742
  error estimate for blocks of size 2^( 6) =       0.000454548497
  error estimate for blocks of size 2^( 7) =       0.000457448923

      target function =                  N/A
              le_mean =     -16.909669512142
             les_mean =     286.264839120025
             stat err =       0.000450673533
             autocorr =       1.238771290466
              std dev =       0.572639742011
             le_variance =       0.327916274131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690966951214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909669512142       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909669512142       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909669512142       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909669512849       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909669533607       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909669561029       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909669351940       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909669489069       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 1.755232e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909669512142       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909669512142       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909669512142       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909669512142       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909669512142       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909669519208       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909669479223       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909669542343       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 4.388134e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909669512142       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909669512142       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909669512142       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909669511076       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909669584924       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909669466896       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909669590983       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909669773454       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 1.097057e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093563 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9043e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.205097
====================================================
  Execution time = 2.2585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2810e-01
  Total weights = 2.0000e+06
  Execution time = 2.4656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188502
                                         uncertainty =       0.003178561841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188502
                                         uncertainty =       0.003178561841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405033585
  error estimate for blocks of size 2^( 2) =       0.000417126603
  error estimate for blocks of size 2^( 3) =       0.000429188382
  error estimate for blocks of size 2^( 4) =       0.000441761077
  error estimate for blocks of size 2^( 5) =       0.000453172736
  error estimate for blocks of size 2^( 6) =       0.000463091226
  error estimate for blocks of size 2^( 7) =       0.000467689011

      target function =                  N/A
              le_mean =     -16.909733498055
             les_mean =     286.267191221372
             stat err =       0.000456428512
             autocorr =       1.269882272371
              std dev =       0.572803989316
             le_variance =       0.328104410176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188511
                                         uncertainty =       0.003178561842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188511
                                         uncertainty =       0.003178561842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405033585
  error estimate for blocks of size 2^( 2) =       0.000417126603
  error estimate for blocks of size 2^( 3) =       0.000429188382
  error estimate for blocks of size 2^( 4) =       0.000441761077
  error estimate for blocks of size 2^( 5) =       0.000453172736
  error estimate for blocks of size 2^( 6) =       0.000463091226
  error estimate for blocks of size 2^( 7) =       0.000467689011

      target function =                  N/A
              le_mean =     -16.909733498055
             les_mean =     286.267191221386
             stat err =       0.000456428512
             autocorr =       1.269882272351
              std dev =       0.572803989324
             le_variance =       0.328104410186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188506
                                         uncertainty =       0.003178561842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188506
                                         uncertainty =       0.003178561842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405033585
  error estimate for blocks of size 2^( 2) =       0.000417126603
  error estimate for blocks of size 2^( 3) =       0.000429188382
  error estimate for blocks of size 2^( 4) =       0.000441761077
  error estimate for blocks of size 2^( 5) =       0.000453172736
  error estimate for blocks of size 2^( 6) =       0.000463091226
  error estimate for blocks of size 2^( 7) =       0.000467689011

      target function =                  N/A
              le_mean =     -16.909733498055
             les_mean =     286.267191221379
             stat err =       0.000456428512
             autocorr =       1.269882272358
              std dev =       0.572803989320
             le_variance =       0.328104410181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188502
                                         uncertainty =       0.003178561841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328173188502
                                         uncertainty =       0.003178561841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405033585
  error estimate for blocks of size 2^( 2) =       0.000417126603
  error estimate for blocks of size 2^( 3) =       0.000429188382
  error estimate for blocks of size 2^( 4) =       0.000441761077
  error estimate for blocks of size 2^( 5) =       0.000453172736
  error estimate for blocks of size 2^( 6) =       0.000463091226
  error estimate for blocks of size 2^( 7) =       0.000467689011

      target function =                  N/A
              le_mean =     -16.909733498055
             les_mean =     286.267191221373
             stat err =       0.000456428512
             autocorr =       1.269882272375
              std dev =       0.572803989317
             le_variance =       0.328104410177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909733498055        initial
     3.7253e+07     3.7253e+08             1.7552e-11       -16.909733498055  <--
     1.4901e+08     1.4901e+09             4.3881e-12       -16.909733498055
     5.9605e+08     5.9605e+09             1.0971e-12       -16.909733498055

*****************************************************************************
Applying the update for shift_i =   3.7253e+07     and shift_s =   3.7253e+08
*****************************************************************************

  Execution time = 3.5115e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4165e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9673
    reference variance = 0.165633
====================================================
  Execution time = 2.3029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4142e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341472439313
                                         uncertainty =       0.009138471145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341472439313
                                         uncertainty =       0.009138471145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413168879
  error estimate for blocks of size 2^( 2) =       0.000424751432
  error estimate for blocks of size 2^( 3) =       0.000436456144
  error estimate for blocks of size 2^( 4) =       0.000448102976
  error estimate for blocks of size 2^( 5) =       0.000456792438
  error estimate for blocks of size 2^( 6) =       0.000464696971
  error estimate for blocks of size 2^( 7) =       0.000468055507

      target function =                  N/A
              le_mean =     -16.910084522909
             les_mean =     286.292375445673
             stat err =       0.000459411973
             autocorr =       1.236372726072
              std dev =       0.584309031628
             le_variance =       0.341417044443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691008452291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910084522909       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910084522911       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910084522911       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910084522568       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910084524324       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084518472       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910084529906       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910084525441       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 5.892827e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910084522909       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910084522910       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910084522910       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910084513829       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910084525283       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084488250       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910084510272       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910084529580       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 1.473199e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910084522909       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910084522909       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910084522909       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910084523040       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910084481393       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084520204       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910084738701       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910084429752       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 3.683250e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9197e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.0079
    reference variance = 0.347004
====================================================
  Execution time = 2.2495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2824e-01
  Total weights = 2.0000e+06
  Execution time = 2.4721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569202
                                         uncertainty =       0.004182135980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569202
                                         uncertainty =       0.004182135980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405114512
  error estimate for blocks of size 2^( 2) =       0.000417271889
  error estimate for blocks of size 2^( 3) =       0.000429905491
  error estimate for blocks of size 2^( 4) =       0.000442026715
  error estimate for blocks of size 2^( 5) =       0.000453785962
  error estimate for blocks of size 2^( 6) =       0.000463087533
  error estimate for blocks of size 2^( 7) =       0.000466354378

      target function =                  N/A
              le_mean =     -16.909598079205
             les_mean =     286.262742572235
             stat err =       0.000456313647
             autocorr =       1.268736144689
              std dev =       0.572918437577
             le_variance =       0.328235536115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569231
                                         uncertainty =       0.004182135981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569231
                                         uncertainty =       0.004182135981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405114512
  error estimate for blocks of size 2^( 2) =       0.000417271889
  error estimate for blocks of size 2^( 3) =       0.000429905491
  error estimate for blocks of size 2^( 4) =       0.000442026715
  error estimate for blocks of size 2^( 5) =       0.000453785962
  error estimate for blocks of size 2^( 6) =       0.000463087533
  error estimate for blocks of size 2^( 7) =       0.000466354378

      target function =                  N/A
              le_mean =     -16.909598079205
             les_mean =     286.262742572271
             stat err =       0.000456313647
             autocorr =       1.268736144633
              std dev =       0.572918437602
             le_variance =       0.328235536145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569217
                                         uncertainty =       0.004182135981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569217
                                         uncertainty =       0.004182135981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405114512
  error estimate for blocks of size 2^( 2) =       0.000417271889
  error estimate for blocks of size 2^( 3) =       0.000429905491
  error estimate for blocks of size 2^( 4) =       0.000442026715
  error estimate for blocks of size 2^( 5) =       0.000453785962
  error estimate for blocks of size 2^( 6) =       0.000463087533
  error estimate for blocks of size 2^( 7) =       0.000466354378

      target function =                  N/A
              le_mean =     -16.909598079205
             les_mean =     286.262742572253
             stat err =       0.000456313647
             autocorr =       1.268736144668
              std dev =       0.572918437589
             le_variance =       0.328235536130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569204
                                         uncertainty =       0.004182135981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328313569204
                                         uncertainty =       0.004182135981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405114512
  error estimate for blocks of size 2^( 2) =       0.000417271889
  error estimate for blocks of size 2^( 3) =       0.000429905491
  error estimate for blocks of size 2^( 4) =       0.000442026715
  error estimate for blocks of size 2^( 5) =       0.000453785962
  error estimate for blocks of size 2^( 6) =       0.000463087533
  error estimate for blocks of size 2^( 7) =       0.000466354378

      target function =                  N/A
              le_mean =     -16.909598079205
             les_mean =     286.262742572237
             stat err =       0.000456313647
             autocorr =       1.268736144687
              std dev =       0.572918437579
             le_variance =       0.328235536117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909598079205        initial
     9.3132e+06     9.3132e+07             5.8928e-11       -16.909598079205  <--
     3.7253e+07     3.7253e+08             1.4732e-11       -16.909598079205
     1.4901e+08     1.4901e+09             3.6832e-12       -16.909598079205

*****************************************************************************
Applying the update for shift_i =   9.3132e+06     and shift_s =   9.3132e+07
*****************************************************************************

  Execution time = 3.5074e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4276e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8491
    reference variance = 0.537038
====================================================
  Execution time = 2.2963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2858e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328622063191
                                         uncertainty =       0.002937936316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328622063191
                                         uncertainty =       0.002937936316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405326843
  error estimate for blocks of size 2^( 2) =       0.000417046640
  error estimate for blocks of size 2^( 3) =       0.000429606574
  error estimate for blocks of size 2^( 4) =       0.000441566167
  error estimate for blocks of size 2^( 5) =       0.000452704798
  error estimate for blocks of size 2^( 6) =       0.000462001809
  error estimate for blocks of size 2^( 7) =       0.000466062591

      target function =                  N/A
              le_mean =     -16.910145237299
             les_mean =     286.281591480917
             stat err =       0.000455583841
             autocorr =       1.263356423462
              std dev =       0.573218717985
             le_variance =       0.328579698648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691014523730e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910145237299       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910145237302       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910145237304       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910145237308       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910145236818       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910145236370       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910145236778       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910145238212       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910145237888       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 2.245291e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910145237299       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910145237300       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910145237300       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910145235327       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910145236985       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910145244264       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910145238646       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910145235850       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910145242810       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 5.613242e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910145237299       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910145237300       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910145237300       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910145248877       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910145250553       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910145262201       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910145256212       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910145237507       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910145209958       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 1.403343e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9048e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9463
    reference variance = 0.355416
====================================================
  Execution time = 2.2218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3534e-01
  Total weights = 2.0000e+06
  Execution time = 2.4589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212698
                                         uncertainty =       0.004108792849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212698
                                         uncertainty =       0.004108792849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409477519
  error estimate for blocks of size 2^( 2) =       0.000421493896
  error estimate for blocks of size 2^( 3) =       0.000433391631
  error estimate for blocks of size 2^( 4) =       0.000444984270
  error estimate for blocks of size 2^( 5) =       0.000454977305
  error estimate for blocks of size 2^( 6) =       0.000463641609
  error estimate for blocks of size 2^( 7) =       0.000467630725

      target function =                  N/A
              le_mean =     -16.910233402264
             les_mean =     286.291337228829
             stat err =       0.000457808477
             autocorr =       1.249992863662
              std dev =       0.579088661130
             le_variance =       0.335343677450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212809
                                         uncertainty =       0.004108792850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212809
                                         uncertainty =       0.004108792850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409477519
  error estimate for blocks of size 2^( 2) =       0.000421493896
  error estimate for blocks of size 2^( 3) =       0.000433391631
  error estimate for blocks of size 2^( 4) =       0.000444984270
  error estimate for blocks of size 2^( 5) =       0.000454977305
  error estimate for blocks of size 2^( 6) =       0.000463641609
  error estimate for blocks of size 2^( 7) =       0.000467630725

      target function =                  N/A
              le_mean =     -16.910233402264
             les_mean =     286.291337228939
             stat err =       0.000457808477
             autocorr =       1.249992863451
              std dev =       0.579088661226
             le_variance =       0.335343677561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212753
                                         uncertainty =       0.004108792850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212753
                                         uncertainty =       0.004108792850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409477519
  error estimate for blocks of size 2^( 2) =       0.000421493896
  error estimate for blocks of size 2^( 3) =       0.000433391631
  error estimate for blocks of size 2^( 4) =       0.000444984270
  error estimate for blocks of size 2^( 5) =       0.000454977305
  error estimate for blocks of size 2^( 6) =       0.000463641609
  error estimate for blocks of size 2^( 7) =       0.000467630725

      target function =                  N/A
              le_mean =     -16.910233402264
             les_mean =     286.291337228884
             stat err =       0.000457808477
             autocorr =       1.249992863550
              std dev =       0.579088661178
             le_variance =       0.335343677505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212705
                                         uncertainty =       0.004108792849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335378212705
                                         uncertainty =       0.004108792849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409477519
  error estimate for blocks of size 2^( 2) =       0.000421493896
  error estimate for blocks of size 2^( 3) =       0.000433391631
  error estimate for blocks of size 2^( 4) =       0.000444984270
  error estimate for blocks of size 2^( 5) =       0.000454977305
  error estimate for blocks of size 2^( 6) =       0.000463641609
  error estimate for blocks of size 2^( 7) =       0.000467630725

      target function =                  N/A
              le_mean =     -16.910233402264
             les_mean =     286.291337228836
             stat err =       0.000457808477
             autocorr =       1.249992863652
              std dev =       0.579088661136
             le_variance =       0.335343677456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910233402264        initial  <--
     2.3283e+06     2.3283e+07             2.2453e-10       -16.910233402264
     9.3132e+06     9.3132e+07             5.6132e-11       -16.910233402264
     3.7253e+07     3.7253e+08             1.4033e-11       -16.910233402264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.7016
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8611
    reference variance = 0.191416
====================================================
  Execution time = 2.2861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332029372681
                                         uncertainty =       0.004913128165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332029372681
                                         uncertainty =       0.004913128165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407406228
  error estimate for blocks of size 2^( 2) =       0.000419520192
  error estimate for blocks of size 2^( 3) =       0.000431794227
  error estimate for blocks of size 2^( 4) =       0.000443969625
  error estimate for blocks of size 2^( 5) =       0.000454815473
  error estimate for blocks of size 2^( 6) =       0.000460281401
  error estimate for blocks of size 2^( 7) =       0.000463866265

      target function =                  N/A
              le_mean =     -16.909614241937
             les_mean =     286.267013313562
             stat err =       0.000455733191
             autocorr =       1.251313103794
              std dev =       0.576159412342
             le_variance =       0.331959668431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690961424194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909614241937       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909614241937       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909614241937       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909614249786       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909614243878       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909614251407       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909614246103       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909614246741       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909614243096       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.800259e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909614241937       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909614241937       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909614241937       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909614241123       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909614241937       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909614244655       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909614198697       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909614281316       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909614182256       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 7.000788e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909614241937       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909614241937       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909614241937       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909614117961       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909614286863       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909614216326       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909614118393       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909614016907       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909614157548       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.749655e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2773e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.93
    reference variance = 0.237739
====================================================
  Execution time = 2.2469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3072e-01
  Total weights = 2.0000e+06
  Execution time = 2.4743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259099
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259099
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406645383
  error estimate for blocks of size 2^( 2) =       0.000418310162
  error estimate for blocks of size 2^( 3) =       0.000430957809
  error estimate for blocks of size 2^( 4) =       0.000442146338
  error estimate for blocks of size 2^( 5) =       0.000452885006
  error estimate for blocks of size 2^( 6) =       0.000459744919
  error estimate for blocks of size 2^( 7) =       0.000462754847

      target function =                  N/A
              le_mean =     -16.909893568052
             les_mean =     286.275221252310
             stat err =       0.000454382778
             autocorr =       1.248567518825
              std dev =       0.575083415526
             le_variance =       0.330720934813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259117
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259117
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406645383
  error estimate for blocks of size 2^( 2) =       0.000418310162
  error estimate for blocks of size 2^( 3) =       0.000430957809
  error estimate for blocks of size 2^( 4) =       0.000442146338
  error estimate for blocks of size 2^( 5) =       0.000452885006
  error estimate for blocks of size 2^( 6) =       0.000459744919
  error estimate for blocks of size 2^( 7) =       0.000462754847

      target function =                  N/A
              le_mean =     -16.909893568052
             les_mean =     286.275221252332
             stat err =       0.000454382778
             autocorr =       1.248567518791
              std dev =       0.575083415541
             le_variance =       0.330720934831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259108
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259108
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406645383
  error estimate for blocks of size 2^( 2) =       0.000418310162
  error estimate for blocks of size 2^( 3) =       0.000430957809
  error estimate for blocks of size 2^( 4) =       0.000442146338
  error estimate for blocks of size 2^( 5) =       0.000452885006
  error estimate for blocks of size 2^( 6) =       0.000459744919
  error estimate for blocks of size 2^( 7) =       0.000462754847

      target function =                  N/A
              le_mean =     -16.909893568052
             les_mean =     286.275221252321
             stat err =       0.000454382778
             autocorr =       1.248567518800
              std dev =       0.575083415534
             le_variance =       0.330720934822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259100
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846259100
                                         uncertainty =       0.004138572652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406645383
  error estimate for blocks of size 2^( 2) =       0.000418310162
  error estimate for blocks of size 2^( 3) =       0.000430957809
  error estimate for blocks of size 2^( 4) =       0.000442146338
  error estimate for blocks of size 2^( 5) =       0.000452885006
  error estimate for blocks of size 2^( 6) =       0.000459744919
  error estimate for blocks of size 2^( 7) =       0.000462754847

      target function =                  N/A
              le_mean =     -16.909893568052
             les_mean =     286.275221252311
             stat err =       0.000454382778
             autocorr =       1.248567518823
              std dev =       0.575083415527
             le_variance =       0.330720934814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909893568052        initial
     2.3283e+07     2.3283e+08             2.8003e-11       -16.909893568052  <--
     9.3132e+07     9.3132e+08             7.0008e-12       -16.909893568052
     3.7253e+08     3.7253e+09             1.7497e-12       -16.909893568052

*****************************************************************************
Applying the update for shift_i =   2.3283e+07     and shift_s =   2.3283e+08
*****************************************************************************

  Execution time = 3.5063e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.7842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.555044
====================================================
  Execution time = 2.2752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3254e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332473310684
                                         uncertainty =       0.003763516222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332473310684
                                         uncertainty =       0.003763516222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407759530
  error estimate for blocks of size 2^( 2) =       0.000419784385
  error estimate for blocks of size 2^( 3) =       0.000431852678
  error estimate for blocks of size 2^( 4) =       0.000442708651
  error estimate for blocks of size 2^( 5) =       0.000453513189
  error estimate for blocks of size 2^( 6) =       0.000462595982
  error estimate for blocks of size 2^( 7) =       0.000469074406

      target function =                  N/A
              le_mean =     -16.910264081463
             les_mean =     286.289566806611
             stat err =       0.000456973057
             autocorr =       1.255951736444
              std dev =       0.576659057026
             le_variance =       0.332535668051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691026408146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910264081463       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910264081464       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910264081465       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910264079334       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910264081580       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910264083029       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910264084000       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910264080959       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 8.554990e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910264081463       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910264081464       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910264081464       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910264081464       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910264075916       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910264085090       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910264082381       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910264079624       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.138751e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910264081463       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910264081463       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910264081463       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910264081463       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910264081463       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910264080072       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910263996530       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910264040159       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 5.347454e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8859e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.234098
====================================================
  Execution time = 2.2532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3177e-01
  Total weights = 2.0000e+06
  Execution time = 2.4547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063730
                                         uncertainty =       0.003553465187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063730
                                         uncertainty =       0.003553465187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407288043
  error estimate for blocks of size 2^( 2) =       0.000419460567
  error estimate for blocks of size 2^( 3) =       0.000432421377
  error estimate for blocks of size 2^( 4) =       0.000444728838
  error estimate for blocks of size 2^( 5) =       0.000456626066
  error estimate for blocks of size 2^( 6) =       0.000468354979
  error estimate for blocks of size 2^( 7) =       0.000476705573

      target function =                  N/A
              le_mean =     -16.910041019645
             les_mean =     286.281254220216
             stat err =       0.000461603864
             autocorr =       1.284504262692
              std dev =       0.575992274285
             le_variance =       0.331767100035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063795
                                         uncertainty =       0.003553465188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063795
                                         uncertainty =       0.003553465188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407288043
  error estimate for blocks of size 2^( 2) =       0.000419460567
  error estimate for blocks of size 2^( 3) =       0.000432421378
  error estimate for blocks of size 2^( 4) =       0.000444728838
  error estimate for blocks of size 2^( 5) =       0.000456626066
  error estimate for blocks of size 2^( 6) =       0.000468354979
  error estimate for blocks of size 2^( 7) =       0.000476705573

      target function =                  N/A
              le_mean =     -16.910041019644
             les_mean =     286.281254220267
             stat err =       0.000461603864
             autocorr =       1.284504262574
              std dev =       0.575992274342
             le_variance =       0.331767100101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063762
                                         uncertainty =       0.003553465188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063762
                                         uncertainty =       0.003553465188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407288043
  error estimate for blocks of size 2^( 2) =       0.000419460567
  error estimate for blocks of size 2^( 3) =       0.000432421378
  error estimate for blocks of size 2^( 4) =       0.000444728838
  error estimate for blocks of size 2^( 5) =       0.000456626066
  error estimate for blocks of size 2^( 6) =       0.000468354979
  error estimate for blocks of size 2^( 7) =       0.000476705573

      target function =                  N/A
              le_mean =     -16.910041019644
             les_mean =     286.281254220241
             stat err =       0.000461603864
             autocorr =       1.284504262637
              std dev =       0.575992274313
             le_variance =       0.331767100068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063734
                                         uncertainty =       0.003553465187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331770063734
                                         uncertainty =       0.003553465187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407288043
  error estimate for blocks of size 2^( 2) =       0.000419460567
  error estimate for blocks of size 2^( 3) =       0.000432421377
  error estimate for blocks of size 2^( 4) =       0.000444728838
  error estimate for blocks of size 2^( 5) =       0.000456626066
  error estimate for blocks of size 2^( 6) =       0.000468354979
  error estimate for blocks of size 2^( 7) =       0.000476705573

      target function =                  N/A
              le_mean =     -16.910041019645
             les_mean =     286.281254220219
             stat err =       0.000461603864
             autocorr =       1.284504262675
              std dev =       0.575992274288
             le_variance =       0.331767100039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910041019645        initial  <--
     5.8208e+06     5.8208e+07             8.5550e-11       -16.910041019644
     2.3283e+07     2.3283e+08             2.1388e-11       -16.910041019644
     9.3132e+07     9.3132e+08             5.3475e-12       -16.910041019645

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9860
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.161508
====================================================
  Execution time = 2.2800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4704e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346958447364
                                         uncertainty =       0.010310691530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346958447364
                                         uncertainty =       0.010310691530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416554763
  error estimate for blocks of size 2^( 2) =       0.000428340267
  error estimate for blocks of size 2^( 3) =       0.000440235028
  error estimate for blocks of size 2^( 4) =       0.000452133167
  error estimate for blocks of size 2^( 5) =       0.000462714377
  error estimate for blocks of size 2^( 6) =       0.000471292734
  error estimate for blocks of size 2^( 7) =       0.000478858098

      target function =                  N/A
              le_mean =     -16.911018694680
             les_mean =     286.329588858727
             stat err =       0.000466249594
             autocorr =       1.252831673687
              std dev =       0.589097394690
             le_variance =       0.347035740430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691101869468e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911018694680       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911018694680       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911018694680       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911018700966       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911018695159       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911018695808       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911018695800       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911018685103       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911018666069       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 9.465852e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911018694680       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911018694680       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911018694680       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911018694680       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911018681132       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911018682836       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911018694680       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911018839466       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911018481831       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 2.366499e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911018694680       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911018694680       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911018694680       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911018694680       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911018606832       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911019179836       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911019021783       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911019035005       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911019235075       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 5.915945e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8943e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9214
    reference variance = 0.200405
====================================================
  Execution time = 2.2637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4169e-01
  Total weights = 2.0000e+06
  Execution time = 2.4725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302630
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302630
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413336172
  error estimate for blocks of size 2^( 2) =       0.000425148740
  error estimate for blocks of size 2^( 3) =       0.000436718699
  error estimate for blocks of size 2^( 4) =       0.000447530853
  error estimate for blocks of size 2^( 5) =       0.000456607823
  error estimate for blocks of size 2^( 6) =       0.000462660053
  error estimate for blocks of size 2^( 7) =       0.000465742544

      target function =                  N/A
              le_mean =     -16.910244471780
             les_mean =     286.298061506164
             stat err =       0.000458135318
             autocorr =       1.228515729843
              std dev =       0.584545619800
             le_variance =       0.341693581628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302632
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302632
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413336172
  error estimate for blocks of size 2^( 2) =       0.000425148740
  error estimate for blocks of size 2^( 3) =       0.000436718699
  error estimate for blocks of size 2^( 4) =       0.000447530853
  error estimate for blocks of size 2^( 5) =       0.000456607823
  error estimate for blocks of size 2^( 6) =       0.000462660053
  error estimate for blocks of size 2^( 7) =       0.000465742544

      target function =                  N/A
              le_mean =     -16.910244471780
             les_mean =     286.298061506163
             stat err =       0.000458135318
             autocorr =       1.228515729840
              std dev =       0.584545619802
             le_variance =       0.341693581630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302631
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302631
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413336172
  error estimate for blocks of size 2^( 2) =       0.000425148740
  error estimate for blocks of size 2^( 3) =       0.000436718699
  error estimate for blocks of size 2^( 4) =       0.000447530853
  error estimate for blocks of size 2^( 5) =       0.000456607823
  error estimate for blocks of size 2^( 6) =       0.000462660053
  error estimate for blocks of size 2^( 7) =       0.000465742544

      target function =                  N/A
              le_mean =     -16.910244471780
             les_mean =     286.298061506164
             stat err =       0.000458135318
             autocorr =       1.228515729837
              std dev =       0.584545619802
             le_variance =       0.341693581629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302630
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341508302630
                                         uncertainty =       0.005614200336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413336172
  error estimate for blocks of size 2^( 2) =       0.000425148740
  error estimate for blocks of size 2^( 3) =       0.000436718699
  error estimate for blocks of size 2^( 4) =       0.000447530853
  error estimate for blocks of size 2^( 5) =       0.000456607823
  error estimate for blocks of size 2^( 6) =       0.000462660053
  error estimate for blocks of size 2^( 7) =       0.000465742544

      target function =                  N/A
              le_mean =     -16.910244471780
             les_mean =     286.298061506164
             stat err =       0.000458135318
             autocorr =       1.228515729839
              std dev =       0.584545619801
             le_variance =       0.341693581628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910244471780        initial  <--
     5.8208e+07     5.8208e+08             9.4659e-12       -16.910244471780
     2.3283e+08     2.3283e+09             2.3665e-12       -16.910244471780
     9.3132e+08     9.3132e+09             5.9159e-13       -16.910244471780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.2692
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9079
    reference variance = 0.252626
====================================================
  Execution time = 2.2727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2920e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329211375193
                                         uncertainty =       0.003684799765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329211375193
                                         uncertainty =       0.003684799765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405710846
  error estimate for blocks of size 2^( 2) =       0.000417410582
  error estimate for blocks of size 2^( 3) =       0.000429879330
  error estimate for blocks of size 2^( 4) =       0.000442266541
  error estimate for blocks of size 2^( 5) =       0.000452993344
  error estimate for blocks of size 2^( 6) =       0.000462783788
  error estimate for blocks of size 2^( 7) =       0.000467146107

      target function =                  N/A
              le_mean =     -16.910434889773
             les_mean =     286.292010577373
             stat err =       0.000456297445
             autocorr =       1.264919357389
              std dev =       0.573761780462
             le_variance =       0.329202580719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691043488977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910434889773       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910434889773       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910434889773       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910434889773       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910434889773       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910434753330       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910434532049       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910435193238       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910435383823       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 1.018832e-12

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910434889773       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910434889773       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910434889773       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910434889773       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910434432157       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910434893248       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910435076936       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910435247688       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910435154594       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 2.546645e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910434889773       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910434889773       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910434889773       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910434889773       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910437550768       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910435662791       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910429861415       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910439397055       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910383203029       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910449299437       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910537457666       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910488490006       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910594493238       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910537413374       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910453535140       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910497318066       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910462598905       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910640344187       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910346501375       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910638931643       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910198251087       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910526883792       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911221063062       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.911100265089       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.910235469234       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909975510442       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.910588285852       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.910850735847       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908536065088       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.909327212775       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.911695606040       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.910695322163       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.911887919050       residual = 2.63e-04           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.911273936685       residual = 9.10e-05           smallest_sin_value = 9.91e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.02e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 6.417658e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8864e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9125
    reference variance = 0.248342
====================================================
  Execution time = 2.2507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3202e-01
  Total weights = 2.0000e+06
  Execution time = 2.4727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407444639
  error estimate for blocks of size 2^( 2) =       0.000419379031
  error estimate for blocks of size 2^( 3) =       0.000431231611
  error estimate for blocks of size 2^( 4) =       0.000443035336
  error estimate for blocks of size 2^( 5) =       0.000452807301
  error estimate for blocks of size 2^( 6) =       0.000460290727
  error estimate for blocks of size 2^( 7) =       0.000463837073

      target function =                  N/A
              le_mean =     -16.909886139492
             les_mean =     286.276271353060
             stat err =       0.000454992609
             autocorr =       1.247014396839
              std dev =       0.576213735083
             le_variance =       0.332022268498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407444639
  error estimate for blocks of size 2^( 2) =       0.000419379031
  error estimate for blocks of size 2^( 3) =       0.000431231611
  error estimate for blocks of size 2^( 4) =       0.000443035336
  error estimate for blocks of size 2^( 5) =       0.000452807301
  error estimate for blocks of size 2^( 6) =       0.000460290727
  error estimate for blocks of size 2^( 7) =       0.000463837073

      target function =                  N/A
              le_mean =     -16.909886139492
             les_mean =     286.276271353061
             stat err =       0.000454992609
             autocorr =       1.247014396834
              std dev =       0.576213735083
             le_variance =       0.332022268499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407444639
  error estimate for blocks of size 2^( 2) =       0.000419379031
  error estimate for blocks of size 2^( 3) =       0.000431231611
  error estimate for blocks of size 2^( 4) =       0.000443035336
  error estimate for blocks of size 2^( 5) =       0.000452807301
  error estimate for blocks of size 2^( 6) =       0.000460290727
  error estimate for blocks of size 2^( 7) =       0.000463837073

      target function =                  N/A
              le_mean =     -16.909886139492
             les_mean =     286.276271353061
             stat err =       0.000454992609
             autocorr =       1.247014396842
              std dev =       0.576213735083
             le_variance =       0.332022268499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332103315216
                                         uncertainty =       0.004072360196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407444639
  error estimate for blocks of size 2^( 2) =       0.000419379031
  error estimate for blocks of size 2^( 3) =       0.000431231611
  error estimate for blocks of size 2^( 4) =       0.000443035336
  error estimate for blocks of size 2^( 5) =       0.000452807301
  error estimate for blocks of size 2^( 6) =       0.000460290727
  error estimate for blocks of size 2^( 7) =       0.000463837073

      target function =                  N/A
              le_mean =     -16.909886139492
             les_mean =     286.276271353061
             stat err =       0.000454992609
             autocorr =       1.247014396837
              std dev =       0.576213735083
             le_variance =       0.332022268498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909886139492        initial
     5.8208e+08     5.8208e+09             1.0188e-12       -16.909886139492  <--
     2.3283e+09     2.3283e+10             2.5466e-13       -16.909886139492
     9.3132e+09     9.3132e+10             6.4177e-14       -16.909886139492

*****************************************************************************
Applying the update for shift_i =   5.8208e+08     and shift_s =   5.8208e+09
*****************************************************************************

  Execution time = 3.5063e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9341
    reference variance = 0.20767
====================================================
  Execution time = 2.2761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3402e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334135749500
                                         uncertainty =       0.005659045206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334135749500
                                         uncertainty =       0.005659045206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408670989
  error estimate for blocks of size 2^( 2) =       0.000420846544
  error estimate for blocks of size 2^( 3) =       0.000433331885
  error estimate for blocks of size 2^( 4) =       0.000445123926
  error estimate for blocks of size 2^( 5) =       0.000457502490
  error estimate for blocks of size 2^( 6) =       0.000466481533
  error estimate for blocks of size 2^( 7) =       0.000469436947

      target function =                  N/A
              le_mean =     -16.910428836616
             les_mean =     286.296627225503
             stat err =       0.000459636224
             autocorr =       1.264971902141
              std dev =       0.577948054972
             le_variance =       0.334023954246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691042883662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910428836616       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910428836616       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910428836616       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910428836616       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910428836617       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910428792827       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910428858409       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910428789368       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910428832350       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 3.711263e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910428836616       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910428836616       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910428836616       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910428867742       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910428601727       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910428911578       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910427930350       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910428612756       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910428265437       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 9.273062e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910428836616       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910428836616       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910428836616       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910428539479       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910428822635       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910428606073       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910430340323       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910427911281       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910430266042       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 2.318763e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8874e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9178
    reference variance = 0.338769
====================================================
  Execution time = 2.2376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2823e-01
  Total weights = 2.0000e+06
  Execution time = 2.5123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238155
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238155
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405113937
  error estimate for blocks of size 2^( 2) =       0.000417439804
  error estimate for blocks of size 2^( 3) =       0.000430059212
  error estimate for blocks of size 2^( 4) =       0.000442941982
  error estimate for blocks of size 2^( 5) =       0.000454648211
  error estimate for blocks of size 2^( 6) =       0.000464839424
  error estimate for blocks of size 2^( 7) =       0.000471372369

      target function =                  N/A
              le_mean =     -16.909308003968
             les_mean =     286.252931612865
             stat err =       0.000458450496
             autocorr =       1.280650212531
              std dev =       0.572917624029
             le_variance =       0.328234603923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238157
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238157
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405113937
  error estimate for blocks of size 2^( 2) =       0.000417439804
  error estimate for blocks of size 2^( 3) =       0.000430059212
  error estimate for blocks of size 2^( 4) =       0.000442941982
  error estimate for blocks of size 2^( 5) =       0.000454648211
  error estimate for blocks of size 2^( 6) =       0.000464839424
  error estimate for blocks of size 2^( 7) =       0.000471372369

      target function =                  N/A
              le_mean =     -16.909308003968
             les_mean =     286.252931612867
             stat err =       0.000458450496
             autocorr =       1.280650212525
              std dev =       0.572917624031
             le_variance =       0.328234603925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238156
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238156
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405113937
  error estimate for blocks of size 2^( 2) =       0.000417439804
  error estimate for blocks of size 2^( 3) =       0.000430059212
  error estimate for blocks of size 2^( 4) =       0.000442941982
  error estimate for blocks of size 2^( 5) =       0.000454648211
  error estimate for blocks of size 2^( 6) =       0.000464839424
  error estimate for blocks of size 2^( 7) =       0.000471372369

      target function =                  N/A
              le_mean =     -16.909308003968
             les_mean =     286.252931612866
             stat err =       0.000458450496
             autocorr =       1.280650212533
              std dev =       0.572917624030
             le_variance =       0.328234603924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238155
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328309238155
                                         uncertainty =       0.003991435357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405113937
  error estimate for blocks of size 2^( 2) =       0.000417439804
  error estimate for blocks of size 2^( 3) =       0.000430059212
  error estimate for blocks of size 2^( 4) =       0.000442941982
  error estimate for blocks of size 2^( 5) =       0.000454648211
  error estimate for blocks of size 2^( 6) =       0.000464839424
  error estimate for blocks of size 2^( 7) =       0.000471372369

      target function =                  N/A
              le_mean =     -16.909308003968
             les_mean =     286.252931612865
             stat err =       0.000458450496
             autocorr =       1.280650212530
              std dev =       0.572917624029
             le_variance =       0.328234603923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909308003968        initial
     1.4552e+08     1.4552e+09             3.7113e-12       -16.909308003968
     5.8208e+08     5.8208e+09             9.2731e-13       -16.909308003968  <--
     2.3283e+09     2.3283e+10             2.3188e-13       -16.909308003968

*****************************************************************************
Applying the update for shift_i =   5.8208e+08     and shift_s =   5.8208e+09
*****************************************************************************

  Execution time = 3.4994e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.164105
====================================================
  Execution time = 2.5238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2351e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323532256688
                                         uncertainty =       0.002825070483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323532256688
                                         uncertainty =       0.002825070483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402190400
  error estimate for blocks of size 2^( 2) =       0.000414356445
  error estimate for blocks of size 2^( 3) =       0.000427642679
  error estimate for blocks of size 2^( 4) =       0.000439915005
  error estimate for blocks of size 2^( 5) =       0.000451075820
  error estimate for blocks of size 2^( 6) =       0.000460006878
  error estimate for blocks of size 2^( 7) =       0.000465066123

      target function =                  N/A
              le_mean =     -16.910314894417
             les_mean =     286.282263901661
             stat err =       0.000454015956
             autocorr =       1.274320980060
              std dev =       0.568783117776
             le_variance =       0.323514235067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691031489442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910314894417       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910314894417       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910314894417       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910314894417       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910314894362       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910315043721       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910315198585       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910314864996       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910314942039       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 4.064662e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910314894417       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910314894417       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910314894417       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910314964676       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910314749165       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910314947654       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910314611067       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910314839657       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910315198179       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 1.015866e-12

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910314894417       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910314894417       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910314894417       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910314893952       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910314894417       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910314634709       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910314393769       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910313981708       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910314544187       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 2.537562e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1317e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.161595
====================================================
  Execution time = 2.2493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3051e-01
  Total weights = 2.0000e+06
  Execution time = 2.4786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289983
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289983
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406516856
  error estimate for blocks of size 2^( 2) =       0.000418748642
  error estimate for blocks of size 2^( 3) =       0.000431651000
  error estimate for blocks of size 2^( 4) =       0.000444430388
  error estimate for blocks of size 2^( 5) =       0.000456152188
  error estimate for blocks of size 2^( 6) =       0.000464182527
  error estimate for blocks of size 2^( 7) =       0.000471293919

      target function =                  N/A
              le_mean =     -16.909462162264
             les_mean =     286.260422360390
             stat err =       0.000459014756
             autocorr =       1.274958876213
              std dev =       0.574901651251
             le_variance =       0.330511908611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289985
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289985
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406516856
  error estimate for blocks of size 2^( 2) =       0.000418748642
  error estimate for blocks of size 2^( 3) =       0.000431651000
  error estimate for blocks of size 2^( 4) =       0.000444430388
  error estimate for blocks of size 2^( 5) =       0.000456152188
  error estimate for blocks of size 2^( 6) =       0.000464182527
  error estimate for blocks of size 2^( 7) =       0.000471293919

      target function =                  N/A
              le_mean =     -16.909462162264
             les_mean =     286.260422360391
             stat err =       0.000459014756
             autocorr =       1.274958876207
              std dev =       0.574901651253
             le_variance =       0.330511908613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289984
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289984
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406516856
  error estimate for blocks of size 2^( 2) =       0.000418748642
  error estimate for blocks of size 2^( 3) =       0.000431651000
  error estimate for blocks of size 2^( 4) =       0.000444430388
  error estimate for blocks of size 2^( 5) =       0.000456152188
  error estimate for blocks of size 2^( 6) =       0.000464182527
  error estimate for blocks of size 2^( 7) =       0.000471293919

      target function =                  N/A
              le_mean =     -16.909462162264
             les_mean =     286.260422360391
             stat err =       0.000459014756
             autocorr =       1.274958876204
              std dev =       0.574901651252
             le_variance =       0.330511908612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289983
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330521289983
                                         uncertainty =       0.004903255750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406516856
  error estimate for blocks of size 2^( 2) =       0.000418748642
  error estimate for blocks of size 2^( 3) =       0.000431651000
  error estimate for blocks of size 2^( 4) =       0.000444430388
  error estimate for blocks of size 2^( 5) =       0.000456152188
  error estimate for blocks of size 2^( 6) =       0.000464182527
  error estimate for blocks of size 2^( 7) =       0.000471293919

      target function =                  N/A
              le_mean =     -16.909462162264
             les_mean =     286.260422360390
             stat err =       0.000459014756
             autocorr =       1.274958876213
              std dev =       0.574901651251
             le_variance =       0.330511908611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909462162264        initial  <--
     1.4552e+08     1.4552e+09             4.0647e-12       -16.909462162264
     5.8208e+08     5.8208e+09             1.0159e-12       -16.909462162264
     2.3283e+09     2.3283e+10             2.5376e-13       -16.909462162264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.0802
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.6404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8787
    reference variance = 0.308142
====================================================
  Execution time = 2.2601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4077e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340760865662
                                         uncertainty =       0.010719820276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340760865662
                                         uncertainty =       0.010719820276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412774471
  error estimate for blocks of size 2^( 2) =       0.000424195549
  error estimate for blocks of size 2^( 3) =       0.000436012186
  error estimate for blocks of size 2^( 4) =       0.000447760221
  error estimate for blocks of size 2^( 5) =       0.000456788969
  error estimate for blocks of size 2^( 6) =       0.000464993505
  error estimate for blocks of size 2^( 7) =       0.000469640983

      target function =                  N/A
              le_mean =     -16.909835265271
             les_mean =     286.283294055559
             stat err =       0.000459795920
             autocorr =       1.240807949631
              std dev =       0.583751254674
             le_variance =       0.340765527334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690983526527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909835265271       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909835265271       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909835265271       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909835265271       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909835265271       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909834674119       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909834554656       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909835500024       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909836063867       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 4.107915e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909835265271       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909835265271       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909835265271       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909832984304       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909835308845       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909832796489       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909830923765       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909830519555       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909834954979       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 1.020105e-13

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909835265271       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909835265271       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909835265271       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909831320521       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909850165974       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909834056255       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909848994406       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909879482986       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909833879099       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909807215217       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909686300042       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909632043097       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909774035787       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910255430228       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910378586792       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909661437576       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909840556821       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909848224681       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909463454917       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908932718384       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907750522237       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.909800929670       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.907947975802       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910498376878       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909331834668       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908563508708       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.910290765075       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.910605545066       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906575802388       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910084555223       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.909041586902       residual = 8.81e-05           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.908226252412       residual = 4.80e-04           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.909547585448       residual = 9.77e-05           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.595046e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153563 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8790e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.201149
====================================================
  Execution time = 2.2341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2652e-01
  Total weights = 2.0000e+06
  Execution time = 2.4640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404056917
  error estimate for blocks of size 2^( 2) =       0.000415771374
  error estimate for blocks of size 2^( 3) =       0.000428095308
  error estimate for blocks of size 2^( 4) =       0.000439954427
  error estimate for blocks of size 2^( 5) =       0.000450824890
  error estimate for blocks of size 2^( 6) =       0.000460613507
  error estimate for blocks of size 2^( 7) =       0.000465388557

      target function =                  N/A
              le_mean =     -16.910616714034
             les_mean =     286.295481470188
             stat err =       0.000454195345
             autocorr =       1.263572794205
              std dev =       0.571422772097
             le_variance =       0.326523984472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404056917
  error estimate for blocks of size 2^( 2) =       0.000415771374
  error estimate for blocks of size 2^( 3) =       0.000428095308
  error estimate for blocks of size 2^( 4) =       0.000439954427
  error estimate for blocks of size 2^( 5) =       0.000450824890
  error estimate for blocks of size 2^( 6) =       0.000460613507
  error estimate for blocks of size 2^( 7) =       0.000465388557

      target function =                  N/A
              le_mean =     -16.910616714034
             les_mean =     286.295481470188
             stat err =       0.000454195345
             autocorr =       1.263572794201
              std dev =       0.571422772098
             le_variance =       0.326523984472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404056917
  error estimate for blocks of size 2^( 2) =       0.000415771374
  error estimate for blocks of size 2^( 3) =       0.000428095308
  error estimate for blocks of size 2^( 4) =       0.000439954427
  error estimate for blocks of size 2^( 5) =       0.000450824890
  error estimate for blocks of size 2^( 6) =       0.000460613507
  error estimate for blocks of size 2^( 7) =       0.000465388557

      target function =                  N/A
              le_mean =     -16.910616714034
             les_mean =     286.295481470188
             stat err =       0.000454195345
             autocorr =       1.263572794188
              std dev =       0.571422772098
             le_variance =       0.326523984472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326580990578
                                         uncertainty =       0.003018459741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404056917
  error estimate for blocks of size 2^( 2) =       0.000415771374
  error estimate for blocks of size 2^( 3) =       0.000428095308
  error estimate for blocks of size 2^( 4) =       0.000439954427
  error estimate for blocks of size 2^( 5) =       0.000450824890
  error estimate for blocks of size 2^( 6) =       0.000460613507
  error estimate for blocks of size 2^( 7) =       0.000465388557

      target function =                  N/A
              le_mean =     -16.910616714034
             les_mean =     286.295481470188
             stat err =       0.000454195345
             autocorr =       1.263572794195
              std dev =       0.571422772097
             le_variance =       0.326523984472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910616714034        initial
     1.4552e+09     1.4552e+10             4.1079e-13       -16.910616714034
     5.8208e+09     5.8208e+10             1.0201e-13       -16.910616714034
     2.3283e+10     2.3283e+11             2.5950e-14       -16.910616714034  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 3.4855e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8338
    reference variance = 0.35245
====================================================
  Execution time = 2.2694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330969409636
                                         uncertainty =       0.003512235928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330969409636
                                         uncertainty =       0.003512235928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406851657
  error estimate for blocks of size 2^( 2) =       0.000418772489
  error estimate for blocks of size 2^( 3) =       0.000431374234
  error estimate for blocks of size 2^( 4) =       0.000444743068
  error estimate for blocks of size 2^( 5) =       0.000455454399
  error estimate for blocks of size 2^( 6) =       0.000465940365
  error estimate for blocks of size 2^( 7) =       0.000469575434

      target function =                  N/A
              le_mean =     -16.908890871574
             les_mean =     286.241646883228
             stat err =       0.000458928317
             autocorr =       1.272382043689
              std dev =       0.575375131519
             le_variance =       0.331056541970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690889087157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908890871574       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908890871574       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908890871574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908890871574       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908890871574       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908886929376       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908887985185       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908888147946       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908893273741       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 9.652503e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908890871574       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908890871574       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908890871574       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908890871574       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908872410094       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908894010772       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908895804406       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908889469511       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908891261933       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.406721e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908890871574       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908890871574       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908890871574       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908890871574       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908890871574       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908892261459       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908889270743       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908900678982       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908952080700       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909604019735       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909084206175       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908543615308       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908494323772       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907464358831       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909931891169       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910369021927       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.913155943371       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907640649795       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910149318151       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907224585052       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910664668305       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906891194587       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.901655324656       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914719213014       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.912948879603       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.907197795837       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905341729248       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906855712197       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907087513506       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910506338196       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.918394719124       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.870772209013       residual = 1.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.899454290706       residual = 9.06e-03           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.932490761713       residual = 7.81e-02           smallest_sin_value = 9.98e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 5.957958e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8877e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9743
    reference variance = 0.242005
====================================================
  Execution time = 2.2362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3286e-01
  Total weights = 2.0000e+06
  Execution time = 2.4677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407956486
  error estimate for blocks of size 2^( 2) =       0.000420302054
  error estimate for blocks of size 2^( 3) =       0.000432636316
  error estimate for blocks of size 2^( 4) =       0.000443872756
  error estimate for blocks of size 2^( 5) =       0.000453707876
  error estimate for blocks of size 2^( 6) =       0.000460108410
  error estimate for blocks of size 2^( 7) =       0.000463714265

      target function =                  N/A
              le_mean =     -16.910242703742
             les_mean =     286.289165121657
             stat err =       0.000455350827
             autocorr =       1.245846611026
              std dev =       0.576937595073
             le_variance =       0.332856988609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407956486
  error estimate for blocks of size 2^( 2) =       0.000420302054
  error estimate for blocks of size 2^( 3) =       0.000432636316
  error estimate for blocks of size 2^( 4) =       0.000443872756
  error estimate for blocks of size 2^( 5) =       0.000453707876
  error estimate for blocks of size 2^( 6) =       0.000460108410
  error estimate for blocks of size 2^( 7) =       0.000463714265

      target function =                  N/A
              le_mean =     -16.910242703742
             les_mean =     286.289165121657
             stat err =       0.000455350827
             autocorr =       1.245846611022
              std dev =       0.576937595074
             le_variance =       0.332856988609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407956486
  error estimate for blocks of size 2^( 2) =       0.000420302054
  error estimate for blocks of size 2^( 3) =       0.000432636316
  error estimate for blocks of size 2^( 4) =       0.000443872756
  error estimate for blocks of size 2^( 5) =       0.000453707876
  error estimate for blocks of size 2^( 6) =       0.000460108410
  error estimate for blocks of size 2^( 7) =       0.000463714265

      target function =                  N/A
              le_mean =     -16.910242703742
             les_mean =     286.289165121657
             stat err =       0.000455350827
             autocorr =       1.245846611029
              std dev =       0.576937595073
             le_variance =       0.332856988609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934102225
                                         uncertainty =       0.003896454095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407956486
  error estimate for blocks of size 2^( 2) =       0.000420302054
  error estimate for blocks of size 2^( 3) =       0.000432636316
  error estimate for blocks of size 2^( 4) =       0.000443872756
  error estimate for blocks of size 2^( 5) =       0.000453707876
  error estimate for blocks of size 2^( 6) =       0.000460108410
  error estimate for blocks of size 2^( 7) =       0.000463714265

      target function =                  N/A
              le_mean =     -16.910242703742
             les_mean =     286.289165121657
             stat err =       0.000455350827
             autocorr =       1.245846611028
              std dev =       0.576937595073
             le_variance =       0.332856988609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910242703742        initial  <--
     5.8208e+09     5.8208e+10             9.6525e-14       -16.910242703742
     2.3283e+10     2.3283e+11             2.4067e-14       -16.910242703742
     9.3132e+10     9.3132e+11             5.9580e-15       -16.910242703742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.8974
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.072413e-01 1 1  ON 0
 uu_1                 1.420440e-01 1 1  ON 1
 uu_2                 4.345520e-02 1 1  ON 2
 uu_3                -1.778299e-02 1 1  ON 3
 uu_4                -6.304916e-02 1 1  ON 4
 uu_5                -9.718932e-02 1 1  ON 5
 uu_6                -1.245021e-01 1 1  ON 6
 uu_7                -1.379397e-01 1 1  ON 7
 uu_8                -1.331485e-01 1 1  ON 8
 uu_9                -1.047980e-01 1 1  ON 9
 ud_0                 4.360136e-01 1 1  ON 10
 ud_1                 1.779836e-01 1 1  ON 11
 ud_2                 6.377024e-02 1 1  ON 12
 ud_3                -5.031134e-03 1 1  ON 13
 ud_4                -6.094499e-02 1 1  ON 14
 ud_5                -1.025859e-01 1 1  ON 15
 ud_6                -1.303650e-01 1 1  ON 16
 ud_7                -1.481794e-01 1 1  ON 17
 ud_8                -1.518383e-01 1 1  ON 18
 ud_9                -1.447710e-01 1 1  ON 19
 eO_0                -7.497588e-01 1 1  ON 20
 eO_1                -4.360971e-01 1 1  ON 21
 eO_2                -2.593328e-02 1 1  ON 22
 eO_3                 2.944289e-01 1 1  ON 23
 eO_4                 5.212463e-01 1 1  ON 24
 eO_5                 4.825035e-01 1 1  ON 25
 eO_6                 2.579470e-01 1 1  ON 26
 eO_7                -4.107653e-02 1 1  ON 27
 eO_8                -2.210815e-01 1 1  ON 28
 eO_9                -8.122647e-02 1 1  ON 29
eH1_0                -2.400168e-01 1 1  ON 30
eH1_1                -1.370434e-01 1 1  ON 31
eH1_2                -9.210022e-02 1 1  ON 32
eH1_3                -4.109808e-02 1 1  ON 33
eH1_4                 7.311880e-03 1 1  ON 34
eH1_5                 3.845027e-02 1 1  ON 35
eH1_6                 9.640333e-02 1 1  ON 36
eH1_7                 1.492293e-01 1 1  ON 37
eH1_8                 1.686298e-01 1 1  ON 38
eH1_9                 5.474761e-02 1 1  ON 39
eH2_0                -2.387105e-01 1 1  ON 40
eH2_1                -1.357871e-01 1 1  ON 41
eH2_2                -9.093170e-02 1 1  ON 42
eH2_3                -3.966624e-02 1 1  ON 43
eH2_4                 8.360463e-03 1 1  ON 44
eH2_5                 3.987545e-02 1 1  ON 45
eH2_6                 9.827038e-02 1 1  ON 46
eH2_7                 1.497509e-01 1 1  ON 47
eH2_8                 1.801325e-01 1 1  ON 48
eH2_9                 4.505643e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.3780e+01 secs
  Total Execution time = 2.5897e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
