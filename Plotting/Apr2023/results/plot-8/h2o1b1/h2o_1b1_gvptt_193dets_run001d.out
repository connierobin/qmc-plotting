Rank =    0  Free Memory = 74111 MB
Rank =    1  Free Memory = 74111 MB
Rank =    2  Free Memory = 74111 MB
Rank =    3  Free Memory = 74111 MB
Rank =    4  Free Memory = 74111 MB
Rank =    5  Free Memory = 74111 MB
Rank =    6  Free Memory = 74110 MB
Rank =    7  Free Memory = 74110 MB
Rank =    8  Free Memory = 74110 MB
Rank =    9  Free Memory = 74110 MB
Rank =   10  Free Memory = 74110 MB
Rank =   11  Free Memory = 74110 MB
Rank =   12  Free Memory = 74110 MB
Rank =   13  Free Memory = 74110 MB
Rank =   14  Free Memory = 74109 MB
Rank =   15  Free Memory = 74096 MB
Rank =   16  Free Memory = 74095 MB
Rank =   17  Free Memory = 74095 MB
Rank =   18  Free Memory = 74095 MB
Rank =   19  Free Memory = 74095 MB
Rank =   20  Free Memory = 74095 MB
Rank =   21  Free Memory = 74095 MB
Rank =   22  Free Memory = 74095 MB
Rank =   23  Free Memory = 74095 MB
Rank =   24  Free Memory = 74095 MB
Rank =   25  Free Memory = 74095 MB
Rank =   26  Free Memory = 74095 MB
Rank =   27  Free Memory = 74095 MB
Rank =   28  Free Memory = 74095 MB
Rank =   29  Free Memory = 74095 MB
Rank =   30  Free Memory = 74095 MB
Rank =   31  Free Memory = 74095 MB
Rank =   32  Free Memory = 74309 MB
Rank =   33  Free Memory = 74309 MB
Rank =   34  Free Memory = 74309 MB
Rank =   35  Free Memory = 74309 MB
Rank =   36  Free Memory = 74309 MB
Rank =   37  Free Memory = 74309 MB
Rank =   38  Free Memory = 74309 MB
Rank =   39  Free Memory = 74309 MB
Rank =   40  Free Memory = 74309 MB
Rank =   41  Free Memory = 74309 MB
Rank =   42  Free Memory = 74309 MB
Rank =   43  Free Memory = 74309 MB
Rank =   44  Free Memory = 74309 MB
Rank =   45  Free Memory = 74309 MB
Rank =   46  Free Memory = 74309 MB
Rank =   47  Free Memory = 74309 MB
Rank =   48  Free Memory = 74309 MB
Rank =   49  Free Memory = 74309 MB
Rank =   50  Free Memory = 74309 MB
Rank =   51  Free Memory = 74309 MB
Rank =   52  Free Memory = 74309 MB
Rank =   53  Free Memory = 74309 MB
Rank =   54  Free Memory = 74309 MB
Rank =   55  Free Memory = 74309 MB
Rank =   56  Free Memory = 74309 MB
Rank =   57  Free Memory = 74309 MB
Rank =   58  Free Memory = 74309 MB
Rank =   59  Free Memory = 74309 MB
Rank =   60  Free Memory = 74309 MB
Rank =   61  Free Memory = 74309 MB
Rank =   62  Free Memory = 74309 MB
Rank =   63  Free Memory = 74309 MB
Rank =   64  Free Memory = 64500 MB
Rank =   65  Free Memory = 64500 MB
Rank =   66  Free Memory = 64500 MB
Rank =   67  Free Memory = 64500 MB
Rank =   68  Free Memory = 64500 MB
Rank =   69  Free Memory = 64500 MB
Rank =   70  Free Memory = 64500 MB
Rank =   71  Free Memory = 64500 MB
Rank =   72  Free Memory = 64500 MB
Rank =   73  Free Memory = 64500 MB
Rank =   74  Free Memory = 64500 MB
Rank =   75  Free Memory = 64500 MB
Rank =   76  Free Memory = 64500 MB
Rank =   77  Free Memory = 64500 MB
Rank =   78  Free Memory = 64500 MB
Rank =   79  Free Memory = 64500 MB
Rank =   80  Free Memory = 64500 MB
Rank =   81  Free Memory = 64500 MB
Rank =   82  Free Memory = 64500 MB
Rank =   83  Free Memory = 64500 MB
Rank =   84  Free Memory = 64500 MB
Rank =   85  Free Memory = 64500 MB
Rank =   86  Free Memory = 64500 MB
Rank =   87  Free Memory = 64500 MB
Rank =   88  Free Memory = 64500 MB
Rank =   89  Free Memory = 64500 MB
Rank =   90  Free Memory = 64500 MB
Rank =   91  Free Memory = 64500 MB
Rank =   92  Free Memory = 64500 MB
Rank =   93  Free Memory = 64500 MB
Rank =   94  Free Memory = 64500 MB
Rank =   95  Free Memory = 64500 MB
Rank =   96  Free Memory = 74562 MB
Rank =   97  Free Memory = 74562 MB
Rank =   98  Free Memory = 74562 MB
Rank =   99  Free Memory = 74562 MB
Rank =  100  Free Memory = 74562 MB
Rank =  101  Free Memory = 74561 MB
Rank =  102  Free Memory = 74561 MB
Rank =  103  Free Memory = 74561 MB
Rank =  104  Free Memory = 74561 MB
Rank =  105  Free Memory = 74561 MB
Rank =  106  Free Memory = 74561 MB
Rank =  107  Free Memory = 74561 MB
Rank =  108  Free Memory = 74561 MB
Rank =  109  Free Memory = 74561 MB
Rank =  110  Free Memory = 74561 MB
Rank =  111  Free Memory = 74561 MB
Rank =  112  Free Memory = 74561 MB
Rank =  113  Free Memory = 74561 MB
Rank =  114  Free Memory = 74561 MB
Rank =  115  Free Memory = 74561 MB
Rank =  116  Free Memory = 74561 MB
Rank =  117  Free Memory = 74561 MB
Rank =  118  Free Memory = 74561 MB
Rank =  119  Free Memory = 74561 MB
Rank =  120  Free Memory = 74561 MB
Rank =  121  Free Memory = 74561 MB
Rank =  122  Free Memory = 74561 MB
Rank =  123  Free Memory = 74561 MB
Rank =  124  Free Memory = 74561 MB
Rank =  125  Free Memory = 74561 MB
Rank =  126  Free Memory = 74561 MB
Rank =  127  Free Memory = 74561 MB
  Input file(s): opt_h2o_1b1_gvptt_193dets_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_193dets_run001d.xml

  Project = H2O
  date    = 2023-05-11 15:37:37 PDT
  host    = n0052.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 561

  Range of prime numbers to use as seeds over processors and threads = 4091-5189


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.073599e-01    1         1  ON     0
     uu_1                 1.420582e-01    1         1  ON     1
     uu_2                 4.330029e-02    1         1  ON     2
     uu_3                -1.792830e-02    1         1  ON     3
     uu_4                -6.302088e-02    1         1  ON     4
     uu_5                -9.703376e-02    1         1  ON     5
     uu_6                -1.244021e-01    1         1  ON     6
     uu_7                -1.378205e-01    1         1  ON     7
     uu_8                -1.332661e-01    1         1  ON     8
     uu_9                -1.047467e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.352246e-01    1         1  ON     0
     ud_1                 1.774307e-01    1         1  ON     1
     ud_2                 6.417733e-02    1         1  ON     2
     ud_3                -4.449364e-03    1         1  ON     3
     ud_4                -6.087788e-02    1         1  ON     4
     ud_5                -1.024855e-01    1         1  ON     5
     ud_6                -1.302101e-01    1         1  ON     6
     ud_7                -1.481119e-01    1         1  ON     7
     ud_8                -1.519364e-01    1         1  ON     8
     ud_9                -1.447780e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.492772e-01    1         1  ON     0
     eO_1                -4.362109e-01    1         1  ON     1
     eO_2                -2.590890e-02    1         1  ON     2
     eO_3                 2.940511e-01    1         1  ON     3
     eO_4                 5.211018e-01    1         1  ON     4
     eO_5                 4.823945e-01    1         1  ON     5
     eO_6                 2.579444e-01    1         1  ON     6
     eO_7                -4.117663e-02    1         1  ON     7
     eO_8                -2.209626e-01    1         1  ON     8
     eO_9                -8.103542e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.394862e-01    1         1  ON     0
     eH1_1                -1.368277e-01    1         1  ON     1
     eH1_2                -9.227866e-02    1         1  ON     2
     eH1_3                -4.109925e-02    1         1  ON     3
     eH1_4                 7.320912e-03    1         1  ON     4
     eH1_5                 3.840612e-02    1         1  ON     5
     eH1_6                 9.633868e-02    1         1  ON     6
     eH1_7                 1.491633e-01    1         1  ON     7
     eH1_8                 1.684376e-01    1         1  ON     8
     eH1_9                 5.453875e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.382335e-01    1         1  ON     0
     eH2_1                -1.355712e-01    1         1  ON     1
     eH2_2                -9.110400e-02    1         1  ON     2
     eH2_3                -3.967049e-02    1         1  ON     3
     eH2_4                 8.332838e-03    1         1  ON     4
     eH2_5                 3.989858e-02    1         1  ON     5
     eH2_6                 9.819831e-02    1         1  ON     6
     eH2_7                 1.497039e-01    1         1  ON     7
     eH2_8                 1.800191e-01    1         1  ON     8
     eH2_9                 4.478678e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 193 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.559549e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 57 unique up determinants.
Found 57 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9140e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9301
    reference variance = 0.22398
====================================================
  Execution time = 4.6396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3279e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1821e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332846233886
                                         uncertainty =       0.003357504929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332846233886
                                         uncertainty =       0.003357504929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407917105
  error estimate for blocks of size 2^( 2) =       0.000419594526
  error estimate for blocks of size 2^( 3) =       0.000431863348
  error estimate for blocks of size 2^( 4) =       0.000443798314
  error estimate for blocks of size 2^( 5) =       0.000455534864
  error estimate for blocks of size 2^( 6) =       0.000462293992
  error estimate for blocks of size 2^( 7) =       0.000467660433

      target function =                  N/A
              le_mean =     -16.910595854315
             les_mean =     286.301044710203
             stat err =       0.000457321900
             autocorr =       1.256898379509
              std dev =       0.576881901789
             le_variance =       0.332792728612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691059585432e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910595854315       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910618268934       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910615368408       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910616875081       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910620163477       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910620758441       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910618807017       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910617955969       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910618101135       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910618136435       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910618323032       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.642201e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910595854315       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910604472179       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910603450067       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910603544001       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910604436296       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910604882312       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910604510170       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910604166346       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910604236732       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.266064e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910595854315       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910598343514       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910598086693       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910598072980       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910598215991       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910598391641       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910598320813       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910598239397       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910598252161       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.476668e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8306e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.073532e-01                 1 1 ON  0
uu_1  1.420641e-01                 1 1 ON  1
uu_2  4.340723e-02                 1 1 ON  2
uu_3  -1.779593e-02                1 1 ON  3
uu_4  -6.299781e-02                1 1 ON  4
uu_5  -9.723325e-02                1 1 ON  5
uu_6  -1.245507e-01                1 1 ON  6
uu_7  -1.379772e-01                1 1 ON  7
uu_8  -1.333007e-01                1 1 ON  8
uu_9  -1.047222e-01                1 1 ON  9
ud_0  4.357512e-01                 1 1 ON  10
ud_1  1.778876e-01                 1 1 ON  11
ud_2  6.383136e-02                 1 1 ON  12
ud_3  -4.924211e-03                1 1 ON  13
ud_4  -6.095423e-02                1 1 ON  14
ud_5  -1.024775e-01                1 1 ON  15
ud_6  -1.302499e-01                1 1 ON  16
ud_7  -1.483317e-01                1 1 ON  17
ud_8  -1.518930e-01                1 1 ON  18
ud_9  -1.446691e-01                1 1 ON  19
eO_0  -7.497285e-01                1 1 ON  20
eO_1  -4.361432e-01                1 1 ON  21
eO_2  -2.578084e-02                1 1 ON  22
eO_3  2.943583e-01                 1 1 ON  23
eO_4  5.210862e-01                 1 1 ON  24
eO_5  4.825068e-01                 1 1 ON  25
eO_6  2.580275e-01                 1 1 ON  26
eO_7  -4.121784e-02                1 1 ON  27
eO_8  -2.210527e-01                1 1 ON  28
eO_9  -8.113513e-02                1 1 ON  29
eH1_0 -2.399574e-01                1 1 ON  30
eH1_1 -1.369614e-01                1 1 ON  31
eH1_2 -9.213802e-02                1 1 ON  32
eH1_3 -4.109423e-02                1 1 ON  33
eH1_4 7.410547e-03                 1 1 ON  34
eH1_5 3.846316e-02                 1 1 ON  35
eH1_6 9.624000e-02                 1 1 ON  36
eH1_7 1.491885e-01                 1 1 ON  37
eH1_8 1.685947e-01                 1 1 ON  38
eH1_9 5.472671e-02                 1 1 ON  39
eH2_0 -2.386244e-01                1 1 ON  40
eH2_1 -1.357019e-01                1 1 ON  41
eH2_2 -9.106700e-02                1 1 ON  42
eH2_3 -3.968678e-02                1 1 ON  43
eH2_4 8.299236e-03                 1 1 ON  44
eH2_5 3.985063e-02                 1 1 ON  45
eH2_6 9.826159e-02                 1 1 ON  46
eH2_7 1.498540e-01                 1 1 ON  47
eH2_8 1.801243e-01                 1 1 ON  48
eH2_9 4.500353e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8598
    reference variance = 0.182351
====================================================
  Execution time = 4.4294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3322e-01
  Total weights = 2.0000e+06
  Execution time = 4.8321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332843585273
                                         uncertainty =       0.004488586416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332843585273
                                         uncertainty =       0.004488586416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407945270
  error estimate for blocks of size 2^( 2) =       0.000420100182
  error estimate for blocks of size 2^( 3) =       0.000432543627
  error estimate for blocks of size 2^( 4) =       0.000444387896
  error estimate for blocks of size 2^( 5) =       0.000455243101
  error estimate for blocks of size 2^( 6) =       0.000463574810
  error estimate for blocks of size 2^( 7) =       0.000470116188

      target function =                  N/A
              le_mean =     -16.908918735846
             les_mean =     286.244371335013
             stat err =       0.000458330499
             autocorr =       1.262274219719
              std dev =       0.576921732975
             le_variance =       0.332838685979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333935142252
                                         uncertainty =       0.004508166444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333935142252
                                         uncertainty =       0.004508166444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408613805
  error estimate for blocks of size 2^( 2) =       0.000420703068
  error estimate for blocks of size 2^( 3) =       0.000433069552
  error estimate for blocks of size 2^( 4) =       0.000444864045
  error estimate for blocks of size 2^( 5) =       0.000455718692
  error estimate for blocks of size 2^( 6) =       0.000464049069
  error estimate for blocks of size 2^( 7) =       0.000470514236

      target function =                  N/A
              le_mean =     -16.908909283792
             les_mean =     286.245143483239
             stat err =       0.000458786511
             autocorr =       1.260651981592
              std dev =       0.577867184303
             le_variance =       0.333930482694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333624155009
                                         uncertainty =       0.004503015304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333624155009
                                         uncertainty =       0.004503015304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408423517
  error estimate for blocks of size 2^( 2) =       0.000420525511
  error estimate for blocks of size 2^( 3) =       0.000432907000
  error estimate for blocks of size 2^( 4) =       0.000444712316
  error estimate for blocks of size 2^( 5) =       0.000455568586
  error estimate for blocks of size 2^( 6) =       0.000463900469
  error estimate for blocks of size 2^( 7) =       0.000470378413

      target function =                  N/A
              le_mean =     -16.908910638845
             les_mean =     286.244878364645
             stat err =       0.000458639946
             autocorr =       1.261020865249
              std dev =       0.577598077384
             le_variance =       0.333619538997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332943871127
                                         uncertainty =       0.004490611787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332943871127
                                         uncertainty =       0.004490611787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408006753
  error estimate for blocks of size 2^( 2) =       0.000420153285
  error estimate for blocks of size 2^( 3) =       0.000432587074
  error estimate for blocks of size 2^( 4) =       0.000444425432
  error estimate for blocks of size 2^( 5) =       0.000455280814
  error estimate for blocks of size 2^( 6) =       0.000463612538
  error estimate for blocks of size 2^( 7) =       0.000470144240

      target function =                  N/A
              le_mean =     -16.908916353042
             les_mean =     286.244391088722
             stat err =       0.000458365756
             autocorr =       1.262087969093
              std dev =       0.577008683654
             le_variance =       0.332939021012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908918735846        initial  <--
     2.5000e-01     2.5000e+00             1.6422e-03       -16.908909283792
     1.0000e+00     1.0000e+01             5.2661e-04       -16.908910638845
     4.0000e+00     4.0000e+01             1.4767e-04       -16.908916353042

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.5437
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302088e-02 1 1  ON 4
 uu_5                -9.703376e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449364e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320912e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332838e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2689e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8409
    reference variance = 0.245026
====================================================
  Execution time = 4.6199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3169e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1959e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331759250647
                                         uncertainty =       0.005940592675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331759250647
                                         uncertainty =       0.005940592675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407241977
  error estimate for blocks of size 2^( 2) =       0.000419695915
  error estimate for blocks of size 2^( 3) =       0.000432583978
  error estimate for blocks of size 2^( 4) =       0.000445242537
  error estimate for blocks of size 2^( 5) =       0.000456767094
  error estimate for blocks of size 2^( 6) =       0.000468092513
  error estimate for blocks of size 2^( 7) =       0.000473910713

      target function =                  N/A
              le_mean =     -16.909984039224
             les_mean =     286.279252096323
             stat err =       0.000461003214
             autocorr =       1.281453445447
              std dev =       0.575927126783
             le_variance =       0.331692055364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690998403922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909984039224       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909989214892       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909991869072       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909992243134       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909992057636       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909992124913       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909992381580       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909992395117       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909992388053       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.250665e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909984039224       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909985414782       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909986159837       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909986275332       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909986219563       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909986224927       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909986291576       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909986301889       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909986296826       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.868888e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909984039224       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909984388625       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909984580768       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909984611339       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909984596949       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909984597187       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909984613900       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909984617084       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909984615563       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.483886e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8166e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.073422e-01 1 1  ON 0
 uu_1                 1.420534e-01 1 1  ON 1
 uu_2                 4.331622e-02 1 1  ON 2
 uu_3                -1.791920e-02 1 1  ON 3
 uu_4                -6.302618e-02 1 1  ON 4
 uu_5                -9.705797e-02 1 1  ON 5
 uu_6                -1.244016e-01 1 1  ON 6
 uu_7                -1.378342e-01 1 1  ON 7
 uu_8                -1.332477e-01 1 1  ON 8
 uu_9                -1.047399e-01 1 1  ON 9
 ud_0                 4.352798e-01 1 1  ON 10
 ud_1                 1.774848e-01 1 1  ON 11
 ud_2                 6.412912e-02 1 1  ON 12
 ud_3                -4.501441e-03 1 1  ON 13
 ud_4                -6.088527e-02 1 1  ON 14
 ud_5                -1.024887e-01 1 1  ON 15
 ud_6                -1.302232e-01 1 1  ON 16
 ud_7                -1.481195e-01 1 1  ON 17
 ud_8                -1.519171e-01 1 1  ON 18
 ud_9                -1.447693e-01 1 1  ON 19
 eO_0                -7.493359e-01 1 1  ON 20
 eO_1                -4.362083e-01 1 1  ON 21
 eO_2                -2.589946e-02 1 1  ON 22
 eO_3                 2.940863e-01 1 1  ON 23
 eO_4                 5.211133e-01 1 1  ON 24
 eO_5                 4.823999e-01 1 1  ON 25
 eO_6                 2.579482e-01 1 1  ON 26
 eO_7                -4.116095e-02 1 1  ON 27
 eO_8                -2.209685e-01 1 1  ON 28
 eO_9                -8.105105e-02 1 1  ON 29
eH1_0                -2.395281e-01 1 1  ON 30
eH1_1                -1.368417e-01 1 1  ON 31
eH1_2                -9.226952e-02 1 1  ON 32
eH1_3                -4.109117e-02 1 1  ON 33
eH1_4                 7.318424e-03 1 1  ON 34
eH1_5                 3.840945e-02 1 1  ON 35
eH1_6                 9.633887e-02 1 1  ON 36
eH1_7                 1.491649e-01 1 1  ON 37
eH1_8                 1.684567e-01 1 1  ON 38
eH1_9                 5.455696e-02 1 1  ON 39
eH2_0                -2.382858e-01 1 1  ON 40
eH2_1                -1.355893e-01 1 1  ON 41
eH2_2                -9.109008e-02 1 1  ON 42
eH2_3                -3.967583e-02 1 1  ON 43
eH2_4                 8.337642e-03 1 1  ON 44
eH2_5                 3.990246e-02 1 1  ON 45
eH2_6                 9.820081e-02 1 1  ON 46
eH2_7                 1.497094e-01 1 1  ON 47
eH2_8                 1.800361e-01 1 1  ON 48
eH2_9                 4.481275e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8892
    reference variance = 0.196816
====================================================
  Execution time = 4.4532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4063e-01
  Total weights = 2.0000e+06
  Execution time = 4.8353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340712460075
                                         uncertainty =       0.009245677394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340712460075
                                         uncertainty =       0.009245677394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412674185
  error estimate for blocks of size 2^( 2) =       0.000424548069
  error estimate for blocks of size 2^( 3) =       0.000436926230
  error estimate for blocks of size 2^( 4) =       0.000448880548
  error estimate for blocks of size 2^( 5) =       0.000458786815
  error estimate for blocks of size 2^( 6) =       0.000466830568
  error estimate for blocks of size 2^( 7) =       0.000473415402

      target function =                  N/A
              le_mean =     -16.909858664211
             les_mean =     286.283919838636
             stat err =       0.000461978334
             autocorr =       1.253223736675
              std dev =       0.583609428763
             le_variance =       0.340599965341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340840849821
                                         uncertainty =       0.009237399793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340840849821
                                         uncertainty =       0.009237399793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412751893
  error estimate for blocks of size 2^( 2) =       0.000424615692
  error estimate for blocks of size 2^( 3) =       0.000436982247
  error estimate for blocks of size 2^( 4) =       0.000448931928
  error estimate for blocks of size 2^( 5) =       0.000458831877
  error estimate for blocks of size 2^( 6) =       0.000466873537
  error estimate for blocks of size 2^( 7) =       0.000473453295

      target function =                  N/A
              le_mean =     -16.909857578111
             les_mean =     286.284011392614
             stat err =       0.000462022659
             autocorr =       1.252992301410
              std dev =       0.583719325507
             le_variance =       0.340728250970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777115756
                                         uncertainty =       0.009240915079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340777115756
                                         uncertainty =       0.009240915079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412713317
  error estimate for blocks of size 2^( 2) =       0.000424581745
  error estimate for blocks of size 2^( 3) =       0.000436953585
  error estimate for blocks of size 2^( 4) =       0.000448905373
  error estimate for blocks of size 2^( 5) =       0.000458808160
  error estimate for blocks of size 2^( 6) =       0.000466850751
  error estimate for blocks of size 2^( 7) =       0.000473432750

      target function =                  N/A
              le_mean =     -16.909857944720
             les_mean =     286.283960104224
             stat err =       0.000461999258
             autocorr =       1.253099602231
              std dev =       0.583664770164
             le_variance =       0.340664563930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340720443834
                                         uncertainty =       0.009245058098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340720443834
                                         uncertainty =       0.009245058098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412679017
  error estimate for blocks of size 2^( 2) =       0.000424552199
  error estimate for blocks of size 2^( 3) =       0.000436929548
  error estimate for blocks of size 2^( 4) =       0.000448883541
  error estimate for blocks of size 2^( 5) =       0.000458789360
  error estimate for blocks of size 2^( 6) =       0.000466832964
  error estimate for blocks of size 2^( 7) =       0.000473417433

      target function =                  N/A
              le_mean =     -16.909858555184
             les_mean =     286.283924127827
             stat err =       0.000461980825
             autocorr =       1.253207902908
              std dev =       0.583616262443
             le_variance =       0.340607941788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909858664211        initial  <--
     2.5000e+00     2.5000e+01             2.2507e-04       -16.909857578111
     1.0000e+01     1.0000e+02             5.8689e-05       -16.909857944720
     4.0000e+01     4.0000e+02             1.4839e-05       -16.909858555184

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.8060
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.073599e-01 1 1  ON 0
 uu_1                 1.420582e-01 1 1  ON 1
 uu_2                 4.330029e-02 1 1  ON 2
 uu_3                -1.792830e-02 1 1  ON 3
 uu_4                -6.302088e-02 1 1  ON 4
 uu_5                -9.703376e-02 1 1  ON 5
 uu_6                -1.244021e-01 1 1  ON 6
 uu_7                -1.378205e-01 1 1  ON 7
 uu_8                -1.332661e-01 1 1  ON 8
 uu_9                -1.047467e-01 1 1  ON 9
 ud_0                 4.352246e-01 1 1  ON 10
 ud_1                 1.774307e-01 1 1  ON 11
 ud_2                 6.417733e-02 1 1  ON 12
 ud_3                -4.449364e-03 1 1  ON 13
 ud_4                -6.087788e-02 1 1  ON 14
 ud_5                -1.024855e-01 1 1  ON 15
 ud_6                -1.302101e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519364e-01 1 1  ON 18
 ud_9                -1.447780e-01 1 1  ON 19
 eO_0                -7.492772e-01 1 1  ON 20
 eO_1                -4.362109e-01 1 1  ON 21
 eO_2                -2.590890e-02 1 1  ON 22
 eO_3                 2.940511e-01 1 1  ON 23
 eO_4                 5.211018e-01 1 1  ON 24
 eO_5                 4.823945e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117663e-02 1 1  ON 27
 eO_8                -2.209626e-01 1 1  ON 28
 eO_9                -8.103542e-02 1 1  ON 29
eH1_0                -2.394862e-01 1 1  ON 30
eH1_1                -1.368277e-01 1 1  ON 31
eH1_2                -9.227866e-02 1 1  ON 32
eH1_3                -4.109925e-02 1 1  ON 33
eH1_4                 7.320912e-03 1 1  ON 34
eH1_5                 3.840612e-02 1 1  ON 35
eH1_6                 9.633868e-02 1 1  ON 36
eH1_7                 1.491633e-01 1 1  ON 37
eH1_8                 1.684376e-01 1 1  ON 38
eH1_9                 5.453875e-02 1 1  ON 39
eH2_0                -2.382335e-01 1 1  ON 40
eH2_1                -1.355712e-01 1 1  ON 41
eH2_2                -9.110400e-02 1 1  ON 42
eH2_3                -3.967049e-02 1 1  ON 43
eH2_4                 8.332838e-03 1 1  ON 44
eH2_5                 3.989858e-02 1 1  ON 45
eH2_6                 9.819831e-02 1 1  ON 46
eH2_7                 1.497039e-01 1 1  ON 47
eH2_8                 1.800191e-01 1 1  ON 48
eH2_9                 4.478678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2698e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.148672
====================================================
  Execution time = 4.5394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1922e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320795828145
                                         uncertainty =       0.002666910923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320795828145
                                         uncertainty =       0.002666910923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400426425
  error estimate for blocks of size 2^( 2) =       0.000412627488
  error estimate for blocks of size 2^( 3) =       0.000425214170
  error estimate for blocks of size 2^( 4) =       0.000437057487
  error estimate for blocks of size 2^( 5) =       0.000447642619
  error estimate for blocks of size 2^( 6) =       0.000453994310
  error estimate for blocks of size 2^( 7) =       0.000457407072

      target function =                  N/A
              le_mean =     -16.910383033816
             les_mean =     286.281736833649
             stat err =       0.000449025372
             autocorr =       1.257466152497
              std dev =       0.566288480914
             le_variance =       0.320682643616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691038303382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910383033816       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910383417707       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910383490352       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910383507131       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910383539129       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910383613684       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910383603085       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910383615491       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910383614298       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.901775e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910383033816       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910383130420       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910383148925       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910383153207       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910383161174       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910383179973       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910383177180       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910383180284       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910383180045       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 7.278005e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910383033816       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910383058007       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910383062655       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910383063731       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910383065721       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910383070431       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910383069723       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910383070499       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910383070443       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 1.820923e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7324e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.073603e-01 1 1  ON 0
 uu_1                 1.420571e-01 1 1  ON 1
 uu_2                 4.330225e-02 1 1  ON 2
 uu_3                -1.792639e-02 1 1  ON 3
 uu_4                -6.302143e-02 1 1  ON 4
 uu_5                -9.703397e-02 1 1  ON 5
 uu_6                -1.244031e-01 1 1  ON 6
 uu_7                -1.378228e-01 1 1  ON 7
 uu_8                -1.332655e-01 1 1  ON 8
 uu_9                -1.047474e-01 1 1  ON 9
 ud_0                 4.352319e-01 1 1  ON 10
 ud_1                 1.774369e-01 1 1  ON 11
 ud_2                 6.417249e-02 1 1  ON 12
 ud_3                -4.454827e-03 1 1  ON 13
 ud_4                -6.087759e-02 1 1  ON 14
 ud_5                -1.024860e-01 1 1  ON 15
 ud_6                -1.302114e-01 1 1  ON 16
 ud_7                -1.481119e-01 1 1  ON 17
 ud_8                -1.519359e-01 1 1  ON 18
 ud_9                -1.447787e-01 1 1  ON 19
 eO_0                -7.492811e-01 1 1  ON 20
 eO_1                -4.362113e-01 1 1  ON 21
 eO_2                -2.590723e-02 1 1  ON 22
 eO_3                 2.940546e-01 1 1  ON 23
 eO_4                 5.211019e-01 1 1  ON 24
 eO_5                 4.823955e-01 1 1  ON 25
 eO_6                 2.579444e-01 1 1  ON 26
 eO_7                -4.117554e-02 1 1  ON 27
 eO_8                -2.209638e-01 1 1  ON 28
 eO_9                -8.103711e-02 1 1  ON 29
eH1_0                -2.394901e-01 1 1  ON 30
eH1_1                -1.368290e-01 1 1  ON 31
eH1_2                -9.227707e-02 1 1  ON 32
eH1_3                -4.109859e-02 1 1  ON 33
eH1_4                 7.321236e-03 1 1  ON 34
eH1_5                 3.840586e-02 1 1  ON 35
eH1_6                 9.633828e-02 1 1  ON 36
eH1_7                 1.491632e-01 1 1  ON 37
eH1_8                 1.684391e-01 1 1  ON 38
eH1_9                 5.454056e-02 1 1  ON 39
eH2_0                -2.382376e-01 1 1  ON 40
eH2_1                -1.355732e-01 1 1  ON 41
eH2_2                -9.110223e-02 1 1  ON 42
eH2_3                -3.967117e-02 1 1  ON 43
eH2_4                 8.333226e-03 1 1  ON 44
eH2_5                 3.989806e-02 1 1  ON 45
eH2_6                 9.819877e-02 1 1  ON 46
eH2_7                 1.497043e-01 1 1  ON 47
eH2_8                 1.800207e-01 1 1  ON 48
eH2_9                 4.478927e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9938
    reference variance = 0.329707
====================================================
  Execution time = 4.4497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4876e-01
  Total weights = 2.0000e+06
  Execution time = 4.8478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348900198532
                                         uncertainty =       0.011188315016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348900198532
                                         uncertainty =       0.011188315016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417584067
  error estimate for blocks of size 2^( 2) =       0.000429251411
  error estimate for blocks of size 2^( 3) =       0.000441851646
  error estimate for blocks of size 2^( 4) =       0.000453150976
  error estimate for blocks of size 2^( 5) =       0.000462982790
  error estimate for blocks of size 2^( 6) =       0.000470617104
  error estimate for blocks of size 2^( 7) =       0.000472879224

      target function =                  N/A
              le_mean =     -16.910457648805
             les_mean =     286.312330623368
             stat err =       0.000464907523
             autocorr =       1.239496513613
              std dev =       0.590553050719
             le_variance =       0.348752905713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348920684752
                                         uncertainty =       0.011190317619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348920684752
                                         uncertainty =       0.011190317619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417596326
  error estimate for blocks of size 2^( 2) =       0.000429262188
  error estimate for blocks of size 2^( 3) =       0.000441861225
  error estimate for blocks of size 2^( 4) =       0.000453159297
  error estimate for blocks of size 2^( 5) =       0.000462990722
  error estimate for blocks of size 2^( 6) =       0.000470625184
  error estimate for blocks of size 2^( 7) =       0.000472887514

      target function =                  N/A
              le_mean =     -16.910457765609
             les_mean =     286.312355050773
             stat err =       0.000464915679
             autocorr =       1.239467225896
              std dev =       0.590570387590
             le_variance =       0.348773382699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348910476229
                                         uncertainty =       0.011189325055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348910476229
                                         uncertainty =       0.011189325055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417590217
  error estimate for blocks of size 2^( 2) =       0.000429256813
  error estimate for blocks of size 2^( 3) =       0.000441856445
  error estimate for blocks of size 2^( 4) =       0.000453155139
  error estimate for blocks of size 2^( 5) =       0.000462986759
  error estimate for blocks of size 2^( 6) =       0.000470621147
  error estimate for blocks of size 2^( 7) =       0.000472883371

      target function =                  N/A
              le_mean =     -16.910457705621
             les_mean =     286.312342818029
             stat err =       0.000464911604
             autocorr =       1.239481760234
              std dev =       0.590561748510
             le_variance =       0.348763178804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348901483466
                                         uncertainty =       0.011188441544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348901483466
                                         uncertainty =       0.011188441544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417584836
  error estimate for blocks of size 2^( 2) =       0.000429252086
  error estimate for blocks of size 2^( 3) =       0.000441852246
  error estimate for blocks of size 2^( 4) =       0.000453151496
  error estimate for blocks of size 2^( 5) =       0.000462983285
  error estimate for blocks of size 2^( 6) =       0.000470617608
  error estimate for blocks of size 2^( 7) =       0.000472879742

      target function =                  N/A
              le_mean =     -16.910457655711
             les_mean =     286.312332141272
             stat err =       0.000464908033
             autocorr =       1.239494665463
              std dev =       0.590554138137
             le_variance =       0.348754190071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910457648805        initial
     2.5000e+01     2.5000e+02             2.9018e-05       -16.910457765609  <--
     1.0000e+02     1.0000e+03             7.2780e-06       -16.910457705621
     4.0000e+02     4.0000e+03             1.8209e-06       -16.910457655711

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 6.8826e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.073612e-01 1 1  ON 0
 uu_1                 1.420540e-01 1 1  ON 1
 uu_2                 4.330805e-02 1 1  ON 2
 uu_3                -1.792069e-02 1 1  ON 3
 uu_4                -6.302303e-02 1 1  ON 4
 uu_5                -9.703462e-02 1 1  ON 5
 uu_6                -1.244061e-01 1 1  ON 6
 uu_7                -1.378297e-01 1 1  ON 7
 uu_8                -1.332638e-01 1 1  ON 8
 uu_9                -1.047494e-01 1 1  ON 9
 ud_0                 4.352536e-01 1 1  ON 10
 ud_1                 1.774553e-01 1 1  ON 11
 ud_2                 6.415827e-02 1 1  ON 12
 ud_3                -4.471106e-03 1 1  ON 13
 ud_4                -6.087684e-02 1 1  ON 14
 ud_5                -1.024876e-01 1 1  ON 15
 ud_6                -1.302152e-01 1 1  ON 16
 ud_7                -1.481121e-01 1 1  ON 17
 ud_8                -1.519343e-01 1 1  ON 18
 ud_9                -1.447808e-01 1 1  ON 19
 eO_0                -7.492925e-01 1 1  ON 20
 eO_1                -4.362124e-01 1 1  ON 21
 eO_2                -2.590228e-02 1 1  ON 22
 eO_3                 2.940650e-01 1 1  ON 23
 eO_4                 5.211021e-01 1 1  ON 24
 eO_5                 4.823986e-01 1 1  ON 25
 eO_6                 2.579443e-01 1 1  ON 26
 eO_7                -4.117226e-02 1 1  ON 27
 eO_8                -2.209671e-01 1 1  ON 28
 eO_9                -8.104217e-02 1 1  ON 29
eH1_0                -2.395018e-01 1 1  ON 30
eH1_1                -1.368328e-01 1 1  ON 31
eH1_2                -9.227233e-02 1 1  ON 32
eH1_3                -4.109661e-02 1 1  ON 33
eH1_4                 7.322196e-03 1 1  ON 34
eH1_5                 3.840509e-02 1 1  ON 35
eH1_6                 9.633709e-02 1 1  ON 36
eH1_7                 1.491628e-01 1 1  ON 37
eH1_8                 1.684438e-01 1 1  ON 38
eH1_9                 5.454597e-02 1 1  ON 39
eH2_0                -2.382499e-01 1 1  ON 40
eH2_1                -1.355791e-01 1 1  ON 41
eH2_2                -9.109696e-02 1 1  ON 42
eH2_3                -3.967317e-02 1 1  ON 43
eH2_4                 8.334356e-03 1 1  ON 44
eH2_5                 3.989653e-02 1 1  ON 45
eH2_6                 9.820016e-02 1 1  ON 46
eH2_7                 1.497055e-01 1 1  ON 47
eH2_8                 1.800258e-01 1 1  ON 48
eH2_9                 4.479676e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2616e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9055
    reference variance = 0.182681
====================================================
  Execution time = 4.5285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3416e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1988e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334322522405
                                         uncertainty =       0.003836054518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334322522405
                                         uncertainty =       0.003836054518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408755663
  error estimate for blocks of size 2^( 2) =       0.000421090071
  error estimate for blocks of size 2^( 3) =       0.000433215693
  error estimate for blocks of size 2^( 4) =       0.000443850766
  error estimate for blocks of size 2^( 5) =       0.000453311165
  error estimate for blocks of size 2^( 6) =       0.000460735174
  error estimate for blocks of size 2^( 7) =       0.000465956267

      target function =                  N/A
              le_mean =     -16.910003389310
             les_mean =     286.282376843459
             stat err =       0.000455963343
             autocorr =       1.244320605784
              std dev =       0.578067802294
             le_variance =       0.334162384049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691000338931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910003389310       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910004259304       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910004977583       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910004991107       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910004918532       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910005094501       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910004992561       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910005039154       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910005029076       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 8.610630e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910003389310       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910003612423       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910003801191       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910003806441       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910003785595       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910003828902       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910003802491       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910003814653       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.255566e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910003389310       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910003445451       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910003493251       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910003494693       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910003489333       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910003500092       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910003493419       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910003496489       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 5.719801e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9093e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.073534e-01 1 1  ON 0
 uu_1                 1.420520e-01 1 1  ON 1
 uu_2                 4.331470e-02 1 1  ON 2
 uu_3                -1.791249e-02 1 1  ON 3
 uu_4                -6.302775e-02 1 1  ON 4
 uu_5                -9.703494e-02 1 1  ON 5
 uu_6                -1.244117e-01 1 1  ON 6
 uu_7                -1.378333e-01 1 1  ON 7
 uu_8                -1.332585e-01 1 1  ON 8
 uu_9                -1.047494e-01 1 1  ON 9
 ud_0                 4.352728e-01 1 1  ON 10
 ud_1                 1.774779e-01 1 1  ON 11
 ud_2                 6.414373e-02 1 1  ON 12
 ud_3                -4.493245e-03 1 1  ON 13
 ud_4                -6.087776e-02 1 1  ON 14
 ud_5                -1.024876e-01 1 1  ON 15
 ud_6                -1.302186e-01 1 1  ON 16
 ud_7                -1.481137e-01 1 1  ON 17
 ud_8                -1.519301e-01 1 1  ON 18
 ud_9                -1.447799e-01 1 1  ON 19
 eO_0                -7.493124e-01 1 1  ON 20
 eO_1                -4.362124e-01 1 1  ON 21
 eO_2                -2.589866e-02 1 1  ON 22
 eO_3                 2.940829e-01 1 1  ON 23
 eO_4                 5.211057e-01 1 1  ON 24
 eO_5                 4.824017e-01 1 1  ON 25
 eO_6                 2.579435e-01 1 1  ON 26
 eO_7                -4.116993e-02 1 1  ON 27
 eO_8                -2.209702e-01 1 1  ON 28
 eO_9                -8.104782e-02 1 1  ON 29
eH1_0                -2.395182e-01 1 1  ON 30
eH1_1                -1.368368e-01 1 1  ON 31
eH1_2                -9.226774e-02 1 1  ON 32
eH1_3                -4.109801e-02 1 1  ON 33
eH1_4                 7.325181e-03 1 1  ON 34
eH1_5                 3.840604e-02 1 1  ON 35
eH1_6                 9.634062e-02 1 1  ON 36
eH1_7                 1.491645e-01 1 1  ON 37
eH1_8                 1.684470e-01 1 1  ON 38
eH1_9                 5.455120e-02 1 1  ON 39
eH2_0                -2.382712e-01 1 1  ON 40
eH2_1                -1.355831e-01 1 1  ON 41
eH2_2                -9.108965e-02 1 1  ON 42
eH2_3                -3.967276e-02 1 1  ON 43
eH2_4                 8.339873e-03 1 1  ON 44
eH2_5                 3.989723e-02 1 1  ON 45
eH2_6                 9.819978e-02 1 1  ON 46
eH2_7                 1.497033e-01 1 1  ON 47
eH2_8                 1.800301e-01 1 1  ON 48
eH2_9                 4.480630e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.928
    reference variance = 0.227217
====================================================
  Execution time = 4.4917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3917e-01
  Total weights = 2.0000e+06
  Execution time = 4.8406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339158589047
                                         uncertainty =       0.008692621516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339158589047
                                         uncertainty =       0.008692621516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411802368
  error estimate for blocks of size 2^( 2) =       0.000424210710
  error estimate for blocks of size 2^( 3) =       0.000436588466
  error estimate for blocks of size 2^( 4) =       0.000448691512
  error estimate for blocks of size 2^( 5) =       0.000459841992
  error estimate for blocks of size 2^( 6) =       0.000469846805
  error estimate for blocks of size 2^( 7) =       0.000478439268

      target function =                  N/A
              le_mean =     -16.909924558684
             les_mean =     286.284710792119
             stat err =       0.000464204894
             autocorr =       1.270696255253
              std dev =       0.582376494484
             le_variance =       0.339162381328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339186823833
                                         uncertainty =       0.008692119161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339186823833
                                         uncertainty =       0.008692119161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411819508
  error estimate for blocks of size 2^( 2) =       0.000424224094
  error estimate for blocks of size 2^( 3) =       0.000436598628
  error estimate for blocks of size 2^( 4) =       0.000448697973
  error estimate for blocks of size 2^( 5) =       0.000459847632
  error estimate for blocks of size 2^( 6) =       0.000469849290
  error estimate for blocks of size 2^( 7) =       0.000478441361

      target function =                  N/A
              le_mean =     -16.909924338567
             les_mean =     286.284731581583
             stat err =       0.000464209064
             autocorr =       1.270613310892
              std dev =       0.582400734132
             le_variance =       0.339190615118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339172640923
                                         uncertainty =       0.008692321735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339172640923
                                         uncertainty =       0.008692321735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411810899
  error estimate for blocks of size 2^( 2) =       0.000424217281
  error estimate for blocks of size 2^( 3) =       0.000436593367
  error estimate for blocks of size 2^( 4) =       0.000448694484
  error estimate for blocks of size 2^( 5) =       0.000459844577
  error estimate for blocks of size 2^( 6) =       0.000469847734
  error estimate for blocks of size 2^( 7) =       0.000478439971

      target function =                  N/A
              le_mean =     -16.909924433283
             les_mean =     286.284720602452
             stat err =       0.000464206691
             autocorr =       1.270653450534
              std dev =       0.582388558171
             le_variance =       0.339176432689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339160309416
                                         uncertainty =       0.008692582131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339160309416
                                         uncertainty =       0.008692582131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411803413
  error estimate for blocks of size 2^( 2) =       0.000424211507
  error estimate for blocks of size 2^( 3) =       0.000436589052
  error estimate for blocks of size 2^( 4) =       0.000448691856
  error estimate for blocks of size 2^( 5) =       0.000459842288
  error estimate for blocks of size 2^( 6) =       0.000469846892
  error estimate for blocks of size 2^( 7) =       0.000478439325

      target function =                  N/A
              le_mean =     -16.909924540618
             les_mean =     286.284711901443
             stat err =       0.000464205090
             autocorr =       1.270690882545
              std dev =       0.582377971444
             le_variance =       0.339164101623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909924558684        initial  <--
     6.2500e+00     6.2500e+01             8.6106e-05       -16.909924338567
     2.5000e+01     2.5000e+02             2.2556e-05       -16.909924433283
     1.0000e+02     1.0000e+03             5.7198e-06       -16.909924540618

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.2143
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.073612e-01 1 1  ON 0
 uu_1                 1.420540e-01 1 1  ON 1
 uu_2                 4.330805e-02 1 1  ON 2
 uu_3                -1.792069e-02 1 1  ON 3
 uu_4                -6.302303e-02 1 1  ON 4
 uu_5                -9.703462e-02 1 1  ON 5
 uu_6                -1.244061e-01 1 1  ON 6
 uu_7                -1.378297e-01 1 1  ON 7
 uu_8                -1.332638e-01 1 1  ON 8
 uu_9                -1.047494e-01 1 1  ON 9
 ud_0                 4.352536e-01 1 1  ON 10
 ud_1                 1.774553e-01 1 1  ON 11
 ud_2                 6.415827e-02 1 1  ON 12
 ud_3                -4.471106e-03 1 1  ON 13
 ud_4                -6.087684e-02 1 1  ON 14
 ud_5                -1.024876e-01 1 1  ON 15
 ud_6                -1.302152e-01 1 1  ON 16
 ud_7                -1.481121e-01 1 1  ON 17
 ud_8                -1.519343e-01 1 1  ON 18
 ud_9                -1.447808e-01 1 1  ON 19
 eO_0                -7.492925e-01 1 1  ON 20
 eO_1                -4.362124e-01 1 1  ON 21
 eO_2                -2.590228e-02 1 1  ON 22
 eO_3                 2.940650e-01 1 1  ON 23
 eO_4                 5.211021e-01 1 1  ON 24
 eO_5                 4.823986e-01 1 1  ON 25
 eO_6                 2.579443e-01 1 1  ON 26
 eO_7                -4.117226e-02 1 1  ON 27
 eO_8                -2.209671e-01 1 1  ON 28
 eO_9                -8.104217e-02 1 1  ON 29
eH1_0                -2.395018e-01 1 1  ON 30
eH1_1                -1.368328e-01 1 1  ON 31
eH1_2                -9.227233e-02 1 1  ON 32
eH1_3                -4.109661e-02 1 1  ON 33
eH1_4                 7.322196e-03 1 1  ON 34
eH1_5                 3.840509e-02 1 1  ON 35
eH1_6                 9.633709e-02 1 1  ON 36
eH1_7                 1.491628e-01 1 1  ON 37
eH1_8                 1.684438e-01 1 1  ON 38
eH1_9                 5.454597e-02 1 1  ON 39
eH2_0                -2.382499e-01 1 1  ON 40
eH2_1                -1.355791e-01 1 1  ON 41
eH2_2                -9.109696e-02 1 1  ON 42
eH2_3                -3.967317e-02 1 1  ON 43
eH2_4                 8.334356e-03 1 1  ON 44
eH2_5                 3.989653e-02 1 1  ON 45
eH2_6                 9.820016e-02 1 1  ON 46
eH2_7                 1.497055e-01 1 1  ON 47
eH2_8                 1.800258e-01 1 1  ON 48
eH2_9                 4.479676e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2831e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9043
    reference variance = 0.163461
====================================================
  Execution time = 4.6019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5080e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2100e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350925858577
                                         uncertainty =       0.026510168630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350925858577
                                         uncertainty =       0.026510168630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418807196
  error estimate for blocks of size 2^( 2) =       0.000430753516
  error estimate for blocks of size 2^( 3) =       0.000443151592
  error estimate for blocks of size 2^( 4) =       0.000455310442
  error estimate for blocks of size 2^( 5) =       0.000466120283
  error estimate for blocks of size 2^( 6) =       0.000472873424
  error estimate for blocks of size 2^( 7) =       0.000476383794

      target function =                  N/A
              le_mean =     -16.909783596604
             les_mean =     286.291580043333
             stat err =       0.000467671986
             autocorr =       1.246965510899
              std dev =       0.592282816525
             le_variance =       0.350798934751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690978359660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909783596604       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909783692954       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909783767618       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909783800346       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909783839123       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909783845668       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909783845996       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909783841574       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909783841996       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.438304e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909783596604       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909783620759       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909783639498       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909783647705       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909783657404       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909783659054       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909783659162       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909783658062       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909783658164       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 3.602337e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909783596604       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909783602647       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909783607336       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909783609390       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909783611815       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909783612228       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909783612256       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909783611982       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909783612010       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 9.009933e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095910 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8126e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.073612e-01 1 1  ON 0
 uu_1                 1.420538e-01 1 1  ON 1
 uu_2                 4.330863e-02 1 1  ON 2
 uu_3                -1.792039e-02 1 1  ON 3
 uu_4                -6.302273e-02 1 1  ON 4
 uu_5                -9.703487e-02 1 1  ON 5
 uu_6                -1.244065e-01 1 1  ON 6
 uu_7                -1.378298e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.047500e-01 1 1  ON 9
 ud_0                 4.352572e-01 1 1  ON 10
 ud_1                 1.774579e-01 1 1  ON 11
 ud_2                 6.415632e-02 1 1  ON 12
 ud_3                -4.473009e-03 1 1  ON 13
 ud_4                -6.087691e-02 1 1  ON 14
 ud_5                -1.024879e-01 1 1  ON 15
 ud_6                -1.302158e-01 1 1  ON 16
 ud_7                -1.481127e-01 1 1  ON 17
 ud_8                -1.519343e-01 1 1  ON 18
 ud_9                -1.447810e-01 1 1  ON 19
 eO_0                -7.492943e-01 1 1  ON 20
 eO_1                -4.362128e-01 1 1  ON 21
 eO_2                -2.590157e-02 1 1  ON 22
 eO_3                 2.940665e-01 1 1  ON 23
 eO_4                 5.211029e-01 1 1  ON 24
 eO_5                 4.823990e-01 1 1  ON 25
 eO_6                 2.579443e-01 1 1  ON 26
 eO_7                -4.117199e-02 1 1  ON 27
 eO_8                -2.209676e-01 1 1  ON 28
 eO_9                -8.104290e-02 1 1  ON 29
eH1_0                -2.395030e-01 1 1  ON 30
eH1_1                -1.368334e-01 1 1  ON 31
eH1_2                -9.227241e-02 1 1  ON 32
eH1_3                -4.109714e-02 1 1  ON 33
eH1_4                 7.322036e-03 1 1  ON 34
eH1_5                 3.840523e-02 1 1  ON 35
eH1_6                 9.633738e-02 1 1  ON 36
eH1_7                 1.491632e-01 1 1  ON 37
eH1_8                 1.684445e-01 1 1  ON 38
eH1_9                 5.454686e-02 1 1  ON 39
eH2_0                -2.382515e-01 1 1  ON 40
eH2_1                -1.355800e-01 1 1  ON 41
eH2_2                -9.109622e-02 1 1  ON 42
eH2_3                -3.967342e-02 1 1  ON 43
eH2_4                 8.334725e-03 1 1  ON 44
eH2_5                 3.989676e-02 1 1  ON 45
eH2_6                 9.820054e-02 1 1  ON 46
eH2_7                 1.497056e-01 1 1  ON 47
eH2_8                 1.800262e-01 1 1  ON 48
eH2_9                 4.479745e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9025
    reference variance = 0.299199
====================================================
  Execution time = 4.4751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3497e-01
  Total weights = 2.0000e+06
  Execution time = 4.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334991267466
                                         uncertainty =       0.006714459195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334991267466
                                         uncertainty =       0.006714459195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409249067
  error estimate for blocks of size 2^( 2) =       0.000421095224
  error estimate for blocks of size 2^( 3) =       0.000433418520
  error estimate for blocks of size 2^( 4) =       0.000445264170
  error estimate for blocks of size 2^( 5) =       0.000456570959
  error estimate for blocks of size 2^( 6) =       0.000464598840
  error estimate for blocks of size 2^( 7) =       0.000468554740

      target function =                  N/A
              le_mean =     -16.910559084860
             les_mean =     286.301977993528
             stat err =       0.000458747177
             autocorr =       1.256525808666
              std dev =       0.578765581612
             le_variance =       0.334969598458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335002174530
                                         uncertainty =       0.006715024967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335002174530
                                         uncertainty =       0.006715024967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409255726
  error estimate for blocks of size 2^( 2) =       0.000421101211
  error estimate for blocks of size 2^( 3) =       0.000433423928
  error estimate for blocks of size 2^( 4) =       0.000445269165
  error estimate for blocks of size 2^( 5) =       0.000456575603
  error estimate for blocks of size 2^( 6) =       0.000464603728
  error estimate for blocks of size 2^( 7) =       0.000468559927

      target function =                  N/A
              le_mean =     -16.910559205296
             les_mean =     286.301992966415
             stat err =       0.000458752106
             autocorr =       1.256511920812
              std dev =       0.578774997820
             le_variance =       0.334980498101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334996732080
                                         uncertainty =       0.006714742298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334996732080
                                         uncertainty =       0.006714742298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409252403
  error estimate for blocks of size 2^( 2) =       0.000421098223
  error estimate for blocks of size 2^( 3) =       0.000433421228
  error estimate for blocks of size 2^( 4) =       0.000445266672
  error estimate for blocks of size 2^( 5) =       0.000456573284
  error estimate for blocks of size 2^( 6) =       0.000464601288
  error estimate for blocks of size 2^( 7) =       0.000468557339

      target function =                  N/A
              le_mean =     -16.910559145029
             les_mean =     286.301985489369
             stat err =       0.000458749646
             autocorr =       1.256518845241
              std dev =       0.578770299294
             le_variance =       0.334975059345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334991950754
                                         uncertainty =       0.006714494589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334991950754
                                         uncertainty =       0.006714494589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409249485
  error estimate for blocks of size 2^( 2) =       0.000421095599
  error estimate for blocks of size 2^( 3) =       0.000433418859
  error estimate for blocks of size 2^( 4) =       0.000445264483
  error estimate for blocks of size 2^( 5) =       0.000456571250
  error estimate for blocks of size 2^( 6) =       0.000464599146
  error estimate for blocks of size 2^( 7) =       0.000468555065

      target function =                  N/A
              le_mean =     -16.910559092357
             les_mean =     286.301978929877
             stat err =       0.000458747486
             autocorr =       1.256524937534
              std dev =       0.578766171506
             le_variance =       0.334970281279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910559084860        initial
     6.2500e+01     6.2500e+02             1.4383e-05       -16.910559205296  <--
     2.5000e+02     2.5000e+03             3.6023e-06       -16.910559145029
     1.0000e+03     1.0000e+04             9.0099e-07       -16.910559092357

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 6.9083e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.073612e-01 1 1  ON 0
 uu_1                 1.420533e-01 1 1  ON 1
 uu_2                 4.331035e-02 1 1  ON 2
 uu_3                -1.791949e-02 1 1  ON 3
 uu_4                -6.302182e-02 1 1  ON 4
 uu_5                -9.703561e-02 1 1  ON 5
 uu_6                -1.244076e-01 1 1  ON 6
 uu_7                -1.378301e-01 1 1  ON 7
 uu_8                -1.332635e-01 1 1  ON 8
 uu_9                -1.047518e-01 1 1  ON 9
 ud_0                 4.352680e-01 1 1  ON 10
 ud_1                 1.774656e-01 1 1  ON 11
 ud_2                 6.415055e-02 1 1  ON 12
 ud_3                -4.478705e-03 1 1  ON 13
 ud_4                -6.087710e-02 1 1  ON 14
 ud_5                -1.024891e-01 1 1  ON 15
 ud_6                -1.302177e-01 1 1  ON 16
 ud_7                -1.481146e-01 1 1  ON 17
 ud_8                -1.519343e-01 1 1  ON 18
 ud_9                -1.447816e-01 1 1  ON 19
 eO_0                -7.492998e-01 1 1  ON 20
 eO_1                -4.362139e-01 1 1  ON 21
 eO_2                -2.589946e-02 1 1  ON 22
 eO_3                 2.940709e-01 1 1  ON 23
 eO_4                 5.211053e-01 1 1  ON 24
 eO_5                 4.824001e-01 1 1  ON 25
 eO_6                 2.579443e-01 1 1  ON 26
 eO_7                -4.117119e-02 1 1  ON 27
 eO_8                -2.209692e-01 1 1  ON 28
 eO_9                -8.104511e-02 1 1  ON 29
eH1_0                -2.395065e-01 1 1  ON 30
eH1_1                -1.368354e-01 1 1  ON 31
eH1_2                -9.227262e-02 1 1  ON 32
eH1_3                -4.109870e-02 1 1  ON 33
eH1_4                 7.321552e-03 1 1  ON 34
eH1_5                 3.840566e-02 1 1  ON 35
eH1_6                 9.633827e-02 1 1  ON 36
eH1_7                 1.491644e-01 1 1  ON 37
eH1_8                 1.684466e-01 1 1  ON 38
eH1_9                 5.454953e-02 1 1  ON 39
eH2_0                -2.382562e-01 1 1  ON 40
eH2_1                -1.355828e-01 1 1  ON 41
eH2_2                -9.109401e-02 1 1  ON 42
eH2_3                -3.967419e-02 1 1  ON 43
eH2_4                 8.335828e-03 1 1  ON 44
eH2_5                 3.989743e-02 1 1  ON 45
eH2_6                 9.820168e-02 1 1  ON 46
eH2_7                 1.497059e-01 1 1  ON 47
eH2_8                 1.800273e-01 1 1  ON 48
eH2_9                 4.479952e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2722e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.7776
    reference variance = 1.00686
====================================================
  Execution time = 4.5368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2257e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336795068281
                                         uncertainty =       0.007004410716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336795068281
                                         uncertainty =       0.007004410716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410379789
  error estimate for blocks of size 2^( 2) =       0.000422520315
  error estimate for blocks of size 2^( 3) =       0.000434596212
  error estimate for blocks of size 2^( 4) =       0.000445810472
  error estimate for blocks of size 2^( 5) =       0.000456839702
  error estimate for blocks of size 2^( 6) =       0.000465186054
  error estimate for blocks of size 2^( 7) =       0.000471244371

      target function =                  N/A
              le_mean =     -16.909296376992
             les_mean =     286.261126938452
             stat err =       0.000459770150
             autocorr =       1.255190421900
              std dev =       0.580364662875
             le_variance =       0.336823141915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690929637699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909296376992       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909296738012       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909296794296       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909296830686       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909296930320       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909296982445       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909296993961       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909296994563       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909296992100       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 4.216393e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909296376992       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909296468204       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909296482508       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909296491523       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909296515829       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909296529154       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909296532447       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909296532497       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909296531885       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.060658e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909296376992       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909296399855       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909296403447       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909296405695       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909296411734       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909296415081       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909296415931       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909296415938       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909296415785       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.655587e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7633e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.073589e-01 1 1  ON 0
 uu_1                 1.420529e-01 1 1  ON 1
 uu_2                 4.331179e-02 1 1  ON 2
 uu_3                -1.791723e-02 1 1  ON 3
 uu_4                -6.302187e-02 1 1  ON 4
 uu_5                -9.703932e-02 1 1  ON 5
 uu_6                -1.244075e-01 1 1  ON 6
 uu_7                -1.378324e-01 1 1  ON 7
 uu_8                -1.332616e-01 1 1  ON 8
 uu_9                -1.047516e-01 1 1  ON 9
 ud_0                 4.352786e-01 1 1  ON 10
 ud_1                 1.774737e-01 1 1  ON 11
 ud_2                 6.414307e-02 1 1  ON 12
 ud_3                -4.488099e-03 1 1  ON 13
 ud_4                -6.087690e-02 1 1  ON 14
 ud_5                -1.024917e-01 1 1  ON 15
 ud_6                -1.302220e-01 1 1  ON 16
 ud_7                -1.481146e-01 1 1  ON 17
 ud_8                -1.519291e-01 1 1  ON 18
 ud_9                -1.447807e-01 1 1  ON 19
 eO_0                -7.493078e-01 1 1  ON 20
 eO_1                -4.362134e-01 1 1  ON 21
 eO_2                -2.589701e-02 1 1  ON 22
 eO_3                 2.940762e-01 1 1  ON 23
 eO_4                 5.211065e-01 1 1  ON 24
 eO_5                 4.824013e-01 1 1  ON 25
 eO_6                 2.579432e-01 1 1  ON 26
 eO_7                -4.116960e-02 1 1  ON 27
 eO_8                -2.209697e-01 1 1  ON 28
 eO_9                -8.104733e-02 1 1  ON 29
eH1_0                -2.395140e-01 1 1  ON 30
eH1_1                -1.368383e-01 1 1  ON 31
eH1_2                -9.227034e-02 1 1  ON 32
eH1_3                -4.109815e-02 1 1  ON 33
eH1_4                 7.320980e-03 1 1  ON 34
eH1_5                 3.840589e-02 1 1  ON 35
eH1_6                 9.633943e-02 1 1  ON 36
eH1_7                 1.491651e-01 1 1  ON 37
eH1_8                 1.684495e-01 1 1  ON 38
eH1_9                 5.455264e-02 1 1  ON 39
eH2_0                -2.382642e-01 1 1  ON 40
eH2_1                -1.355862e-01 1 1  ON 41
eH2_2                -9.109262e-02 1 1  ON 42
eH2_3                -3.967554e-02 1 1  ON 43
eH2_4                 8.338205e-03 1 1  ON 44
eH2_5                 3.989932e-02 1 1  ON 45
eH2_6                 9.820220e-02 1 1  ON 46
eH2_7                 1.497058e-01 1 1  ON 47
eH2_8                 1.800295e-01 1 1  ON 48
eH2_9                 4.480396e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9196
    reference variance = 0.375442
====================================================
  Execution time = 4.5182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2775e-01
  Total weights = 2.0000e+06
  Execution time = 4.8449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327822744496
                                         uncertainty =       0.003546980403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327822744496
                                         uncertainty =       0.003546980403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404813143
  error estimate for blocks of size 2^( 2) =       0.000417064053
  error estimate for blocks of size 2^( 3) =       0.000430224691
  error estimate for blocks of size 2^( 4) =       0.000443729484
  error estimate for blocks of size 2^( 5) =       0.000455549483
  error estimate for blocks of size 2^( 6) =       0.000464830075
  error estimate for blocks of size 2^( 7) =       0.000471736609

      target function =                  N/A
              le_mean =     -16.909292861706
             les_mean =     286.251932280985
             stat err =       0.000458961413
             autocorr =       1.285414332344
              std dev =       0.572492237417
             le_variance =       0.327747361902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327853390208
                                         uncertainty =       0.003548146749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327853390208
                                         uncertainty =       0.003548146749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404832055
  error estimate for blocks of size 2^( 2) =       0.000417080767
  error estimate for blocks of size 2^( 3) =       0.000430239143
  error estimate for blocks of size 2^( 4) =       0.000443742412
  error estimate for blocks of size 2^( 5) =       0.000455561496
  error estimate for blocks of size 2^( 6) =       0.000464842395
  error estimate for blocks of size 2^( 7) =       0.000471749164

      target function =                  N/A
              le_mean =     -16.909293117424
             les_mean =     286.251971553008
             stat err =       0.000458973867
             autocorr =       1.285363993026
              std dev =       0.572518983043
             le_variance =       0.327777985945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327838177027
                                         uncertainty =       0.003547574641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327838177027
                                         uncertainty =       0.003547574641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404822667
  error estimate for blocks of size 2^( 2) =       0.000417072460
  error estimate for blocks of size 2^( 3) =       0.000430231951
  error estimate for blocks of size 2^( 4) =       0.000443735972
  error estimate for blocks of size 2^( 5) =       0.000455555508
  error estimate for blocks of size 2^( 6) =       0.000464836254
  error estimate for blocks of size 2^( 7) =       0.000471742909

      target function =                  N/A
              le_mean =     -16.909292988579
             les_mean =     286.251951993142
             stat err =       0.000458967661
             autocorr =       1.285388849203
              std dev =       0.572505706018
             le_variance =       0.327762783423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327824675178
                                         uncertainty =       0.003547055033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327824675178
                                         uncertainty =       0.003547055033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404814335
  error estimate for blocks of size 2^( 2) =       0.000417065104
  error estimate for blocks of size 2^( 3) =       0.000430225598
  error estimate for blocks of size 2^( 4) =       0.000443730294
  error estimate for blocks of size 2^( 5) =       0.000455550235
  error estimate for blocks of size 2^( 6) =       0.000464830846
  error estimate for blocks of size 2^( 7) =       0.000471737396

      target function =                  N/A
              le_mean =     -16.909292877220
             les_mean =     286.251934734941
             stat err =       0.000458962193
             autocorr =       1.285411136015
              std dev =       0.572493922416
             le_variance =       0.327749291203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909292861706        initial
     1.5625e+01     1.5625e+02             4.2164e-05       -16.909293117424  <--
     6.2500e+01     6.2500e+02             1.0607e-05       -16.909292988579
     2.5000e+02     2.5000e+03             2.6556e-06       -16.909292877220

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 6.9511e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.073520e-01 1 1  ON 0
 uu_1                 1.420517e-01 1 1  ON 1
 uu_2                 4.331600e-02 1 1  ON 2
 uu_3                -1.791057e-02 1 1  ON 3
 uu_4                -6.302204e-02 1 1  ON 4
 uu_5                -9.705027e-02 1 1  ON 5
 uu_6                -1.244073e-01 1 1  ON 6
 uu_7                -1.378394e-01 1 1  ON 7
 uu_8                -1.332558e-01 1 1  ON 8
 uu_9                -1.047509e-01 1 1  ON 9
 ud_0                 4.353102e-01 1 1  ON 10
 ud_1                 1.774973e-01 1 1  ON 11
 ud_2                 6.412135e-02 1 1  ON 12
 ud_3                -4.515947e-03 1 1  ON 13
 ud_4                -6.087661e-02 1 1  ON 14
 ud_5                -1.024994e-01 1 1  ON 15
 ud_6                -1.302349e-01 1 1  ON 16
 ud_7                -1.481147e-01 1 1  ON 17
 ud_8                -1.519135e-01 1 1  ON 18
 ud_9                -1.447779e-01 1 1  ON 19
 eO_0                -7.493316e-01 1 1  ON 20
 eO_1                -4.362121e-01 1 1  ON 21
 eO_2                -2.588985e-02 1 1  ON 22
 eO_3                 2.940920e-01 1 1  ON 23
 eO_4                 5.211100e-01 1 1  ON 24
 eO_5                 4.824049e-01 1 1  ON 25
 eO_6                 2.579401e-01 1 1  ON 26
 eO_7                -4.116483e-02 1 1  ON 27
 eO_8                -2.209712e-01 1 1  ON 28
 eO_9                -8.105398e-02 1 1  ON 29
eH1_0                -2.395364e-01 1 1  ON 30
eH1_1                -1.368470e-01 1 1  ON 31
eH1_2                -9.226357e-02 1 1  ON 32
eH1_3                -4.109650e-02 1 1  ON 33
eH1_4                 7.319261e-03 1 1  ON 34
eH1_5                 3.840658e-02 1 1  ON 35
eH1_6                 9.634292e-02 1 1  ON 36
eH1_7                 1.491671e-01 1 1  ON 37
eH1_8                 1.684581e-01 1 1  ON 38
eH1_9                 5.456197e-02 1 1  ON 39
eH2_0                -2.382882e-01 1 1  ON 40
eH2_1                -1.355965e-01 1 1  ON 41
eH2_2                -9.108857e-02 1 1  ON 42
eH2_3                -3.967950e-02 1 1  ON 43
eH2_4                 8.345240e-03 1 1  ON 44
eH2_5                 3.990499e-02 1 1  ON 45
eH2_6                 9.820378e-02 1 1  ON 46
eH2_7                 1.497052e-01 1 1  ON 47
eH2_8                 1.800361e-01 1 1  ON 48
eH2_9                 4.481725e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2718e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9509
    reference variance = 0.292168
====================================================
  Execution time = 4.5580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2042e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332718707240
                                         uncertainty =       0.004113402063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332718707240
                                         uncertainty =       0.004113402063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407841107
  error estimate for blocks of size 2^( 2) =       0.000419734816
  error estimate for blocks of size 2^( 3) =       0.000432340451
  error estimate for blocks of size 2^( 4) =       0.000444871591
  error estimate for blocks of size 2^( 5) =       0.000454873133
  error estimate for blocks of size 2^( 6) =       0.000462913563
  error estimate for blocks of size 2^( 7) =       0.000469456009

      target function =                  N/A
              le_mean =     -16.909756391121
             les_mean =     286.272529777221
             stat err =       0.000458028574
             autocorr =       1.261255725980
              std dev =       0.576774424271
             le_variance =       0.332668736493


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690975639112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909756391121       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909757855047       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909758992732       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909759221784       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909759387990       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909759694750       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909759647282       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909759650831       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909759652688       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.880252e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909756391121       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909756772412       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909757078820       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909757141912       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909757179667       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909757256968       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909757248515       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909757248270       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909757248330       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 4.857748e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909756391121       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909756487451       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909756565563       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909756581761       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909756590999       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909756610271       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909756608386       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909756608279       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909756608255       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.223653e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7630e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.073502e-01 1 1  ON 0
 uu_1                 1.420510e-01 1 1  ON 1
 uu_2                 4.332434e-02 1 1  ON 2
 uu_3                -1.790596e-02 1 1  ON 3
 uu_4                -6.302873e-02 1 1  ON 4
 uu_5                -9.705541e-02 1 1  ON 5
 uu_6                -1.244158e-01 1 1  ON 6
 uu_7                -1.378470e-01 1 1  ON 7
 uu_8                -1.332503e-01 1 1  ON 8
 uu_9                -1.047513e-01 1 1  ON 9
 ud_0                 4.353587e-01 1 1  ON 10
 ud_1                 1.775312e-01 1 1  ON 11
 ud_2                 6.408520e-02 1 1  ON 12
 ud_3                -4.546506e-03 1 1  ON 13
 ud_4                -6.087684e-02 1 1  ON 14
 ud_5                -1.025113e-01 1 1  ON 15
 ud_6                -1.302470e-01 1 1  ON 16
 ud_7                -1.481241e-01 1 1  ON 17
 ud_8                -1.519043e-01 1 1  ON 18
 ud_9                -1.447682e-01 1 1  ON 19
 eO_0                -7.493613e-01 1 1  ON 20
 eO_1                -4.362128e-01 1 1  ON 21
 eO_2                -2.588053e-02 1 1  ON 22
 eO_3                 2.941121e-01 1 1  ON 23
 eO_4                 5.211178e-01 1 1  ON 24
 eO_5                 4.824099e-01 1 1  ON 25
 eO_6                 2.579386e-01 1 1  ON 26
 eO_7                -4.116237e-02 1 1  ON 27
 eO_8                -2.209745e-01 1 1  ON 28
 eO_9                -8.106181e-02 1 1  ON 29
eH1_0                -2.395641e-01 1 1  ON 30
eH1_1                -1.368628e-01 1 1  ON 31
eH1_2                -9.225157e-02 1 1  ON 32
eH1_3                -4.109258e-02 1 1  ON 33
eH1_4                 7.319222e-03 1 1  ON 34
eH1_5                 3.840861e-02 1 1  ON 35
eH1_6                 9.634261e-02 1 1  ON 36
eH1_7                 1.491656e-01 1 1  ON 37
eH1_8                 1.684689e-01 1 1  ON 38
eH1_9                 5.457571e-02 1 1  ON 39
eH2_0                -2.383161e-01 1 1  ON 40
eH2_1                -1.356121e-01 1 1  ON 41
eH2_2                -9.107865e-02 1 1  ON 42
eH2_3                -3.967997e-02 1 1  ON 43
eH2_4                 8.348936e-03 1 1  ON 44
eH2_5                 3.989822e-02 1 1  ON 45
eH2_6                 9.820780e-02 1 1  ON 46
eH2_7                 1.497092e-01 1 1  ON 47
eH2_8                 1.800454e-01 1 1  ON 48
eH2_9                 4.483357e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8526
    reference variance = 0.263724
====================================================
  Execution time = 4.4805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3941e-01
  Total weights = 2.0000e+06
  Execution time = 4.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339357268265
                                         uncertainty =       0.008112433515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339357268265
                                         uncertainty =       0.008112433515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411926666
  error estimate for blocks of size 2^( 2) =       0.000423350789
  error estimate for blocks of size 2^( 3) =       0.000435832484
  error estimate for blocks of size 2^( 4) =       0.000446353272
  error estimate for blocks of size 2^( 5) =       0.000455545411
  error estimate for blocks of size 2^( 6) =       0.000463174662
  error estimate for blocks of size 2^( 7) =       0.000467049059

      target function =                  N/A
              le_mean =     -16.909825625800
             les_mean =     286.281569681024
             stat err =       0.000458030601
             autocorr =       1.236372041500
              std dev =       0.582552277266
             le_variance =       0.339367155747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507982401
                                         uncertainty =       0.008115051320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339507982401
                                         uncertainty =       0.008115051320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412018074
  error estimate for blocks of size 2^( 2) =       0.000423432685
  error estimate for blocks of size 2^( 3) =       0.000435904352
  error estimate for blocks of size 2^( 4) =       0.000446420040
  error estimate for blocks of size 2^( 5) =       0.000455609038
  error estimate for blocks of size 2^( 6) =       0.000463233186
  error estimate for blocks of size 2^( 7) =       0.000467111653

      target function =                  N/A
              le_mean =     -16.909824519646
             les_mean =     286.281682901453
             stat err =       0.000458093479
             autocorr =       1.236162842690
              std dev =       0.582681547662
             le_variance =       0.339517785986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339435666824
                                         uncertainty =       0.008113831517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339435666824
                                         uncertainty =       0.008113831517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411974216
  error estimate for blocks of size 2^( 2) =       0.000423393287
  error estimate for blocks of size 2^( 3) =       0.000435869626
  error estimate for blocks of size 2^( 4) =       0.000446387704
  error estimate for blocks of size 2^( 5) =       0.000455578169
  error estimate for blocks of size 2^( 6) =       0.000463204793
  error estimate for blocks of size 2^( 7) =       0.000467081285

      target function =                  N/A
              le_mean =     -16.909824991448
             les_mean =     286.281626580893
             stat err =       0.000458062988
             autocorr =       1.236261462129
              std dev =       0.582619523545
             le_variance =       0.339445509216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339367127357
                                         uncertainty =       0.008112611390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339367127357
                                         uncertainty =       0.008112611390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411932646
  error estimate for blocks of size 2^( 2) =       0.000423356125
  error estimate for blocks of size 2^( 3) =       0.000435837137
  error estimate for blocks of size 2^( 4) =       0.000446357579
  error estimate for blocks of size 2^( 5) =       0.000455549505
  error estimate for blocks of size 2^( 6) =       0.000463178425
  error estimate for blocks of size 2^( 7) =       0.000467053086

      target function =                  N/A
              le_mean =     -16.909825537700
             les_mean =     286.281576554856
             stat err =       0.000458034649
             autocorr =       1.236357997493
              std dev =       0.582560734253
             le_variance =       0.339377009094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909825625800        initial  <--
     3.9062e+00     3.9062e+01             1.8803e-04       -16.909824519646
     1.5625e+01     1.5625e+02             4.8577e-05       -16.909824991448
     6.2500e+01     6.2500e+02             1.2237e-05       -16.909825537700

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.0196
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.073520e-01 1 1  ON 0
 uu_1                 1.420517e-01 1 1  ON 1
 uu_2                 4.331600e-02 1 1  ON 2
 uu_3                -1.791057e-02 1 1  ON 3
 uu_4                -6.302204e-02 1 1  ON 4
 uu_5                -9.705027e-02 1 1  ON 5
 uu_6                -1.244073e-01 1 1  ON 6
 uu_7                -1.378394e-01 1 1  ON 7
 uu_8                -1.332558e-01 1 1  ON 8
 uu_9                -1.047509e-01 1 1  ON 9
 ud_0                 4.353102e-01 1 1  ON 10
 ud_1                 1.774973e-01 1 1  ON 11
 ud_2                 6.412135e-02 1 1  ON 12
 ud_3                -4.515947e-03 1 1  ON 13
 ud_4                -6.087661e-02 1 1  ON 14
 ud_5                -1.024994e-01 1 1  ON 15
 ud_6                -1.302349e-01 1 1  ON 16
 ud_7                -1.481147e-01 1 1  ON 17
 ud_8                -1.519135e-01 1 1  ON 18
 ud_9                -1.447779e-01 1 1  ON 19
 eO_0                -7.493316e-01 1 1  ON 20
 eO_1                -4.362121e-01 1 1  ON 21
 eO_2                -2.588985e-02 1 1  ON 22
 eO_3                 2.940920e-01 1 1  ON 23
 eO_4                 5.211100e-01 1 1  ON 24
 eO_5                 4.824049e-01 1 1  ON 25
 eO_6                 2.579401e-01 1 1  ON 26
 eO_7                -4.116483e-02 1 1  ON 27
 eO_8                -2.209712e-01 1 1  ON 28
 eO_9                -8.105398e-02 1 1  ON 29
eH1_0                -2.395364e-01 1 1  ON 30
eH1_1                -1.368470e-01 1 1  ON 31
eH1_2                -9.226357e-02 1 1  ON 32
eH1_3                -4.109650e-02 1 1  ON 33
eH1_4                 7.319261e-03 1 1  ON 34
eH1_5                 3.840658e-02 1 1  ON 35
eH1_6                 9.634292e-02 1 1  ON 36
eH1_7                 1.491671e-01 1 1  ON 37
eH1_8                 1.684581e-01 1 1  ON 38
eH1_9                 5.456197e-02 1 1  ON 39
eH2_0                -2.382882e-01 1 1  ON 40
eH2_1                -1.355965e-01 1 1  ON 41
eH2_2                -9.108857e-02 1 1  ON 42
eH2_3                -3.967950e-02 1 1  ON 43
eH2_4                 8.345240e-03 1 1  ON 44
eH2_5                 3.990499e-02 1 1  ON 45
eH2_6                 9.820378e-02 1 1  ON 46
eH2_7                 1.497052e-01 1 1  ON 47
eH2_8                 1.800361e-01 1 1  ON 48
eH2_9                 4.481725e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2666e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9065
    reference variance = 0.153899
====================================================
  Execution time = 4.5682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3188e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1839e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331513997716
                                         uncertainty =       0.003599952498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331513997716
                                         uncertainty =       0.003599952498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407355785
  error estimate for blocks of size 2^( 2) =       0.000419438573
  error estimate for blocks of size 2^( 3) =       0.000431989649
  error estimate for blocks of size 2^( 4) =       0.000443029547
  error estimate for blocks of size 2^( 5) =       0.000452583774
  error estimate for blocks of size 2^( 6) =       0.000459611478
  error estimate for blocks of size 2^( 7) =       0.000463787667

      target function =                  N/A
              le_mean =     -16.910533455478
             les_mean =     286.298019053703
             stat err =       0.000454753116
             autocorr =       1.246245467564
              std dev =       0.576088075544
             le_variance =       0.331877470784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691053345548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910533455478       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910533549723       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910533562076       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910533575501       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910533589202       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910533602603       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910533612672       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910533606948       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910533607496       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.422660e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910533455478       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910533479138       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910533482251       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910533485602       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910533488936       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910533492294       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910533494865       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910533493431       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910533493553       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.560204e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910533455478       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910533461400       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910533462179       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910533463017       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910533463844       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910533464685       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910533465331       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910533464972       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 8.900875e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7528e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.073509e-01 1 1  ON 0
 uu_1                 1.420509e-01 1 1  ON 1
 uu_2                 4.331714e-02 1 1  ON 2
 uu_3                -1.791008e-02 1 1  ON 3
 uu_4                -6.302202e-02 1 1  ON 4
 uu_5                -9.705153e-02 1 1  ON 5
 uu_6                -1.244081e-01 1 1  ON 6
 uu_7                -1.378401e-01 1 1  ON 7
 uu_8                -1.332542e-01 1 1  ON 8
 uu_9                -1.047506e-01 1 1  ON 9
 ud_0                 4.353137e-01 1 1  ON 10
 ud_1                 1.775008e-01 1 1  ON 11
 ud_2                 6.411852e-02 1 1  ON 12
 ud_3                -4.519476e-03 1 1  ON 13
 ud_4                -6.087702e-02 1 1  ON 14
 ud_5                -1.024995e-01 1 1  ON 15
 ud_6                -1.302362e-01 1 1  ON 16
 ud_7                -1.481154e-01 1 1  ON 17
 ud_8                -1.519126e-01 1 1  ON 18
 ud_9                -1.447770e-01 1 1  ON 19
 eO_0                -7.493351e-01 1 1  ON 20
 eO_1                -4.362115e-01 1 1  ON 21
 eO_2                -2.588938e-02 1 1  ON 22
 eO_3                 2.940945e-01 1 1  ON 23
 eO_4                 5.211108e-01 1 1  ON 24
 eO_5                 4.824052e-01 1 1  ON 25
 eO_6                 2.579399e-01 1 1  ON 26
 eO_7                -4.116474e-02 1 1  ON 27
 eO_8                -2.209716e-01 1 1  ON 28
 eO_9                -8.105460e-02 1 1  ON 29
eH1_0                -2.395394e-01 1 1  ON 30
eH1_1                -1.368475e-01 1 1  ON 31
eH1_2                -9.226323e-02 1 1  ON 32
eH1_3                -4.109660e-02 1 1  ON 33
eH1_4                 7.319791e-03 1 1  ON 34
eH1_5                 3.840630e-02 1 1  ON 35
eH1_6                 9.634290e-02 1 1  ON 36
eH1_7                 1.491677e-01 1 1  ON 37
eH1_8                 1.684592e-01 1 1  ON 38
eH1_9                 5.456299e-02 1 1  ON 39
eH2_0                -2.382911e-01 1 1  ON 40
eH2_1                -1.355980e-01 1 1  ON 41
eH2_2                -9.108735e-02 1 1  ON 42
eH2_3                -3.967975e-02 1 1  ON 43
eH2_4                 8.345804e-03 1 1  ON 44
eH2_5                 3.990542e-02 1 1  ON 45
eH2_6                 9.820395e-02 1 1  ON 46
eH2_7                 1.497053e-01 1 1  ON 47
eH2_8                 1.800367e-01 1 1  ON 48
eH2_9                 4.481882e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8588
    reference variance = 0.164856
====================================================
  Execution time = 4.4921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3603e-01
  Total weights = 2.0000e+06
  Execution time = 4.8329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598954110
                                         uncertainty =       0.004604035841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598954110
                                         uncertainty =       0.004604035841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409893802
  error estimate for blocks of size 2^( 2) =       0.000421902328
  error estimate for blocks of size 2^( 3) =       0.000434177580
  error estimate for blocks of size 2^( 4) =       0.000444970962
  error estimate for blocks of size 2^( 5) =       0.000455633530
  error estimate for blocks of size 2^( 6) =       0.000463316522
  error estimate for blocks of size 2^( 7) =       0.000465106368

      target function =                  N/A
              le_mean =     -16.909663028796
             les_mean =     286.272729436788
             stat err =       0.000457256846
             autocorr =       1.244450795887
              std dev =       0.579677373529
             le_variance =       0.336025857381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335607252535
                                         uncertainty =       0.004604211970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335607252535
                                         uncertainty =       0.004604211970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409898923
  error estimate for blocks of size 2^( 2) =       0.000421906640
  error estimate for blocks of size 2^( 3) =       0.000434181153
  error estimate for blocks of size 2^( 4) =       0.000444973970
  error estimate for blocks of size 2^( 5) =       0.000455636367
  error estimate for blocks of size 2^( 6) =       0.000463318924
  error estimate for blocks of size 2^( 7) =       0.000465108867

      target function =                  N/A
              le_mean =     -16.909663094196
             les_mean =     286.272740046147
             stat err =       0.000457259532
             autocorr =       1.244434318915
              std dev =       0.579684616806
             le_variance =       0.336034254961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335603099168
                                         uncertainty =       0.004604124189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335603099168
                                         uncertainty =       0.004604124189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409896360
  error estimate for blocks of size 2^( 2) =       0.000421904479
  error estimate for blocks of size 2^( 3) =       0.000434179359
  error estimate for blocks of size 2^( 4) =       0.000444972458
  error estimate for blocks of size 2^( 5) =       0.000455634940
  error estimate for blocks of size 2^( 6) =       0.000463317712
  error estimate for blocks of size 2^( 7) =       0.000465107607

      target function =                  N/A
              le_mean =     -16.909663061118
             les_mean =     286.272734724853
             stat err =       0.000457258179
             autocorr =       1.244442520490
              std dev =       0.579680991861
             le_variance =       0.336030052325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335599475150
                                         uncertainty =       0.004604046894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335599475150
                                         uncertainty =       0.004604046894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409894123
  error estimate for blocks of size 2^( 2) =       0.000421902598
  error estimate for blocks of size 2^( 3) =       0.000434177804
  error estimate for blocks of size 2^( 4) =       0.000444971151
  error estimate for blocks of size 2^( 5) =       0.000455633708
  error estimate for blocks of size 2^( 6) =       0.000463316672
  error estimate for blocks of size 2^( 7) =       0.000465106524

      target function =                  N/A
              le_mean =     -16.909663032722
             les_mean =     286.272730096810
             stat err =       0.000457257014
             autocorr =       1.244449759586
              std dev =       0.579677828289
             le_variance =       0.336026384609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909663028796        initial
     3.9062e+01     3.9062e+02             1.4227e-05       -16.909663094196  <--
     1.5625e+02     1.5625e+03             3.5602e-06       -16.909663061118
     6.2500e+02     6.2500e+03             8.9009e-07       -16.909663032722

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 6.9155e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.073478e-01 1 1  ON 0
 uu_1                 1.420486e-01 1 1  ON 1
 uu_2                 4.332052e-02 1 1  ON 2
 uu_3                -1.790862e-02 1 1  ON 3
 uu_4                -6.302197e-02 1 1  ON 4
 uu_5                -9.705528e-02 1 1  ON 5
 uu_6                -1.244106e-01 1 1  ON 6
 uu_7                -1.378421e-01 1 1  ON 7
 uu_8                -1.332495e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353244e-01 1 1  ON 10
 ud_1                 1.775110e-01 1 1  ON 11
 ud_2                 6.411016e-02 1 1  ON 12
 ud_3                -4.530017e-03 1 1  ON 13
 ud_4                -6.087827e-02 1 1  ON 14
 ud_5                -1.024996e-01 1 1  ON 15
 ud_6                -1.302404e-01 1 1  ON 16
 ud_7                -1.481175e-01 1 1  ON 17
 ud_8                -1.519097e-01 1 1  ON 18
 ud_9                -1.447742e-01 1 1  ON 19
 eO_0                -7.493456e-01 1 1  ON 20
 eO_1                -4.362096e-01 1 1  ON 21
 eO_2                -2.588798e-02 1 1  ON 22
 eO_3                 2.941021e-01 1 1  ON 23
 eO_4                 5.211131e-01 1 1  ON 24
 eO_5                 4.824061e-01 1 1  ON 25
 eO_6                 2.579393e-01 1 1  ON 26
 eO_7                -4.116446e-02 1 1  ON 27
 eO_8                -2.209729e-01 1 1  ON 28
 eO_9                -8.105646e-02 1 1  ON 29
eH1_0                -2.395483e-01 1 1  ON 30
eH1_1                -1.368487e-01 1 1  ON 31
eH1_2                -9.226220e-02 1 1  ON 32
eH1_3                -4.109691e-02 1 1  ON 33
eH1_4                 7.321372e-03 1 1  ON 34
eH1_5                 3.840547e-02 1 1  ON 35
eH1_6                 9.634283e-02 1 1  ON 36
eH1_7                 1.491696e-01 1 1  ON 37
eH1_8                 1.684626e-01 1 1  ON 38
eH1_9                 5.456602e-02 1 1  ON 39
eH2_0                -2.382998e-01 1 1  ON 40
eH2_1                -1.356027e-01 1 1  ON 41
eH2_2                -9.108371e-02 1 1  ON 42
eH2_3                -3.968048e-02 1 1  ON 43
eH2_4                 8.347485e-03 1 1  ON 44
eH2_5                 3.990672e-02 1 1  ON 45
eH2_6                 9.820447e-02 1 1  ON 46
eH2_7                 1.497054e-01 1 1  ON 47
eH2_8                 1.800383e-01 1 1  ON 48
eH2_9                 4.482352e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2669e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8309
    reference variance = 0.294162
====================================================
  Execution time = 4.7024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3013e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2021e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330223531452
                                         uncertainty =       0.004146862877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330223531452
                                         uncertainty =       0.004146862877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406279361
  error estimate for blocks of size 2^( 2) =       0.000418765066
  error estimate for blocks of size 2^( 3) =       0.000431357580
  error estimate for blocks of size 2^( 4) =       0.000443795949
  error estimate for blocks of size 2^( 5) =       0.000455888949
  error estimate for blocks of size 2^( 6) =       0.000464430648
  error estimate for blocks of size 2^( 7) =       0.000471666895

      target function =                  N/A
              le_mean =     -16.910237994337
             les_mean =     286.286274698418
             stat err =       0.000458945610
             autocorr =       1.276065359431
              std dev =       0.574565782438
             le_variance =       0.330125838349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691023799434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910237994337       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910238946915       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910239500732       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910239677769       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910239703298       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910239614847       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910239630913       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910239631406       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910239642352       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 6.592710e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910237994337       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910238236555       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910238379333       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910238425449       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910238433435       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910238411453       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910238414951       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910238414692       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910238417199       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.662957e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910237994337       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910238055152       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910238091127       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910238102778       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910238104876       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910238099398       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910238100241       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910238100149       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910238100762       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 4.165877e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9053e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.073449e-01 1 1  ON 0
 uu_1                 1.420475e-01 1 1  ON 1
 uu_2                 4.332298e-02 1 1  ON 2
 uu_3                -1.790569e-02 1 1  ON 3
 uu_4                -6.302281e-02 1 1  ON 4
 uu_5                -9.705995e-02 1 1  ON 5
 uu_6                -1.244150e-01 1 1  ON 6
 uu_7                -1.378440e-01 1 1  ON 7
 uu_8                -1.332464e-01 1 1  ON 8
 uu_9                -1.047485e-01 1 1  ON 9
 ud_0                 4.353410e-01 1 1  ON 10
 ud_1                 1.775252e-01 1 1  ON 11
 ud_2                 6.409701e-02 1 1  ON 12
 ud_3                -4.544885e-03 1 1  ON 13
 ud_4                -6.087853e-02 1 1  ON 14
 ud_5                -1.025021e-01 1 1  ON 15
 ud_6                -1.302451e-01 1 1  ON 16
 ud_7                -1.481184e-01 1 1  ON 17
 ud_8                -1.519080e-01 1 1  ON 18
 ud_9                -1.447715e-01 1 1  ON 19
 eO_0                -7.493577e-01 1 1  ON 20
 eO_1                -4.362118e-01 1 1  ON 21
 eO_2                -2.588456e-02 1 1  ON 22
 eO_3                 2.941115e-01 1 1  ON 23
 eO_4                 5.211147e-01 1 1  ON 24
 eO_5                 4.824073e-01 1 1  ON 25
 eO_6                 2.579403e-01 1 1  ON 26
 eO_7                -4.116149e-02 1 1  ON 27
 eO_8                -2.209745e-01 1 1  ON 28
 eO_9                -8.105954e-02 1 1  ON 29
eH1_0                -2.395601e-01 1 1  ON 30
eH1_1                -1.368530e-01 1 1  ON 31
eH1_2                -9.225978e-02 1 1  ON 32
eH1_3                -4.109684e-02 1 1  ON 33
eH1_4                 7.320862e-03 1 1  ON 34
eH1_5                 3.840617e-02 1 1  ON 35
eH1_6                 9.634318e-02 1 1  ON 36
eH1_7                 1.491713e-01 1 1  ON 37
eH1_8                 1.684680e-01 1 1  ON 38
eH1_9                 5.457164e-02 1 1  ON 39
eH2_0                -2.383109e-01 1 1  ON 40
eH2_1                -1.356101e-01 1 1  ON 41
eH2_2                -9.107959e-02 1 1  ON 42
eH2_3                -3.968064e-02 1 1  ON 43
eH2_4                 8.346474e-03 1 1  ON 44
eH2_5                 3.990617e-02 1 1  ON 45
eH2_6                 9.820964e-02 1 1  ON 46
eH2_7                 1.497076e-01 1 1  ON 47
eH2_8                 1.800410e-01 1 1  ON 48
eH2_9                 4.482911e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8819
    reference variance = 0.333887
====================================================
  Execution time = 4.5301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3161e-01
  Total weights = 2.0000e+06
  Execution time = 4.8462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331525750537
                                         uncertainty =       0.003879661609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331525750537
                                         uncertainty =       0.003879661609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407182388
  error estimate for blocks of size 2^( 2) =       0.000419301237
  error estimate for blocks of size 2^( 3) =       0.000431751179
  error estimate for blocks of size 2^( 4) =       0.000443483991
  error estimate for blocks of size 2^( 5) =       0.000454340162
  error estimate for blocks of size 2^( 6) =       0.000462655724
  error estimate for blocks of size 2^( 7) =       0.000465314478

      target function =                  N/A
              le_mean =     -16.909985290970
             les_mean =     286.279197369613
             stat err =       0.000456448589
             autocorr =       1.256625205113
              std dev =       0.575842855813
             le_variance =       0.331594994591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331572174619
                                         uncertainty =       0.003881359111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331572174619
                                         uncertainty =       0.003881359111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407210946
  error estimate for blocks of size 2^( 2) =       0.000419326264
  error estimate for blocks of size 2^( 3) =       0.000431772908
  error estimate for blocks of size 2^( 4) =       0.000443503572
  error estimate for blocks of size 2^( 5) =       0.000454358881
  error estimate for blocks of size 2^( 6) =       0.000462674051
  error estimate for blocks of size 2^( 7) =       0.000465333548

      target function =                  N/A
              le_mean =     -16.909985289127
             les_mean =     286.279243820956
             stat err =       0.000456467513
             autocorr =       1.256553146964
              std dev =       0.575883241881
             le_variance =       0.331641508280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331549168958
                                         uncertainty =       0.003880529370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331549168958
                                         uncertainty =       0.003880529370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407196795
  error estimate for blocks of size 2^( 2) =       0.000419313835
  error estimate for blocks of size 2^( 3) =       0.000431762088
  error estimate for blocks of size 2^( 4) =       0.000443493809
  error estimate for blocks of size 2^( 5) =       0.000454349535
  error estimate for blocks of size 2^( 6) =       0.000462664903
  error estimate for blocks of size 2^( 7) =       0.000465324062

      target function =                  N/A
              le_mean =     -16.909985282313
             les_mean =     286.279220541334
             stat err =       0.000456458077
             autocorr =       1.256588532722
              std dev =       0.575863229523
             le_variance =       0.331618459116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331528678784
                                         uncertainty =       0.003879770672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331528678784
                                         uncertainty =       0.003879770672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407184190
  error estimate for blocks of size 2^( 2) =       0.000419302811
  error estimate for blocks of size 2^( 3) =       0.000431752540
  error estimate for blocks of size 2^( 4) =       0.000443485215
  error estimate for blocks of size 2^( 5) =       0.000454341330
  error estimate for blocks of size 2^( 6) =       0.000462656867
  error estimate for blocks of size 2^( 7) =       0.000465315673

      target function =                  N/A
              le_mean =     -16.909985288747
             les_mean =     286.279200228476
             stat err =       0.000456449771
             autocorr =       1.256620597643
              std dev =       0.575845403422
             le_variance =       0.331597928642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909985290970        initial  <--
     9.7656e+00     9.7656e+01             6.5927e-05       -16.909985289127
     3.9062e+01     3.9062e+02             1.6630e-05       -16.909985282313
     1.5625e+02     1.5625e+03             4.1659e-06       -16.909985288747

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.6044
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.073478e-01 1 1  ON 0
 uu_1                 1.420486e-01 1 1  ON 1
 uu_2                 4.332052e-02 1 1  ON 2
 uu_3                -1.790862e-02 1 1  ON 3
 uu_4                -6.302197e-02 1 1  ON 4
 uu_5                -9.705528e-02 1 1  ON 5
 uu_6                -1.244106e-01 1 1  ON 6
 uu_7                -1.378421e-01 1 1  ON 7
 uu_8                -1.332495e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353244e-01 1 1  ON 10
 ud_1                 1.775110e-01 1 1  ON 11
 ud_2                 6.411016e-02 1 1  ON 12
 ud_3                -4.530017e-03 1 1  ON 13
 ud_4                -6.087827e-02 1 1  ON 14
 ud_5                -1.024996e-01 1 1  ON 15
 ud_6                -1.302404e-01 1 1  ON 16
 ud_7                -1.481175e-01 1 1  ON 17
 ud_8                -1.519097e-01 1 1  ON 18
 ud_9                -1.447742e-01 1 1  ON 19
 eO_0                -7.493456e-01 1 1  ON 20
 eO_1                -4.362096e-01 1 1  ON 21
 eO_2                -2.588798e-02 1 1  ON 22
 eO_3                 2.941021e-01 1 1  ON 23
 eO_4                 5.211131e-01 1 1  ON 24
 eO_5                 4.824061e-01 1 1  ON 25
 eO_6                 2.579393e-01 1 1  ON 26
 eO_7                -4.116446e-02 1 1  ON 27
 eO_8                -2.209729e-01 1 1  ON 28
 eO_9                -8.105646e-02 1 1  ON 29
eH1_0                -2.395483e-01 1 1  ON 30
eH1_1                -1.368487e-01 1 1  ON 31
eH1_2                -9.226220e-02 1 1  ON 32
eH1_3                -4.109691e-02 1 1  ON 33
eH1_4                 7.321372e-03 1 1  ON 34
eH1_5                 3.840547e-02 1 1  ON 35
eH1_6                 9.634283e-02 1 1  ON 36
eH1_7                 1.491696e-01 1 1  ON 37
eH1_8                 1.684626e-01 1 1  ON 38
eH1_9                 5.456602e-02 1 1  ON 39
eH2_0                -2.382998e-01 1 1  ON 40
eH2_1                -1.356027e-01 1 1  ON 41
eH2_2                -9.108371e-02 1 1  ON 42
eH2_3                -3.968048e-02 1 1  ON 43
eH2_4                 8.347485e-03 1 1  ON 44
eH2_5                 3.990672e-02 1 1  ON 45
eH2_6                 9.820447e-02 1 1  ON 46
eH2_7                 1.497054e-01 1 1  ON 47
eH2_8                 1.800383e-01 1 1  ON 48
eH2_9                 4.482352e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2866e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8401
    reference variance = 0.240379
====================================================
  Execution time = 4.6629e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2038e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330644046334
                                         uncertainty =       0.004227057837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330644046334
                                         uncertainty =       0.004227057837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406541961
  error estimate for blocks of size 2^( 2) =       0.000418456905
  error estimate for blocks of size 2^( 3) =       0.000430373925
  error estimate for blocks of size 2^( 4) =       0.000442935882
  error estimate for blocks of size 2^( 5) =       0.000453473170
  error estimate for blocks of size 2^( 6) =       0.000459521130
  error estimate for blocks of size 2^( 7) =       0.000466888425

      target function =                  N/A
              le_mean =     -16.909727391681
             les_mean =     286.269433027053
             stat err =       0.000455704652
             autocorr =       1.256481704827
              std dev =       0.574937154273
             le_variance =       0.330552731364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690972739168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909727391681       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909727479116       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909727526220       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909727531089       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909727539258       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909727557115       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909727556798       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909727554562       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909727554163       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 7.257779e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909727391681       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909727413576       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909727425396       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909727426620       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909727428641       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909727433114       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909727433041       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909727432488       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909727432383       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.816011e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909727391681       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909727397157       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909727400115       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909727400421       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909727400925       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909727402041       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909727402025       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909727401886       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909727401867       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 4.540997e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8676e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073475e-01 1 1  ON 0
 uu_1                 1.420483e-01 1 1  ON 1
 uu_2                 4.332089e-02 1 1  ON 2
 uu_3                -1.790842e-02 1 1  ON 3
 uu_4                -6.302220e-02 1 1  ON 4
 uu_5                -9.705540e-02 1 1  ON 5
 uu_6                -1.244108e-01 1 1  ON 6
 uu_7                -1.378422e-01 1 1  ON 7
 uu_8                -1.332494e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353262e-01 1 1  ON 10
 ud_1                 1.775124e-01 1 1  ON 11
 ud_2                 6.410887e-02 1 1  ON 12
 ud_3                -4.531444e-03 1 1  ON 13
 ud_4                -6.087828e-02 1 1  ON 14
 ud_5                -1.025001e-01 1 1  ON 15
 ud_6                -1.302409e-01 1 1  ON 16
 ud_7                -1.481175e-01 1 1  ON 17
 ud_8                -1.519094e-01 1 1  ON 18
 ud_9                -1.447739e-01 1 1  ON 19
 eO_0                -7.493469e-01 1 1  ON 20
 eO_1                -4.362097e-01 1 1  ON 21
 eO_2                -2.588749e-02 1 1  ON 22
 eO_3                 2.941030e-01 1 1  ON 23
 eO_4                 5.211134e-01 1 1  ON 24
 eO_5                 4.824061e-01 1 1  ON 25
 eO_6                 2.579395e-01 1 1  ON 26
 eO_7                -4.116425e-02 1 1  ON 27
 eO_8                -2.209732e-01 1 1  ON 28
 eO_9                -8.105680e-02 1 1  ON 29
eH1_0                -2.395493e-01 1 1  ON 30
eH1_1                -1.368494e-01 1 1  ON 31
eH1_2                -9.226170e-02 1 1  ON 32
eH1_3                -4.109691e-02 1 1  ON 33
eH1_4                 7.321078e-03 1 1  ON 34
eH1_5                 3.840587e-02 1 1  ON 35
eH1_6                 9.634298e-02 1 1  ON 36
eH1_7                 1.491697e-01 1 1  ON 37
eH1_8                 1.684630e-01 1 1  ON 38
eH1_9                 5.456644e-02 1 1  ON 39
eH2_0                -2.383009e-01 1 1  ON 40
eH2_1                -1.356031e-01 1 1  ON 41
eH2_2                -9.108347e-02 1 1  ON 42
eH2_3                -3.968056e-02 1 1  ON 43
eH2_4                 8.347420e-03 1 1  ON 44
eH2_5                 3.990671e-02 1 1  ON 45
eH2_6                 9.820465e-02 1 1  ON 46
eH2_7                 1.497056e-01 1 1  ON 47
eH2_8                 1.800386e-01 1 1  ON 48
eH2_9                 4.482409e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9582
    reference variance = 0.318819
====================================================
  Execution time = 4.4973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4270e-01
  Total weights = 2.0000e+06
  Execution time = 4.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776051694
                                         uncertainty =       0.005737025067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776051694
                                         uncertainty =       0.005737025067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413946615
  error estimate for blocks of size 2^( 2) =       0.000425622546
  error estimate for blocks of size 2^( 3) =       0.000438286408
  error estimate for blocks of size 2^( 4) =       0.000450040553
  error estimate for blocks of size 2^( 5) =       0.000460831791
  error estimate for blocks of size 2^( 6) =       0.000469681585
  error estimate for blocks of size 2^( 7) =       0.000473546508

      target function =                  N/A
              le_mean =     -16.909854848129
             les_mean =     286.285894414210
             stat err =       0.000463525109
             autocorr =       1.253885437015
              std dev =       0.585408917558
             le_variance =       0.342703600756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342781093101
                                         uncertainty =       0.005737157874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342781093101
                                         uncertainty =       0.005737157874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413949659
  error estimate for blocks of size 2^( 2) =       0.000425625212
  error estimate for blocks of size 2^( 3) =       0.000438288633
  error estimate for blocks of size 2^( 4) =       0.000450042446
  error estimate for blocks of size 2^( 5) =       0.000460833475
  error estimate for blocks of size 2^( 6) =       0.000469683080
  error estimate for blocks of size 2^( 7) =       0.000473548021

      target function =                  N/A
              le_mean =     -16.909854828928
             les_mean =     286.285898804190
             stat err =       0.000463526755
             autocorr =       1.253875903944
              std dev =       0.585413221691
             le_variance =       0.342708640131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342778574445
                                         uncertainty =       0.005737091646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342778574445
                                         uncertainty =       0.005737091646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413948138
  error estimate for blocks of size 2^( 2) =       0.000425623880
  error estimate for blocks of size 2^( 3) =       0.000438287521
  error estimate for blocks of size 2^( 4) =       0.000450041499
  error estimate for blocks of size 2^( 5) =       0.000460832633
  error estimate for blocks of size 2^( 6) =       0.000469682332
  error estimate for blocks of size 2^( 7) =       0.000473547264

      target function =                  N/A
              le_mean =     -16.909854838358
             les_mean =     286.285896605467
             stat err =       0.000463525932
             autocorr =       1.253880660140
              std dev =       0.585411071377
             le_variance =       0.342706122490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776367051
                                         uncertainty =       0.005737033395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342776367051
                                         uncertainty =       0.005737033395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413946806
  error estimate for blocks of size 2^( 2) =       0.000425622713
  error estimate for blocks of size 2^( 3) =       0.000438286547
  error estimate for blocks of size 2^( 4) =       0.000450040672
  error estimate for blocks of size 2^( 5) =       0.000460831897
  error estimate for blocks of size 2^( 6) =       0.000469681678
  error estimate for blocks of size 2^( 7) =       0.000473546603

      target function =                  N/A
              le_mean =     -16.909854846894
             les_mean =     286.285894687649
             stat err =       0.000463525212
             autocorr =       1.253884839545
              std dev =       0.585409186797
             le_variance =       0.342703915987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909854848129        initial  <--
     9.7656e+01     9.7656e+02             7.2578e-06       -16.909854828928
     3.9062e+02     3.9062e+03             1.8160e-06       -16.909854838358
     1.5625e+03     1.5625e+04             4.5410e-07       -16.909854846894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.2378
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073478e-01 1 1  ON 0
 uu_1                 1.420486e-01 1 1  ON 1
 uu_2                 4.332052e-02 1 1  ON 2
 uu_3                -1.790862e-02 1 1  ON 3
 uu_4                -6.302197e-02 1 1  ON 4
 uu_5                -9.705528e-02 1 1  ON 5
 uu_6                -1.244106e-01 1 1  ON 6
 uu_7                -1.378421e-01 1 1  ON 7
 uu_8                -1.332495e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353244e-01 1 1  ON 10
 ud_1                 1.775110e-01 1 1  ON 11
 ud_2                 6.411016e-02 1 1  ON 12
 ud_3                -4.530017e-03 1 1  ON 13
 ud_4                -6.087827e-02 1 1  ON 14
 ud_5                -1.024996e-01 1 1  ON 15
 ud_6                -1.302404e-01 1 1  ON 16
 ud_7                -1.481175e-01 1 1  ON 17
 ud_8                -1.519097e-01 1 1  ON 18
 ud_9                -1.447742e-01 1 1  ON 19
 eO_0                -7.493456e-01 1 1  ON 20
 eO_1                -4.362096e-01 1 1  ON 21
 eO_2                -2.588798e-02 1 1  ON 22
 eO_3                 2.941021e-01 1 1  ON 23
 eO_4                 5.211131e-01 1 1  ON 24
 eO_5                 4.824061e-01 1 1  ON 25
 eO_6                 2.579393e-01 1 1  ON 26
 eO_7                -4.116446e-02 1 1  ON 27
 eO_8                -2.209729e-01 1 1  ON 28
 eO_9                -8.105646e-02 1 1  ON 29
eH1_0                -2.395483e-01 1 1  ON 30
eH1_1                -1.368487e-01 1 1  ON 31
eH1_2                -9.226220e-02 1 1  ON 32
eH1_3                -4.109691e-02 1 1  ON 33
eH1_4                 7.321372e-03 1 1  ON 34
eH1_5                 3.840547e-02 1 1  ON 35
eH1_6                 9.634283e-02 1 1  ON 36
eH1_7                 1.491696e-01 1 1  ON 37
eH1_8                 1.684626e-01 1 1  ON 38
eH1_9                 5.456602e-02 1 1  ON 39
eH2_0                -2.382998e-01 1 1  ON 40
eH2_1                -1.356027e-01 1 1  ON 41
eH2_2                -9.108371e-02 1 1  ON 42
eH2_3                -3.968048e-02 1 1  ON 43
eH2_4                 8.347485e-03 1 1  ON 44
eH2_5                 3.990672e-02 1 1  ON 45
eH2_6                 9.820447e-02 1 1  ON 46
eH2_7                 1.497054e-01 1 1  ON 47
eH2_8                 1.800383e-01 1 1  ON 48
eH2_9                 4.482352e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2792e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9118
    reference variance = 0.367565
====================================================
  Execution time = 4.6142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3013e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1936e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330052940263
                                         uncertainty =       0.003251194101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330052940263
                                         uncertainty =       0.003251194101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406283038
  error estimate for blocks of size 2^( 2) =       0.000418398020
  error estimate for blocks of size 2^( 3) =       0.000431364183
  error estimate for blocks of size 2^( 4) =       0.000444288851
  error estimate for blocks of size 2^( 5) =       0.000455085409
  error estimate for blocks of size 2^( 6) =       0.000464599507
  error estimate for blocks of size 2^( 7) =       0.000468249823

      target function =                  N/A
              le_mean =     -16.909985776710
             les_mean =     286.277750616801
             stat err =       0.000458055897
             autocorr =       1.271099582305
              std dev =       0.574570981968
             le_variance =       0.330131813320


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690998577671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909985776710       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909985781907       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909985785420       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909985786197       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909985787043       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909985788693       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909985789135       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909985789346       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909985789184       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 7.551331e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909985776710       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909985778010       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909985778888       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909985779082       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909985779294       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909985779706       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909985779810       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909985779867       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909985779817       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.888088e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909985776710       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909985777035       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909985777255       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909985777291       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909985777356       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909985777460       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909985777482       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909985777505       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909985777504       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 4.720379e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8086e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.073478e-01 1 1  ON 0
 uu_1                 1.420486e-01 1 1  ON 1
 uu_2                 4.332054e-02 1 1  ON 2
 uu_3                -1.790856e-02 1 1  ON 3
 uu_4                -6.302200e-02 1 1  ON 4
 uu_5                -9.705533e-02 1 1  ON 5
 uu_6                -1.244107e-01 1 1  ON 6
 uu_7                -1.378421e-01 1 1  ON 7
 uu_8                -1.332494e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353246e-01 1 1  ON 10
 ud_1                 1.775111e-01 1 1  ON 11
 ud_2                 6.411004e-02 1 1  ON 12
 ud_3                -4.530131e-03 1 1  ON 13
 ud_4                -6.087828e-02 1 1  ON 14
 ud_5                -1.024997e-01 1 1  ON 15
 ud_6                -1.302404e-01 1 1  ON 16
 ud_7                -1.481175e-01 1 1  ON 17
 ud_8                -1.519097e-01 1 1  ON 18
 ud_9                -1.447742e-01 1 1  ON 19
 eO_0                -7.493457e-01 1 1  ON 20
 eO_1                -4.362096e-01 1 1  ON 21
 eO_2                -2.588795e-02 1 1  ON 22
 eO_3                 2.941022e-01 1 1  ON 23
 eO_4                 5.211131e-01 1 1  ON 24
 eO_5                 4.824061e-01 1 1  ON 25
 eO_6                 2.579393e-01 1 1  ON 26
 eO_7                -4.116444e-02 1 1  ON 27
 eO_8                -2.209729e-01 1 1  ON 28
 eO_9                -8.105650e-02 1 1  ON 29
eH1_0                -2.395484e-01 1 1  ON 30
eH1_1                -1.368488e-01 1 1  ON 31
eH1_2                -9.226217e-02 1 1  ON 32
eH1_3                -4.109693e-02 1 1  ON 33
eH1_4                 7.321387e-03 1 1  ON 34
eH1_5                 3.840545e-02 1 1  ON 35
eH1_6                 9.634285e-02 1 1  ON 36
eH1_7                 1.491696e-01 1 1  ON 37
eH1_8                 1.684626e-01 1 1  ON 38
eH1_9                 5.456608e-02 1 1  ON 39
eH2_0                -2.383000e-01 1 1  ON 40
eH2_1                -1.356028e-01 1 1  ON 41
eH2_2                -9.108367e-02 1 1  ON 42
eH2_3                -3.968047e-02 1 1  ON 43
eH2_4                 8.347484e-03 1 1  ON 44
eH2_5                 3.990674e-02 1 1  ON 45
eH2_6                 9.820447e-02 1 1  ON 46
eH2_7                 1.497054e-01 1 1  ON 47
eH2_8                 1.800383e-01 1 1  ON 48
eH2_9                 4.482358e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8027
    reference variance = 0.208725
====================================================
  Execution time = 4.6295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3451e-01
  Total weights = 2.0000e+06
  Execution time = 4.8158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506353898
                                         uncertainty =       0.003754565103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506353898
                                         uncertainty =       0.003754565103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408965185
  error estimate for blocks of size 2^( 2) =       0.000421148724
  error estimate for blocks of size 2^( 3) =       0.000433259810
  error estimate for blocks of size 2^( 4) =       0.000445594381
  error estimate for blocks of size 2^( 5) =       0.000456263339
  error estimate for blocks of size 2^( 6) =       0.000466043933
  error estimate for blocks of size 2^( 7) =       0.000470909165

      target function =                  N/A
              le_mean =     -16.910003554037
             les_mean =     286.282725074770
             stat err =       0.000459702704
             autocorr =       1.263518024155
              std dev =       0.578364110652
             le_variance =       0.334505044490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506894428
                                         uncertainty =       0.003754576850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506894428
                                         uncertainty =       0.003754576850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408965515
  error estimate for blocks of size 2^( 2) =       0.000421149020
  error estimate for blocks of size 2^( 3) =       0.000433260069
  error estimate for blocks of size 2^( 4) =       0.000445594620
  error estimate for blocks of size 2^( 5) =       0.000456263566
  error estimate for blocks of size 2^( 6) =       0.000466044155
  error estimate for blocks of size 2^( 7) =       0.000470909376

      target function =                  N/A
              le_mean =     -16.910003555247
             les_mean =     286.282725655863
             stat err =       0.000459702929
             autocorr =       1.263517219279
              std dev =       0.578364577613
             le_variance =       0.334505584638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506624210
                                         uncertainty =       0.003754570978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506624210
                                         uncertainty =       0.003754570978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408965350
  error estimate for blocks of size 2^( 2) =       0.000421148872
  error estimate for blocks of size 2^( 3) =       0.000433259939
  error estimate for blocks of size 2^( 4) =       0.000445594501
  error estimate for blocks of size 2^( 5) =       0.000456263453
  error estimate for blocks of size 2^( 6) =       0.000466044044
  error estimate for blocks of size 2^( 7) =       0.000470909270

      target function =                  N/A
              le_mean =     -16.910003554641
             les_mean =     286.282725365330
             stat err =       0.000459702817
             autocorr =       1.263517621633
              std dev =       0.578364344173
             le_variance =       0.334505314611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506387688
                                         uncertainty =       0.003754565837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334506387688
                                         uncertainty =       0.003754565837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408965205
  error estimate for blocks of size 2^( 2) =       0.000421148743
  error estimate for blocks of size 2^( 3) =       0.000433259826
  error estimate for blocks of size 2^( 4) =       0.000445594396
  error estimate for blocks of size 2^( 5) =       0.000456263353
  error estimate for blocks of size 2^( 6) =       0.000466043947
  error estimate for blocks of size 2^( 7) =       0.000470909178

      target function =                  N/A
              le_mean =     -16.910003554112
             les_mean =     286.282725111088
             stat err =       0.000459702718
             autocorr =       1.263517973857
              std dev =       0.578364139843
             le_variance =       0.334505078256


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910003554037        initial
     9.7656e+02     9.7656e+03             7.5513e-07       -16.910003555247  <--
     3.9062e+03     3.9062e+04             1.8881e-07       -16.910003554641
     1.5625e+04     1.5625e+05             4.7204e-08       -16.910003554112

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 7.0518e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.073477e-01 1 1  ON 0
 uu_1                 1.420486e-01 1 1  ON 1
 uu_2                 4.332059e-02 1 1  ON 2
 uu_3                -1.790837e-02 1 1  ON 3
 uu_4                -6.302209e-02 1 1  ON 4
 uu_5                -9.705548e-02 1 1  ON 5
 uu_6                -1.244108e-01 1 1  ON 6
 uu_7                -1.378422e-01 1 1  ON 7
 uu_8                -1.332493e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353252e-01 1 1  ON 10
 ud_1                 1.775115e-01 1 1  ON 11
 ud_2                 6.410970e-02 1 1  ON 12
 ud_3                -4.530472e-03 1 1  ON 13
 ud_4                -6.087832e-02 1 1  ON 14
 ud_5                -1.024997e-01 1 1  ON 15
 ud_6                -1.302404e-01 1 1  ON 16
 ud_7                -1.481176e-01 1 1  ON 17
 ud_8                -1.519096e-01 1 1  ON 18
 ud_9                -1.447742e-01 1 1  ON 19
 eO_0                -7.493460e-01 1 1  ON 20
 eO_1                -4.362096e-01 1 1  ON 21
 eO_2                -2.588784e-02 1 1  ON 22
 eO_3                 2.941024e-01 1 1  ON 23
 eO_4                 5.211131e-01 1 1  ON 24
 eO_5                 4.824062e-01 1 1  ON 25
 eO_6                 2.579393e-01 1 1  ON 26
 eO_7                -4.116440e-02 1 1  ON 27
 eO_8                -2.209729e-01 1 1  ON 28
 eO_9                -8.105661e-02 1 1  ON 29
eH1_0                -2.395487e-01 1 1  ON 30
eH1_1                -1.368489e-01 1 1  ON 31
eH1_2                -9.226208e-02 1 1  ON 32
eH1_3                -4.109699e-02 1 1  ON 33
eH1_4                 7.321432e-03 1 1  ON 34
eH1_5                 3.840538e-02 1 1  ON 35
eH1_6                 9.634290e-02 1 1  ON 36
eH1_7                 1.491696e-01 1 1  ON 37
eH1_8                 1.684628e-01 1 1  ON 38
eH1_9                 5.456624e-02 1 1  ON 39
eH2_0                -2.383003e-01 1 1  ON 40
eH2_1                -1.356029e-01 1 1  ON 41
eH2_2                -9.108356e-02 1 1  ON 42
eH2_3                -3.968043e-02 1 1  ON 43
eH2_4                 8.347481e-03 1 1  ON 44
eH2_5                 3.990680e-02 1 1  ON 45
eH2_6                 9.820449e-02 1 1  ON 46
eH2_7                 1.497055e-01 1 1  ON 47
eH2_8                 1.800383e-01 1 1  ON 48
eH2_9                 4.482373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2861e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.190407
====================================================
  Execution time = 4.6239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3670e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1951e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336803912454
                                         uncertainty =       0.007410722475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336803912454
                                         uncertainty =       0.007410722475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410303447
  error estimate for blocks of size 2^( 2) =       0.000422325367
  error estimate for blocks of size 2^( 3) =       0.000435210069
  error estimate for blocks of size 2^( 4) =       0.000447418778
  error estimate for blocks of size 2^( 5) =       0.000457637127
  error estimate for blocks of size 2^( 6) =       0.000465573340
  error estimate for blocks of size 2^( 7) =       0.000471507503

      target function =                  N/A
              le_mean =     -16.910068233189
             les_mean =     286.287105320576
             stat err =       0.000460534187
             autocorr =       1.259834270173
              std dev =       0.580256699931
             le_variance =       0.336697837815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691006823319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910068233189       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910068261594       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910068273059       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910068278946       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910068283799       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910068287486       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910068287865       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910068288058       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910068287713       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.890512e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910068233189       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910068240295       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910068243164       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910068244638       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910068245849       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910068246774       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910068246867       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910068246916       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910068246827       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 7.229968e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910068233189       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910068234966       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910068235683       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910068236052       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910068236356       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910068236583       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910068236613       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910068236620       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910068236594       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.807722e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8199e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.073476e-01 1 1  ON 0
 uu_1                 1.420485e-01 1 1  ON 1
 uu_2                 4.332075e-02 1 1  ON 2
 uu_3                -1.790831e-02 1 1  ON 3
 uu_4                -6.302213e-02 1 1  ON 4
 uu_5                -9.705555e-02 1 1  ON 5
 uu_6                -1.244111e-01 1 1  ON 6
 uu_7                -1.378423e-01 1 1  ON 7
 uu_8                -1.332491e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353259e-01 1 1  ON 10
 ud_1                 1.775119e-01 1 1  ON 11
 ud_2                 6.410924e-02 1 1  ON 12
 ud_3                -4.531044e-03 1 1  ON 13
 ud_4                -6.087848e-02 1 1  ON 14
 ud_5                -1.024998e-01 1 1  ON 15
 ud_6                -1.302406e-01 1 1  ON 16
 ud_7                -1.481176e-01 1 1  ON 17
 ud_8                -1.519094e-01 1 1  ON 18
 ud_9                -1.447741e-01 1 1  ON 19
 eO_0                -7.493465e-01 1 1  ON 20
 eO_1                -4.362096e-01 1 1  ON 21
 eO_2                -2.588765e-02 1 1  ON 22
 eO_3                 2.941027e-01 1 1  ON 23
 eO_4                 5.211132e-01 1 1  ON 24
 eO_5                 4.824062e-01 1 1  ON 25
 eO_6                 2.579394e-01 1 1  ON 26
 eO_7                -4.116432e-02 1 1  ON 27
 eO_8                -2.209730e-01 1 1  ON 28
 eO_9                -8.105672e-02 1 1  ON 29
eH1_0                -2.395493e-01 1 1  ON 30
eH1_1                -1.368492e-01 1 1  ON 31
eH1_2                -9.226188e-02 1 1  ON 32
eH1_3                -4.109688e-02 1 1  ON 33
eH1_4                 7.321511e-03 1 1  ON 34
eH1_5                 3.840542e-02 1 1  ON 35
eH1_6                 9.634293e-02 1 1  ON 36
eH1_7                 1.491697e-01 1 1  ON 37
eH1_8                 1.684629e-01 1 1  ON 38
eH1_9                 5.456645e-02 1 1  ON 39
eH2_0                -2.383006e-01 1 1  ON 40
eH2_1                -1.356031e-01 1 1  ON 41
eH2_2                -9.108347e-02 1 1  ON 42
eH2_3                -3.968055e-02 1 1  ON 43
eH2_4                 8.347539e-03 1 1  ON 44
eH2_5                 3.990686e-02 1 1  ON 45
eH2_6                 9.820453e-02 1 1  ON 46
eH2_7                 1.497055e-01 1 1  ON 47
eH2_8                 1.800384e-01 1 1  ON 48
eH2_9                 4.482397e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8155
    reference variance = 0.297645
====================================================
  Execution time = 4.5148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2734e-01
  Total weights = 2.0000e+06
  Execution time = 4.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190669066
                                         uncertainty =       0.003221719819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190669066
                                         uncertainty =       0.003221719819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404559609
  error estimate for blocks of size 2^( 2) =       0.000416712838
  error estimate for blocks of size 2^( 3) =       0.000428977907
  error estimate for blocks of size 2^( 4) =       0.000440695567
  error estimate for blocks of size 2^( 5) =       0.000452551787
  error estimate for blocks of size 2^( 6) =       0.000460307714
  error estimate for blocks of size 2^( 7) =       0.000467344327

      target function =                  N/A
              le_mean =     -16.910243305543
             les_mean =     286.283665443739
             stat err =       0.000455224849
             autocorr =       1.266155011516
              std dev =       0.572133686077
             le_variance =       0.327336954744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327192538953
                                         uncertainty =       0.003221722567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327192538953
                                         uncertainty =       0.003221722567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404560766
  error estimate for blocks of size 2^( 2) =       0.000416713850
  error estimate for blocks of size 2^( 3) =       0.000428978777
  error estimate for blocks of size 2^( 4) =       0.000440696357
  error estimate for blocks of size 2^( 5) =       0.000452552493
  error estimate for blocks of size 2^( 6) =       0.000460308348
  error estimate for blocks of size 2^( 7) =       0.000467344887

      target function =                  N/A
              le_mean =     -16.910243309652
             les_mean =     286.283667454655
             stat err =       0.000455225521
             autocorr =       1.266151512421
              std dev =       0.572135322006
             le_variance =       0.327338826687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327191604405
                                         uncertainty =       0.003221721187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327191604405
                                         uncertainty =       0.003221721187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404560188
  error estimate for blocks of size 2^( 2) =       0.000416713344
  error estimate for blocks of size 2^( 3) =       0.000428978342
  error estimate for blocks of size 2^( 4) =       0.000440695962
  error estimate for blocks of size 2^( 5) =       0.000452552140
  error estimate for blocks of size 2^( 6) =       0.000460308031
  error estimate for blocks of size 2^( 7) =       0.000467344607

      target function =                  N/A
              le_mean =     -16.910243307577
             les_mean =     286.283666448882
             stat err =       0.000455225185
             autocorr =       1.266153260627
              std dev =       0.572134504389
             le_variance =       0.327337891113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190785990
                                         uncertainty =       0.003221719990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327190785990
                                         uncertainty =       0.003221719990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404559682
  error estimate for blocks of size 2^( 2) =       0.000416712901
  error estimate for blocks of size 2^( 3) =       0.000428977962
  error estimate for blocks of size 2^( 4) =       0.000440695617
  error estimate for blocks of size 2^( 5) =       0.000452551831
  error estimate for blocks of size 2^( 6) =       0.000460307753
  error estimate for blocks of size 2^( 7) =       0.000467344362

      target function =                  N/A
              le_mean =     -16.910243305795
             les_mean =     286.283665569328
             stat err =       0.000455224891
             autocorr =       1.266154792611
              std dev =       0.572133788372
             le_variance =       0.327337071797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910243305543        initial
     2.4414e+02     2.4414e+03             2.8905e-06       -16.910243309652  <--
     9.7656e+02     9.7656e+03             7.2300e-07       -16.910243307577
     3.9062e+03     3.9062e+04             1.8077e-07       -16.910243305795

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 6.9444e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.073473e-01 1 1  ON 0
 uu_1                 1.420483e-01 1 1  ON 1
 uu_2                 4.332124e-02 1 1  ON 2
 uu_3                -1.790813e-02 1 1  ON 3
 uu_4                -6.302226e-02 1 1  ON 4
 uu_5                -9.705577e-02 1 1  ON 5
 uu_6                -1.244118e-01 1 1  ON 6
 uu_7                -1.378427e-01 1 1  ON 7
 uu_8                -1.332487e-01 1 1  ON 8
 uu_9                -1.047494e-01 1 1  ON 9
 ud_0                 4.353280e-01 1 1  ON 10
 ud_1                 1.775133e-01 1 1  ON 11
 ud_2                 6.410786e-02 1 1  ON 12
 ud_3                -4.532760e-03 1 1  ON 13
 ud_4                -6.087896e-02 1 1  ON 14
 ud_5                -1.025001e-01 1 1  ON 15
 ud_6                -1.302412e-01 1 1  ON 16
 ud_7                -1.481176e-01 1 1  ON 17
 ud_8                -1.519089e-01 1 1  ON 18
 ud_9                -1.447737e-01 1 1  ON 19
 eO_0                -7.493479e-01 1 1  ON 20
 eO_1                -4.362097e-01 1 1  ON 21
 eO_2                -2.588707e-02 1 1  ON 22
 eO_3                 2.941037e-01 1 1  ON 23
 eO_4                 5.211136e-01 1 1  ON 24
 eO_5                 4.824063e-01 1 1  ON 25
 eO_6                 2.579394e-01 1 1  ON 26
 eO_7                -4.116409e-02 1 1  ON 27
 eO_8                -2.209732e-01 1 1  ON 28
 eO_9                -8.105706e-02 1 1  ON 29
eH1_0                -2.395511e-01 1 1  ON 30
eH1_1                -1.368501e-01 1 1  ON 31
eH1_2                -9.226128e-02 1 1  ON 32
eH1_3                -4.109657e-02 1 1  ON 33
eH1_4                 7.321749e-03 1 1  ON 34
eH1_5                 3.840552e-02 1 1  ON 35
eH1_6                 9.634302e-02 1 1  ON 36
eH1_7                 1.491697e-01 1 1  ON 37
eH1_8                 1.684635e-01 1 1  ON 38
eH1_9                 5.456708e-02 1 1  ON 39
eH2_0                -2.383018e-01 1 1  ON 40
eH2_1                -1.356036e-01 1 1  ON 41
eH2_2                -9.108321e-02 1 1  ON 42
eH2_3                -3.968090e-02 1 1  ON 43
eH2_4                 8.347711e-03 1 1  ON 44
eH2_5                 3.990707e-02 1 1  ON 45
eH2_6                 9.820463e-02 1 1  ON 46
eH2_7                 1.497055e-01 1 1  ON 47
eH2_8                 1.800388e-01 1 1  ON 48
eH2_9                 4.482470e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2765e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8773
    reference variance = 0.256987
====================================================
  Execution time = 4.6239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3089e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1976e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330661566162
                                         uncertainty =       0.004882715474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330661566162
                                         uncertainty =       0.004882715474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406746491
  error estimate for blocks of size 2^( 2) =       0.000418625104
  error estimate for blocks of size 2^( 3) =       0.000430433578
  error estimate for blocks of size 2^( 4) =       0.000442292066
  error estimate for blocks of size 2^( 5) =       0.000451655136
  error estimate for blocks of size 2^( 6) =       0.000457957290
  error estimate for blocks of size 2^( 7) =       0.000463533514

      target function =                  N/A
              le_mean =     -16.910119570839
             les_mean =     286.283029150819
             stat err =       0.000453859502
             autocorr =       1.245074199346
              std dev =       0.575226404301
             le_variance =       0.330885416205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691011957084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910119570839       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910119787780       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910119888682       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910119890289       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910119892766       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910119904078       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910119901772       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910119899964       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910119899841       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.340526e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910119570839       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910119625218       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910119650594       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910119651015       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910119651640       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910119654493       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910119653908       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910119653453       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910119653417       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 3.356374e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910119570839       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910119584442       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910119590796       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910119590902       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910119591059       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910119591774       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910119591624       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910119591514       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910119591501       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 8.394064e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8222e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.073471e-01 1 1  ON 0
 uu_1                 1.420479e-01 1 1  ON 1
 uu_2                 4.332155e-02 1 1  ON 2
 uu_3                -1.790740e-02 1 1  ON 3
 uu_4                -6.302247e-02 1 1  ON 4
 uu_5                -9.705616e-02 1 1  ON 5
 uu_6                -1.244119e-01 1 1  ON 6
 uu_7                -1.378432e-01 1 1  ON 7
 uu_8                -1.332487e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.353314e-01 1 1  ON 10
 ud_1                 1.775160e-01 1 1  ON 11
 ud_2                 6.410592e-02 1 1  ON 12
 ud_3                -4.534647e-03 1 1  ON 13
 ud_4                -6.087912e-02 1 1  ON 14
 ud_5                -1.025002e-01 1 1  ON 15
 ud_6                -1.302417e-01 1 1  ON 16
 ud_7                -1.481183e-01 1 1  ON 17
 ud_8                -1.519093e-01 1 1  ON 18
 ud_9                -1.447738e-01 1 1  ON 19
 eO_0                -7.493497e-01 1 1  ON 20
 eO_1                -4.362092e-01 1 1  ON 21
 eO_2                -2.588638e-02 1 1  ON 22
 eO_3                 2.941049e-01 1 1  ON 23
 eO_4                 5.211136e-01 1 1  ON 24
 eO_5                 4.824064e-01 1 1  ON 25
 eO_6                 2.579397e-01 1 1  ON 26
 eO_7                -4.116402e-02 1 1  ON 27
 eO_8                -2.209739e-01 1 1  ON 28
 eO_9                -8.105761e-02 1 1  ON 29
eH1_0                -2.395526e-01 1 1  ON 30
eH1_1                -1.368508e-01 1 1  ON 31
eH1_2                -9.226039e-02 1 1  ON 32
eH1_3                -4.109667e-02 1 1  ON 33
eH1_4                 7.321697e-03 1 1  ON 34
eH1_5                 3.840559e-02 1 1  ON 35
eH1_6                 9.634295e-02 1 1  ON 36
eH1_7                 1.491696e-01 1 1  ON 37
eH1_8                 1.684641e-01 1 1  ON 38
eH1_9                 5.456798e-02 1 1  ON 39
eH2_0                -2.383036e-01 1 1  ON 40
eH2_1                -1.356041e-01 1 1  ON 41
eH2_2                -9.108276e-02 1 1  ON 42
eH2_3                -3.968061e-02 1 1  ON 43
eH2_4                 8.347952e-03 1 1  ON 44
eH2_5                 3.990731e-02 1 1  ON 45
eH2_6                 9.820471e-02 1 1  ON 46
eH2_7                 1.497057e-01 1 1  ON 47
eH2_8                 1.800389e-01 1 1  ON 48
eH2_9                 4.482531e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8904
    reference variance = 0.199401
====================================================
  Execution time = 4.5194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2903e-01
  Total weights = 2.0000e+06
  Execution time = 4.8430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329054648435
                                         uncertainty =       0.003199000295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329054648435
                                         uncertainty =       0.003199000295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405604791
  error estimate for blocks of size 2^( 2) =       0.000418235475
  error estimate for blocks of size 2^( 3) =       0.000431390824
  error estimate for blocks of size 2^( 4) =       0.000443953798
  error estimate for blocks of size 2^( 5) =       0.000454662413
  error estimate for blocks of size 2^( 6) =       0.000463348911
  error estimate for blocks of size 2^( 7) =       0.000468844978

      target function =                  N/A
              le_mean =     -16.909091869071
             les_mean =     286.246418165054
             stat err =       0.000457702525
             autocorr =       1.273387155254
              std dev =       0.573611796336
             le_variance =       0.329030492896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329063465030
                                         uncertainty =       0.003199141678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329063465030
                                         uncertainty =       0.003199141678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405610223
  error estimate for blocks of size 2^( 2) =       0.000418240276
  error estimate for blocks of size 2^( 3) =       0.000431395044
  error estimate for blocks of size 2^( 4) =       0.000443957604
  error estimate for blocks of size 2^( 5) =       0.000454665795
  error estimate for blocks of size 2^( 6) =       0.000463351677
  error estimate for blocks of size 2^( 7) =       0.000468847855

      target function =                  N/A
              le_mean =     -16.909091970387
             les_mean =     286.246430403872
             stat err =       0.000457705733
             autocorr =       1.273370897329
              std dev =       0.573619477857
             le_variance =       0.329039305377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329059064966
                                         uncertainty =       0.003199071139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329059064966
                                         uncertainty =       0.003199071139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405607512
  error estimate for blocks of size 2^( 2) =       0.000418237879
  error estimate for blocks of size 2^( 3) =       0.000431392937
  error estimate for blocks of size 2^( 4) =       0.000443955703
  error estimate for blocks of size 2^( 5) =       0.000454664105
  error estimate for blocks of size 2^( 6) =       0.000463350294
  error estimate for blocks of size 2^( 7) =       0.000468846417

      target function =                  N/A
              le_mean =     -16.909091919610
             les_mean =     286.246424288663
             stat err =       0.000457704130
             autocorr =       1.273378999118
              std dev =       0.573615644272
             le_variance =       0.329034907354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329055200624
                                         uncertainty =       0.003199009155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329055200624
                                         uncertainty =       0.003199009155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405605131
  error estimate for blocks of size 2^( 2) =       0.000418235775
  error estimate for blocks of size 2^( 3) =       0.000431391088
  error estimate for blocks of size 2^( 4) =       0.000443954036
  error estimate for blocks of size 2^( 5) =       0.000454662625
  error estimate for blocks of size 2^( 6) =       0.000463349084
  error estimate for blocks of size 2^( 7) =       0.000468845158

      target function =                  N/A
              le_mean =     -16.909091875360
             les_mean =     286.246418929678
             stat err =       0.000457702726
             autocorr =       1.273386134802
              std dev =       0.573612277436
             le_variance =       0.329031044826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909091869071        initial
     6.1035e+01     6.1035e+02             1.3405e-05       -16.909091970387  <--
     2.4414e+02     2.4414e+03             3.3564e-06       -16.909091919610
     9.7656e+02     9.7656e+03             8.3941e-07       -16.909091875360

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 6.9579e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.073465e-01 1 1  ON 0
 uu_1                 1.420469e-01 1 1  ON 1
 uu_2                 4.332247e-02 1 1  ON 2
 uu_3                -1.790522e-02 1 1  ON 3
 uu_4                -6.302310e-02 1 1  ON 4
 uu_5                -9.705731e-02 1 1  ON 5
 uu_6                -1.244121e-01 1 1  ON 6
 uu_7                -1.378447e-01 1 1  ON 7
 uu_8                -1.332487e-01 1 1  ON 8
 uu_9                -1.047499e-01 1 1  ON 9
 ud_0                 4.353414e-01 1 1  ON 10
 ud_1                 1.775240e-01 1 1  ON 11
 ud_2                 6.410018e-02 1 1  ON 12
 ud_3                -4.540298e-03 1 1  ON 13
 ud_4                -6.087958e-02 1 1  ON 14
 ud_5                -1.025004e-01 1 1  ON 15
 ud_6                -1.302432e-01 1 1  ON 16
 ud_7                -1.481203e-01 1 1  ON 17
 ud_8                -1.519103e-01 1 1  ON 18
 ud_9                -1.447740e-01 1 1  ON 19
 eO_0                -7.493549e-01 1 1  ON 20
 eO_1                -4.362078e-01 1 1  ON 21
 eO_2                -2.588433e-02 1 1  ON 22
 eO_3                 2.941087e-01 1 1  ON 23
 eO_4                 5.211138e-01 1 1  ON 24
 eO_5                 4.824069e-01 1 1  ON 25
 eO_6                 2.579407e-01 1 1  ON 26
 eO_7                -4.116380e-02 1 1  ON 27
 eO_8                -2.209759e-01 1 1  ON 28
 eO_9                -8.105927e-02 1 1  ON 29
eH1_0                -2.395573e-01 1 1  ON 30
eH1_1                -1.368531e-01 1 1  ON 31
eH1_2                -9.225774e-02 1 1  ON 32
eH1_3                -4.109696e-02 1 1  ON 33
eH1_4                 7.321539e-03 1 1  ON 34
eH1_5                 3.840579e-02 1 1  ON 35
eH1_6                 9.634274e-02 1 1  ON 36
eH1_7                 1.491692e-01 1 1  ON 37
eH1_8                 1.684661e-01 1 1  ON 38
eH1_9                 5.457068e-02 1 1  ON 39
eH2_0                -2.383090e-01 1 1  ON 40
eH2_1                -1.356057e-01 1 1  ON 41
eH2_2                -9.108142e-02 1 1  ON 42
eH2_3                -3.967974e-02 1 1  ON 43
eH2_4                 8.348676e-03 1 1  ON 44
eH2_5                 3.990804e-02 1 1  ON 45
eH2_6                 9.820498e-02 1 1  ON 46
eH2_7                 1.497062e-01 1 1  ON 47
eH2_8                 1.800392e-01 1 1  ON 48
eH2_9                 4.482715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2781e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9601
    reference variance = 0.716263
====================================================
  Execution time = 4.6708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3134e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2146e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331338289666
                                         uncertainty =       0.003905648684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331338289666
                                         uncertainty =       0.003905648684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407026464
  error estimate for blocks of size 2^( 2) =       0.000419351833
  error estimate for blocks of size 2^( 3) =       0.000431852917
  error estimate for blocks of size 2^( 4) =       0.000444527203
  error estimate for blocks of size 2^( 5) =       0.000455421475
  error estimate for blocks of size 2^( 6) =       0.000465890221
  error estimate for blocks of size 2^( 7) =       0.000472048037

      target function =                  N/A
              le_mean =     -16.909515174172
             les_mean =     286.263044344831
             stat err =       0.000459471734
             autocorr =       1.274301821978
              std dev =       0.575622345773
             le_variance =       0.331341084953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690951517417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909515174172       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515617156       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909515800577       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909515737933       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909515730970       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909515769382       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909515821386       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909515818082       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909515813778       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 4.417018e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909515174172       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515286098       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909515333062       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909515317076       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909515314242       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909515323554       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909515336978       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909515336387       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909515335224       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.110763e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909515174172       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909515202228       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909515214040       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909515210023       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909515209246       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909515211552       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909515214935       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909515214803       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909515214506       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.780796e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8862e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.073467e-01 1 1  ON 0
 uu_1                 1.420472e-01 1 1  ON 1
 uu_2                 4.332529e-02 1 1  ON 2
 uu_3                -1.790296e-02 1 1  ON 3
 uu_4                -6.302352e-02 1 1  ON 4
 uu_5                -9.705886e-02 1 1  ON 5
 uu_6                -1.244142e-01 1 1  ON 6
 uu_7                -1.378489e-01 1 1  ON 7
 uu_8                -1.332487e-01 1 1  ON 8
 uu_9                -1.047503e-01 1 1  ON 9
 ud_0                 4.353526e-01 1 1  ON 10
 ud_1                 1.775330e-01 1 1  ON 11
 ud_2                 6.409259e-02 1 1  ON 12
 ud_3                -4.548958e-03 1 1  ON 13
 ud_4                -6.088170e-02 1 1  ON 14
 ud_5                -1.025009e-01 1 1  ON 15
 ud_6                -1.302434e-01 1 1  ON 16
 ud_7                -1.481194e-01 1 1  ON 17
 ud_8                -1.519100e-01 1 1  ON 18
 ud_9                -1.447753e-01 1 1  ON 19
 eO_0                -7.493619e-01 1 1  ON 20
 eO_1                -4.362093e-01 1 1  ON 21
 eO_2                -2.588275e-02 1 1  ON 22
 eO_3                 2.941161e-01 1 1  ON 23
 eO_4                 5.211148e-01 1 1  ON 24
 eO_5                 4.824081e-01 1 1  ON 25
 eO_6                 2.579411e-01 1 1  ON 26
 eO_7                -4.116188e-02 1 1  ON 27
 eO_8                -2.209775e-01 1 1  ON 28
 eO_9                -8.106202e-02 1 1  ON 29
eH1_0                -2.395657e-01 1 1  ON 30
eH1_1                -1.368571e-01 1 1  ON 31
eH1_2                -9.225511e-02 1 1  ON 32
eH1_3                -4.109616e-02 1 1  ON 33
eH1_4                 7.322261e-03 1 1  ON 34
eH1_5                 3.840710e-02 1 1  ON 35
eH1_6                 9.634315e-02 1 1  ON 36
eH1_7                 1.491692e-01 1 1  ON 37
eH1_8                 1.684693e-01 1 1  ON 38
eH1_9                 5.457392e-02 1 1  ON 39
eH2_0                -2.383158e-01 1 1  ON 40
eH2_1                -1.356083e-01 1 1  ON 41
eH2_2                -9.108010e-02 1 1  ON 42
eH2_3                -3.967921e-02 1 1  ON 43
eH2_4                 8.351626e-03 1 1  ON 44
eH2_5                 3.990761e-02 1 1  ON 45
eH2_6                 9.820523e-02 1 1  ON 46
eH2_7                 1.497061e-01 1 1  ON 47
eH2_8                 1.800405e-01 1 1  ON 48
eH2_9                 4.483039e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.199848
====================================================
  Execution time = 4.5266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3664e-01
  Total weights = 2.0000e+06
  Execution time = 4.8538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336696661889
                                         uncertainty =       0.003717189827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336696661889
                                         uncertainty =       0.003717189827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410262102
  error estimate for blocks of size 2^( 2) =       0.000422485021
  error estimate for blocks of size 2^( 3) =       0.000435076443
  error estimate for blocks of size 2^( 4) =       0.000447697156
  error estimate for blocks of size 2^( 5) =       0.000458537996
  error estimate for blocks of size 2^( 6) =       0.000466128993
  error estimate for blocks of size 2^( 7) =       0.000470370448

      target function =                  N/A
              le_mean =     -16.909329888451
             les_mean =     286.262067093523
             stat err =       0.000460683648
             autocorr =       1.260906236554
              std dev =       0.580198229386
             le_variance =       0.336629985383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336727098926
                                         uncertainty =       0.003717598367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336727098926
                                         uncertainty =       0.003717598367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410280635
  error estimate for blocks of size 2^( 2) =       0.000422501222
  error estimate for blocks of size 2^( 3) =       0.000435090542
  error estimate for blocks of size 2^( 4) =       0.000447709519
  error estimate for blocks of size 2^( 5) =       0.000458549463
  error estimate for blocks of size 2^( 6) =       0.000466139952
  error estimate for blocks of size 2^( 7) =       0.000470381736

      target function =                  N/A
              le_mean =     -16.909330021512
             les_mean =     286.262102006426
             stat err =       0.000460695168
             autocorr =       1.260855381272
              std dev =       0.580224437925
             le_variance =       0.336660398365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336711970418
                                         uncertainty =       0.003717396124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336711970418
                                         uncertainty =       0.003717396124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410271423
  error estimate for blocks of size 2^( 2) =       0.000422493159
  error estimate for blocks of size 2^( 3) =       0.000435083517
  error estimate for blocks of size 2^( 4) =       0.000447703353
  error estimate for blocks of size 2^( 5) =       0.000458543736
  error estimate for blocks of size 2^( 6) =       0.000466134477
  error estimate for blocks of size 2^( 7) =       0.000470376103

      target function =                  N/A
              le_mean =     -16.909329951041
             les_mean =     286.262084506537
             stat err =       0.000460689417
             autocorr =       1.260880521430
              std dev =       0.580211411214
             le_variance =       0.336645281703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336698576395
                                         uncertainty =       0.003717215676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336698576395
                                         uncertainty =       0.003717215676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410263268
  error estimate for blocks of size 2^( 2) =       0.000422486038
  error estimate for blocks of size 2^( 3) =       0.000435077326
  error estimate for blocks of size 2^( 4) =       0.000447697930
  error estimate for blocks of size 2^( 5) =       0.000458538713
  error estimate for blocks of size 2^( 6) =       0.000466129677
  error estimate for blocks of size 2^( 7) =       0.000470371154

      target function =                  N/A
              le_mean =     -16.909329895820
             les_mean =     286.262069255702
             stat err =       0.000460684368
             autocorr =       1.260903011824
              std dev =       0.580199877936
             le_variance =       0.336631898357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909329888451        initial
     1.5259e+01     1.5259e+02             4.4170e-05       -16.909330021512  <--
     6.1035e+01     6.1035e+02             1.1108e-05       -16.909329951041
     2.4414e+02     2.4414e+03             2.7808e-06       -16.909329895820

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 6.9604e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.073472e-01 1 1  ON 0
 uu_1                 1.420484e-01 1 1  ON 1
 uu_2                 4.333358e-02 1 1  ON 2
 uu_3                -1.789626e-02 1 1  ON 3
 uu_4                -6.302478e-02 1 1  ON 4
 uu_5                -9.706345e-02 1 1  ON 5
 uu_6                -1.244205e-01 1 1  ON 6
 uu_7                -1.378613e-01 1 1  ON 7
 uu_8                -1.332485e-01 1 1  ON 8
 uu_9                -1.047515e-01 1 1  ON 9
 ud_0                 4.353856e-01 1 1  ON 10
 ud_1                 1.775594e-01 1 1  ON 11
 ud_2                 6.407062e-02 1 1  ON 12
 ud_3                -4.574703e-03 1 1  ON 13
 ud_4                -6.088819e-02 1 1  ON 14
 ud_5                -1.025024e-01 1 1  ON 15
 ud_6                -1.302437e-01 1 1  ON 16
 ud_7                -1.481167e-01 1 1  ON 17
 ud_8                -1.519091e-01 1 1  ON 18
 ud_9                -1.447790e-01 1 1  ON 19
 eO_0                -7.493828e-01 1 1  ON 20
 eO_1                -4.362137e-01 1 1  ON 21
 eO_2                -2.587818e-02 1 1  ON 22
 eO_3                 2.941381e-01 1 1  ON 23
 eO_4                 5.211176e-01 1 1  ON 24
 eO_5                 4.824118e-01 1 1  ON 25
 eO_6                 2.579423e-01 1 1  ON 26
 eO_7                -4.115614e-02 1 1  ON 27
 eO_8                -2.209823e-01 1 1  ON 28
 eO_9                -8.107026e-02 1 1  ON 29
eH1_0                -2.395908e-01 1 1  ON 30
eH1_1                -1.368689e-01 1 1  ON 31
eH1_2                -9.224738e-02 1 1  ON 32
eH1_3                -4.109375e-02 1 1  ON 33
eH1_4                 7.324377e-03 1 1  ON 34
eH1_5                 3.841102e-02 1 1  ON 35
eH1_6                 9.634442e-02 1 1  ON 36
eH1_7                 1.491692e-01 1 1  ON 37
eH1_8                 1.684788e-01 1 1  ON 38
eH1_9                 5.458363e-02 1 1  ON 39
eH2_0                -2.383360e-01 1 1  ON 40
eH2_1                -1.356160e-01 1 1  ON 41
eH2_2                -9.107622e-02 1 1  ON 42
eH2_3                -3.967757e-02 1 1  ON 43
eH2_4                 8.360372e-03 1 1  ON 44
eH2_5                 3.990635e-02 1 1  ON 45
eH2_6                 9.820601e-02 1 1  ON 46
eH2_7                 1.497059e-01 1 1  ON 47
eH2_8                 1.800443e-01 1 1  ON 48
eH2_9                 4.484009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2847e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.316796
====================================================
  Execution time = 4.6287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1979e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329565637051
                                         uncertainty =       0.003673183859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329565637051
                                         uncertainty =       0.003673183859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406001109
  error estimate for blocks of size 2^( 2) =       0.000417973440
  error estimate for blocks of size 2^( 3) =       0.000430996453
  error estimate for blocks of size 2^( 4) =       0.000443905413
  error estimate for blocks of size 2^( 5) =       0.000455288671
  error estimate for blocks of size 2^( 6) =       0.000464323072
  error estimate for blocks of size 2^( 7) =       0.000471544036

      target function =                  N/A
              le_mean =     -16.910141689782
             les_mean =     286.282565604488
             stat err =       0.000458765298
             autocorr =       1.276811186331
              std dev =       0.574172274519
             le_variance =       0.329673800827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691014168978e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910141689782       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910144016230       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910145542523       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910145704618       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910145766085       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910145716299       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910145594639       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910145607094       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910145631575       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.801833e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910141689782       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910142296433       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910142707813       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910142755525       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910142776950       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910142766608       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910142734377       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910142733964       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910142738996       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 4.627459e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910141689782       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910141843095       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910141947985       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910141960427       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910141966218       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910141963877       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910141955737       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910141955346       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910141956537       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.163835e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8274e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.073457e-01 1 1  ON 0
 uu_1                 1.420479e-01 1 1  ON 1
 uu_2                 4.334336e-02 1 1  ON 2
 uu_3                -1.788564e-02 1 1  ON 3
 uu_4                -6.302269e-02 1 1  ON 4
 uu_5                -9.707753e-02 1 1  ON 5
 uu_6                -1.244295e-01 1 1  ON 6
 uu_7                -1.378692e-01 1 1  ON 7
 uu_8                -1.332417e-01 1 1  ON 8
 uu_9                -1.047542e-01 1 1  ON 9
 ud_0                 4.354319e-01 1 1  ON 10
 ud_1                 1.775955e-01 1 1  ON 11
 ud_2                 6.404477e-02 1 1  ON 12
 ud_3                -4.607334e-03 1 1  ON 13
 ud_4                -6.088778e-02 1 1  ON 14
 ud_5                -1.024968e-01 1 1  ON 15
 ud_6                -1.302470e-01 1 1  ON 16
 ud_7                -1.481264e-01 1 1  ON 17
 ud_8                -1.519093e-01 1 1  ON 18
 ud_9                -1.447848e-01 1 1  ON 19
 eO_0                -7.494139e-01 1 1  ON 20
 eO_1                -4.362152e-01 1 1  ON 21
 eO_2                -2.586948e-02 1 1  ON 22
 eO_3                 2.941660e-01 1 1  ON 23
 eO_4                 5.211212e-01 1 1  ON 24
 eO_5                 4.824195e-01 1 1  ON 25
 eO_6                 2.579434e-01 1 1  ON 26
 eO_7                -4.115207e-02 1 1  ON 27
 eO_8                -2.209895e-01 1 1  ON 28
 eO_9                -8.108093e-02 1 1  ON 29
eH1_0                -2.396207e-01 1 1  ON 30
eH1_1                -1.368797e-01 1 1  ON 31
eH1_2                -9.223114e-02 1 1  ON 32
eH1_3                -4.109072e-02 1 1  ON 33
eH1_4                 7.326049e-03 1 1  ON 34
eH1_5                 3.841139e-02 1 1  ON 35
eH1_6                 9.635001e-02 1 1  ON 36
eH1_7                 1.491675e-01 1 1  ON 37
eH1_8                 1.684877e-01 1 1  ON 38
eH1_9                 5.459300e-02 1 1  ON 39
eH2_0                -2.383589e-01 1 1  ON 40
eH2_1                -1.356273e-01 1 1  ON 41
eH2_2                -9.106784e-02 1 1  ON 42
eH2_3                -3.967660e-02 1 1  ON 43
eH2_4                 8.357207e-03 1 1  ON 44
eH2_5                 3.990822e-02 1 1  ON 45
eH2_6                 9.820574e-02 1 1  ON 46
eH2_7                 1.497093e-01 1 1  ON 47
eH2_8                 1.800514e-01 1 1  ON 48
eH2_9                 4.485421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.7871
    reference variance = 1.39071
====================================================
  Execution time = 4.5578e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4229e-01
  Total weights = 2.0000e+06
  Execution time = 4.8577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341995861239
                                         uncertainty =       0.006168213897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341995861239
                                         uncertainty =       0.006168213897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413675740
  error estimate for blocks of size 2^( 2) =       0.000425494932
  error estimate for blocks of size 2^( 3) =       0.000438078565
  error estimate for blocks of size 2^( 4) =       0.000450082832
  error estimate for blocks of size 2^( 5) =       0.000459742797
  error estimate for blocks of size 2^( 6) =       0.000466366407
  error estimate for blocks of size 2^( 7) =       0.000472073499

      target function =                  N/A
              le_mean =     -16.910022520987
             les_mean =     286.291116725197
             stat err =       0.000462066384
             autocorr =       1.247638139708
              std dev =       0.585025842208
             le_variance =       0.342255236051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342114680858
                                         uncertainty =       0.006171741481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342114680858
                                         uncertainty =       0.006171741481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413747735
  error estimate for blocks of size 2^( 2) =       0.000425559463
  error estimate for blocks of size 2^( 3) =       0.000438135338
  error estimate for blocks of size 2^( 4) =       0.000450133238
  error estimate for blocks of size 2^( 5) =       0.000459791621
  error estimate for blocks of size 2^( 6) =       0.000466409200
  error estimate for blocks of size 2^( 7) =       0.000472121915

      target function =                  N/A
              le_mean =     -16.910020166464
             les_mean =     286.291156235656
             stat err =       0.000462113993
             autocorr =       1.247461010321
              std dev =       0.585127658388
             le_variance =       0.342374376611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342057124496
                                         uncertainty =       0.006170072967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342057124496
                                         uncertainty =       0.006170072967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413712863
  error estimate for blocks of size 2^( 2) =       0.000425528108
  error estimate for blocks of size 2^( 3) =       0.000438107600
  error estimate for blocks of size 2^( 4) =       0.000450108512
  error estimate for blocks of size 2^( 5) =       0.000459767638
  error estimate for blocks of size 2^( 6) =       0.000466388029
  error estimate for blocks of size 2^( 7) =       0.000472098196

      target function =                  N/A
              le_mean =     -16.910021204670
             les_mean =     286.291133638072
             stat err =       0.000462090594
             autocorr =       1.247544963209
              std dev =       0.585078342481
             le_variance =       0.342316666840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342003545074
                                         uncertainty =       0.006168449382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342003545074
                                         uncertainty =       0.006168449382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413680397
  error estimate for blocks of size 2^( 2) =       0.000425499085
  error estimate for blocks of size 2^( 3) =       0.000438082189
  error estimate for blocks of size 2^( 4) =       0.000450086030
  error estimate for blocks of size 2^( 5) =       0.000459745889
  error estimate for blocks of size 2^( 6) =       0.000466369089
  error estimate for blocks of size 2^( 7) =       0.000472076575

      target function =                  N/A
              le_mean =     -16.910022346354
             les_mean =     286.291118524125
             stat err =       0.000462069396
             autocorr =       1.247626318505
              std dev =       0.585032427353
             le_variance =       0.342262941055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910022520987        initial  <--
     3.8147e+00     3.8147e+01             1.8018e-04       -16.910020166464
     1.5259e+01     1.5259e+02             4.6275e-05       -16.910021204670
     6.1035e+01     6.1035e+02             1.1638e-05       -16.910022346354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.9799
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.073472e-01 1 1  ON 0
 uu_1                 1.420484e-01 1 1  ON 1
 uu_2                 4.333358e-02 1 1  ON 2
 uu_3                -1.789626e-02 1 1  ON 3
 uu_4                -6.302478e-02 1 1  ON 4
 uu_5                -9.706345e-02 1 1  ON 5
 uu_6                -1.244205e-01 1 1  ON 6
 uu_7                -1.378613e-01 1 1  ON 7
 uu_8                -1.332485e-01 1 1  ON 8
 uu_9                -1.047515e-01 1 1  ON 9
 ud_0                 4.353856e-01 1 1  ON 10
 ud_1                 1.775594e-01 1 1  ON 11
 ud_2                 6.407062e-02 1 1  ON 12
 ud_3                -4.574703e-03 1 1  ON 13
 ud_4                -6.088819e-02 1 1  ON 14
 ud_5                -1.025024e-01 1 1  ON 15
 ud_6                -1.302437e-01 1 1  ON 16
 ud_7                -1.481167e-01 1 1  ON 17
 ud_8                -1.519091e-01 1 1  ON 18
 ud_9                -1.447790e-01 1 1  ON 19
 eO_0                -7.493828e-01 1 1  ON 20
 eO_1                -4.362137e-01 1 1  ON 21
 eO_2                -2.587818e-02 1 1  ON 22
 eO_3                 2.941381e-01 1 1  ON 23
 eO_4                 5.211176e-01 1 1  ON 24
 eO_5                 4.824118e-01 1 1  ON 25
 eO_6                 2.579423e-01 1 1  ON 26
 eO_7                -4.115614e-02 1 1  ON 27
 eO_8                -2.209823e-01 1 1  ON 28
 eO_9                -8.107026e-02 1 1  ON 29
eH1_0                -2.395908e-01 1 1  ON 30
eH1_1                -1.368689e-01 1 1  ON 31
eH1_2                -9.224738e-02 1 1  ON 32
eH1_3                -4.109375e-02 1 1  ON 33
eH1_4                 7.324377e-03 1 1  ON 34
eH1_5                 3.841102e-02 1 1  ON 35
eH1_6                 9.634442e-02 1 1  ON 36
eH1_7                 1.491692e-01 1 1  ON 37
eH1_8                 1.684788e-01 1 1  ON 38
eH1_9                 5.458363e-02 1 1  ON 39
eH2_0                -2.383360e-01 1 1  ON 40
eH2_1                -1.356160e-01 1 1  ON 41
eH2_2                -9.107622e-02 1 1  ON 42
eH2_3                -3.967757e-02 1 1  ON 43
eH2_4                 8.360372e-03 1 1  ON 44
eH2_5                 3.990635e-02 1 1  ON 45
eH2_6                 9.820601e-02 1 1  ON 46
eH2_7                 1.497059e-01 1 1  ON 47
eH2_8                 1.800443e-01 1 1  ON 48
eH2_9                 4.484009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2826e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8717
    reference variance = 0.434875
====================================================
  Execution time = 4.6929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2220e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2027e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322212829849
                                         uncertainty =       0.002642695911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322212829849
                                         uncertainty =       0.002642695911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401372050
  error estimate for blocks of size 2^( 2) =       0.000412998845
  error estimate for blocks of size 2^( 3) =       0.000425959568
  error estimate for blocks of size 2^( 4) =       0.000437878354
  error estimate for blocks of size 2^( 5) =       0.000448316567
  error estimate for blocks of size 2^( 6) =       0.000455335008
  error estimate for blocks of size 2^( 7) =       0.000458414553

      target function =                  N/A
              le_mean =     -16.909988785573
             les_mean =     286.269919611526
             stat err =       0.000449986120
             autocorr =       1.256909429760
              std dev =       0.567625796108
             le_variance =       0.322199044407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690998878557e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909988785573       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909988919014       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909988931599       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909988965180       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909988995903       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909989017296       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909989025622       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909989030986       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909989030169       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 2.138728e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909988785573       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909988819075       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909988822234       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909988830662       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909988838321       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909988843712       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909988845790       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909988847159       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909988846960       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 5.365020e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909988785573       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909988793958       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909988794748       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909988796858       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909988798770       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909988800121       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909988800640       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909988800986       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909988800934       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 1.342387e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8964e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.073468e-01 1 1  ON 0
 uu_1                 1.420478e-01 1 1  ON 1
 uu_2                 4.333397e-02 1 1  ON 2
 uu_3                -1.789530e-02 1 1  ON 3
 uu_4                -6.302547e-02 1 1  ON 4
 uu_5                -9.706416e-02 1 1  ON 5
 uu_6                -1.244214e-01 1 1  ON 6
 uu_7                -1.378616e-01 1 1  ON 7
 uu_8                -1.332476e-01 1 1  ON 8
 uu_9                -1.047515e-01 1 1  ON 9
 ud_0                 4.353910e-01 1 1  ON 10
 ud_1                 1.775628e-01 1 1  ON 11
 ud_2                 6.406791e-02 1 1  ON 12
 ud_3                -4.578225e-03 1 1  ON 13
 ud_4                -6.088845e-02 1 1  ON 14
 ud_5                -1.025032e-01 1 1  ON 15
 ud_6                -1.302448e-01 1 1  ON 16
 ud_7                -1.481179e-01 1 1  ON 17
 ud_8                -1.519084e-01 1 1  ON 18
 ud_9                -1.447788e-01 1 1  ON 19
 eO_0                -7.493857e-01 1 1  ON 20
 eO_1                -4.362139e-01 1 1  ON 21
 eO_2                -2.587678e-02 1 1  ON 22
 eO_3                 2.941405e-01 1 1  ON 23
 eO_4                 5.211176e-01 1 1  ON 24
 eO_5                 4.824123e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115574e-02 1 1  ON 27
 eO_8                -2.209827e-01 1 1  ON 28
 eO_9                -8.107112e-02 1 1  ON 29
eH1_0                -2.395938e-01 1 1  ON 30
eH1_1                -1.368703e-01 1 1  ON 31
eH1_2                -9.224599e-02 1 1  ON 32
eH1_3                -4.109374e-02 1 1  ON 33
eH1_4                 7.324041e-03 1 1  ON 34
eH1_5                 3.841117e-02 1 1  ON 35
eH1_6                 9.634503e-02 1 1  ON 36
eH1_7                 1.491695e-01 1 1  ON 37
eH1_8                 1.684801e-01 1 1  ON 38
eH1_9                 5.458474e-02 1 1  ON 39
eH2_0                -2.383388e-01 1 1  ON 40
eH2_1                -1.356176e-01 1 1  ON 41
eH2_2                -9.107522e-02 1 1  ON 42
eH2_3                -3.967820e-02 1 1  ON 43
eH2_4                 8.361549e-03 1 1  ON 44
eH2_5                 3.990636e-02 1 1  ON 45
eH2_6                 9.820628e-02 1 1  ON 46
eH2_7                 1.497059e-01 1 1  ON 47
eH2_8                 1.800451e-01 1 1  ON 48
eH2_9                 4.484173e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.323318
====================================================
  Execution time = 4.5436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3255e-01
  Total weights = 2.0000e+06
  Execution time = 4.8638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332478562710
                                         uncertainty =       0.006031597642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332478562710
                                         uncertainty =       0.006031597642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407766614
  error estimate for blocks of size 2^( 2) =       0.000419815457
  error estimate for blocks of size 2^( 3) =       0.000432199877
  error estimate for blocks of size 2^( 4) =       0.000444215910
  error estimate for blocks of size 2^( 5) =       0.000455719057
  error estimate for blocks of size 2^( 6) =       0.000464201077
  error estimate for blocks of size 2^( 7) =       0.000470806659

      target function =                  N/A
              le_mean =     -16.909153350201
             les_mean =     286.252014077335
             stat err =       0.000458735676
             autocorr =       1.265615260831
              std dev =       0.576669075811
             le_variance =       0.332547222996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332492853570
                                         uncertainty =       0.006031810766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332492853570
                                         uncertainty =       0.006031810766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407775379
  error estimate for blocks of size 2^( 2) =       0.000419823206
  error estimate for blocks of size 2^( 3) =       0.000432206691
  error estimate for blocks of size 2^( 4) =       0.000444222155
  error estimate for blocks of size 2^( 5) =       0.000455724711
  error estimate for blocks of size 2^( 6) =       0.000464206301
  error estimate for blocks of size 2^( 7) =       0.000470811191

      target function =                  N/A
              le_mean =     -16.909153374667
             les_mean =     286.252029201798
             stat err =       0.000458741090
             autocorr =       1.265590722984
              std dev =       0.576681471916
             le_variance =       0.332561520051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332485735240
                                         uncertainty =       0.006031704370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332485735240
                                         uncertainty =       0.006031704370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407771013
  error estimate for blocks of size 2^( 2) =       0.000419819345
  error estimate for blocks of size 2^( 3) =       0.000432203294
  error estimate for blocks of size 2^( 4) =       0.000444219042
  error estimate for blocks of size 2^( 5) =       0.000455721892
  error estimate for blocks of size 2^( 6) =       0.000464203695
  error estimate for blocks of size 2^( 7) =       0.000470808928

      target function =                  N/A
              le_mean =     -16.909153361738
             les_mean =     286.252021643129
             stat err =       0.000458738389
             autocorr =       1.265602923284
              std dev =       0.576675297395
             le_variance =       0.332554398626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332479459851
                                         uncertainty =       0.006031610987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332479459851
                                         uncertainty =       0.006031610987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407767164
  error estimate for blocks of size 2^( 2) =       0.000419815943
  error estimate for blocks of size 2^( 3) =       0.000432200304
  error estimate for blocks of size 2^( 4) =       0.000444216301
  error estimate for blocks of size 2^( 5) =       0.000455719411
  error estimate for blocks of size 2^( 6) =       0.000464201404
  error estimate for blocks of size 2^( 7) =       0.000470806943

      target function =                  N/A
              le_mean =     -16.909153351571
             les_mean =     286.252015021191
             stat err =       0.000458736015
             autocorr =       1.265613716277
              std dev =       0.576669854011
             le_variance =       0.332548120525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909153350201        initial
     3.8147e+01     3.8147e+02             2.1387e-05       -16.909153374667  <--
     1.5259e+02     1.5259e+03             5.3650e-06       -16.909153361738
     6.1035e+02     6.1035e+03             1.3424e-06       -16.909153351571

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 6.9761e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.073454e-01 1 1  ON 0
 uu_1                 1.420461e-01 1 1  ON 1
 uu_2                 4.333510e-02 1 1  ON 2
 uu_3                -1.789247e-02 1 1  ON 3
 uu_4                -6.302754e-02 1 1  ON 4
 uu_5                -9.706628e-02 1 1  ON 5
 uu_6                -1.244239e-01 1 1  ON 6
 uu_7                -1.378627e-01 1 1  ON 7
 uu_8                -1.332449e-01 1 1  ON 8
 uu_9                -1.047514e-01 1 1  ON 9
 ud_0                 4.354070e-01 1 1  ON 10
 ud_1                 1.775727e-01 1 1  ON 11
 ud_2                 6.405990e-02 1 1  ON 12
 ud_3                -4.588737e-03 1 1  ON 13
 ud_4                -6.088928e-02 1 1  ON 14
 ud_5                -1.025054e-01 1 1  ON 15
 ud_6                -1.302479e-01 1 1  ON 16
 ud_7                -1.481213e-01 1 1  ON 17
 ud_8                -1.519062e-01 1 1  ON 18
 ud_9                -1.447782e-01 1 1  ON 19
 eO_0                -7.493944e-01 1 1  ON 20
 eO_1                -4.362145e-01 1 1  ON 21
 eO_2                -2.587262e-02 1 1  ON 22
 eO_3                 2.941476e-01 1 1  ON 23
 eO_4                 5.211176e-01 1 1  ON 24
 eO_5                 4.824140e-01 1 1  ON 25
 eO_6                 2.579416e-01 1 1  ON 26
 eO_7                -4.115453e-02 1 1  ON 27
 eO_8                -2.209841e-01 1 1  ON 28
 eO_9                -8.107373e-02 1 1  ON 29
eH1_0                -2.396027e-01 1 1  ON 30
eH1_1                -1.368745e-01 1 1  ON 31
eH1_2                -9.224185e-02 1 1  ON 32
eH1_3                -4.109372e-02 1 1  ON 33
eH1_4                 7.323034e-03 1 1  ON 34
eH1_5                 3.841162e-02 1 1  ON 35
eH1_6                 9.634687e-02 1 1  ON 36
eH1_7                 1.491702e-01 1 1  ON 37
eH1_8                 1.684839e-01 1 1  ON 38
eH1_9                 5.458806e-02 1 1  ON 39
eH2_0                -2.383471e-01 1 1  ON 40
eH2_1                -1.356223e-01 1 1  ON 41
eH2_2                -9.107226e-02 1 1  ON 42
eH2_3                -3.968006e-02 1 1  ON 43
eH2_4                 8.365060e-03 1 1  ON 44
eH2_5                 3.990642e-02 1 1  ON 45
eH2_6                 9.820711e-02 1 1  ON 46
eH2_7                 1.497058e-01 1 1  ON 47
eH2_8                 1.800476e-01 1 1  ON 48
eH2_9                 4.484665e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2873e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9887
    reference variance = 0.278439
====================================================
  Execution time = 4.6117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3102e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2070e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331036736284
                                         uncertainty =       0.003462529191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331036736284
                                         uncertainty =       0.003462529191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406829162
  error estimate for blocks of size 2^( 2) =       0.000419213329
  error estimate for blocks of size 2^( 3) =       0.000432003734
  error estimate for blocks of size 2^( 4) =       0.000444203563
  error estimate for blocks of size 2^( 5) =       0.000453792994
  error estimate for blocks of size 2^( 6) =       0.000463509596
  error estimate for blocks of size 2^( 7) =       0.000467184854

      target function =                  N/A
              le_mean =     -16.909093516799
             les_mean =     286.248463328728
             stat err =       0.000457172752
             autocorr =       1.262805670148
              std dev =       0.575343318697
             le_variance =       0.331019934370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690909351680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909093516799       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909094531979       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909095091994       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909095188127       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909095451088       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909095516601       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909095543917       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909095500532       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909095502875       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 7.246303e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909093516799       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909093774918       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909093919230       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909093943728       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909094008526       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909094026527       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909094033260       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909094022864       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909094023743       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.838015e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909093516799       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909093581605       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909093617963       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909093624119       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909093640258       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909093644857       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909093646535       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909093643963       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909093644205       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 4.611227e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8194e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.073439e-01 1 1  ON 0
 uu_1                 1.420437e-01 1 1  ON 1
 uu_2                 4.334057e-02 1 1  ON 2
 uu_3                -1.789136e-02 1 1  ON 3
 uu_4                -6.302772e-02 1 1  ON 4
 uu_5                -9.707083e-02 1 1  ON 5
 uu_6                -1.244289e-01 1 1  ON 6
 uu_7                -1.378668e-01 1 1  ON 7
 uu_8                -1.332411e-01 1 1  ON 8
 uu_9                -1.047496e-01 1 1  ON 9
 ud_0                 4.354254e-01 1 1  ON 10
 ud_1                 1.775841e-01 1 1  ON 11
 ud_2                 6.404505e-02 1 1  ON 12
 ud_3                -4.602592e-03 1 1  ON 13
 ud_4                -6.089359e-02 1 1  ON 14
 ud_5                -1.025071e-01 1 1  ON 15
 ud_6                -1.302525e-01 1 1  ON 16
 ud_7                -1.481227e-01 1 1  ON 17
 ud_8                -1.519017e-01 1 1  ON 18
 ud_9                -1.447740e-01 1 1  ON 19
 eO_0                -7.494095e-01 1 1  ON 20
 eO_1                -4.362154e-01 1 1  ON 21
 eO_2                -2.586826e-02 1 1  ON 22
 eO_3                 2.941582e-01 1 1  ON 23
 eO_4                 5.211208e-01 1 1  ON 24
 eO_5                 4.824166e-01 1 1  ON 25
 eO_6                 2.579409e-01 1 1  ON 26
 eO_7                -4.115372e-02 1 1  ON 27
 eO_8                -2.209859e-01 1 1  ON 28
 eO_9                -8.107640e-02 1 1  ON 29
eH1_0                -2.396166e-01 1 1  ON 30
eH1_1                -1.368777e-01 1 1  ON 31
eH1_2                -9.223574e-02 1 1  ON 32
eH1_3                -4.109523e-02 1 1  ON 33
eH1_4                 7.323915e-03 1 1  ON 34
eH1_5                 3.841049e-02 1 1  ON 35
eH1_6                 9.634858e-02 1 1  ON 36
eH1_7                 1.491722e-01 1 1  ON 37
eH1_8                 1.684878e-01 1 1  ON 38
eH1_9                 5.459300e-02 1 1  ON 39
eH2_0                -2.383569e-01 1 1  ON 40
eH2_1                -1.356241e-01 1 1  ON 41
eH2_2                -9.106969e-02 1 1  ON 42
eH2_3                -3.968334e-02 1 1  ON 43
eH2_4                 8.364857e-03 1 1  ON 44
eH2_5                 3.990516e-02 1 1  ON 45
eH2_6                 9.820739e-02 1 1  ON 46
eH2_7                 1.497067e-01 1 1  ON 47
eH2_8                 1.800512e-01 1 1  ON 48
eH2_9                 4.485440e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9907
    reference variance = 0.402668
====================================================
  Execution time = 4.5357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2495e-01
  Total weights = 2.0000e+06
  Execution time = 4.8363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324952495414
                                         uncertainty =       0.003084143727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324952495414
                                         uncertainty =       0.003084143727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403072297
  error estimate for blocks of size 2^( 2) =       0.000415145096
  error estimate for blocks of size 2^( 3) =       0.000427688070
  error estimate for blocks of size 2^( 4) =       0.000438740556
  error estimate for blocks of size 2^( 5) =       0.000448393766
  error estimate for blocks of size 2^( 6) =       0.000455675739
  error estimate for blocks of size 2^( 7) =       0.000460925344

      target function =                  N/A
              le_mean =     -16.910151245010
             les_mean =     286.278149519438
             stat err =       0.000450933851
             autocorr =       1.251583352064
              std dev =       0.570030308672
             le_variance =       0.324934552805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325007136008
                                         uncertainty =       0.003084545947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325007136008
                                         uncertainty =       0.003084545947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403106187
  error estimate for blocks of size 2^( 2) =       0.000415175259
  error estimate for blocks of size 2^( 3) =       0.000427714270
  error estimate for blocks of size 2^( 4) =       0.000438764415
  error estimate for blocks of size 2^( 5) =       0.000448416400
  error estimate for blocks of size 2^( 6) =       0.000455697432
  error estimate for blocks of size 2^( 7) =       0.000460945573

      target function =                  N/A
              le_mean =     -16.910150876261
             les_mean =     286.278191691324
             stat err =       0.000450955955
             autocorr =       1.251495595435
              std dev =       0.570078236652
             le_variance =       0.324989195904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324980204826
                                         uncertainty =       0.003084347653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324980204826
                                         uncertainty =       0.003084347653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403089484
  error estimate for blocks of size 2^( 2) =       0.000415160369
  error estimate for blocks of size 2^( 3) =       0.000427701311
  error estimate for blocks of size 2^( 4) =       0.000438752606
  error estimate for blocks of size 2^( 5) =       0.000448405193
  error estimate for blocks of size 2^( 6) =       0.000455686674
  error estimate for blocks of size 2^( 7) =       0.000460935527

      target function =                  N/A
              le_mean =     -16.910151043429
             les_mean =     286.278170412594
             stat err =       0.000450945000
             autocorr =       1.251538506498
              std dev =       0.570054614483
             le_variance =       0.324962263494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324955966241
                                         uncertainty =       0.003084169301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324955966241
                                         uncertainty =       0.003084169301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403074450
  error estimate for blocks of size 2^( 2) =       0.000415147008
  error estimate for blocks of size 2^( 3) =       0.000427689726
  error estimate for blocks of size 2^( 4) =       0.000438742062
  error estimate for blocks of size 2^( 5) =       0.000448395194
  error estimate for blocks of size 2^( 6) =       0.000455677105
  error estimate for blocks of size 2^( 7) =       0.000460926615

      target function =                  N/A
              le_mean =     -16.910151218400
             les_mean =     286.278152090464
             stat err =       0.000450935244
             autocorr =       1.251577712287
              std dev =       0.570033353227
             le_variance =       0.324938023791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910151245010        initial  <--
     9.5367e+00     9.5367e+01             7.2463e-05       -16.910150876261
     3.8147e+01     3.8147e+02             1.8380e-05       -16.910151043429
     1.5259e+02     1.5259e+03             4.6112e-06       -16.910151218400

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.6559
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.073454e-01 1 1  ON 0
 uu_1                 1.420461e-01 1 1  ON 1
 uu_2                 4.333510e-02 1 1  ON 2
 uu_3                -1.789247e-02 1 1  ON 3
 uu_4                -6.302754e-02 1 1  ON 4
 uu_5                -9.706628e-02 1 1  ON 5
 uu_6                -1.244239e-01 1 1  ON 6
 uu_7                -1.378627e-01 1 1  ON 7
 uu_8                -1.332449e-01 1 1  ON 8
 uu_9                -1.047514e-01 1 1  ON 9
 ud_0                 4.354070e-01 1 1  ON 10
 ud_1                 1.775727e-01 1 1  ON 11
 ud_2                 6.405990e-02 1 1  ON 12
 ud_3                -4.588737e-03 1 1  ON 13
 ud_4                -6.088928e-02 1 1  ON 14
 ud_5                -1.025054e-01 1 1  ON 15
 ud_6                -1.302479e-01 1 1  ON 16
 ud_7                -1.481213e-01 1 1  ON 17
 ud_8                -1.519062e-01 1 1  ON 18
 ud_9                -1.447782e-01 1 1  ON 19
 eO_0                -7.493944e-01 1 1  ON 20
 eO_1                -4.362145e-01 1 1  ON 21
 eO_2                -2.587262e-02 1 1  ON 22
 eO_3                 2.941476e-01 1 1  ON 23
 eO_4                 5.211176e-01 1 1  ON 24
 eO_5                 4.824140e-01 1 1  ON 25
 eO_6                 2.579416e-01 1 1  ON 26
 eO_7                -4.115453e-02 1 1  ON 27
 eO_8                -2.209841e-01 1 1  ON 28
 eO_9                -8.107373e-02 1 1  ON 29
eH1_0                -2.396027e-01 1 1  ON 30
eH1_1                -1.368745e-01 1 1  ON 31
eH1_2                -9.224185e-02 1 1  ON 32
eH1_3                -4.109372e-02 1 1  ON 33
eH1_4                 7.323034e-03 1 1  ON 34
eH1_5                 3.841162e-02 1 1  ON 35
eH1_6                 9.634687e-02 1 1  ON 36
eH1_7                 1.491702e-01 1 1  ON 37
eH1_8                 1.684839e-01 1 1  ON 38
eH1_9                 5.458806e-02 1 1  ON 39
eH2_0                -2.383471e-01 1 1  ON 40
eH2_1                -1.356223e-01 1 1  ON 41
eH2_2                -9.107226e-02 1 1  ON 42
eH2_3                -3.968006e-02 1 1  ON 43
eH2_4                 8.365060e-03 1 1  ON 44
eH2_5                 3.990642e-02 1 1  ON 45
eH2_6                 9.820711e-02 1 1  ON 46
eH2_7                 1.497058e-01 1 1  ON 47
eH2_8                 1.800476e-01 1 1  ON 48
eH2_9                 4.484665e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2786e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8525
    reference variance = 0.338877
====================================================
  Execution time = 4.7513e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3201e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2047e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332091187739
                                         uncertainty =       0.004028653722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332091187739
                                         uncertainty =       0.004028653722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407437897
  error estimate for blocks of size 2^( 2) =       0.000419421023
  error estimate for blocks of size 2^( 3) =       0.000431971978
  error estimate for blocks of size 2^( 4) =       0.000444860937
  error estimate for blocks of size 2^( 5) =       0.000456841336
  error estimate for blocks of size 2^( 6) =       0.000468777235
  error estimate for blocks of size 2^( 7) =       0.000475808536

      target function =                  N/A
              le_mean =     -16.909977692360
             les_mean =     286.279356669737
             stat err =       0.000461572011
             autocorr =       1.283382430891
              std dev =       0.576204199583
             le_variance =       0.332011279617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690997769236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909977692360       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909977783880       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909977807101       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909977813588       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909977814681       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909977822438       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909977820533       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909977822256       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909977822141       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 5.590795e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909977692360       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909977715280       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909977721111       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909977722743       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909977723021       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909977724970       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909977724489       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909977724916       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909977724886       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.398455e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909977692360       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909977698093       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909977699552       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909977699961       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909977700030       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909977700512       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909977700399       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909977700505       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909977700490       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 3.496601e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9568e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.073452e-01 1 1  ON 0
 uu_1                 1.420460e-01 1 1  ON 1
 uu_2                 4.333533e-02 1 1  ON 2
 uu_3                -1.789229e-02 1 1  ON 3
 uu_4                -6.302767e-02 1 1  ON 4
 uu_5                -9.706693e-02 1 1  ON 5
 uu_6                -1.244241e-01 1 1  ON 6
 uu_7                -1.378628e-01 1 1  ON 7
 uu_8                -1.332446e-01 1 1  ON 8
 uu_9                -1.047512e-01 1 1  ON 9
 ud_0                 4.354084e-01 1 1  ON 10
 ud_1                 1.775740e-01 1 1  ON 11
 ud_2                 6.405871e-02 1 1  ON 12
 ud_3                -4.589922e-03 1 1  ON 13
 ud_4                -6.088929e-02 1 1  ON 14
 ud_5                -1.025054e-01 1 1  ON 15
 ud_6                -1.302485e-01 1 1  ON 16
 ud_7                -1.481215e-01 1 1  ON 17
 ud_8                -1.519059e-01 1 1  ON 18
 ud_9                -1.447779e-01 1 1  ON 19
 eO_0                -7.493958e-01 1 1  ON 20
 eO_1                -4.362144e-01 1 1  ON 21
 eO_2                -2.587226e-02 1 1  ON 22
 eO_3                 2.941486e-01 1 1  ON 23
 eO_4                 5.211176e-01 1 1  ON 24
 eO_5                 4.824142e-01 1 1  ON 25
 eO_6                 2.579416e-01 1 1  ON 26
 eO_7                -4.115442e-02 1 1  ON 27
 eO_8                -2.209842e-01 1 1  ON 28
 eO_9                -8.107402e-02 1 1  ON 29
eH1_0                -2.396039e-01 1 1  ON 30
eH1_1                -1.368751e-01 1 1  ON 31
eH1_2                -9.224161e-02 1 1  ON 32
eH1_3                -4.109353e-02 1 1  ON 33
eH1_4                 7.323148e-03 1 1  ON 34
eH1_5                 3.841132e-02 1 1  ON 35
eH1_6                 9.634674e-02 1 1  ON 36
eH1_7                 1.491704e-01 1 1  ON 37
eH1_8                 1.684846e-01 1 1  ON 38
eH1_9                 5.458871e-02 1 1  ON 39
eH2_0                -2.383482e-01 1 1  ON 40
eH2_1                -1.356227e-01 1 1  ON 41
eH2_2                -9.107170e-02 1 1  ON 42
eH2_3                -3.968005e-02 1 1  ON 43
eH2_4                 8.365047e-03 1 1  ON 44
eH2_5                 3.990631e-02 1 1  ON 45
eH2_6                 9.820727e-02 1 1  ON 46
eH2_7                 1.497060e-01 1 1  ON 47
eH2_8                 1.800478e-01 1 1  ON 48
eH2_9                 4.484718e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9331
    reference variance = 0.293279
====================================================
  Execution time = 4.6528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2238e-01
  Total weights = 2.0000e+06
  Execution time = 4.8340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322449429524
                                         uncertainty =       0.003592028982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322449429524
                                         uncertainty =       0.003592028982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401483375
  error estimate for blocks of size 2^( 2) =       0.000413794019
  error estimate for blocks of size 2^( 3) =       0.000426086077
  error estimate for blocks of size 2^( 4) =       0.000438060040
  error estimate for blocks of size 2^( 5) =       0.000448682987
  error estimate for blocks of size 2^( 6) =       0.000457518991
  error estimate for blocks of size 2^( 7) =       0.000461621539

      target function =                  N/A
              le_mean =     -16.911507724744
             les_mean =     286.321471163868
             stat err =       0.000451470889
             autocorr =       1.264516125509
              std dev =       0.567783234157
             le_variance =       0.322377800990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322453127503
                                         uncertainty =       0.003592149396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322453127503
                                         uncertainty =       0.003592149396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401485676
  error estimate for blocks of size 2^( 2) =       0.000413795987
  error estimate for blocks of size 2^( 3) =       0.000426087700
  error estimate for blocks of size 2^( 4) =       0.000438061469
  error estimate for blocks of size 2^( 5) =       0.000448684317
  error estimate for blocks of size 2^( 6) =       0.000457520340
  error estimate for blocks of size 2^( 7) =       0.000461622847

      target function =                  N/A
              le_mean =     -16.911507735072
             les_mean =     286.321475208148
             stat err =       0.000451472243
             autocorr =       1.264509217793
              std dev =       0.567786487999
             le_variance =       0.322381495954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322451279245
                                         uncertainty =       0.003592089266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322451279245
                                         uncertainty =       0.003592089266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484526
  error estimate for blocks of size 2^( 2) =       0.000413795003
  error estimate for blocks of size 2^( 3) =       0.000426086888
  error estimate for blocks of size 2^( 4) =       0.000438060754
  error estimate for blocks of size 2^( 5) =       0.000448683651
  error estimate for blocks of size 2^( 6) =       0.000457519665
  error estimate for blocks of size 2^( 7) =       0.000461622192

      target function =                  N/A
              le_mean =     -16.911507729840
             les_mean =     286.321473184438
             stat err =       0.000451471566
             autocorr =       1.264512664423
              std dev =       0.567784861722
             le_variance =       0.322379649200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322449660723
                                         uncertainty =       0.003592036520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322449660723
                                         uncertainty =       0.003592036520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401483519
  error estimate for blocks of size 2^( 2) =       0.000413794142
  error estimate for blocks of size 2^( 3) =       0.000426086178
  error estimate for blocks of size 2^( 4) =       0.000438060129
  error estimate for blocks of size 2^( 5) =       0.000448683070
  error estimate for blocks of size 2^( 6) =       0.000457519075
  error estimate for blocks of size 2^( 7) =       0.000461621621

      target function =                  N/A
              le_mean =     -16.911507725372
             les_mean =     286.321471416117
             stat err =       0.000451470974
             autocorr =       1.264515692618
              std dev =       0.567783437588
             le_variance =       0.322378031999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911507724744        initial
     9.5367e+01     9.5367e+02             5.5908e-06       -16.911507735072  <--
     3.8147e+02     3.8147e+03             1.3985e-06       -16.911507729840
     1.5259e+03     1.5259e+04             3.4966e-07       -16.911507725372

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 7.0837e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.073445e-01 1 1  ON 0
 uu_1                 1.420458e-01 1 1  ON 1
 uu_2                 4.333602e-02 1 1  ON 2
 uu_3                -1.789178e-02 1 1  ON 3
 uu_4                -6.302805e-02 1 1  ON 4
 uu_5                -9.706889e-02 1 1  ON 5
 uu_6                -1.244245e-01 1 1  ON 6
 uu_7                -1.378632e-01 1 1  ON 7
 uu_8                -1.332439e-01 1 1  ON 8
 uu_9                -1.047507e-01 1 1  ON 9
 ud_0                 4.354126e-01 1 1  ON 10
 ud_1                 1.775779e-01 1 1  ON 11
 ud_2                 6.405516e-02 1 1  ON 12
 ud_3                -4.593473e-03 1 1  ON 13
 ud_4                -6.088931e-02 1 1  ON 14
 ud_5                -1.025055e-01 1 1  ON 15
 ud_6                -1.302501e-01 1 1  ON 16
 ud_7                -1.481221e-01 1 1  ON 17
 ud_8                -1.519047e-01 1 1  ON 18
 ud_9                -1.447769e-01 1 1  ON 19
 eO_0                -7.493998e-01 1 1  ON 20
 eO_1                -4.362140e-01 1 1  ON 21
 eO_2                -2.587121e-02 1 1  ON 22
 eO_3                 2.941516e-01 1 1  ON 23
 eO_4                 5.211177e-01 1 1  ON 24
 eO_5                 4.824148e-01 1 1  ON 25
 eO_6                 2.579415e-01 1 1  ON 26
 eO_7                -4.115410e-02 1 1  ON 27
 eO_8                -2.209844e-01 1 1  ON 28
 eO_9                -8.107492e-02 1 1  ON 29
eH1_0                -2.396076e-01 1 1  ON 30
eH1_1                -1.368767e-01 1 1  ON 31
eH1_2                -9.224086e-02 1 1  ON 32
eH1_3                -4.109293e-02 1 1  ON 33
eH1_4                 7.323489e-03 1 1  ON 34
eH1_5                 3.841044e-02 1 1  ON 35
eH1_6                 9.634637e-02 1 1  ON 36
eH1_7                 1.491711e-01 1 1  ON 37
eH1_8                 1.684865e-01 1 1  ON 38
eH1_9                 5.459065e-02 1 1  ON 39
eH2_0                -2.383516e-01 1 1  ON 40
eH2_1                -1.356240e-01 1 1  ON 41
eH2_2                -9.107004e-02 1 1  ON 42
eH2_3                -3.968003e-02 1 1  ON 43
eH2_4                 8.365008e-03 1 1  ON 44
eH2_5                 3.990600e-02 1 1  ON 45
eH2_6                 9.820778e-02 1 1  ON 46
eH2_7                 1.497065e-01 1 1  ON 47
eH2_8                 1.800485e-01 1 1  ON 48
eH2_9                 4.484878e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.3041e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9343
    reference variance = 0.169785
====================================================
  Execution time = 4.5870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2828e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1991e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328103225731
                                         uncertainty =       0.004569004199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328103225731
                                         uncertainty =       0.004569004199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405143976
  error estimate for blocks of size 2^( 2) =       0.000417401597
  error estimate for blocks of size 2^( 3) =       0.000430092944
  error estimate for blocks of size 2^( 4) =       0.000442333315
  error estimate for blocks of size 2^( 5) =       0.000453660865
  error estimate for blocks of size 2^( 6) =       0.000463630557
  error estimate for blocks of size 2^( 7) =       0.000470684609

      target function =                  N/A
              le_mean =     -16.908976307333
             les_mean =     286.241762879780
             stat err =       0.000457577337
             autocorr =       1.275587460066
              std dev =       0.572960105056
             le_variance =       0.328283281985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690897630733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908976307333       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908976796865       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908976811785       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908976879218       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908976880402       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908976906963       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908976907937       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908976894343       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 2.748413e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908976307333       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908976430567       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908976434506       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908976451547       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908976451816       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908976458605       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908976458889       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908976455422       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 6.888523e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908976307333       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908976338195       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908976339193       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908976343465       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908976343531       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908976345237       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908976345311       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908976344440       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.723169e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7868e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.073438e-01 1 1  ON 0
 uu_1                 1.420445e-01 1 1  ON 1
 uu_2                 4.333670e-02 1 1  ON 2
 uu_3                -1.789091e-02 1 1  ON 3
 uu_4                -6.302822e-02 1 1  ON 4
 uu_5                -9.707075e-02 1 1  ON 5
 uu_6                -1.244258e-01 1 1  ON 6
 uu_7                -1.378632e-01 1 1  ON 7
 uu_8                -1.332425e-01 1 1  ON 8
 uu_9                -1.047504e-01 1 1  ON 9
 ud_0                 4.354195e-01 1 1  ON 10
 ud_1                 1.775833e-01 1 1  ON 11
 ud_2                 6.405028e-02 1 1  ON 12
 ud_3                -4.599694e-03 1 1  ON 13
 ud_4                -6.088934e-02 1 1  ON 14
 ud_5                -1.025061e-01 1 1  ON 15
 ud_6                -1.302529e-01 1 1  ON 16
 ud_7                -1.481229e-01 1 1  ON 17
 ud_8                -1.519032e-01 1 1  ON 18
 ud_9                -1.447751e-01 1 1  ON 19
 eO_0                -7.494055e-01 1 1  ON 20
 eO_1                -4.362130e-01 1 1  ON 21
 eO_2                -2.587015e-02 1 1  ON 22
 eO_3                 2.941547e-01 1 1  ON 23
 eO_4                 5.211189e-01 1 1  ON 24
 eO_5                 4.824152e-01 1 1  ON 25
 eO_6                 2.579416e-01 1 1  ON 26
 eO_7                -4.115332e-02 1 1  ON 27
 eO_8                -2.209851e-01 1 1  ON 28
 eO_9                -8.107600e-02 1 1  ON 29
eH1_0                -2.396113e-01 1 1  ON 30
eH1_1                -1.368783e-01 1 1  ON 31
eH1_2                -9.223916e-02 1 1  ON 32
eH1_3                -4.109316e-02 1 1  ON 33
eH1_4                 7.323480e-03 1 1  ON 34
eH1_5                 3.841142e-02 1 1  ON 35
eH1_6                 9.634671e-02 1 1  ON 36
eH1_7                 1.491713e-01 1 1  ON 37
eH1_8                 1.684870e-01 1 1  ON 38
eH1_9                 5.459228e-02 1 1  ON 39
eH2_0                -2.383558e-01 1 1  ON 40
eH2_1                -1.356253e-01 1 1  ON 41
eH2_2                -9.106877e-02 1 1  ON 42
eH2_3                -3.968134e-02 1 1  ON 43
eH2_4                 8.364531e-03 1 1  ON 44
eH2_5                 3.990563e-02 1 1  ON 45
eH2_6                 9.820786e-02 1 1  ON 46
eH2_7                 1.497075e-01 1 1  ON 47
eH2_8                 1.800504e-01 1 1  ON 48
eH2_9                 4.485152e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8436
    reference variance = 0.208546
====================================================
  Execution time = 4.5001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2609e-01
  Total weights = 2.0000e+06
  Execution time = 4.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326164028108
                                         uncertainty =       0.003301488530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326164028108
                                         uncertainty =       0.003301488530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403786354
  error estimate for blocks of size 2^( 2) =       0.000415918926
  error estimate for blocks of size 2^( 3) =       0.000428897971
  error estimate for blocks of size 2^( 4) =       0.000441042251
  error estimate for blocks of size 2^( 5) =       0.000452735949
  error estimate for blocks of size 2^( 6) =       0.000462312432
  error estimate for blocks of size 2^( 7) =       0.000468184627

      target function =                  N/A
              le_mean =     -16.909880380452
             les_mean =     286.270141156830
             stat err =       0.000456068815
             autocorr =       1.275726211037
              std dev =       0.571040137532
             le_variance =       0.326086838673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326184350189
                                         uncertainty =       0.003301830237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326184350189
                                         uncertainty =       0.003301830237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403798932
  error estimate for blocks of size 2^( 2) =       0.000415930108
  error estimate for blocks of size 2^( 3) =       0.000428907749
  error estimate for blocks of size 2^( 4) =       0.000441051256
  error estimate for blocks of size 2^( 5) =       0.000452744381
  error estimate for blocks of size 2^( 6) =       0.000462320839
  error estimate for blocks of size 2^( 7) =       0.000468193163

      target function =                  N/A
              le_mean =     -16.909880810469
             les_mean =     286.270176016442
             stat err =       0.000456077410
             autocorr =       1.275694815069
              std dev =       0.571057926332
             le_variance =       0.326107155226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326174206859
                                         uncertainty =       0.003301660668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326174206859
                                         uncertainty =       0.003301660668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403792654
  error estimate for blocks of size 2^( 2) =       0.000415924522
  error estimate for blocks of size 2^( 3) =       0.000428902860
  error estimate for blocks of size 2^( 4) =       0.000441046750
  error estimate for blocks of size 2^( 5) =       0.000452740159
  error estimate for blocks of size 2^( 6) =       0.000462316628
  error estimate for blocks of size 2^( 7) =       0.000468188888

      target function =                  N/A
              le_mean =     -16.909880596583
             les_mean =     286.270158642323
             stat err =       0.000456073106
             autocorr =       1.275710410942
              std dev =       0.571049047512
             le_variance =       0.326097014664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326165300206
                                         uncertainty =       0.003301510087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326165300206
                                         uncertainty =       0.003301510087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403787141
  error estimate for blocks of size 2^( 2) =       0.000415919625
  error estimate for blocks of size 2^( 3) =       0.000428898582
  error estimate for blocks of size 2^( 4) =       0.000441042812
  error estimate for blocks of size 2^( 5) =       0.000452736474
  error estimate for blocks of size 2^( 6) =       0.000462312955
  error estimate for blocks of size 2^( 7) =       0.000468185159

      target function =                  N/A
              le_mean =     -16.909880407360
             les_mean =     286.270143338582
             stat err =       0.000456069350
             autocorr =       1.275724232221
              std dev =       0.571041251071
             le_variance =       0.326088110424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909880380452        initial
     2.3842e+01     2.3842e+02             2.7484e-05       -16.909880810469  <--
     9.5367e+01     9.5367e+02             6.8885e-06       -16.909880596583
     3.8147e+02     3.8147e+03             1.7232e-06       -16.909880407360

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 6.9286e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.073417e-01 1 1  ON 0
 uu_1                 1.420409e-01 1 1  ON 1
 uu_2                 4.333870e-02 1 1  ON 2
 uu_3                -1.788835e-02 1 1  ON 3
 uu_4                -6.302877e-02 1 1  ON 4
 uu_5                -9.707627e-02 1 1  ON 5
 uu_6                -1.244296e-01 1 1  ON 6
 uu_7                -1.378635e-01 1 1  ON 7
 uu_8                -1.332384e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354401e-01 1 1  ON 10
 ud_1                 1.775993e-01 1 1  ON 11
 ud_2                 6.403592e-02 1 1  ON 12
 ud_3                -4.618207e-03 1 1  ON 13
 ud_4                -6.088953e-02 1 1  ON 14
 ud_5                -1.025081e-01 1 1  ON 15
 ud_6                -1.302611e-01 1 1  ON 16
 ud_7                -1.481252e-01 1 1  ON 17
 ud_8                -1.518988e-01 1 1  ON 18
 ud_9                -1.447697e-01 1 1  ON 19
 eO_0                -7.494225e-01 1 1  ON 20
 eO_1                -4.362098e-01 1 1  ON 21
 eO_2                -2.586702e-02 1 1  ON 22
 eO_3                 2.941638e-01 1 1  ON 23
 eO_4                 5.211225e-01 1 1  ON 24
 eO_5                 4.824164e-01 1 1  ON 25
 eO_6                 2.579419e-01 1 1  ON 26
 eO_7                -4.115098e-02 1 1  ON 27
 eO_8                -2.209872e-01 1 1  ON 28
 eO_9                -8.107923e-02 1 1  ON 29
eH1_0                -2.396226e-01 1 1  ON 30
eH1_1                -1.368833e-01 1 1  ON 31
eH1_2                -9.223409e-02 1 1  ON 32
eH1_3                -4.109382e-02 1 1  ON 33
eH1_4                 7.323459e-03 1 1  ON 34
eH1_5                 3.841434e-02 1 1  ON 35
eH1_6                 9.634775e-02 1 1  ON 36
eH1_7                 1.491718e-01 1 1  ON 37
eH1_8                 1.684888e-01 1 1  ON 38
eH1_9                 5.459718e-02 1 1  ON 39
eH2_0                -2.383685e-01 1 1  ON 40
eH2_1                -1.356291e-01 1 1  ON 41
eH2_2                -9.106499e-02 1 1  ON 42
eH2_3                -3.968523e-02 1 1  ON 43
eH2_4                 8.363098e-03 1 1  ON 44
eH2_5                 3.990454e-02 1 1  ON 45
eH2_6                 9.820813e-02 1 1  ON 46
eH2_7                 1.497105e-01 1 1  ON 47
eH2_8                 1.800561e-01 1 1  ON 48
eH2_9                 4.485973e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2716e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.181699
====================================================
  Execution time = 4.5714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2754e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2056e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327561894415
                                         uncertainty =       0.003435248391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327561894415
                                         uncertainty =       0.003435248391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404684701
  error estimate for blocks of size 2^( 2) =       0.000416886309
  error estimate for blocks of size 2^( 3) =       0.000429334591
  error estimate for blocks of size 2^( 4) =       0.000440994112
  error estimate for blocks of size 2^( 5) =       0.000452332236
  error estimate for blocks of size 2^( 6) =       0.000460855971
  error estimate for blocks of size 2^( 7) =       0.000465821942

      target function =                  N/A
              le_mean =     -16.910194923946
             les_mean =     286.282231616098
             stat err =       0.000455001065
             autocorr =       1.264128593259
              std dev =       0.572310592278
             le_variance =       0.327539414034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691019492395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910194923946       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910196086640       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910196435811       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910196521245       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910196484900       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910196461972       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910196504486       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910196532264       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910196511655       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 1.128574e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910194923946       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910195222703       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910195315653       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910195338546       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910195330593       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910195324294       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910195334190       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910195341273       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910195335897       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 2.862102e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910194923946       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910194999158       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910195022774       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910195028603       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910195026689       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910195025084       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910195027513       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910195029292       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910195027931       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 7.177806e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7778e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.073405e-01 1 1  ON 0
 uu_1                 1.420359e-01 1 1  ON 1
 uu_2                 4.334284e-02 1 1  ON 2
 uu_3                -1.788065e-02 1 1  ON 3
 uu_4                -6.303081e-02 1 1  ON 4
 uu_5                -9.707746e-02 1 1  ON 5
 uu_6                -1.244354e-01 1 1  ON 6
 uu_7                -1.378681e-01 1 1  ON 7
 uu_8                -1.332336e-01 1 1  ON 8
 uu_9                -1.047504e-01 1 1  ON 9
 ud_0                 4.354687e-01 1 1  ON 10
 ud_1                 1.776232e-01 1 1  ON 11
 ud_2                 6.401811e-02 1 1  ON 12
 ud_3                -4.639617e-03 1 1  ON 13
 ud_4                -6.089139e-02 1 1  ON 14
 ud_5                -1.025088e-01 1 1  ON 15
 ud_6                -1.302710e-01 1 1  ON 16
 ud_7                -1.481299e-01 1 1  ON 17
 ud_8                -1.518977e-01 1 1  ON 18
 ud_9                -1.447658e-01 1 1  ON 19
 eO_0                -7.494451e-01 1 1  ON 20
 eO_1                -4.362069e-01 1 1  ON 21
 eO_2                -2.586095e-02 1 1  ON 22
 eO_3                 2.941806e-01 1 1  ON 23
 eO_4                 5.211253e-01 1 1  ON 24
 eO_5                 4.824189e-01 1 1  ON 25
 eO_6                 2.579399e-01 1 1  ON 26
 eO_7                -4.114929e-02 1 1  ON 27
 eO_8                -2.209895e-01 1 1  ON 28
 eO_9                -8.108402e-02 1 1  ON 29
eH1_0                -2.396380e-01 1 1  ON 30
eH1_1                -1.368902e-01 1 1  ON 31
eH1_2                -9.222885e-02 1 1  ON 32
eH1_3                -4.109368e-02 1 1  ON 33
eH1_4                 7.319512e-03 1 1  ON 34
eH1_5                 3.841494e-02 1 1  ON 35
eH1_6                 9.635001e-02 1 1  ON 36
eH1_7                 1.491744e-01 1 1  ON 37
eH1_8                 1.684962e-01 1 1  ON 38
eH1_9                 5.460524e-02 1 1  ON 39
eH2_0                -2.383859e-01 1 1  ON 40
eH2_1                -1.356386e-01 1 1  ON 41
eH2_2                -9.105882e-02 1 1  ON 42
eH2_3                -3.968813e-02 1 1  ON 43
eH2_4                 8.369122e-03 1 1  ON 44
eH2_5                 3.990332e-02 1 1  ON 45
eH2_6                 9.821275e-02 1 1  ON 46
eH2_7                 1.497121e-01 1 1  ON 47
eH2_8                 1.800591e-01 1 1  ON 48
eH2_9                 4.486881e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9897
    reference variance = 0.684953
====================================================
  Execution time = 4.5122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3848e-01
  Total weights = 2.0000e+06
  Execution time = 4.8376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369738090
                                         uncertainty =       0.004969344365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369738090
                                         uncertainty =       0.004969344365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411379173
  error estimate for blocks of size 2^( 2) =       0.000422863840
  error estimate for blocks of size 2^( 3) =       0.000435072461
  error estimate for blocks of size 2^( 4) =       0.000446829267
  error estimate for blocks of size 2^( 5) =       0.000458154198
  error estimate for blocks of size 2^( 6) =       0.000466601129
  error estimate for blocks of size 2^( 7) =       0.000470486975

      target function =                  N/A
              le_mean =     -16.909762397760
             les_mean =     286.278529826891
             stat err =       0.000460517892
             autocorr =       1.253165458582
              std dev =       0.581778005279
             le_variance =       0.338465647426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338446540769
                                         uncertainty =       0.004969721271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338446540769
                                         uncertainty =       0.004969721271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411425834
  error estimate for blocks of size 2^( 2) =       0.000422905668
  error estimate for blocks of size 2^( 3) =       0.000435109616
  error estimate for blocks of size 2^( 4) =       0.000446862420
  error estimate for blocks of size 2^( 5) =       0.000458185401
  error estimate for blocks of size 2^( 6) =       0.000466630790
  error estimate for blocks of size 2^( 7) =       0.000470515004

      target function =                  N/A
              le_mean =     -16.909761726675
             les_mean =     286.278583917915
             stat err =       0.000460548404
             autocorr =       1.253047244689
              std dev =       0.581843994790
             le_variance =       0.338542434273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338408770278
                                         uncertainty =       0.004969515909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338408770278
                                         uncertainty =       0.004969515909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411402887
  error estimate for blocks of size 2^( 2) =       0.000422885048
  error estimate for blocks of size 2^( 3) =       0.000435091265
  error estimate for blocks of size 2^( 4) =       0.000446846003
  error estimate for blocks of size 2^( 5) =       0.000458169929
  error estimate for blocks of size 2^( 6) =       0.000466616055
  error estimate for blocks of size 2^( 7) =       0.000470501010

      target function =                  N/A
              le_mean =     -16.909762032087
             les_mean =     286.278556483764
             stat err =       0.000460533249
             autocorr =       1.253104560327
              std dev =       0.581811542699
             le_variance =       0.338504671218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338374623436
                                         uncertainty =       0.004969365147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338374623436
                                         uncertainty =       0.004969365147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411382141
  error estimate for blocks of size 2^( 2) =       0.000422866491
  error estimate for blocks of size 2^( 3) =       0.000435074808
  error estimate for blocks of size 2^( 4) =       0.000446831354
  error estimate for blocks of size 2^( 5) =       0.000458156158
  error estimate for blocks of size 2^( 6) =       0.000466602987
  error estimate for blocks of size 2^( 7) =       0.000470488719

      target function =                  N/A
              le_mean =     -16.909762348993
             les_mean =     286.278533061904
             stat err =       0.000460519804
             autocorr =       1.253157781546
              std dev =       0.581782202981
             le_variance =       0.338470531706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909762397760        initial  <--
     5.9605e+00     5.9605e+01             1.1286e-04       -16.909761726675
     2.3842e+01     2.3842e+02             2.8621e-05       -16.909762032087
     9.5367e+01     9.5367e+02             7.1778e-06       -16.909762348993

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.7804
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.073417e-01 1 1  ON 0
 uu_1                 1.420409e-01 1 1  ON 1
 uu_2                 4.333870e-02 1 1  ON 2
 uu_3                -1.788835e-02 1 1  ON 3
 uu_4                -6.302877e-02 1 1  ON 4
 uu_5                -9.707627e-02 1 1  ON 5
 uu_6                -1.244296e-01 1 1  ON 6
 uu_7                -1.378635e-01 1 1  ON 7
 uu_8                -1.332384e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354401e-01 1 1  ON 10
 ud_1                 1.775993e-01 1 1  ON 11
 ud_2                 6.403592e-02 1 1  ON 12
 ud_3                -4.618207e-03 1 1  ON 13
 ud_4                -6.088953e-02 1 1  ON 14
 ud_5                -1.025081e-01 1 1  ON 15
 ud_6                -1.302611e-01 1 1  ON 16
 ud_7                -1.481252e-01 1 1  ON 17
 ud_8                -1.518988e-01 1 1  ON 18
 ud_9                -1.447697e-01 1 1  ON 19
 eO_0                -7.494225e-01 1 1  ON 20
 eO_1                -4.362098e-01 1 1  ON 21
 eO_2                -2.586702e-02 1 1  ON 22
 eO_3                 2.941638e-01 1 1  ON 23
 eO_4                 5.211225e-01 1 1  ON 24
 eO_5                 4.824164e-01 1 1  ON 25
 eO_6                 2.579419e-01 1 1  ON 26
 eO_7                -4.115098e-02 1 1  ON 27
 eO_8                -2.209872e-01 1 1  ON 28
 eO_9                -8.107923e-02 1 1  ON 29
eH1_0                -2.396226e-01 1 1  ON 30
eH1_1                -1.368833e-01 1 1  ON 31
eH1_2                -9.223409e-02 1 1  ON 32
eH1_3                -4.109382e-02 1 1  ON 33
eH1_4                 7.323459e-03 1 1  ON 34
eH1_5                 3.841434e-02 1 1  ON 35
eH1_6                 9.634775e-02 1 1  ON 36
eH1_7                 1.491718e-01 1 1  ON 37
eH1_8                 1.684888e-01 1 1  ON 38
eH1_9                 5.459718e-02 1 1  ON 39
eH2_0                -2.383685e-01 1 1  ON 40
eH2_1                -1.356291e-01 1 1  ON 41
eH2_2                -9.106499e-02 1 1  ON 42
eH2_3                -3.968523e-02 1 1  ON 43
eH2_4                 8.363098e-03 1 1  ON 44
eH2_5                 3.990454e-02 1 1  ON 45
eH2_6                 9.820813e-02 1 1  ON 46
eH2_7                 1.497105e-01 1 1  ON 47
eH2_8                 1.800561e-01 1 1  ON 48
eH2_9                 4.485973e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2757e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8805
    reference variance = 0.237777
====================================================
  Execution time = 4.5983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2949e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1925e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329587831464
                                         uncertainty =       0.005771793351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329587831464
                                         uncertainty =       0.005771793351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405890938
  error estimate for blocks of size 2^( 2) =       0.000417927406
  error estimate for blocks of size 2^( 3) =       0.000430970863
  error estimate for blocks of size 2^( 4) =       0.000442902318
  error estimate for blocks of size 2^( 5) =       0.000454872610
  error estimate for blocks of size 2^( 6) =       0.000462276924
  error estimate for blocks of size 2^( 7) =       0.000467554302

      target function =                  N/A
              le_mean =     -16.909808214465
             les_mean =     286.271108591993
             stat err =       0.000456901539
             autocorr =       1.267145632228
              std dev =       0.574016469050
             le_variance =       0.329494906740


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690980821447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909808214465       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808297144       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909808383009       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909808399675       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909808414342       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909808408754       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909808408212       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909808407739       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909808407569       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 1.030610e-05

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909808214465       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808235191       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909808256747       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909808260941       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909808264626       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909808263229       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909808263088       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909808262971       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909808262925       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 2.581567e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909808214465       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909808219650       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909808225045       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909808226095       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909808227018       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909808226668       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909808226633       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909808226602       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909808226592       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 6.457051e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7916e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.073410e-01 1 1  ON 0
 uu_1                 1.420403e-01 1 1  ON 1
 uu_2                 4.333911e-02 1 1  ON 2
 uu_3                -1.788808e-02 1 1  ON 3
 uu_4                -6.302899e-02 1 1  ON 4
 uu_5                -9.707711e-02 1 1  ON 5
 uu_6                -1.244301e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332373e-01 1 1  ON 8
 uu_9                -1.047489e-01 1 1  ON 9
 ud_0                 4.354427e-01 1 1  ON 10
 ud_1                 1.776010e-01 1 1  ON 11
 ud_2                 6.403388e-02 1 1  ON 12
 ud_3                -4.620453e-03 1 1  ON 13
 ud_4                -6.089004e-02 1 1  ON 14
 ud_5                -1.025086e-01 1 1  ON 15
 ud_6                -1.302622e-01 1 1  ON 16
 ud_7                -1.481252e-01 1 1  ON 17
 ud_8                -1.518978e-01 1 1  ON 18
 ud_9                -1.447689e-01 1 1  ON 19
 eO_0                -7.494247e-01 1 1  ON 20
 eO_1                -4.362098e-01 1 1  ON 21
 eO_2                -2.586664e-02 1 1  ON 22
 eO_3                 2.941653e-01 1 1  ON 23
 eO_4                 5.211230e-01 1 1  ON 24
 eO_5                 4.824164e-01 1 1  ON 25
 eO_6                 2.579418e-01 1 1  ON 26
 eO_7                -4.115050e-02 1 1  ON 27
 eO_8                -2.209872e-01 1 1  ON 28
 eO_9                -8.107965e-02 1 1  ON 29
eH1_0                -2.396242e-01 1 1  ON 30
eH1_1                -1.368842e-01 1 1  ON 31
eH1_2                -9.223340e-02 1 1  ON 32
eH1_3                -4.109341e-02 1 1  ON 33
eH1_4                 7.323025e-03 1 1  ON 34
eH1_5                 3.841419e-02 1 1  ON 35
eH1_6                 9.634773e-02 1 1  ON 36
eH1_7                 1.491721e-01 1 1  ON 37
eH1_8                 1.684895e-01 1 1  ON 38
eH1_9                 5.459818e-02 1 1  ON 39
eH2_0                -2.383705e-01 1 1  ON 40
eH2_1                -1.356300e-01 1 1  ON 41
eH2_2                -9.106431e-02 1 1  ON 42
eH2_3                -3.968583e-02 1 1  ON 43
eH2_4                 8.363373e-03 1 1  ON 44
eH2_5                 3.990419e-02 1 1  ON 45
eH2_6                 9.820879e-02 1 1  ON 46
eH2_7                 1.497111e-01 1 1  ON 47
eH2_8                 1.800565e-01 1 1  ON 48
eH2_9                 4.486068e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9468
    reference variance = 0.344751
====================================================
  Execution time = 4.5224e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4814e-01
  Total weights = 2.0000e+06
  Execution time = 4.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348266165980
                                         uncertainty =       0.008557838258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348266165980
                                         uncertainty =       0.008557838258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417217620
  error estimate for blocks of size 2^( 2) =       0.000429387065
  error estimate for blocks of size 2^( 3) =       0.000441928930
  error estimate for blocks of size 2^( 4) =       0.000455190384
  error estimate for blocks of size 2^( 5) =       0.000465664772
  error estimate for blocks of size 2^( 6) =       0.000474268129
  error estimate for blocks of size 2^( 7) =       0.000478717779

      target function =                  N/A
              le_mean =     -16.909783584315
             les_mean =     286.288921779415
             stat err =       0.000468460266
             autocorr =       1.260724631376
              std dev =       0.590034816872
             le_variance =       0.348141085122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348273944291
                                         uncertainty =       0.008557980781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348273944291
                                         uncertainty =       0.008557980781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417222282
  error estimate for blocks of size 2^( 2) =       0.000429391198
  error estimate for blocks of size 2^( 3) =       0.000441932559
  error estimate for blocks of size 2^( 4) =       0.000455193588
  error estimate for blocks of size 2^( 5) =       0.000465667867
  error estimate for blocks of size 2^( 6) =       0.000474271245
  error estimate for blocks of size 2^( 7) =       0.000478721157

      target function =                  N/A
              le_mean =     -16.909783560151
             les_mean =     286.288928742282
             stat err =       0.000468463464
             autocorr =       1.260713672763
              std dev =       0.590041409730
             le_variance =       0.348148865196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348270062914
                                         uncertainty =       0.008557909814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348270062914
                                         uncertainty =       0.008557909814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417219956
  error estimate for blocks of size 2^( 2) =       0.000429389135
  error estimate for blocks of size 2^( 3) =       0.000441930747
  error estimate for blocks of size 2^( 4) =       0.000455191988
  error estimate for blocks of size 2^( 5) =       0.000465666321
  error estimate for blocks of size 2^( 6) =       0.000474269689
  error estimate for blocks of size 2^( 7) =       0.000478719470

      target function =                  N/A
              le_mean =     -16.909783571861
             les_mean =     286.288925256068
             stat err =       0.000468461867
             autocorr =       1.260719133782
              std dev =       0.590038119908
             le_variance =       0.348144982944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348266653240
                                         uncertainty =       0.008557847211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348266653240
                                         uncertainty =       0.008557847211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417217912
  error estimate for blocks of size 2^( 2) =       0.000429387324
  error estimate for blocks of size 2^( 3) =       0.000441929158
  error estimate for blocks of size 2^( 4) =       0.000455190584
  error estimate for blocks of size 2^( 5) =       0.000465664965
  error estimate for blocks of size 2^( 6) =       0.000474268324
  error estimate for blocks of size 2^( 7) =       0.000478717990

      target function =                  N/A
              le_mean =     -16.909783582728
             les_mean =     286.288922213125
             stat err =       0.000468460466
             autocorr =       1.260723943534
              std dev =       0.590035229874
             le_variance =       0.348141572493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909783584315        initial  <--
     5.9605e+01     5.9605e+02             1.0306e-05       -16.909783560151
     2.3842e+02     2.3842e+03             2.5816e-06       -16.909783571861
     9.5367e+02     9.5367e+03             6.4571e-07       -16.909783582728

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.5761
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.073417e-01 1 1  ON 0
 uu_1                 1.420409e-01 1 1  ON 1
 uu_2                 4.333870e-02 1 1  ON 2
 uu_3                -1.788835e-02 1 1  ON 3
 uu_4                -6.302877e-02 1 1  ON 4
 uu_5                -9.707627e-02 1 1  ON 5
 uu_6                -1.244296e-01 1 1  ON 6
 uu_7                -1.378635e-01 1 1  ON 7
 uu_8                -1.332384e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354401e-01 1 1  ON 10
 ud_1                 1.775993e-01 1 1  ON 11
 ud_2                 6.403592e-02 1 1  ON 12
 ud_3                -4.618207e-03 1 1  ON 13
 ud_4                -6.088953e-02 1 1  ON 14
 ud_5                -1.025081e-01 1 1  ON 15
 ud_6                -1.302611e-01 1 1  ON 16
 ud_7                -1.481252e-01 1 1  ON 17
 ud_8                -1.518988e-01 1 1  ON 18
 ud_9                -1.447697e-01 1 1  ON 19
 eO_0                -7.494225e-01 1 1  ON 20
 eO_1                -4.362098e-01 1 1  ON 21
 eO_2                -2.586702e-02 1 1  ON 22
 eO_3                 2.941638e-01 1 1  ON 23
 eO_4                 5.211225e-01 1 1  ON 24
 eO_5                 4.824164e-01 1 1  ON 25
 eO_6                 2.579419e-01 1 1  ON 26
 eO_7                -4.115098e-02 1 1  ON 27
 eO_8                -2.209872e-01 1 1  ON 28
 eO_9                -8.107923e-02 1 1  ON 29
eH1_0                -2.396226e-01 1 1  ON 30
eH1_1                -1.368833e-01 1 1  ON 31
eH1_2                -9.223409e-02 1 1  ON 32
eH1_3                -4.109382e-02 1 1  ON 33
eH1_4                 7.323459e-03 1 1  ON 34
eH1_5                 3.841434e-02 1 1  ON 35
eH1_6                 9.634775e-02 1 1  ON 36
eH1_7                 1.491718e-01 1 1  ON 37
eH1_8                 1.684888e-01 1 1  ON 38
eH1_9                 5.459718e-02 1 1  ON 39
eH2_0                -2.383685e-01 1 1  ON 40
eH2_1                -1.356291e-01 1 1  ON 41
eH2_2                -9.106499e-02 1 1  ON 42
eH2_3                -3.968523e-02 1 1  ON 43
eH2_4                 8.363098e-03 1 1  ON 44
eH2_5                 3.990454e-02 1 1  ON 45
eH2_6                 9.820813e-02 1 1  ON 46
eH2_7                 1.497105e-01 1 1  ON 47
eH2_8                 1.800561e-01 1 1  ON 48
eH2_9                 4.485973e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2750e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8432
    reference variance = 0.498123
====================================================
  Execution time = 4.6293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2209e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328525407435
                                         uncertainty =       0.003301686877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328525407435
                                         uncertainty =       0.003301686877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405256439
  error estimate for blocks of size 2^( 2) =       0.000417485103
  error estimate for blocks of size 2^( 3) =       0.000430155770
  error estimate for blocks of size 2^( 4) =       0.000443102736
  error estimate for blocks of size 2^( 5) =       0.000452589138
  error estimate for blocks of size 2^( 6) =       0.000460167415
  error estimate for blocks of size 2^( 7) =       0.000464666628

      target function =                  N/A
              le_mean =     -16.908790350893
             les_mean =     286.235656528375
             stat err =       0.000455131479
             autocorr =       1.261286949115
              std dev =       0.573119151805
             le_variance =       0.328465562165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690879035089e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908790350893       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908790358675       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908790361514       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908790362962       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908790363717       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908790363469       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908790363884       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908790363925       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908790364041       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 1.373849e-06

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908790350893       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908790352839       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908790353549       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908790353909       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908790354100       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908790354038       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908790354141       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908790354152       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908790354183       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 3.435286e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.908790350893       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.908790351379       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.908790351557       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.908790351647       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908790351695       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.908790351676       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908790351706       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908790351709       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908790351711       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 8.588631e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8510e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.073417e-01 1 1  ON 0
 uu_1                 1.420409e-01 1 1  ON 1
 uu_2                 4.333872e-02 1 1  ON 2
 uu_3                -1.788831e-02 1 1  ON 3
 uu_4                -6.302879e-02 1 1  ON 4
 uu_5                -9.707632e-02 1 1  ON 5
 uu_6                -1.244296e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332384e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354404e-01 1 1  ON 10
 ud_1                 1.775995e-01 1 1  ON 11
 ud_2                 6.403572e-02 1 1  ON 12
 ud_3                -4.618391e-03 1 1  ON 13
 ud_4                -6.088958e-02 1 1  ON 14
 ud_5                -1.025082e-01 1 1  ON 15
 ud_6                -1.302611e-01 1 1  ON 16
 ud_7                -1.481253e-01 1 1  ON 17
 ud_8                -1.518988e-01 1 1  ON 18
 ud_9                -1.447697e-01 1 1  ON 19
 eO_0                -7.494227e-01 1 1  ON 20
 eO_1                -4.362099e-01 1 1  ON 21
 eO_2                -2.586696e-02 1 1  ON 22
 eO_3                 2.941639e-01 1 1  ON 23
 eO_4                 5.211225e-01 1 1  ON 24
 eO_5                 4.824164e-01 1 1  ON 25
 eO_6                 2.579420e-01 1 1  ON 26
 eO_7                -4.115094e-02 1 1  ON 27
 eO_8                -2.209872e-01 1 1  ON 28
 eO_9                -8.107929e-02 1 1  ON 29
eH1_0                -2.396227e-01 1 1  ON 30
eH1_1                -1.368834e-01 1 1  ON 31
eH1_2                -9.223402e-02 1 1  ON 32
eH1_3                -4.109380e-02 1 1  ON 33
eH1_4                 7.323415e-03 1 1  ON 34
eH1_5                 3.841437e-02 1 1  ON 35
eH1_6                 9.634781e-02 1 1  ON 36
eH1_7                 1.491718e-01 1 1  ON 37
eH1_8                 1.684888e-01 1 1  ON 38
eH1_9                 5.459724e-02 1 1  ON 39
eH2_0                -2.383686e-01 1 1  ON 40
eH2_1                -1.356292e-01 1 1  ON 41
eH2_2                -9.106496e-02 1 1  ON 42
eH2_3                -3.968526e-02 1 1  ON 43
eH2_4                 8.363114e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820814e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800561e-01 1 1  ON 48
eH2_9                 4.485984e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.895
    reference variance = 0.201742
====================================================
  Execution time = 4.4927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2985e-01
  Total weights = 2.0000e+06
  Execution time = 4.8459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329988651785
                                         uncertainty =       0.003551555914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329988651785
                                         uncertainty =       0.003551555914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406111118
  error estimate for blocks of size 2^( 2) =       0.000418221655
  error estimate for blocks of size 2^( 3) =       0.000430914030
  error estimate for blocks of size 2^( 4) =       0.000444056079
  error estimate for blocks of size 2^( 5) =       0.000454486054
  error estimate for blocks of size 2^( 6) =       0.000462900750
  error estimate for blocks of size 2^( 7) =       0.000468236251

      target function =                  N/A
              le_mean =     -16.909804305273
             les_mean =     286.271333958353
             stat err =       0.000457419783
             autocorr =       1.268645049544
              std dev =       0.574327851194
             le_variance =       0.329852480657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329989661660
                                         uncertainty =       0.003551568166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329989661660
                                         uncertainty =       0.003551568166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406111740
  error estimate for blocks of size 2^( 2) =       0.000418222209
  error estimate for blocks of size 2^( 3) =       0.000430914514
  error estimate for blocks of size 2^( 4) =       0.000444056519
  error estimate for blocks of size 2^( 5) =       0.000454486459
  error estimate for blocks of size 2^( 6) =       0.000462901144
  error estimate for blocks of size 2^( 7) =       0.000468236632

      target function =                  N/A
              le_mean =     -16.909804306178
             les_mean =     286.271334998301
             stat err =       0.000457420189
             autocorr =       1.268643414950
              std dev =       0.574328729895
             le_variance =       0.329853489983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329989156849
                                         uncertainty =       0.003551562042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329989156849
                                         uncertainty =       0.003551562042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406111429
  error estimate for blocks of size 2^( 2) =       0.000418221932
  error estimate for blocks of size 2^( 3) =       0.000430914272
  error estimate for blocks of size 2^( 4) =       0.000444056299
  error estimate for blocks of size 2^( 5) =       0.000454486256
  error estimate for blocks of size 2^( 6) =       0.000462900947
  error estimate for blocks of size 2^( 7) =       0.000468236442

      target function =                  N/A
              le_mean =     -16.909804305723
             les_mean =     286.271334478377
             stat err =       0.000457419986
             autocorr =       1.268644231951
              std dev =       0.574328290655
             le_variance =       0.329852985446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329988714920
                                         uncertainty =       0.003551556680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329988714920
                                         uncertainty =       0.003551556680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406111157
  error estimate for blocks of size 2^( 2) =       0.000418221690
  error estimate for blocks of size 2^( 3) =       0.000430914060
  error estimate for blocks of size 2^( 4) =       0.000444056106
  error estimate for blocks of size 2^( 5) =       0.000454486079
  error estimate for blocks of size 2^( 6) =       0.000462900775
  error estimate for blocks of size 2^( 7) =       0.000468236275

      target function =                  N/A
              le_mean =     -16.909804305329
             les_mean =     286.271334023349
             stat err =       0.000457419809
             autocorr =       1.268644947341
              std dev =       0.574327906129
             le_variance =       0.329852543759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909804305273        initial
     5.9605e+02     5.9605e+03             1.3738e-06       -16.909804306178  <--
     2.3842e+03     2.3842e+04             3.4353e-07       -16.909804305723
     9.5367e+03     9.5367e+04             8.5886e-08       -16.909804305329

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 6.9294e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618942e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2781e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8646
    reference variance = 0.198039
====================================================
  Execution time = 4.7053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1978e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253646575
                                         uncertainty =       0.005093715586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253646575
                                         uncertainty =       0.005093715586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407529447
  error estimate for blocks of size 2^( 2) =       0.000419766588
  error estimate for blocks of size 2^( 3) =       0.000432074752
  error estimate for blocks of size 2^( 4) =       0.000443034149
  error estimate for blocks of size 2^( 5) =       0.000454382168
  error estimate for blocks of size 2^( 6) =       0.000462472992
  error estimate for blocks of size 2^( 7) =       0.000467990596

      target function =                  N/A
              le_mean =     -16.910631989163
             les_mean =     286.301634606639
             stat err =       0.000456969976
             autocorr =       1.257353353594
              std dev =       0.576333670557
             le_variance =       0.332160499818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691063198916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910631989163       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910632045867       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910632065066       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910632071670       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910632072800       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910632077977       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910632076050       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910632076201       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910632076709       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 4.481936e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910631989163       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910632003354       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910632008163       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910632009817       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910632010099       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910632011393       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910632010911       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910632010947       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910632011075       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 1.121125e-06

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910631989163       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910631992712       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910631993914       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910631994328       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910631994398       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910631994722       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910631994602       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910631994616       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910631994644       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 2.803213e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9039e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.073414e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333908e-02 1 1  ON 2
 uu_3                -1.788793e-02 1 1  ON 3
 uu_4                -6.302867e-02 1 1  ON 4
 uu_5                -9.707682e-02 1 1  ON 5
 uu_6                -1.244299e-01 1 1  ON 6
 uu_7                -1.378636e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047495e-01 1 1  ON 9
 ud_0                 4.354426e-01 1 1  ON 10
 ud_1                 1.776011e-01 1 1  ON 11
 ud_2                 6.403452e-02 1 1  ON 12
 ud_3                -4.619655e-03 1 1  ON 13
 ud_4                -6.088972e-02 1 1  ON 14
 ud_5                -1.025082e-01 1 1  ON 15
 ud_6                -1.302614e-01 1 1  ON 16
 ud_7                -1.481256e-01 1 1  ON 17
 ud_8                -1.518988e-01 1 1  ON 18
 ud_9                -1.447698e-01 1 1  ON 19
 eO_0                -7.494240e-01 1 1  ON 20
 eO_1                -4.362099e-01 1 1  ON 21
 eO_2                -2.586662e-02 1 1  ON 22
 eO_3                 2.941649e-01 1 1  ON 23
 eO_4                 5.211228e-01 1 1  ON 24
 eO_5                 4.824167e-01 1 1  ON 25
 eO_6                 2.579422e-01 1 1  ON 26
 eO_7                -4.115081e-02 1 1  ON 27
 eO_8                -2.209875e-01 1 1  ON 28
 eO_9                -8.107977e-02 1 1  ON 29
eH1_0                -2.396239e-01 1 1  ON 30
eH1_1                -1.368839e-01 1 1  ON 31
eH1_2                -9.223341e-02 1 1  ON 32
eH1_3                -4.109379e-02 1 1  ON 33
eH1_4                 7.323233e-03 1 1  ON 34
eH1_5                 3.841435e-02 1 1  ON 35
eH1_6                 9.634808e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684893e-01 1 1  ON 38
eH1_9                 5.459773e-02 1 1  ON 39
eH2_0                -2.383697e-01 1 1  ON 40
eH2_1                -1.356296e-01 1 1  ON 41
eH2_2                -9.106461e-02 1 1  ON 42
eH2_3                -3.968534e-02 1 1  ON 43
eH2_4                 8.363205e-03 1 1  ON 44
eH2_5                 3.990441e-02 1 1  ON 45
eH2_6                 9.820835e-02 1 1  ON 46
eH2_7                 1.497106e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486054e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.909
    reference variance = 0.267322
====================================================
  Execution time = 4.5610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2972e-01
  Total weights = 2.0000e+06
  Execution time = 4.8387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329762518620
                                         uncertainty =       0.004339679454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329762518620
                                         uncertainty =       0.004339679454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406031373
  error estimate for blocks of size 2^( 2) =       0.000417955604
  error estimate for blocks of size 2^( 3) =       0.000430405063
  error estimate for blocks of size 2^( 4) =       0.000442157266
  error estimate for blocks of size 2^( 5) =       0.000452945408
  error estimate for blocks of size 2^( 6) =       0.000460264033
  error estimate for blocks of size 2^( 7) =       0.000466874401

      target function =                  N/A
              le_mean =     -16.909456916652
             les_mean =     286.259456002895
             stat err =       0.000455560277
             autocorr =       1.258845737193
              std dev =       0.574215074371
             le_variance =       0.329722951635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329765047605
                                         uncertainty =       0.004339707189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329765047605
                                         uncertainty =       0.004339707189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406032931
  error estimate for blocks of size 2^( 2) =       0.000417956956
  error estimate for blocks of size 2^( 3) =       0.000430406247
  error estimate for blocks of size 2^( 4) =       0.000442158294
  error estimate for blocks of size 2^( 5) =       0.000452946372
  error estimate for blocks of size 2^( 6) =       0.000460265020
  error estimate for blocks of size 2^( 7) =       0.000466875340

      target function =                  N/A
              le_mean =     -16.909456902233
             les_mean =     286.259458045813
             stat err =       0.000455561256
             autocorr =       1.258841488531
              std dev =       0.574217277875
             le_variance =       0.329725482210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763783817
                                         uncertainty =       0.004339693331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329763783817
                                         uncertainty =       0.004339693331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406032152
  error estimate for blocks of size 2^( 2) =       0.000417956280
  error estimate for blocks of size 2^( 3) =       0.000430405655
  error estimate for blocks of size 2^( 4) =       0.000442157780
  error estimate for blocks of size 2^( 5) =       0.000452945890
  error estimate for blocks of size 2^( 6) =       0.000460264527
  error estimate for blocks of size 2^( 7) =       0.000466874870

      target function =                  N/A
              le_mean =     -16.909456909383
             les_mean =     286.259457023050
             stat err =       0.000455560767
             autocorr =       1.258843610120
              std dev =       0.574216176740
             le_variance =       0.329724217630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329762676776
                                         uncertainty =       0.004339681189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329762676776
                                         uncertainty =       0.004339681189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406031470
  error estimate for blocks of size 2^( 2) =       0.000417955688
  error estimate for blocks of size 2^( 3) =       0.000430405137
  error estimate for blocks of size 2^( 4) =       0.000442157330
  error estimate for blocks of size 2^( 5) =       0.000452945469
  error estimate for blocks of size 2^( 6) =       0.000460264095
  error estimate for blocks of size 2^( 7) =       0.000466874459

      target function =                  N/A
              le_mean =     -16.909456915739
             les_mean =     286.259456130257
             stat err =       0.000455560338
             autocorr =       1.258845471212
              std dev =       0.574215212173
             le_variance =       0.329723109891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909456916652        initial  <--
     1.4901e+02     1.4901e+03             4.4819e-06       -16.909456902233
     5.9605e+02     5.9605e+03             1.1211e-06       -16.909456909383
     2.3842e+03     2.3842e+04             2.8032e-07       -16.909456915739

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.8937
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618942e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2894e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8634
    reference variance = 0.208663
====================================================
  Execution time = 4.6219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1951e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328180172100
                                         uncertainty =       0.003338895669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328180172100
                                         uncertainty =       0.003338895669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405111588
  error estimate for blocks of size 2^( 2) =       0.000417048211
  error estimate for blocks of size 2^( 3) =       0.000429475255
  error estimate for blocks of size 2^( 4) =       0.000442159399
  error estimate for blocks of size 2^( 5) =       0.000452395152
  error estimate for blocks of size 2^( 6) =       0.000459545255
  error estimate for blocks of size 2^( 7) =       0.000466967948

      target function =                  N/A
              le_mean =     -16.910026581418
             les_mean =     286.277229617408
             stat err =       0.000455266938
             autocorr =       1.262940509839
              std dev =       0.572914301857
             le_variance =       0.328230797272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691002658142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910026581418       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910026585828       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910026588318       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910026589312       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910026590063       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910026590443       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910026590633       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910026590521       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 4.260048e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910026581418       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910026582520       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910026583143       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910026583391       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910026583578       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910026583683       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910026583723       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910026583694       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 1.065052e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910026581418       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910026581693       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910026581849       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910026581918       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910026581960       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910026581982       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910026582012       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910026581987       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.662654e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153503 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8178e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420407e-01 1 1  ON 1
 uu_2                 4.333879e-02 1 1  ON 2
 uu_3                -1.788817e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707651e-02 1 1  ON 5
 uu_6                -1.244298e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354416e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403505e-02 1 1  ON 12
 ud_3                -4.619027e-03 1 1  ON 13
 ud_4                -6.088976e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586675e-02 1 1  ON 22
 eO_3                 2.941644e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115083e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107949e-02 1 1  ON 29
eH1_0                -2.396233e-01 1 1  ON 30
eH1_1                -1.368838e-01 1 1  ON 31
eH1_2                -9.223379e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323282e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634799e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459745e-02 1 1  ON 39
eH2_0                -2.383691e-01 1 1  ON 40
eH2_1                -1.356294e-01 1 1  ON 41
eH2_2                -9.106481e-02 1 1  ON 42
eH2_3                -3.968536e-02 1 1  ON 43
eH2_4                 8.363163e-03 1 1  ON 44
eH2_5                 3.990452e-02 1 1  ON 45
eH2_6                 9.820818e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486021e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9683
    reference variance = 0.497568
====================================================
  Execution time = 4.4970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3823e-01
  Total weights = 2.0000e+06
  Execution time = 4.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252851491
                                         uncertainty =       0.009077477108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252851491
                                         uncertainty =       0.009077477108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411238240
  error estimate for blocks of size 2^( 2) =       0.000422782494
  error estimate for blocks of size 2^( 3) =       0.000435403094
  error estimate for blocks of size 2^( 4) =       0.000447537120
  error estimate for blocks of size 2^( 5) =       0.000458565673
  error estimate for blocks of size 2^( 6) =       0.000467797401
  error estimate for blocks of size 2^( 7) =       0.000474301521

      target function =                  N/A
              le_mean =     -16.909611841292
             les_mean =     286.273206234401
             stat err =       0.000462050429
             autocorr =       1.262384842400
              std dev =       0.581578696604
             le_variance =       0.338233780344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338253144344
                                         uncertainty =       0.009077478351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338253144344
                                         uncertainty =       0.009077478351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411238418
  error estimate for blocks of size 2^( 2) =       0.000422782651
  error estimate for blocks of size 2^( 3) =       0.000435403227
  error estimate for blocks of size 2^( 4) =       0.000447537237
  error estimate for blocks of size 2^( 5) =       0.000458565790
  error estimate for blocks of size 2^( 6) =       0.000467797508
  error estimate for blocks of size 2^( 7) =       0.000474301624

      target function =                  N/A
              le_mean =     -16.909611840174
             les_mean =     286.273206489302
             stat err =       0.000462050540
             autocorr =       1.262384356324
              std dev =       0.581578948270
             le_variance =       0.338234073070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252997921
                                         uncertainty =       0.009077477729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252997921
                                         uncertainty =       0.009077477729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411238329
  error estimate for blocks of size 2^( 2) =       0.000422782572
  error estimate for blocks of size 2^( 3) =       0.000435403160
  error estimate for blocks of size 2^( 4) =       0.000447537178
  error estimate for blocks of size 2^( 5) =       0.000458565732
  error estimate for blocks of size 2^( 6) =       0.000467797455
  error estimate for blocks of size 2^( 7) =       0.000474301572

      target function =                  N/A
              le_mean =     -16.909611840733
             les_mean =     286.273206361839
             stat err =       0.000462050484
             autocorr =       1.262384599339
              std dev =       0.581578822440
             le_variance =       0.338233926710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252869795
                                         uncertainty =       0.009077477185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252869795
                                         uncertainty =       0.009077477185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411238251
  error estimate for blocks of size 2^( 2) =       0.000422782504
  error estimate for blocks of size 2^( 3) =       0.000435403102
  error estimate for blocks of size 2^( 4) =       0.000447537127
  error estimate for blocks of size 2^( 5) =       0.000458565681
  error estimate for blocks of size 2^( 6) =       0.000467797408
  error estimate for blocks of size 2^( 7) =       0.000474301527

      target function =                  N/A
              le_mean =     -16.909611841222
             les_mean =     286.273206250329
             stat err =       0.000462050436
             autocorr =       1.262384812015
              std dev =       0.581578712334
             le_variance =       0.338233798640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909611841292        initial  <--
     1.4901e+03     1.4901e+04             4.2600e-07       -16.909611840174
     5.9605e+03     5.9605e+04             1.0651e-07       -16.909611840733
     2.3842e+04     2.3842e+05             2.6627e-08       -16.909611841222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.2567
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618942e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2744e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9723
    reference variance = 0.20341
====================================================
  Execution time = 4.5678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1970e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321191865064
                                         uncertainty =       0.003119984144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321191865064
                                         uncertainty =       0.003119984144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400748678
  error estimate for blocks of size 2^( 2) =       0.000413055375
  error estimate for blocks of size 2^( 3) =       0.000425124091
  error estimate for blocks of size 2^( 4) =       0.000436589666
  error estimate for blocks of size 2^( 5) =       0.000448046890
  error estimate for blocks of size 2^( 6) =       0.000457254069
  error estimate for blocks of size 2^( 7) =       0.000461396093

      target function =                  N/A
              le_mean =     -16.910332063773
             les_mean =     286.280529352355
             stat err =       0.000450821679
             autocorr =       1.265509437920
              std dev =       0.566744215571
             le_variance =       0.321199005883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691033206377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910332063773       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910332064345       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910332064669       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910332064694       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910332064743       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910332064636       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910332064739       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910332064738       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910332064764       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 4.954817e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910332063773       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910332063916       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910332063997       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910332063988       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910332064022       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910332064016       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910332064040       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910332064027       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910332064022       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 1.238713e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910332063773       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910332063809       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910332063829       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910332063831       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910332063545       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910332063885       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910332063739       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910332063710       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910332063620       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 3.096787e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156538 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7656e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302884e-02 1 1  ON 4
 uu_5                -9.707650e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618951e-03 1 1  ON 13
 ud_4                -6.088975e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368838e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323285e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106484e-02 1 1  ON 42
eH2_3                -3.968534e-02 1 1  ON 43
eH2_4                 8.363165e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9287
    reference variance = 0.43906
====================================================
  Execution time = 4.5468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3366e-01
  Total weights = 2.0000e+06
  Execution time = 4.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731712574
                                         uncertainty =       0.005002936159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731712574
                                         uncertainty =       0.005002936159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408446279
  error estimate for blocks of size 2^( 2) =       0.000420454315
  error estimate for blocks of size 2^( 3) =       0.000433335650
  error estimate for blocks of size 2^( 4) =       0.000446044604
  error estimate for blocks of size 2^( 5) =       0.000457264728
  error estimate for blocks of size 2^( 6) =       0.000466047629
  error estimate for blocks of size 2^( 7) =       0.000473860879

      target function =                  N/A
              le_mean =     -16.909774720606
             les_mean =     286.274137660143
             stat err =       0.000460804460
             autocorr =       1.272809653593
              std dev =       0.577630266987
             le_variance =       0.333656725340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731743402
                                         uncertainty =       0.005002936934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731743402
                                         uncertainty =       0.005002936934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408446298
  error estimate for blocks of size 2^( 2) =       0.000420454332
  error estimate for blocks of size 2^( 3) =       0.000433335665
  error estimate for blocks of size 2^( 4) =       0.000446044617
  error estimate for blocks of size 2^( 5) =       0.000457264740
  error estimate for blocks of size 2^( 6) =       0.000466047641
  error estimate for blocks of size 2^( 7) =       0.000473860890

      target function =                  N/A
              le_mean =     -16.909774720415
             les_mean =     286.274137684528
             stat err =       0.000460804472
             autocorr =       1.272809601186
              std dev =       0.577630293674
             le_variance =       0.333656756170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731727988
                                         uncertainty =       0.005002936547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731727988
                                         uncertainty =       0.005002936547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408446288
  error estimate for blocks of size 2^( 2) =       0.000420454323
  error estimate for blocks of size 2^( 3) =       0.000433335657
  error estimate for blocks of size 2^( 4) =       0.000446044611
  error estimate for blocks of size 2^( 5) =       0.000457264734
  error estimate for blocks of size 2^( 6) =       0.000466047635
  error estimate for blocks of size 2^( 7) =       0.000473860884

      target function =                  N/A
              le_mean =     -16.909774720510
             les_mean =     286.274137672335
             stat err =       0.000460804466
             autocorr =       1.272809627379
              std dev =       0.577630280331
             le_variance =       0.333656740755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731714501
                                         uncertainty =       0.005002936207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333731714501
                                         uncertainty =       0.005002936207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408446280
  error estimate for blocks of size 2^( 2) =       0.000420454316
  error estimate for blocks of size 2^( 3) =       0.000433335651
  error estimate for blocks of size 2^( 4) =       0.000446044605
  error estimate for blocks of size 2^( 5) =       0.000457264729
  error estimate for blocks of size 2^( 6) =       0.000466047630
  error estimate for blocks of size 2^( 7) =       0.000473860880

      target function =                  N/A
              le_mean =     -16.909774720594
             les_mean =     286.274137661667
             stat err =       0.000460804461
             autocorr =       1.272809650325
              std dev =       0.577630268655
             le_variance =       0.333656727267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909774720606        initial  <--
     1.4901e+04     1.4901e+05             4.9548e-08       -16.909774720415
     5.9605e+04     5.9605e+05             1.2387e-08       -16.909774720510
     2.3842e+05     2.3842e+06             3.0968e-09       -16.909774720594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.7938
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618942e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2746e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9113
    reference variance = 0.219361
====================================================
  Execution time = 4.5529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3272e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2181e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818329173
                                         uncertainty =       0.005525105517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818329173
                                         uncertainty =       0.005525105517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407874752
  error estimate for blocks of size 2^( 2) =       0.000420299976
  error estimate for blocks of size 2^( 3) =       0.000433276862
  error estimate for blocks of size 2^( 4) =       0.000445539520
  error estimate for blocks of size 2^( 5) =       0.000456778804
  error estimate for blocks of size 2^( 6) =       0.000466207409
  error estimate for blocks of size 2^( 7) =       0.000470371385

      target function =                  N/A
              le_mean =     -16.909989290732
             les_mean =     286.280461272467
             stat err =       0.000459724280
             autocorr =       1.270402199457
              std dev =       0.576822005625
             le_variance =       0.332723626174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690998929073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909989290732       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909989290804       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909989290815       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909989290821       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909989290819       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909989290917       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909989290477       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909989290800       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909989290892       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 4.337673e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909989290732       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909989290750       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909989290752       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909989290817       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909989290718       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909989290860       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909989290532       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909989290720       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909989290571       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.084419e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909989290732       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909989290736       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909989290737       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909989290737       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909989291446       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909989290823       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909989289418       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909989290774       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909989290554       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.711048e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159557 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7718e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618943e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9251
    reference variance = 0.324703
====================================================
  Execution time = 4.4063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2622e-01
  Total weights = 2.0000e+06
  Execution time = 4.8416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238633029
                                         uncertainty =       0.004020172282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238633029
                                         uncertainty =       0.004020172282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403871853
  error estimate for blocks of size 2^( 2) =       0.000416590993
  error estimate for blocks of size 2^( 3) =       0.000429563101
  error estimate for blocks of size 2^( 4) =       0.000442389377
  error estimate for blocks of size 2^( 5) =       0.000454540396
  error estimate for blocks of size 2^( 6) =       0.000463696882
  error estimate for blocks of size 2^( 7) =       0.000470176597

      target function =                  N/A
              le_mean =     -16.910083282106
             les_mean =     286.277141392008
             stat err =       0.000457700813
             autocorr =       1.284328717409
              std dev =       0.571161052026
             le_variance =       0.326224947351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238636005
                                         uncertainty =       0.004020172307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238636005
                                         uncertainty =       0.004020172307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403871855
  error estimate for blocks of size 2^( 2) =       0.000416590995
  error estimate for blocks of size 2^( 3) =       0.000429563102
  error estimate for blocks of size 2^( 4) =       0.000442389378
  error estimate for blocks of size 2^( 5) =       0.000454540397
  error estimate for blocks of size 2^( 6) =       0.000463696883
  error estimate for blocks of size 2^( 7) =       0.000470176598

      target function =                  N/A
              le_mean =     -16.910083282068
             les_mean =     286.277141393686
             stat err =       0.000457700814
             autocorr =       1.284328711927
              std dev =       0.571161054630
             le_variance =       0.326224950326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238634517
                                         uncertainty =       0.004020172295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238634517
                                         uncertainty =       0.004020172295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403871854
  error estimate for blocks of size 2^( 2) =       0.000416590994
  error estimate for blocks of size 2^( 3) =       0.000429563101
  error estimate for blocks of size 2^( 4) =       0.000442389378
  error estimate for blocks of size 2^( 5) =       0.000454540396
  error estimate for blocks of size 2^( 6) =       0.000463696883
  error estimate for blocks of size 2^( 7) =       0.000470176598

      target function =                  N/A
              le_mean =     -16.910083282087
             les_mean =     286.277141392847
             stat err =       0.000457700813
             autocorr =       1.284328714674
              std dev =       0.571161053328
             le_variance =       0.326224948839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238633215
                                         uncertainty =       0.004020172283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326238633215
                                         uncertainty =       0.004020172283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403871853
  error estimate for blocks of size 2^( 2) =       0.000416590993
  error estimate for blocks of size 2^( 3) =       0.000429563101
  error estimate for blocks of size 2^( 4) =       0.000442389377
  error estimate for blocks of size 2^( 5) =       0.000454540396
  error estimate for blocks of size 2^( 6) =       0.000463696882
  error estimate for blocks of size 2^( 7) =       0.000470176597

      target function =                  N/A
              le_mean =     -16.910083282104
             les_mean =     286.277141392113
             stat err =       0.000457700813
             autocorr =       1.284328717068
              std dev =       0.571161052189
             le_variance =       0.326224947537


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910083282106        initial  <--
     1.4901e+05     1.4901e+06             4.3377e-09       -16.910083282068
     5.9605e+05     5.9605e+06             1.0844e-09       -16.910083282087
     2.3842e+06     2.3842e+07             2.7110e-10       -16.910083282104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.3809
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618942e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2610e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8595
    reference variance = 0.305996
====================================================
  Execution time = 4.5498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4286e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2155e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342917167927
                                         uncertainty =       0.007707884691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342917167927
                                         uncertainty =       0.007707884691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414043303
  error estimate for blocks of size 2^( 2) =       0.000426215863
  error estimate for blocks of size 2^( 3) =       0.000438627577
  error estimate for blocks of size 2^( 4) =       0.000449931224
  error estimate for blocks of size 2^( 5) =       0.000459486210
  error estimate for blocks of size 2^( 6) =       0.000467597753
  error estimate for blocks of size 2^( 7) =       0.000470507545

      target function =                  N/A
              le_mean =     -16.910331187587
             les_mean =     286.302164415409
             stat err =       0.000461880683
             autocorr =       1.244423117635
              std dev =       0.585545654043
             le_variance =       0.342863712968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691033118759e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910331187587       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910331187593       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910331187598       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910331187598       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910331187264       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910331189221       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910331187394       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910331187038       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910331186372       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.668074e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910331187587       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910331187588       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910331187590       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910331187906       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910331187484       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910331186360       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910331205105       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910331180256       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910331183603       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 9.170190e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910331187587       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910331187587       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910331187588       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910331187588       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910331187588       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910331187354       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910331194712       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910331199146       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910331174882       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 2.292573e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7661e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618942e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9708
    reference variance = 0.345322
====================================================
  Execution time = 4.4514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2448e-01
  Total weights = 2.0000e+06
  Execution time = 4.8471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618657
                                         uncertainty =       0.002936116866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618657
                                         uncertainty =       0.002936116866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402788259
  error estimate for blocks of size 2^( 2) =       0.000414823192
  error estimate for blocks of size 2^( 3) =       0.000427357361
  error estimate for blocks of size 2^( 4) =       0.000439749877
  error estimate for blocks of size 2^( 5) =       0.000450058451
  error estimate for blocks of size 2^( 6) =       0.000457142982
  error estimate for blocks of size 2^( 7) =       0.000462073779

      target function =                  N/A
              le_mean =     -16.909901540301
             les_mean =     286.269246703645
             stat err =       0.000452256272
             autocorr =       1.260711144896
              std dev =       0.569628618659
             le_variance =       0.324476763195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618879
                                         uncertainty =       0.002936116867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618879
                                         uncertainty =       0.002936116867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402788259
  error estimate for blocks of size 2^( 2) =       0.000414823192
  error estimate for blocks of size 2^( 3) =       0.000427357361
  error estimate for blocks of size 2^( 4) =       0.000439749877
  error estimate for blocks of size 2^( 5) =       0.000450058451
  error estimate for blocks of size 2^( 6) =       0.000457142982
  error estimate for blocks of size 2^( 7) =       0.000462073779

      target function =                  N/A
              le_mean =     -16.909901540303
             les_mean =     286.269246703935
             stat err =       0.000452256272
             autocorr =       1.260711144509
              std dev =       0.569628618854
             le_variance =       0.324476763417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618768
                                         uncertainty =       0.002936116866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618768
                                         uncertainty =       0.002936116866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402788259
  error estimate for blocks of size 2^( 2) =       0.000414823192
  error estimate for blocks of size 2^( 3) =       0.000427357361
  error estimate for blocks of size 2^( 4) =       0.000439749877
  error estimate for blocks of size 2^( 5) =       0.000450058451
  error estimate for blocks of size 2^( 6) =       0.000457142982
  error estimate for blocks of size 2^( 7) =       0.000462073779

      target function =                  N/A
              le_mean =     -16.909901540302
             les_mean =     286.269246703790
             stat err =       0.000452256272
             autocorr =       1.260711144694
              std dev =       0.569628618756
             le_variance =       0.324476763306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618671
                                         uncertainty =       0.002936116866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324508618671
                                         uncertainty =       0.002936116866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402788259
  error estimate for blocks of size 2^( 2) =       0.000414823192
  error estimate for blocks of size 2^( 3) =       0.000427357361
  error estimate for blocks of size 2^( 4) =       0.000439749877
  error estimate for blocks of size 2^( 5) =       0.000450058451
  error estimate for blocks of size 2^( 6) =       0.000457142982
  error estimate for blocks of size 2^( 7) =       0.000462073779

      target function =                  N/A
              le_mean =     -16.909901540302
             les_mean =     286.269246703663
             stat err =       0.000452256272
             autocorr =       1.260711144869
              std dev =       0.569628618671
             le_variance =       0.324476763209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909901540301        initial
     1.4901e+06     1.4901e+07             3.6681e-10       -16.909901540303  <--
     5.9605e+06     5.9605e+07             9.1702e-11       -16.909901540302
     2.3842e+07     2.3842e+08             2.2926e-11       -16.909901540302

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 7.0910e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618943e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2858e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8312
    reference variance = 0.194399
====================================================
  Execution time = 4.5406e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2480e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2048e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324886657904
                                         uncertainty =       0.002491882122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324886657904
                                         uncertainty =       0.002491882122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402988842
  error estimate for blocks of size 2^( 2) =       0.000414634613
  error estimate for blocks of size 2^( 3) =       0.000427038118
  error estimate for blocks of size 2^( 4) =       0.000438986713
  error estimate for blocks of size 2^( 5) =       0.000449892267
  error estimate for blocks of size 2^( 6) =       0.000456038414
  error estimate for blocks of size 2^( 7) =       0.000460202573

      target function =                  N/A
              le_mean =     -16.911119698288
             les_mean =     286.310769301780
             stat err =       0.000451279992
             autocorr =       1.254024766381
              std dev =       0.569912286538
             le_variance =       0.324800014347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691111969829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911119698288       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911119698307       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911119698317       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911119698321       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911119698013       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911119698465       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911119698258       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911119698546       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911119698703       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.866970e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911119698288       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911119698293       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911119698295       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911119699003       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911119698727       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911119697734       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911119698968       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911119698733       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911119698653       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 4.667426e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911119698288       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911119698289       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911119698290       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911119698290       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911119698814       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911119700794       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911119698407       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911119697613       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911119697663       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 1.166857e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7462e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618943e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107946e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363160e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8753
    reference variance = 0.219192
====================================================
  Execution time = 4.4601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5351e-01
  Total weights = 2.0000e+06
  Execution time = 4.8641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668157298
                                         uncertainty =       0.014237550591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668157298
                                         uncertainty =       0.014237550591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420425435
  error estimate for blocks of size 2^( 2) =       0.000431982535
  error estimate for blocks of size 2^( 3) =       0.000443973305
  error estimate for blocks of size 2^( 4) =       0.000455357750
  error estimate for blocks of size 2^( 5) =       0.000465333852
  error estimate for blocks of size 2^( 6) =       0.000472141105
  error estimate for blocks of size 2^( 7) =       0.000479201478

      target function =                  N/A
              le_mean =     -16.910305756868
             les_mean =     286.311955707100
             stat err =       0.000468008546
             autocorr =       1.239166325972
              std dev =       0.594571352403
             le_variance =       0.353515093098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668158448
                                         uncertainty =       0.014237550586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668158448
                                         uncertainty =       0.014237550586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420425436
  error estimate for blocks of size 2^( 2) =       0.000431982536
  error estimate for blocks of size 2^( 3) =       0.000443973306
  error estimate for blocks of size 2^( 4) =       0.000455357750
  error estimate for blocks of size 2^( 5) =       0.000465333853
  error estimate for blocks of size 2^( 6) =       0.000472141106
  error estimate for blocks of size 2^( 7) =       0.000479201479

      target function =                  N/A
              le_mean =     -16.910305756872
             les_mean =     286.311955708377
             stat err =       0.000468008547
             autocorr =       1.239166323930
              std dev =       0.594571353370
             le_variance =       0.353515094248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668157873
                                         uncertainty =       0.014237550588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668157873
                                         uncertainty =       0.014237550588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420425436
  error estimate for blocks of size 2^( 2) =       0.000431982536
  error estimate for blocks of size 2^( 3) =       0.000443973305
  error estimate for blocks of size 2^( 4) =       0.000455357750
  error estimate for blocks of size 2^( 5) =       0.000465333853
  error estimate for blocks of size 2^( 6) =       0.000472141106
  error estimate for blocks of size 2^( 7) =       0.000479201478

      target function =                  N/A
              le_mean =     -16.910305756870
             les_mean =     286.311955707738
             stat err =       0.000468008547
             autocorr =       1.239166324955
              std dev =       0.594571352887
             le_variance =       0.353515093673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668157370
                                         uncertainty =       0.014237550591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353668157370
                                         uncertainty =       0.014237550591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420425435
  error estimate for blocks of size 2^( 2) =       0.000431982535
  error estimate for blocks of size 2^( 3) =       0.000443973305
  error estimate for blocks of size 2^( 4) =       0.000455357750
  error estimate for blocks of size 2^( 5) =       0.000465333853
  error estimate for blocks of size 2^( 6) =       0.000472141105
  error estimate for blocks of size 2^( 7) =       0.000479201478

      target function =                  N/A
              le_mean =     -16.910305756868
             les_mean =     286.311955707180
             stat err =       0.000468008546
             autocorr =       1.239166325855
              std dev =       0.594571352464
             le_variance =       0.353515093170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910305756868        initial
     3.7253e+05     3.7253e+06             1.8670e-09       -16.910305756872  <--
     1.4901e+06     1.4901e+07             4.6674e-10       -16.910305756870
     5.9605e+06     5.9605e+07             1.1669e-10       -16.910305756868

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 6.9081e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2655e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.0018
    reference variance = 0.234928
====================================================
  Execution time = 4.5268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3170e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1969e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331546662480
                                         uncertainty =       0.004403728479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331546662480
                                         uncertainty =       0.004403728479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407248611
  error estimate for blocks of size 2^( 2) =       0.000418843984
  error estimate for blocks of size 2^( 3) =       0.000431676885
  error estimate for blocks of size 2^( 4) =       0.000444349211
  error estimate for blocks of size 2^( 5) =       0.000454872642
  error estimate for blocks of size 2^( 6) =       0.000465068158
  error estimate for blocks of size 2^( 7) =       0.000471341739

      target function =                  N/A
              le_mean =     -16.909918492561
             les_mean =     286.277046121294
             stat err =       0.000458907937
             autocorr =       1.269790037617
              std dev =       0.575936508746
             le_variance =       0.331702862106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690991849256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909918492561       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909918492640       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909918492708       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909918492726       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909918492727       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909918492786       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909918492727       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909918492708       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909918492693       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 6.056926e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909918492561       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909918492580       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909918492597       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909918492606       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909918492885       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909918492543       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909918492584       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909918492620       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909918492627       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.514233e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909918492561       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909918492565       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909918492570       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909918492571       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909918492551       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909918492667       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909918497580       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909918492242       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909918493032       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.785592e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7245e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302884e-02 1 1  ON 4
 uu_5                -9.707650e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618945e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9398
    reference variance = 0.407008
====================================================
  Execution time = 4.4323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2812e-01
  Total weights = 2.0000e+06
  Execution time = 4.8300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138708542
                                         uncertainty =       0.007098008911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138708542
                                         uncertainty =       0.007098008911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405043815
  error estimate for blocks of size 2^( 2) =       0.000416741776
  error estimate for blocks of size 2^( 3) =       0.000428923496
  error estimate for blocks of size 2^( 4) =       0.000440363433
  error estimate for blocks of size 2^( 5) =       0.000449658409
  error estimate for blocks of size 2^( 6) =       0.000455756496
  error estimate for blocks of size 2^( 7) =       0.000460020407

      target function =                  N/A
              le_mean =     -16.909619358827
             les_mean =     286.263347680285
             stat err =       0.000451449686
             autocorr =       1.242266293872
              std dev =       0.572818456344
             le_variance =       0.328120983928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138712821
                                         uncertainty =       0.007098008960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138712821
                                         uncertainty =       0.007098008960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405043818
  error estimate for blocks of size 2^( 2) =       0.000416741778
  error estimate for blocks of size 2^( 3) =       0.000428923498
  error estimate for blocks of size 2^( 4) =       0.000440363435
  error estimate for blocks of size 2^( 5) =       0.000449658410
  error estimate for blocks of size 2^( 6) =       0.000455756498
  error estimate for blocks of size 2^( 7) =       0.000460020409

      target function =                  N/A
              le_mean =     -16.909619358734
             les_mean =     286.263347681408
             stat err =       0.000451449688
             autocorr =       1.242266286345
              std dev =       0.572818460081
             le_variance =       0.328120988209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138710682
                                         uncertainty =       0.007098008936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138710682
                                         uncertainty =       0.007098008936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405043816
  error estimate for blocks of size 2^( 2) =       0.000416741777
  error estimate for blocks of size 2^( 3) =       0.000428923497
  error estimate for blocks of size 2^( 4) =       0.000440363434
  error estimate for blocks of size 2^( 5) =       0.000449658409
  error estimate for blocks of size 2^( 6) =       0.000455756497
  error estimate for blocks of size 2^( 7) =       0.000460020408

      target function =                  N/A
              le_mean =     -16.909619358780
             les_mean =     286.263347680846
             stat err =       0.000451449687
             autocorr =       1.242266290116
              std dev =       0.572818458212
             le_variance =       0.328120986069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138708809
                                         uncertainty =       0.007098008914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328138708809
                                         uncertainty =       0.007098008914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405043815
  error estimate for blocks of size 2^( 2) =       0.000416741776
  error estimate for blocks of size 2^( 3) =       0.000428923496
  error estimate for blocks of size 2^( 4) =       0.000440363433
  error estimate for blocks of size 2^( 5) =       0.000449658409
  error estimate for blocks of size 2^( 6) =       0.000455756497
  error estimate for blocks of size 2^( 7) =       0.000460020408

      target function =                  N/A
              le_mean =     -16.909619358821
             les_mean =     286.263347680355
             stat err =       0.000451449686
             autocorr =       1.242266293402
              std dev =       0.572818456577
             le_variance =       0.328120984196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909619358827        initial  <--
     9.3132e+04     9.3132e+05             6.0569e-09       -16.909619358734
     3.7253e+05     3.7253e+06             1.5142e-09       -16.909619358780
     1.4901e+06     1.4901e+07             3.7856e-10       -16.909619358821

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.6297
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2588e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.42132
====================================================
  Execution time = 4.6908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3539e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1991e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335419327867
                                         uncertainty =       0.005789582306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335419327867
                                         uncertainty =       0.005789582306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409504154
  error estimate for blocks of size 2^( 2) =       0.000421658902
  error estimate for blocks of size 2^( 3) =       0.000434649533
  error estimate for blocks of size 2^( 4) =       0.000446475570
  error estimate for blocks of size 2^( 5) =       0.000458048361
  error estimate for blocks of size 2^( 6) =       0.000467101763
  error estimate for blocks of size 2^( 7) =       0.000471754316

      target function =                  N/A
              le_mean =     -16.910212899867
             les_mean =     286.290687454860
             stat err =       0.000460845003
             autocorr =       1.266464854795
              std dev =       0.579126327950
             le_variance =       0.335387303725


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691021289987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212899867       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212899874       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212899875       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212899819       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212900049       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212900056       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212899402       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212899342       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 7.607722e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212899867       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212899869       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212899869       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212899869       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212899846       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212899339       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212901113       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212899607       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.901932e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910212899867       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910212899867       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910212899868       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212906908       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212897241       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212896510       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212888093       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212912658       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 4.754797e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8911e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8741
    reference variance = 0.326837
====================================================
  Execution time = 4.3993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.6053e-01
  Total weights = 2.0000e+06
  Execution time = 4.8290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621994793
                                         uncertainty =       0.021866635482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621994793
                                         uncertainty =       0.021866635482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424573977
  error estimate for blocks of size 2^( 2) =       0.000436330436
  error estimate for blocks of size 2^( 3) =       0.000448534280
  error estimate for blocks of size 2^( 4) =       0.000461002451
  error estimate for blocks of size 2^( 5) =       0.000473311455
  error estimate for blocks of size 2^( 6) =       0.000481110171
  error estimate for blocks of size 2^( 7) =       0.000490016074

      target function =                  N/A
              le_mean =     -16.910116655166
             les_mean =     286.312571235443
             stat err =       0.000476360038
             autocorr =       1.258820763192
              std dev =       0.600438276913
             le_variance =       0.360526124382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621995495
                                         uncertainty =       0.021866635617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621995495
                                         uncertainty =       0.021866635617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424573978
  error estimate for blocks of size 2^( 2) =       0.000436330436
  error estimate for blocks of size 2^( 3) =       0.000448534280
  error estimate for blocks of size 2^( 4) =       0.000461002451
  error estimate for blocks of size 2^( 5) =       0.000473311455
  error estimate for blocks of size 2^( 6) =       0.000481110172
  error estimate for blocks of size 2^( 7) =       0.000490016074

      target function =                  N/A
              le_mean =     -16.910116655165
             les_mean =     286.312571236098
             stat err =       0.000476360038
             autocorr =       1.258820762299
              std dev =       0.600438277498
             le_variance =       0.360526125085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621995144
                                         uncertainty =       0.021866635550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621995144
                                         uncertainty =       0.021866635550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424573977
  error estimate for blocks of size 2^( 2) =       0.000436330436
  error estimate for blocks of size 2^( 3) =       0.000448534280
  error estimate for blocks of size 2^( 4) =       0.000461002451
  error estimate for blocks of size 2^( 5) =       0.000473311455
  error estimate for blocks of size 2^( 6) =       0.000481110172
  error estimate for blocks of size 2^( 7) =       0.000490016074

      target function =                  N/A
              le_mean =     -16.910116655165
             les_mean =     286.312571235771
             stat err =       0.000476360038
             autocorr =       1.258820762746
              std dev =       0.600438277205
             le_variance =       0.360526124733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621994837
                                         uncertainty =       0.021866635491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360621994837
                                         uncertainty =       0.021866635491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424573977
  error estimate for blocks of size 2^( 2) =       0.000436330436
  error estimate for blocks of size 2^( 3) =       0.000448534280
  error estimate for blocks of size 2^( 4) =       0.000461002451
  error estimate for blocks of size 2^( 5) =       0.000473311455
  error estimate for blocks of size 2^( 6) =       0.000481110171
  error estimate for blocks of size 2^( 7) =       0.000490016074

      target function =                  N/A
              le_mean =     -16.910116655166
             les_mean =     286.312571235484
             stat err =       0.000476360038
             autocorr =       1.258820763137
              std dev =       0.600438276949
             le_variance =       0.360526124426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910116655166        initial  <--
     9.3132e+05     9.3132e+06             7.6077e-10       -16.910116655165
     3.7253e+06     3.7253e+07             1.9019e-10       -16.910116655165
     1.4901e+07     1.4901e+08             4.7548e-11       -16.910116655166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.3075
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2732e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9409
    reference variance = 0.366577
====================================================
  Execution time = 4.5629e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2860e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2095e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328640641076
                                         uncertainty =       0.003931195469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328640641076
                                         uncertainty =       0.003931195469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405338954
  error estimate for blocks of size 2^( 2) =       0.000417532544
  error estimate for blocks of size 2^( 3) =       0.000429893064
  error estimate for blocks of size 2^( 4) =       0.000441197842
  error estimate for blocks of size 2^( 5) =       0.000451657471
  error estimate for blocks of size 2^( 6) =       0.000459341491
  error estimate for blocks of size 2^( 7) =       0.000463698140

      target function =                  N/A
              le_mean =     -16.911217998636
             les_mean =     286.317893368040
             stat err =       0.000453973736
             autocorr =       1.254367438221
              std dev =       0.573235845822
             le_variance =       0.328599334935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691121799864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911217998636       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911217998637       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911217998637       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911217998637       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911217998637       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911218007340       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911218002103       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911217991513       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911217996997       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 7.376153e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911217998636       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911217998637       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911217998637       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911217999397       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911217956277       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911217994931       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911218018203       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911217990154       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911217987357       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 1.844045e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911217998636       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911217998636       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911217998636       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911217998636       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911217998636       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911217998636       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911218025858       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911218055187       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911217967802       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 4.610452e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174356 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7732e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.183497
====================================================
  Execution time = 4.4298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3953e-01
  Total weights = 2.0000e+06
  Execution time = 4.8487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441056
                                         uncertainty =       0.012089408642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441056
                                         uncertainty =       0.012089408642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412025160
  error estimate for blocks of size 2^( 2) =       0.000424015508
  error estimate for blocks of size 2^( 3) =       0.000436756598
  error estimate for blocks of size 2^( 4) =       0.000449262728
  error estimate for blocks of size 2^( 5) =       0.000459575985
  error estimate for blocks of size 2^( 6) =       0.000466670979
  error estimate for blocks of size 2^( 7) =       0.000468829020

      target function =                  N/A
              le_mean =     -16.908709643517
             les_mean =     286.243991104535
             stat err =       0.000461084678
             autocorr =       1.252315936185
              std dev =       0.582691569807
             le_variance =       0.339529465524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441090
                                         uncertainty =       0.012089408644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441090
                                         uncertainty =       0.012089408644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412025160
  error estimate for blocks of size 2^( 2) =       0.000424015508
  error estimate for blocks of size 2^( 3) =       0.000436756598
  error estimate for blocks of size 2^( 4) =       0.000449262728
  error estimate for blocks of size 2^( 5) =       0.000459575985
  error estimate for blocks of size 2^( 6) =       0.000466670979
  error estimate for blocks of size 2^( 7) =       0.000468829020

      target function =                  N/A
              le_mean =     -16.908709643517
             les_mean =     286.243991104567
             stat err =       0.000461084678
             autocorr =       1.252315936104
              std dev =       0.582691569835
             le_variance =       0.339529465557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441073
                                         uncertainty =       0.012089408643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441073
                                         uncertainty =       0.012089408643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412025160
  error estimate for blocks of size 2^( 2) =       0.000424015508
  error estimate for blocks of size 2^( 3) =       0.000436756598
  error estimate for blocks of size 2^( 4) =       0.000449262728
  error estimate for blocks of size 2^( 5) =       0.000459575985
  error estimate for blocks of size 2^( 6) =       0.000466670979
  error estimate for blocks of size 2^( 7) =       0.000468829020

      target function =                  N/A
              le_mean =     -16.908709643517
             les_mean =     286.243991104551
             stat err =       0.000461084678
             autocorr =       1.252315936143
              std dev =       0.582691569821
             le_variance =       0.339529465540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441059
                                         uncertainty =       0.012089408642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338926441059
                                         uncertainty =       0.012089408642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412025160
  error estimate for blocks of size 2^( 2) =       0.000424015508
  error estimate for blocks of size 2^( 3) =       0.000436756598
  error estimate for blocks of size 2^( 4) =       0.000449262728
  error estimate for blocks of size 2^( 5) =       0.000459575985
  error estimate for blocks of size 2^( 6) =       0.000466670979
  error estimate for blocks of size 2^( 7) =       0.000468829020

      target function =                  N/A
              le_mean =     -16.908709643517
             les_mean =     286.243991104537
             stat err =       0.000461084678
             autocorr =       1.252315936183
              std dev =       0.582691569808
             le_variance =       0.339529465526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.908709643517        initial  <--
     9.3132e+06     9.3132e+07             7.3762e-11       -16.908709643517
     3.7253e+07     3.7253e+08             1.8440e-11       -16.908709643517
     1.4901e+08     1.4901e+09             4.6105e-12       -16.908709643517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.6539
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2639e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9263
    reference variance = 0.22993
====================================================
  Execution time = 4.4908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1847e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771862869
                                         uncertainty =       0.008220494433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338771862869
                                         uncertainty =       0.008220494433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411547597
  error estimate for blocks of size 2^( 2) =       0.000423605027
  error estimate for blocks of size 2^( 3) =       0.000436055452
  error estimate for blocks of size 2^( 4) =       0.000448236505
  error estimate for blocks of size 2^( 5) =       0.000459354955
  error estimate for blocks of size 2^( 6) =       0.000466297644
  error estimate for blocks of size 2^( 7) =       0.000471783516

      target function =                  N/A
              le_mean =     -16.910472941455
             les_mean =     286.302837784126
             stat err =       0.000461418155
             autocorr =       1.257040341384
              std dev =       0.582016193764
             le_variance =       0.338742849803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691047294146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910472941455       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910472941455       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910472941456       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910472941456       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910472941456       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910472953068       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910472924076       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910472922111       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 6.721838e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910472941455       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910472941455       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910472941455       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910472941455       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910472664893       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910473051999       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910472701768       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910473398004       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.680333e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910472941455       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910472941455       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910472941455       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910472941455       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910472671694       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910472896806       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910472922512       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910471973755       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 4.200907e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6763e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8337
    reference variance = 0.207626
====================================================
  Execution time = 4.4699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2517e-01
  Total weights = 2.0000e+06
  Execution time = 4.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321129
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321129
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403220512
  error estimate for blocks of size 2^( 2) =       0.000415334061
  error estimate for blocks of size 2^( 3) =       0.000427154846
  error estimate for blocks of size 2^( 4) =       0.000438738172
  error estimate for blocks of size 2^( 5) =       0.000450029771
  error estimate for blocks of size 2^( 6) =       0.000457274031
  error estimate for blocks of size 2^( 7) =       0.000460490573

      target function =                  N/A
              le_mean =     -16.909920111366
             les_mean =     286.270571572618
             stat err =       0.000451633137
             autocorr =       1.254545349065
              std dev =       0.570239916541
             le_variance =       0.325173562417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321134
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321134
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403220512
  error estimate for blocks of size 2^( 2) =       0.000415334061
  error estimate for blocks of size 2^( 3) =       0.000427154846
  error estimate for blocks of size 2^( 4) =       0.000438738172
  error estimate for blocks of size 2^( 5) =       0.000450029771
  error estimate for blocks of size 2^( 6) =       0.000457274031
  error estimate for blocks of size 2^( 7) =       0.000460490573

      target function =                  N/A
              le_mean =     -16.909920111366
             les_mean =     286.270571572625
             stat err =       0.000451633137
             autocorr =       1.254545349062
              std dev =       0.570239916545
             le_variance =       0.325173562421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321131
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321131
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403220512
  error estimate for blocks of size 2^( 2) =       0.000415334061
  error estimate for blocks of size 2^( 3) =       0.000427154846
  error estimate for blocks of size 2^( 4) =       0.000438738172
  error estimate for blocks of size 2^( 5) =       0.000450029771
  error estimate for blocks of size 2^( 6) =       0.000457274031
  error estimate for blocks of size 2^( 7) =       0.000460490573

      target function =                  N/A
              le_mean =     -16.909920111366
             les_mean =     286.270571572621
             stat err =       0.000451633137
             autocorr =       1.254545349054
              std dev =       0.570239916543
             le_variance =       0.325173562419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321130
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325067321130
                                         uncertainty =       0.003438474768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403220512
  error estimate for blocks of size 2^( 2) =       0.000415334061
  error estimate for blocks of size 2^( 3) =       0.000427154846
  error estimate for blocks of size 2^( 4) =       0.000438738172
  error estimate for blocks of size 2^( 5) =       0.000450029771
  error estimate for blocks of size 2^( 6) =       0.000457274031
  error estimate for blocks of size 2^( 7) =       0.000460490573

      target function =                  N/A
              le_mean =     -16.909920111366
             les_mean =     286.270571572618
             stat err =       0.000451633137
             autocorr =       1.254545349067
              std dev =       0.570239916541
             le_variance =       0.325173562417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909920111366        initial
     9.3132e+07     9.3132e+08             6.7218e-12       -16.909920111366  <--
     3.7253e+08     3.7253e+09             1.6803e-12       -16.909920111366
     1.4901e+09     1.4901e+10             4.2009e-13       -16.909920111366

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 6.9091e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2586e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.258299
====================================================
  Execution time = 4.5630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3385e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1965e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333824502255
                                         uncertainty =       0.003348259486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333824502255
                                         uncertainty =       0.003348259486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408565707
  error estimate for blocks of size 2^( 2) =       0.000420647326
  error estimate for blocks of size 2^( 3) =       0.000433625022
  error estimate for blocks of size 2^( 4) =       0.000446274859
  error estimate for blocks of size 2^( 5) =       0.000458398453
  error estimate for blocks of size 2^( 6) =       0.000468838574
  error estimate for blocks of size 2^( 7) =       0.000474898490

      target function =                  N/A
              le_mean =     -16.909045362785
             les_mean =     286.249666787010
             stat err =       0.000462102594
             autocorr =       1.279242830857
              std dev =       0.577799163380
             le_variance =       0.333851873202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690904536279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909045362785       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909045362786       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909045362786       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909045362786       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909045370765       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909045355227       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909045359794       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909045379532       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909045357934       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 3.077218e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909045362785       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909045362785       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909045362786       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909045355335       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909045360242       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909045277720       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909045332993       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909045388586       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909045164717       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 7.692896e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909045362785       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909045362785       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909045362785       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909045411866       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909045339221       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909045474750       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909045261532       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909045218692       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909045359165       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.923026e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7603e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.150579
====================================================
  Execution time = 4.4401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3411e-01
  Total weights = 2.0000e+06
  Execution time = 4.8530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945709
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945709
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408724724
  error estimate for blocks of size 2^( 2) =       0.000420258027
  error estimate for blocks of size 2^( 3) =       0.000433387318
  error estimate for blocks of size 2^( 4) =       0.000444837056
  error estimate for blocks of size 2^( 5) =       0.000456031504
  error estimate for blocks of size 2^( 6) =       0.000463716205
  error estimate for blocks of size 2^( 7) =       0.000467489333

      target function =                  N/A
              le_mean =     -16.909325930917
             les_mean =     286.259415070252
             stat err =       0.000458018525
             autocorr =       1.255753130418
              std dev =       0.578024047348
             le_variance =       0.334111799312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945732
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945732
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408724724
  error estimate for blocks of size 2^( 2) =       0.000420258027
  error estimate for blocks of size 2^( 3) =       0.000433387318
  error estimate for blocks of size 2^( 4) =       0.000444837056
  error estimate for blocks of size 2^( 5) =       0.000456031504
  error estimate for blocks of size 2^( 6) =       0.000463716205
  error estimate for blocks of size 2^( 7) =       0.000467489333

      target function =                  N/A
              le_mean =     -16.909325930917
             les_mean =     286.259415070272
             stat err =       0.000458018525
             autocorr =       1.255753130388
              std dev =       0.578024047368
             le_variance =       0.334111799335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945720
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945720
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408724724
  error estimate for blocks of size 2^( 2) =       0.000420258027
  error estimate for blocks of size 2^( 3) =       0.000433387318
  error estimate for blocks of size 2^( 4) =       0.000444837056
  error estimate for blocks of size 2^( 5) =       0.000456031504
  error estimate for blocks of size 2^( 6) =       0.000463716205
  error estimate for blocks of size 2^( 7) =       0.000467489333

      target function =                  N/A
              le_mean =     -16.909325930917
             les_mean =     286.259415070262
             stat err =       0.000458018525
             autocorr =       1.255753130403
              std dev =       0.578024047358
             le_variance =       0.334111799324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945710
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334088945710
                                         uncertainty =       0.004537959221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408724724
  error estimate for blocks of size 2^( 2) =       0.000420258027
  error estimate for blocks of size 2^( 3) =       0.000433387318
  error estimate for blocks of size 2^( 4) =       0.000444837056
  error estimate for blocks of size 2^( 5) =       0.000456031504
  error estimate for blocks of size 2^( 6) =       0.000463716205
  error estimate for blocks of size 2^( 7) =       0.000467489333

      target function =                  N/A
              le_mean =     -16.909325930917
             les_mean =     286.259415070254
             stat err =       0.000458018525
             autocorr =       1.255753130412
              std dev =       0.578024047349
             le_variance =       0.334111799314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909325930917        initial  <--
     2.3283e+07     2.3283e+08             3.0772e-11       -16.909325930917
     9.3132e+07     9.3132e+08             7.6929e-12       -16.909325930917
     3.7253e+08     3.7253e+09             1.9230e-12       -16.909325930917

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.7592
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2637e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9052
    reference variance = 0.361738
====================================================
  Execution time = 4.4972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2041e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332181635492
                                         uncertainty =       0.004131765782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332181635492
                                         uncertainty =       0.004131765782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407583234
  error estimate for blocks of size 2^( 2) =       0.000419866087
  error estimate for blocks of size 2^( 3) =       0.000432122625
  error estimate for blocks of size 2^( 4) =       0.000444029148
  error estimate for blocks of size 2^( 5) =       0.000454282333
  error estimate for blocks of size 2^( 6) =       0.000461712173
  error estimate for blocks of size 2^( 7) =       0.000467763506

      target function =                  N/A
              le_mean =     -16.910296703893
             les_mean =     286.290382633652
             stat err =       0.000456946790
             autocorr =       1.256893957509
              std dev =       0.576409738013
             le_variance =       0.332248186077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691029670389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910296703893       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910296703893       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910296703893       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910296713344       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910296708914       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910296835126       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910296737341       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910296696360       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910296668465       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 2.800499e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910296703893       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910296703893       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910296703893       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910296703893       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910297709264       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910296636118       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910297103833       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910296979144       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910299978635       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 7.009810e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910296703893       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910296703893       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910296703893       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910295020998       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910299946500       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910295865186       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910293656469       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910298710764       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910294026452       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 1.748653e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7021e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9926
    reference variance = 0.239059
====================================================
  Execution time = 4.4353e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3255e-01
  Total weights = 2.0000e+06
  Execution time = 4.8288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188678
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188678
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407770895
  error estimate for blocks of size 2^( 2) =       0.000419466806
  error estimate for blocks of size 2^( 3) =       0.000431899351
  error estimate for blocks of size 2^( 4) =       0.000443337692
  error estimate for blocks of size 2^( 5) =       0.000454008313
  error estimate for blocks of size 2^( 6) =       0.000461176841
  error estimate for blocks of size 2^( 7) =       0.000466147139

      target function =                  N/A
              le_mean =     -16.910160438017
             les_mean =     286.286080079458
             stat err =       0.000456167496
             autocorr =       1.251457841691
              std dev =       0.576675130593
             le_variance =       0.332554206245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188680
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188680
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407770895
  error estimate for blocks of size 2^( 2) =       0.000419466806
  error estimate for blocks of size 2^( 3) =       0.000431899351
  error estimate for blocks of size 2^( 4) =       0.000443337692
  error estimate for blocks of size 2^( 5) =       0.000454008313
  error estimate for blocks of size 2^( 6) =       0.000461176841
  error estimate for blocks of size 2^( 7) =       0.000466147139

      target function =                  N/A
              le_mean =     -16.910160438017
             les_mean =     286.286080079460
             stat err =       0.000456167496
             autocorr =       1.251457841681
              std dev =       0.576675130595
             le_variance =       0.332554206247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188679
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188679
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407770895
  error estimate for blocks of size 2^( 2) =       0.000419466806
  error estimate for blocks of size 2^( 3) =       0.000431899351
  error estimate for blocks of size 2^( 4) =       0.000443337692
  error estimate for blocks of size 2^( 5) =       0.000454008313
  error estimate for blocks of size 2^( 6) =       0.000461176841
  error estimate for blocks of size 2^( 7) =       0.000466147139

      target function =                  N/A
              le_mean =     -16.910160438017
             les_mean =     286.286080079459
             stat err =       0.000456167496
             autocorr =       1.251457841697
              std dev =       0.576675130594
             le_variance =       0.332554206246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188678
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332617188678
                                         uncertainty =       0.004327443057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407770895
  error estimate for blocks of size 2^( 2) =       0.000419466806
  error estimate for blocks of size 2^( 3) =       0.000431899351
  error estimate for blocks of size 2^( 4) =       0.000443337692
  error estimate for blocks of size 2^( 5) =       0.000454008313
  error estimate for blocks of size 2^( 6) =       0.000461176841
  error estimate for blocks of size 2^( 7) =       0.000466147139

      target function =                  N/A
              le_mean =     -16.910160438017
             les_mean =     286.286080079458
             stat err =       0.000456167496
             autocorr =       1.251457841697
              std dev =       0.576675130594
             le_variance =       0.332554206245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910160438017        initial
     2.3283e+08     2.3283e+09             2.8005e-12       -16.910160438017  <--
     9.3132e+08     9.3132e+09             7.0098e-13       -16.910160438017
     3.7253e+09     3.7253e+10             1.7487e-13       -16.910160438017

*****************************************************************************
Applying the update for shift_i =   2.3283e+08     and shift_s =   2.3283e+09
*****************************************************************************

  Execution time = 6.8616e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2564e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9327
    reference variance = 0.189071
====================================================
  Execution time = 4.6419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3219e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1912e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332110834394
                                         uncertainty =       0.008166086097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332110834394
                                         uncertainty =       0.008166086097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407549942
  error estimate for blocks of size 2^( 2) =       0.000419874582
  error estimate for blocks of size 2^( 3) =       0.000432776079
  error estimate for blocks of size 2^( 4) =       0.000445259814
  error estimate for blocks of size 2^( 5) =       0.000457746023
  error estimate for blocks of size 2^( 6) =       0.000465274174
  error estimate for blocks of size 2^( 7) =       0.000471617316

      target function =                  N/A
              le_mean =     -16.909715224591
             les_mean =     286.270662721706
             stat err =       0.000459974331
             autocorr =       1.273812545052
              std dev =       0.576362655829
             le_variance =       0.332193911034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690971522459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909715224591       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909715224591       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909715224591       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909715194973       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909715232943       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909715177518       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909715205205       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909715208292       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909715183853       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 1.143282e-11

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909715224591       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909715224591       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909715224591       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909715224591       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909715339724       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909715264400       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909715708754       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909715247771       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909714995398       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 2.858876e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909715224591       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909715224591       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909715224591       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909715101528       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909715309941       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909716380707       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909713140720       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909715273036       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909715384466       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 7.141891e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8339e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8618
    reference variance = 0.461502
====================================================
  Execution time = 4.4888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2785e-01
  Total weights = 2.0000e+06
  Execution time = 4.8470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152522
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152522
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404879644
  error estimate for blocks of size 2^( 2) =       0.000417195171
  error estimate for blocks of size 2^( 3) =       0.000429778088
  error estimate for blocks of size 2^( 4) =       0.000441502816
  error estimate for blocks of size 2^( 5) =       0.000452187323
  error estimate for blocks of size 2^( 6) =       0.000459396535
  error estimate for blocks of size 2^( 7) =       0.000464652057

      target function =                  N/A
              le_mean =     -16.910226725177
             les_mean =     286.283622784990
             stat err =       0.000454434683
             autocorr =       1.259769399005
              std dev =       0.572586283477
             le_variance =       0.327855052026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152529
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152529
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404879644
  error estimate for blocks of size 2^( 2) =       0.000417195171
  error estimate for blocks of size 2^( 3) =       0.000429778088
  error estimate for blocks of size 2^( 4) =       0.000441502816
  error estimate for blocks of size 2^( 5) =       0.000452187323
  error estimate for blocks of size 2^( 6) =       0.000459396535
  error estimate for blocks of size 2^( 7) =       0.000464652057

      target function =                  N/A
              le_mean =     -16.910226725177
             les_mean =     286.283622784994
             stat err =       0.000454434683
             autocorr =       1.259769398996
              std dev =       0.572586283484
             le_variance =       0.327855052033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152525
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152525
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404879644
  error estimate for blocks of size 2^( 2) =       0.000417195171
  error estimate for blocks of size 2^( 3) =       0.000429778088
  error estimate for blocks of size 2^( 4) =       0.000441502816
  error estimate for blocks of size 2^( 5) =       0.000452187323
  error estimate for blocks of size 2^( 6) =       0.000459396535
  error estimate for blocks of size 2^( 7) =       0.000464652057

      target function =                  N/A
              le_mean =     -16.910226725177
             les_mean =     286.283622784992
             stat err =       0.000454434683
             autocorr =       1.259769398993
              std dev =       0.572586283480
             le_variance =       0.327855052030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152522
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327686152522
                                         uncertainty =       0.002715719038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404879644
  error estimate for blocks of size 2^( 2) =       0.000417195171
  error estimate for blocks of size 2^( 3) =       0.000429778088
  error estimate for blocks of size 2^( 4) =       0.000441502816
  error estimate for blocks of size 2^( 5) =       0.000452187323
  error estimate for blocks of size 2^( 6) =       0.000459396535
  error estimate for blocks of size 2^( 7) =       0.000464652057

      target function =                  N/A
              le_mean =     -16.910226725177
             les_mean =     286.283622784990
             stat err =       0.000454434683
             autocorr =       1.259769399007
              std dev =       0.572586283477
             le_variance =       0.327855052027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910226725177        initial  <--
     5.8208e+07     5.8208e+08             1.1433e-11       -16.910226725177
     2.3283e+08     2.3283e+09             2.8589e-12       -16.910226725177
     9.3132e+08     9.3132e+09             7.1419e-13       -16.910226725177

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 69.3106
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2766e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9008
    reference variance = 0.302234
====================================================
  Execution time = 4.4915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2759e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2005e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327623280454
                                         uncertainty =       0.003594780788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327623280454
                                         uncertainty =       0.003594780788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404715644
  error estimate for blocks of size 2^( 2) =       0.000417005031
  error estimate for blocks of size 2^( 3) =       0.000429931236
  error estimate for blocks of size 2^( 4) =       0.000441938586
  error estimate for blocks of size 2^( 5) =       0.000453820632
  error estimate for blocks of size 2^( 6) =       0.000463565804
  error estimate for blocks of size 2^( 7) =       0.000469162840

      target function =                  N/A
              le_mean =     -16.909298099843
             les_mean =     286.251951570699
             stat err =       0.000457121965
             autocorr =       1.275745944554
              std dev =       0.572354352760
             le_variance =       0.327589505124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690929809984e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909298099843       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909298099843       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909298099843       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909298099843       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909298099844       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909298074917       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909298094975       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909298254261       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909298149747       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 9.378993e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909298099843       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909298099843       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909298099843       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909298275126       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909298122316       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909299483448       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909298864318       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909297965743       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909297196220       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 2.342894e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909298099843       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909298099843       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909298099843       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909298099843       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909298099843       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909297895891       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909297061765       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909300303561       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909299760086       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 5.831307e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6928e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8193
    reference variance = 0.20333
====================================================
  Execution time = 4.4317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2701e-01
  Total weights = 2.0000e+06
  Execution time = 4.8335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005720
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005720
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404358519
  error estimate for blocks of size 2^( 2) =       0.000416719375
  error estimate for blocks of size 2^( 3) =       0.000429370348
  error estimate for blocks of size 2^( 4) =       0.000441367071
  error estimate for blocks of size 2^( 5) =       0.000453569202
  error estimate for blocks of size 2^( 6) =       0.000462790191
  error estimate for blocks of size 2^( 7) =       0.000468937460

      target function =                  N/A
              le_mean =     -16.909407118337
             les_mean =     286.255060554324
             stat err =       0.000456665981
             autocorr =       1.275452019831
              std dev =       0.571849301960
             le_variance =       0.327011624152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005721
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005721
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404358519
  error estimate for blocks of size 2^( 2) =       0.000416719375
  error estimate for blocks of size 2^( 3) =       0.000429370348
  error estimate for blocks of size 2^( 4) =       0.000441367071
  error estimate for blocks of size 2^( 5) =       0.000453569202
  error estimate for blocks of size 2^( 6) =       0.000462790191
  error estimate for blocks of size 2^( 7) =       0.000468937460

      target function =                  N/A
              le_mean =     -16.909407118337
             les_mean =     286.255060554324
             stat err =       0.000456665981
             autocorr =       1.275452019834
              std dev =       0.571849301960
             le_variance =       0.327011624152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005720
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005720
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404358519
  error estimate for blocks of size 2^( 2) =       0.000416719375
  error estimate for blocks of size 2^( 3) =       0.000429370348
  error estimate for blocks of size 2^( 4) =       0.000441367071
  error estimate for blocks of size 2^( 5) =       0.000453569202
  error estimate for blocks of size 2^( 6) =       0.000462790191
  error estimate for blocks of size 2^( 7) =       0.000468937460

      target function =                  N/A
              le_mean =     -16.909407118337
             les_mean =     286.255060554324
             stat err =       0.000456665981
             autocorr =       1.275452019837
              std dev =       0.571849301960
             le_variance =       0.327011624152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005720
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327048005720
                                         uncertainty =       0.002971127912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404358519
  error estimate for blocks of size 2^( 2) =       0.000416719375
  error estimate for blocks of size 2^( 3) =       0.000429370348
  error estimate for blocks of size 2^( 4) =       0.000441367071
  error estimate for blocks of size 2^( 5) =       0.000453569202
  error estimate for blocks of size 2^( 6) =       0.000462790191
  error estimate for blocks of size 2^( 7) =       0.000468937460

      target function =                  N/A
              le_mean =     -16.909407118337
             les_mean =     286.255060554324
             stat err =       0.000456665981
             autocorr =       1.275452019834
              std dev =       0.571849301960
             le_variance =       0.327011624152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909407118337        initial  <--
     5.8208e+08     5.8208e+09             9.3790e-13       -16.909407118337
     2.3283e+09     2.3283e+10             2.3429e-13       -16.909407118337
     9.3132e+09     9.3132e+10             5.8313e-14       -16.909407118337

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.6144
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2555e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9018
    reference variance = 0.250735
====================================================
  Execution time = 4.4872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4746e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2086e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347588721746
                                         uncertainty =       0.017515375391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347588721746
                                         uncertainty =       0.017515375391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416808956
  error estimate for blocks of size 2^( 2) =       0.000428525683
  error estimate for blocks of size 2^( 3) =       0.000440567563
  error estimate for blocks of size 2^( 4) =       0.000451699517
  error estimate for blocks of size 2^( 5) =       0.000460818012
  error estimate for blocks of size 2^( 6) =       0.000467460376
  error estimate for blocks of size 2^( 7) =       0.000471689825

      target function =                  N/A
              le_mean =     -16.910644567136
             les_mean =     286.317358913110
             stat err =       0.000462916932
             autocorr =       1.233479822019
              std dev =       0.589456877851
             le_variance =       0.347459410845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691064456714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910644567136       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910644567136       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910644567136       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910644567136       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910644808070       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910645576488       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910638115887       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910646846532       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910642643339       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 1.131305e-13

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910644567136       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910644567136       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910644567136       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910644458831       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910645945672       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910644704907       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910644061728       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910634916859       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910641156800       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910506074615       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910684000015       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910636070766       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910664690052       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910401561991       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910751021594       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909474524731       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910671771306       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910607999715       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909238808179       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908573526492       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908725307017       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910009506438       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911514591240       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914708575327       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.910968800277       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908109371012       residual = 8.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.911322036491       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908412500609       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909622759208       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.911215760059       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.910308721059       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.910592862739       residual = 2.67e-06           smallest_sin_value = 9.99e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.800442e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910644567136       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910644567136       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910644567136       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910644567136       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910653853701       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910641753736       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910584797453       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910601793628       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910535602535       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910576683738       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910380020987       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910457040642       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909112024814       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909977700864       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911306156864       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.913429415890       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910824327078       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909749008635       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907408066860       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.913442119086       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.920362178015       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.899252773811       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.902641661310       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914062706541       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903629036467       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914505329957       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.911181592944       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.927162826913       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.911908691443       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.892825470301       residual = 4.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.937081042571       residual = 9.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.912757763242       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.894117874576       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.912174563376       residual = 4.88e-04           smallest_sin_value = 9.95e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.912792631104       residual = 6.95e-04           smallest_sin_value = 9.91e-01
davidson iteration   35 stopping due to small subspace S singular value of 8.69e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 6.973922e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7200e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9317
    reference variance = 0.351916
====================================================
  Execution time = 4.4521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2787e-01
  Total weights = 2.0000e+06
  Execution time = 4.8529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404888271
  error estimate for blocks of size 2^( 2) =       0.000417115639
  error estimate for blocks of size 2^( 3) =       0.000429737735
  error estimate for blocks of size 2^( 4) =       0.000441540346
  error estimate for blocks of size 2^( 5) =       0.000454139654
  error estimate for blocks of size 2^( 6) =       0.000462449668
  error estimate for blocks of size 2^( 7) =       0.000468165250

      target function =                  N/A
              le_mean =     -16.909938328557
             les_mean =     286.273883136446
             stat err =       0.000456573729
             autocorr =       1.271602710619
              std dev =       0.572598484799
             le_variance =       0.327869024794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404888271
  error estimate for blocks of size 2^( 2) =       0.000417115639
  error estimate for blocks of size 2^( 3) =       0.000429737735
  error estimate for blocks of size 2^( 4) =       0.000441540346
  error estimate for blocks of size 2^( 5) =       0.000454139654
  error estimate for blocks of size 2^( 6) =       0.000462449668
  error estimate for blocks of size 2^( 7) =       0.000468165250

      target function =                  N/A
              le_mean =     -16.909938328557
             les_mean =     286.273883136446
             stat err =       0.000456573729
             autocorr =       1.271602710618
              std dev =       0.572598484799
             le_variance =       0.327869024794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404888271
  error estimate for blocks of size 2^( 2) =       0.000417115639
  error estimate for blocks of size 2^( 3) =       0.000429737735
  error estimate for blocks of size 2^( 4) =       0.000441540346
  error estimate for blocks of size 2^( 5) =       0.000454139654
  error estimate for blocks of size 2^( 6) =       0.000462449668
  error estimate for blocks of size 2^( 7) =       0.000468165250

      target function =                  N/A
              le_mean =     -16.909938328557
             les_mean =     286.273883136446
             stat err =       0.000456573729
             autocorr =       1.271602710617
              std dev =       0.572598484799
             le_variance =       0.327869024794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327782866096
                                         uncertainty =       0.002501713302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404888271
  error estimate for blocks of size 2^( 2) =       0.000417115639
  error estimate for blocks of size 2^( 3) =       0.000429737735
  error estimate for blocks of size 2^( 4) =       0.000441540346
  error estimate for blocks of size 2^( 5) =       0.000454139654
  error estimate for blocks of size 2^( 6) =       0.000462449668
  error estimate for blocks of size 2^( 7) =       0.000468165250

      target function =                  N/A
              le_mean =     -16.909938328557
             les_mean =     286.273883136446
             stat err =       0.000456573729
             autocorr =       1.271602710617
              std dev =       0.572598484799
             le_variance =       0.327869024794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909938328557        initial  <--
     5.8208e+09     5.8208e+10             1.1313e-13       -16.909938328557
     2.3283e+10     2.3283e+11             2.8004e-14       -16.909938328557
     9.3132e+10     9.3132e+11             6.9739e-15       -16.909938328557

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.8787
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2609e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8342
    reference variance = 0.396544
====================================================
  Execution time = 4.5151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1927e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336305450430
                                         uncertainty =       0.006353980170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336305450430
                                         uncertainty =       0.006353980170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410008546
  error estimate for blocks of size 2^( 2) =       0.000422392646
  error estimate for blocks of size 2^( 3) =       0.000434943607
  error estimate for blocks of size 2^( 4) =       0.000447025516
  error estimate for blocks of size 2^( 5) =       0.000457189086
  error estimate for blocks of size 2^( 6) =       0.000463578630
  error estimate for blocks of size 2^( 7) =       0.000469741266

      target function =                  N/A
              le_mean =     -16.909359156249
             les_mean =     286.262640923002
             stat err =       0.000459383624
             autocorr =       1.255351081980
              std dev =       0.579839646883
             le_variance =       0.336214016098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690935915625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909359156249       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909359156249       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909359156249       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909342690171       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909393070439       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909361577016       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909397675858       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909375298866       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909354224406       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909295223451       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909431497268       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908011282000       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909281093303       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909769728029       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908303824650       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906188737358       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907583417897       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907084533884       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907105384991       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907174877781       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907899767583       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910253027795       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.909232388637       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.915505595324       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.910624962600       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.911496313491       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.911632447002       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.911624796907       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906590736073       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908245592714       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.909459089253       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906784143189       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.905835759596       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.907639162481       residual = 9.98e-04           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.907243087682       residual = 9.64e-04           smallest_sin_value = 9.98e-01
davidson iteration   35:   krylov dim =  36   energy =     -16.924061343242       residual = 2.86e-02           smallest_sin_value = 9.97e-01
davidson iteration   36 stopping due to small subspace S singular value of 8.62e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+10 is 1.086517e-14

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909359156249       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909359156249       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909359156249       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909359156249       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909348286398       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909515930879       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909424924343       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909392246028       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.908820746193       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909843672487       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907879890611       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908144319074       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905507581051       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.912378987866       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909116944780       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907826494725       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.921141422983       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.897223675136       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908031345361       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.894721640893       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.934896162678       residual = 9.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.927928216817       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911501777302       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.885665003270       residual = 7.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.884297126387       residual = 8.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.899792237022       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.922079176150       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.909545299408       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.894672133678       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.896102789127       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.893958583890       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.881692971308       residual = 9.53e-02           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.863273013228       residual = 2.82e-01           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.53e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+11 is 2.741508e-15

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909359156249       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909359156249       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909359156249       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909304338208       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909559898375       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909560117109       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908547643800       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908031378227       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.912273712405       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.916429399286       residual = 6.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894976948227       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906981037052       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.902886731278       residual = 5.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908663399530       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.890493229883       residual = 4.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.912993111405       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903223622672       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.834606835991       residual = 7.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904920396179       residual = 9.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.885099462497       residual = 8.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.838253313090       residual = 6.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.895020978198       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.937489935764       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.932629825748       residual = 8.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.891654457868       residual = 5.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.843411084202       residual = 5.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.788963318007       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.812641521789       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.823712007234       residual = 9.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.817979717543       residual = 1.17e+00           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.821297598880       residual = 1.17e+00           smallest_sin_value = 9.93e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.894907744315       residual = 2.54e-02           smallest_sin_value = 9.93e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+11 is 5.718527e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7133e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8946
    reference variance = 0.250383
====================================================
  Execution time = 4.4340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2758e-01
  Total weights = 2.0000e+06
  Execution time = 4.8485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404707806
  error estimate for blocks of size 2^( 2) =       0.000417138173
  error estimate for blocks of size 2^( 3) =       0.000429543724
  error estimate for blocks of size 2^( 4) =       0.000441159431
  error estimate for blocks of size 2^( 5) =       0.000450546975
  error estimate for blocks of size 2^( 6) =       0.000457249361
  error estimate for blocks of size 2^( 7) =       0.000459615818

      target function =                  N/A
              le_mean =     -16.909522316744
             les_mean =     286.259521632391
             stat err =       0.000452142896
             autocorr =       1.248154257621
              std dev =       0.572343267367
             le_variance =       0.327576815701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404707806
  error estimate for blocks of size 2^( 2) =       0.000417138173
  error estimate for blocks of size 2^( 3) =       0.000429543724
  error estimate for blocks of size 2^( 4) =       0.000441159431
  error estimate for blocks of size 2^( 5) =       0.000450546975
  error estimate for blocks of size 2^( 6) =       0.000457249361
  error estimate for blocks of size 2^( 7) =       0.000459615818

      target function =                  N/A
              le_mean =     -16.909522316744
             les_mean =     286.259521632391
             stat err =       0.000452142896
             autocorr =       1.248154257625
              std dev =       0.572343267367
             le_variance =       0.327576815701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404707806
  error estimate for blocks of size 2^( 2) =       0.000417138173
  error estimate for blocks of size 2^( 3) =       0.000429543724
  error estimate for blocks of size 2^( 4) =       0.000441159431
  error estimate for blocks of size 2^( 5) =       0.000450546975
  error estimate for blocks of size 2^( 6) =       0.000457249361
  error estimate for blocks of size 2^( 7) =       0.000459615818

      target function =                  N/A
              le_mean =     -16.909522316744
             les_mean =     286.259521632391
             stat err =       0.000452142896
             autocorr =       1.248154257626
              std dev =       0.572343267367
             le_variance =       0.327576815701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327466637947
                                         uncertainty =       0.004347618569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404707806
  error estimate for blocks of size 2^( 2) =       0.000417138173
  error estimate for blocks of size 2^( 3) =       0.000429543724
  error estimate for blocks of size 2^( 4) =       0.000441159431
  error estimate for blocks of size 2^( 5) =       0.000450546975
  error estimate for blocks of size 2^( 6) =       0.000457249361
  error estimate for blocks of size 2^( 7) =       0.000459615818

      target function =                  N/A
              le_mean =     -16.909522316744
             les_mean =     286.259521632391
             stat err =       0.000452142896
             autocorr =       1.248154257626
              std dev =       0.572343267367
             le_variance =       0.327576815701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909522316744        initial  <--
     5.8208e+10     5.8208e+11             1.0865e-14       -16.909522316744
     2.3283e+11     2.3283e+12             2.7415e-15       -16.909522316744
     9.3132e+11     9.3132e+12             5.7185e-16       -16.909522316744

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.7135
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2585e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8786
    reference variance = 0.48397
====================================================
  Execution time = 4.4957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2053e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1979e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320550162973
                                         uncertainty =       0.002313167326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320550162973
                                         uncertainty =       0.002313167326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400333343
  error estimate for blocks of size 2^( 2) =       0.000412404487
  error estimate for blocks of size 2^( 3) =       0.000425153323
  error estimate for blocks of size 2^( 4) =       0.000436954158
  error estimate for blocks of size 2^( 5) =       0.000447250599
  error estimate for blocks of size 2^( 6) =       0.000454207914
  error estimate for blocks of size 2^( 7) =       0.000458120126

      target function =                  N/A
              le_mean =     -16.909985671982
             les_mean =     286.268148837604
             stat err =       0.000449133199
             autocorr =       1.258655246049
              std dev =       0.566156843307
             le_variance =       0.320533571223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690998567198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909985671982       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909985671982       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909985671982       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909985671982       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909968397493       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909919389844       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909914583017       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910442905509       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910175339688       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905882483000       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910410481194       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907247248621       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904529049954       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.878270802986       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.874757046921       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.937033092124       residual = 9.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906975560494       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.923038812642       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.008930011026       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.972663275186       residual = 5.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.861648578999       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.926807399436       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.949635868823       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.929082918793       residual = 4.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.959524810034       residual = 3.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.926849889303       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.781510824223       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.885712697081       residual = 8.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904777061171       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.852464676798       residual = 3.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.912002212271       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.860377578790       residual = 4.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.931260387481       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.827319974369       residual = 9.29e-01           smallest_sin_value = 9.98e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+11 is 1.075856e-15

solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909985671982       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909985671982       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909985671982       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909986290676       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910009176114       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.896236353601       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.896525866654       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.902245112467       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.902674820101       residual = 7.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.912465916540       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894920549673       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.931698087101       residual = 6.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.912072585024       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.952919920034       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.892362067940       residual = 4.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.981877734806       residual = 6.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.975324626388       residual = 5.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.924748958860       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.860846884555       residual = 3.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.805849495671       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.853291266135       residual = 4.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.897348866669       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.800263911833       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.958749761716       residual = 4.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.985535386880       residual = 9.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.029139945075       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.035203739215       residual = 1.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.353964177451       residual = 2.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.866220593070       residual = 6.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.112087387027       residual = 6.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.719532088297       residual = 5.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.682441170698       residual = 6.38e+00           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.931488989097       residual = 2.51e-01           smallest_sin_value = 9.94e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+12 is 2.939284e-16

solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909985671982       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909985671982       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909985671982       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909985671982       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912557206607       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.951439051637       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.871041465235       residual = 1.97e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.918848342188       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.952454208723       residual = 2.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.921291087812       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.002678154728       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.940916299259       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.976598079804       residual = 6.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.941164527968       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.965401628236       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.930460986548       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.864452820414       residual = 3.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.806571961495       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.832870437333       residual = 8.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.738853001194       residual = 3.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.572890648825       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.859493706770       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.891907826603       residual = 8.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.728733756321       residual = 4.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.710838272045       residual = 8.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.960840358121       residual = 9.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.726279677618       residual = 6.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.574227720755       residual = 1.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.282699780267       residual = 2.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.609579653725       residual = 1.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.545282977327       residual = 2.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.894070817486       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.406101074127       residual = 3.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -15.828219383319       residual = 1.60e+02           smallest_sin_value = 9.98e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+12 is 2.908238e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.6990e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9369
    reference variance = 0.21441
====================================================
  Execution time = 4.4430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3043e-01
  Total weights = 2.0000e+06
  Execution time = 4.8511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406468981
  error estimate for blocks of size 2^( 2) =       0.000418789872
  error estimate for blocks of size 2^( 3) =       0.000431307606
  error estimate for blocks of size 2^( 4) =       0.000443055762
  error estimate for blocks of size 2^( 5) =       0.000453539149
  error estimate for blocks of size 2^( 6) =       0.000459253700
  error estimate for blocks of size 2^( 7) =       0.000465886404

      target function =                  N/A
              le_mean =     -16.909906436269
             les_mean =     286.275369582472
             stat err =       0.000455433754
             autocorr =       1.255438990932
              std dev =       0.574833945000
             le_variance =       0.330434064324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406468981
  error estimate for blocks of size 2^( 2) =       0.000418789872
  error estimate for blocks of size 2^( 3) =       0.000431307606
  error estimate for blocks of size 2^( 4) =       0.000443055762
  error estimate for blocks of size 2^( 5) =       0.000453539149
  error estimate for blocks of size 2^( 6) =       0.000459253700
  error estimate for blocks of size 2^( 7) =       0.000465886404

      target function =                  N/A
              le_mean =     -16.909906436269
             les_mean =     286.275369582472
             stat err =       0.000455433754
             autocorr =       1.255438990932
              std dev =       0.574833945000
             le_variance =       0.330434064324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406468981
  error estimate for blocks of size 2^( 2) =       0.000418789872
  error estimate for blocks of size 2^( 3) =       0.000431307606
  error estimate for blocks of size 2^( 4) =       0.000443055762
  error estimate for blocks of size 2^( 5) =       0.000453539149
  error estimate for blocks of size 2^( 6) =       0.000459253700
  error estimate for blocks of size 2^( 7) =       0.000465886404

      target function =                  N/A
              le_mean =     -16.909906436269
             les_mean =     286.275369582472
             stat err =       0.000455433754
             autocorr =       1.255438990932
              std dev =       0.574833945000
             le_variance =       0.330434064324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330471409608
                                         uncertainty =       0.004334408496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406468981
  error estimate for blocks of size 2^( 2) =       0.000418789872
  error estimate for blocks of size 2^( 3) =       0.000431307606
  error estimate for blocks of size 2^( 4) =       0.000443055762
  error estimate for blocks of size 2^( 5) =       0.000453539149
  error estimate for blocks of size 2^( 6) =       0.000459253700
  error estimate for blocks of size 2^( 7) =       0.000465886404

      target function =                  N/A
              le_mean =     -16.909906436269
             les_mean =     286.275369582472
             stat err =       0.000455433754
             autocorr =       1.255438990932
              std dev =       0.574833945000
             le_variance =       0.330434064324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909906436269        initial  <--
     5.8208e+11     5.8208e+12             1.0759e-15       -16.909906436269
     2.3283e+12     2.3283e+13             2.9393e-16       -16.909906436269
     9.3132e+12     9.3132e+13             2.9082e-17       -16.909906436269

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.7544
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2575e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 24456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.948
    reference variance = 0.296255
====================================================
  Execution time = 4.4957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2654e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.2092e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326592526626
                                         uncertainty =       0.003192590862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326592526626
                                         uncertainty =       0.003192590862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404067882
  error estimate for blocks of size 2^( 2) =       0.000415661767
  error estimate for blocks of size 2^( 3) =       0.000427713762
  error estimate for blocks of size 2^( 4) =       0.000440276687
  error estimate for blocks of size 2^( 5) =       0.000450657356
  error estimate for blocks of size 2^( 6) =       0.000459440789
  error estimate for blocks of size 2^( 7) =       0.000466391457

      target function =                  N/A
              le_mean =     -16.909650557952
             les_mean =     286.262823534989
             stat err =       0.000454191572
             autocorr =       1.263483225119
              std dev =       0.571438278580
             le_variance =       0.326541706227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690965055795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909650557952       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909650557952       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909650557952       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909650557952       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909650557952       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909650557952       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.7054e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9328
    reference variance = 0.225254
====================================================
  Execution time = 4.4569e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2347e-01
  Total weights = 2.0000e+06
  Execution time = 4.8420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402164802
  error estimate for blocks of size 2^( 2) =       0.000413884590
  error estimate for blocks of size 2^( 3) =       0.000426615777
  error estimate for blocks of size 2^( 4) =       0.000438927661
  error estimate for blocks of size 2^( 5) =       0.000448633990
  error estimate for blocks of size 2^( 6) =       0.000455351820
  error estimate for blocks of size 2^( 7) =       0.000459218877

      target function =                  N/A
              le_mean =     -16.909971294924
             les_mean =     286.270602089973
             stat err =       0.000450533087
             autocorr =       1.255004448527
              std dev =       0.568746917847
             le_variance =       0.323473056560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402164802
  error estimate for blocks of size 2^( 2) =       0.000413884590
  error estimate for blocks of size 2^( 3) =       0.000426615777
  error estimate for blocks of size 2^( 4) =       0.000438927661
  error estimate for blocks of size 2^( 5) =       0.000448633990
  error estimate for blocks of size 2^( 6) =       0.000455351820
  error estimate for blocks of size 2^( 7) =       0.000459218877

      target function =                  N/A
              le_mean =     -16.909971294924
             les_mean =     286.270602089973
             stat err =       0.000450533087
             autocorr =       1.255004448527
              std dev =       0.568746917847
             le_variance =       0.323473056560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402164802
  error estimate for blocks of size 2^( 2) =       0.000413884590
  error estimate for blocks of size 2^( 3) =       0.000426615777
  error estimate for blocks of size 2^( 4) =       0.000438927661
  error estimate for blocks of size 2^( 5) =       0.000448633990
  error estimate for blocks of size 2^( 6) =       0.000455351820
  error estimate for blocks of size 2^( 7) =       0.000459218877

      target function =                  N/A
              le_mean =     -16.909971294924
             les_mean =     286.270602089973
             stat err =       0.000450533087
             autocorr =       1.255004448527
              std dev =       0.568746917847
             le_variance =       0.323473056560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323367085012
                                         uncertainty =       0.003350576852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402164802
  error estimate for blocks of size 2^( 2) =       0.000413884590
  error estimate for blocks of size 2^( 3) =       0.000426615777
  error estimate for blocks of size 2^( 4) =       0.000438927661
  error estimate for blocks of size 2^( 5) =       0.000448633990
  error estimate for blocks of size 2^( 6) =       0.000455351820
  error estimate for blocks of size 2^( 7) =       0.000459218877

      target function =                  N/A
              le_mean =     -16.909971294924
             les_mean =     286.270602089973
             stat err =       0.000450533087
             autocorr =       1.255004448527
              std dev =       0.568746917847
             le_variance =       0.323473056560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909971294924        initial  <--
     5.8208e+12     5.8208e+13             0.0000e+00       -16.909971294924
     2.3283e+13     2.3283e+14             0.0000e+00       -16.909971294924
     9.3132e+13     9.3132e+14             0.0000e+00       -16.909971294924

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 68.9471
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.073415e-01 1 1  ON 0
 uu_1                 1.420408e-01 1 1  ON 1
 uu_2                 4.333878e-02 1 1  ON 2
 uu_3                -1.788819e-02 1 1  ON 3
 uu_4                -6.302883e-02 1 1  ON 4
 uu_5                -9.707649e-02 1 1  ON 5
 uu_6                -1.244297e-01 1 1  ON 6
 uu_7                -1.378634e-01 1 1  ON 7
 uu_8                -1.332383e-01 1 1  ON 8
 uu_9                -1.047493e-01 1 1  ON 9
 ud_0                 4.354415e-01 1 1  ON 10
 ud_1                 1.776003e-01 1 1  ON 11
 ud_2                 6.403511e-02 1 1  ON 12
 ud_3                -4.618944e-03 1 1  ON 13
 ud_4                -6.088974e-02 1 1  ON 14
 ud_5                -1.025083e-01 1 1  ON 15
 ud_6                -1.302613e-01 1 1  ON 16
 ud_7                -1.481255e-01 1 1  ON 17
 ud_8                -1.518987e-01 1 1  ON 18
 ud_9                -1.447696e-01 1 1  ON 19
 eO_0                -7.494233e-01 1 1  ON 20
 eO_1                -4.362100e-01 1 1  ON 21
 eO_2                -2.586677e-02 1 1  ON 22
 eO_3                 2.941643e-01 1 1  ON 23
 eO_4                 5.211227e-01 1 1  ON 24
 eO_5                 4.824165e-01 1 1  ON 25
 eO_6                 2.579421e-01 1 1  ON 26
 eO_7                -4.115084e-02 1 1  ON 27
 eO_8                -2.209873e-01 1 1  ON 28
 eO_9                -8.107947e-02 1 1  ON 29
eH1_0                -2.396232e-01 1 1  ON 30
eH1_1                -1.368837e-01 1 1  ON 31
eH1_2                -9.223381e-02 1 1  ON 32
eH1_3                -4.109373e-02 1 1  ON 33
eH1_4                 7.323284e-03 1 1  ON 34
eH1_5                 3.841446e-02 1 1  ON 35
eH1_6                 9.634798e-02 1 1  ON 36
eH1_7                 1.491719e-01 1 1  ON 37
eH1_8                 1.684890e-01 1 1  ON 38
eH1_9                 5.459742e-02 1 1  ON 39
eH2_0                -2.383690e-01 1 1  ON 40
eH2_1                -1.356293e-01 1 1  ON 41
eH2_2                -9.106485e-02 1 1  ON 42
eH2_3                -3.968533e-02 1 1  ON 43
eH2_4                 8.363161e-03 1 1  ON 44
eH2_5                 3.990453e-02 1 1  ON 45
eH2_6                 9.820817e-02 1 1  ON 46
eH2_7                 1.497104e-01 1 1  ON 47
eH2_8                 1.800563e-01 1 1  ON 48
eH2_9                 4.486017e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2601e+02 secs
  Total Execution time = 5.0903e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
